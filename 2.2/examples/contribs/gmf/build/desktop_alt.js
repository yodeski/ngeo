
/*
 * Auto redirect to https to prevent CORS exceptions
 */
if (window.location.protocol == 'http:' &&
    window.location.port != '3000' &&
    window.location.host != 'localhost') {
  var restOfUrl = window.location.href.substr(5);
  /** @type {Location} */
  window.location = 'https:' + restOfUrl;
}

/*! jQuery v3.2.1 | (c) JS Foundation and other contributors | jquery.org/license */
!function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";var c=[],d=a.document,e=Object.getPrototypeOf,f=c.slice,g=c.concat,h=c.push,i=c.indexOf,j={},k=j.toString,l=j.hasOwnProperty,m=l.toString,n=m.call(Object),o={};function p(a,b){b=b||d;var c=b.createElement("script");c.text=a,b.head.appendChild(c).parentNode.removeChild(c)}var q="3.2.1",r=function(a,b){return new r.fn.init(a,b)},s=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,t=/^-ms-/,u=/-([a-z])/g,v=function(a,b){return b.toUpperCase()};r.fn=r.prototype={jquery:q,constructor:r,length:0,toArray:function(){return f.call(this)},get:function(a){return null==a?f.call(this):a<0?this[a+this.length]:this[a]},pushStack:function(a){var b=r.merge(this.constructor(),a);return b.prevObject=this,b},each:function(a){return r.each(this,a)},map:function(a){return this.pushStack(r.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(f.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:c.sort,splice:c.splice},r.extend=r.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||r.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(r.isPlainObject(d)||(e=Array.isArray(d)))?(e?(e=!1,f=c&&Array.isArray(c)?c:[]):f=c&&r.isPlainObject(c)?c:{},g[b]=r.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},r.extend({expando:"jQuery"+(q+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===r.type(a)},isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=r.type(a);return("number"===b||"string"===b)&&!isNaN(a-parseFloat(a))},isPlainObject:function(a){var b,c;return!(!a||"[object Object]"!==k.call(a))&&(!(b=e(a))||(c=l.call(b,"constructor")&&b.constructor,"function"==typeof c&&m.call(c)===n))},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?j[k.call(a)]||"object":typeof a},globalEval:function(a){p(a)},camelCase:function(a){return a.replace(t,"ms-").replace(u,v)},each:function(a,b){var c,d=0;if(w(a)){for(c=a.length;d<c;d++)if(b.call(a[d],d,a[d])===!1)break}else for(d in a)if(b.call(a[d],d,a[d])===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(s,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(w(Object(a))?r.merge(c,"string"==typeof a?[a]:a):h.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:i.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;f<g;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,e,f=0,h=[];if(w(a))for(d=a.length;f<d;f++)e=b(a[f],f,c),null!=e&&h.push(e);else for(f in a)e=b(a[f],f,c),null!=e&&h.push(e);return g.apply([],h)},guid:1,proxy:function(a,b){var c,d,e;if("string"==typeof b&&(c=a[b],b=a,a=c),r.isFunction(a))return d=f.call(arguments,2),e=function(){return a.apply(b||this,d.concat(f.call(arguments)))},e.guid=a.guid=a.guid||r.guid++,e},now:Date.now,support:o}),"function"==typeof Symbol&&(r.fn[Symbol.iterator]=c[Symbol.iterator]),r.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){j["[object "+b+"]"]=b.toLowerCase()});function w(a){var b=!!a&&"length"in a&&a.length,c=r.type(a);return"function"!==c&&!r.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a)}var x=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",L="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",M="\\["+K+"*("+L+")(?:"+K+"*([*^$|!~]?=)"+K+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+L+"))|)"+K+"*\\]",N=":("+L+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+M+")*)|.*)\\)|)",O=new RegExp(K+"+","g"),P=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),Q=new RegExp("^"+K+"*,"+K+"*"),R=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),S=new RegExp("="+K+"*([^\\]'\"]*?)"+K+"*\\]","g"),T=new RegExp(N),U=new RegExp("^"+L+"$"),V={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L+"|[*])"),ATTR:new RegExp("^"+M),PSEUDO:new RegExp("^"+N),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,_=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),aa=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ba=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ca=function(a,b){return b?"\0"===a?"\ufffd":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a},da=function(){m()},ea=ta(function(a){return a.disabled===!0&&("form"in a||"label"in a)},{dir:"parentNode",next:"legend"});try{G.apply(D=H.call(v.childNodes),v.childNodes),D[v.childNodes.length].nodeType}catch(fa){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s=b&&b.ownerDocument,w=b?b.nodeType:9;if(d=d||[],"string"!=typeof a||!a||1!==w&&9!==w&&11!==w)return d;if(!e&&((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,p)){if(11!==w&&(l=Z.exec(a)))if(f=l[1]){if(9===w){if(!(j=b.getElementById(f)))return d;if(j.id===f)return d.push(j),d}else if(s&&(j=s.getElementById(f))&&t(b,j)&&j.id===f)return d.push(j),d}else{if(l[2])return G.apply(d,b.getElementsByTagName(a)),d;if((f=l[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(f)),d}if(c.qsa&&!A[a+" "]&&(!q||!q.test(a))){if(1!==w)s=b,r=a;else if("object"!==b.nodeName.toLowerCase()){(k=b.getAttribute("id"))?k=k.replace(ba,ca):b.setAttribute("id",k=u),o=g(a),h=o.length;while(h--)o[h]="#"+k+" "+sa(o[h]);r=o.join(","),s=$.test(a)&&qa(b.parentNode)||b}if(r)try{return G.apply(d,s.querySelectorAll(r)),d}catch(x){}finally{k===u&&b.removeAttribute("id")}}}return i(a.replace(P,"$1"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("fieldset");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split("|"),e=c.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return function(b){return"form"in b?b.parentNode&&b.disabled===!1?"label"in b?"label"in b.parentNode?b.parentNode.disabled===a:b.disabled===a:b.isDisabled===a||b.isDisabled!==!a&&ea(b)===a:b.disabled===a:"label"in b&&b.disabled===a}}function pa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function qa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=n.documentElement,p=!f(n),v!==n&&(e=n.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",da,!1):e.attachEvent&&e.attachEvent("onunload",da)),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(n.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Y.test(n.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!n.getElementsByName||!n.getElementsByName(u).length}),c.getById?(d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){return a.getAttribute("id")===b}},d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c?[c]:[]}}):(d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}},d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c,d,e,f=b.getElementById(a);if(f){if(c=f.getAttributeNode("id"),c&&c.value===a)return[f];e=b.getElementsByName(a),d=0;while(f=e[d++])if(c=f.getAttributeNode("id"),c&&c.value===a)return[f]}return[]}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){if("undefined"!=typeof b.getElementsByClassName&&p)return b.getElementsByClassName(a)},r=[],q=[],(c.qsa=Y.test(n.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+K+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+K+"*(?:value|"+J+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){a.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var b=n.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+K+"*[*^$|!~]?="),2!==a.querySelectorAll(":enabled").length&&q.push(":enabled",":disabled"),o.appendChild(a).disabled=!0,2!==a.querySelectorAll(":disabled").length&&q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=Y.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"*"),s.call(a,"[s!='']:x"),r.push("!=",N)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=Y.test(o.compareDocumentPosition),t=b||Y.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===n||a.ownerDocument===v&&t(v,a)?-1:b===n||b.ownerDocument===v&&t(v,b)?1:k?I(k,a)-I(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,g=[a],h=[b];if(!e||!f)return a===n?-1:b===n?1:e?-1:f?1:k?I(k,a)-I(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)g.unshift(c);c=b;while(c=c.parentNode)h.unshift(c);while(g[d]===h[d])d++;return d?la(g[d],h[d]):g[d]===v?-1:h[d]===v?1:0},n):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(S,"='$1']"),c.matchesSelector&&p&&!A[b+" "]&&(!r||!r.test(b))&&(!q||!q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.escape=function(a){return(a+"").replace(ba,ca)},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(_,aa),a[3]=(a[3]||a[4]||a[5]||"").replace(_,aa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return V.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&T.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(_,aa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+K+")"+a+"("+K+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(O," ")+" ").indexOf(c)>-1:"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){while(p){m=b;while(m=m[p])if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){m=q,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n&&j[2],m=n&&q.childNodes[n];while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if(1===m.nodeType&&++t&&m===b){k[a]=[w,n,t];break}}else if(s&&(m=b,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n),t===!1)while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if((h?m.nodeName.toLowerCase()===r:1===m.nodeType)&&++t&&(s&&(l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[w,t]),m===b))break;return t-=e,t===d||t%d===0&&t/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(P,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(_,aa),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return U.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(_,aa).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:oa(!1),disabled:oa(!0),checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:pa(function(){return[0]}),last:pa(function(a,b){return[b-1]}),eq:pa(function(a,b,c){return[c<0?c+b:c]}),even:pa(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:pa(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:pa(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:pa(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function ra(){}ra.prototype=d.filters=d.pseudos,d.setFilters=new ra,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){c&&!(e=Q.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P," ")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function sa(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function ta(a,b,c){var d=b.dir,e=b.next,f=e||d,g=c&&"parentNode"===f,h=x++;return b.first?function(b,c,e){while(b=b[d])if(1===b.nodeType||g)return a(b,c,e);return!1}:function(b,c,i){var j,k,l,m=[w,h];if(i){while(b=b[d])if((1===b.nodeType||g)&&a(b,c,i))return!0}else while(b=b[d])if(1===b.nodeType||g)if(l=b[u]||(b[u]={}),k=l[b.uniqueID]||(l[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[d]||b;else{if((j=k[f])&&j[0]===w&&j[1]===h)return m[2]=j[2];if(k[f]=m,m[2]=a(b,c,i))return!0}return!1}}function ua(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function va(a,b,c){for(var d=0,e=b.length;d<e;d++)ga(a,b[d],c);return c}function wa(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function xa(a,b,c,d,e,f){return d&&!d[u]&&(d=xa(d)),e&&!e[u]&&(e=xa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||va(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:wa(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=wa(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=wa(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ya(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=ta(function(a){return a===b},h,!0),l=ta(function(a){return I(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];i<f;i++)if(c=d.relative[a[i].type])m=[ta(ua(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;e<f;e++)if(d.relative[a[e].type])break;return xa(i>1&&ua(m),i>1&&sa(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(P,"$1"),c,i<e&&ya(a.slice(i,e)),e<f&&ya(a=a.slice(e)),e<f&&sa(a))}m.push(c)}return ua(m)}function za(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,o,q,r=0,s="0",t=f&&[],u=[],v=j,x=f||e&&d.find.TAG("*",k),y=w+=null==v?1:Math.random()||.1,z=x.length;for(k&&(j=g===n||g||k);s!==z&&null!=(l=x[s]);s++){if(e&&l){o=0,g||l.ownerDocument===n||(m(l),h=!p);while(q=a[o++])if(q(l,g||n,h)){i.push(l);break}k&&(w=y)}c&&((l=!q&&l)&&r--,f&&t.push(l))}if(r+=s,c&&s!==r){o=0;while(q=b[o++])q(t,u,g,h);if(f){if(r>0)while(s--)t[s]||u[s]||(u[s]=E.call(i));u=wa(u)}G.apply(i,u),k&&!f&&u.length>0&&r+b.length>1&&ga.uniqueSort(i)}return k&&(w=y,j=v),t};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=ya(b[c]),f[u]?d.push(f):e.push(f);f=A(a,za(e,d)),f.selector=a}return f},i=ga.select=function(a,b,c,e){var f,i,j,k,l,m="function"==typeof a&&a,n=!e&&g(a=m.selector||a);if(c=c||[],1===n.length){if(i=n[0]=n[0].slice(0),i.length>2&&"ID"===(j=i[0]).type&&9===b.nodeType&&p&&d.relative[i[1].type]){if(b=(d.find.ID(j.matches[0].replace(_,aa),b)||[])[0],!b)return c;m&&(b=b.parentNode),a=a.slice(i.shift().value.length)}f=V.needsContext.test(a)?0:i.length;while(f--){if(j=i[f],d.relative[k=j.type])break;if((l=d.find[k])&&(e=l(j.matches[0].replace(_,aa),$.test(i[0].type)&&qa(b.parentNode)||b))){if(i.splice(f,1),a=e.length&&sa(i),!a)return G.apply(c,e),c;break}}}return(m||h(a,n))(e,b,!p,c,!b||$.test(a)&&qa(b.parentNode)||b),c},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("fieldset"))}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(J,function(a,b,c){var d;if(!c)return a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);r.find=x,r.expr=x.selectors,r.expr[":"]=r.expr.pseudos,r.uniqueSort=r.unique=x.uniqueSort,r.text=x.getText,r.isXMLDoc=x.isXML,r.contains=x.contains,r.escapeSelector=x.escape;var y=function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&r(a).is(c))break;d.push(a)}return d},z=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},A=r.expr.match.needsContext;function B(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()}var C=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,D=/^.[^:#\[\.,]*$/;function E(a,b,c){return r.isFunction(b)?r.grep(a,function(a,d){return!!b.call(a,d,a)!==c}):b.nodeType?r.grep(a,function(a){return a===b!==c}):"string"!=typeof b?r.grep(a,function(a){return i.call(b,a)>-1!==c}):D.test(b)?r.filter(b,a,c):(b=r.filter(b,a),r.grep(a,function(a){return i.call(b,a)>-1!==c&&1===a.nodeType}))}r.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?r.find.matchesSelector(d,a)?[d]:[]:r.find.matches(a,r.grep(b,function(a){return 1===a.nodeType}))},r.fn.extend({find:function(a){var b,c,d=this.length,e=this;if("string"!=typeof a)return this.pushStack(r(a).filter(function(){for(b=0;b<d;b++)if(r.contains(e[b],this))return!0}));for(c=this.pushStack([]),b=0;b<d;b++)r.find(a,e[b],c);return d>1?r.uniqueSort(c):c},filter:function(a){return this.pushStack(E(this,a||[],!1))},not:function(a){return this.pushStack(E(this,a||[],!0))},is:function(a){return!!E(this,"string"==typeof a&&A.test(a)?r(a):a||[],!1).length}});var F,G=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,H=r.fn.init=function(a,b,c){var e,f;if(!a)return this;if(c=c||F,"string"==typeof a){if(e="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:G.exec(a),!e||!e[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(e[1]){if(b=b instanceof r?b[0]:b,r.merge(this,r.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:d,!0)),C.test(e[1])&&r.isPlainObject(b))for(e in b)r.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e]);return this}return f=d.getElementById(e[2]),f&&(this[0]=f,this.length=1),this}return a.nodeType?(this[0]=a,this.length=1,this):r.isFunction(a)?void 0!==c.ready?c.ready(a):a(r):r.makeArray(a,this)};H.prototype=r.fn,F=r(d);var I=/^(?:parents|prev(?:Until|All))/,J={children:!0,contents:!0,next:!0,prev:!0};r.fn.extend({has:function(a){var b=r(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(r.contains(this,b[a]))return!0})},closest:function(a,b){var c,d=0,e=this.length,f=[],g="string"!=typeof a&&r(a);if(!A.test(a))for(;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&r.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?r.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?i.call(r(a),this[0]):i.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(r.uniqueSort(r.merge(this.get(),r(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function K(a,b){while((a=a[b])&&1!==a.nodeType);return a}r.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return y(a,"parentNode")},parentsUntil:function(a,b,c){return y(a,"parentNode",c)},next:function(a){return K(a,"nextSibling")},prev:function(a){return K(a,"previousSibling")},nextAll:function(a){return y(a,"nextSibling")},prevAll:function(a){return y(a,"previousSibling")},nextUntil:function(a,b,c){return y(a,"nextSibling",c)},prevUntil:function(a,b,c){return y(a,"previousSibling",c)},siblings:function(a){return z((a.parentNode||{}).firstChild,a)},children:function(a){return z(a.firstChild)},contents:function(a){return B(a,"iframe")?a.contentDocument:(B(a,"template")&&(a=a.content||a),r.merge([],a.childNodes))}},function(a,b){r.fn[a]=function(c,d){var e=r.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=r.filter(d,e)),this.length>1&&(J[a]||r.uniqueSort(e),I.test(a)&&e.reverse()),this.pushStack(e)}});var L=/[^\x20\t\r\n\f]+/g;function M(a){var b={};return r.each(a.match(L)||[],function(a,c){b[c]=!0}),b}r.Callbacks=function(a){a="string"==typeof a?M(a):r.extend({},a);var b,c,d,e,f=[],g=[],h=-1,i=function(){for(e=e||a.once,d=b=!0;g.length;h=-1){c=g.shift();while(++h<f.length)f[h].apply(c[0],c[1])===!1&&a.stopOnFalse&&(h=f.length,c=!1)}a.memory||(c=!1),b=!1,e&&(f=c?[]:"")},j={add:function(){return f&&(c&&!b&&(h=f.length-1,g.push(c)),function d(b){r.each(b,function(b,c){r.isFunction(c)?a.unique&&j.has(c)||f.push(c):c&&c.length&&"string"!==r.type(c)&&d(c)})}(arguments),c&&!b&&i()),this},remove:function(){return r.each(arguments,function(a,b){var c;while((c=r.inArray(b,f,c))>-1)f.splice(c,1),c<=h&&h--}),this},has:function(a){return a?r.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=g=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=g=[],c||b||(f=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],g.push(c),b||i()),this},fire:function(){return j.fireWith(this,arguments),this},fired:function(){return!!d}};return j};function N(a){return a}function O(a){throw a}function P(a,b,c,d){var e;try{a&&r.isFunction(e=a.promise)?e.call(a).done(b).fail(c):a&&r.isFunction(e=a.then)?e.call(a,b,c):b.apply(void 0,[a].slice(d))}catch(a){c.apply(void 0,[a])}}r.extend({Deferred:function(b){var c=[["notify","progress",r.Callbacks("memory"),r.Callbacks("memory"),2],["resolve","done",r.Callbacks("once memory"),r.Callbacks("once memory"),0,"resolved"],["reject","fail",r.Callbacks("once memory"),r.Callbacks("once memory"),1,"rejected"]],d="pending",e={state:function(){return d},always:function(){return f.done(arguments).fail(arguments),this},"catch":function(a){return e.then(null,a)},pipe:function(){var a=arguments;return r.Deferred(function(b){r.each(c,function(c,d){var e=r.isFunction(a[d[4]])&&a[d[4]];f[d[1]](function(){var a=e&&e.apply(this,arguments);a&&r.isFunction(a.promise)?a.promise().progress(b.notify).done(b.resolve).fail(b.reject):b[d[0]+"With"](this,e?[a]:arguments)})}),a=null}).promise()},then:function(b,d,e){var f=0;function g(b,c,d,e){return function(){var h=this,i=arguments,j=function(){var a,j;if(!(b<f)){if(a=d.apply(h,i),a===c.promise())throw new TypeError("Thenable self-resolution");j=a&&("object"==typeof a||"function"==typeof a)&&a.then,r.isFunction(j)?e?j.call(a,g(f,c,N,e),g(f,c,O,e)):(f++,j.call(a,g(f,c,N,e),g(f,c,O,e),g(f,c,N,c.notifyWith))):(d!==N&&(h=void 0,i=[a]),(e||c.resolveWith)(h,i))}},k=e?j:function(){try{j()}catch(a){r.Deferred.exceptionHook&&r.Deferred.exceptionHook(a,k.stackTrace),b+1>=f&&(d!==O&&(h=void 0,i=[a]),c.rejectWith(h,i))}};b?k():(r.Deferred.getStackHook&&(k.stackTrace=r.Deferred.getStackHook()),a.setTimeout(k))}}return r.Deferred(function(a){c[0][3].add(g(0,a,r.isFunction(e)?e:N,a.notifyWith)),c[1][3].add(g(0,a,r.isFunction(b)?b:N)),c[2][3].add(g(0,a,r.isFunction(d)?d:O))}).promise()},promise:function(a){return null!=a?r.extend(a,e):e}},f={};return r.each(c,function(a,b){var g=b[2],h=b[5];e[b[1]]=g.add,h&&g.add(function(){d=h},c[3-a][2].disable,c[0][2].lock),g.add(b[3].fire),f[b[0]]=function(){return f[b[0]+"With"](this===f?void 0:this,arguments),this},f[b[0]+"With"]=g.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(a){var b=arguments.length,c=b,d=Array(c),e=f.call(arguments),g=r.Deferred(),h=function(a){return function(c){d[a]=this,e[a]=arguments.length>1?f.call(arguments):c,--b||g.resolveWith(d,e)}};if(b<=1&&(P(a,g.done(h(c)).resolve,g.reject,!b),"pending"===g.state()||r.isFunction(e[c]&&e[c].then)))return g.then();while(c--)P(e[c],h(c),g.reject);return g.promise()}});var Q=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;r.Deferred.exceptionHook=function(b,c){a.console&&a.console.warn&&b&&Q.test(b.name)&&a.console.warn("jQuery.Deferred exception: "+b.message,b.stack,c)},r.readyException=function(b){a.setTimeout(function(){throw b})};var R=r.Deferred();r.fn.ready=function(a){return R.then(a)["catch"](function(a){r.readyException(a)}),this},r.extend({isReady:!1,readyWait:1,ready:function(a){(a===!0?--r.readyWait:r.isReady)||(r.isReady=!0,a!==!0&&--r.readyWait>0||R.resolveWith(d,[r]))}}),r.ready.then=R.then;function S(){d.removeEventListener("DOMContentLoaded",S),
a.removeEventListener("load",S),r.ready()}"complete"===d.readyState||"loading"!==d.readyState&&!d.documentElement.doScroll?a.setTimeout(r.ready):(d.addEventListener("DOMContentLoaded",S),a.addEventListener("load",S));var T=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===r.type(c)){e=!0;for(h in c)T(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,r.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(r(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},U=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function V(){this.expando=r.expando+V.uid++}V.uid=1,V.prototype={cache:function(a){var b=a[this.expando];return b||(b={},U(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[r.camelCase(b)]=c;else for(d in b)e[r.camelCase(d)]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][r.camelCase(b)]},access:function(a,b,c){return void 0===b||b&&"string"==typeof b&&void 0===c?this.get(a,b):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d=a[this.expando];if(void 0!==d){if(void 0!==b){Array.isArray(b)?b=b.map(r.camelCase):(b=r.camelCase(b),b=b in d?[b]:b.match(L)||[]),c=b.length;while(c--)delete d[b[c]]}(void 0===b||r.isEmptyObject(d))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!r.isEmptyObject(b)}};var W=new V,X=new V,Y=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Z=/[A-Z]/g;function $(a){return"true"===a||"false"!==a&&("null"===a?null:a===+a+""?+a:Y.test(a)?JSON.parse(a):a)}function _(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(Z,"-$&").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c=$(c)}catch(e){}X.set(a,b,c)}else c=void 0;return c}r.extend({hasData:function(a){return X.hasData(a)||W.hasData(a)},data:function(a,b,c){return X.access(a,b,c)},removeData:function(a,b){X.remove(a,b)},_data:function(a,b,c){return W.access(a,b,c)},_removeData:function(a,b){W.remove(a,b)}}),r.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=X.get(f),1===f.nodeType&&!W.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=r.camelCase(d.slice(5)),_(f,d,e[d])));W.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){X.set(this,a)}):T(this,function(b){var c;if(f&&void 0===b){if(c=X.get(f,a),void 0!==c)return c;if(c=_(f,a),void 0!==c)return c}else this.each(function(){X.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){X.remove(this,a)})}}),r.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=W.get(a,b),c&&(!d||Array.isArray(c)?d=W.access(a,b,r.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=r.queue(a,b),d=c.length,e=c.shift(),f=r._queueHooks(a,b),g=function(){r.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return W.get(a,c)||W.access(a,c,{empty:r.Callbacks("once memory").add(function(){W.remove(a,[b+"queue",c])})})}}),r.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?r.queue(this[0],a):void 0===b?this:this.each(function(){var c=r.queue(this,a,b);r._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&r.dequeue(this,a)})},dequeue:function(a){return this.each(function(){r.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=r.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=W.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var aa=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ba=new RegExp("^(?:([+-])=|)("+aa+")([a-z%]*)$","i"),ca=["Top","Right","Bottom","Left"],da=function(a,b){return a=b||a,"none"===a.style.display||""===a.style.display&&r.contains(a.ownerDocument,a)&&"none"===r.css(a,"display")},ea=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};function fa(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return r.css(a,b,"")},i=h(),j=c&&c[3]||(r.cssNumber[b]?"":"px"),k=(r.cssNumber[b]||"px"!==j&&+i)&&ba.exec(r.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do f=f||".5",k/=f,r.style(a,b,k+j);while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}var ga={};function ha(a){var b,c=a.ownerDocument,d=a.nodeName,e=ga[d];return e?e:(b=c.body.appendChild(c.createElement(d)),e=r.css(b,"display"),b.parentNode.removeChild(b),"none"===e&&(e="block"),ga[d]=e,e)}function ia(a,b){for(var c,d,e=[],f=0,g=a.length;f<g;f++)d=a[f],d.style&&(c=d.style.display,b?("none"===c&&(e[f]=W.get(d,"display")||null,e[f]||(d.style.display="")),""===d.style.display&&da(d)&&(e[f]=ha(d))):"none"!==c&&(e[f]="none",W.set(d,"display",c)));for(f=0;f<g;f++)null!=e[f]&&(a[f].style.display=e[f]);return a}r.fn.extend({show:function(){return ia(this,!0)},hide:function(){return ia(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){da(this)?r(this).show():r(this).hide()})}});var ja=/^(?:checkbox|radio)$/i,ka=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,la=/^$|\/(?:java|ecma)script/i,ma={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ma.optgroup=ma.option,ma.tbody=ma.tfoot=ma.colgroup=ma.caption=ma.thead,ma.th=ma.td;function na(a,b){var c;return c="undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName(b||"*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll(b||"*"):[],void 0===b||b&&B(a,b)?r.merge([a],c):c}function oa(a,b){for(var c=0,d=a.length;c<d;c++)W.set(a[c],"globalEval",!b||W.get(b[c],"globalEval"))}var pa=/<|&#?\w+;/;function qa(a,b,c,d,e){for(var f,g,h,i,j,k,l=b.createDocumentFragment(),m=[],n=0,o=a.length;n<o;n++)if(f=a[n],f||0===f)if("object"===r.type(f))r.merge(m,f.nodeType?[f]:f);else if(pa.test(f)){g=g||l.appendChild(b.createElement("div")),h=(ka.exec(f)||["",""])[1].toLowerCase(),i=ma[h]||ma._default,g.innerHTML=i[1]+r.htmlPrefilter(f)+i[2],k=i[0];while(k--)g=g.lastChild;r.merge(m,g.childNodes),g=l.firstChild,g.textContent=""}else m.push(b.createTextNode(f));l.textContent="",n=0;while(f=m[n++])if(d&&r.inArray(f,d)>-1)e&&e.push(f);else if(j=r.contains(f.ownerDocument,f),g=na(l.appendChild(f),"script"),j&&oa(g),c){k=0;while(f=g[k++])la.test(f.type||"")&&c.push(f)}return l}!function(){var a=d.createDocumentFragment(),b=a.appendChild(d.createElement("div")),c=d.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),o.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",o.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var ra=d.documentElement,sa=/^key/,ta=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ua=/^([^.]*)(?:\.(.+)|)/;function va(){return!0}function wa(){return!1}function xa(){try{return d.activeElement}catch(a){}}function ya(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)ya(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),e===!1)e=wa;else if(!e)return a;return 1===f&&(g=e,e=function(a){return r().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=r.guid++)),a.each(function(){r.event.add(this,b,e,d,c)})}r.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=W.get(a);if(q){c.handler&&(f=c,c=f.handler,e=f.selector),e&&r.find.matchesSelector(ra,e),c.guid||(c.guid=r.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return"undefined"!=typeof r&&r.event.triggered!==b.type?r.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(L)||[""],j=b.length;while(j--)h=ua.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=r.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=r.event.special[n]||{},k=r.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&r.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),r.event.global[n]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=W.hasData(a)&&W.get(a);if(q&&(i=q.events)){b=(b||"").match(L)||[""],j=b.length;while(j--)if(h=ua.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){l=r.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||r.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)r.event.remove(a,n+b[j],c,d,!0);r.isEmptyObject(i)&&W.remove(a,"handle events")}},dispatch:function(a){var b=r.event.fix(a),c,d,e,f,g,h,i=new Array(arguments.length),j=(W.get(this,"events")||{})[b.type]||[],k=r.event.special[b.type]||{};for(i[0]=b,c=1;c<arguments.length;c++)i[c]=arguments[c];if(b.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,b)!==!1){h=r.event.handlers.call(this,b,j),c=0;while((f=h[c++])&&!b.isPropagationStopped()){b.currentTarget=f.elem,d=0;while((g=f.handlers[d++])&&!b.isImmediatePropagationStopped())b.rnamespace&&!b.rnamespace.test(g.namespace)||(b.handleObj=g,b.data=g.data,e=((r.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(b.result=e)===!1&&(b.preventDefault(),b.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,b),b.result}},handlers:function(a,b){var c,d,e,f,g,h=[],i=b.delegateCount,j=a.target;if(i&&j.nodeType&&!("click"===a.type&&a.button>=1))for(;j!==this;j=j.parentNode||this)if(1===j.nodeType&&("click"!==a.type||j.disabled!==!0)){for(f=[],g={},c=0;c<i;c++)d=b[c],e=d.selector+" ",void 0===g[e]&&(g[e]=d.needsContext?r(e,this).index(j)>-1:r.find(e,this,null,[j]).length),g[e]&&f.push(d);f.length&&h.push({elem:j,handlers:f})}return j=this,i<b.length&&h.push({elem:j,handlers:b.slice(i)}),h},addProp:function(a,b){Object.defineProperty(r.Event.prototype,a,{enumerable:!0,configurable:!0,get:r.isFunction(b)?function(){if(this.originalEvent)return b(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[a]},set:function(b){Object.defineProperty(this,a,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(a){return a[r.expando]?a:new r.Event(a)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==xa()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===xa()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&B(this,"input"))return this.click(),!1},_default:function(a){return B(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},r.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},r.Event=function(a,b){return this instanceof r.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?va:wa,this.target=a.target&&3===a.target.nodeType?a.target.parentNode:a.target,this.currentTarget=a.currentTarget,this.relatedTarget=a.relatedTarget):this.type=a,b&&r.extend(this,b),this.timeStamp=a&&a.timeStamp||r.now(),void(this[r.expando]=!0)):new r.Event(a,b)},r.Event.prototype={constructor:r.Event,isDefaultPrevented:wa,isPropagationStopped:wa,isImmediatePropagationStopped:wa,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=va,a&&!this.isSimulated&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=va,a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=va,a&&!this.isSimulated&&a.stopImmediatePropagation(),this.stopPropagation()}},r.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(a){var b=a.button;return null==a.which&&sa.test(a.type)?null!=a.charCode?a.charCode:a.keyCode:!a.which&&void 0!==b&&ta.test(a.type)?1&b?1:2&b?3:4&b?2:0:a.which}},r.event.addProp),r.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){r.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||r.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),r.fn.extend({on:function(a,b,c,d){return ya(this,a,b,c,d)},one:function(a,b,c,d){return ya(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,r(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return b!==!1&&"function"!=typeof b||(c=b,b=void 0),c===!1&&(c=wa),this.each(function(){r.event.remove(this,a,c,b)})}});var za=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Aa=/<script|<style|<link/i,Ba=/checked\s*(?:[^=]|=\s*.checked.)/i,Ca=/^true\/(.*)/,Da=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ea(a,b){return B(a,"table")&&B(11!==b.nodeType?b:b.firstChild,"tr")?r(">tbody",a)[0]||a:a}function Fa(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function Ga(a){var b=Ca.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function Ha(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(W.hasData(a)&&(f=W.access(a),g=W.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;c<d;c++)r.event.add(b,e,j[e][c])}X.hasData(a)&&(h=X.access(a),i=r.extend({},h),X.set(b,i))}}function Ia(a,b){var c=b.nodeName.toLowerCase();"input"===c&&ja.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function Ja(a,b,c,d){b=g.apply([],b);var e,f,h,i,j,k,l=0,m=a.length,n=m-1,q=b[0],s=r.isFunction(q);if(s||m>1&&"string"==typeof q&&!o.checkClone&&Ba.test(q))return a.each(function(e){var f=a.eq(e);s&&(b[0]=q.call(this,e,f.html())),Ja(f,b,c,d)});if(m&&(e=qa(b,a[0].ownerDocument,!1,a,d),f=e.firstChild,1===e.childNodes.length&&(e=f),f||d)){for(h=r.map(na(e,"script"),Fa),i=h.length;l<m;l++)j=e,l!==n&&(j=r.clone(j,!0,!0),i&&r.merge(h,na(j,"script"))),c.call(a[l],j,l);if(i)for(k=h[h.length-1].ownerDocument,r.map(h,Ga),l=0;l<i;l++)j=h[l],la.test(j.type||"")&&!W.access(j,"globalEval")&&r.contains(k,j)&&(j.src?r._evalUrl&&r._evalUrl(j.src):p(j.textContent.replace(Da,""),k))}return a}function Ka(a,b,c){for(var d,e=b?r.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||r.cleanData(na(d)),d.parentNode&&(c&&r.contains(d.ownerDocument,d)&&oa(na(d,"script")),d.parentNode.removeChild(d));return a}r.extend({htmlPrefilter:function(a){return a.replace(za,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=r.contains(a.ownerDocument,a);if(!(o.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||r.isXMLDoc(a)))for(g=na(h),f=na(a),d=0,e=f.length;d<e;d++)Ia(f[d],g[d]);if(b)if(c)for(f=f||na(a),g=g||na(h),d=0,e=f.length;d<e;d++)Ha(f[d],g[d]);else Ha(a,h);return g=na(h,"script"),g.length>0&&oa(g,!i&&na(a,"script")),h},cleanData:function(a){for(var b,c,d,e=r.event.special,f=0;void 0!==(c=a[f]);f++)if(U(c)){if(b=c[W.expando]){if(b.events)for(d in b.events)e[d]?r.event.remove(c,d):r.removeEvent(c,d,b.handle);c[W.expando]=void 0}c[X.expando]&&(c[X.expando]=void 0)}}}),r.fn.extend({detach:function(a){return Ka(this,a,!0)},remove:function(a){return Ka(this,a)},text:function(a){return T(this,function(a){return void 0===a?r.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return Ja(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Ea(this,a);b.appendChild(a)}})},prepend:function(){return Ja(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Ea(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return Ja(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return Ja(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(r.cleanData(na(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return r.clone(this,a,b)})},html:function(a){return T(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Aa.test(a)&&!ma[(ka.exec(a)||["",""])[1].toLowerCase()]){a=r.htmlPrefilter(a);try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(r.cleanData(na(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return Ja(this,arguments,function(b){var c=this.parentNode;r.inArray(this,a)<0&&(r.cleanData(na(this)),c&&c.replaceChild(b,this))},a)}}),r.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){r.fn[a]=function(a){for(var c,d=[],e=r(a),f=e.length-1,g=0;g<=f;g++)c=g===f?this:this.clone(!0),r(e[g])[b](c),h.apply(d,c.get());return this.pushStack(d)}});var La=/^margin/,Ma=new RegExp("^("+aa+")(?!px)[a-z%]+$","i"),Na=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)};!function(){function b(){if(i){i.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",i.innerHTML="",ra.appendChild(h);var b=a.getComputedStyle(i);c="1%"!==b.top,g="2px"===b.marginLeft,e="4px"===b.width,i.style.marginRight="50%",f="4px"===b.marginRight,ra.removeChild(h),i=null}}var c,e,f,g,h=d.createElement("div"),i=d.createElement("div");i.style&&(i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",o.clearCloneStyle="content-box"===i.style.backgroundClip,h.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",h.appendChild(i),r.extend(o,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return b(),e},pixelMarginRight:function(){return b(),f},reliableMarginLeft:function(){return b(),g}}))}();function Oa(a,b,c){var d,e,f,g,h=a.style;return c=c||Na(a),c&&(g=c.getPropertyValue(b)||c[b],""!==g||r.contains(a.ownerDocument,a)||(g=r.style(a,b)),!o.pixelMarginRight()&&Ma.test(g)&&La.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function Pa(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}var Qa=/^(none|table(?!-c[ea]).+)/,Ra=/^--/,Sa={position:"absolute",visibility:"hidden",display:"block"},Ta={letterSpacing:"0",fontWeight:"400"},Ua=["Webkit","Moz","ms"],Va=d.createElement("div").style;function Wa(a){if(a in Va)return a;var b=a[0].toUpperCase()+a.slice(1),c=Ua.length;while(c--)if(a=Ua[c]+b,a in Va)return a}function Xa(a){var b=r.cssProps[a];return b||(b=r.cssProps[a]=Wa(a)||a),b}function Ya(a,b,c){var d=ba.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function Za(a,b,c,d,e){var f,g=0;for(f=c===(d?"border":"content")?4:"width"===b?1:0;f<4;f+=2)"margin"===c&&(g+=r.css(a,c+ca[f],!0,e)),d?("content"===c&&(g-=r.css(a,"padding"+ca[f],!0,e)),"margin"!==c&&(g-=r.css(a,"border"+ca[f]+"Width",!0,e))):(g+=r.css(a,"padding"+ca[f],!0,e),"padding"!==c&&(g+=r.css(a,"border"+ca[f]+"Width",!0,e)));return g}function $a(a,b,c){var d,e=Na(a),f=Oa(a,b,e),g="border-box"===r.css(a,"boxSizing",!1,e);return Ma.test(f)?f:(d=g&&(o.boxSizingReliable()||f===a.style[b]),"auto"===f&&(f=a["offset"+b[0].toUpperCase()+b.slice(1)]),f=parseFloat(f)||0,f+Za(a,b,c||(g?"border":"content"),d,e)+"px")}r.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Oa(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=r.camelCase(b),i=Ra.test(b),j=a.style;return i||(b=Xa(h)),g=r.cssHooks[b]||r.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:j[b]:(f=typeof c,"string"===f&&(e=ba.exec(c))&&e[1]&&(c=fa(a,b,e),f="number"),null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(r.cssNumber[h]?"":"px")),o.clearCloneStyle||""!==c||0!==b.indexOf("background")||(j[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i?j.setProperty(b,c):j[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=r.camelCase(b),i=Ra.test(b);return i||(b=Xa(h)),g=r.cssHooks[b]||r.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=Oa(a,b,d)),"normal"===e&&b in Ta&&(e=Ta[b]),""===c||c?(f=parseFloat(e),c===!0||isFinite(f)?f||0:e):e}}),r.each(["height","width"],function(a,b){r.cssHooks[b]={get:function(a,c,d){if(c)return!Qa.test(r.css(a,"display"))||a.getClientRects().length&&a.getBoundingClientRect().width?$a(a,b,d):ea(a,Sa,function(){return $a(a,b,d)})},set:function(a,c,d){var e,f=d&&Na(a),g=d&&Za(a,b,d,"border-box"===r.css(a,"boxSizing",!1,f),f);return g&&(e=ba.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=r.css(a,b)),Ya(a,c,g)}}}),r.cssHooks.marginLeft=Pa(o.reliableMarginLeft,function(a,b){if(b)return(parseFloat(Oa(a,"marginLeft"))||a.getBoundingClientRect().left-ea(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px"}),r.each({margin:"",padding:"",border:"Width"},function(a,b){r.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+ca[d]+b]=f[d]||f[d-2]||f[0];return e}},La.test(a)||(r.cssHooks[a+b].set=Ya)}),r.fn.extend({css:function(a,b){return T(this,function(a,b,c){var d,e,f={},g=0;if(Array.isArray(b)){for(d=Na(a),e=b.length;g<e;g++)f[b[g]]=r.css(a,b[g],!1,d);return f}return void 0!==c?r.style(a,b,c):r.css(a,b)},a,b,arguments.length>1)}});function _a(a,b,c,d,e){return new _a.prototype.init(a,b,c,d,e)}r.Tween=_a,_a.prototype={constructor:_a,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||r.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(r.cssNumber[c]?"":"px")},cur:function(){var a=_a.propHooks[this.prop];return a&&a.get?a.get(this):_a.propHooks._default.get(this)},run:function(a){var b,c=_a.propHooks[this.prop];return this.options.duration?this.pos=b=r.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):_a.propHooks._default.set(this),this}},_a.prototype.init.prototype=_a.prototype,_a.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=r.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){r.fx.step[a.prop]?r.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[r.cssProps[a.prop]]&&!r.cssHooks[a.prop]?a.elem[a.prop]=a.now:r.style(a.elem,a.prop,a.now+a.unit)}}},_a.propHooks.scrollTop=_a.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},r.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},r.fx=_a.prototype.init,r.fx.step={};var ab,bb,cb=/^(?:toggle|show|hide)$/,db=/queueHooks$/;function eb(){bb&&(d.hidden===!1&&a.requestAnimationFrame?a.requestAnimationFrame(eb):a.setTimeout(eb,r.fx.interval),r.fx.tick())}function fb(){return a.setTimeout(function(){ab=void 0}),ab=r.now()}function gb(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)c=ca[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function hb(a,b,c){for(var d,e=(kb.tweeners[b]||[]).concat(kb.tweeners["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function ib(a,b,c){var d,e,f,g,h,i,j,k,l="width"in b||"height"in b,m=this,n={},o=a.style,p=a.nodeType&&da(a),q=W.get(a,"fxshow");c.queue||(g=r._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,m.always(function(){m.always(function(){g.unqueued--,r.queue(a,"fx").length||g.empty.fire()})}));for(d in b)if(e=b[d],cb.test(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}n[d]=q&&q[d]||r.style(a,d)}if(i=!r.isEmptyObject(b),i||!r.isEmptyObject(n)){l&&1===a.nodeType&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=q&&q.display,null==j&&(j=W.get(a,"display")),k=r.css(a,"display"),"none"===k&&(j?k=j:(ia([a],!0),j=a.style.display||j,k=r.css(a,"display"),ia([a]))),("inline"===k||"inline-block"===k&&null!=j)&&"none"===r.css(a,"float")&&(i||(m.done(function(){o.display=j}),null==j&&(k=o.display,j="none"===k?"":k)),o.display="inline-block")),c.overflow&&(o.overflow="hidden",m.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]})),i=!1;for(d in n)i||(q?"hidden"in q&&(p=q.hidden):q=W.access(a,"fxshow",{display:j}),f&&(q.hidden=!p),p&&ia([a],!0),m.done(function(){p||ia([a]),W.remove(a,"fxshow");for(d in n)r.style(a,d,n[d])})),i=hb(p?q[d]:0,d,m),d in q||(q[d]=i.start,p&&(i.end=i.start,i.start=0))}}function jb(a,b){var c,d,e,f,g;for(c in a)if(d=r.camelCase(c),e=b[d],f=a[c],Array.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=r.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function kb(a,b,c){var d,e,f=0,g=kb.prefilters.length,h=r.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=ab||fb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(i||h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:r.extend({},b),opts:r.extend(!0,{specialEasing:{},easing:r.easing._default},c),originalProperties:b,originalOptions:c,startTime:ab||fb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=r.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(jb(k,j.opts.specialEasing);f<g;f++)if(d=kb.prefilters[f].call(j,a,k,j.opts))return r.isFunction(d.stop)&&(r._queueHooks(j.elem,j.opts.queue).stop=r.proxy(d.stop,d)),d;return r.map(k,hb,j),r.isFunction(j.opts.start)&&j.opts.start.call(a,j),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always),r.fx.timer(r.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j}r.Animation=r.extend(kb,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return fa(c.elem,a,ba.exec(b),c),c}]},tweener:function(a,b){r.isFunction(a)?(b=a,a=["*"]):a=a.match(L);for(var c,d=0,e=a.length;d<e;d++)c=a[d],kb.tweeners[c]=kb.tweeners[c]||[],kb.tweeners[c].unshift(b)},prefilters:[ib],prefilter:function(a,b){b?kb.prefilters.unshift(a):kb.prefilters.push(a)}}),r.speed=function(a,b,c){var d=a&&"object"==typeof a?r.extend({},a):{complete:c||!c&&b||r.isFunction(a)&&a,duration:a,easing:c&&b||b&&!r.isFunction(b)&&b};return r.fx.off?d.duration=0:"number"!=typeof d.duration&&(d.duration in r.fx.speeds?d.duration=r.fx.speeds[d.duration]:d.duration=r.fx.speeds._default),null!=d.queue&&d.queue!==!0||(d.queue="fx"),d.old=d.complete,d.complete=function(){r.isFunction(d.old)&&d.old.call(this),d.queue&&r.dequeue(this,d.queue)},d},r.fn.extend({fadeTo:function(a,b,c,d){return this.filter(da).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=r.isEmptyObject(a),f=r.speed(b,c,d),g=function(){var b=kb(this,r.extend({},a),f);(e||W.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=r.timers,g=W.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&db.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||r.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=W.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=r.timers,g=d?d.length:0;for(c.finish=!0,r.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),r.each(["toggle","show","hide"],function(a,b){var c=r.fn[b];r.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(gb(b,!0),a,d,e)}}),r.each({slideDown:gb("show"),slideUp:gb("hide"),slideToggle:gb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){r.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),r.timers=[],r.fx.tick=function(){var a,b=0,c=r.timers;for(ab=r.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||r.fx.stop(),ab=void 0},r.fx.timer=function(a){r.timers.push(a),r.fx.start()},r.fx.interval=13,r.fx.start=function(){bb||(bb=!0,eb())},r.fx.stop=function(){bb=null},r.fx.speeds={slow:600,fast:200,_default:400},r.fn.delay=function(b,c){return b=r.fx?r.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=d.createElement("input"),b=d.createElement("select"),c=b.appendChild(d.createElement("option"));a.type="checkbox",o.checkOn=""!==a.value,o.optSelected=c.selected,a=d.createElement("input"),a.value="t",a.type="radio",o.radioValue="t"===a.value}();var lb,mb=r.expr.attrHandle;r.fn.extend({attr:function(a,b){return T(this,r.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){r.removeAttr(this,a)})}}),r.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return"undefined"==typeof a.getAttribute?r.prop(a,b,c):(1===f&&r.isXMLDoc(a)||(e=r.attrHooks[b.toLowerCase()]||(r.expr.match.bool.test(b)?lb:void 0)),void 0!==c?null===c?void r.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=r.find.attr(a,b),
null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!o.radioValue&&"radio"===b&&B(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d=0,e=b&&b.match(L);if(e&&1===a.nodeType)while(c=e[d++])a.removeAttribute(c)}}),lb={set:function(a,b,c){return b===!1?r.removeAttr(a,c):a.setAttribute(c,c),c}},r.each(r.expr.match.bool.source.match(/\w+/g),function(a,b){var c=mb[b]||r.find.attr;mb[b]=function(a,b,d){var e,f,g=b.toLowerCase();return d||(f=mb[g],mb[g]=e,e=null!=c(a,b,d)?g:null,mb[g]=f),e}});var nb=/^(?:input|select|textarea|button)$/i,ob=/^(?:a|area)$/i;r.fn.extend({prop:function(a,b){return T(this,r.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[r.propFix[a]||a]})}}),r.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&r.isXMLDoc(a)||(b=r.propFix[b]||b,e=r.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=r.find.attr(a,"tabindex");return b?parseInt(b,10):nb.test(a.nodeName)||ob.test(a.nodeName)&&a.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),o.optSelected||(r.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),r.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){r.propFix[this.toLowerCase()]=this});function pb(a){var b=a.match(L)||[];return b.join(" ")}function qb(a){return a.getAttribute&&a.getAttribute("class")||""}r.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).addClass(a.call(this,b,qb(this)))});if("string"==typeof a&&a){b=a.match(L)||[];while(c=this[i++])if(e=qb(c),d=1===c.nodeType&&" "+pb(e)+" "){g=0;while(f=b[g++])d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=pb(d),e!==h&&c.setAttribute("class",h)}}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).removeClass(a.call(this,b,qb(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a){b=a.match(L)||[];while(c=this[i++])if(e=qb(c),d=1===c.nodeType&&" "+pb(e)+" "){g=0;while(f=b[g++])while(d.indexOf(" "+f+" ")>-1)d=d.replace(" "+f+" "," ");h=pb(d),e!==h&&c.setAttribute("class",h)}}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):r.isFunction(a)?this.each(function(c){r(this).toggleClass(a.call(this,c,qb(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c){d=0,e=r(this),f=a.match(L)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else void 0!==a&&"boolean"!==c||(b=qb(this),b&&W.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||a===!1?"":W.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;b=" "+a+" ";while(c=this[d++])if(1===c.nodeType&&(" "+pb(qb(c))+" ").indexOf(b)>-1)return!0;return!1}});var rb=/\r/g;r.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=r.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,r(this).val()):a,null==e?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=r.map(e,function(a){return null==a?"":a+""})),b=r.valHooks[this.type]||r.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=r.valHooks[e.type]||r.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(rb,""):null==c?"":c)}}}),r.extend({valHooks:{option:{get:function(a){var b=r.find.attr(a,"value");return null!=b?b:pb(r.text(a))}},select:{get:function(a){var b,c,d,e=a.options,f=a.selectedIndex,g="select-one"===a.type,h=g?null:[],i=g?f+1:e.length;for(d=f<0?i:g?f:0;d<i;d++)if(c=e[d],(c.selected||d===f)&&!c.disabled&&(!c.parentNode.disabled||!B(c.parentNode,"optgroup"))){if(b=r(c).val(),g)return b;h.push(b)}return h},set:function(a,b){var c,d,e=a.options,f=r.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=r.inArray(r.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),r.each(["radio","checkbox"],function(){r.valHooks[this]={set:function(a,b){if(Array.isArray(b))return a.checked=r.inArray(r(a).val(),b)>-1}},o.checkOn||(r.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var sb=/^(?:focusinfocus|focusoutblur)$/;r.extend(r.event,{trigger:function(b,c,e,f){var g,h,i,j,k,m,n,o=[e||d],p=l.call(b,"type")?b.type:b,q=l.call(b,"namespace")?b.namespace.split("."):[];if(h=i=e=e||d,3!==e.nodeType&&8!==e.nodeType&&!sb.test(p+r.event.triggered)&&(p.indexOf(".")>-1&&(q=p.split("."),p=q.shift(),q.sort()),k=p.indexOf(":")<0&&"on"+p,b=b[r.expando]?b:new r.Event(p,"object"==typeof b&&b),b.isTrigger=f?2:3,b.namespace=q.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=e),c=null==c?[b]:r.makeArray(c,[b]),n=r.event.special[p]||{},f||!n.trigger||n.trigger.apply(e,c)!==!1)){if(!f&&!n.noBubble&&!r.isWindow(e)){for(j=n.delegateType||p,sb.test(j+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),i=h;i===(e.ownerDocument||d)&&o.push(i.defaultView||i.parentWindow||a)}g=0;while((h=o[g++])&&!b.isPropagationStopped())b.type=g>1?j:n.bindType||p,m=(W.get(h,"events")||{})[b.type]&&W.get(h,"handle"),m&&m.apply(h,c),m=k&&h[k],m&&m.apply&&U(h)&&(b.result=m.apply(h,c),b.result===!1&&b.preventDefault());return b.type=p,f||b.isDefaultPrevented()||n._default&&n._default.apply(o.pop(),c)!==!1||!U(e)||k&&r.isFunction(e[p])&&!r.isWindow(e)&&(i=e[k],i&&(e[k]=null),r.event.triggered=p,e[p](),r.event.triggered=void 0,i&&(e[k]=i)),b.result}},simulate:function(a,b,c){var d=r.extend(new r.Event,c,{type:a,isSimulated:!0});r.event.trigger(d,null,b)}}),r.fn.extend({trigger:function(a,b){return this.each(function(){r.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return r.event.trigger(a,b,c,!0)}}),r.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(a,b){r.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),r.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),o.focusin="onfocusin"in a,o.focusin||r.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){r.event.simulate(b,a.target,r.event.fix(a))};r.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=W.access(d,b);e||d.addEventListener(a,c,!0),W.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=W.access(d,b)-1;e?W.access(d,b,e):(d.removeEventListener(a,c,!0),W.remove(d,b))}}});var tb=a.location,ub=r.now(),vb=/\?/;r.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,"text/xml")}catch(d){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||r.error("Invalid XML: "+b),c};var wb=/\[\]$/,xb=/\r?\n/g,yb=/^(?:submit|button|image|reset|file)$/i,zb=/^(?:input|select|textarea|keygen)/i;function Ab(a,b,c,d){var e;if(Array.isArray(b))r.each(b,function(b,e){c||wb.test(a)?d(a,e):Ab(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==r.type(b))d(a,b);else for(e in b)Ab(a+"["+e+"]",b[e],c,d)}r.param=function(a,b){var c,d=[],e=function(a,b){var c=r.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(null==c?"":c)};if(Array.isArray(a)||a.jquery&&!r.isPlainObject(a))r.each(a,function(){e(this.name,this.value)});else for(c in a)Ab(c,a[c],b,e);return d.join("&")},r.fn.extend({serialize:function(){return r.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=r.prop(this,"elements");return a?r.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!r(this).is(":disabled")&&zb.test(this.nodeName)&&!yb.test(a)&&(this.checked||!ja.test(a))}).map(function(a,b){var c=r(this).val();return null==c?null:Array.isArray(c)?r.map(c,function(a){return{name:b.name,value:a.replace(xb,"\r\n")}}):{name:b.name,value:c.replace(xb,"\r\n")}}).get()}});var Bb=/%20/g,Cb=/#.*$/,Db=/([?&])_=[^&]*/,Eb=/^(.*?):[ \t]*([^\r\n]*)$/gm,Fb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Gb=/^(?:GET|HEAD)$/,Hb=/^\/\//,Ib={},Jb={},Kb="*/".concat("*"),Lb=d.createElement("a");Lb.href=tb.href;function Mb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(L)||[];if(r.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Nb(a,b,c,d){var e={},f=a===Jb;function g(h){var i;return e[h]=!0,r.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Ob(a,b){var c,d,e=r.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&r.extend(!0,a,d),a}function Pb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}if(f)return f!==i[0]&&i.unshift(f),c[f]}function Qb(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}r.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:tb.href,type:"GET",isLocal:Fb.test(tb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Kb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":r.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Ob(Ob(a,r.ajaxSettings),b):Ob(r.ajaxSettings,a)},ajaxPrefilter:Mb(Ib),ajaxTransport:Mb(Jb),ajax:function(b,c){"object"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m,n,o=r.ajaxSetup({},c),p=o.context||o,q=o.context&&(p.nodeType||p.jquery)?r(p):r.event,s=r.Deferred(),t=r.Callbacks("once memory"),u=o.statusCode||{},v={},w={},x="canceled",y={readyState:0,getResponseHeader:function(a){var b;if(k){if(!h){h={};while(b=Eb.exec(g))h[b[1].toLowerCase()]=b[2]}b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return k?g:null},setRequestHeader:function(a,b){return null==k&&(a=w[a.toLowerCase()]=w[a.toLowerCase()]||a,v[a]=b),this},overrideMimeType:function(a){return null==k&&(o.mimeType=a),this},statusCode:function(a){var b;if(a)if(k)y.always(a[y.status]);else for(b in a)u[b]=[u[b],a[b]];return this},abort:function(a){var b=a||x;return e&&e.abort(b),A(0,b),this}};if(s.promise(y),o.url=((b||o.url||tb.href)+"").replace(Hb,tb.protocol+"//"),o.type=c.method||c.type||o.method||o.type,o.dataTypes=(o.dataType||"*").toLowerCase().match(L)||[""],null==o.crossDomain){j=d.createElement("a");try{j.href=o.url,j.href=j.href,o.crossDomain=Lb.protocol+"//"+Lb.host!=j.protocol+"//"+j.host}catch(z){o.crossDomain=!0}}if(o.data&&o.processData&&"string"!=typeof o.data&&(o.data=r.param(o.data,o.traditional)),Nb(Ib,o,c,y),k)return y;l=r.event&&o.global,l&&0===r.active++&&r.event.trigger("ajaxStart"),o.type=o.type.toUpperCase(),o.hasContent=!Gb.test(o.type),f=o.url.replace(Cb,""),o.hasContent?o.data&&o.processData&&0===(o.contentType||"").indexOf("application/x-www-form-urlencoded")&&(o.data=o.data.replace(Bb,"+")):(n=o.url.slice(f.length),o.data&&(f+=(vb.test(f)?"&":"?")+o.data,delete o.data),o.cache===!1&&(f=f.replace(Db,"$1"),n=(vb.test(f)?"&":"?")+"_="+ub++ +n),o.url=f+n),o.ifModified&&(r.lastModified[f]&&y.setRequestHeader("If-Modified-Since",r.lastModified[f]),r.etag[f]&&y.setRequestHeader("If-None-Match",r.etag[f])),(o.data&&o.hasContent&&o.contentType!==!1||c.contentType)&&y.setRequestHeader("Content-Type",o.contentType),y.setRequestHeader("Accept",o.dataTypes[0]&&o.accepts[o.dataTypes[0]]?o.accepts[o.dataTypes[0]]+("*"!==o.dataTypes[0]?", "+Kb+"; q=0.01":""):o.accepts["*"]);for(m in o.headers)y.setRequestHeader(m,o.headers[m]);if(o.beforeSend&&(o.beforeSend.call(p,y,o)===!1||k))return y.abort();if(x="abort",t.add(o.complete),y.done(o.success),y.fail(o.error),e=Nb(Jb,o,c,y)){if(y.readyState=1,l&&q.trigger("ajaxSend",[y,o]),k)return y;o.async&&o.timeout>0&&(i=a.setTimeout(function(){y.abort("timeout")},o.timeout));try{k=!1,e.send(v,A)}catch(z){if(k)throw z;A(-1,z)}}else A(-1,"No Transport");function A(b,c,d,h){var j,m,n,v,w,x=c;k||(k=!0,i&&a.clearTimeout(i),e=void 0,g=h||"",y.readyState=b>0?4:0,j=b>=200&&b<300||304===b,d&&(v=Pb(o,y,d)),v=Qb(o,v,y,j),j?(o.ifModified&&(w=y.getResponseHeader("Last-Modified"),w&&(r.lastModified[f]=w),w=y.getResponseHeader("etag"),w&&(r.etag[f]=w)),204===b||"HEAD"===o.type?x="nocontent":304===b?x="notmodified":(x=v.state,m=v.data,n=v.error,j=!n)):(n=x,!b&&x||(x="error",b<0&&(b=0))),y.status=b,y.statusText=(c||x)+"",j?s.resolveWith(p,[m,x,y]):s.rejectWith(p,[y,x,n]),y.statusCode(u),u=void 0,l&&q.trigger(j?"ajaxSuccess":"ajaxError",[y,o,j?m:n]),t.fireWith(p,[y,x]),l&&(q.trigger("ajaxComplete",[y,o]),--r.active||r.event.trigger("ajaxStop")))}return y},getJSON:function(a,b,c){return r.get(a,b,c,"json")},getScript:function(a,b){return r.get(a,void 0,b,"script")}}),r.each(["get","post"],function(a,b){r[b]=function(a,c,d,e){return r.isFunction(c)&&(e=e||d,d=c,c=void 0),r.ajax(r.extend({url:a,type:b,dataType:e,data:c,success:d},r.isPlainObject(a)&&a))}}),r._evalUrl=function(a){return r.ajax({url:a,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},r.fn.extend({wrapAll:function(a){var b;return this[0]&&(r.isFunction(a)&&(a=a.call(this[0])),b=r(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this},wrapInner:function(a){return r.isFunction(a)?this.each(function(b){r(this).wrapInner(a.call(this,b))}):this.each(function(){var b=r(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=r.isFunction(a);return this.each(function(c){r(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(a){return this.parent(a).not("body").each(function(){r(this).replaceWith(this.childNodes)}),this}}),r.expr.pseudos.hidden=function(a){return!r.expr.pseudos.visible(a)},r.expr.pseudos.visible=function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},r.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(b){}};var Rb={0:200,1223:204},Sb=r.ajaxSettings.xhr();o.cors=!!Sb&&"withCredentials"in Sb,o.ajax=Sb=!!Sb,r.ajaxTransport(function(b){var c,d;if(o.cors||Sb&&!b.crossDomain)return{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Rb[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(b.hasContent&&b.data||null)}catch(i){if(c)throw i}},abort:function(){c&&c()}}}),r.ajaxPrefilter(function(a){a.crossDomain&&(a.contents.script=!1)}),r.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return r.globalEval(a),a}}}),r.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),r.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(e,f){b=r("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&f("error"===a.type?404:200,a.type)}),d.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Tb=[],Ub=/(=)\?(?=&|$)|\?\?/;r.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Tb.pop()||r.expando+"_"+ub++;return this[a]=!0,a}}),r.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Ub.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ub.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=r.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Ub,"$1"+e):b.jsonp!==!1&&(b.url+=(vb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||r.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?r(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Tb.push(e)),g&&r.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),o.createHTMLDocument=function(){var a=d.implementation.createHTMLDocument("").body;return a.innerHTML="<form></form><form></form>",2===a.childNodes.length}(),r.parseHTML=function(a,b,c){if("string"!=typeof a)return[];"boolean"==typeof b&&(c=b,b=!1);var e,f,g;return b||(o.createHTMLDocument?(b=d.implementation.createHTMLDocument(""),e=b.createElement("base"),e.href=d.location.href,b.head.appendChild(e)):b=d),f=C.exec(a),g=!c&&[],f?[b.createElement(f[1])]:(f=qa([a],b,g),g&&g.length&&r(g).remove(),r.merge([],f.childNodes))},r.fn.load=function(a,b,c){var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=pb(a.slice(h)),a=a.slice(0,h)),r.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&r.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?r("<div>").append(r.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},r.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){r.fn[b]=function(a){return this.on(b,a)}}),r.expr.pseudos.animated=function(a){return r.grep(r.timers,function(b){return a===b.elem}).length},r.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=r.css(a,"position"),l=r(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=r.css(a,"top"),i=r.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),r.isFunction(b)&&(b=b.call(a,c,r.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},r.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){r.offset.setOffset(this,a,b)});var b,c,d,e,f=this[0];if(f)return f.getClientRects().length?(d=f.getBoundingClientRect(),b=f.ownerDocument,c=b.documentElement,e=b.defaultView,{top:d.top+e.pageYOffset-c.clientTop,left:d.left+e.pageXOffset-c.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===r.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),B(a[0],"html")||(d=a.offset()),d={top:d.top+r.css(a[0],"borderTopWidth",!0),left:d.left+r.css(a[0],"borderLeftWidth",!0)}),{top:b.top-d.top-r.css(c,"marginTop",!0),left:b.left-d.left-r.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent;while(a&&"static"===r.css(a,"position"))a=a.offsetParent;return a||ra})}}),r.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;r.fn[a]=function(d){return T(this,function(a,d,e){var f;return r.isWindow(a)?f=a:9===a.nodeType&&(f=a.defaultView),void 0===e?f?f[b]:a[d]:void(f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e)},a,d,arguments.length)}}),r.each(["top","left"],function(a,b){r.cssHooks[b]=Pa(o.pixelPosition,function(a,c){if(c)return c=Oa(a,b),Ma.test(c)?r(a).position()[b]+"px":c})}),r.each({Height:"height",Width:"width"},function(a,b){r.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){r.fn[d]=function(e,f){var g=arguments.length&&(c||"boolean"!=typeof e),h=c||(e===!0||f===!0?"margin":"border");return T(this,function(b,c,e){var f;return r.isWindow(b)?0===d.indexOf("outer")?b["inner"+a]:b.document.documentElement["client"+a]:9===b.nodeType?(f=b.documentElement,Math.max(b.body["scroll"+a],f["scroll"+a],b.body["offset"+a],f["offset"+a],f["client"+a])):void 0===e?r.css(b,c,h):r.style(b,c,e,h)},b,g?e:void 0,g)}})}),r.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}}),r.holdReady=function(a){a?r.readyWait++:r.ready(!0)},r.isArray=Array.isArray,r.parseJSON=JSON.parse,r.nodeName=B,"function"==typeof define&&define.amd&&define("jquery",[],function(){return r});var Vb=a.jQuery,Wb=a.$;return r.noConflict=function(b){return a.$===r&&(a.$=Wb),b&&a.jQuery===r&&(a.jQuery=Vb),r},b||(a.jQuery=a.$=r),r});

/*
 AngularJS v1.6.5
 (c) 2010-2017 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(x){'use strict';function pe(a){if(G(a))t(a.objectMaxDepth)&&(Lc.objectMaxDepth=Tb(a.objectMaxDepth)?a.objectMaxDepth:NaN);else return Lc}function Tb(a){return W(a)&&0<a}function K(a,b){b=b||Error;return function(){var d=arguments[0],c;c="["+(a?a+":":"")+d+"] http://errors.angularjs.org/1.6.5/"+(a?a+"/":"")+d;for(d=1;d<arguments.length;d++){c=c+(1==d?"?":"&")+"p"+(d-1)+"=";var e=encodeURIComponent,f;f=arguments[d];f="function"==typeof f?f.toString().replace(/ \{[\s\S]*$/,""):"undefined"==
typeof f?"undefined":"string"!=typeof f?JSON.stringify(f):f;c+=e(f)}return new b(c)}}function oa(a){if(null==a||Za(a))return!1;if(I(a)||C(a)||z&&a instanceof z)return!0;var b="length"in Object(a)&&a.length;return W(b)&&(0<=b&&(b-1 in a||a instanceof Array)||"function"===typeof a.item)}function p(a,b,d){var c,e;if(a)if(E(a))for(c in a)"prototype"!==c&&"length"!==c&&"name"!==c&&a.hasOwnProperty(c)&&b.call(d,a[c],c,a);else if(I(a)||oa(a)){var f="object"!==typeof a;c=0;for(e=a.length;c<e;c++)(f||c in
a)&&b.call(d,a[c],c,a)}else if(a.forEach&&a.forEach!==p)a.forEach(b,d,a);else if(Mc(a))for(c in a)b.call(d,a[c],c,a);else if("function"===typeof a.hasOwnProperty)for(c in a)a.hasOwnProperty(c)&&b.call(d,a[c],c,a);else for(c in a)wa.call(a,c)&&b.call(d,a[c],c,a);return a}function Nc(a,b,d){for(var c=Object.keys(a).sort(),e=0;e<c.length;e++)b.call(d,a[c[e]],c[e]);return c}function Ub(a){return function(b,d){a(d,b)}}function qe(){return++sb}function Vb(a,b,d){for(var c=a.$$hashKey,e=0,f=b.length;e<f;++e){var g=
b[e];if(G(g)||E(g))for(var k=Object.keys(g),h=0,l=k.length;h<l;h++){var m=k[h],n=g[m];d&&G(n)?ia(n)?a[m]=new Date(n.valueOf()):$a(n)?a[m]=new RegExp(n):n.nodeName?a[m]=n.cloneNode(!0):Wb(n)?a[m]=n.clone():(G(a[m])||(a[m]=I(n)?[]:{}),Vb(a[m],[n],!0)):a[m]=n}}c?a.$$hashKey=c:delete a.$$hashKey;return a}function O(a){return Vb(a,xa.call(arguments,1),!1)}function re(a){return Vb(a,xa.call(arguments,1),!0)}function Q(a){return parseInt(a,10)}function Xb(a,b){return O(Object.create(a),b)}function B(){}
function ab(a){return a}function aa(a){return function(){return a}}function Yb(a){return E(a.toString)&&a.toString!==la}function v(a){return"undefined"===typeof a}function t(a){return"undefined"!==typeof a}function G(a){return null!==a&&"object"===typeof a}function Mc(a){return null!==a&&"object"===typeof a&&!Oc(a)}function C(a){return"string"===typeof a}function W(a){return"number"===typeof a}function ia(a){return"[object Date]"===la.call(a)}function Zb(a){switch(la.call(a)){case "[object Error]":return!0;
case "[object Exception]":return!0;case "[object DOMException]":return!0;default:return a instanceof Error}}function E(a){return"function"===typeof a}function $a(a){return"[object RegExp]"===la.call(a)}function Za(a){return a&&a.window===a}function bb(a){return a&&a.$evalAsync&&a.$watch}function La(a){return"boolean"===typeof a}function se(a){return a&&W(a.length)&&te.test(la.call(a))}function Wb(a){return!(!a||!(a.nodeName||a.prop&&a.attr&&a.find))}function ue(a){var b={};a=a.split(",");var d;for(d=
0;d<a.length;d++)b[a[d]]=!0;return b}function ya(a){return N(a.nodeName||a[0]&&a[0].nodeName)}function cb(a,b){var d=a.indexOf(b);0<=d&&a.splice(d,1);return d}function Ia(a,b,d){function c(a,b,c){c--;if(0>c)return"...";var d=b.$$hashKey,g;if(I(a)){g=0;for(var f=a.length;g<f;g++)b.push(e(a[g],c))}else if(Mc(a))for(g in a)b[g]=e(a[g],c);else if(a&&"function"===typeof a.hasOwnProperty)for(g in a)a.hasOwnProperty(g)&&(b[g]=e(a[g],c));else for(g in a)wa.call(a,g)&&(b[g]=e(a[g],c));d?b.$$hashKey=d:delete b.$$hashKey;
return b}function e(a,b){if(!G(a))return a;var d=g.indexOf(a);if(-1!==d)return k[d];if(Za(a)||bb(a))throw za("cpws");var d=!1,e=f(a);void 0===e&&(e=I(a)?[]:Object.create(Oc(a)),d=!0);g.push(a);k.push(e);return d?c(a,e,b):e}function f(a){switch(la.call(a)){case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Float32Array]":case "[object Float64Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return new a.constructor(e(a.buffer),
a.byteOffset,a.length);case "[object ArrayBuffer]":if(!a.slice){var b=new ArrayBuffer(a.byteLength);(new Uint8Array(b)).set(new Uint8Array(a));return b}return a.slice(0);case "[object Boolean]":case "[object Number]":case "[object String]":case "[object Date]":return new a.constructor(a.valueOf());case "[object RegExp]":return b=new RegExp(a.source,a.toString().match(/[^/]*$/)[0]),b.lastIndex=a.lastIndex,b;case "[object Blob]":return new a.constructor([a],{type:a.type})}if(E(a.cloneNode))return a.cloneNode(!0)}
var g=[],k=[];d=Tb(d)?d:NaN;if(b){if(se(b)||"[object ArrayBuffer]"===la.call(b))throw za("cpta");if(a===b)throw za("cpi");I(b)?b.length=0:p(b,function(a,c){"$$hashKey"!==c&&delete b[c]});g.push(a);k.push(b);return c(a,b,d)}return e(a,d)}function $b(a,b){return a===b||a!==a&&b!==b}function sa(a,b){if(a===b)return!0;if(null===a||null===b)return!1;if(a!==a&&b!==b)return!0;var d=typeof a,c;if(d===typeof b&&"object"===d)if(I(a)){if(!I(b))return!1;if((d=a.length)===b.length){for(c=0;c<d;c++)if(!sa(a[c],
b[c]))return!1;return!0}}else{if(ia(a))return ia(b)?$b(a.getTime(),b.getTime()):!1;if($a(a))return $a(b)?a.toString()===b.toString():!1;if(bb(a)||bb(b)||Za(a)||Za(b)||I(b)||ia(b)||$a(b))return!1;d=R();for(c in a)if("$"!==c.charAt(0)&&!E(a[c])){if(!sa(a[c],b[c]))return!1;d[c]=!0}for(c in b)if(!(c in d)&&"$"!==c.charAt(0)&&t(b[c])&&!E(b[c]))return!1;return!0}return!1}function db(a,b,d){return a.concat(xa.call(b,d))}function Qa(a,b){var d=2<arguments.length?xa.call(arguments,2):[];return!E(b)||b instanceof
RegExp?b:d.length?function(){return arguments.length?b.apply(a,db(d,arguments,0)):b.apply(a,d)}:function(){return arguments.length?b.apply(a,arguments):b.call(a)}}function Pc(a,b){var d=b;"string"===typeof a&&"$"===a.charAt(0)&&"$"===a.charAt(1)?d=void 0:Za(b)?d="$WINDOW":b&&x.document===b?d="$DOCUMENT":bb(b)&&(d="$SCOPE");return d}function eb(a,b){if(!v(a))return W(b)||(b=b?2:null),JSON.stringify(a,Pc,b)}function Qc(a){return C(a)?JSON.parse(a):a}function Rc(a,b){a=a.replace(ve,"");var d=Date.parse("Jan 01, 1970 00:00:00 "+
a)/6E4;return ba(d)?b:d}function ac(a,b,d){d=d?-1:1;var c=a.getTimezoneOffset();b=Rc(b,c);d*=b-c;a=new Date(a.getTime());a.setMinutes(a.getMinutes()+d);return a}function Aa(a){a=z(a).clone().empty();var b=z("<div>").append(a).html();try{return a[0].nodeType===Ma?N(b):b.match(/^(<[^>]+>)/)[1].replace(/^<([\w-]+)/,function(a,b){return"<"+N(b)})}catch(d){return N(b)}}function Sc(a){try{return decodeURIComponent(a)}catch(b){}}function Tc(a){var b={};p((a||"").split("&"),function(a){var c,e,f;a&&(e=a=
a.replace(/\+/g,"%20"),c=a.indexOf("="),-1!==c&&(e=a.substring(0,c),f=a.substring(c+1)),e=Sc(e),t(e)&&(f=t(f)?Sc(f):!0,wa.call(b,e)?I(b[e])?b[e].push(f):b[e]=[b[e],f]:b[e]=f))});return b}function bc(a){var b=[];p(a,function(a,c){I(a)?p(a,function(a){b.push(ma(c,!0)+(!0===a?"":"="+ma(a,!0)))}):b.push(ma(c,!0)+(!0===a?"":"="+ma(a,!0)))});return b.length?b.join("&"):""}function fb(a){return ma(a,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function ma(a,b){return encodeURIComponent(a).replace(/%40/gi,
"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,b?"%20":"+")}function we(a,b){var d,c,e=Na.length;for(c=0;c<e;++c)if(d=Na[c]+b,C(d=a.getAttribute(d)))return d;return null}function xe(a,b){var d,c,e={};p(Na,function(b){b+="app";!d&&a.hasAttribute&&a.hasAttribute(b)&&(d=a,c=a.getAttribute(b))});p(Na,function(b){b+="app";var e;!d&&(e=a.querySelector("["+b.replace(":","\\:")+"]"))&&(d=e,c=e.getAttribute(b))});d&&(ye?(e.strictDi=null!==we(d,"strict-di"),
b(d,c?[c]:[],e)):x.console.error("Angular: disabling automatic bootstrap. <script> protocol indicates an extension, document.location.href does not match."))}function Uc(a,b,d){G(d)||(d={});d=O({strictDi:!1},d);var c=function(){a=z(a);if(a.injector()){var c=a[0]===x.document?"document":Aa(a);throw za("btstrpd",c.replace(/</,"&lt;").replace(/>/,"&gt;"));}b=b||[];b.unshift(["$provide",function(b){b.value("$rootElement",a)}]);d.debugInfoEnabled&&b.push(["$compileProvider",function(a){a.debugInfoEnabled(!0)}]);
b.unshift("ng");c=gb(b,d.strictDi);c.invoke(["$rootScope","$rootElement","$compile","$injector",function(a,b,c,d){a.$apply(function(){b.data("$injector",d);c(b)(a)})}]);return c},e=/^NG_ENABLE_DEBUG_INFO!/,f=/^NG_DEFER_BOOTSTRAP!/;x&&e.test(x.name)&&(d.debugInfoEnabled=!0,x.name=x.name.replace(e,""));if(x&&!f.test(x.name))return c();x.name=x.name.replace(f,"");fa.resumeBootstrap=function(a){p(a,function(a){b.push(a)});return c()};E(fa.resumeDeferredBootstrap)&&fa.resumeDeferredBootstrap()}function ze(){x.name=
"NG_ENABLE_DEBUG_INFO!"+x.name;x.location.reload()}function Ae(a){a=fa.element(a).injector();if(!a)throw za("test");return a.get("$$testability")}function Vc(a,b){b=b||"_";return a.replace(Be,function(a,c){return(c?b:"")+a.toLowerCase()})}function Ce(){var a;if(!Wc){var b=tb();(ta=v(b)?x.jQuery:b?x[b]:void 0)&&ta.fn.on?(z=ta,O(ta.fn,{scope:Ra.scope,isolateScope:Ra.isolateScope,controller:Ra.controller,injector:Ra.injector,inheritedData:Ra.inheritedData}),a=ta.cleanData,ta.cleanData=function(b){for(var c,
e=0,f;null!=(f=b[e]);e++)(c=ta._data(f,"events"))&&c.$destroy&&ta(f).triggerHandler("$destroy");a(b)}):z=S;fa.element=z;Wc=!0}}function hb(a,b,d){if(!a)throw za("areq",b||"?",d||"required");return a}function ub(a,b,d){d&&I(a)&&(a=a[a.length-1]);hb(E(a),b,"not a function, got "+(a&&"object"===typeof a?a.constructor.name||"Object":typeof a));return a}function Oa(a,b){if("hasOwnProperty"===a)throw za("badname",b);}function Xc(a,b,d){if(!b)return a;b=b.split(".");for(var c,e=a,f=b.length,g=0;g<f;g++)c=
b[g],a&&(a=(e=a)[c]);return!d&&E(a)?Qa(e,a):a}function vb(a){for(var b=a[0],d=a[a.length-1],c,e=1;b!==d&&(b=b.nextSibling);e++)if(c||a[e]!==b)c||(c=z(xa.call(a,0,e))),c.push(b);return c||a}function R(){return Object.create(null)}function cc(a){if(null==a)return"";switch(typeof a){case "string":break;case "number":a=""+a;break;default:a=!Yb(a)||I(a)||ia(a)?eb(a):a.toString()}return a}function De(a){function b(a,b,c){return a[b]||(a[b]=c())}var d=K("$injector"),c=K("ng");a=b(a,"angular",Object);a.$$minErr=
a.$$minErr||K;return b(a,"module",function(){var a={};return function(f,g,k){var h={};if("hasOwnProperty"===f)throw c("badname","module");g&&a.hasOwnProperty(f)&&(a[f]=null);return b(a,f,function(){function a(b,c,d,g){g||(g=e);return function(){g[d||"push"]([b,c,arguments]);return p}}function b(a,c,d){d||(d=e);return function(b,e){e&&E(e)&&(e.$$moduleName=f);d.push([a,c,arguments]);return p}}if(!g)throw d("nomod",f);var e=[],q=[],F=[],M=a("$injector","invoke","push",q),p={_invokeQueue:e,_configBlocks:q,
_runBlocks:F,info:function(a){if(t(a)){if(!G(a))throw c("aobj","value");h=a;return this}return h},requires:g,name:f,provider:b("$provide","provider"),factory:b("$provide","factory"),service:b("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),decorator:b("$provide","decorator",q),animation:b("$animateProvider","register"),filter:b("$filterProvider","register"),controller:b("$controllerProvider","register"),directive:b("$compileProvider","directive"),component:b("$compileProvider",
"component"),config:M,run:function(a){F.push(a);return this}};k&&M(k);return p})}})}function ra(a,b){if(I(a)){b=b||[];for(var d=0,c=a.length;d<c;d++)b[d]=a[d]}else if(G(a))for(d in b=b||{},a)if("$"!==d.charAt(0)||"$"!==d.charAt(1))b[d]=a[d];return b||a}function Ee(a,b){var d=[];Tb(b)&&(a=fa.copy(a,null,b));return JSON.stringify(a,function(a,b){b=Pc(a,b);if(G(b)){if(0<=d.indexOf(b))return"...";d.push(b)}return b})}function Fe(a){O(a,{errorHandlingConfig:pe,bootstrap:Uc,copy:Ia,extend:O,merge:re,equals:sa,
element:z,forEach:p,injector:gb,noop:B,bind:Qa,toJson:eb,fromJson:Qc,identity:ab,isUndefined:v,isDefined:t,isString:C,isFunction:E,isObject:G,isNumber:W,isElement:Wb,isArray:I,version:Ge,isDate:ia,lowercase:N,uppercase:wb,callbacks:{$$counter:0},getTestability:Ae,reloadWithDebugInfo:ze,$$minErr:K,$$csp:Ja,$$encodeUriSegment:fb,$$encodeUriQuery:ma,$$stringify:cc});dc=De(x);dc("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:He});a.provider("$compile",Yc).directive({a:Ie,input:Zc,
textarea:Zc,form:Je,script:Ke,select:Le,option:Me,ngBind:Ne,ngBindHtml:Oe,ngBindTemplate:Pe,ngClass:Qe,ngClassEven:Re,ngClassOdd:Se,ngCloak:Te,ngController:Ue,ngForm:Ve,ngHide:We,ngIf:Xe,ngInclude:Ye,ngInit:Ze,ngNonBindable:$e,ngPluralize:af,ngRepeat:bf,ngShow:cf,ngStyle:df,ngSwitch:ef,ngSwitchWhen:ff,ngSwitchDefault:gf,ngOptions:hf,ngTransclude:jf,ngModel:kf,ngList:lf,ngChange:mf,pattern:$c,ngPattern:$c,required:ad,ngRequired:ad,minlength:bd,ngMinlength:bd,maxlength:cd,ngMaxlength:cd,ngValue:nf,
ngModelOptions:of}).directive({ngInclude:pf}).directive(xb).directive(dd);a.provider({$anchorScroll:qf,$animate:rf,$animateCss:sf,$$animateJs:tf,$$animateQueue:uf,$$AnimateRunner:vf,$$animateAsyncRun:wf,$browser:xf,$cacheFactory:yf,$controller:zf,$document:Af,$$isDocumentHidden:Bf,$exceptionHandler:Cf,$filter:ed,$$forceReflow:Df,$interpolate:Ef,$interval:Ff,$http:Gf,$httpParamSerializer:Hf,$httpParamSerializerJQLike:If,$httpBackend:Jf,$xhrFactory:Kf,$jsonpCallbacks:Lf,$location:Mf,$log:Nf,$parse:Of,
$rootScope:Pf,$q:Qf,$$q:Rf,$sce:Sf,$sceDelegate:Tf,$sniffer:Uf,$templateCache:Vf,$templateRequest:Wf,$$testability:Xf,$timeout:Yf,$window:Zf,$$rAF:$f,$$jqLite:ag,$$Map:bg,$$cookieReader:cg})}]).info({angularVersion:"1.6.5"})}function ib(a,b){return b.toUpperCase()}function yb(a){return a.replace(dg,ib)}function ec(a){a=a.nodeType;return 1===a||!a||9===a}function fd(a,b){var d,c,e=b.createDocumentFragment(),f=[];if(fc.test(a)){d=e.appendChild(b.createElement("div"));c=(eg.exec(a)||["",""])[1].toLowerCase();
c=pa[c]||pa._default;d.innerHTML=c[1]+a.replace(fg,"<$1></$2>")+c[2];for(c=c[0];c--;)d=d.lastChild;f=db(f,d.childNodes);d=e.firstChild;d.textContent=""}else f.push(b.createTextNode(a));e.textContent="";e.innerHTML="";p(f,function(a){e.appendChild(a)});return e}function S(a){if(a instanceof S)return a;var b;C(a)&&(a=P(a),b=!0);if(!(this instanceof S)){if(b&&"<"!==a.charAt(0))throw gc("nosel");return new S(a)}if(b){b=x.document;var d;a=(d=gg.exec(a))?[b.createElement(d[1])]:(d=fd(a,b))?d.childNodes:
[];hc(this,a)}else E(a)?gd(a):hc(this,a)}function ic(a){return a.cloneNode(!0)}function zb(a,b){!b&&ec(a)&&z.cleanData([a]);a.querySelectorAll&&z.cleanData(a.querySelectorAll("*"))}function hd(a,b,d,c){if(t(c))throw gc("offargs");var e=(c=Ab(a))&&c.events,f=c&&c.handle;if(f)if(b){var g=function(b){var c=e[b];t(d)&&cb(c||[],d);t(d)&&c&&0<c.length||(a.removeEventListener(b,f),delete e[b])};p(b.split(" "),function(a){g(a);Bb[a]&&g(Bb[a])})}else for(b in e)"$destroy"!==b&&a.removeEventListener(b,f),delete e[b]}
function jc(a,b){var d=a.ng339,c=d&&jb[d];c&&(b?delete c.data[b]:(c.handle&&(c.events.$destroy&&c.handle({},"$destroy"),hd(a)),delete jb[d],a.ng339=void 0))}function Ab(a,b){var d=a.ng339,d=d&&jb[d];b&&!d&&(a.ng339=d=++hg,d=jb[d]={events:{},data:{},handle:void 0});return d}function kc(a,b,d){if(ec(a)){var c,e=t(d),f=!e&&b&&!G(b),g=!b;a=(a=Ab(a,!f))&&a.data;if(e)a[yb(b)]=d;else{if(g)return a;if(f)return a&&a[yb(b)];for(c in b)a[yb(c)]=b[c]}}}function Cb(a,b){return a.getAttribute?-1<(" "+(a.getAttribute("class")||
"")+" ").replace(/[\n\t]/g," ").indexOf(" "+b+" "):!1}function Db(a,b){b&&a.setAttribute&&p(b.split(" "),function(b){a.setAttribute("class",P((" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+P(b)+" "," ")))})}function Eb(a,b){if(b&&a.setAttribute){var d=(" "+(a.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");p(b.split(" "),function(a){a=P(a);-1===d.indexOf(" "+a+" ")&&(d+=a+" ")});a.setAttribute("class",P(d))}}function hc(a,b){if(b)if(b.nodeType)a[a.length++]=b;else{var d=
b.length;if("number"===typeof d&&b.window!==b){if(d)for(var c=0;c<d;c++)a[a.length++]=b[c]}else a[a.length++]=b}}function id(a,b){return Fb(a,"$"+(b||"ngController")+"Controller")}function Fb(a,b,d){9===a.nodeType&&(a=a.documentElement);for(b=I(b)?b:[b];a;){for(var c=0,e=b.length;c<e;c++)if(t(d=z.data(a,b[c])))return d;a=a.parentNode||11===a.nodeType&&a.host}}function jd(a){for(zb(a,!0);a.firstChild;)a.removeChild(a.firstChild)}function Gb(a,b){b||zb(a);var d=a.parentNode;d&&d.removeChild(a)}function ig(a,
b){b=b||x;if("complete"===b.document.readyState)b.setTimeout(a);else z(b).on("load",a)}function gd(a){function b(){x.document.removeEventListener("DOMContentLoaded",b);x.removeEventListener("load",b);a()}"complete"===x.document.readyState?x.setTimeout(a):(x.document.addEventListener("DOMContentLoaded",b),x.addEventListener("load",b))}function kd(a,b){var d=Hb[b.toLowerCase()];return d&&ld[ya(a)]&&d}function jg(a,b){var d=function(c,d){c.isDefaultPrevented=function(){return c.defaultPrevented};var f=
b[d||c.type],g=f?f.length:0;if(g){if(v(c.immediatePropagationStopped)){var k=c.stopImmediatePropagation;c.stopImmediatePropagation=function(){c.immediatePropagationStopped=!0;c.stopPropagation&&c.stopPropagation();k&&k.call(c)}}c.isImmediatePropagationStopped=function(){return!0===c.immediatePropagationStopped};var h=f.specialHandlerWrapper||kg;1<g&&(f=ra(f));for(var l=0;l<g;l++)c.isImmediatePropagationStopped()||h(a,c,f[l])}};d.elem=a;return d}function kg(a,b,d){d.call(a,b)}function lg(a,b,d){var c=
b.relatedTarget;c&&(c===a||mg.call(a,c))||d.call(a,b)}function ag(){this.$get=function(){return O(S,{hasClass:function(a,b){a.attr&&(a=a[0]);return Cb(a,b)},addClass:function(a,b){a.attr&&(a=a[0]);return Eb(a,b)},removeClass:function(a,b){a.attr&&(a=a[0]);return Db(a,b)}})}}function Sa(a,b){var d=a&&a.$$hashKey;if(d)return"function"===typeof d&&(d=a.$$hashKey()),d;d=typeof a;return d="function"===d||"object"===d&&null!==a?a.$$hashKey=d+":"+(b||qe)():d+":"+a}function md(){this._keys=[];this._values=
[];this._lastKey=NaN;this._lastIndex=-1}function nd(a){a=Function.prototype.toString.call(a).replace(ng,"");return a.match(og)||a.match(pg)}function qg(a){return(a=nd(a))?"function("+(a[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function gb(a,b){function d(a){return function(b,c){if(G(b))p(b,Ub(a));else return a(b,c)}}function c(a,b){Oa(a,"service");if(E(b)||I(b))b=q.instantiate(b);if(!b.$get)throw Ka("pget",a);return n[a+"Provider"]=b}function e(a,b){return function(){var c=w.invoke(b,this);if(v(c))throw Ka("undef",
a);return c}}function f(a,b,d){return c(a,{$get:!1!==d?e(a,b):b})}function g(a){hb(v(a)||I(a),"modulesToLoad","not an array");var b=[],c;p(a,function(a){function d(a){var b,c;b=0;for(c=a.length;b<c;b++){var e=a[b],g=q.get(e[0]);g[e[1]].apply(g,e[2])}}if(!m.get(a)){m.set(a,!0);try{C(a)?(c=dc(a),w.modules[a]=c,b=b.concat(g(c.requires)).concat(c._runBlocks),d(c._invokeQueue),d(c._configBlocks)):E(a)?b.push(q.invoke(a)):I(a)?b.push(q.invoke(a)):ub(a,"module")}catch(e){throw I(a)&&(a=a[a.length-1]),e.message&&
e.stack&&-1===e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),Ka("modulerr",a,e.stack||e.message||e);}}});return b}function k(a,c){function d(b,e){if(a.hasOwnProperty(b)){if(a[b]===h)throw Ka("cdep",b+" <- "+l.join(" <- "));return a[b]}try{return l.unshift(b),a[b]=h,a[b]=c(b,e),a[b]}catch(g){throw a[b]===h&&delete a[b],g;}finally{l.shift()}}function e(a,c,g){var f=[];a=gb.$$annotate(a,b,g);for(var h=0,k=a.length;h<k;h++){var l=a[h];if("string"!==typeof l)throw Ka("itkn",l);f.push(c&&c.hasOwnProperty(l)?
c[l]:d(l,g))}return f}return{invoke:function(a,b,c,d){"string"===typeof c&&(d=c,c=null);c=e(a,c,d);I(a)&&(a=a[a.length-1]);d=a;if(Ba||"function"!==typeof d)d=!1;else{var g=d.$$ngIsClass;La(g)||(g=d.$$ngIsClass=/^(?:class\b|constructor\()/.test(Function.prototype.toString.call(d)));d=g}return d?(c.unshift(null),new (Function.prototype.bind.apply(a,c))):a.apply(b,c)},instantiate:function(a,b,c){var d=I(a)?a[a.length-1]:a;a=e(a,b,c);a.unshift(null);return new (Function.prototype.bind.apply(d,a))},get:d,
annotate:gb.$$annotate,has:function(b){return n.hasOwnProperty(b+"Provider")||a.hasOwnProperty(b)}}}b=!0===b;var h={},l=[],m=new Ib,n={$provide:{provider:d(c),factory:d(f),service:d(function(a,b){return f(a,["$injector",function(a){return a.instantiate(b)}])}),value:d(function(a,b){return f(a,aa(b),!1)}),constant:d(function(a,b){Oa(a,"constant");n[a]=b;F[a]=b}),decorator:function(a,b){var c=q.get(a+"Provider"),d=c.$get;c.$get=function(){var a=w.invoke(d,c);return w.invoke(b,null,{$delegate:a})}}}},
q=n.$injector=k(n,function(a,b){fa.isString(b)&&l.push(b);throw Ka("unpr",l.join(" <- "));}),F={},M=k(F,function(a,b){var c=q.get(a+"Provider",b);return w.invoke(c.$get,c,void 0,a)}),w=M;n.$injectorProvider={$get:aa(M)};w.modules=q.modules=R();var u=g(a),w=M.get("$injector");w.strictDi=b;p(u,function(a){a&&w.invoke(a)});return w}function qf(){var a=!0;this.disableAutoScrolling=function(){a=!1};this.$get=["$window","$location","$rootScope",function(b,d,c){function e(a){var b=null;Array.prototype.some.call(a,
function(a){if("a"===ya(a))return b=a,!0});return b}function f(a){if(a){a.scrollIntoView();var c;c=g.yOffset;E(c)?c=c():Wb(c)?(c=c[0],c="fixed"!==b.getComputedStyle(c).position?0:c.getBoundingClientRect().bottom):W(c)||(c=0);c&&(a=a.getBoundingClientRect().top,b.scrollBy(0,a-c))}else b.scrollTo(0,0)}function g(a){a=C(a)?a:W(a)?a.toString():d.hash();var b;a?(b=k.getElementById(a))?f(b):(b=e(k.getElementsByName(a)))?f(b):"top"===a&&f(null):f(null)}var k=b.document;a&&c.$watch(function(){return d.hash()},
function(a,b){a===b&&""===a||ig(function(){c.$evalAsync(g)})});return g}]}function kb(a,b){if(!a&&!b)return"";if(!a)return b;if(!b)return a;I(a)&&(a=a.join(" "));I(b)&&(b=b.join(" "));return a+" "+b}function rg(a){C(a)&&(a=a.split(" "));var b=R();p(a,function(a){a.length&&(b[a]=!0)});return b}function Ca(a){return G(a)?a:{}}function sg(a,b,d,c){function e(a){try{a.apply(null,xa.call(arguments,1))}finally{if(M--,0===M)for(;w.length;)try{w.pop()()}catch(b){d.error(b)}}}function f(){y=null;k()}function g(){u=
D();u=v(u)?null:u;sa(u,L)&&(u=L);A=L=u}function k(){var a=A;g();if(na!==h.url()||a!==u)na=h.url(),A=u,p(H,function(a){a(h.url(),u)})}var h=this,l=a.location,m=a.history,n=a.setTimeout,q=a.clearTimeout,F={};h.isMock=!1;var M=0,w=[];h.$$completeOutstandingRequest=e;h.$$incOutstandingRequestCount=function(){M++};h.notifyWhenNoOutstandingRequests=function(a){0===M?a():w.push(a)};var u,A,na=l.href,s=b.find("base"),y=null,D=c.history?function(){try{return m.state}catch(a){}}:B;g();h.url=function(b,d,e){v(e)&&
(e=null);l!==a.location&&(l=a.location);m!==a.history&&(m=a.history);if(b){var f=A===e;if(na===b&&(!c.history||f))return h;var k=na&&ja(na)===ja(b);na=b;A=e;!c.history||k&&f?(k||(y=b),d?l.replace(b):k?(d=l,e=b.indexOf("#"),e=-1===e?"":b.substr(e),d.hash=e):l.href=b,l.href!==b&&(y=b)):(m[d?"replaceState":"pushState"](e,"",b),g());y&&(y=b);return h}return y||l.href.replace(/%27/g,"'")};h.state=function(){return u};var H=[],Z=!1,L=null;h.onUrlChange=function(b){if(!Z){if(c.history)z(a).on("popstate",
f);z(a).on("hashchange",f);Z=!0}H.push(b);return b};h.$$applicationDestroyed=function(){z(a).off("hashchange popstate",f)};h.$$checkUrlChange=k;h.baseHref=function(){var a=s.attr("href");return a?a.replace(/^(https?:)?\/\/[^/]*/,""):""};h.defer=function(a,b){var c;M++;c=n(function(){delete F[c];e(a)},b||0);F[c]=!0;return c};h.defer.cancel=function(a){return F[a]?(delete F[a],q(a),e(B),!0):!1}}function xf(){this.$get=["$window","$log","$sniffer","$document",function(a,b,d,c){return new sg(a,c,b,d)}]}
function yf(){this.$get=function(){function a(a,c){function e(a){a!==n&&(q?q===a&&(q=a.n):q=a,f(a.n,a.p),f(a,n),n=a,n.n=null)}function f(a,b){a!==b&&(a&&(a.p=b),b&&(b.n=a))}if(a in b)throw K("$cacheFactory")("iid",a);var g=0,k=O({},c,{id:a}),h=R(),l=c&&c.capacity||Number.MAX_VALUE,m=R(),n=null,q=null;return b[a]={put:function(a,b){if(!v(b)){if(l<Number.MAX_VALUE){var c=m[a]||(m[a]={key:a});e(c)}a in h||g++;h[a]=b;g>l&&this.remove(q.key);return b}},get:function(a){if(l<Number.MAX_VALUE){var b=m[a];
if(!b)return;e(b)}return h[a]},remove:function(a){if(l<Number.MAX_VALUE){var b=m[a];if(!b)return;b===n&&(n=b.p);b===q&&(q=b.n);f(b.n,b.p);delete m[a]}a in h&&(delete h[a],g--)},removeAll:function(){h=R();g=0;m=R();n=q=null},destroy:function(){m=k=h=null;delete b[a]},info:function(){return O({},k,{size:g})}}}var b={};a.info=function(){var a={};p(b,function(b,e){a[e]=b.info()});return a};a.get=function(a){return b[a]};return a}}function Vf(){this.$get=["$cacheFactory",function(a){return a("templates")}]}
function Yc(a,b){function d(a,b,c){var d=/^\s*([@&<]|=(\*?))(\??)\s*([\w$]*)\s*$/,e=R();p(a,function(a,g){if(a in n)e[g]=n[a];else{var f=a.match(d);if(!f)throw ga("iscp",b,g,a,c?"controller bindings definition":"isolate scope definition");e[g]={mode:f[1][0],collection:"*"===f[2],optional:"?"===f[3],attrName:f[4]||g};f[4]&&(n[a]=e[g])}});return e}function c(a){var b=a.charAt(0);if(!b||b!==N(b))throw ga("baddir",a);if(a!==a.trim())throw ga("baddir",a);}function e(a){var b=a.require||a.controller&&a.name;
!I(b)&&G(b)&&p(b,function(a,c){var d=a.match(l);a.substring(d[0].length)||(b[c]=d[0]+c)});return b}var f={},g=/^\s*directive:\s*([\w-]+)\s+(.*)$/,k=/(([\w-]+)(?::([^;]+))?;?)/,h=ue("ngSrc,ngSrcset,src,srcset"),l=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,m=/^(on[a-z]+|formaction)$/,n=R();this.directive=function na(b,d){hb(b,"name");Oa(b,"directive");C(b)?(c(b),hb(d,"directiveFactory"),f.hasOwnProperty(b)||(f[b]=[],a.factory(b+"Directive",["$injector","$exceptionHandler",function(a,c){var d=[];p(f[b],function(g,
f){try{var h=a.invoke(g);E(h)?h={compile:aa(h)}:!h.compile&&h.link&&(h.compile=aa(h.link));h.priority=h.priority||0;h.index=f;h.name=h.name||b;h.require=e(h);var k=h,l=h.restrict;if(l&&(!C(l)||!/[EACM]/.test(l)))throw ga("badrestrict",l,b);k.restrict=l||"EA";h.$$moduleName=g.$$moduleName;d.push(h)}catch(m){c(m)}});return d}])),f[b].push(d)):p(b,Ub(na));return this};this.component=function s(a,b){function c(a){function e(b){return E(b)||I(b)?function(c,d){return a.invoke(b,this,{$element:c,$attrs:d})}:
b}var g=b.template||b.templateUrl?b.template:"",f={controller:d,controllerAs:tg(b.controller)||b.controllerAs||"$ctrl",template:e(g),templateUrl:e(b.templateUrl),transclude:b.transclude,scope:{},bindToController:b.bindings||{},restrict:"E",require:b.require};p(b,function(a,b){"$"===b.charAt(0)&&(f[b]=a)});return f}if(!C(a))return p(a,Ub(Qa(this,s))),this;var d=b.controller||function(){};p(b,function(a,b){"$"===b.charAt(0)&&(c[b]=a,E(d)&&(d[b]=a))});c.$inject=["$injector"];return this.directive(a,
c)};this.aHrefSanitizationWhitelist=function(a){return t(a)?(b.aHrefSanitizationWhitelist(a),this):b.aHrefSanitizationWhitelist()};this.imgSrcSanitizationWhitelist=function(a){return t(a)?(b.imgSrcSanitizationWhitelist(a),this):b.imgSrcSanitizationWhitelist()};var q=!0;this.debugInfoEnabled=function(a){return t(a)?(q=a,this):q};var F=!1;this.preAssignBindingsEnabled=function(a){return t(a)?(F=a,this):F};var M=10;this.onChangesTtl=function(a){return arguments.length?(M=a,this):M};var w=!0;this.commentDirectivesEnabled=
function(a){return arguments.length?(w=a,this):w};var u=!0;this.cssClassDirectivesEnabled=function(a){return arguments.length?(u=a,this):u};this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function(a,b,c,e,n,L,T,J,U,Y){function r(){try{if(!--Ca)throw ja=void 0,ga("infchng",M);T.$apply(function(){for(var a=[],b=0,c=ja.length;b<c;++b)try{ja[b]()}catch(d){a.push(d)}ja=void 0;if(a.length)throw a;})}finally{Ca++}}
function ca(a,b){if(b){var c=Object.keys(b),d,e,g;d=0;for(e=c.length;d<e;d++)g=c[d],this[g]=b[g]}else this.$attr={};this.$$element=a}function Ta(a,b,c){za.innerHTML="<span "+b+">";b=za.firstChild.attributes;var d=b[0];b.removeNamedItem(d.name);d.value=c;a.attributes.setNamedItem(d)}function Da(a,b){try{a.addClass(b)}catch(c){}}function da(a,b,c,d,e){a instanceof z||(a=z(a));var g=K(a,b,a,c,d,e);da.$$addScopeClass(a);var f=null;return function(b,c,d){if(!a)throw ga("multilink");hb(b,"scope");e&&e.needsNewScope&&
(b=b.$parent.$new());d=d||{};var h=d.parentBoundTranscludeFn,k=d.transcludeControllers;d=d.futureParentElement;h&&h.$$boundTransclude&&(h=h.$$boundTransclude);f||(f=(d=d&&d[0])?"foreignobject"!==ya(d)&&la.call(d).match(/SVG/)?"svg":"html":"html");d="html"!==f?z(ka(f,z("<div>").append(a).html())):c?Ra.clone.call(a):a;if(k)for(var l in k)d.data("$"+l+"Controller",k[l].instance);da.$$addScopeInfo(d,b);c&&c(d,b);g&&g(b,d,d,h);c||(a=g=null);return d}}function K(a,b,c,d,e,g){function f(a,c,d,e){var g,k,
l,m,q,n,D;if(H)for(D=Array(c.length),m=0;m<h.length;m+=3)g=h[m],D[g]=c[g];else D=c;m=0;for(q=h.length;m<q;)k=D[h[m++]],c=h[m++],g=h[m++],c?(c.scope?(l=a.$new(),da.$$addScopeInfo(z(k),l)):l=a,n=c.transcludeOnThisElement?V(a,c.transclude,e):!c.templateOnThisElement&&e?e:!e&&b?V(a,b):null,c(g,l,k,d,n)):g&&g(a,k.childNodes,void 0,e)}for(var h=[],k=I(a)||a instanceof z,l,m,q,n,H,D=0;D<a.length;D++){l=new ca;11===Ba&&lb(a,D,k);m=mc(a[D],[],l,0===D?d:void 0,e);(g=m.length?X(m,a[D],l,b,c,null,[],[],g):null)&&
g.scope&&da.$$addScopeClass(l.$$element);l=g&&g.terminal||!(q=a[D].childNodes)||!q.length?null:K(q,g?(g.transcludeOnThisElement||!g.templateOnThisElement)&&g.transclude:b);if(g||l)h.push(D,g,l),n=!0,H=H||g;g=null}return n?f:null}function lb(a,b,c){var d=a[b],e=d.parentNode,g;if(d.nodeType===Ma)for(;;){g=e?d.nextSibling:a[b+1];if(!g||g.nodeType!==Ma)break;d.nodeValue+=g.nodeValue;g.parentNode&&g.parentNode.removeChild(g);c&&g===a[b+1]&&a.splice(b+1,1)}}function V(a,b,c){function d(e,g,f,h,k){e||(e=
a.$new(!1,k),e.$$transcluded=!0);return b(e,g,{parentBoundTranscludeFn:c,transcludeControllers:f,futureParentElement:h})}var e=d.$$slots=R(),g;for(g in b.$$slots)e[g]=b.$$slots[g]?V(a,b.$$slots[g],c):null;return d}function mc(a,b,c,d,e){var g=c.$attr,f;switch(a.nodeType){case 1:f=ya(a);Q(b,Ea(f),"E",d,e);for(var h,l,m,q,n=a.attributes,H=0,D=n&&n.length;H<D;H++){var F=!1,u=!1;h=n[H];l=h.name;m=h.value;h=Ea(l);(q=Na.test(h))&&(l=l.replace(od,"").substr(8).replace(/_(.)/g,function(a,b){return b.toUpperCase()}));
(h=h.match(Oa))&&ba(h[1])&&(F=l,u=l.substr(0,l.length-5)+"end",l=l.substr(0,l.length-6));h=Ea(l.toLowerCase());g[h]=l;if(q||!c.hasOwnProperty(h))c[h]=m,kd(a,h)&&(c[h]=!0);va(a,b,m,h,q);Q(b,h,"A",d,e,F,u)}"input"===f&&"hidden"===a.getAttribute("type")&&a.setAttribute("autocomplete","off");if(!Ka)break;g=a.className;G(g)&&(g=g.animVal);if(C(g)&&""!==g)for(;a=k.exec(g);)h=Ea(a[2]),Q(b,h,"C",d,e)&&(c[h]=P(a[3])),g=g.substr(a.index+a[0].length);break;case Ma:pa(b,a.nodeValue);break;case 8:if(!Ja)break;
nc(a,b,c,d,e)}b.sort(ma);return b}function nc(a,b,c,d,e){try{var f=g.exec(a.nodeValue);if(f){var h=Ea(f[1]);Q(b,h,"M",d,e)&&(c[h]=P(f[2]))}}catch(k){}}function pd(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw ga("uterdir",b,c);1===a.nodeType&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&e--);d.push(a);a=a.nextSibling}while(0<e)}else d.push(a);return z(d)}function qd(a,b,c){return function(d,e,g,f,h){e=pd(e[0],b,c);return a(d,e,g,f,h)}}function S(a,b,c,d,e,g){var f;return a?
da(b,c,d,e,g):function(){f||(f=da(b,c,d,e,g),b=c=g=null);return f.apply(this,arguments)}}function X(a,b,d,e,g,f,h,k,l){function m(a,b,c,d){if(a){c&&(a=qd(a,c,d));a.require=s.require;a.directiveName=Y;if(L===s||s.$$isolateScope)a=ta(a,{isolateScope:!0});h.push(a)}if(b){c&&(b=qd(b,c,d));b.require=s.require;b.directiveName=Y;if(L===s||s.$$isolateScope)b=ta(b,{isolateScope:!0});k.push(b)}}function q(a,e,g,f,l){function m(a,b,c,d){var e;bb(a)||(d=c,c=b,b=a,a=void 0);U&&(e=T);c||(c=U?ha.parent():ha);if(d){var g=
l.$$slots[d];if(g)return g(a,b,e,c,t);if(v(g))throw ga("noslot",d,Aa(ha));}else return l(a,b,e,c,t)}var n,s,J,y,Z,T,w,ha;b===g?(f=d,ha=d.$$element):(ha=z(g),f=new ca(ha,d));Z=e;L?y=e.$new(!0):H&&(Z=e.$parent);l&&(w=m,w.$$boundTransclude=l,w.isSlotFilled=function(a){return!!l.$$slots[a]});u&&(T=ea(ha,f,w,u,y,e,L));L&&(da.$$addScopeInfo(ha,y,!0,!(M&&(M===L||M===L.$$originalDirective))),da.$$addScopeClass(ha,!0),y.$$isolateBindings=L.$$isolateBindings,s=qa(e,f,y,y.$$isolateBindings,L),s.removeWatches&&
y.$on("$destroy",s.removeWatches));for(n in T){s=u[n];J=T[n];var Y=s.$$bindings.bindToController;if(F){J.bindingInfo=Y?qa(Z,f,J.instance,Y,s):{};var r=J();r!==J.instance&&(J.instance=r,ha.data("$"+s.name+"Controller",r),J.bindingInfo.removeWatches&&J.bindingInfo.removeWatches(),J.bindingInfo=qa(Z,f,J.instance,Y,s))}else J.instance=J(),ha.data("$"+s.name+"Controller",J.instance),J.bindingInfo=qa(Z,f,J.instance,Y,s)}p(u,function(a,b){var c=a.require;a.bindToController&&!I(c)&&G(c)&&O(T[b].instance,
W(b,c,ha,T))});p(T,function(a){var b=a.instance;if(E(b.$onChanges))try{b.$onChanges(a.bindingInfo.initialChanges)}catch(d){c(d)}if(E(b.$onInit))try{b.$onInit()}catch(e){c(e)}E(b.$doCheck)&&(Z.$watch(function(){b.$doCheck()}),b.$doCheck());E(b.$onDestroy)&&Z.$on("$destroy",function(){b.$onDestroy()})});n=0;for(s=h.length;n<s;n++)J=h[n],ua(J,J.isolateScope?y:e,ha,f,J.require&&W(J.directiveName,J.require,ha,T),w);var t=e;L&&(L.template||null===L.templateUrl)&&(t=y);a&&a(t,g.childNodes,void 0,l);for(n=
k.length-1;0<=n;n--)J=k[n],ua(J,J.isolateScope?y:e,ha,f,J.require&&W(J.directiveName,J.require,ha,T),w);p(T,function(a){a=a.instance;E(a.$postLink)&&a.$postLink()})}l=l||{};for(var n=-Number.MAX_VALUE,H=l.newScopeDirective,u=l.controllerDirectives,L=l.newIsolateScopeDirective,M=l.templateDirective,J=l.nonTlbTranscludeDirective,Z=!1,T=!1,U=l.hasElementTranscludeDirective,y=d.$$element=z(b),s,Y,w,r=e,t,Pa=!1,Ta=!1,V,x=0,Da=a.length;x<Da;x++){s=a[x];var B=s.$$start,C=s.$$end;B&&(y=pd(b,B,C));w=void 0;
if(n>s.priority)break;if(V=s.scope)s.templateUrl||(G(V)?(aa("new/isolated scope",L||H,s,y),L=s):aa("new/isolated scope",L,s,y)),H=H||s;Y=s.name;if(!Pa&&(s.replace&&(s.templateUrl||s.template)||s.transclude&&!s.$$tlb)){for(V=x+1;Pa=a[V++];)if(Pa.transclude&&!Pa.$$tlb||Pa.replace&&(Pa.templateUrl||Pa.template)){Ta=!0;break}Pa=!0}!s.templateUrl&&s.controller&&(u=u||R(),aa("'"+Y+"' controller",u[Y],s,y),u[Y]=s);if(V=s.transclude)if(Z=!0,s.$$tlb||(aa("transclusion",J,s,y),J=s),"element"===V)U=!0,n=s.priority,
w=y,y=d.$$element=z(da.$$createComment(Y,d[Y])),b=y[0],oa(g,xa.call(w,0),b),w[0].$$parentNode=w[0].parentNode,r=S(Ta,w,e,n,f&&f.name,{nonTlbTranscludeDirective:J});else{var K=R();if(G(V)){w=[];var N=R(),lb=R();p(V,function(a,b){var c="?"===a.charAt(0);a=c?a.substring(1):a;N[a]=b;K[b]=null;lb[b]=c});p(y.contents(),function(a){var b=N[Ea(ya(a))];b?(lb[b]=!0,K[b]=K[b]||[],K[b].push(a)):w.push(a)});p(lb,function(a,b){if(!a)throw ga("reqslot",b);});for(var lc in K)K[lc]&&(K[lc]=S(Ta,K[lc],e))}else w=z(ic(b)).contents();
y.empty();r=S(Ta,w,e,void 0,void 0,{needsNewScope:s.$$isolateScope||s.$$newScope});r.$$slots=K}if(s.template)if(T=!0,aa("template",M,s,y),M=s,V=E(s.template)?s.template(y,d):s.template,V=Ha(V),s.replace){f=s;w=fc.test(V)?rd(ka(s.templateNamespace,P(V))):[];b=w[0];if(1!==w.length||1!==b.nodeType)throw ga("tplrt",Y,"");oa(g,y,b);Da={$attr:{}};V=mc(b,[],Da);var nc=a.splice(x+1,a.length-(x+1));(L||H)&&$(V,L,H);a=a.concat(V).concat(nc);fa(d,Da);Da=a.length}else y.html(V);if(s.templateUrl)T=!0,aa("template",
M,s,y),M=s,s.replace&&(f=s),q=ia(a.splice(x,a.length-x),y,d,g,Z&&r,h,k,{controllerDirectives:u,newScopeDirective:H!==s&&H,newIsolateScopeDirective:L,templateDirective:M,nonTlbTranscludeDirective:J}),Da=a.length;else if(s.compile)try{t=s.compile(y,d,r);var Q=s.$$originalDirective||s;E(t)?m(null,Qa(Q,t),B,C):t&&m(Qa(Q,t.pre),Qa(Q,t.post),B,C)}catch(ba){c(ba,Aa(y))}s.terminal&&(q.terminal=!0,n=Math.max(n,s.priority))}q.scope=H&&!0===H.scope;q.transcludeOnThisElement=Z;q.templateOnThisElement=T;q.transclude=
r;l.hasElementTranscludeDirective=U;return q}function W(a,b,c,d){var e;if(C(b)){var g=b.match(l);b=b.substring(g[0].length);var f=g[1]||g[3],g="?"===g[2];"^^"===f?c=c.parent():e=(e=d&&d[b])&&e.instance;if(!e){var h="$"+b+"Controller";e=f?c.inheritedData(h):c.data(h)}if(!e&&!g)throw ga("ctreq",b,a);}else if(I(b))for(e=[],f=0,g=b.length;f<g;f++)e[f]=W(a,b[f],c,d);else G(b)&&(e={},p(b,function(b,g){e[g]=W(a,b,c,d)}));return e||null}function ea(a,b,c,d,e,g,f){var h=R(),k;for(k in d){var l=d[k],m={$scope:l===
f||l.$$isolateScope?e:g,$element:a,$attrs:b,$transclude:c},n=l.controller;"@"===n&&(n=b[l.name]);m=L(n,m,!0,l.controllerAs);h[l.name]=m;a.data("$"+l.name+"Controller",m.instance)}return h}function $(a,b,c){for(var d=0,e=a.length;d<e;d++)a[d]=Xb(a[d],{$$isolateScope:b,$$newScope:c})}function Q(b,c,e,g,h,k,l){if(c===h)return null;var m=null;if(f.hasOwnProperty(c)){h=a.get(c+"Directive");for(var n=0,q=h.length;n<q;n++)if(c=h[n],(v(g)||g>c.priority)&&-1!==c.restrict.indexOf(e)){k&&(c=Xb(c,{$$start:k,
$$end:l}));if(!c.$$bindings){var H=m=c,D=c.name,F={isolateScope:null,bindToController:null};G(H.scope)&&(!0===H.bindToController?(F.bindToController=d(H.scope,D,!0),F.isolateScope={}):F.isolateScope=d(H.scope,D,!1));G(H.bindToController)&&(F.bindToController=d(H.bindToController,D,!0));if(F.bindToController&&!H.controller)throw ga("noctrl",D);m=m.$$bindings=F;G(m.isolateScope)&&(c.$$isolateBindings=m.isolateScope)}b.push(c);m=c}}return m}function ba(b){if(f.hasOwnProperty(b))for(var c=a.get(b+"Directive"),
d=0,e=c.length;d<e;d++)if(b=c[d],b.multiElement)return!0;return!1}function fa(a,b){var c=b.$attr,d=a.$attr;p(a,function(d,e){"$"!==e.charAt(0)&&(b[e]&&b[e]!==d&&(d=d.length?d+(("style"===e?";":" ")+b[e]):b[e]),a.$set(e,d,!0,c[e]))});p(b,function(b,e){a.hasOwnProperty(e)||"$"===e.charAt(0)||(a[e]=b,"class"!==e&&"style"!==e&&(d[e]=c[e]))})}function ia(a,b,d,g,f,h,k,l){var m=[],n,q,F=b[0],s=a.shift(),L=Xb(s,{templateUrl:null,transclude:null,replace:null,$$originalDirective:s}),J=E(s.templateUrl)?s.templateUrl(b,
d):s.templateUrl,u=s.templateNamespace;b.empty();e(J).then(function(c){var e,H;c=Ha(c);if(s.replace){c=fc.test(c)?rd(ka(u,P(c))):[];e=c[0];if(1!==c.length||1!==e.nodeType)throw ga("tplrt",s.name,J);c={$attr:{}};oa(g,b,e);var D=mc(e,[],c);G(s.scope)&&$(D,!0);a=D.concat(a);fa(d,c)}else e=F,b.html(c);a.unshift(L);n=X(a,e,d,f,b,s,h,k,l);p(g,function(a,c){a===e&&(g[c]=b[0])});for(q=K(b[0].childNodes,f);m.length;){c=m.shift();H=m.shift();var y=m.shift(),M=m.shift(),D=b[0];if(!c.$$destroyed){if(H!==F){var Z=
H.className;l.hasElementTranscludeDirective&&s.replace||(D=ic(e));oa(y,z(H),D);Da(z(D),Z)}H=n.transcludeOnThisElement?V(c,n.transclude,M):M;n(q,c,D,g,H)}}m=null}).catch(function(a){Zb(a)&&c(a)});return function(a,b,c,d,e){a=e;b.$$destroyed||(m?m.push(b,c,d,a):(n.transcludeOnThisElement&&(a=V(b,n.transclude,e)),n(q,b,c,d,a)))}}function ma(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function aa(a,b,c,d){function e(a){return a?" (module: "+a+")":
""}if(b)throw ga("multidir",b.name,e(b.$$moduleName),c.name,e(c.$$moduleName),a,Aa(d));}function pa(a,c){var d=b(c,!0);d&&a.push({priority:0,compile:function(a){a=a.parent();var b=!!a.length;b&&da.$$addBindingClass(a);return function(a,c){var e=c.parent();b||da.$$addBindingClass(e);da.$$addBindingInfo(e,d.expressions);a.$watch(d,function(a){c[0].nodeValue=a})}}})}function ka(a,b){a=N(a||"html");switch(a){case "svg":case "math":var c=x.document.createElement("div");c.innerHTML="<"+a+">"+b+"</"+a+">";
return c.childNodes[0].childNodes;default:return b}}function ra(a,b){if("srcdoc"===b)return J.HTML;var c=ya(a);if("src"===b||"ngSrc"===b){if(-1===["img","video","audio","source","track"].indexOf(c))return J.RESOURCE_URL}else if("xlinkHref"===b||"form"===c&&"action"===b||"link"===c&&"href"===b)return J.RESOURCE_URL}function va(a,c,d,e,g){var f=ra(a,e),k=h[e]||g,l=b(d,!g,f,k);if(l){if("multiple"===e&&"select"===ya(a))throw ga("selmulti",Aa(a));if(m.test(e))throw ga("nodomevents");c.push({priority:100,
compile:function(){return{pre:function(a,c,g){c=g.$$observers||(g.$$observers=R());var h=g[e];h!==d&&(l=h&&b(h,!0,f,k),d=h);l&&(g[e]=l(a),(c[e]||(c[e]=[])).$$inter=!0,(g.$$observers&&g.$$observers[e].$$scope||a).$watch(l,function(a,b){"class"===e&&a!==b?g.$updateClass(a,b):g.$set(e,a)}))}}}})}}function oa(a,b,c){var d=b[0],e=b.length,g=d.parentNode,f,h;if(a)for(f=0,h=a.length;f<h;f++)if(a[f]===d){a[f++]=c;h=f+e-1;for(var k=a.length;f<k;f++,h++)h<k?a[f]=a[h]:delete a[f];a.length-=e-1;a.context===d&&
(a.context=c);break}g&&g.replaceChild(c,d);a=x.document.createDocumentFragment();for(f=0;f<e;f++)a.appendChild(b[f]);z.hasData(d)&&(z.data(c,z.data(d)),z(d).off("$destroy"));z.cleanData(a.querySelectorAll("*"));for(f=1;f<e;f++)delete b[f];b[0]=c;b.length=1}function ta(a,b){return O(function(){return a.apply(null,arguments)},a,b)}function ua(a,b,d,e,g,f){try{a(b,d,e,g,f)}catch(h){c(h,Aa(d))}}function qa(a,c,d,e,g){function f(b,c,e){E(d.$onChanges)&&!$b(c,e)&&(ja||(a.$$postDigest(r),ja=[]),m||(m={},
ja.push(h)),m[b]&&(e=m[b].previousValue),m[b]=new Jb(e,c))}function h(){d.$onChanges(m);m=void 0}var k=[],l={},m;p(e,function(e,h){var m=e.attrName,q=e.optional,H,D,F,s;switch(e.mode){case "@":q||wa.call(c,m)||(d[h]=c[m]=void 0);q=c.$observe(m,function(a){if(C(a)||La(a))f(h,a,d[h]),d[h]=a});c.$$observers[m].$$scope=a;H=c[m];C(H)?d[h]=b(H)(a):La(H)&&(d[h]=H);l[h]=new Jb(oc,d[h]);k.push(q);break;case "=":if(!wa.call(c,m)){if(q)break;c[m]=void 0}if(q&&!c[m])break;D=n(c[m]);s=D.literal?sa:$b;F=D.assign||
function(){H=d[h]=D(a);throw ga("nonassign",c[m],m,g.name);};H=d[h]=D(a);q=function(b){s(b,d[h])||(s(b,H)?F(a,b=d[h]):d[h]=b);return H=b};q.$stateful=!0;q=e.collection?a.$watchCollection(c[m],q):a.$watch(n(c[m],q),null,D.literal);k.push(q);break;case "<":if(!wa.call(c,m)){if(q)break;c[m]=void 0}if(q&&!c[m])break;D=n(c[m]);var L=D.literal,J=d[h]=D(a);l[h]=new Jb(oc,d[h]);q=a.$watch(D,function(a,b){if(b===a){if(b===J||L&&sa(b,J))return;b=J}f(h,a,b);d[h]=a},L);k.push(q);break;case "&":D=c.hasOwnProperty(m)?
n(c[m]):B;if(D===B&&q)break;d[h]=function(b){return D(a,b)}}});return{initialChanges:l,removeWatches:k.length&&function(){for(var a=0,b=k.length;a<b;++a)k[a]()}}}var Ia=/^\w/,za=x.document.createElement("div"),Ja=w,Ka=u,Ca=M,ja;ca.prototype={$normalize:Ea,$addClass:function(a){a&&0<a.length&&U.addClass(this.$$element,a)},$removeClass:function(a){a&&0<a.length&&U.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=sd(a,b);c&&c.length&&U.addClass(this.$$element,c);(c=sd(b,a))&&c.length&&
U.removeClass(this.$$element,c)},$set:function(a,b,d,e){var g=kd(this.$$element[0],a),f=td[a],h=a;g?(this.$$element.prop(a,b),e=g):f&&(this[f]=b,h=f);this[a]=b;e?this.$attr[a]=e:(e=this.$attr[a])||(this.$attr[a]=e=Vc(a,"-"));g=ya(this.$$element);if("a"===g&&("href"===a||"xlinkHref"===a)||"img"===g&&"src"===a)this[a]=b=Y(b,"src"===a);else if("img"===g&&"srcset"===a&&t(b)){for(var g="",f=P(b),k=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,k=/\s/.test(f)?k:/(,)/,f=f.split(k),k=Math.floor(f.length/2),l=0;l<
k;l++)var m=2*l,g=g+Y(P(f[m]),!0),g=g+(" "+P(f[m+1]));f=P(f[2*l]).split(/\s/);g+=Y(P(f[0]),!0);2===f.length&&(g+=" "+P(f[1]));this[a]=b=g}!1!==d&&(null===b||v(b)?this.$$element.removeAttr(e):Ia.test(e)?this.$$element.attr(e,b):Ta(this.$$element[0],e,b));(a=this.$$observers)&&p(a[h],function(a){try{a(b)}catch(d){c(d)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers=R()),e=d[a]||(d[a]=[]);e.push(b);T.$evalAsync(function(){e.$$inter||!c.hasOwnProperty(a)||v(c[a])||b(c[a])});return function(){cb(e,
b)}}};var Fa=b.startSymbol(),Ga=b.endSymbol(),Ha="{{"===Fa&&"}}"===Ga?ab:function(a){return a.replace(/\{\{/g,Fa).replace(/}}/g,Ga)},Na=/^ngAttr[A-Z]/,Oa=/^(.+)Start$/;da.$$addBindingInfo=q?function(a,b){var c=a.data("$binding")||[];I(b)?c=c.concat(b):c.push(b);a.data("$binding",c)}:B;da.$$addBindingClass=q?function(a){Da(a,"ng-binding")}:B;da.$$addScopeInfo=q?function(a,b,c,d){a.data(c?d?"$isolateScopeNoTemplate":"$isolateScope":"$scope",b)}:B;da.$$addScopeClass=q?function(a,b){Da(a,b?"ng-isolate-scope":
"ng-scope")}:B;da.$$createComment=function(a,b){var c="";q&&(c=" "+(a||"")+": ",b&&(c+=b+" "));return x.document.createComment(c)};return da}]}function Jb(a,b){this.previousValue=a;this.currentValue=b}function Ea(a){return a.replace(od,"").replace(ug,ib)}function sd(a,b){var d="",c=a.split(/\s+/),e=b.split(/\s+/),f=0;a:for(;f<c.length;f++){for(var g=c[f],k=0;k<e.length;k++)if(g===e[k])continue a;d+=(0<d.length?" ":"")+g}return d}function rd(a){a=z(a);var b=a.length;if(1>=b)return a;for(;b--;){var d=
a[b];(8===d.nodeType||d.nodeType===Ma&&""===d.nodeValue.trim())&&vg.call(a,b,1)}return a}function tg(a,b){if(b&&C(b))return b;if(C(a)){var d=ud.exec(a);if(d)return d[3]}}function zf(){var a={},b=!1;this.has=function(b){return a.hasOwnProperty(b)};this.register=function(b,c){Oa(b,"controller");G(b)?O(a,b):a[b]=c};this.allowGlobals=function(){b=!0};this.$get=["$injector","$window",function(d,c){function e(a,b,c,d){if(!a||!G(a.$scope))throw K("$controller")("noscp",d,b);a.$scope[b]=c}return function(f,
g,k,h){var l,m,n;k=!0===k;h&&C(h)&&(n=h);if(C(f)){h=f.match(ud);if(!h)throw vd("ctrlfmt",f);m=h[1];n=n||h[3];f=a.hasOwnProperty(m)?a[m]:Xc(g.$scope,m,!0)||(b?Xc(c,m,!0):void 0);if(!f)throw vd("ctrlreg",m);ub(f,m,!0)}if(k)return k=(I(f)?f[f.length-1]:f).prototype,l=Object.create(k||null),n&&e(g,n,l,m||f.name),O(function(){var a=d.invoke(f,l,g,m);a!==l&&(G(a)||E(a))&&(l=a,n&&e(g,n,l,m||f.name));return l},{instance:l,identifier:n});l=d.instantiate(f,g,m);n&&e(g,n,l,m||f.name);return l}}]}function Af(){this.$get=
["$window",function(a){return z(a.document)}]}function Bf(){this.$get=["$document","$rootScope",function(a,b){function d(){e=c.hidden}var c=a[0],e=c&&c.hidden;a.on("visibilitychange",d);b.$on("$destroy",function(){a.off("visibilitychange",d)});return function(){return e}}]}function Cf(){this.$get=["$log",function(a){return function(b,d){a.error.apply(a,arguments)}}]}function pc(a){return G(a)?ia(a)?a.toISOString():eb(a):a}function Hf(){this.$get=function(){return function(a){if(!a)return"";var b=
[];Nc(a,function(a,c){null===a||v(a)||(I(a)?p(a,function(a){b.push(ma(c)+"="+ma(pc(a)))}):b.push(ma(c)+"="+ma(pc(a))))});return b.join("&")}}}function If(){this.$get=function(){return function(a){function b(a,e,f){null===a||v(a)||(I(a)?p(a,function(a,c){b(a,e+"["+(G(a)?c:"")+"]")}):G(a)&&!ia(a)?Nc(a,function(a,c){b(a,e+(f?"":"[")+c+(f?"":"]"))}):d.push(ma(e)+"="+ma(pc(a))))}if(!a)return"";var d=[];b(a,"",!0);return d.join("&")}}}function qc(a,b){if(C(a)){var d=a.replace(wg,"").trim();if(d){var c=
b("Content-Type");(c=c&&0===c.indexOf(wd))||(c=(c=d.match(xg))&&yg[c[0]].test(d));if(c)try{a=Qc(d)}catch(e){throw rc("baddata",a,e);}}}return a}function xd(a){var b=R(),d;C(a)?p(a.split("\n"),function(a){d=a.indexOf(":");var e=N(P(a.substr(0,d)));a=P(a.substr(d+1));e&&(b[e]=b[e]?b[e]+", "+a:a)}):G(a)&&p(a,function(a,d){var f=N(d),g=P(a);f&&(b[f]=b[f]?b[f]+", "+g:g)});return b}function yd(a){var b;return function(d){b||(b=xd(a));return d?(d=b[N(d)],void 0===d&&(d=null),d):b}}function zd(a,b,d,c){if(E(c))return c(a,
b,d);p(c,function(c){a=c(a,b,d)});return a}function Gf(){var a=this.defaults={transformResponse:[qc],transformRequest:[function(a){return G(a)&&"[object File]"!==la.call(a)&&"[object Blob]"!==la.call(a)&&"[object FormData]"!==la.call(a)?eb(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:ra(sc),put:ra(sc),patch:ra(sc)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer",jsonpCallbackParam:"callback"},b=!1;this.useApplyAsync=function(a){return t(a)?
(b=!!a,this):b};var d=this.interceptors=[];this.$get=["$browser","$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector","$sce",function(c,e,f,g,k,h,l,m){function n(b){function d(a,b){for(var c=0,e=b.length;c<e;){var g=b[c++],f=b[c++];a=a.then(g,f)}b.length=0;return a}function e(a,b){var c,d={};p(a,function(a,e){E(a)?(c=a(b),null!=c&&(d[e]=c)):d[e]=a});return d}function g(a){var b=O({},a);b.data=zd(a.data,a.headers,a.status,f.transformResponse);a=a.status;return 200<=a&&300>
a?b:h.reject(b)}if(!G(b))throw K("$http")("badreq",b);if(!C(m.valueOf(b.url)))throw K("$http")("badreq",b.url);var f=O({method:"get",transformRequest:a.transformRequest,transformResponse:a.transformResponse,paramSerializer:a.paramSerializer,jsonpCallbackParam:a.jsonpCallbackParam},b);f.headers=function(b){var c=a.headers,d=O({},b.headers),g,f,h,c=O({},c.common,c[N(b.method)]);a:for(g in c){f=N(g);for(h in d)if(N(h)===f)continue a;d[g]=c[g]}return e(d,ra(b))}(b);f.method=wb(f.method);f.paramSerializer=
C(f.paramSerializer)?l.get(f.paramSerializer):f.paramSerializer;c.$$incOutstandingRequestCount();var k=[],n=[];b=h.resolve(f);p(u,function(a){(a.request||a.requestError)&&k.unshift(a.request,a.requestError);(a.response||a.responseError)&&n.push(a.response,a.responseError)});b=d(b,k);b=b.then(function(b){var c=b.headers,d=zd(b.data,yd(c),void 0,b.transformRequest);v(d)&&p(c,function(a,b){"content-type"===N(b)&&delete c[b]});v(b.withCredentials)&&!v(a.withCredentials)&&(b.withCredentials=a.withCredentials);
return q(b,d).then(g,g)});b=d(b,n);return b=b.finally(function(){c.$$completeOutstandingRequest(B)})}function q(c,d){function g(a){if(a){var c={};p(a,function(a,d){c[d]=function(c){function d(){a(c)}b?k.$applyAsync(d):k.$$phase?d():k.$apply(d)}});return c}}function l(a,c,d,e){function g(){q(c,a,d,e)}J&&(200<=a&&300>a?J.put(ca,[a,c,xd(d),e]):J.remove(ca));b?k.$applyAsync(g):(g(),k.$$phase||k.$apply())}function q(a,b,d,e){b=-1<=b?b:0;(200<=b&&300>b?L.resolve:L.reject)({data:a,status:b,headers:yd(d),
config:c,statusText:e})}function H(a){q(a.data,a.status,ra(a.headers()),a.statusText)}function u(){var a=n.pendingRequests.indexOf(c);-1!==a&&n.pendingRequests.splice(a,1)}var L=h.defer(),T=L.promise,J,U,Y=c.headers,r="jsonp"===N(c.method),ca=c.url;r?ca=m.getTrustedResourceUrl(ca):C(ca)||(ca=m.valueOf(ca));ca=F(ca,c.paramSerializer(c.params));r&&(ca=M(ca,c.jsonpCallbackParam));n.pendingRequests.push(c);T.then(u,u);!c.cache&&!a.cache||!1===c.cache||"GET"!==c.method&&"JSONP"!==c.method||(J=G(c.cache)?
c.cache:G(a.cache)?a.cache:w);J&&(U=J.get(ca),t(U)?U&&E(U.then)?U.then(H,H):I(U)?q(U[1],U[0],ra(U[2]),U[3]):q(U,200,{},"OK"):J.put(ca,T));v(U)&&((U=Ad(c.url)?f()[c.xsrfCookieName||a.xsrfCookieName]:void 0)&&(Y[c.xsrfHeaderName||a.xsrfHeaderName]=U),e(c.method,ca,d,l,Y,c.timeout,c.withCredentials,c.responseType,g(c.eventHandlers),g(c.uploadEventHandlers)));return T}function F(a,b){0<b.length&&(a+=(-1===a.indexOf("?")?"?":"&")+b);return a}function M(a,b){if(/[&?][^=]+=JSON_CALLBACK/.test(a))throw rc("badjsonp",
a);if((new RegExp("[&?]"+b+"=")).test(a))throw rc("badjsonp",b,a);return a+=(-1===a.indexOf("?")?"?":"&")+b+"=JSON_CALLBACK"}var w=g("$http");a.paramSerializer=C(a.paramSerializer)?l.get(a.paramSerializer):a.paramSerializer;var u=[];p(d,function(a){u.unshift(C(a)?l.get(a):l.invoke(a))});n.pendingRequests=[];(function(a){p(arguments,function(a){n[a]=function(b,c){return n(O({},c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){p(arguments,function(a){n[a]=function(b,c,d){return n(O({},
d||{},{method:a,url:b,data:c}))}})})("post","put","patch");n.defaults=a;return n}]}function Kf(){this.$get=function(){return function(){return new x.XMLHttpRequest}}}function Jf(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function(a,b,d,c){return zg(a,c,a.defer,b,d[0])}]}function zg(a,b,d,c,e){function f(a,b,d){a=a.replace("JSON_CALLBACK",b);var f=e.createElement("script"),m=null;f.type="text/javascript";f.src=a;f.async=!0;m=function(a){f.removeEventListener("load",m);f.removeEventListener("error",
m);e.body.removeChild(f);f=null;var g=-1,F="unknown";a&&("load"!==a.type||c.wasCalled(b)||(a={type:"error"}),F=a.type,g="error"===a.type?404:200);d&&d(g,F)};f.addEventListener("load",m);f.addEventListener("error",m);e.body.appendChild(f);return m}return function(e,k,h,l,m,n,q,F,M,w){function u(){na&&na();s&&s.abort()}k=k||a.url();if("jsonp"===N(e))var A=c.createCallback(k),na=f(k,A,function(a,b){var e=200===a&&c.getResponse(A);t(D)&&d.cancel(D);na=s=null;l(a,e,"",b);c.removeCallback(A)});else{var s=
b(e,k);s.open(e,k,!0);p(m,function(a,b){t(a)&&s.setRequestHeader(b,a)});s.onload=function(){var a=s.statusText||"",b="response"in s?s.response:s.responseText,c=1223===s.status?204:s.status;0===c&&(c=b?200:"file"===ua(k).protocol?404:0);var e=s.getAllResponseHeaders();t(D)&&d.cancel(D);na=s=null;l(c,b,e,a)};e=function(){t(D)&&d.cancel(D);na=s=null;l(-1,null,null,"")};s.onerror=e;s.onabort=e;s.ontimeout=e;p(M,function(a,b){s.addEventListener(b,a)});p(w,function(a,b){s.upload.addEventListener(b,a)});
q&&(s.withCredentials=!0);if(F)try{s.responseType=F}catch(y){if("json"!==F)throw y;}s.send(v(h)?null:h)}if(0<n)var D=d(u,n);else n&&E(n.then)&&n.then(u)}}function Ef(){var a="{{",b="}}";this.startSymbol=function(b){return b?(a=b,this):a};this.endSymbol=function(a){return a?(b=a,this):b};this.$get=["$parse","$exceptionHandler","$sce",function(d,c,e){function f(a){return"\\\\\\"+a}function g(c){return c.replace(n,a).replace(q,b)}function k(a,b,c,d){var e=a.$watch(function(a){e();return d(a)},b,c);return e}
function h(f,h,q,n){function A(a){try{var b=a;a=q?e.getTrusted(q,b):e.valueOf(b);return n&&!t(a)?a:cc(a)}catch(d){c(Fa.interr(f,d))}}if(!f.length||-1===f.indexOf(a)){var p;h||(h=g(f),p=aa(h),p.exp=f,p.expressions=[],p.$$watchDelegate=k);return p}n=!!n;var s,y,D=0,H=[],Z=[];p=f.length;for(var L=[],T=[];D<p;)if(-1!==(s=f.indexOf(a,D))&&-1!==(y=f.indexOf(b,s+l)))D!==s&&L.push(g(f.substring(D,s))),D=f.substring(s+l,y),H.push(D),Z.push(d(D,A)),D=y+m,T.push(L.length),L.push("");else{D!==p&&L.push(g(f.substring(D)));
break}q&&1<L.length&&Fa.throwNoconcat(f);if(!h||H.length){var J=function(a){for(var b=0,c=H.length;b<c;b++){if(n&&v(a[b]))return;L[T[b]]=a[b]}return L.join("")};return O(function(a){var b=0,d=H.length,e=Array(d);try{for(;b<d;b++)e[b]=Z[b](a);return J(e)}catch(g){c(Fa.interr(f,g))}},{exp:f,expressions:H,$$watchDelegate:function(a,b){var c;return a.$watchGroup(Z,function(d,e){var g=J(d);E(b)&&b.call(this,g,d!==e?c:g,a);c=g})}})}}var l=a.length,m=b.length,n=new RegExp(a.replace(/./g,f),"g"),q=new RegExp(b.replace(/./g,
f),"g");h.startSymbol=function(){return a};h.endSymbol=function(){return b};return h}]}function Ff(){this.$get=["$rootScope","$window","$q","$$q","$browser",function(a,b,d,c,e){function f(f,h,l,m){function n(){q?f.apply(null,F):f(u)}var q=4<arguments.length,F=q?xa.call(arguments,4):[],p=b.setInterval,w=b.clearInterval,u=0,A=t(m)&&!m,r=(A?c:d).defer(),s=r.promise;l=t(l)?l:0;s.$$intervalId=p(function(){A?e.defer(n):a.$evalAsync(n);r.notify(u++);0<l&&u>=l&&(r.resolve(u),w(s.$$intervalId),delete g[s.$$intervalId]);
A||a.$apply()},h);g[s.$$intervalId]=r;return s}var g={};f.cancel=function(a){return a&&a.$$intervalId in g?(g[a.$$intervalId].promise.$$state.pur=!0,g[a.$$intervalId].reject("canceled"),b.clearInterval(a.$$intervalId),delete g[a.$$intervalId],!0):!1};return f}]}function tc(a){a=a.split("/");for(var b=a.length;b--;)a[b]=fb(a[b]);return a.join("/")}function Bd(a,b){var d=ua(a);b.$$protocol=d.protocol;b.$$host=d.hostname;b.$$port=Q(d.port)||Ag[d.protocol]||null}function Cd(a,b){if(Bg.test(a))throw mb("badpath",
a);var d="/"!==a.charAt(0);d&&(a="/"+a);var c=ua(a);b.$$path=decodeURIComponent(d&&"/"===c.pathname.charAt(0)?c.pathname.substring(1):c.pathname);b.$$search=Tc(c.search);b.$$hash=decodeURIComponent(c.hash);b.$$path&&"/"!==b.$$path.charAt(0)&&(b.$$path="/"+b.$$path)}function uc(a,b){return a.slice(0,b.length)===b}function va(a,b){if(uc(b,a))return b.substr(a.length)}function ja(a){var b=a.indexOf("#");return-1===b?a:a.substr(0,b)}function nb(a){return a.replace(/(#.+)|#$/,"$1")}function vc(a,b,d){this.$$html5=
!0;d=d||"";Bd(a,this);this.$$parse=function(a){var d=va(b,a);if(!C(d))throw mb("ipthprfx",a,b);Cd(d,this);this.$$path||(this.$$path="/");this.$$compose()};this.$$compose=function(){var a=bc(this.$$search),d=this.$$hash?"#"+fb(this.$$hash):"";this.$$url=tc(this.$$path)+(a?"?"+a:"")+d;this.$$absUrl=b+this.$$url.substr(1);this.$$urlUpdatedByLocation=!0};this.$$parseLinkUrl=function(c,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;t(f=va(a,c))?(g=f,g=d&&t(f=va(d,f))?b+(va("/",f)||f):a+g):
t(f=va(b,c))?g=b+f:b===c+"/"&&(g=b);g&&this.$$parse(g);return!!g}}function wc(a,b,d){Bd(a,this);this.$$parse=function(c){var e=va(a,c)||va(b,c),f;v(e)||"#"!==e.charAt(0)?this.$$html5?f=e:(f="",v(e)&&(a=c,this.replace())):(f=va(d,e),v(f)&&(f=e));Cd(f,this);c=this.$$path;var e=a,g=/^\/[A-Z]:(\/.*)/;uc(f,e)&&(f=f.replace(e,""));g.exec(f)||(c=(f=g.exec(c))?f[1]:c);this.$$path=c;this.$$compose()};this.$$compose=function(){var b=bc(this.$$search),e=this.$$hash?"#"+fb(this.$$hash):"";this.$$url=tc(this.$$path)+
(b?"?"+b:"")+e;this.$$absUrl=a+(this.$$url?d+this.$$url:"");this.$$urlUpdatedByLocation=!0};this.$$parseLinkUrl=function(b,d){return ja(a)===ja(b)?(this.$$parse(b),!0):!1}}function Dd(a,b,d){this.$$html5=!0;wc.apply(this,arguments);this.$$parseLinkUrl=function(c,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;a===ja(c)?f=c:(g=va(b,c))?f=a+d+g:b===c+"/"&&(f=b);f&&this.$$parse(f);return!!f};this.$$compose=function(){var b=bc(this.$$search),e=this.$$hash?"#"+fb(this.$$hash):"";this.$$url=
tc(this.$$path)+(b?"?"+b:"")+e;this.$$absUrl=a+d+this.$$url;this.$$urlUpdatedByLocation=!0}}function Kb(a){return function(){return this[a]}}function Ed(a,b){return function(d){if(v(d))return this[a];this[a]=b(d);this.$$compose();return this}}function Mf(){var a="!",b={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(b){return t(b)?(a=b,this):a};this.html5Mode=function(a){if(La(a))return b.enabled=a,this;if(G(a)){La(a.enabled)&&(b.enabled=a.enabled);La(a.requireBase)&&(b.requireBase=
a.requireBase);if(La(a.rewriteLinks)||C(a.rewriteLinks))b.rewriteLinks=a.rewriteLinks;return this}return b};this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(d,c,e,f,g){function k(a,b,d){var e=l.url(),g=l.$$state;try{c.url(a,b,d),l.$$state=c.state()}catch(f){throw l.url(e),l.$$state=g,f;}}function h(a,b){d.$broadcast("$locationChangeSuccess",l.absUrl(),a,l.$$state,b)}var l,m;m=c.baseHref();var n=c.url(),q;if(b.enabled){if(!m&&b.requireBase)throw mb("nobase");q=n.substring(0,
n.indexOf("/",n.indexOf("//")+2))+(m||"/");m=e.history?vc:Dd}else q=ja(n),m=wc;var F=q.substr(0,ja(q).lastIndexOf("/")+1);l=new m(q,F,"#"+a);l.$$parseLinkUrl(n,n);l.$$state=c.state();var p=/^\s*(javascript|mailto):/i;f.on("click",function(a){var e=b.rewriteLinks;if(e&&!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&2!==a.which&&2!==a.button){for(var h=z(a.target);"a"!==ya(h[0]);)if(h[0]===f[0]||!(h=h.parent())[0])return;if(!C(e)||!v(h.attr(e))){var e=h.prop("href"),k=h.attr("href")||h.attr("xlink:href");G(e)&&
"[object SVGAnimatedString]"===e.toString()&&(e=ua(e.animVal).href);p.test(e)||!e||h.attr("target")||a.isDefaultPrevented()||!l.$$parseLinkUrl(e,k)||(a.preventDefault(),l.absUrl()!==c.url()&&(d.$apply(),g.angular["ff-684208-preventDefault"]=!0))}}});nb(l.absUrl())!==nb(n)&&c.url(l.absUrl(),!0);var w=!0;c.onUrlChange(function(a,b){uc(a,F)?(d.$evalAsync(function(){var c=l.absUrl(),e=l.$$state,g;a=nb(a);l.$$parse(a);l.$$state=b;g=d.$broadcast("$locationChangeStart",a,c,b,e).defaultPrevented;l.absUrl()===
a&&(g?(l.$$parse(c),l.$$state=e,k(c,!1,e)):(w=!1,h(c,e)))}),d.$$phase||d.$digest()):g.location.href=a});d.$watch(function(){if(w||l.$$urlUpdatedByLocation){l.$$urlUpdatedByLocation=!1;var a=nb(c.url()),b=nb(l.absUrl()),g=c.state(),f=l.$$replace,m=a!==b||l.$$html5&&e.history&&g!==l.$$state;if(w||m)w=!1,d.$evalAsync(function(){var b=l.absUrl(),c=d.$broadcast("$locationChangeStart",b,a,l.$$state,g).defaultPrevented;l.absUrl()===b&&(c?(l.$$parse(a),l.$$state=g):(m&&k(b,f,g===l.$$state?null:l.$$state),
h(a,g)))})}l.$$replace=!1});return l}]}function Nf(){var a=!0,b=this;this.debugEnabled=function(b){return t(b)?(a=b,this):a};this.$get=["$window",function(d){function c(a){Zb(a)&&(a.stack&&f?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line));return a}function e(a){var b=d.console||{},e=b[a]||b.log||B;return function(){var a=[];p(arguments,function(b){a.push(c(b))});return Function.prototype.apply.call(e,b,a)}}
var f=Ba||/\bEdge\//.test(d.navigator&&d.navigator.userAgent);return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){a&&c.apply(b,arguments)}}()}}]}function Cg(a){return a+""}function Dg(a,b){return"undefined"!==typeof a?a:b}function Fd(a,b){return"undefined"===typeof a?b:"undefined"===typeof b?a:a+b}function Eg(a,b){switch(a.type){case r.MemberExpression:if(a.computed)return!1;break;case r.UnaryExpression:return 1;case r.BinaryExpression:return"+"!==
a.operator?1:!1;case r.CallExpression:return!1}return void 0===b?Gd:b}function X(a,b,d){var c,e,f=a.isPure=Eg(a,d);switch(a.type){case r.Program:c=!0;p(a.body,function(a){X(a.expression,b,f);c=c&&a.expression.constant});a.constant=c;break;case r.Literal:a.constant=!0;a.toWatch=[];break;case r.UnaryExpression:X(a.argument,b,f);a.constant=a.argument.constant;a.toWatch=a.argument.toWatch;break;case r.BinaryExpression:X(a.left,b,f);X(a.right,b,f);a.constant=a.left.constant&&a.right.constant;a.toWatch=
a.left.toWatch.concat(a.right.toWatch);break;case r.LogicalExpression:X(a.left,b,f);X(a.right,b,f);a.constant=a.left.constant&&a.right.constant;a.toWatch=a.constant?[]:[a];break;case r.ConditionalExpression:X(a.test,b,f);X(a.alternate,b,f);X(a.consequent,b,f);a.constant=a.test.constant&&a.alternate.constant&&a.consequent.constant;a.toWatch=a.constant?[]:[a];break;case r.Identifier:a.constant=!1;a.toWatch=[a];break;case r.MemberExpression:X(a.object,b,f);a.computed&&X(a.property,b,f);a.constant=a.object.constant&&
(!a.computed||a.property.constant);a.toWatch=[a];break;case r.CallExpression:c=d=a.filter?!b(a.callee.name).$stateful:!1;e=[];p(a.arguments,function(a){X(a,b,f);c=c&&a.constant;a.constant||e.push.apply(e,a.toWatch)});a.constant=c;a.toWatch=d?e:[a];break;case r.AssignmentExpression:X(a.left,b,f);X(a.right,b,f);a.constant=a.left.constant&&a.right.constant;a.toWatch=[a];break;case r.ArrayExpression:c=!0;e=[];p(a.elements,function(a){X(a,b,f);c=c&&a.constant;a.constant||e.push.apply(e,a.toWatch)});a.constant=
c;a.toWatch=e;break;case r.ObjectExpression:c=!0;e=[];p(a.properties,function(a){X(a.value,b,f);c=c&&a.value.constant&&!a.computed;a.value.constant||e.push.apply(e,a.value.toWatch);a.computed&&(X(a.key,b,f),a.key.constant||e.push.apply(e,a.key.toWatch))});a.constant=c;a.toWatch=e;break;case r.ThisExpression:a.constant=!1;a.toWatch=[];break;case r.LocalsExpression:a.constant=!1,a.toWatch=[]}}function Hd(a){if(1===a.length){a=a[0].expression;var b=a.toWatch;return 1!==b.length?b:b[0]!==a?b:void 0}}
function Id(a){return a.type===r.Identifier||a.type===r.MemberExpression}function Jd(a){if(1===a.body.length&&Id(a.body[0].expression))return{type:r.AssignmentExpression,left:a.body[0].expression,right:{type:r.NGValueParameter},operator:"="}}function Kd(a){this.$filter=a}function Ld(a){this.$filter=a}function xc(a,b,d){this.ast=new r(a,d);this.astCompiler=d.csp?new Ld(b):new Kd(b)}function yc(a){return E(a.valueOf)?a.valueOf():Fg.call(a)}function Of(){var a=R(),b={"true":!0,"false":!1,"null":null,
undefined:void 0},d,c;this.addLiteral=function(a,c){b[a]=c};this.setIdentifierFns=function(a,b){d=a;c=b;return this};this.$get=["$filter",function(e){function f(a,b,c){return null==a||null==b?a===b:"object"!==typeof a||(a=yc(a),"object"!==typeof a||c)?a===b||a!==a&&b!==b:!1}function g(a,b,c,d,e){var g=d.inputs,h;if(1===g.length){var k=f,g=g[0];return a.$watch(function(a){var b=g(a);f(b,k,g.isPure)||(h=d(a,void 0,void 0,[b]),k=b&&yc(b));return h},b,c,e)}for(var l=[],m=[],n=0,p=g.length;n<p;n++)l[n]=
f,m[n]=null;return a.$watch(function(a){for(var b=!1,c=0,e=g.length;c<e;c++){var k=g[c](a);if(b||(b=!f(k,l[c],g[c].isPure)))m[c]=k,l[c]=k&&yc(k)}b&&(h=d(a,void 0,void 0,m));return h},b,c,e)}function k(a,b,c,d,e){function f(a){return d(a)}function h(a,c,d){l=a;E(b)&&b(a,c,d);t(a)&&d.$$postDigest(function(){t(l)&&k()})}var k,l;return k=d.inputs?g(a,h,c,d,e):a.$watch(f,h,c)}function h(a,b,c,d){function e(a){var b=!0;p(a,function(a){t(a)||(b=!1)});return b}var g,f;return g=a.$watch(function(a){return d(a)},
function(a,c,d){f=a;E(b)&&b(a,c,d);e(a)&&d.$$postDigest(function(){e(f)&&g()})},c)}function l(a,b,c,d){var e=a.$watch(function(a){e();return d(a)},b,c);return e}function m(a,b){if(!b)return a;var c=a.$$watchDelegate,d=!1,e=c!==h&&c!==k?function(c,e,g,f){g=d&&f?f[0]:a(c,e,g,f);return b(g,c,e)}:function(c,d,e,g){e=a(c,d,e,g);c=b(e,c,d);return t(e)?c:e},d=!a.inputs;c&&c!==g?(e.$$watchDelegate=c,e.inputs=a.inputs):b.$stateful||(e.$$watchDelegate=g,e.inputs=a.inputs?a.inputs:[a]);e.inputs&&(e.inputs=e.inputs.map(function(a){return a.isPure===
Gd?function(b){return a(b)}:a}));return e}var n={csp:Ja().noUnsafeEval,literals:Ia(b),isIdentifierStart:E(d)&&d,isIdentifierContinue:E(c)&&c};return function(b,c){var d,f,p;switch(typeof b){case "string":return p=b=b.trim(),d=a[p],d||(":"===b.charAt(0)&&":"===b.charAt(1)&&(f=!0,b=b.substring(2)),d=new zc(n),d=(new xc(d,e,n)).parse(b),d.constant?d.$$watchDelegate=l:f?d.$$watchDelegate=d.literal?h:k:d.inputs&&(d.$$watchDelegate=g),a[p]=d),m(d,c);case "function":return m(b,c);default:return m(B,c)}}}]}
function Qf(){var a=!0;this.$get=["$rootScope","$exceptionHandler",function(b,d){return Md(function(a){b.$evalAsync(a)},d,a)}];this.errorOnUnhandledRejections=function(b){return t(b)?(a=b,this):a}}function Rf(){var a=!0;this.$get=["$browser","$exceptionHandler",function(b,d){return Md(function(a){b.defer(a)},d,a)}];this.errorOnUnhandledRejections=function(b){return t(b)?(a=b,this):a}}function Md(a,b,d){function c(){return new e}function e(){var a=this.promise=new f;this.resolve=function(b){h(a,b)};
this.reject=function(b){m(a,b)};this.notify=function(b){q(a,b)}}function f(){this.$$state={status:0}}function g(){for(;!t&&s.length;){var a=s.shift();if(!a.pur){a.pur=!0;var c=a.value,c="Possibly unhandled rejection: "+("function"===typeof c?c.toString().replace(/ \{[\s\S]*$/,""):v(c)?"undefined":"string"!==typeof c?Ee(c,void 0):c);Zb(a.value)?b(a.value,c):b(c)}}}function k(b){!d||b.pending||2!==b.status||b.pur||(0===t&&0===s.length&&a(g),s.push(b));!b.processScheduled&&b.pending&&(b.processScheduled=
!0,++t,a(function(){var c,e,f;f=b.pending;b.processScheduled=!1;b.pending=void 0;try{for(var k=0,l=f.length;k<l;++k){b.pur=!0;e=f[k][0];c=f[k][b.status];try{E(c)?h(e,c(b.value)):1===b.status?h(e,b.value):m(e,b.value)}catch(n){m(e,n)}}}finally{--t,d&&0===t&&a(g)}}))}function h(a,b){a.$$state.status||(b===a?n(a,A("qcycle",b)):l(a,b))}function l(a,b){function c(b){f||(f=!0,l(a,b))}function d(b){f||(f=!0,n(a,b))}function e(b){q(a,b)}var g,f=!1;try{if(G(b)||E(b))g=b.then;E(g)?(a.$$state.status=-1,g.call(b,
c,d,e)):(a.$$state.value=b,a.$$state.status=1,k(a.$$state))}catch(h){d(h)}}function m(a,b){a.$$state.status||n(a,b)}function n(a,b){a.$$state.value=b;a.$$state.status=2;k(a.$$state)}function q(c,d){var e=c.$$state.pending;0>=c.$$state.status&&e&&e.length&&a(function(){for(var a,c,g=0,f=e.length;g<f;g++){c=e[g][0];a=e[g][3];try{q(c,E(a)?a(d):d)}catch(h){b(h)}}})}function F(a){var b=new f;m(b,a);return b}function r(a,b,c){var d=null;try{E(c)&&(d=c())}catch(e){return F(e)}return d&&E(d.then)?d.then(function(){return b(a)},
F):b(a)}function w(a,b,c,d){var e=new f;h(e,a);return e.then(b,c,d)}function u(a){if(!E(a))throw A("norslvr",a);var b=new f;a(function(a){h(b,a)},function(a){m(b,a)});return b}var A=K("$q",TypeError),t=0,s=[];O(f.prototype,{then:function(a,b,c){if(v(a)&&v(b)&&v(c))return this;var d=new f;this.$$state.pending=this.$$state.pending||[];this.$$state.pending.push([d,a,b,c]);0<this.$$state.status&&k(this.$$state);return d},"catch":function(a){return this.then(null,a)},"finally":function(a,b){return this.then(function(b){return r(b,
y,a)},function(b){return r(b,F,a)},b)}});var y=w;u.prototype=f.prototype;u.defer=c;u.reject=F;u.when=w;u.resolve=y;u.all=function(a){var b=new f,c=0,d=I(a)?[]:{};p(a,function(a,e){c++;w(a).then(function(a){d[e]=a;--c||h(b,d)},function(a){m(b,a)})});0===c&&h(b,d);return b};u.race=function(a){var b=c();p(a,function(a){w(a).then(b.resolve,b.reject)});return b.promise};return u}function $f(){this.$get=["$window","$timeout",function(a,b){var d=a.requestAnimationFrame||a.webkitRequestAnimationFrame,c=a.cancelAnimationFrame||
a.webkitCancelAnimationFrame||a.webkitCancelRequestAnimationFrame,e=!!d,f=e?function(a){var b=d(a);return function(){c(b)}}:function(a){var c=b(a,16.66,!1);return function(){b.cancel(c)}};f.supported=e;return f}]}function Pf(){function a(a){function b(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null;this.$$listeners={};this.$$listenerCount={};this.$$watchersCount=0;this.$id=++sb;this.$$ChildScope=null}b.prototype=a;return b}var b=10,d=K("$rootScope"),c=null,e=null;this.digestTtl=
function(a){arguments.length&&(b=a);return b};this.$get=["$exceptionHandler","$parse","$browser",function(f,g,k){function h(a){a.currentScope.$$destroyed=!0}function l(a){9===Ba&&(a.$$childHead&&l(a.$$childHead),a.$$nextSibling&&l(a.$$nextSibling));a.$parent=a.$$nextSibling=a.$$prevSibling=a.$$childHead=a.$$childTail=a.$root=a.$$watchers=null}function m(){this.$id=++sb;this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this.$root=
this;this.$$destroyed=!1;this.$$listeners={};this.$$listenerCount={};this.$$watchersCount=0;this.$$isolateBindings=null}function n(a){if(A.$$phase)throw d("inprog",A.$$phase);A.$$phase=a}function q(a,b){do a.$$watchersCount+=b;while(a=a.$parent)}function F(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function r(){}function w(){for(;y.length;)try{y.shift()()}catch(a){f(a)}e=null}function u(){null===e&&(e=k.defer(function(){A.$apply(w)}))}
m.prototype={constructor:m,$new:function(b,c){var d;c=c||this;b?(d=new m,d.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=a(this)),d=new this.$$ChildScope);d.$parent=c;d.$$prevSibling=c.$$childTail;c.$$childHead?(c.$$childTail.$$nextSibling=d,c.$$childTail=d):c.$$childHead=c.$$childTail=d;(b||c!==this)&&d.$on("$destroy",h);return d},$watch:function(a,b,d,e){var f=g(a);if(f.$$watchDelegate)return f.$$watchDelegate(this,b,d,f,a);var h=this,k=h.$$watchers,l={fn:b,last:r,get:f,exp:e||a,eq:!!d};
c=null;E(b)||(l.fn=B);k||(k=h.$$watchers=[],k.$$digestWatchIndex=-1);k.unshift(l);k.$$digestWatchIndex++;q(this,1);return function(){var a=cb(k,l);0<=a&&(q(h,-1),a<k.$$digestWatchIndex&&k.$$digestWatchIndex--);c=null}},$watchGroup:function(a,b){function c(){h=!1;k?(k=!1,b(e,e,f)):b(e,d,f)}var d=Array(a.length),e=Array(a.length),g=[],f=this,h=!1,k=!0;if(!a.length){var l=!0;f.$evalAsync(function(){l&&b(e,e,f)});return function(){l=!1}}if(1===a.length)return this.$watch(a[0],function(a,c,g){e[0]=a;d[0]=
c;b(e,a===c?e:d,g)});p(a,function(a,b){var k=f.$watch(a,function(a,g){e[b]=a;d[b]=g;h||(h=!0,f.$evalAsync(c))});g.push(k)});return function(){for(;g.length;)g.shift()()}},$watchCollection:function(a,b){function c(a){e=a;var b,d,g,h;if(!v(e)){if(G(e))if(oa(e))for(f!==n&&(f=n,s=f.length=0,l++),a=e.length,s!==a&&(l++,f.length=s=a),b=0;b<a;b++)h=f[b],g=e[b],d=h!==h&&g!==g,d||h===g||(l++,f[b]=g);else{f!==q&&(f=q={},s=0,l++);a=0;for(b in e)wa.call(e,b)&&(a++,g=e[b],h=f[b],b in f?(d=h!==h&&g!==g,d||h===
g||(l++,f[b]=g)):(s++,f[b]=g,l++));if(s>a)for(b in l++,f)wa.call(e,b)||(s--,delete f[b])}else f!==e&&(f=e,l++);return l}}c.$stateful=!0;var d=this,e,f,h,k=1<b.length,l=0,m=g(a,c),n=[],q={},p=!0,s=0;return this.$watch(m,function(){p?(p=!1,b(e,e,d)):b(e,h,d);if(k)if(G(e))if(oa(e)){h=Array(e.length);for(var a=0;a<e.length;a++)h[a]=e[a]}else for(a in h={},e)wa.call(e,a)&&(h[a]=e[a]);else h=e})},$digest:function(){var a,g,h,l,m,q,p,F=b,y,u=[],v,x;n("$digest");k.$$checkUrlChange();this===A&&null!==e&&(k.defer.cancel(e),
w());c=null;do{p=!1;y=this;for(q=0;q<t.length;q++){try{x=t[q],l=x.fn,l(x.scope,x.locals)}catch(z){f(z)}c=null}t.length=0;a:do{if(q=y.$$watchers)for(q.$$digestWatchIndex=q.length;q.$$digestWatchIndex--;)try{if(a=q[q.$$digestWatchIndex])if(m=a.get,(g=m(y))!==(h=a.last)&&!(a.eq?sa(g,h):ba(g)&&ba(h)))p=!0,c=a,a.last=a.eq?Ia(g,null):g,l=a.fn,l(g,h===r?g:h,y),5>F&&(v=4-F,u[v]||(u[v]=[]),u[v].push({msg:E(a.exp)?"fn: "+(a.exp.name||a.exp.toString()):a.exp,newVal:g,oldVal:h}));else if(a===c){p=!1;break a}}catch(B){f(B)}if(!(q=
y.$$watchersCount&&y.$$childHead||y!==this&&y.$$nextSibling))for(;y!==this&&!(q=y.$$nextSibling);)y=y.$parent}while(y=q);if((p||t.length)&&!F--)throw A.$$phase=null,d("infdig",b,u);}while(p||t.length);for(A.$$phase=null;D<s.length;)try{s[D++]()}catch(G){f(G)}s.length=D=0;k.$$checkUrlChange()},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;this===A&&k.$$applicationDestroyed();q(this,-this.$$watchersCount);for(var b in this.$$listenerCount)F(this,
this.$$listenerCount[b],b);a&&a.$$childHead===this&&(a.$$childHead=this.$$nextSibling);a&&a.$$childTail===this&&(a.$$childTail=this.$$prevSibling);this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling);this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling);this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=B;this.$on=this.$watch=this.$watchGroup=function(){return B};this.$$listeners={};this.$$nextSibling=null;l(this)}},$eval:function(a,b){return g(a)(this,
b)},$evalAsync:function(a,b){A.$$phase||t.length||k.defer(function(){t.length&&A.$digest()});t.push({scope:this,fn:g(a),locals:b})},$$postDigest:function(a){s.push(a)},$apply:function(a){try{n("$apply");try{return this.$eval(a)}finally{A.$$phase=null}}catch(b){f(b)}finally{try{A.$digest()}catch(c){throw f(c),c;}}},$applyAsync:function(a){function b(){c.$eval(a)}var c=this;a&&y.push(b);a=g(a);u()},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]);c.push(b);var d=this;do d.$$listenerCount[a]||
(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){var d=c.indexOf(b);-1!==d&&(c[d]=null,F(e,1,a))}},$emit:function(a,b){var c=[],d,e=this,g=!1,h={name:a,targetScope:e,stopPropagation:function(){g=!0},preventDefault:function(){h.defaultPrevented=!0},defaultPrevented:!1},k=db([h],arguments,1),l,m;do{d=e.$$listeners[a]||c;h.currentScope=e;l=0;for(m=d.length;l<m;l++)if(d[l])try{d[l].apply(null,k)}catch(n){f(n)}else d.splice(l,1),l--,m--;if(g)return h.currentScope=
null,h;e=e.$parent}while(e);h.currentScope=null;return h},$broadcast:function(a,b){var c=this,d=this,e={name:a,targetScope:this,preventDefault:function(){e.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[a])return e;for(var g=db([e],arguments,1),h,k;c=d;){e.currentScope=c;d=c.$$listeners[a]||[];h=0;for(k=d.length;h<k;h++)if(d[h])try{d[h].apply(null,g)}catch(l){f(l)}else d.splice(h,1),h--,k--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=
c.$$nextSibling);)c=c.$parent}e.currentScope=null;return e}};var A=new m,t=A.$$asyncQueue=[],s=A.$$postDigestQueue=[],y=A.$$applyAsyncQueue=[],D=0;return A}]}function He(){var a=/^\s*(https?|ftp|mailto|tel|file):/,b=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(b){return t(b)?(a=b,this):a};this.imgSrcSanitizationWhitelist=function(a){return t(a)?(b=a,this):b};this.$get=function(){return function(d,c){var e=c?b:a,f;f=ua(d).href;return""===f||f.match(e)?d:"unsafe:"+
f}}}function Gg(a){if("self"===a)return a;if(C(a)){if(-1<a.indexOf("***"))throw qa("iwcard",a);a=Nd(a).replace(/\\\*\\\*/g,".*").replace(/\\\*/g,"[^:/.?&;]*");return new RegExp("^"+a+"$")}if($a(a))return new RegExp("^"+a.source+"$");throw qa("imatcher");}function Od(a){var b=[];t(a)&&p(a,function(a){b.push(Gg(a))});return b}function Tf(){this.SCE_CONTEXTS=ka;var a=["self"],b=[];this.resourceUrlWhitelist=function(b){arguments.length&&(a=Od(b));return a};this.resourceUrlBlacklist=function(a){arguments.length&&
(b=Od(a));return b};this.$get=["$injector",function(d){function c(a,b){return"self"===a?Ad(b):!!a.exec(b.href)}function e(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};a&&(b.prototype=new a);b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()};b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()};return b}var f=function(a){throw qa("unsafe");};d.has("$sanitize")&&(f=d.get("$sanitize"));var g=e(),k={};k[ka.HTML]=e(g);k[ka.CSS]=e(g);k[ka.URL]=
e(g);k[ka.JS]=e(g);k[ka.RESOURCE_URL]=e(k[ka.URL]);return{trustAs:function(a,b){var c=k.hasOwnProperty(a)?k[a]:null;if(!c)throw qa("icontext",a,b);if(null===b||v(b)||""===b)return b;if("string"!==typeof b)throw qa("itype",a);return new c(b)},getTrusted:function(d,e){if(null===e||v(e)||""===e)return e;var g=k.hasOwnProperty(d)?k[d]:null;if(g&&e instanceof g)return e.$$unwrapTrustedValue();if(d===ka.RESOURCE_URL){var g=ua(e.toString()),n,q,p=!1;n=0;for(q=a.length;n<q;n++)if(c(a[n],g)){p=!0;break}if(p)for(n=
0,q=b.length;n<q;n++)if(c(b[n],g)){p=!1;break}if(p)return e;throw qa("insecurl",e.toString());}if(d===ka.HTML)return f(e);throw qa("unsafe");},valueOf:function(a){return a instanceof g?a.$$unwrapTrustedValue():a}}}]}function Sf(){var a=!0;this.enabled=function(b){arguments.length&&(a=!!b);return a};this.$get=["$parse","$sceDelegate",function(b,d){if(a&&8>Ba)throw qa("iequirks");var c=ra(ka);c.isEnabled=function(){return a};c.trustAs=d.trustAs;c.getTrusted=d.getTrusted;c.valueOf=d.valueOf;a||(c.trustAs=
c.getTrusted=function(a,b){return b},c.valueOf=ab);c.parseAs=function(a,d){var e=b(d);return e.literal&&e.constant?e:b(d,function(b){return c.getTrusted(a,b)})};var e=c.parseAs,f=c.getTrusted,g=c.trustAs;p(ka,function(a,b){var d=N(b);c[("parse_as_"+d).replace(Ac,ib)]=function(b){return e(a,b)};c[("get_trusted_"+d).replace(Ac,ib)]=function(b){return f(a,b)};c[("trust_as_"+d).replace(Ac,ib)]=function(b){return g(a,b)}});return c}]}function Uf(){this.$get=["$window","$document",function(a,b){var d={},
c=!((!a.nw||!a.nw.process)&&a.chrome&&(a.chrome.app&&a.chrome.app.runtime||!a.chrome.app&&a.chrome.runtime&&a.chrome.runtime.id))&&a.history&&a.history.pushState,e=Q((/android (\d+)/.exec(N((a.navigator||{}).userAgent))||[])[1]),f=/Boxee/i.test((a.navigator||{}).userAgent),g=b[0]||{},k=g.body&&g.body.style,h=!1,l=!1;k&&(h=!!("transition"in k||"webkitTransition"in k),l=!!("animation"in k||"webkitAnimation"in k));return{history:!(!c||4>e||f),hasEvent:function(a){if("input"===a&&Ba)return!1;if(v(d[a])){var b=
g.createElement("div");d[a]="on"+a in b}return d[a]},csp:Ja(),transitions:h,animations:l,android:e}}]}function Wf(){var a;this.httpOptions=function(b){return b?(a=b,this):a};this.$get=["$exceptionHandler","$templateCache","$http","$q","$sce",function(b,d,c,e,f){function g(k,h){g.totalPendingRequests++;if(!C(k)||v(d.get(k)))k=f.getTrustedResourceUrl(k);var l=c.defaults&&c.defaults.transformResponse;I(l)?l=l.filter(function(a){return a!==qc}):l===qc&&(l=null);return c.get(k,O({cache:d,transformResponse:l},
a)).finally(function(){g.totalPendingRequests--}).then(function(a){d.put(k,a.data);return a.data},function(a){h||(a=Hg("tpload",k,a.status,a.statusText),b(a));return e.reject(a)})}g.totalPendingRequests=0;return g}]}function Xf(){this.$get=["$rootScope","$browser","$location",function(a,b,d){return{findBindings:function(a,b,d){a=a.getElementsByClassName("ng-binding");var g=[];p(a,function(a){var c=fa.element(a).data("$binding");c&&p(c,function(c){d?(new RegExp("(^|\\s)"+Nd(b)+"(\\s|\\||$)")).test(c)&&
g.push(a):-1!==c.indexOf(b)&&g.push(a)})});return g},findModels:function(a,b,d){for(var g=["ng-","data-ng-","ng\\:"],k=0;k<g.length;++k){var h=a.querySelectorAll("["+g[k]+"model"+(d?"=":"*=")+'"'+b+'"]');if(h.length)return h}},getLocation:function(){return d.url()},setLocation:function(b){b!==d.url()&&(d.url(b),a.$digest())},whenStable:function(a){b.notifyWhenNoOutstandingRequests(a)}}}]}function Yf(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(a,b,d,c,e){function f(f,
h,l){E(f)||(l=h,h=f,f=B);var m=xa.call(arguments,3),n=t(l)&&!l,q=(n?c:d).defer(),p=q.promise,r;r=b.defer(function(){try{q.resolve(f.apply(null,m))}catch(b){q.reject(b),e(b)}finally{delete g[p.$$timeoutId]}n||a.$apply()},h);p.$$timeoutId=r;g[r]=q;return p}var g={};f.cancel=function(a){return a&&a.$$timeoutId in g?(g[a.$$timeoutId].promise.$$state.pur=!0,g[a.$$timeoutId].reject("canceled"),delete g[a.$$timeoutId],b.defer.cancel(a.$$timeoutId)):!1};return f}]}function ua(a){Ba&&(ea.setAttribute("href",
a),a=ea.href);ea.setAttribute("href",a);return{href:ea.href,protocol:ea.protocol?ea.protocol.replace(/:$/,""):"",host:ea.host,search:ea.search?ea.search.replace(/^\?/,""):"",hash:ea.hash?ea.hash.replace(/^#/,""):"",hostname:ea.hostname,port:ea.port,pathname:"/"===ea.pathname.charAt(0)?ea.pathname:"/"+ea.pathname}}function Ad(a){a=C(a)?ua(a):a;return a.protocol===Pd.protocol&&a.host===Pd.host}function Zf(){this.$get=aa(x)}function Qd(a){function b(a){try{return decodeURIComponent(a)}catch(b){return a}}
var d=a[0]||{},c={},e="";return function(){var a,g,k,h,l;try{a=d.cookie||""}catch(m){a=""}if(a!==e)for(e=a,a=e.split("; "),c={},k=0;k<a.length;k++)g=a[k],h=g.indexOf("="),0<h&&(l=b(g.substring(0,h)),v(c[l])&&(c[l]=b(g.substring(h+1))));return c}}function cg(){this.$get=Qd}function ed(a){function b(d,c){if(G(d)){var e={};p(d,function(a,c){e[c]=b(c,a)});return e}return a.factory(d+"Filter",c)}this.register=b;this.$get=["$injector",function(a){return function(b){return a.get(b+"Filter")}}];b("currency",
Rd);b("date",Sd);b("filter",Ig);b("json",Jg);b("limitTo",Kg);b("lowercase",Lg);b("number",Td);b("orderBy",Ud);b("uppercase",Mg)}function Ig(){return function(a,b,d,c){if(!oa(a)){if(null==a)return a;throw K("filter")("notarray",a);}c=c||"$";var e;switch(Bc(b)){case "function":break;case "boolean":case "null":case "number":case "string":e=!0;case "object":b=Ng(b,d,c,e);break;default:return a}return Array.prototype.filter.call(a,b)}}function Ng(a,b,d,c){var e=G(a)&&d in a;!0===b?b=sa:E(b)||(b=function(a,
b){if(v(a))return!1;if(null===a||null===b)return a===b;if(G(b)||G(a)&&!Yb(a))return!1;a=N(""+a);b=N(""+b);return-1!==a.indexOf(b)});return function(f){return e&&!G(f)?Ga(f,a[d],b,d,!1):Ga(f,a,b,d,c)}}function Ga(a,b,d,c,e,f){var g=Bc(a),k=Bc(b);if("string"===k&&"!"===b.charAt(0))return!Ga(a,b.substring(1),d,c,e);if(I(a))return a.some(function(a){return Ga(a,b,d,c,e)});switch(g){case "object":var h;if(e){for(h in a)if(h.charAt&&"$"!==h.charAt(0)&&Ga(a[h],b,d,c,!0))return!0;return f?!1:Ga(a,b,d,c,!1)}if("object"===
k){for(h in b)if(f=b[h],!E(f)&&!v(f)&&(g=h===c,!Ga(g?a:a[h],f,d,c,g,g)))return!1;return!0}return d(a,b);case "function":return!1;default:return d(a,b)}}function Bc(a){return null===a?"null":typeof a}function Rd(a){var b=a.NUMBER_FORMATS;return function(a,c,e){v(c)&&(c=b.CURRENCY_SYM);v(e)&&(e=b.PATTERNS[1].maxFrac);return null==a?a:Vd(a,b.PATTERNS[1],b.GROUP_SEP,b.DECIMAL_SEP,e).replace(/\u00A4/g,c)}}function Td(a){var b=a.NUMBER_FORMATS;return function(a,c){return null==a?a:Vd(a,b.PATTERNS[0],b.GROUP_SEP,
b.DECIMAL_SEP,c)}}function Og(a){var b=0,d,c,e,f,g;-1<(c=a.indexOf(Wd))&&(a=a.replace(Wd,""));0<(e=a.search(/e/i))?(0>c&&(c=e),c+=+a.slice(e+1),a=a.substring(0,e)):0>c&&(c=a.length);for(e=0;a.charAt(e)===Cc;e++);if(e===(g=a.length))d=[0],c=1;else{for(g--;a.charAt(g)===Cc;)g--;c-=e;d=[];for(f=0;e<=g;e++,f++)d[f]=+a.charAt(e)}c>Xd&&(d=d.splice(0,Xd-1),b=c-1,c=1);return{d:d,e:b,i:c}}function Pg(a,b,d,c){var e=a.d,f=e.length-a.i;b=v(b)?Math.min(Math.max(d,f),c):+b;d=b+a.i;c=e[d];if(0<d){e.splice(Math.max(a.i,
d));for(var g=d;g<e.length;g++)e[g]=0}else for(f=Math.max(0,f),a.i=1,e.length=Math.max(1,d=b+1),e[0]=0,g=1;g<d;g++)e[g]=0;if(5<=c)if(0>d-1){for(c=0;c>d;c--)e.unshift(0),a.i++;e.unshift(1);a.i++}else e[d-1]++;for(;f<Math.max(0,b);f++)e.push(0);if(b=e.reduceRight(function(a,b,c,d){b+=a;d[c]=b%10;return Math.floor(b/10)},0))e.unshift(b),a.i++}function Vd(a,b,d,c,e){if(!C(a)&&!W(a)||isNaN(a))return"";var f=!isFinite(a),g=!1,k=Math.abs(a)+"",h="";if(f)h="\u221e";else{g=Og(k);Pg(g,e,b.minFrac,b.maxFrac);
h=g.d;k=g.i;e=g.e;f=[];for(g=h.reduce(function(a,b){return a&&!b},!0);0>k;)h.unshift(0),k++;0<k?f=h.splice(k,h.length):(f=h,h=[0]);k=[];for(h.length>=b.lgSize&&k.unshift(h.splice(-b.lgSize,h.length).join(""));h.length>b.gSize;)k.unshift(h.splice(-b.gSize,h.length).join(""));h.length&&k.unshift(h.join(""));h=k.join(d);f.length&&(h+=c+f.join(""));e&&(h+="e+"+e)}return 0>a&&!g?b.negPre+h+b.negSuf:b.posPre+h+b.posSuf}function Lb(a,b,d,c){var e="";if(0>a||c&&0>=a)c?a=-a+1:(a=-a,e="-");for(a=""+a;a.length<
b;)a=Cc+a;d&&(a=a.substr(a.length-b));return e+a}function $(a,b,d,c,e){d=d||0;return function(f){f=f["get"+a]();if(0<d||f>-d)f+=d;0===f&&-12===d&&(f=12);return Lb(f,b,c,e)}}function ob(a,b,d){return function(c,e){var f=c["get"+a](),g=wb((d?"STANDALONE":"")+(b?"SHORT":"")+a);return e[g][f]}}function Yd(a){var b=(new Date(a,0,1)).getDay();return new Date(a,0,(4>=b?5:12)-b)}function Zd(a){return function(b){var d=Yd(b.getFullYear());b=+new Date(b.getFullYear(),b.getMonth(),b.getDate()+(4-b.getDay()))-
+d;b=1+Math.round(b/6048E5);return Lb(b,a)}}function Dc(a,b){return 0>=a.getFullYear()?b.ERAS[0]:b.ERAS[1]}function Sd(a){function b(a){var b;if(b=a.match(d)){a=new Date(0);var f=0,g=0,k=b[8]?a.setUTCFullYear:a.setFullYear,h=b[8]?a.setUTCHours:a.setHours;b[9]&&(f=Q(b[9]+b[10]),g=Q(b[9]+b[11]));k.call(a,Q(b[1]),Q(b[2])-1,Q(b[3]));f=Q(b[4]||0)-f;g=Q(b[5]||0)-g;k=Q(b[6]||0);b=Math.round(1E3*parseFloat("0."+(b[7]||0)));h.call(a,f,g,k,b)}return a}var d=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;
return function(c,d,f){var g="",k=[],h,l;d=d||"mediumDate";d=a.DATETIME_FORMATS[d]||d;C(c)&&(c=Qg.test(c)?Q(c):b(c));W(c)&&(c=new Date(c));if(!ia(c)||!isFinite(c.getTime()))return c;for(;d;)(l=Rg.exec(d))?(k=db(k,l,1),d=k.pop()):(k.push(d),d=null);var m=c.getTimezoneOffset();f&&(m=Rc(f,m),c=ac(c,f,!0));p(k,function(b){h=Sg[b];g+=h?h(c,a.DATETIME_FORMATS,m):"''"===b?"'":b.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return g}}function Jg(){return function(a,b){v(b)&&(b=2);return eb(a,b)}}function Kg(){return function(a,
b,d){b=Infinity===Math.abs(Number(b))?Number(b):Q(b);if(ba(b))return a;W(a)&&(a=a.toString());if(!oa(a))return a;d=!d||isNaN(d)?0:Q(d);d=0>d?Math.max(0,a.length+d):d;return 0<=b?Ec(a,d,d+b):0===d?Ec(a,b,a.length):Ec(a,Math.max(0,d+b),d)}}function Ec(a,b,d){return C(a)?a.slice(b,d):xa.call(a,b,d)}function Ud(a){function b(b){return b.map(function(b){var c=1,d=ab;if(E(b))d=b;else if(C(b)){if("+"===b.charAt(0)||"-"===b.charAt(0))c="-"===b.charAt(0)?-1:1,b=b.substring(1);if(""!==b&&(d=a(b),d.constant))var e=
d(),d=function(a){return a[e]}}return{get:d,descending:c}})}function d(a){switch(typeof a){case "number":case "boolean":case "string":return!0;default:return!1}}function c(a,b){var c=0,d=a.type,h=b.type;if(d===h){var h=a.value,l=b.value;"string"===d?(h=h.toLowerCase(),l=l.toLowerCase()):"object"===d&&(G(h)&&(h=a.index),G(l)&&(l=b.index));h!==l&&(c=h<l?-1:1)}else c=d<h?-1:1;return c}return function(a,f,g,k){if(null==a)return a;if(!oa(a))throw K("orderBy")("notarray",a);I(f)||(f=[f]);0===f.length&&
(f=["+"]);var h=b(f),l=g?-1:1,m=E(k)?k:c;a=Array.prototype.map.call(a,function(a,b){return{value:a,tieBreaker:{value:b,type:"number",index:b},predicateValues:h.map(function(c){var e=c.get(a);c=typeof e;if(null===e)c="string",e="null";else if("object"===c)a:{if(E(e.valueOf)&&(e=e.valueOf(),d(e)))break a;Yb(e)&&(e=e.toString(),d(e))}return{value:e,type:c,index:b}})}});a.sort(function(a,b){for(var d=0,e=h.length;d<e;d++){var g=m(a.predicateValues[d],b.predicateValues[d]);if(g)return g*h[d].descending*
l}return(m(a.tieBreaker,b.tieBreaker)||c(a.tieBreaker,b.tieBreaker))*l});return a=a.map(function(a){return a.value})}}function Ua(a){E(a)&&(a={link:a});a.restrict=a.restrict||"AC";return aa(a)}function Mb(a,b,d,c,e){this.$$controls=[];this.$error={};this.$$success={};this.$pending=void 0;this.$name=e(b.name||b.ngForm||"")(d);this.$dirty=!1;this.$valid=this.$pristine=!0;this.$submitted=this.$invalid=!1;this.$$parentForm=Nb;this.$$element=a;this.$$animate=c;$d(this)}function $d(a){a.$$classCache={};
a.$$classCache[ae]=!(a.$$classCache[pb]=a.$$element.hasClass(pb))}function be(a){function b(a,b,c){c&&!a.$$classCache[b]?(a.$$animate.addClass(a.$$element,b),a.$$classCache[b]=!0):!c&&a.$$classCache[b]&&(a.$$animate.removeClass(a.$$element,b),a.$$classCache[b]=!1)}function d(a,c,d){c=c?"-"+Vc(c,"-"):"";b(a,pb+c,!0===d);b(a,ae+c,!1===d)}var c=a.set,e=a.unset;a.clazz.prototype.$setValidity=function(a,g,k){v(g)?(this.$pending||(this.$pending={}),c(this.$pending,a,k)):(this.$pending&&e(this.$pending,
a,k),ce(this.$pending)&&(this.$pending=void 0));La(g)?g?(e(this.$error,a,k),c(this.$$success,a,k)):(c(this.$error,a,k),e(this.$$success,a,k)):(e(this.$error,a,k),e(this.$$success,a,k));this.$pending?(b(this,"ng-pending",!0),this.$valid=this.$invalid=void 0,d(this,"",null)):(b(this,"ng-pending",!1),this.$valid=ce(this.$error),this.$invalid=!this.$valid,d(this,"",this.$valid));g=this.$pending&&this.$pending[a]?void 0:this.$error[a]?!1:this.$$success[a]?!0:null;d(this,a,g);this.$$parentForm.$setValidity(a,
g,this)}}function ce(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function Fc(a){a.$formatters.push(function(b){return a.$isEmpty(b)?b:b.toString()})}function Va(a,b,d,c,e,f){var g=N(b[0].type);if(!e.android){var k=!1;b.on("compositionstart",function(){k=!0});b.on("compositionend",function(){k=!1;l()})}var h,l=function(a){h&&(f.defer.cancel(h),h=null);if(!k){var e=b.val();a=a&&a.type;"password"===g||d.ngTrim&&"false"===d.ngTrim||(e=P(e));(c.$viewValue!==e||""===e&&c.$$hasNativeValidators)&&
c.$setViewValue(e,a)}};if(e.hasEvent("input"))b.on("input",l);else{var m=function(a,b,c){h||(h=f.defer(function(){h=null;b&&b.value===c||l(a)}))};b.on("keydown",function(a){var b=a.keyCode;91===b||15<b&&19>b||37<=b&&40>=b||m(a,this,this.value)});if(e.hasEvent("paste"))b.on("paste cut",m)}b.on("change",l);if(de[g]&&c.$$hasNativeValidators&&g===d.type)b.on("keydown wheel mousedown",function(a){if(!h){var b=this.validity,c=b.badInput,d=b.typeMismatch;h=f.defer(function(){h=null;b.badInput===c&&b.typeMismatch===
d||l(a)})}});c.$render=function(){var a=c.$isEmpty(c.$viewValue)?"":c.$viewValue;b.val()!==a&&b.val(a)}}function Ob(a,b){return function(d,c){var e,f;if(ia(d))return d;if(C(d)){'"'===d.charAt(0)&&'"'===d.charAt(d.length-1)&&(d=d.substring(1,d.length-1));if(Tg.test(d))return new Date(d);a.lastIndex=0;if(e=a.exec(d))return e.shift(),f=c?{yyyy:c.getFullYear(),MM:c.getMonth()+1,dd:c.getDate(),HH:c.getHours(),mm:c.getMinutes(),ss:c.getSeconds(),sss:c.getMilliseconds()/1E3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,
ss:0,sss:0},p(e,function(a,c){c<b.length&&(f[b[c]]=+a)}),new Date(f.yyyy,f.MM-1,f.dd,f.HH,f.mm,f.ss||0,1E3*f.sss||0)}return NaN}}function qb(a,b,d,c){return function(e,f,g,k,h,l,m){function n(a){return a&&!(a.getTime&&a.getTime()!==a.getTime())}function q(a){return t(a)&&!ia(a)?d(a)||void 0:a}Gc(e,f,g,k);Va(e,f,g,k,h,l);var p=k&&k.$options.getOption("timezone"),r;k.$$parserName=a;k.$parsers.push(function(a){if(k.$isEmpty(a))return null;if(b.test(a))return a=d(a,r),p&&(a=ac(a,p)),a});k.$formatters.push(function(a){if(a&&
!ia(a))throw rb("datefmt",a);if(n(a))return(r=a)&&p&&(r=ac(r,p,!0)),m("date")(a,c,p);r=null;return""});if(t(g.min)||g.ngMin){var w;k.$validators.min=function(a){return!n(a)||v(w)||d(a)>=w};g.$observe("min",function(a){w=q(a);k.$validate()})}if(t(g.max)||g.ngMax){var u;k.$validators.max=function(a){return!n(a)||v(u)||d(a)<=u};g.$observe("max",function(a){u=q(a);k.$validate()})}}}function Gc(a,b,d,c){(c.$$hasNativeValidators=G(b[0].validity))&&c.$parsers.push(function(a){var c=b.prop("validity")||{};
return c.badInput||c.typeMismatch?void 0:a})}function ee(a){a.$$parserName="number";a.$parsers.push(function(b){if(a.$isEmpty(b))return null;if(Ug.test(b))return parseFloat(b)});a.$formatters.push(function(b){if(!a.$isEmpty(b)){if(!W(b))throw rb("numfmt",b);b=b.toString()}return b})}function Wa(a){t(a)&&!W(a)&&(a=parseFloat(a));return ba(a)?void 0:a}function Hc(a){var b=a.toString(),d=b.indexOf(".");return-1===d?-1<a&&1>a&&(a=/e-(\d+)$/.exec(b))?Number(a[1]):0:b.length-d-1}function fe(a,b,d){a=Number(a);
var c=(a|0)!==a,e=(b|0)!==b,f=(d|0)!==d;if(c||e||f){var g=c?Hc(a):0,k=e?Hc(b):0,h=f?Hc(d):0,g=Math.max(g,k,h),g=Math.pow(10,g);a*=g;b*=g;d*=g;c&&(a=Math.round(a));e&&(b=Math.round(b));f&&(d=Math.round(d))}return 0===(a-b)%d}function ge(a,b,d,c,e){if(t(c)){a=a(c);if(!a.constant)throw rb("constexpr",d,c);return a(b)}return e}function Ic(a,b){function d(a,b){if(!a||!a.length)return[];if(!b||!b.length)return a;var c=[],d=0;a:for(;d<a.length;d++){for(var e=a[d],f=0;f<b.length;f++)if(e===b[f])continue a;
c.push(e)}return c}function c(a){var b=a;I(a)?b=a.map(c).join(" "):G(a)&&(b=Object.keys(a).filter(function(b){return a[b]}).join(" "));return b}function e(a){var b=a;if(I(a))b=a.map(e);else if(G(a)){var c=!1,b=Object.keys(a).filter(function(b){b=a[b];!c&&v(b)&&(c=!0);return b});c&&b.push(void 0)}return b}a="ngClass"+a;var f;return["$parse",function(g){return{restrict:"AC",link:function(k,h,l){function m(a,b){var c=[];p(a,function(a){if(0<b||A[a])A[a]=(A[a]||0)+b,A[a]===+(0<b)&&c.push(a)});return c.join(" ")}
function n(a){if(a===b){var c=s,c=m(c&&c.split(" "),1);l.$addClass(c)}else c=s,c=m(c&&c.split(" "),-1),l.$removeClass(c);v=a}function q(a){a=c(a);a!==s&&r(a)}function r(a){if(v===b){var c=s&&s.split(" "),e=a&&a.split(" "),g=d(c,e),c=d(e,c),g=m(g,-1),c=m(c,1);l.$addClass(c);l.$removeClass(g)}s=a}var t=l[a].trim(),w=":"===t.charAt(0)&&":"===t.charAt(1),t=g(t,w?e:c),u=w?q:r,A=h.data("$classCounts"),v=!0,s;A||(A=R(),h.data("$classCounts",A));"ngClass"!==a&&(f||(f=g("$index",function(a){return a&1})),
k.$watch(f,n));k.$watch(t,u,w)}}}]}function Pb(a,b,d,c,e,f,g,k,h){this.$modelValue=this.$viewValue=Number.NaN;this.$$rawModelValue=void 0;this.$validators={};this.$asyncValidators={};this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$untouched=!0;this.$touched=!1;this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$error={};this.$$success={};this.$pending=void 0;this.$name=h(d.name||"",!1)(a);this.$$parentForm=Nb;this.$options=Qb;this.$$parsedNgModel=e(d.ngModel);
this.$$parsedNgModelAssign=this.$$parsedNgModel.assign;this.$$ngModelGet=this.$$parsedNgModel;this.$$ngModelSet=this.$$parsedNgModelAssign;this.$$pendingDebounce=null;this.$$parserValid=void 0;this.$$currentValidationRunId=0;Object.defineProperty(this,"$$scope",{value:a});this.$$attr=d;this.$$element=c;this.$$animate=f;this.$$timeout=g;this.$$parse=e;this.$$q=k;this.$$exceptionHandler=b;$d(this);Vg(this)}function Vg(a){a.$$scope.$watch(function(b){b=a.$$ngModelGet(b);if(b!==a.$modelValue&&(a.$modelValue===
a.$modelValue||b===b)){a.$modelValue=a.$$rawModelValue=b;a.$$parserValid=void 0;for(var d=a.$formatters,c=d.length,e=b;c--;)e=d[c](e);a.$viewValue!==e&&(a.$$updateEmptyClasses(e),a.$viewValue=a.$$lastCommittedViewValue=e,a.$render(),a.$$runValidators(a.$modelValue,a.$viewValue,B))}return b})}function Jc(a){this.$$options=a}function he(a,b){p(b,function(b,c){t(a[c])||(a[c]=b)})}function Ha(a,b){a.prop("selected",b);a.attr("selected",b)}var Lc={objectMaxDepth:5},Wg=/^\/(.+)\/([a-z]*)$/,wa=Object.prototype.hasOwnProperty,
N=function(a){return C(a)?a.toLowerCase():a},wb=function(a){return C(a)?a.toUpperCase():a},Ba,z,ta,xa=[].slice,vg=[].splice,Xg=[].push,la=Object.prototype.toString,Oc=Object.getPrototypeOf,za=K("ng"),fa=x.angular||(x.angular={}),dc,sb=0;Ba=x.document.documentMode;var ba=Number.isNaN||function(a){return a!==a};B.$inject=[];ab.$inject=[];var I=Array.isArray,te=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array]$/,P=function(a){return C(a)?a.trim():a},Nd=function(a){return a.replace(/([-()[\]{}+?*.$^|,:#<!\\])/g,
"\\$1").replace(/\x08/g,"\\x08")},Ja=function(){if(!t(Ja.rules)){var a=x.document.querySelector("[ng-csp]")||x.document.querySelector("[data-ng-csp]");if(a){var b=a.getAttribute("ng-csp")||a.getAttribute("data-ng-csp");Ja.rules={noUnsafeEval:!b||-1!==b.indexOf("no-unsafe-eval"),noInlineStyle:!b||-1!==b.indexOf("no-inline-style")}}else{a=Ja;try{new Function(""),b=!1}catch(d){b=!0}a.rules={noUnsafeEval:b,noInlineStyle:!1}}}return Ja.rules},tb=function(){if(t(tb.name_))return tb.name_;var a,b,d=Na.length,
c,e;for(b=0;b<d;++b)if(c=Na[b],a=x.document.querySelector("["+c.replace(":","\\:")+"jq]")){e=a.getAttribute(c+"jq");break}return tb.name_=e},ve=/:/g,Na=["ng-","data-ng-","ng:","x-ng-"],ye=function(a){var b=a.currentScript;if(!b)return!0;if(!(b instanceof x.HTMLScriptElement||b instanceof x.SVGScriptElement))return!1;b=b.attributes;return[b.getNamedItem("src"),b.getNamedItem("href"),b.getNamedItem("xlink:href")].every(function(b){if(!b)return!0;if(!b.value)return!1;var c=a.createElement("a");c.href=
b.value;if(a.location.origin===c.origin)return!0;switch(c.protocol){case "http:":case "https:":case "ftp:":case "blob:":case "file:":case "data:":return!0;default:return!1}})}(x.document),Be=/[A-Z]/g,Wc=!1,Ma=3,Ge={full:"1.6.5",major:1,minor:6,dot:5,codeName:"toffee-salinization"};S.expando="ng339";var jb=S.cache={},hg=1;S._data=function(a){return this.cache[a[this.expando]]||{}};var dg=/-([a-z])/g,Yg=/^-ms-/,Bb={mouseleave:"mouseout",mouseenter:"mouseover"},gc=K("jqLite"),gg=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,
fc=/<|&#?\w+;/,eg=/<([\w:-]+)/,fg=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,pa={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};pa.optgroup=pa.option;pa.tbody=pa.tfoot=pa.colgroup=pa.caption=pa.thead;pa.th=pa.td;var mg=x.Node.prototype.contains||function(a){return!!(this.compareDocumentPosition(a)&
16)},Ra=S.prototype={ready:gd,toString:function(){var a=[];p(this,function(b){a.push(""+b)});return"["+a.join(", ")+"]"},eq:function(a){return 0<=a?z(this[a]):z(this[this.length+a])},length:0,push:Xg,sort:[].sort,splice:[].splice},Hb={};p("multiple selected checked disabled readOnly required open".split(" "),function(a){Hb[N(a)]=a});var ld={};p("input select option textarea button form details".split(" "),function(a){ld[a]=!0});var td={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",
ngPattern:"pattern",ngStep:"step"};p({data:kc,removeData:jc,hasData:function(a){for(var b in jb[a.ng339])return!0;return!1},cleanData:function(a){for(var b=0,d=a.length;b<d;b++)jc(a[b])}},function(a,b){S[b]=a});p({data:kc,inheritedData:Fb,scope:function(a){return z.data(a,"$scope")||Fb(a.parentNode||a,["$isolateScope","$scope"])},isolateScope:function(a){return z.data(a,"$isolateScope")||z.data(a,"$isolateScopeNoTemplate")},controller:id,injector:function(a){return Fb(a,"$injector")},removeAttr:function(a,
b){a.removeAttribute(b)},hasClass:Cb,css:function(a,b,d){b=yb(b.replace(Yg,"ms-"));if(t(d))a.style[b]=d;else return a.style[b]},attr:function(a,b,d){var c=a.nodeType;if(c!==Ma&&2!==c&&8!==c&&a.getAttribute){var c=N(b),e=Hb[c];if(t(d))null===d||!1===d&&e?a.removeAttribute(b):a.setAttribute(b,e?c:d);else return a=a.getAttribute(b),e&&null!==a&&(a=c),null===a?void 0:a}},prop:function(a,b,d){if(t(d))a[b]=d;else return a[b]},text:function(){function a(a,d){if(v(d)){var c=a.nodeType;return 1===c||c===Ma?
a.textContent:""}a.textContent=d}a.$dv="";return a}(),val:function(a,b){if(v(b)){if(a.multiple&&"select"===ya(a)){var d=[];p(a.options,function(a){a.selected&&d.push(a.value||a.text)});return d}return a.value}a.value=b},html:function(a,b){if(v(b))return a.innerHTML;zb(a,!0);a.innerHTML=b},empty:jd},function(a,b){S.prototype[b]=function(b,c){var e,f,g=this.length;if(a!==jd&&v(2===a.length&&a!==Cb&&a!==id?b:c)){if(G(b)){for(e=0;e<g;e++)if(a===kc)a(this[e],b);else for(f in b)a(this[e],f,b[f]);return this}e=
a.$dv;g=v(e)?Math.min(g,1):g;for(f=0;f<g;f++){var k=a(this[f],b,c);e=e?e+k:k}return e}for(e=0;e<g;e++)a(this[e],b,c);return this}});p({removeData:jc,on:function(a,b,d,c){if(t(c))throw gc("onargs");if(ec(a)){c=Ab(a,!0);var e=c.events,f=c.handle;f||(f=c.handle=jg(a,e));c=0<=b.indexOf(" ")?b.split(" "):[b];for(var g=c.length,k=function(b,c,g){var k=e[b];k||(k=e[b]=[],k.specialHandlerWrapper=c,"$destroy"===b||g||a.addEventListener(b,f));k.push(d)};g--;)b=c[g],Bb[b]?(k(Bb[b],lg),k(b,void 0,!0)):k(b)}},
off:hd,one:function(a,b,d){a=z(a);a.on(b,function e(){a.off(b,d);a.off(b,e)});a.on(b,d)},replaceWith:function(a,b){var d,c=a.parentNode;zb(a);p(new S(b),function(b){d?c.insertBefore(b,d.nextSibling):c.replaceChild(b,a);d=b})},children:function(a){var b=[];p(a.childNodes,function(a){1===a.nodeType&&b.push(a)});return b},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,b){var d=a.nodeType;if(1===d||11===d){b=new S(b);for(var d=0,c=b.length;d<c;d++)a.appendChild(b[d])}},
prepend:function(a,b){if(1===a.nodeType){var d=a.firstChild;p(new S(b),function(b){a.insertBefore(b,d)})}},wrap:function(a,b){var d=z(b).eq(0).clone()[0],c=a.parentNode;c&&c.replaceChild(d,a);d.appendChild(a)},remove:Gb,detach:function(a){Gb(a,!0)},after:function(a,b){var d=a,c=a.parentNode;if(c){b=new S(b);for(var e=0,f=b.length;e<f;e++){var g=b[e];c.insertBefore(g,d.nextSibling);d=g}}},addClass:Eb,removeClass:Db,toggleClass:function(a,b,d){b&&p(b.split(" "),function(b){var e=d;v(e)&&(e=!Cb(a,b));
(e?Eb:Db)(a,b)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){return a.nextElementSibling},find:function(a,b){return a.getElementsByTagName?a.getElementsByTagName(b):[]},clone:ic,triggerHandler:function(a,b,d){var c,e,f=b.type||b,g=Ab(a);if(g=(g=g&&g.events)&&g[f])c={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===
this.immediatePropagationStopped},stopPropagation:B,type:f,target:a},b.type&&(c=O(c,b)),b=ra(g),e=d?[c].concat(d):[c],p(b,function(b){c.isImmediatePropagationStopped()||b.apply(a,e)})}},function(a,b){S.prototype[b]=function(b,c,e){for(var f,g=0,k=this.length;g<k;g++)v(f)?(f=a(this[g],b,c,e),t(f)&&(f=z(f))):hc(f,a(this[g],b,c,e));return t(f)?f:this}});S.prototype.bind=S.prototype.on;S.prototype.unbind=S.prototype.off;var Zg=Object.create(null);md.prototype={_idx:function(a){if(a===this._lastKey)return this._lastIndex;
this._lastKey=a;return this._lastIndex=this._keys.indexOf(a)},_transformKey:function(a){return ba(a)?Zg:a},get:function(a){a=this._transformKey(a);a=this._idx(a);if(-1!==a)return this._values[a]},set:function(a,b){a=this._transformKey(a);var d=this._idx(a);-1===d&&(d=this._lastIndex=this._keys.length);this._keys[d]=a;this._values[d]=b},delete:function(a){a=this._transformKey(a);a=this._idx(a);if(-1===a)return!1;this._keys.splice(a,1);this._values.splice(a,1);this._lastKey=NaN;this._lastIndex=-1;return!0}};
var Ib=md,bg=[function(){this.$get=[function(){return Ib}]}],og=/^([^(]+?)=>/,pg=/^[^(]*\(\s*([^)]*)\)/m,$g=/,/,ah=/^\s*(_?)(\S+?)\1\s*$/,ng=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,Ka=K("$injector");gb.$$annotate=function(a,b,d){var c;if("function"===typeof a){if(!(c=a.$inject)){c=[];if(a.length){if(b)throw C(d)&&d||(d=a.name||qg(a)),Ka("strictdi",d);b=nd(a);p(b[1].split($g),function(a){a.replace(ah,function(a,b,d){c.push(d)})})}a.$inject=c}}else I(a)?(b=a.length-1,ub(a[b],"fn"),c=a.slice(0,b)):ub(a,"fn",
!0);return c};var ie=K("$animate"),tf=function(){this.$get=B},uf=function(){var a=new Ib,b=[];this.$get=["$$AnimateRunner","$rootScope",function(d,c){function e(a,b,c){var d=!1;b&&(b=C(b)?b.split(" "):I(b)?b:[],p(b,function(b){b&&(d=!0,a[b]=c)}));return d}function f(){p(b,function(b){var c=a.get(b);if(c){var d=rg(b.attr("class")),e="",f="";p(c,function(a,b){a!==!!d[b]&&(a?e+=(e.length?" ":"")+b:f+=(f.length?" ":"")+b)});p(b,function(a){e&&Eb(a,e);f&&Db(a,f)});a.delete(b)}});b.length=0}return{enabled:B,
on:B,off:B,pin:B,push:function(g,k,h,l){l&&l();h=h||{};h.from&&g.css(h.from);h.to&&g.css(h.to);if(h.addClass||h.removeClass)if(k=h.addClass,l=h.removeClass,h=a.get(g)||{},k=e(h,k,!0),l=e(h,l,!1),k||l)a.set(g,h),b.push(g),1===b.length&&c.$$postDigest(f);g=new d;g.complete();return g}}}]},rf=["$provide",function(a){var b=this,d=null,c=null;this.$$registeredAnimations=Object.create(null);this.register=function(c,d){if(c&&"."!==c.charAt(0))throw ie("notcsel",c);var g=c+"-animation";b.$$registeredAnimations[c.substr(1)]=
g;a.factory(g,d)};this.customFilter=function(a){1===arguments.length&&(c=E(a)?a:null);return c};this.classNameFilter=function(a){if(1===arguments.length&&(d=a instanceof RegExp?a:null)&&/[(\s|\/)]ng-animate[(\s|\/)]/.test(d.toString()))throw d=null,ie("nongcls","ng-animate");return d};this.$get=["$$animateQueue",function(a){function b(a,c,d){if(d){var e;a:{for(e=0;e<d.length;e++){var f=d[e];if(1===f.nodeType){e=f;break a}}e=void 0}!e||e.parentNode||e.previousElementSibling||(d=null)}d?d.after(a):
c.prepend(a)}return{on:a.on,off:a.off,pin:a.pin,enabled:a.enabled,cancel:function(a){a.end&&a.end()},enter:function(c,d,h,l){d=d&&z(d);h=h&&z(h);d=d||h.parent();b(c,d,h);return a.push(c,"enter",Ca(l))},move:function(c,d,h,l){d=d&&z(d);h=h&&z(h);d=d||h.parent();b(c,d,h);return a.push(c,"move",Ca(l))},leave:function(b,c){return a.push(b,"leave",Ca(c),function(){b.remove()})},addClass:function(b,c,d){d=Ca(d);d.addClass=kb(d.addclass,c);return a.push(b,"addClass",d)},removeClass:function(b,c,d){d=Ca(d);
d.removeClass=kb(d.removeClass,c);return a.push(b,"removeClass",d)},setClass:function(b,c,d,f){f=Ca(f);f.addClass=kb(f.addClass,c);f.removeClass=kb(f.removeClass,d);return a.push(b,"setClass",f)},animate:function(b,c,d,f,m){m=Ca(m);m.from=m.from?O(m.from,c):c;m.to=m.to?O(m.to,d):d;m.tempClasses=kb(m.tempClasses,f||"ng-inline-animate");return a.push(b,"animate",m)}}}]}],wf=function(){this.$get=["$$rAF",function(a){function b(b){d.push(b);1<d.length||a(function(){for(var a=0;a<d.length;a++)d[a]();d=
[]})}var d=[];return function(){var a=!1;b(function(){a=!0});return function(d){a?d():b(d)}}}]},vf=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$$isDocumentHidden","$timeout",function(a,b,d,c,e){function f(a){this.setHost(a);var b=d();this._doneCallbacks=[];this._tick=function(a){c()?e(a,0,!1):b(a)};this._state=0}f.chain=function(a,b){function c(){if(d===a.length)b(!0);else a[d](function(a){!1===a?b(!1):(d++,c())})}var d=0;c()};f.all=function(a,b){function c(f){e=e&&f;++d===a.length&&
b(e)}var d=0,e=!0;p(a,function(a){a.done(c)})};f.prototype={setHost:function(a){this.host=a||{}},done:function(a){2===this._state?a():this._doneCallbacks.push(a)},progress:B,getPromise:function(){if(!this.promise){var b=this;this.promise=a(function(a,c){b.done(function(b){!1===b?c():a()})})}return this.promise},then:function(a,b){return this.getPromise().then(a,b)},"catch":function(a){return this.getPromise()["catch"](a)},"finally":function(a){return this.getPromise()["finally"](a)},pause:function(){this.host.pause&&
this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end();this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel();this._resolve(!1)},complete:function(a){var b=this;0===b._state&&(b._state=1,b._tick(function(){b._resolve(a)}))},_resolve:function(a){2!==this._state&&(p(this._doneCallbacks,function(b){b(a)}),this._doneCallbacks.length=0,this._state=2)}};return f}]},sf=function(){this.$get=["$$rAF","$q","$$AnimateRunner",
function(a,b,d){return function(b,e){function f(){a(function(){g.addClass&&(b.addClass(g.addClass),g.addClass=null);g.removeClass&&(b.removeClass(g.removeClass),g.removeClass=null);g.to&&(b.css(g.to),g.to=null);k||h.complete();k=!0});return h}var g=e||{};g.$$prepared||(g=Ia(g));g.cleanupStyles&&(g.from=g.to=null);g.from&&(b.css(g.from),g.from=null);var k,h=new d;return{start:f,end:f}}}]},ga=K("$compile"),oc=new function(){};Yc.$inject=["$provide","$$sanitizeUriProvider"];Jb.prototype.isFirstChange=
function(){return this.previousValue===oc};var od=/^((?:x|data)[:\-_])/i,ug=/[:\-_]+(.)/g,vd=K("$controller"),ud=/^(\S+)(\s+as\s+([\w$]+))?$/,Df=function(){this.$get=["$document",function(a){return function(b){b?!b.nodeType&&b instanceof z&&(b=b[0]):b=a[0].body;return b.offsetWidth+1}}]},wd="application/json",sc={"Content-Type":wd+";charset=utf-8"},xg=/^\[|^\{(?!\{)/,yg={"[":/]$/,"{":/}$/},wg=/^\)]\}',?\n/,rc=K("$http"),Fa=fa.$interpolateMinErr=K("$interpolate");Fa.throwNoconcat=function(a){throw Fa("noconcat",
a);};Fa.interr=function(a,b){return Fa("interr",a,b.toString())};var Lf=function(){this.$get=function(){function a(a){var b=function(a){b.data=a;b.called=!0};b.id=a;return b}var b=fa.callbacks,d={};return{createCallback:function(c){c="_"+(b.$$counter++).toString(36);var e="angular.callbacks."+c,f=a(c);d[e]=b[c]=f;return e},wasCalled:function(a){return d[a].called},getResponse:function(a){return d[a].data},removeCallback:function(a){delete b[d[a].id];delete d[a]}}}},bh=/^([^?#]*)(\?([^#]*))?(#(.*))?$/,
Ag={http:80,https:443,ftp:21},mb=K("$location"),Bg=/^\s*[\\/]{2,}/,ch={$$absUrl:"",$$html5:!1,$$replace:!1,absUrl:Kb("$$absUrl"),url:function(a){if(v(a))return this.$$url;var b=bh.exec(a);(b[1]||""===a)&&this.path(decodeURIComponent(b[1]));(b[2]||b[1]||""===a)&&this.search(b[3]||"");this.hash(b[5]||"");return this},protocol:Kb("$$protocol"),host:Kb("$$host"),port:Kb("$$port"),path:Ed("$$path",function(a){a=null!==a?a.toString():"";return"/"===a.charAt(0)?a:"/"+a}),search:function(a,b){switch(arguments.length){case 0:return this.$$search;
case 1:if(C(a)||W(a))a=a.toString(),this.$$search=Tc(a);else if(G(a))a=Ia(a,{}),p(a,function(b,c){null==b&&delete a[c]}),this.$$search=a;else throw mb("isrcharg");break;default:v(b)||null===b?delete this.$$search[a]:this.$$search[a]=b}this.$$compose();return this},hash:Ed("$$hash",function(a){return null!==a?a.toString():""}),replace:function(){this.$$replace=!0;return this}};p([Dd,wc,vc],function(a){a.prototype=Object.create(ch);a.prototype.state=function(b){if(!arguments.length)return this.$$state;
if(a!==vc||!this.$$html5)throw mb("nostate");this.$$state=v(b)?null:b;this.$$urlUpdatedByLocation=!0;return this}});var Xa=K("$parse"),Fg={}.constructor.prototype.valueOf,Rb=R();p("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(a){Rb[a]=!0});var dh={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},zc=function(a){this.options=a};zc.prototype={constructor:zc,lex:function(a){this.text=a;this.index=0;for(this.tokens=[];this.index<this.text.length;)if(a=this.text.charAt(this.index),
'"'===a||"'"===a)this.readString(a);else if(this.isNumber(a)||"."===a&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(a,"(){}[].,;:?"))this.tokens.push({index:this.index,text:a}),this.index++;else if(this.isWhitespace(a))this.index++;else{var b=a+this.peek(),d=b+this.peek(2),c=Rb[b],e=Rb[d];Rb[a]||c||e?(a=e?d:c?b:a,this.tokens.push({index:this.index,text:a,operator:!0}),this.index+=a.length):this.throwError("Unexpected next character ",
this.index,this.index+1)}return this.tokens},is:function(a,b){return-1!==b.indexOf(a)},peek:function(a){a=a||1;return this.index+a<this.text.length?this.text.charAt(this.index+a):!1},isNumber:function(a){return"0"<=a&&"9">=a&&"string"===typeof a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||"\u00a0"===a},isIdentifierStart:function(a){return this.options.isIdentifierStart?this.options.isIdentifierStart(a,this.codePointAt(a)):this.isValidIdentifierStart(a)},isValidIdentifierStart:function(a){return"a"<=
a&&"z">=a||"A"<=a&&"Z">=a||"_"===a||"$"===a},isIdentifierContinue:function(a){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(a,this.codePointAt(a)):this.isValidIdentifierContinue(a)},isValidIdentifierContinue:function(a,b){return this.isValidIdentifierStart(a,b)||this.isNumber(a)},codePointAt:function(a){return 1===a.length?a.charCodeAt(0):(a.charCodeAt(0)<<10)+a.charCodeAt(1)-56613888},peekMultichar:function(){var a=this.text.charAt(this.index),b=this.peek();if(!b)return a;
var d=a.charCodeAt(0),c=b.charCodeAt(0);return 55296<=d&&56319>=d&&56320<=c&&57343>=c?a+b:a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,b,d){d=d||this.index;b=t(b)?"s "+b+"-"+this.index+" ["+this.text.substring(b,d)+"]":" "+d;throw Xa("lexerr",a,b,this.text);},readNumber:function(){for(var a="",b=this.index;this.index<this.text.length;){var d=N(this.text.charAt(this.index));if("."===d||this.isNumber(d))a+=d;else{var c=this.peek();if("e"===d&&this.isExpOperator(c))a+=
d;else if(this.isExpOperator(d)&&c&&this.isNumber(c)&&"e"===a.charAt(a.length-1))a+=d;else if(!this.isExpOperator(d)||c&&this.isNumber(c)||"e"!==a.charAt(a.length-1))break;else this.throwError("Invalid exponent")}this.index++}this.tokens.push({index:b,text:a,constant:!0,value:Number(a)})},readIdent:function(){var a=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var b=this.peekMultichar();if(!this.isIdentifierContinue(b))break;this.index+=b.length}this.tokens.push({index:a,
text:this.text.slice(a,this.index),identifier:!0})},readString:function(a){var b=this.index;this.index++;for(var d="",c=a,e=!1;this.index<this.text.length;){var f=this.text.charAt(this.index),c=c+f;if(e)"u"===f?(e=this.text.substring(this.index+1,this.index+5),e.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+e+"]"),this.index+=4,d+=String.fromCharCode(parseInt(e,16))):d+=dh[f]||f,e=!1;else if("\\"===f)e=!0;else{if(f===a){this.index++;this.tokens.push({index:b,text:c,constant:!0,
value:d});return}d+=f}this.index++}this.throwError("Unterminated quote",b)}};var r=function(a,b){this.lexer=a;this.options=b};r.Program="Program";r.ExpressionStatement="ExpressionStatement";r.AssignmentExpression="AssignmentExpression";r.ConditionalExpression="ConditionalExpression";r.LogicalExpression="LogicalExpression";r.BinaryExpression="BinaryExpression";r.UnaryExpression="UnaryExpression";r.CallExpression="CallExpression";r.MemberExpression="MemberExpression";r.Identifier="Identifier";r.Literal=
"Literal";r.ArrayExpression="ArrayExpression";r.Property="Property";r.ObjectExpression="ObjectExpression";r.ThisExpression="ThisExpression";r.LocalsExpression="LocalsExpression";r.NGValueParameter="NGValueParameter";r.prototype={ast:function(a){this.text=a;this.tokens=this.lexer.lex(a);a=this.program();0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]);return a},program:function(){for(var a=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&a.push(this.expressionStatement()),
!this.expect(";"))return{type:r.Program,body:a}},expressionStatement:function(){return{type:r.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var a=this.expression();this.expect("|");)a=this.filter(a);return a},expression:function(){return this.assignment()},assignment:function(){var a=this.ternary();if(this.expect("=")){if(!Id(a))throw Xa("lval");a={type:r.AssignmentExpression,left:a,right:this.assignment(),operator:"="}}return a},ternary:function(){var a=this.logicalOR(),
b,d;return this.expect("?")&&(b=this.expression(),this.consume(":"))?(d=this.expression(),{type:r.ConditionalExpression,test:a,alternate:b,consequent:d}):a},logicalOR:function(){for(var a=this.logicalAND();this.expect("||");)a={type:r.LogicalExpression,operator:"||",left:a,right:this.logicalAND()};return a},logicalAND:function(){for(var a=this.equality();this.expect("&&");)a={type:r.LogicalExpression,operator:"&&",left:a,right:this.equality()};return a},equality:function(){for(var a=this.relational(),
b;b=this.expect("==","!=","===","!==");)a={type:r.BinaryExpression,operator:b.text,left:a,right:this.relational()};return a},relational:function(){for(var a=this.additive(),b;b=this.expect("<",">","<=",">=");)a={type:r.BinaryExpression,operator:b.text,left:a,right:this.additive()};return a},additive:function(){for(var a=this.multiplicative(),b;b=this.expect("+","-");)a={type:r.BinaryExpression,operator:b.text,left:a,right:this.multiplicative()};return a},multiplicative:function(){for(var a=this.unary(),
b;b=this.expect("*","/","%");)a={type:r.BinaryExpression,operator:b.text,left:a,right:this.unary()};return a},unary:function(){var a;return(a=this.expect("+","-","!"))?{type:r.UnaryExpression,operator:a.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var a;this.expect("(")?(a=this.filterChain(),this.consume(")")):this.expect("[")?a=this.arrayDeclaration():this.expect("{")?a=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?a=Ia(this.selfReferential[this.consume().text]):
this.options.literals.hasOwnProperty(this.peek().text)?a={type:r.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?a=this.identifier():this.peek().constant?a=this.constant():this.throwError("not a primary expression",this.peek());for(var b;b=this.expect("(","[",".");)"("===b.text?(a={type:r.CallExpression,callee:a,arguments:this.parseArguments()},this.consume(")")):"["===b.text?(a={type:r.MemberExpression,object:a,property:this.expression(),computed:!0},this.consume("]")):
"."===b.text?a={type:r.MemberExpression,object:a,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return a},filter:function(a){a=[a];for(var b={type:r.CallExpression,callee:this.identifier(),arguments:a,filter:!0};this.expect(":");)a.push(this.expression());return b},parseArguments:function(){var a=[];if(")"!==this.peekToken().text){do a.push(this.filterChain());while(this.expect(","))}return a},identifier:function(){var a=this.consume();a.identifier||this.throwError("is not a valid identifier",
a);return{type:r.Identifier,name:a.text}},constant:function(){return{type:r.Literal,value:this.consume().value}},arrayDeclaration:function(){var a=[];if("]"!==this.peekToken().text){do{if(this.peek("]"))break;a.push(this.expression())}while(this.expect(","))}this.consume("]");return{type:r.ArrayExpression,elements:a}},object:function(){var a=[],b;if("}"!==this.peekToken().text){do{if(this.peek("}"))break;b={type:r.Property,kind:"init"};this.peek().constant?(b.key=this.constant(),b.computed=!1,this.consume(":"),
b.value=this.expression()):this.peek().identifier?(b.key=this.identifier(),b.computed=!1,this.peek(":")?(this.consume(":"),b.value=this.expression()):b.value=b.key):this.peek("[")?(this.consume("["),b.key=this.expression(),this.consume("]"),b.computed=!0,this.consume(":"),b.value=this.expression()):this.throwError("invalid key",this.peek());a.push(b)}while(this.expect(","))}this.consume("}");return{type:r.ObjectExpression,properties:a}},throwError:function(a,b){throw Xa("syntax",b.text,a,b.index+
1,this.text,this.text.substring(b.index));},consume:function(a){if(0===this.tokens.length)throw Xa("ueoe",this.text);var b=this.expect(a);b||this.throwError("is unexpected, expecting ["+a+"]",this.peek());return b},peekToken:function(){if(0===this.tokens.length)throw Xa("ueoe",this.text);return this.tokens[0]},peek:function(a,b,d,c){return this.peekAhead(0,a,b,d,c)},peekAhead:function(a,b,d,c,e){if(this.tokens.length>a){a=this.tokens[a];var f=a.text;if(f===b||f===d||f===c||f===e||!(b||d||c||e))return a}return!1},
expect:function(a,b,d,c){return(a=this.peek(a,b,d,c))?(this.tokens.shift(),a):!1},selfReferential:{"this":{type:r.ThisExpression},$locals:{type:r.LocalsExpression}}};var Gd=2;Kd.prototype={compile:function(a){var b=this;this.state={nextId:0,filters:{},fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]};X(a,b.$filter);var d="",c;this.stage="assign";if(c=Jd(a))this.state.computing="assign",d=this.nextId(),this.recurse(c,d),this.return_(d),d="fn.assign="+this.generateFunction("assign",
"s,v,l");c=Hd(a.body);b.stage="inputs";p(c,function(a,c){var d="fn"+c;b.state[d]={vars:[],body:[],own:{}};b.state.computing=d;var k=b.nextId();b.recurse(a,k);b.return_(k);b.state.inputs.push({name:d,isPure:a.isPure});a.watchId=c});this.state.computing="fn";this.stage="main";this.recurse(a);a='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+d+this.watchFns()+"return fn;";a=(new Function("$filter","getStringValue","ifDefined","plus",a))(this.$filter,
Cg,Dg,Fd);this.state=this.stage=void 0;return a},USE:"use",STRICT:"strict",watchFns:function(){var a=[],b=this.state.inputs,d=this;p(b,function(b){a.push("var "+b.name+"="+d.generateFunction(b.name,"s"));b.isPure&&a.push(b.name,".isPure="+JSON.stringify(b.isPure)+";")});b.length&&a.push("fn.inputs=["+b.map(function(a){return a.name}).join(",")+"];");return a.join("")},generateFunction:function(a,b){return"function("+b+"){"+this.varsPrefix(a)+this.body(a)+"};"},filterPrefix:function(){var a=[],b=this;
p(this.state.filters,function(d,c){a.push(d+"=$filter("+b.escape(c)+")")});return a.length?"var "+a.join(",")+";":""},varsPrefix:function(a){return this.state[a].vars.length?"var "+this.state[a].vars.join(",")+";":""},body:function(a){return this.state[a].body.join("")},recurse:function(a,b,d,c,e,f){var g,k,h=this,l,m,n;c=c||B;if(!f&&t(a.watchId))b=b||this.nextId(),this.if_("i",this.lazyAssign(b,this.computedMember("i",a.watchId)),this.lazyRecurse(a,b,d,c,e,!0));else switch(a.type){case r.Program:p(a.body,
function(b,c){h.recurse(b.expression,void 0,void 0,function(a){k=a});c!==a.body.length-1?h.current().body.push(k,";"):h.return_(k)});break;case r.Literal:m=this.escape(a.value);this.assign(b,m);c(b||m);break;case r.UnaryExpression:this.recurse(a.argument,void 0,void 0,function(a){k=a});m=a.operator+"("+this.ifDefined(k,0)+")";this.assign(b,m);c(m);break;case r.BinaryExpression:this.recurse(a.left,void 0,void 0,function(a){g=a});this.recurse(a.right,void 0,void 0,function(a){k=a});m="+"===a.operator?
this.plus(g,k):"-"===a.operator?this.ifDefined(g,0)+a.operator+this.ifDefined(k,0):"("+g+")"+a.operator+"("+k+")";this.assign(b,m);c(m);break;case r.LogicalExpression:b=b||this.nextId();h.recurse(a.left,b);h.if_("&&"===a.operator?b:h.not(b),h.lazyRecurse(a.right,b));c(b);break;case r.ConditionalExpression:b=b||this.nextId();h.recurse(a.test,b);h.if_(b,h.lazyRecurse(a.alternate,b),h.lazyRecurse(a.consequent,b));c(b);break;case r.Identifier:b=b||this.nextId();d&&(d.context="inputs"===h.stage?"s":this.assign(this.nextId(),
this.getHasOwnProperty("l",a.name)+"?l:s"),d.computed=!1,d.name=a.name);h.if_("inputs"===h.stage||h.not(h.getHasOwnProperty("l",a.name)),function(){h.if_("inputs"===h.stage||"s",function(){e&&1!==e&&h.if_(h.isNull(h.nonComputedMember("s",a.name)),h.lazyAssign(h.nonComputedMember("s",a.name),"{}"));h.assign(b,h.nonComputedMember("s",a.name))})},b&&h.lazyAssign(b,h.nonComputedMember("l",a.name)));c(b);break;case r.MemberExpression:g=d&&(d.context=this.nextId())||this.nextId();b=b||this.nextId();h.recurse(a.object,
g,void 0,function(){h.if_(h.notNull(g),function(){a.computed?(k=h.nextId(),h.recurse(a.property,k),h.getStringValue(k),e&&1!==e&&h.if_(h.not(h.computedMember(g,k)),h.lazyAssign(h.computedMember(g,k),"{}")),m=h.computedMember(g,k),h.assign(b,m),d&&(d.computed=!0,d.name=k)):(e&&1!==e&&h.if_(h.isNull(h.nonComputedMember(g,a.property.name)),h.lazyAssign(h.nonComputedMember(g,a.property.name),"{}")),m=h.nonComputedMember(g,a.property.name),h.assign(b,m),d&&(d.computed=!1,d.name=a.property.name))},function(){h.assign(b,
"undefined")});c(b)},!!e);break;case r.CallExpression:b=b||this.nextId();a.filter?(k=h.filter(a.callee.name),l=[],p(a.arguments,function(a){var b=h.nextId();h.recurse(a,b);l.push(b)}),m=k+"("+l.join(",")+")",h.assign(b,m),c(b)):(k=h.nextId(),g={},l=[],h.recurse(a.callee,k,g,function(){h.if_(h.notNull(k),function(){p(a.arguments,function(b){h.recurse(b,a.constant?void 0:h.nextId(),void 0,function(a){l.push(a)})});m=g.name?h.member(g.context,g.name,g.computed)+"("+l.join(",")+")":k+"("+l.join(",")+
")";h.assign(b,m)},function(){h.assign(b,"undefined")});c(b)}));break;case r.AssignmentExpression:k=this.nextId();g={};this.recurse(a.left,void 0,g,function(){h.if_(h.notNull(g.context),function(){h.recurse(a.right,k);m=h.member(g.context,g.name,g.computed)+a.operator+k;h.assign(b,m);c(b||m)})},1);break;case r.ArrayExpression:l=[];p(a.elements,function(b){h.recurse(b,a.constant?void 0:h.nextId(),void 0,function(a){l.push(a)})});m="["+l.join(",")+"]";this.assign(b,m);c(b||m);break;case r.ObjectExpression:l=
[];n=!1;p(a.properties,function(a){a.computed&&(n=!0)});n?(b=b||this.nextId(),this.assign(b,"{}"),p(a.properties,function(a){a.computed?(g=h.nextId(),h.recurse(a.key,g)):g=a.key.type===r.Identifier?a.key.name:""+a.key.value;k=h.nextId();h.recurse(a.value,k);h.assign(h.member(b,g,a.computed),k)})):(p(a.properties,function(b){h.recurse(b.value,a.constant?void 0:h.nextId(),void 0,function(a){l.push(h.escape(b.key.type===r.Identifier?b.key.name:""+b.key.value)+":"+a)})}),m="{"+l.join(",")+"}",this.assign(b,
m));c(b||m);break;case r.ThisExpression:this.assign(b,"s");c(b||"s");break;case r.LocalsExpression:this.assign(b,"l");c(b||"l");break;case r.NGValueParameter:this.assign(b,"v"),c(b||"v")}},getHasOwnProperty:function(a,b){var d=a+"."+b,c=this.current().own;c.hasOwnProperty(d)||(c[d]=this.nextId(!1,a+"&&("+this.escape(b)+" in "+a+")"));return c[d]},assign:function(a,b){if(a)return this.current().body.push(a,"=",b,";"),a},filter:function(a){this.state.filters.hasOwnProperty(a)||(this.state.filters[a]=
this.nextId(!0));return this.state.filters[a]},ifDefined:function(a,b){return"ifDefined("+a+","+this.escape(b)+")"},plus:function(a,b){return"plus("+a+","+b+")"},return_:function(a){this.current().body.push("return ",a,";")},if_:function(a,b,d){if(!0===a)b();else{var c=this.current().body;c.push("if(",a,"){");b();c.push("}");d&&(c.push("else{"),d(),c.push("}"))}},not:function(a){return"!("+a+")"},isNull:function(a){return a+"==null"},notNull:function(a){return a+"!=null"},nonComputedMember:function(a,
b){var d=/[^$_a-zA-Z0-9]/g;return/^[$_a-zA-Z][$_a-zA-Z0-9]*$/.test(b)?a+"."+b:a+'["'+b.replace(d,this.stringEscapeFn)+'"]'},computedMember:function(a,b){return a+"["+b+"]"},member:function(a,b,d){return d?this.computedMember(a,b):this.nonComputedMember(a,b)},getStringValue:function(a){this.assign(a,"getStringValue("+a+")")},lazyRecurse:function(a,b,d,c,e,f){var g=this;return function(){g.recurse(a,b,d,c,e,f)}},lazyAssign:function(a,b){var d=this;return function(){d.assign(a,b)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,
stringEscapeFn:function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)},escape:function(a){if(C(a))return"'"+a.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(W(a))return a.toString();if(!0===a)return"true";if(!1===a)return"false";if(null===a)return"null";if("undefined"===typeof a)return"undefined";throw Xa("esc");},nextId:function(a,b){var d="v"+this.state.nextId++;a||this.current().vars.push(d+(b?"="+b:""));return d},current:function(){return this.state[this.state.computing]}};
Ld.prototype={compile:function(a){var b=this;X(a,b.$filter);var d,c;if(d=Jd(a))c=this.recurse(d);d=Hd(a.body);var e;d&&(e=[],p(d,function(a,c){var d=b.recurse(a);d.isPure=a.isPure;a.input=d;e.push(d);a.watchId=c}));var f=[];p(a.body,function(a){f.push(b.recurse(a.expression))});a=0===a.body.length?B:1===a.body.length?f[0]:function(a,b){var c;p(f,function(d){c=d(a,b)});return c};c&&(a.assign=function(a,b,d){return c(a,d,b)});e&&(a.inputs=e);return a},recurse:function(a,b,d){var c,e,f=this,g;if(a.input)return this.inputs(a.input,
a.watchId);switch(a.type){case r.Literal:return this.value(a.value,b);case r.UnaryExpression:return e=this.recurse(a.argument),this["unary"+a.operator](e,b);case r.BinaryExpression:return c=this.recurse(a.left),e=this.recurse(a.right),this["binary"+a.operator](c,e,b);case r.LogicalExpression:return c=this.recurse(a.left),e=this.recurse(a.right),this["binary"+a.operator](c,e,b);case r.ConditionalExpression:return this["ternary?:"](this.recurse(a.test),this.recurse(a.alternate),this.recurse(a.consequent),
b);case r.Identifier:return f.identifier(a.name,b,d);case r.MemberExpression:return c=this.recurse(a.object,!1,!!d),a.computed||(e=a.property.name),a.computed&&(e=this.recurse(a.property)),a.computed?this.computedMember(c,e,b,d):this.nonComputedMember(c,e,b,d);case r.CallExpression:return g=[],p(a.arguments,function(a){g.push(f.recurse(a))}),a.filter&&(e=this.$filter(a.callee.name)),a.filter||(e=this.recurse(a.callee,!0)),a.filter?function(a,c,d,f){for(var n=[],q=0;q<g.length;++q)n.push(g[q](a,c,
d,f));a=e.apply(void 0,n,f);return b?{context:void 0,name:void 0,value:a}:a}:function(a,c,d,f){var n=e(a,c,d,f),q;if(null!=n.value){q=[];for(var p=0;p<g.length;++p)q.push(g[p](a,c,d,f));q=n.value.apply(n.context,q)}return b?{value:q}:q};case r.AssignmentExpression:return c=this.recurse(a.left,!0,1),e=this.recurse(a.right),function(a,d,f,g){var n=c(a,d,f,g);a=e(a,d,f,g);n.context[n.name]=a;return b?{value:a}:a};case r.ArrayExpression:return g=[],p(a.elements,function(a){g.push(f.recurse(a))}),function(a,
c,d,e){for(var f=[],q=0;q<g.length;++q)f.push(g[q](a,c,d,e));return b?{value:f}:f};case r.ObjectExpression:return g=[],p(a.properties,function(a){a.computed?g.push({key:f.recurse(a.key),computed:!0,value:f.recurse(a.value)}):g.push({key:a.key.type===r.Identifier?a.key.name:""+a.key.value,computed:!1,value:f.recurse(a.value)})}),function(a,c,d,e){for(var f={},q=0;q<g.length;++q)g[q].computed?f[g[q].key(a,c,d,e)]=g[q].value(a,c,d,e):f[g[q].key]=g[q].value(a,c,d,e);return b?{value:f}:f};case r.ThisExpression:return function(a){return b?
{value:a}:a};case r.LocalsExpression:return function(a,c){return b?{value:c}:c};case r.NGValueParameter:return function(a,c,d){return b?{value:d}:d}}},"unary+":function(a,b){return function(d,c,e,f){d=a(d,c,e,f);d=t(d)?+d:0;return b?{value:d}:d}},"unary-":function(a,b){return function(d,c,e,f){d=a(d,c,e,f);d=t(d)?-d:-0;return b?{value:d}:d}},"unary!":function(a,b){return function(d,c,e,f){d=!a(d,c,e,f);return b?{value:d}:d}},"binary+":function(a,b,d){return function(c,e,f,g){var k=a(c,e,f,g);c=b(c,
e,f,g);k=Fd(k,c);return d?{value:k}:k}},"binary-":function(a,b,d){return function(c,e,f,g){var k=a(c,e,f,g);c=b(c,e,f,g);k=(t(k)?k:0)-(t(c)?c:0);return d?{value:k}:k}},"binary*":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)*b(c,e,f,g);return d?{value:c}:c}},"binary/":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)/b(c,e,f,g);return d?{value:c}:c}},"binary%":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)%b(c,e,f,g);return d?{value:c}:c}},"binary===":function(a,b,d){return function(c,
e,f,g){c=a(c,e,f,g)===b(c,e,f,g);return d?{value:c}:c}},"binary!==":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)!==b(c,e,f,g);return d?{value:c}:c}},"binary==":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)==b(c,e,f,g);return d?{value:c}:c}},"binary!=":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)!=b(c,e,f,g);return d?{value:c}:c}},"binary<":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)<b(c,e,f,g);return d?{value:c}:c}},"binary>":function(a,b,d){return function(c,e,
f,g){c=a(c,e,f,g)>b(c,e,f,g);return d?{value:c}:c}},"binary<=":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)<=b(c,e,f,g);return d?{value:c}:c}},"binary>=":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)>=b(c,e,f,g);return d?{value:c}:c}},"binary&&":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)&&b(c,e,f,g);return d?{value:c}:c}},"binary||":function(a,b,d){return function(c,e,f,g){c=a(c,e,f,g)||b(c,e,f,g);return d?{value:c}:c}},"ternary?:":function(a,b,d,c){return function(e,f,
g,k){e=a(e,f,g,k)?b(e,f,g,k):d(e,f,g,k);return c?{value:e}:e}},value:function(a,b){return function(){return b?{context:void 0,name:void 0,value:a}:a}},identifier:function(a,b,d){return function(c,e,f,g){c=e&&a in e?e:c;d&&1!==d&&c&&null==c[a]&&(c[a]={});e=c?c[a]:void 0;return b?{context:c,name:a,value:e}:e}},computedMember:function(a,b,d,c){return function(e,f,g,k){var h=a(e,f,g,k),l,m;null!=h&&(l=b(e,f,g,k),l+="",c&&1!==c&&h&&!h[l]&&(h[l]={}),m=h[l]);return d?{context:h,name:l,value:m}:m}},nonComputedMember:function(a,
b,d,c){return function(e,f,g,k){e=a(e,f,g,k);c&&1!==c&&e&&null==e[b]&&(e[b]={});f=null!=e?e[b]:void 0;return d?{context:e,name:b,value:f}:f}},inputs:function(a,b){return function(d,c,e,f){return f?f[b]:a(d,c,e)}}};xc.prototype={constructor:xc,parse:function(a){a=this.ast.ast(a);var b=this.astCompiler.compile(a);b.literal=0===a.body.length||1===a.body.length&&(a.body[0].expression.type===r.Literal||a.body[0].expression.type===r.ArrayExpression||a.body[0].expression.type===r.ObjectExpression);b.constant=
a.constant;return b}};var qa=K("$sce"),ka={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},Ac=/_([a-z])/g,Hg=K("$compile"),ea=x.document.createElement("a"),Pd=ua(x.location.href);Qd.$inject=["$document"];ed.$inject=["$provide"];var Xd=22,Wd=".",Cc="0";Rd.$inject=["$locale"];Td.$inject=["$locale"];var Sg={yyyy:$("FullYear",4,0,!1,!0),yy:$("FullYear",2,0,!0,!0),y:$("FullYear",1,0,!1,!0),MMMM:ob("Month"),MMM:ob("Month",!0),MM:$("Month",2,1),M:$("Month",1,1),LLLL:ob("Month",!1,!0),
dd:$("Date",2),d:$("Date",1),HH:$("Hours",2),H:$("Hours",1),hh:$("Hours",2,-12),h:$("Hours",1,-12),mm:$("Minutes",2),m:$("Minutes",1),ss:$("Seconds",2),s:$("Seconds",1),sss:$("Milliseconds",3),EEEE:ob("Day"),EEE:ob("Day",!0),a:function(a,b){return 12>a.getHours()?b.AMPMS[0]:b.AMPMS[1]},Z:function(a,b,d){a=-1*d;return a=(0<=a?"+":"")+(Lb(Math[0<a?"floor":"ceil"](a/60),2)+Lb(Math.abs(a%60),2))},ww:Zd(2),w:Zd(1),G:Dc,GG:Dc,GGG:Dc,GGGG:function(a,b){return 0>=a.getFullYear()?b.ERANAMES[0]:b.ERANAMES[1]}},
Rg=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))([\s\S]*)/,Qg=/^-?\d+$/;Sd.$inject=["$locale"];var Lg=aa(N),Mg=aa(wb);Ud.$inject=["$parse"];var Ie=aa({restrict:"E",compile:function(a,b){if(!b.href&&!b.xlinkHref)return function(a,b){if("a"===b[0].nodeName.toLowerCase()){var e="[object SVGAnimatedString]"===la.call(b.prop("href"))?"xlink:href":"href";b.on("click",function(a){b.attr(e)||a.preventDefault()})}}}}),xb={};p(Hb,function(a,b){function d(a,d,e){a.$watch(e[c],
function(a){e.$set(b,!!a)})}if("multiple"!==a){var c=Ea("ng-"+b),e=d;"checked"===a&&(e=function(a,b,e){e.ngModel!==e[c]&&d(a,b,e)});xb[c]=function(){return{restrict:"A",priority:100,link:e}}}});p(td,function(a,b){xb[b]=function(){return{priority:100,link:function(a,c,e){if("ngPattern"===b&&"/"===e.ngPattern.charAt(0)&&(c=e.ngPattern.match(Wg))){e.$set("ngPattern",new RegExp(c[1],c[2]));return}a.$watch(e[b],function(a){e.$set(b,a)})}}}});p(["src","srcset","href"],function(a){var b=Ea("ng-"+a);xb[b]=
function(){return{priority:99,link:function(d,c,e){var f=a,g=a;"href"===a&&"[object SVGAnimatedString]"===la.call(c.prop("href"))&&(g="xlinkHref",e.$attr[g]="xlink:href",f=null);e.$observe(b,function(b){b?(e.$set(g,b),Ba&&f&&c.prop(f,e[g])):"href"===a&&e.$set(g,null)})}}}});var Nb={$addControl:B,$$renameControl:function(a,b){a.$name=b},$removeControl:B,$setValidity:B,$setDirty:B,$setPristine:B,$setSubmitted:B};Mb.$inject=["$element","$attrs","$scope","$animate","$interpolate"];Mb.prototype={$rollbackViewValue:function(){p(this.$$controls,
function(a){a.$rollbackViewValue()})},$commitViewValue:function(){p(this.$$controls,function(a){a.$commitViewValue()})},$addControl:function(a){Oa(a.$name,"input");this.$$controls.push(a);a.$name&&(this[a.$name]=a);a.$$parentForm=this},$$renameControl:function(a,b){var d=a.$name;this[d]===a&&delete this[d];this[b]=a;a.$name=b},$removeControl:function(a){a.$name&&this[a.$name]===a&&delete this[a.$name];p(this.$pending,function(b,d){this.$setValidity(d,null,a)},this);p(this.$error,function(b,d){this.$setValidity(d,
null,a)},this);p(this.$$success,function(b,d){this.$setValidity(d,null,a)},this);cb(this.$$controls,a);a.$$parentForm=Nb},$setDirty:function(){this.$$animate.removeClass(this.$$element,Ya);this.$$animate.addClass(this.$$element,Sb);this.$dirty=!0;this.$pristine=!1;this.$$parentForm.$setDirty()},$setPristine:function(){this.$$animate.setClass(this.$$element,Ya,Sb+" ng-submitted");this.$dirty=!1;this.$pristine=!0;this.$submitted=!1;p(this.$$controls,function(a){a.$setPristine()})},$setUntouched:function(){p(this.$$controls,
function(a){a.$setUntouched()})},$setSubmitted:function(){this.$$animate.addClass(this.$$element,"ng-submitted");this.$submitted=!0;this.$$parentForm.$setSubmitted()}};be({clazz:Mb,set:function(a,b,d){var c=a[b];c?-1===c.indexOf(d)&&c.push(d):a[b]=[d]},unset:function(a,b,d){var c=a[b];c&&(cb(c,d),0===c.length&&delete a[b])}});var je=function(a){return["$timeout","$parse",function(b,d){function c(a){return""===a?d('this[""]').assign:d(a).assign||B}return{name:"form",restrict:a?"EAC":"E",require:["form",
"^^?form"],controller:Mb,compile:function(d,f){d.addClass(Ya).addClass(pb);var g=f.name?"name":a&&f.ngForm?"ngForm":!1;return{pre:function(a,d,e,f){var n=f[0];if(!("action"in e)){var q=function(b){a.$apply(function(){n.$commitViewValue();n.$setSubmitted()});b.preventDefault()};d[0].addEventListener("submit",q);d.on("$destroy",function(){b(function(){d[0].removeEventListener("submit",q)},0,!1)})}(f[1]||n.$$parentForm).$addControl(n);var p=g?c(n.$name):B;g&&(p(a,n),e.$observe(g,function(b){n.$name!==
b&&(p(a,void 0),n.$$parentForm.$$renameControl(n,b),p=c(n.$name),p(a,n))}));d.on("$destroy",function(){n.$$parentForm.$removeControl(n);p(a,void 0);O(n,Nb)})}}}}}]},Je=je(),Ve=je(!0),Tg=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,eh=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,fh=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,
Ug=/^\s*(-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,ke=/^(\d{4,})-(\d{2})-(\d{2})$/,le=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Kc=/^(\d{4,})-W(\d\d)$/,me=/^(\d{4,})-(\d\d)$/,ne=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,de=R();p(["date","datetime-local","month","time","week"],function(a){de[a]=!0});var oe={text:function(a,b,d,c,e,f){Va(a,b,d,c,e,f);Fc(c)},date:qb("date",ke,Ob(ke,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":qb("datetimelocal",le,Ob(le,"yyyy MM dd HH mm ss sss".split(" ")),
"yyyy-MM-ddTHH:mm:ss.sss"),time:qb("time",ne,Ob(ne,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:qb("week",Kc,function(a,b){if(ia(a))return a;if(C(a)){Kc.lastIndex=0;var d=Kc.exec(a);if(d){var c=+d[1],e=+d[2],f=d=0,g=0,k=0,h=Yd(c),e=7*(e-1);b&&(d=b.getHours(),f=b.getMinutes(),g=b.getSeconds(),k=b.getMilliseconds());return new Date(c,0,h.getDate()+e,d,f,g,k)}}return NaN},"yyyy-Www"),month:qb("month",me,Ob(me,["yyyy","MM"]),"yyyy-MM"),number:function(a,b,d,c,e,f){Gc(a,b,d,c);ee(c);Va(a,b,d,c,e,f);var g,
k;if(t(d.min)||d.ngMin)c.$validators.min=function(a){return c.$isEmpty(a)||v(g)||a>=g},d.$observe("min",function(a){g=Wa(a);c.$validate()});if(t(d.max)||d.ngMax)c.$validators.max=function(a){return c.$isEmpty(a)||v(k)||a<=k},d.$observe("max",function(a){k=Wa(a);c.$validate()});if(t(d.step)||d.ngStep){var h;c.$validators.step=function(a,b){return c.$isEmpty(b)||v(h)||fe(b,g||0,h)};d.$observe("step",function(a){h=Wa(a);c.$validate()})}},url:function(a,b,d,c,e,f){Va(a,b,d,c,e,f);Fc(c);c.$$parserName=
"url";c.$validators.url=function(a,b){var d=a||b;return c.$isEmpty(d)||eh.test(d)}},email:function(a,b,d,c,e,f){Va(a,b,d,c,e,f);Fc(c);c.$$parserName="email";c.$validators.email=function(a,b){var d=a||b;return c.$isEmpty(d)||fh.test(d)}},radio:function(a,b,d,c){var e=!d.ngTrim||"false"!==P(d.ngTrim);v(d.name)&&b.attr("name",++sb);b.on("click",function(a){var g;b[0].checked&&(g=d.value,e&&(g=P(g)),c.$setViewValue(g,a&&a.type))});c.$render=function(){var a=d.value;e&&(a=P(a));b[0].checked=a===c.$viewValue};
d.$observe("value",c.$render)},range:function(a,b,d,c,e,f){function g(a,c){b.attr(a,d[a]);d.$observe(a,c)}function k(a){n=Wa(a);ba(c.$modelValue)||(m?(a=b.val(),n>a&&(a=n,b.val(a)),c.$setViewValue(a)):c.$validate())}function h(a){q=Wa(a);ba(c.$modelValue)||(m?(a=b.val(),q<a&&(b.val(q),a=q<n?n:q),c.$setViewValue(a)):c.$validate())}function l(a){p=Wa(a);ba(c.$modelValue)||(m&&c.$viewValue!==b.val()?c.$setViewValue(b.val()):c.$validate())}Gc(a,b,d,c);ee(c);Va(a,b,d,c,e,f);var m=c.$$hasNativeValidators&&
"range"===b[0].type,n=m?0:void 0,q=m?100:void 0,p=m?1:void 0,r=b[0].validity;a=t(d.min);e=t(d.max);f=t(d.step);var w=c.$render;c.$render=m&&t(r.rangeUnderflow)&&t(r.rangeOverflow)?function(){w();c.$setViewValue(b.val())}:w;a&&(c.$validators.min=m?function(){return!0}:function(a,b){return c.$isEmpty(b)||v(n)||b>=n},g("min",k));e&&(c.$validators.max=m?function(){return!0}:function(a,b){return c.$isEmpty(b)||v(q)||b<=q},g("max",h));f&&(c.$validators.step=m?function(){return!r.stepMismatch}:function(a,
b){return c.$isEmpty(b)||v(p)||fe(b,n||0,p)},g("step",l))},checkbox:function(a,b,d,c,e,f,g,k){var h=ge(k,a,"ngTrueValue",d.ngTrueValue,!0),l=ge(k,a,"ngFalseValue",d.ngFalseValue,!1);b.on("click",function(a){c.$setViewValue(b[0].checked,a&&a.type)});c.$render=function(){b[0].checked=c.$viewValue};c.$isEmpty=function(a){return!1===a};c.$formatters.push(function(a){return sa(a,h)});c.$parsers.push(function(a){return a?h:l})},hidden:B,button:B,submit:B,reset:B,file:B},Zc=["$browser","$sniffer","$filter",
"$parse",function(a,b,d,c){return{restrict:"E",require:["?ngModel"],link:{pre:function(e,f,g,k){k[0]&&(oe[N(g.type)]||oe.text)(e,f,g,k[0],b,a,d,c)}}}}],gh=/^(true|false|\d+)$/,nf=function(){function a(a,d,c){var e=t(c)?c:9===Ba?"":null;a.prop("value",e);d.$set("value",c)}return{restrict:"A",priority:100,compile:function(b,d){return gh.test(d.ngValue)?function(b,d,f){b=b.$eval(f.ngValue);a(d,f,b)}:function(b,d,f){b.$watch(f.ngValue,function(b){a(d,f,b)})}}}},Ne=["$compile",function(a){return{restrict:"AC",
compile:function(b){a.$$addBindingClass(b);return function(b,c,e){a.$$addBindingInfo(c,e.ngBind);c=c[0];b.$watch(e.ngBind,function(a){c.textContent=cc(a)})}}}}],Pe=["$interpolate","$compile",function(a,b){return{compile:function(d){b.$$addBindingClass(d);return function(c,d,f){c=a(d.attr(f.$attr.ngBindTemplate));b.$$addBindingInfo(d,c.expressions);d=d[0];f.$observe("ngBindTemplate",function(a){d.textContent=v(a)?"":a})}}}}],Oe=["$sce","$parse","$compile",function(a,b,d){return{restrict:"A",compile:function(c,
e){var f=b(e.ngBindHtml),g=b(e.ngBindHtml,function(b){return a.valueOf(b)});d.$$addBindingClass(c);return function(b,c,e){d.$$addBindingInfo(c,e.ngBindHtml);b.$watch(g,function(){var d=f(b);c.html(a.getTrustedHtml(d)||"")})}}}}],mf=aa({restrict:"A",require:"ngModel",link:function(a,b,d,c){c.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),Qe=Ic("",!0),Se=Ic("Odd",0),Re=Ic("Even",1),Te=Ua({compile:function(a,b){b.$set("ngCloak",void 0);a.removeClass("ng-cloak")}}),Ue=[function(){return{restrict:"A",
scope:!0,controller:"@",priority:500}}],dd={},hh={blur:!0,focus:!0};p("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var b=Ea("ng-"+a);dd[b]=["$parse","$rootScope",function(d,c){return{restrict:"A",compile:function(e,f){var g=d(f[b]);return function(b,d){d.on(a,function(d){var e=function(){g(b,{$event:d})};hh[a]&&c.$$phase?b.$evalAsync(e):b.$apply(e)})}}}}]});var Xe=["$animate","$compile",
function(a,b){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(d,c,e,f,g){var k,h,l;d.$watch(e.ngIf,function(d){d?h||g(function(d,f){h=f;d[d.length++]=b.$$createComment("end ngIf",e.ngIf);k={clone:d};a.enter(d,c.parent(),c)}):(l&&(l.remove(),l=null),h&&(h.$destroy(),h=null),k&&(l=vb(k.clone),a.leave(l).done(function(a){!1!==a&&(l=null)}),k=null))})}}}],Ye=["$templateRequest","$anchorScroll","$animate",function(a,b,d){return{restrict:"ECA",priority:400,
terminal:!0,transclude:"element",controller:fa.noop,compile:function(c,e){var f=e.ngInclude||e.src,g=e.onload||"",k=e.autoscroll;return function(c,e,m,n,q){var p=0,r,w,u,A=function(){w&&(w.remove(),w=null);r&&(r.$destroy(),r=null);u&&(d.leave(u).done(function(a){!1!==a&&(w=null)}),w=u,u=null)};c.$watch(f,function(f){var m=function(a){!1===a||!t(k)||k&&!c.$eval(k)||b()},y=++p;f?(a(f,!0).then(function(a){if(!c.$$destroyed&&y===p){var b=c.$new();n.template=a;a=q(b,function(a){A();d.enter(a,null,e).done(m)});
r=b;u=a;r.$emit("$includeContentLoaded",f);c.$eval(g)}},function(){c.$$destroyed||y!==p||(A(),c.$emit("$includeContentError",f))}),c.$emit("$includeContentRequested",f)):(A(),n.template=null)})}}}}],pf=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(b,d,c,e){la.call(d[0]).match(/SVG/)?(d.empty(),a(fd(e.template,x.document).childNodes)(b,function(a){d.append(a)},{futureParentElement:d})):(d.html(e.template),a(d.contents())(b))}}}],Ze=Ua({priority:450,compile:function(){return{pre:function(a,
b,d){a.$eval(d.ngInit)}}}}),lf=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(a,b,d,c){var e=d.ngList||", ",f="false"!==d.ngTrim,g=f?P(e):e;c.$parsers.push(function(a){if(!v(a)){var b=[];a&&p(a.split(g),function(a){a&&b.push(f?P(a):a)});return b}});c.$formatters.push(function(a){if(I(a))return a.join(e)});c.$isEmpty=function(a){return!a||!a.length}}}},pb="ng-valid",ae="ng-invalid",Ya="ng-pristine",Sb="ng-dirty",rb=K("ngModel");Pb.$inject="$scope $exceptionHandler $attrs $element $parse $animate $timeout $q $interpolate".split(" ");
Pb.prototype={$$initGetterSetters:function(){if(this.$options.getOption("getterSetter")){var a=this.$$parse(this.$$attr.ngModel+"()"),b=this.$$parse(this.$$attr.ngModel+"($$$p)");this.$$ngModelGet=function(b){var c=this.$$parsedNgModel(b);E(c)&&(c=a(b));return c};this.$$ngModelSet=function(a,c){E(this.$$parsedNgModel(a))?b(a,{$$$p:c}):this.$$parsedNgModelAssign(a,c)}}else if(!this.$$parsedNgModel.assign)throw rb("nonassign",this.$$attr.ngModel,Aa(this.$$element));},$render:B,$isEmpty:function(a){return v(a)||
""===a||null===a||a!==a},$$updateEmptyClasses:function(a){this.$isEmpty(a)?(this.$$animate.removeClass(this.$$element,"ng-not-empty"),this.$$animate.addClass(this.$$element,"ng-empty")):(this.$$animate.removeClass(this.$$element,"ng-empty"),this.$$animate.addClass(this.$$element,"ng-not-empty"))},$setPristine:function(){this.$dirty=!1;this.$pristine=!0;this.$$animate.removeClass(this.$$element,Sb);this.$$animate.addClass(this.$$element,Ya)},$setDirty:function(){this.$dirty=!0;this.$pristine=!1;this.$$animate.removeClass(this.$$element,
Ya);this.$$animate.addClass(this.$$element,Sb);this.$$parentForm.$setDirty()},$setUntouched:function(){this.$touched=!1;this.$untouched=!0;this.$$animate.setClass(this.$$element,"ng-untouched","ng-touched")},$setTouched:function(){this.$touched=!0;this.$untouched=!1;this.$$animate.setClass(this.$$element,"ng-touched","ng-untouched")},$rollbackViewValue:function(){this.$$timeout.cancel(this.$$pendingDebounce);this.$viewValue=this.$$lastCommittedViewValue;this.$render()},$validate:function(){if(!ba(this.$modelValue)){var a=
this.$$lastCommittedViewValue,b=this.$$rawModelValue,d=this.$valid,c=this.$modelValue,e=this.$options.getOption("allowInvalid"),f=this;this.$$runValidators(b,a,function(a){e||d===a||(f.$modelValue=a?b:void 0,f.$modelValue!==c&&f.$$writeModelToScope())})}},$$runValidators:function(a,b,d){function c(){var c=!0;p(h.$validators,function(d,e){var g=Boolean(d(a,b));c=c&&g;f(e,g)});return c?!0:(p(h.$asyncValidators,function(a,b){f(b,null)}),!1)}function e(){var c=[],d=!0;p(h.$asyncValidators,function(e,
g){var h=e(a,b);if(!h||!E(h.then))throw rb("nopromise",h);f(g,void 0);c.push(h.then(function(){f(g,!0)},function(){d=!1;f(g,!1)}))});c.length?h.$$q.all(c).then(function(){g(d)},B):g(!0)}function f(a,b){k===h.$$currentValidationRunId&&h.$setValidity(a,b)}function g(a){k===h.$$currentValidationRunId&&d(a)}this.$$currentValidationRunId++;var k=this.$$currentValidationRunId,h=this;(function(){var a=h.$$parserName||"parse";if(v(h.$$parserValid))f(a,null);else return h.$$parserValid||(p(h.$validators,function(a,
b){f(b,null)}),p(h.$asyncValidators,function(a,b){f(b,null)})),f(a,h.$$parserValid),h.$$parserValid;return!0})()?c()?e():g(!1):g(!1)},$commitViewValue:function(){var a=this.$viewValue;this.$$timeout.cancel(this.$$pendingDebounce);if(this.$$lastCommittedViewValue!==a||""===a&&this.$$hasNativeValidators)this.$$updateEmptyClasses(a),this.$$lastCommittedViewValue=a,this.$pristine&&this.$setDirty(),this.$$parseAndValidate()},$$parseAndValidate:function(){var a=this.$$lastCommittedViewValue,b=this;if(this.$$parserValid=
v(a)?void 0:!0)for(var d=0;d<this.$parsers.length;d++)if(a=this.$parsers[d](a),v(a)){this.$$parserValid=!1;break}ba(this.$modelValue)&&(this.$modelValue=this.$$ngModelGet(this.$$scope));var c=this.$modelValue,e=this.$options.getOption("allowInvalid");this.$$rawModelValue=a;e&&(this.$modelValue=a,b.$modelValue!==c&&b.$$writeModelToScope());this.$$runValidators(a,this.$$lastCommittedViewValue,function(d){e||(b.$modelValue=d?a:void 0,b.$modelValue!==c&&b.$$writeModelToScope())})},$$writeModelToScope:function(){this.$$ngModelSet(this.$$scope,
this.$modelValue);p(this.$viewChangeListeners,function(a){try{a()}catch(b){this.$$exceptionHandler(b)}},this)},$setViewValue:function(a,b){this.$viewValue=a;this.$options.getOption("updateOnDefault")&&this.$$debounceViewValueCommit(b)},$$debounceViewValueCommit:function(a){var b=this.$options.getOption("debounce");W(b[a])?b=b[a]:W(b["default"])&&(b=b["default"]);this.$$timeout.cancel(this.$$pendingDebounce);var d=this;0<b?this.$$pendingDebounce=this.$$timeout(function(){d.$commitViewValue()},b):this.$$scope.$root.$$phase?
this.$commitViewValue():this.$$scope.$apply(function(){d.$commitViewValue()})},$overrideModelOptions:function(a){this.$options=this.$options.createChild(a)}};be({clazz:Pb,set:function(a,b){a[b]=!0},unset:function(a,b){delete a[b]}});var kf=["$rootScope",function(a){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:Pb,priority:1,compile:function(b){b.addClass(Ya).addClass("ng-untouched").addClass(pb);return{pre:function(a,b,e,f){var g=f[0];b=f[1]||g.$$parentForm;if(f=f[2])g.$options=
f.$options;g.$$initGetterSetters();b.$addControl(g);e.$observe("name",function(a){g.$name!==a&&g.$$parentForm.$$renameControl(g,a)});a.$on("$destroy",function(){g.$$parentForm.$removeControl(g)})},post:function(b,c,e,f){function g(){k.$setTouched()}var k=f[0];if(k.$options.getOption("updateOn"))c.on(k.$options.getOption("updateOn"),function(a){k.$$debounceViewValueCommit(a&&a.type)});c.on("blur",function(){k.$touched||(a.$$phase?b.$evalAsync(g):b.$apply(g))})}}}}}],Qb,ih=/(\s+|^)default(\s+|$)/;Jc.prototype=
{getOption:function(a){return this.$$options[a]},createChild:function(a){var b=!1;a=O({},a);p(a,function(d,c){"$inherit"===d?"*"===c?b=!0:(a[c]=this.$$options[c],"updateOn"===c&&(a.updateOnDefault=this.$$options.updateOnDefault)):"updateOn"===c&&(a.updateOnDefault=!1,a[c]=P(d.replace(ih,function(){a.updateOnDefault=!0;return" "})))},this);b&&(delete a["*"],he(a,this.$$options));he(a,Qb.$$options);return new Jc(a)}};Qb=new Jc({updateOn:"",updateOnDefault:!0,debounce:0,getterSetter:!1,allowInvalid:!1,
timezone:null});var of=function(){function a(a,d){this.$$attrs=a;this.$$scope=d}a.$inject=["$attrs","$scope"];a.prototype={$onInit:function(){var a=this.parentCtrl?this.parentCtrl.$options:Qb,d=this.$$scope.$eval(this.$$attrs.ngModelOptions);this.$options=a.createChild(d)}};return{restrict:"A",priority:10,require:{parentCtrl:"?^^ngModelOptions"},bindToController:!0,controller:a}},$e=Ua({terminal:!0,priority:1E3}),jh=K("ngOptions"),kh=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([$\w][$\w]*)|(?:\(\s*([$\w][$\w]*)\s*,\s*([$\w][$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,
hf=["$compile","$document","$parse",function(a,b,d){function c(a,b,c){function e(a,b,c,d,f){this.selectValue=a;this.viewValue=b;this.label=c;this.group=d;this.disabled=f}function f(a){var b;if(!p&&oa(a))b=a;else{b=[];for(var c in a)a.hasOwnProperty(c)&&"$"!==c.charAt(0)&&b.push(c)}return b}var n=a.match(kh);if(!n)throw jh("iexp",a,Aa(b));var q=n[5]||n[7],p=n[6];a=/ as /.test(n[0])&&n[1];var r=n[9];b=d(n[2]?n[1]:q);var w=a&&d(a)||b,t=r&&d(r),A=r?function(a,b){return t(c,b)}:function(a){return Sa(a)},
v=function(a,b){return A(a,z(a,b))},s=d(n[2]||n[1]),y=d(n[3]||""),D=d(n[4]||""),H=d(n[8]),x={},z=p?function(a,b){x[p]=b;x[q]=a;return x}:function(a){x[q]=a;return x};return{trackBy:r,getTrackByValue:v,getWatchables:d(H,function(a){var b=[];a=a||[];for(var d=f(a),e=d.length,g=0;g<e;g++){var k=a===d?g:d[g],l=a[k],k=z(l,k),l=A(l,k);b.push(l);if(n[2]||n[1])l=s(c,k),b.push(l);n[4]&&(k=D(c,k),b.push(k))}return b}),getOptions:function(){for(var a=[],b={},d=H(c)||[],g=f(d),k=g.length,n=0;n<k;n++){var q=d===
g?n:g[n],p=z(d[q],q),t=w(c,p),q=A(t,p),u=s(c,p),F=y(c,p),p=D(c,p),t=new e(q,t,u,F,p);a.push(t);b[q]=t}return{items:a,selectValueMap:b,getOptionFromViewValue:function(a){return b[v(a)]},getViewValueFromOption:function(a){return r?Ia(a.viewValue):a.viewValue}}}}}var e=x.document.createElement("option"),f=x.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(a,b,c,d){d[0].registerOption=B},post:function(d,k,h,l){function m(a){var b=(a=A.getOptionFromViewValue(a))&&
a.element;b&&!b.selected&&(b.selected=!0);return a}function n(a,b){a.element=b;b.disabled=a.disabled;a.label!==b.label&&(b.label=a.label,b.textContent=a.label);b.value=a.selectValue}var q=l[0],r=l[1],v=h.multiple;l=0;for(var w=k.children(),u=w.length;l<u;l++)if(""===w[l].value){q.hasEmptyOption=!0;q.emptyOption=w.eq(l);break}k.empty();l=!!q.emptyOption;z(e.cloneNode(!1)).val("?");var A,x=c(h.ngOptions,k,d),s=b[0].createDocumentFragment();q.generateUnknownOptionValue=function(a){return"?"};v?(q.writeValue=
function(a){if(A){var b=a&&a.map(m)||[];A.items.forEach(function(a){a.element.selected&&-1===Array.prototype.indexOf.call(b,a)&&(a.element.selected=!1)})}},q.readValue=function(){var a=k.val()||[],b=[];p(a,function(a){(a=A.selectValueMap[a])&&!a.disabled&&b.push(A.getViewValueFromOption(a))});return b},x.trackBy&&d.$watchCollection(function(){if(I(r.$viewValue))return r.$viewValue.map(function(a){return x.getTrackByValue(a)})},function(){r.$render()})):(q.writeValue=function(a){if(A){var b=k[0].options[k[0].selectedIndex],
c=A.getOptionFromViewValue(a);b&&b.removeAttribute("selected");c?(k[0].value!==c.selectValue&&(q.removeUnknownOption(),k[0].value=c.selectValue,c.element.selected=!0),c.element.setAttribute("selected","selected")):q.selectUnknownOrEmptyOption(a)}},q.readValue=function(){var a=A.selectValueMap[k.val()];return a&&!a.disabled?(q.unselectEmptyOption(),q.removeUnknownOption(),A.getViewValueFromOption(a)):null},x.trackBy&&d.$watch(function(){return x.getTrackByValue(r.$viewValue)},function(){r.$render()}));
l&&(a(q.emptyOption)(d),k.prepend(q.emptyOption),8===q.emptyOption[0].nodeType?(q.hasEmptyOption=!1,q.registerOption=function(a,b){""===b.val()&&(q.hasEmptyOption=!0,q.emptyOption=b,q.emptyOption.removeClass("ng-scope"),r.$render(),b.on("$destroy",function(){var a=q.$isEmptyOptionSelected();q.hasEmptyOption=!1;q.emptyOption=void 0;a&&r.$render()}))}):q.emptyOption.removeClass("ng-scope"));d.$watchCollection(x.getWatchables,function(){var a=A&&q.readValue();if(A)for(var b=A.items.length-1;0<=b;b--){var c=
A.items[b];t(c.group)?Gb(c.element.parentNode):Gb(c.element)}A=x.getOptions();var d={};A.items.forEach(function(a){var b;if(t(a.group)){b=d[a.group];b||(b=f.cloneNode(!1),s.appendChild(b),b.label=null===a.group?"null":a.group,d[a.group]=b);var c=e.cloneNode(!1);b.appendChild(c);n(a,c)}else b=e.cloneNode(!1),s.appendChild(b),n(a,b)});k[0].appendChild(s);r.$render();r.$isEmpty(a)||(b=q.readValue(),(x.trackBy||v?sa(a,b):a===b)||(r.$setViewValue(b),r.$render()))})}}}}],af=["$locale","$interpolate","$log",
function(a,b,d){var c=/{}/g,e=/^when(Minus)?(.+)$/;return{link:function(f,g,k){function h(a){g.text(a||"")}var l=k.count,m=k.$attr.when&&g.attr(k.$attr.when),n=k.offset||0,q=f.$eval(m)||{},r={},t=b.startSymbol(),w=b.endSymbol(),u=t+l+"-"+n+w,A=fa.noop,x;p(k,function(a,b){var c=e.exec(b);c&&(c=(c[1]?"-":"")+N(c[2]),q[c]=g.attr(k.$attr[b]))});p(q,function(a,d){r[d]=b(a.replace(c,u))});f.$watch(l,function(b){var c=parseFloat(b),e=ba(c);e||c in q||(c=a.pluralCat(c-n));c===x||e&&ba(x)||(A(),e=r[c],v(e)?
(null!=b&&d.debug("ngPluralize: no rule defined for '"+c+"' in "+m),A=B,h()):A=f.$watch(e,h),x=c)})}}}],bf=["$parse","$animate","$compile",function(a,b,d){var c=K("ngRepeat"),e=function(a,b,c,d,e,m,n){a[c]=d;e&&(a[e]=m);a.$index=b;a.$first=0===b;a.$last=b===n-1;a.$middle=!(a.$first||a.$last);a.$odd=!(a.$even=0===(b&1))};return{restrict:"A",multiElement:!0,transclude:"element",priority:1E3,terminal:!0,$$tlb:!0,compile:function(f,g){var k=g.ngRepeat,h=d.$$createComment("end ngRepeat",k),l=k.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);
if(!l)throw c("iexp",k);var m=l[1],n=l[2],q=l[3],r=l[4],l=m.match(/^(?:(\s*[$\w]+)|\(\s*([$\w]+)\s*,\s*([$\w]+)\s*\))$/);if(!l)throw c("iidexp",m);var t=l[3]||l[1],w=l[2];if(q&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(q)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(q)))throw c("badident",q);var u,v,x,s,y={$id:Sa};r?u=a(r):(x=function(a,b){return Sa(b)},s=function(a){return a});return function(a,d,f,g,l){u&&(v=function(b,c,d){w&&(y[w]=b);y[t]=c;y.$index=
d;return u(a,y)});var m=R();a.$watchCollection(n,function(f){var g,n,r=d[0],u,y=R(),F,z,E,B,G,C,I;q&&(a[q]=f);if(oa(f))G=f,n=v||x;else for(I in n=v||s,G=[],f)wa.call(f,I)&&"$"!==I.charAt(0)&&G.push(I);F=G.length;I=Array(F);for(g=0;g<F;g++)if(z=f===G?g:G[g],E=f[z],B=n(z,E,g),m[B])C=m[B],delete m[B],y[B]=C,I[g]=C;else{if(y[B])throw p(I,function(a){a&&a.scope&&(m[a.id]=a)}),c("dupes",k,B,E);I[g]={id:B,scope:void 0,clone:void 0};y[B]=!0}for(u in m){C=m[u];B=vb(C.clone);b.leave(B);if(B[0].parentNode)for(g=
0,n=B.length;g<n;g++)B[g].$$NG_REMOVED=!0;C.scope.$destroy()}for(g=0;g<F;g++)if(z=f===G?g:G[g],E=f[z],C=I[g],C.scope){u=r;do u=u.nextSibling;while(u&&u.$$NG_REMOVED);C.clone[0]!==u&&b.move(vb(C.clone),null,r);r=C.clone[C.clone.length-1];e(C.scope,g,t,E,w,z,F)}else l(function(a,c){C.scope=c;var d=h.cloneNode(!1);a[a.length++]=d;b.enter(a,null,r);r=d;C.clone=a;y[C.id]=C;e(C.scope,g,t,E,w,z,F)});m=y})}}}}],cf=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(b,d,c){b.$watch(c.ngShow,
function(b){a[b?"removeClass":"addClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],We=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(b,d,c){b.$watch(c.ngHide,function(b){a[b?"addClass":"removeClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],df=Ua(function(a,b,d){a.$watch(d.ngStyle,function(a,d){d&&a!==d&&p(d,function(a,c){b.css(c,"")});a&&b.css(a)},!0)}),ef=["$animate","$compile",function(a,b){return{require:"ngSwitch",controller:["$scope",function(){this.cases=
{}}],link:function(d,c,e,f){var g=[],k=[],h=[],l=[],m=function(a,b){return function(c){!1!==c&&a.splice(b,1)}};d.$watch(e.ngSwitch||e.on,function(c){for(var d,e;h.length;)a.cancel(h.pop());d=0;for(e=l.length;d<e;++d){var r=vb(k[d].clone);l[d].$destroy();(h[d]=a.leave(r)).done(m(h,d))}k.length=0;l.length=0;(g=f.cases["!"+c]||f.cases["?"])&&p(g,function(c){c.transclude(function(d,e){l.push(e);var f=c.element;d[d.length++]=b.$$createComment("end ngSwitchWhen");k.push({clone:d});a.enter(d,f.parent(),
f)})})})}}}],ff=Ua({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,d,c,e){a=d.ngSwitchWhen.split(d.ngSwitchWhenSeparator).sort().filter(function(a,b,c){return c[b-1]!==a});p(a,function(a){c.cases["!"+a]=c.cases["!"+a]||[];c.cases["!"+a].push({transclude:e,element:b})})}}),gf=Ua({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,b,d,c,e){c.cases["?"]=c.cases["?"]||[];c.cases["?"].push({transclude:e,element:b})}}),lh=K("ngTransclude"),
jf=["$compile",function(a){return{restrict:"EAC",terminal:!0,compile:function(b){var d=a(b.contents());b.empty();return function(a,b,f,g,k){function h(){d(a,function(a){b.append(a)})}if(!k)throw lh("orphan",Aa(b));f.ngTransclude===f.$attr.ngTransclude&&(f.ngTransclude="");f=f.ngTransclude||f.ngTranscludeSlot;k(function(a,c){var d;if(d=a.length)a:{d=0;for(var f=a.length;d<f;d++){var g=a[d];if(g.nodeType!==Ma||g.nodeValue.trim()){d=!0;break a}}d=void 0}d?b.append(a):(h(),c.$destroy())},null,f);f&&!k.isSlotFilled(f)&&
h()}}}}],Ke=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(b,d){"text/ng-template"===d.type&&a.put(d.id,b[0].text)}}}],mh={$setViewValue:B,$render:B},nh=["$element","$scope",function(a,b){function d(){g||(g=!0,b.$$postDigest(function(){g=!1;e.ngModelCtrl.$render()}))}function c(a){k||(k=!0,b.$$postDigest(function(){b.$$destroyed||(k=!1,e.ngModelCtrl.$setViewValue(e.readValue()),a&&e.ngModelCtrl.$render())}))}var e=this,f=new Ib;e.selectValueMap={};e.ngModelCtrl=mh;
e.multiple=!1;e.unknownOption=z(x.document.createElement("option"));e.hasEmptyOption=!1;e.emptyOption=void 0;e.renderUnknownOption=function(b){b=e.generateUnknownOptionValue(b);e.unknownOption.val(b);a.prepend(e.unknownOption);Ha(e.unknownOption,!0);a.val(b)};e.updateUnknownOption=function(b){b=e.generateUnknownOptionValue(b);e.unknownOption.val(b);Ha(e.unknownOption,!0);a.val(b)};e.generateUnknownOptionValue=function(a){return"? "+Sa(a)+" ?"};e.removeUnknownOption=function(){e.unknownOption.parent()&&
e.unknownOption.remove()};e.selectEmptyOption=function(){e.emptyOption&&(a.val(""),Ha(e.emptyOption,!0))};e.unselectEmptyOption=function(){e.hasEmptyOption&&Ha(e.emptyOption,!1)};b.$on("$destroy",function(){e.renderUnknownOption=B});e.readValue=function(){var b=a.val(),b=b in e.selectValueMap?e.selectValueMap[b]:b;return e.hasOption(b)?b:null};e.writeValue=function(b){var c=a[0].options[a[0].selectedIndex];c&&Ha(z(c),!1);e.hasOption(b)?(e.removeUnknownOption(),c=Sa(b),a.val(c in e.selectValueMap?
c:b),Ha(z(a[0].options[a[0].selectedIndex]),!0)):e.selectUnknownOrEmptyOption(b)};e.addOption=function(a,b){if(8!==b[0].nodeType){Oa(a,'"option value"');""===a&&(e.hasEmptyOption=!0,e.emptyOption=b);var c=f.get(a)||0;f.set(a,c+1);d()}};e.removeOption=function(a){var b=f.get(a);b&&(1===b?(f.delete(a),""===a&&(e.hasEmptyOption=!1,e.emptyOption=void 0)):f.set(a,b-1))};e.hasOption=function(a){return!!f.get(a)};e.$hasEmptyOption=function(){return e.hasEmptyOption};e.$isUnknownOptionSelected=function(){return a[0].options[0]===
e.unknownOption[0]};e.$isEmptyOptionSelected=function(){return e.hasEmptyOption&&a[0].options[a[0].selectedIndex]===e.emptyOption[0]};e.selectUnknownOrEmptyOption=function(a){null==a&&e.emptyOption?(e.removeUnknownOption(),e.selectEmptyOption()):e.unknownOption.parent().length?e.updateUnknownOption(a):e.renderUnknownOption(a)};var g=!1,k=!1;e.registerOption=function(a,b,f,g,k){if(f.$attr.ngValue){var p,r=NaN;f.$observe("value",function(a){var d,f=b.prop("selected");t(r)&&(e.removeOption(p),delete e.selectValueMap[r],
d=!0);r=Sa(a);p=a;e.selectValueMap[r]=a;e.addOption(a,b);b.attr("value",r);d&&f&&c()})}else g?f.$observe("value",function(a){e.readValue();var d,f=b.prop("selected");t(p)&&(e.removeOption(p),d=!0);p=a;e.addOption(a,b);d&&f&&c()}):k?a.$watch(k,function(a,d){f.$set("value",a);var g=b.prop("selected");d!==a&&e.removeOption(d);e.addOption(a,b);d&&g&&c()}):e.addOption(f.value,b);f.$observe("disabled",function(a){if("true"===a||a&&b.prop("selected"))e.multiple?c(!0):(e.ngModelCtrl.$setViewValue(null),e.ngModelCtrl.$render())});
b.on("$destroy",function(){var a=e.readValue(),b=f.value;e.removeOption(b);d();(e.multiple&&a&&-1!==a.indexOf(b)||a===b)&&c(!0)})}}],Le=function(){return{restrict:"E",require:["select","?ngModel"],controller:nh,priority:1,link:{pre:function(a,b,d,c){var e=c[0],f=c[1];if(f){if(e.ngModelCtrl=f,b.on("change",function(){e.removeUnknownOption();a.$apply(function(){f.$setViewValue(e.readValue())})}),d.multiple){e.multiple=!0;e.readValue=function(){var a=[];p(b.find("option"),function(b){b.selected&&!b.disabled&&
(b=b.value,a.push(b in e.selectValueMap?e.selectValueMap[b]:b))});return a};e.writeValue=function(a){p(b.find("option"),function(b){var c=!!a&&(-1!==Array.prototype.indexOf.call(a,b.value)||-1!==Array.prototype.indexOf.call(a,e.selectValueMap[b.value]));c!==b.selected&&Ha(z(b),c)})};var g,k=NaN;a.$watch(function(){k!==f.$viewValue||sa(g,f.$viewValue)||(g=ra(f.$viewValue),f.$render());k=f.$viewValue});f.$isEmpty=function(a){return!a||0===a.length}}}else e.registerOption=B},post:function(a,b,d,c){var e=
c[1];if(e){var f=c[0];e.$render=function(){f.writeValue(e.$viewValue)}}}}}},Me=["$interpolate",function(a){return{restrict:"E",priority:100,compile:function(b,d){var c,e;t(d.ngValue)||(t(d.value)?c=a(d.value,!0):(e=a(b.text(),!0))||d.$set("value",b.text()));return function(a,b,d){var h=b.parent();(h=h.data("$selectController")||h.parent().data("$selectController"))&&h.registerOption(a,b,d,c,e)}}}}],ad=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,d,c){c&&(d.required=!0,c.$validators.required=
function(a,b){return!d.required||!c.$isEmpty(b)},d.$observe("required",function(){c.$validate()}))}}},$c=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,d,c){if(c){var e,f=d.ngPattern||d.pattern;d.$observe("pattern",function(a){C(a)&&0<a.length&&(a=new RegExp("^"+a+"$"));if(a&&!a.test)throw K("ngPattern")("noregexp",f,a,Aa(b));e=a||void 0;c.$validate()});c.$validators.pattern=function(a,b){return c.$isEmpty(b)||v(e)||e.test(b)}}}}},cd=function(){return{restrict:"A",require:"?ngModel",
link:function(a,b,d,c){if(c){var e=-1;d.$observe("maxlength",function(a){a=Q(a);e=ba(a)?-1:a;c.$validate()});c.$validators.maxlength=function(a,b){return 0>e||c.$isEmpty(b)||b.length<=e}}}}},bd=function(){return{restrict:"A",require:"?ngModel",link:function(a,b,d,c){if(c){var e=0;d.$observe("minlength",function(a){e=Q(a)||0;c.$validate()});c.$validators.minlength=function(a,b){return c.$isEmpty(b)||b.length>=e}}}}};x.angular.bootstrap?x.console&&console.log("WARNING: Tried to load angular more than once."):
(Ce(),Fe(fa),fa.module("ngLocale",[],["$provide",function(a){function b(a){a+="";var b=a.indexOf(".");return-1==b?0:a.length-b-1}a.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:"January February March April May June July August September October November December".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
STANDALONEMONTH:"January February March April May June July August September October November December".split(" "),WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,
minFrac:2,minInt:1,negPre:"-\u00a4",negSuf:"",posPre:"\u00a4",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(a,c){var e=a|0,f=c;void 0===f&&(f=Math.min(b(a),3));Math.pow(10,f);return 1==e&&0==f?"one":"other"}})}]),z(function(){xe(x.document,Uc)}))})(window);!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>');
//# sourceMappingURL=angular.min.js.map

/*
 AngularJS v1.6.5
 (c) 2010-2017 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(S,q){'use strict';function Ea(a,b,c){if(!a)throw Pa("areq",b||"?",c||"required");return a}function Fa(a,b){if(!a&&!b)return"";if(!a)return b;if(!b)return a;V(a)&&(a=a.join(" "));V(b)&&(b=b.join(" "));return a+" "+b}function Qa(a){var b={};a&&(a.to||a.from)&&(b.to=a.to,b.from=a.from);return b}function W(a,b,c){var d="";a=V(a)?a:a&&C(a)&&a.length?a.split(/\s+/):[];t(a,function(a,f){a&&0<a.length&&(d+=0<f?" ":"",d+=c?b+a:a+b)});return d}function Ga(a){if(a instanceof A)switch(a.length){case 0:return a;
case 1:if(1===a[0].nodeType)return a;break;default:return A(ua(a))}if(1===a.nodeType)return A(a)}function ua(a){if(!a[0])return a;for(var b=0;b<a.length;b++){var c=a[b];if(1===c.nodeType)return c}}function Ra(a,b,c){t(b,function(b){a.addClass(b,c)})}function Sa(a,b,c){t(b,function(b){a.removeClass(b,c)})}function X(a){return function(b,c){c.addClass&&(Ra(a,b,c.addClass),c.addClass=null);c.removeClass&&(Sa(a,b,c.removeClass),c.removeClass=null)}}function oa(a){a=a||{};if(!a.$$prepared){var b=a.domOperation||
O;a.domOperation=function(){a.$$domOperationFired=!0;b();b=O};a.$$prepared=!0}return a}function ha(a,b){Ha(a,b);Ia(a,b)}function Ha(a,b){b.from&&(a.css(b.from),b.from=null)}function Ia(a,b){b.to&&(a.css(b.to),b.to=null)}function T(a,b,c){var d=b.options||{};c=c.options||{};var e=(d.addClass||"")+" "+(c.addClass||""),f=(d.removeClass||"")+" "+(c.removeClass||"");a=Ta(a.attr("class"),e,f);c.preparationClasses&&(d.preparationClasses=ca(c.preparationClasses,d.preparationClasses),delete c.preparationClasses);
e=d.domOperation!==O?d.domOperation:null;va(d,c);e&&(d.domOperation=e);d.addClass=a.addClass?a.addClass:null;d.removeClass=a.removeClass?a.removeClass:null;b.addClass=d.addClass;b.removeClass=d.removeClass;return d}function Ta(a,b,c){function d(a){C(a)&&(a=a.split(" "));var b={};t(a,function(a){a.length&&(b[a]=!0)});return b}var e={};a=d(a);b=d(b);t(b,function(a,b){e[b]=1});c=d(c);t(c,function(a,b){e[b]=1===e[b]?null:-1});var f={addClass:"",removeClass:""};t(e,function(b,c){var d,e;1===b?(d="addClass",
e=!a[c]||a[c+"-remove"]):-1===b&&(d="removeClass",e=a[c]||a[c+"-add"]);e&&(f[d].length&&(f[d]+=" "),f[d]+=c)});return f}function J(a){return a instanceof A?a[0]:a}function Ua(a,b,c){var d="";b&&(d=W(b,"ng-",!0));c.addClass&&(d=ca(d,W(c.addClass,"-add")));c.removeClass&&(d=ca(d,W(c.removeClass,"-remove")));d.length&&(c.preparationClasses=d,a.addClass(d))}function pa(a,b){var c=b?"-"+b+"s":"";ka(a,[la,c]);return[la,c]}function wa(a,b){var c=b?"paused":"",d=Y+"PlayState";ka(a,[d,c]);return[d,c]}function ka(a,
b){a.style[b[0]]=b[1]}function ca(a,b){return a?b?a+" "+b:a:b}function Ja(a,b,c){var d=Object.create(null),e=a.getComputedStyle(b)||{};t(c,function(a,b){var c=e[a];if(c){var l=c.charAt(0);if("-"===l||"+"===l||0<=l)c=Va(c);0===c&&(c=null);d[b]=c}});return d}function Va(a){var b=0;a=a.split(/\s*,\s*/);t(a,function(a){"s"===a.charAt(a.length-1)&&(a=a.substring(0,a.length-1));a=parseFloat(a)||0;b=b?Math.max(a,b):a});return b}function xa(a){return 0===a||null!=a}function Ka(a,b){var c=Q,d=a+"s";b?c+="Duration":
d+=" linear all";return[c,d]}function La(){var a=Object.create(null);return{flush:function(){a=Object.create(null)},count:function(b){return(b=a[b])?b.total:0},get:function(b){return(b=a[b])&&b.value},put:function(b,c){a[b]?a[b].total++:a[b]={total:1,value:c}}}}function Ma(a,b,c){t(c,function(c){a[c]=ya(a[c])?a[c]:b.style.getPropertyValue(c)})}var Q,za,Y,Aa;void 0===S.ontransitionend&&void 0!==S.onwebkittransitionend?(Q="WebkitTransition",za="webkitTransitionEnd transitionend"):(Q="transition",za=
"transitionend");void 0===S.onanimationend&&void 0!==S.onwebkitanimationend?(Y="WebkitAnimation",Aa="webkitAnimationEnd animationend"):(Y="animation",Aa="animationend");var qa=Y+"Delay",Ba=Y+"Duration",la=Q+"Delay",Na=Q+"Duration",Pa=q.$$minErr("ng"),Wa={transitionDuration:Na,transitionDelay:la,transitionProperty:Q+"Property",animationDuration:Ba,animationDelay:qa,animationIterationCount:Y+"IterationCount"},Xa={transitionDuration:Na,transitionDelay:la,animationDuration:Ba,animationDelay:qa},Ca,va,
t,V,ya,Z,Da,ra,C,P,A,O;q.module("ngAnimate",[],function(){O=q.noop;Ca=q.copy;va=q.extend;A=q.element;t=q.forEach;V=q.isArray;C=q.isString;ra=q.isObject;P=q.isUndefined;ya=q.isDefined;Da=q.isFunction;Z=q.isElement}).info({angularVersion:"1.6.5"}).directive("ngAnimateSwap",["$animate","$rootScope",function(a,b){return{restrict:"A",transclude:"element",terminal:!0,priority:600,link:function(b,d,e,f,n){var G,l;b.$watchCollection(e.ngAnimateSwap||e["for"],function(e){G&&a.leave(G);l&&(l.$destroy(),l=null);
if(e||0===e)l=b.$new(),n(l,function(b){G=b;a.enter(b,null,d)})})}}}]).directive("ngAnimateChildren",["$interpolate",function(a){return{link:function(b,c,d){function e(a){c.data("$$ngAnimateChildren","on"===a||"true"===a)}var f=d.ngAnimateChildren;C(f)&&0===f.length?c.data("$$ngAnimateChildren",!0):(e(a(f)(b)),d.$observe("ngAnimateChildren",e))}}}]).factory("$$rAFScheduler",["$$rAF",function(a){function b(a){d=d.concat(a);c()}function c(){if(d.length){for(var b=d.shift(),n=0;n<b.length;n++)b[n]();
e||a(function(){e||c()})}}var d,e;d=b.queue=[];b.waitUntilQuiet=function(b){e&&e();e=a(function(){e=null;b();c()})};return b}]).provider("$$animateQueue",["$animateProvider",function(a){function b(a){if(!a)return null;a=a.split(" ");var b=Object.create(null);t(a,function(a){b[a]=!0});return b}function c(a,c){if(a&&c){var d=b(c);return a.split(" ").some(function(a){return d[a]})}}function d(a,b,c){return f[a].some(function(a){return a(b,c)})}function e(a,b){var c=0<(a.addClass||"").length,d=0<(a.removeClass||
"").length;return b?c&&d:c||d}var f=this.rules={skip:[],cancel:[],join:[]};f.join.push(function(a,b){return!a.structural&&e(a)});f.skip.push(function(a,b){return!a.structural&&!e(a)});f.skip.push(function(a,b){return"leave"===b.event&&a.structural});f.skip.push(function(a,b){return b.structural&&2===b.state&&!a.structural});f.cancel.push(function(a,b){return b.structural&&a.structural});f.cancel.push(function(a,b){return 2===b.state&&a.structural});f.cancel.push(function(a,b){if(b.structural)return!1;
var d=a.addClass,e=a.removeClass,f=b.addClass,sa=b.removeClass;return P(d)&&P(e)||P(f)&&P(sa)?!1:c(d,sa)||c(e,f)});this.$get=["$$rAF","$rootScope","$rootElement","$document","$$Map","$$animation","$$AnimateRunner","$templateRequest","$$jqLite","$$forceReflow","$$isDocumentHidden",function(b,c,f,s,y,sa,da,v,E,g,M){function x(){var a=!1;return function(b){a?b():c.$$postDigest(function(){a=!0;b()})}}function H(a,b,c){var h=[],d=k[c];d&&t(d,function(d){u.call(d.node,b)?h.push(d.callback):"leave"===c&&
u.call(d.node,a)&&h.push(d.callback)});return h}function I(a,b,c){var h=ua(b);return a.filter(function(a){return!(a.node===h&&(!c||a.callback===c))})}function K(a,k,w){function K(a,c,h,k){s(function(){var a=H(na,p,c);a.length?b(function(){t(a,function(a){a(f,h,k)});"close"!==h||p.parentNode||ba.off(p)}):"close"!==h||p.parentNode||ba.off(p)});a.progress(c,h,k)}function I(a){var b=f,c=g;c.preparationClasses&&(b.removeClass(c.preparationClasses),c.preparationClasses=null);c.activeClasses&&(b.removeClass(c.activeClasses),
c.activeClasses=null);Oa(f,g);ha(f,g);g.domOperation();l.complete(!a)}var g=Ca(w),f=Ga(a),p=J(f),na=p&&p.parentNode,g=oa(g),l=new da,s=x();V(g.addClass)&&(g.addClass=g.addClass.join(" "));g.addClass&&!C(g.addClass)&&(g.addClass=null);V(g.removeClass)&&(g.removeClass=g.removeClass.join(" "));g.removeClass&&!C(g.removeClass)&&(g.removeClass=null);g.from&&!ra(g.from)&&(g.from=null);g.to&&!ra(g.to)&&(g.to=null);if(!(h&&p&&Ya(p,k,w)&&D(p,g)))return I(),l;var v=0<=["enter","move","leave"].indexOf(k),u=
M(),y=u||ga.get(p);w=!y&&z.get(p)||{};var E=!!w.state;y||E&&1===w.state||(y=!L(p,na,k));if(y)return u&&K(l,k,"start"),I(),u&&K(l,k,"close"),l;v&&ta(p);u={structural:v,element:f,event:k,addClass:g.addClass,removeClass:g.removeClass,close:I,options:g,runner:l};if(E){if(d("skip",u,w)){if(2===w.state)return I(),l;T(f,w,u);return w.runner}if(d("cancel",u,w))if(2===w.state)w.runner.end();else if(w.structural)w.close();else return T(f,w,u),w.runner;else if(d("join",u,w))if(2===w.state)T(f,u,{});else return Ua(f,
v?k:null,g),k=u.event=w.event,g=T(f,w,u),w.runner}else T(f,u,{});(E=u.structural)||(E="animate"===u.event&&0<Object.keys(u.options.to||{}).length||e(u));if(!E)return I(),m(p),l;var q=(w.counter||0)+1;u.counter=q;F(p,1,u);c.$$postDigest(function(){f=Ga(a);var b=z.get(p),c=!b,b=b||{},h=0<(f.parent()||[]).length&&("animate"===b.event||b.structural||e(b));if(c||b.counter!==q||!h){c&&(Oa(f,g),ha(f,g));if(c||v&&b.event!==k)g.domOperation(),l.end();h||m(p)}else k=!b.structural&&e(b,!0)?"setClass":b.event,
F(p,2),b=sa(f,k,b.options),l.setHost(b),K(l,k,"start",{}),b.done(function(a){I(!a);(a=z.get(p))&&a.counter===q&&m(p);K(l,k,"close",{})})});return l}function ta(a){a=a.querySelectorAll("[data-ng-animate]");t(a,function(a){var b=parseInt(a.getAttribute("data-ng-animate"),10),c=z.get(a);if(c)switch(b){case 2:c.runner.end();case 1:z.delete(a)}})}function m(a){a.removeAttribute("data-ng-animate");z.delete(a)}function L(a,b,c){c=s[0].body;var h=J(f),k=a===c||"HTML"===a.nodeName,d=a===h,g=!1,e=ga.get(a),
p;for((a=A.data(a,"$ngAnimatePin"))&&(b=J(a));b;){d||(d=b===h);if(1!==b.nodeType)break;a=z.get(b)||{};if(!g){var H=ga.get(b);if(!0===H&&!1!==e){e=!0;break}else!1===H&&(e=!1);g=a.structural}if(P(p)||!0===p)a=A.data(b,"$$ngAnimateChildren"),ya(a)&&(p=a);if(g&&!1===p)break;k||(k=b===c);if(k&&d)break;if(!d&&(a=A.data(b,"$ngAnimatePin"))){b=J(a);continue}b=b.parentNode}return(!g||p)&&!0!==e&&d&&k}function F(a,b,c){c=c||{};c.state=b;a.setAttribute("data-ng-animate",b);c=(b=z.get(a))?va(b,c):c;z.set(a,c)}
var z=new y,ga=new y,h=null,p=c.$watch(function(){return 0===v.totalPendingRequests},function(a){a&&(p(),c.$$postDigest(function(){c.$$postDigest(function(){null===h&&(h=!0)})}))}),k=Object.create(null);y=a.customFilter();var na=a.classNameFilter();g=function(){return!0};var Ya=y||g,D=na?function(a,b){var c=[a.getAttribute("class"),b.addClass,b.removeClass].join(" ");return na.test(c)}:g,Oa=X(E),u=S.Node.prototype.contains||function(a){return this===a||!!(this.compareDocumentPosition(a)&16)},ba={on:function(a,
b,c){var h=ua(b);k[a]=k[a]||[];k[a].push({node:h,callback:c});A(b).on("$destroy",function(){z.get(h)||ba.off(a,b,c)})},off:function(a,b,c){if(1!==arguments.length||C(arguments[0])){var h=k[a];h&&(k[a]=1===arguments.length?null:I(h,b,c))}else for(h in b=arguments[0],k)k[h]=I(k[h],b)},pin:function(a,b){Ea(Z(a),"element","not an element");Ea(Z(b),"parentElement","not an element");a.data("$ngAnimatePin",b)},push:function(a,b,c,h){c=c||{};c.domOperation=h;return K(a,b,c)},enabled:function(a,b){var c=arguments.length;
if(0===c)b=!!h;else if(Z(a)){var k=J(a);1===c?b=!ga.get(k):ga.set(k,!b)}else b=h=!!a;return b}};return ba}]}]).provider("$$animation",["$animateProvider",function(a){var b=this.drivers=[];this.$get=["$$jqLite","$rootScope","$injector","$$AnimateRunner","$$Map","$$rAFScheduler",function(a,d,e,f,n,G){function l(a){function b(a){if(a.processed)return a;a.processed=!0;var d=a.domNode,e=d.parentNode;g.set(d,a);for(var f;e;){if(f=g.get(e)){f.processed||(f=b(f));break}e=e.parentNode}(f||c).children.push(a);
return a}var c={children:[]},d,g=new n;for(d=0;d<a.length;d++){var e=a[d];g.set(e.domNode,a[d]={domNode:e.domNode,fn:e.fn,children:[]})}for(d=0;d<a.length;d++)b(a[d]);return function(a){var b=[],c=[],d;for(d=0;d<a.children.length;d++)c.push(a.children[d]);a=c.length;var g=0,e=[];for(d=0;d<c.length;d++){var f=c[d];0>=a&&(a=g,g=0,b.push(e),e=[]);e.push(f.fn);f.children.forEach(function(a){g++;c.push(a)});a--}e.length&&b.push(e);return b}(c)}var s=[],y=X(a);return function(n,q,v){function E(a){a=a.hasAttribute("ng-animate-ref")?
[a]:a.querySelectorAll("[ng-animate-ref]");var b=[];t(a,function(a){var c=a.getAttribute("ng-animate-ref");c&&c.length&&b.push(a)});return b}function g(a){var b=[],c={};t(a,function(a,d){var k=J(a.element),g=0<=["enter","move"].indexOf(a.event),k=a.structural?E(k):[];if(k.length){var e=g?"to":"from";t(k,function(a){var b=a.getAttribute("ng-animate-ref");c[b]=c[b]||{};c[b][e]={animationID:d,element:A(a)}})}else b.push(a)});var d={},g={};t(c,function(c,e){var f=c.from,p=c.to;if(f&&p){var H=a[f.animationID],
z=a[p.animationID],m=f.animationID.toString();if(!g[m]){var l=g[m]={structural:!0,beforeStart:function(){H.beforeStart();z.beforeStart()},close:function(){H.close();z.close()},classes:M(H.classes,z.classes),from:H,to:z,anchors:[]};l.classes.length?b.push(l):(b.push(H),b.push(z))}g[m].anchors.push({out:f.element,"in":p.element})}else f=f?f.animationID:p.animationID,p=f.toString(),d[p]||(d[p]=!0,b.push(a[f]))});return b}function M(a,b){a=a.split(" ");b=b.split(" ");for(var c=[],d=0;d<a.length;d++){var g=
a[d];if("ng-"!==g.substring(0,3))for(var e=0;e<b.length;e++)if(g===b[e]){c.push(g);break}}return c.join(" ")}function x(a){for(var c=b.length-1;0<=c;c--){var d=e.get(b[c])(a);if(d)return d}}function H(a,b){function c(a){(a=a.data("$$animationRunner"))&&a.setHost(b)}a.from&&a.to?(c(a.from.element),c(a.to.element)):c(a.element)}function I(){var a=n.data("$$animationRunner");!a||"leave"===q&&v.$$domOperationFired||a.end()}function K(b){n.off("$destroy",I);n.removeData("$$animationRunner");y(n,v);ha(n,
v);v.domOperation();F&&a.removeClass(n,F);n.removeClass("ng-animate");m.complete(!b)}v=oa(v);var ta=0<=["enter","move","leave"].indexOf(q),m=new f({end:function(){K()},cancel:function(){K(!0)}});if(!b.length)return K(),m;n.data("$$animationRunner",m);var L=Fa(n.attr("class"),Fa(v.addClass,v.removeClass)),F=v.tempClasses;F&&(L+=" "+F,v.tempClasses=null);var z;ta&&(z="ng-"+q+"-prepare",a.addClass(n,z));s.push({element:n,classes:L,event:q,structural:ta,options:v,beforeStart:function(){n.addClass("ng-animate");
F&&a.addClass(n,F);z&&(a.removeClass(n,z),z=null)},close:K});n.on("$destroy",I);if(1<s.length)return m;d.$$postDigest(function(){var a=[];t(s,function(b){b.element.data("$$animationRunner")?a.push(b):b.close()});s.length=0;var b=g(a),c=[];t(b,function(a){c.push({domNode:J(a.from?a.from.element:a.element),fn:function(){a.beforeStart();var b,c=a.close;if((a.anchors?a.from.element||a.to.element:a.element).data("$$animationRunner")){var d=x(a);d&&(b=d.start)}b?(b=b(),b.done(function(a){c(!a)}),H(a,b)):
c()}})});G(l(c))});return m}}]}]).provider("$animateCss",["$animateProvider",function(a){var b=La(),c=La();this.$get=["$window","$$jqLite","$$AnimateRunner","$timeout","$$forceReflow","$sniffer","$$rAFScheduler","$$animateQueue",function(a,e,f,n,G,l,s,y){function q(a,b){var c=a.parentNode;return(c.$$ngAnimateParentKey||(c.$$ngAnimateParentKey=++M))+"-"+a.getAttribute("class")+"-"+b}function da(g,f,l,n){var m;0<b.count(l)&&(m=c.get(l),m||(f=W(f,"-stagger"),e.addClass(g,f),m=Ja(a,g,n),m.animationDuration=
Math.max(m.animationDuration,0),m.transitionDuration=Math.max(m.transitionDuration,0),e.removeClass(g,f),c.put(l,m)));return m||{}}function v(a){x.push(a);s.waitUntilQuiet(function(){b.flush();c.flush();for(var a=G(),d=0;d<x.length;d++)x[d](a);x.length=0})}function E(c,g,e){g=b.get(e);g||(g=Ja(a,c,Wa),"infinite"===g.animationIterationCount&&(g.animationIterationCount=1));b.put(e,g);c=g;e=c.animationDelay;g=c.transitionDelay;c.maxDelay=e&&g?Math.max(e,g):e||g;c.maxDuration=Math.max(c.animationDuration*
c.animationIterationCount,c.transitionDuration);return c}var g=X(e),M=0,x=[];return function(a,c){function d(){m()}function s(){m(!0)}function m(b){if(!(M||ba&&u)){M=!0;u=!1;h.$$skipPreparationClasses||e.removeClass(a,fa);e.removeClass(a,ca);wa(k,!1);pa(k,!1);t(x,function(a){k.style[a[0]]=""});g(a,h);ha(a,h);Object.keys(p).length&&t(p,function(a,b){a?k.style.setProperty(b,a):k.style.removeProperty(b)});if(h.onDone)h.onDone();ea&&ea.length&&a.off(ea.join(" "),z);var c=a.data("$$animateCss");c&&(n.cancel(c[0].timer),
a.removeData("$$animateCss"));A&&A.complete(!b)}}function L(a){r.blockTransition&&pa(k,a);r.blockKeyframeAnimation&&wa(k,!!a)}function F(){A=new f({end:d,cancel:s});v(O);m();return{$$willAnimate:!1,start:function(){return A},end:d}}function z(a){a.stopPropagation();var b=a.originalEvent||a;a=b.$manualTimeStamp||Date.now();b=parseFloat(b.elapsedTime.toFixed(3));Math.max(a-T,0)>=P&&b>=N&&(ba=!0,m())}function ga(){function b(){if(!M){L(!1);t(x,function(a){k.style[a[0]]=a[1]});g(a,h);e.addClass(a,ca);
if(r.recalculateTimingStyles){ma=k.getAttribute("class")+" "+fa;ja=q(k,ma);B=E(k,ma,ja);$=B.maxDelay;w=Math.max($,0);N=B.maxDuration;if(0===N){m();return}r.hasTransitions=0<B.transitionDuration;r.hasAnimations=0<B.animationDuration}r.applyAnimationDelay&&($="boolean"!==typeof h.delay&&xa(h.delay)?parseFloat(h.delay):$,w=Math.max($,0),B.animationDelay=$,aa=[qa,$+"s"],x.push(aa),k.style[aa[0]]=aa[1]);P=1E3*w;S=1E3*N;if(h.easing){var d,f=h.easing;r.hasTransitions&&(d=Q+"TimingFunction",x.push([d,f]),
k.style[d]=f);r.hasAnimations&&(d=Y+"TimingFunction",x.push([d,f]),k.style[d]=f)}B.transitionDuration&&ea.push(za);B.animationDuration&&ea.push(Aa);T=Date.now();var l=P+1.5*S;d=T+l;var f=a.data("$$animateCss")||[],F=!0;if(f.length){var s=f[0];(F=d>s.expectedEndTime)?n.cancel(s.timer):f.push(m)}F&&(l=n(c,l,!1),f[0]={timer:l,expectedEndTime:d},f.push(m),a.data("$$animateCss",f));if(ea.length)a.on(ea.join(" "),z);h.to&&(h.cleanupStyles&&Ma(p,k,Object.keys(h.to)),Ia(a,h))}}function c(){var b=a.data("$$animateCss");
if(b){for(var d=1;d<b.length;d++)b[d]();a.removeData("$$animateCss")}}if(!M)if(k.parentNode){var d=function(a){if(ba)u&&a&&(u=!1,m());else if(u=!a,B.animationDuration)if(a=wa(k,u),u)x.push(a);else{var b=x,c=b.indexOf(a);0<=a&&b.splice(c,1)}},f=0<Z&&(B.transitionDuration&&0===U.transitionDuration||B.animationDuration&&0===U.animationDuration)&&Math.max(U.animationDelay,U.transitionDelay);f?n(b,Math.floor(f*Z*1E3),!1):b();C.resume=function(){d(!0)};C.pause=function(){d(!1)}}else m()}var h=c||{};h.$$prepared||
(h=oa(Ca(h)));var p={},k=J(a);if(!k||!k.parentNode||!y.enabled())return F();var x=[],G=a.attr("class"),D=Qa(h),M,u,ba,A,C,w,P,N,S,T,ea=[];if(0===h.duration||!l.animations&&!l.transitions)return F();var ia=h.event&&V(h.event)?h.event.join(" "):h.event,X="",R="";ia&&h.structural?X=W(ia,"ng-",!0):ia&&(X=ia);h.addClass&&(R+=W(h.addClass,"-add"));h.removeClass&&(R.length&&(R+=" "),R+=W(h.removeClass,"-remove"));h.applyClassesEarly&&R.length&&g(a,h);var fa=[X,R].join(" ").trim(),ma=G+" "+fa,ca=W(fa,"-active"),
G=D.to&&0<Object.keys(D.to).length;if(!(0<(h.keyframeStyle||"").length||G||fa))return F();var ja,U;0<h.stagger?(D=parseFloat(h.stagger),U={transitionDelay:D,animationDelay:D,transitionDuration:0,animationDuration:0}):(ja=q(k,ma),U=da(k,fa,ja,Xa));h.$$skipPreparationClasses||e.addClass(a,fa);h.transitionStyle&&(D=[Q,h.transitionStyle],ka(k,D),x.push(D));0<=h.duration&&(D=0<k.style[Q].length,D=Ka(h.duration,D),ka(k,D),x.push(D));h.keyframeStyle&&(D=[Y,h.keyframeStyle],ka(k,D),x.push(D));var Z=U?0<=
h.staggerIndex?h.staggerIndex:b.count(ja):0;(ia=0===Z)&&!h.skipBlocking&&pa(k,9999);var B=E(k,ma,ja),$=B.maxDelay;w=Math.max($,0);N=B.maxDuration;var r={};r.hasTransitions=0<B.transitionDuration;r.hasAnimations=0<B.animationDuration;r.hasTransitionAll=r.hasTransitions&&"all"===B.transitionProperty;r.applyTransitionDuration=G&&(r.hasTransitions&&!r.hasTransitionAll||r.hasAnimations&&!r.hasTransitions);r.applyAnimationDuration=h.duration&&r.hasAnimations;r.applyTransitionDelay=xa(h.delay)&&(r.applyTransitionDuration||
r.hasTransitions);r.applyAnimationDelay=xa(h.delay)&&r.hasAnimations;r.recalculateTimingStyles=0<R.length;if(r.applyTransitionDuration||r.applyAnimationDuration)N=h.duration?parseFloat(h.duration):N,r.applyTransitionDuration&&(r.hasTransitions=!0,B.transitionDuration=N,D=0<k.style[Q+"Property"].length,x.push(Ka(N,D))),r.applyAnimationDuration&&(r.hasAnimations=!0,B.animationDuration=N,x.push([Ba,N+"s"]));if(0===N&&!r.recalculateTimingStyles)return F();if(null!=h.delay){var aa;"boolean"!==typeof h.delay&&
(aa=parseFloat(h.delay),w=Math.max(aa,0));r.applyTransitionDelay&&x.push([la,aa+"s"]);r.applyAnimationDelay&&x.push([qa,aa+"s"])}null==h.duration&&0<B.transitionDuration&&(r.recalculateTimingStyles=r.recalculateTimingStyles||ia);P=1E3*w;S=1E3*N;h.skipBlocking||(r.blockTransition=0<B.transitionDuration,r.blockKeyframeAnimation=0<B.animationDuration&&0<U.animationDelay&&0===U.animationDuration);h.from&&(h.cleanupStyles&&Ma(p,k,Object.keys(h.from)),Ha(a,h));r.blockTransition||r.blockKeyframeAnimation?
L(N):h.skipBlocking||pa(k,!1);return{$$willAnimate:!0,end:d,start:function(){if(!M)return C={end:d,cancel:s,resume:null,pause:null},A=new f(C),v(ga),A}}}}]}]).provider("$$animateCssDriver",["$$animationProvider",function(a){a.drivers.push("$$animateCssDriver");this.$get=["$animateCss","$rootScope","$$AnimateRunner","$rootElement","$sniffer","$$jqLite","$document",function(a,c,d,e,f,n,G){function l(a){return a.replace(/\bng-\S+\b/g,"")}function s(a,b){C(a)&&(a=a.split(" "));C(b)&&(b=b.split(" "));
return a.filter(function(a){return-1===b.indexOf(a)}).join(" ")}function y(c,f,e){function n(a){var b={},c=J(a).getBoundingClientRect();t(["width","height","top","left"],function(a){var d=c[a];switch(a){case "top":d+=v.scrollTop;break;case "left":d+=v.scrollLeft}b[a]=Math.floor(d)+"px"});return b}function G(){var c=l(e.attr("class")||""),d=s(c,m),c=s(m,c),d=a(y,{to:n(e),addClass:"ng-anchor-in "+d,removeClass:"ng-anchor-out "+c,delay:!0});return d.$$willAnimate?d:null}function q(){y.remove();f.removeClass("ng-animate-shim");
e.removeClass("ng-animate-shim")}var y=A(J(f).cloneNode(!0)),m=l(y.attr("class")||"");f.addClass("ng-animate-shim");e.addClass("ng-animate-shim");y.addClass("ng-anchor");E.append(y);var L;c=function(){var c=a(y,{addClass:"ng-anchor-out",delay:!0,from:n(f)});return c.$$willAnimate?c:null}();if(!c&&(L=G(),!L))return q();var F=c||L;return{start:function(){function a(){c&&c.end()}var b,c=F.start();c.done(function(){c=null;if(!L&&(L=G()))return c=L.start(),c.done(function(){c=null;q();b.complete()}),c;
q();b.complete()});return b=new d({end:a,cancel:a})}}}function q(a,b,c,f){var e=da(a,O),l=da(b,O),n=[];t(f,function(a){(a=y(c,a.out,a["in"]))&&n.push(a)});if(e||l||0!==n.length)return{start:function(){function a(){t(b,function(a){a.end()})}var b=[];e&&b.push(e.start());l&&b.push(l.start());t(n,function(a){b.push(a.start())});var c=new d({end:a,cancel:a});d.all(b,function(a){c.complete(a)});return c}}}function da(c){var d=c.element,e=c.options||{};c.structural&&(e.event=c.event,e.structural=!0,e.applyClassesEarly=
!0,"leave"===c.event&&(e.onDone=e.domOperation));e.preparationClasses&&(e.event=ca(e.event,e.preparationClasses));c=a(d,e);return c.$$willAnimate?c:null}if(!f.animations&&!f.transitions)return O;var v=G[0].body;c=J(e);var E=A(c.parentNode&&11===c.parentNode.nodeType||v.contains(c)?c:v);return function(a){return a.from&&a.to?q(a.from,a.to,a.classes,a.anchors):da(a)}}]}]).provider("$$animateJs",["$animateProvider",function(a){this.$get=["$injector","$$AnimateRunner","$$jqLite",function(b,c,d){function e(c){c=
V(c)?c:c.split(" ");for(var d=[],e={},f=0;f<c.length;f++){var y=c[f],q=a.$$registeredAnimations[y];q&&!e[y]&&(d.push(b.get(q)),e[y]=!0)}return d}var f=X(d);return function(a,b,d,s){function q(){s.domOperation();f(a,s)}function A(a,b,d,e,f){switch(d){case "animate":b=[b,e.from,e.to,f];break;case "setClass":b=[b,g,M,f];break;case "addClass":b=[b,g,f];break;case "removeClass":b=[b,M,f];break;default:b=[b,f]}b.push(e);if(a=a.apply(a,b))if(Da(a.start)&&(a=a.start()),a instanceof c)a.done(f);else if(Da(a))return a;
return O}function C(a,b,d,e,f){var g=[];t(e,function(e){var l=e[f];l&&g.push(function(){var e,f,h=!1,g=function(a){h||(h=!0,(f||O)(a),e.complete(!a))};e=new c({end:function(){g()},cancel:function(){g(!0)}});f=A(l,a,b,d,function(a){g(!1===a)});return e})});return g}function v(a,b,d,e,f){var g=C(a,b,d,e,f);if(0===g.length){var k,l;"beforeSetClass"===f?(k=C(a,"removeClass",d,e,"beforeRemoveClass"),l=C(a,"addClass",d,e,"beforeAddClass")):"setClass"===f&&(k=C(a,"removeClass",d,e,"removeClass"),l=C(a,"addClass",
d,e,"addClass"));k&&(g=g.concat(k));l&&(g=g.concat(l))}if(0!==g.length)return function(a){var b=[];g.length&&t(g,function(a){b.push(a())});b.length?c.all(b,a):a();return function(a){t(b,function(b){a?b.cancel():b.end()})}}}var E=!1;3===arguments.length&&ra(d)&&(s=d,d=null);s=oa(s);d||(d=a.attr("class")||"",s.addClass&&(d+=" "+s.addClass),s.removeClass&&(d+=" "+s.removeClass));var g=s.addClass,M=s.removeClass,x=e(d),H,I;if(x.length){var K,J;"leave"===b?(J="leave",K="afterLeave"):(J="before"+b.charAt(0).toUpperCase()+
b.substr(1),K=b);"enter"!==b&&"move"!==b&&(H=v(a,b,s,x,J));I=v(a,b,s,x,K)}if(H||I){var m;return{$$willAnimate:!0,end:function(){m?m.end():(E=!0,q(),ha(a,s),m=new c,m.complete(!0));return m},start:function(){function b(c){E=!0;q();ha(a,s);m.complete(c)}if(m)return m;m=new c;var d,e=[];H&&e.push(function(a){d=H(a)});e.length?e.push(function(a){q();a(!0)}):q();I&&e.push(function(a){d=I(a)});m.setHost({end:function(){E||((d||O)(void 0),b(void 0))},cancel:function(){E||((d||O)(!0),b(!0))}});c.chain(e,
b);return m}}}}}]}]).provider("$$animateJsDriver",["$$animationProvider",function(a){a.drivers.push("$$animateJsDriver");this.$get=["$$animateJs","$$AnimateRunner",function(a,c){function d(c){return a(c.element,c.event,c.classes,c.options)}return function(a){if(a.from&&a.to){var b=d(a.from),n=d(a.to);if(b||n)return{start:function(){function a(){return function(){t(d,function(a){a.end()})}}var d=[];b&&d.push(b.start());n&&d.push(n.start());c.all(d,function(a){e.complete(a)});var e=new c({end:a(),cancel:a()});
return e}}}else return d(a)}}]}])})(window,window.angular);
//# sourceMappingURL=angular-animate.min.js.map

/**
 * floatThead wrapper for AngularJS
 * @version v0.1.0 - 2015-10-25
 * @link https://github.com/brandon-barker/angular-floatThead
 * @author Brandon Barker
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
(function () {
  'use strict';

  angular
    .module('floatThead', [])
    .directive('floatThead', ['$timeout', '$log', floatThead]);

  function floatThead($timeout, $log) {
    // Usage:
    // Specify float-thead on any table element and optionally pass through a floatThead options object to initialize the library.
    // Optionally specify ng-model to have the directive watch any objects for changes and call 'reflow' on floatThead.
    // You can also manually trigger a reflow by triggering an event on the table element called 'update', eg: jQuery('.table').trigger('update');
    var directive = {
      require: '?ngModel',
      scope: {
        floatThead: '=?',
        floatTheadEnabled: '=?'
      },
      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {
        // default float-thead-enabled to true if not present
        if (!$attrs.hasOwnProperty('floatTheadEnabled')) {
          $scope.floatTheadEnabled = $attrs.floatTheadEnabled = true;
        }
        
        // default to empty object
        if (!$attrs.hasOwnProperty('floatThead') || $attrs.floatThead === '') {
          $scope.floatThead = $attrs.floatThead = {};
        }
      }],
      link: link,
      restrict: 'A'
    };
    return directive;

    function link($scope, $element, $attrs, ngModel) {
      $scope.$watch('floatTheadEnabled', function (newVal) {
        if (newVal === true) {
          if (angular.isObject($scope.floatThead)) {
            jQuery($element).floatThead($scope.floatThead);
          }
        } else {
          jQuery($element).floatThead('destroy');
        }
      });
      
      $scope.$watch('floatThead', function (newVal, oldVal) {
        if (newVal === oldVal || !$scope.floatTheadEnabled) {
          return;
        }
        
        // first destroy it so we can recreate with new options
        jQuery($element).floatThead('destroy');
        if (angular.isObject(newVal)) {
          jQuery($element).floatThead(newVal);
        }
      }, true);

      if (ngModel) {
        // hook the model $formatters to get notified when anything changes so we can reflow
        ngModel.$formatters.push(function () {
          // only reflow if enabled
          if ($scope.floatTheadEnabled && angular.isObject($scope.floatThead)) {
            // give time for rerender before reflow
            $timeout(function() {
              jQuery($element).floatThead('reflow');
            });
          }
        });
      } else {
        $log.info('floatThead: ngModel not provided!');
      }

      $element.bind('update', function () {
        $timeout(function () {
          jQuery($element).floatThead('reflow');
        }, 0);
      });

      $element.bind('$destroy', function () {
        jQuery($element).floatThead('destroy');
      });
    }
  }
})();

angular.module("gettext",[]),angular.module("gettext").constant("gettext",function(a){return a}),angular.module("gettext").factory("gettextCatalog",["gettextPlurals","gettextFallbackLanguage","$http","$cacheFactory","$interpolate","$rootScope",function(a,b,c,d,e,f){function g(){f.$broadcast("gettextLanguageChanged")}var h,i="$$noContext",j='<span id="test" title="test" class="tested">test</span>',k=angular.element("<span>"+j+"</span>").html()!==j,l=function(a){return h.debug&&h.currentLanguage!==h.baseLanguage?h.debugPrefix+a:a},m=function(a){return h.showTranslatedMarkers?h.translatedMarkerPrefix+a+h.translatedMarkerSuffix:a};return h={debug:!1,debugPrefix:"[MISSING]: ",showTranslatedMarkers:!1,translatedMarkerPrefix:"[",translatedMarkerSuffix:"]",strings:{},baseLanguage:"en",currentLanguage:"en",cache:d("strings"),setCurrentLanguage:function(a){this.currentLanguage=a,g()},getCurrentLanguage:function(){return this.currentLanguage},setStrings:function(b,c){this.strings[b]||(this.strings[b]={});var d=a(b,1);for(var e in c){var f=c[e];if(k&&(e=angular.element("<span>"+e+"</span>").html()),angular.isString(f)||angular.isArray(f)){var h={};h[i]=f,f=h}this.strings[b][e]||(this.strings[b][e]={});for(var j in f){var l=f[j];angular.isArray(l)?this.strings[b][e][j]=l:(this.strings[b][e][j]=[],this.strings[b][e][j][d]=l)}}g()},getStringFormFor:function(b,c,d,e){if(!b)return null;var f=this.strings[b]||{},g=f[c]||{},h=g[e||i]||[];return h[a(b,d)]},getString:function(a,c,d){var f=b(this.currentLanguage);return a=this.getStringFormFor(this.currentLanguage,a,1,d)||this.getStringFormFor(f,a,1,d)||l(a),a=c?e(a)(c):a,m(a)},getPlural:function(a,c,d,f,g){var h=b(this.currentLanguage);return c=this.getStringFormFor(this.currentLanguage,c,a,g)||this.getStringFormFor(h,c,a,g)||l(1===a?c:d),f&&(f.$count=a,c=e(c)(f)),m(c)},loadRemote:function(a){return c({method:"GET",url:a,cache:h.cache}).then(function(a){var b=a.data;for(var c in b)h.setStrings(c,b[c]);return a})}}}]),angular.module("gettext").directive("translate",["gettextCatalog","$parse","$animate","$compile","$window","gettextUtil",function(a,b,c,d,e,f){function g(a){return f.lcFirst(a.replace(j,""))}function h(a,b,c){var d=Object.keys(b).filter(function(a){return f.startsWith(a,j)&&a!==j});if(!d.length)return null;var e=angular.extend({},a),h=[];return d.forEach(function(d){var f=a.$watch(b[d],function(a){var b=g(d);e[b]=a,c(e)});h.push(f)}),a.$on("$destroy",function(){h.forEach(function(a){a()})}),e}var i=parseInt((/msie (\d+)/.exec(angular.lowercase(e.navigator.userAgent))||[])[1],10),j="translateParams";return{restrict:"AE",terminal:!0,compile:function(e,g){f.assert(!g.translatePlural||g.translateN,"translate-n","translate-plural"),f.assert(!g.translateN||g.translatePlural,"translate-plural","translate-n");var j=f.trim(e.html()),k=g.translatePlural,l=g.translateContext;return 8>=i&&"<!--IE fix-->"===j.slice(-13)&&(j=j.slice(0,-13)),{post:function(e,g,i){function m(b){b=b||null;var h;k?(e=o||(o=e.$new()),e.$count=n(e),h=a.getPlural(e.$count,j,k,b,l)):h=a.getString(j,b,l);var i=g.contents();if(i||h){if(h===f.trim(i.html()))return void(p&&d(i)(e));var m=angular.element("<span>"+h+"</span>");d(m.contents())(e);var q=m.contents();c.enter(q,g),c.leave(i)}}var n=b(i.translateN),o=null,p=!0,q=h(e,i,m);m(q),p=!1,i.translateN&&e.$watch(i.translateN,function(){m(q)}),e.$on("gettextLanguageChanged",function(){m(q)})}}}}}]),angular.module("gettext").factory("gettextFallbackLanguage",function(){var a={},b=/([^_]+)_[^_]+$/;return function(c){if(a[c])return a[c];var d=b.exec(c);return d?(a[c]=d[1],d[1]):null}}),angular.module("gettext").filter("translate",["gettextCatalog",function(a){function b(b,c){return a.getString(b,null,c)}return b.$stateful=!0,b}]),angular.module("gettext").factory("gettextPlurals",function(){function a(a){return b[a]||(b[a]=a.split(/\-|_/).shift()),b[a]}var b={pt_BR:"pt_BR","pt-BR":"pt_BR"};return function(b,c){switch(a(b)){case"ay":case"bo":case"cgg":case"dz":case"fa":case"id":case"ja":case"jbo":case"ka":case"kk":case"km":case"ko":case"ky":case"lo":case"ms":case"my":case"sah":case"su":case"th":case"tt":case"ug":case"vi":case"wo":case"zh":return 0;case"is":return c%10!=1||c%100==11?1:0;case"jv":return 0!=c?1:0;case"mk":return 1==c||c%10==1?0:1;case"ach":case"ak":case"am":case"arn":case"br":case"fil":case"fr":case"gun":case"ln":case"mfe":case"mg":case"mi":case"oc":case"pt_BR":case"tg":case"ti":case"tr":case"uz":case"wa":case"zh":return c>1?1:0;case"lv":return c%10==1&&c%100!=11?0:0!=c?1:2;case"lt":return c%10==1&&c%100!=11?0:c%10>=2&&(10>c%100||c%100>=20)?1:2;case"be":case"bs":case"hr":case"ru":case"sr":case"uk":return c%10==1&&c%100!=11?0:c%10>=2&&4>=c%10&&(10>c%100||c%100>=20)?1:2;case"mnk":return 0==c?0:1==c?1:2;case"ro":return 1==c?0:0==c||c%100>0&&20>c%100?1:2;case"pl":return 1==c?0:c%10>=2&&4>=c%10&&(10>c%100||c%100>=20)?1:2;case"cs":case"sk":return 1==c?0:c>=2&&4>=c?1:2;case"sl":return c%100==1?1:c%100==2?2:c%100==3||c%100==4?3:0;case"mt":return 1==c?0:0==c||c%100>1&&11>c%100?1:c%100>10&&20>c%100?2:3;case"gd":return 1==c||11==c?0:2==c||12==c?1:c>2&&20>c?2:3;case"cy":return 1==c?0:2==c?1:8!=c&&11!=c?2:3;case"kw":return 1==c?0:2==c?1:3==c?2:3;case"ga":return 1==c?0:2==c?1:7>c?2:11>c?3:4;case"ar":return 0==c?0:1==c?1:2==c?2:c%100>=3&&10>=c%100?3:c%100>=11?4:5;default:return 1!=c?1:0}}}),angular.module("gettext").factory("gettextUtil",function(){function a(a,b,c){if(!a)throw new Error("You should add a "+b+" attribute whenever you add a "+c+" attribute.")}function b(a,b){return 0===a.indexOf(b)}function c(a){var b=a.charAt(0).toLowerCase();return b+a.substr(1)}var d=function(){return String.prototype.trim?function(a){return"string"==typeof a?a.trim():a}:function(a){return"string"==typeof a?a.replace(/^\s*/,"").replace(/\s*$/,""):a}}();return{trim:d,assert:a,startsWith:b,lcFirst:c}});

/*
 AngularJS v1.6.5
 (c) 2010-2017 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(s,d){'use strict';function J(d){var k=[];w(k,B).chars(d);return k.join("")}var x=d.$$minErr("$sanitize"),C,k,D,E,p,B,F,G,w;d.module("ngSanitize",[]).provider("$sanitize",function(){function g(a,e){var c={},b=a.split(","),f;for(f=0;f<b.length;f++)c[e?p(b[f]):b[f]]=!0;return c}function K(a){for(var e={},c=0,b=a.length;c<b;c++){var f=a[c];e[f.name]=f.value}return e}function H(a){return a.replace(/&/g,"&amp;").replace(L,function(a){var c=a.charCodeAt(0);a=a.charCodeAt(1);return"&#"+(1024*(c-
55296)+(a-56320)+65536)+";"}).replace(M,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function I(a){for(;a;){if(a.nodeType===s.Node.ELEMENT_NODE)for(var e=a.attributes,c=0,b=e.length;c<b;c++){var f=e[c],h=f.name.toLowerCase();if("xmlns:ns1"===h||0===h.lastIndexOf("ns1:",0))a.removeAttributeNode(f),c--,b--}(e=a.firstChild)&&I(e);a=t("nextSibling",a)}}function t(a,e){var c=e[a];if(c&&F.call(e,c))throw x("elclob",e.outerHTML||e.outerText);return c}var y=!1;this.$get=
["$$sanitizeUri",function(a){y&&k(n,z);return function(e){var c=[];G(e,w(c,function(b,c){return!/^unsafe:/.test(a(b,c))}));return c.join("")}}];this.enableSvg=function(a){return E(a)?(y=a,this):y};C=d.bind;k=d.extend;D=d.forEach;E=d.isDefined;p=d.lowercase;B=d.noop;G=function(a,e){null===a||void 0===a?a="":"string"!==typeof a&&(a=""+a);var c=u(a);if(!c)return"";var b=5;do{if(0===b)throw x("uinput");b--;a=c.innerHTML;c=u(a)}while(a!==c.innerHTML);for(b=c.firstChild;b;){switch(b.nodeType){case 1:e.start(b.nodeName.toLowerCase(),
K(b.attributes));break;case 3:e.chars(b.textContent)}var f;if(!(f=b.firstChild)&&(1===b.nodeType&&e.end(b.nodeName.toLowerCase()),f=t("nextSibling",b),!f))for(;null==f;){b=t("parentNode",b);if(b===c)break;f=t("nextSibling",b);1===b.nodeType&&e.end(b.nodeName.toLowerCase())}b=f}for(;b=c.firstChild;)c.removeChild(b)};w=function(a,e){var c=!1,b=C(a,a.push);return{start:function(a,h){a=p(a);!c&&A[a]&&(c=a);c||!0!==n[a]||(b("<"),b(a),D(h,function(c,h){var d=p(h),g="img"===a&&"src"===d||"background"===
d;!0!==v[d]||!0===m[d]&&!e(c,g)||(b(" "),b(h),b('="'),b(H(c)),b('"'))}),b(">"))},end:function(a){a=p(a);c||!0!==n[a]||!0===h[a]||(b("</"),b(a),b(">"));a==c&&(c=!1)},chars:function(a){c||b(H(a))}}};F=s.Node.prototype.contains||function(a){return!!(this.compareDocumentPosition(a)&16)};var L=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,M=/([^#-~ |!])/g,h=g("area,br,col,hr,img,wbr"),q=g("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),l=g("rp,rt"),r=k({},l,q),q=k({},q,g("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),
l=k({},l,g("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),z=g("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),A=g("script,style"),n=k({},h,q,l,r),m=g("background,cite,href,longdesc,src,xlink:href"),r=g("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),
l=g("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",
!0),v=k({},m,l,r),u=function(a,e){function c(b){b="<remove></remove>"+b;try{var c=(new a.DOMParser).parseFromString(b,"text/html").body;c.firstChild.remove();return c}catch(e){}}function b(a){d.innerHTML=a;e.documentMode&&I(d);return d}var h;if(e&&e.implementation)h=e.implementation.createHTMLDocument("inert");else throw x("noinert");var d=(h.documentElement||h.getDocumentElement()).querySelector("body");d.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>';return d.querySelector("svg")?
(d.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',d.querySelector("svg img")?c:b):function(b){b="<remove></remove>"+b;try{b=encodeURI(b)}catch(c){return}var e=new a.XMLHttpRequest;e.responseType="document";e.open("GET","data:text/html;charset=utf-8,"+b,!1);e.send(null);b=e.response.body;b.firstChild.remove();return b}}(s,s.document)}).info({angularVersion:"1.6.5"});d.module("ngSanitize").filter("linky",["$sanitize",function(g){var k=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,
p=/^mailto:/i,s=d.$$minErr("linky"),t=d.isDefined,y=d.isFunction,w=d.isObject,x=d.isString;return function(d,q,l){function r(a){a&&m.push(J(a))}function z(a,d){var c,b=A(a);m.push("<a ");for(c in b)m.push(c+'="'+b[c]+'" ');!t(q)||"target"in b||m.push('target="',q,'" ');m.push('href="',a.replace(/"/g,"&quot;"),'">');r(d);m.push("</a>")}if(null==d||""===d)return d;if(!x(d))throw s("notstring",d);for(var A=y(l)?l:w(l)?function(){return l}:function(){return{}},n=d,m=[],v,u;d=n.match(k);)v=d[0],d[2]||
d[4]||(v=(d[3]?"http://":"mailto:")+v),u=d.index,r(n.substr(0,u)),z(v,d[0].replace(p,"")),n=n.substring(u+d[0].length);r(n);return g(m.join(""))}}])})(window,window.angular);
//# sourceMappingURL=angular-sanitize.min.js.map

/*
 AngularJS v1.6.5
 (c) 2010-2017 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(x,p){'use strict';function s(f,k){var e=!1,a=!1;this.ngClickOverrideEnabled=function(b){return p.isDefined(b)?(b&&!a&&(a=!0,t.$$moduleName="ngTouch",k.directive("ngClick",t),f.decorator("ngClickDirective",["$delegate",function(a){if(e)a.shift();else for(var b=a.length-1;0<=b;){if("ngTouch"===a[b].$$moduleName){a.splice(b,1);break}b--}return a}])),e=b,this):e};this.$get=function(){return{ngClickOverrideEnabled:function(){return e}}}}function v(f,k,e){n.directive(f,["$parse","$swipe",function(a,
b){return function(l,u,g){function h(c){if(!d)return!1;var a=Math.abs(c.y-d.y);c=(c.x-d.x)*k;return r&&75>a&&0<c&&30<c&&.3>a/c}var m=a(g[f]),d,r,c=["touch"];p.isDefined(g.ngSwipeDisableMouse)||c.push("mouse");b.bind(u,{start:function(c,a){d=c;r=!0},cancel:function(c){r=!1},end:function(c,d){h(c)&&l.$apply(function(){u.triggerHandler(e);m(l,{$event:d})})}},c)}}])}var n=p.module("ngTouch",[]);n.info({angularVersion:"1.6.5"});n.provider("$touch",s);s.$inject=["$provide","$compileProvider"];n.factory("$swipe",
[function(){function f(a){a=a.originalEvent||a;var b=a.touches&&a.touches.length?a.touches:[a];a=a.changedTouches&&a.changedTouches[0]||b[0];return{x:a.clientX,y:a.clientY}}function k(a,b){var l=[];p.forEach(a,function(a){(a=e[a][b])&&l.push(a)});return l.join(" ")}var e={mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},touch:{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup",cancel:"pointercancel"}};return{bind:function(a,
b,l){var e,g,h,m,d=!1;l=l||["mouse","touch","pointer"];a.on(k(l,"start"),function(c){h=f(c);d=!0;g=e=0;m=h;b.start&&b.start(h,c)});var r=k(l,"cancel");if(r)a.on(r,function(c){d=!1;b.cancel&&b.cancel(c)});a.on(k(l,"move"),function(c){if(d&&h){var a=f(c);e+=Math.abs(a.x-m.x);g+=Math.abs(a.y-m.y);m=a;10>e&&10>g||(g>e?(d=!1,b.cancel&&b.cancel(c)):(c.preventDefault(),b.move&&b.move(a,c)))}});a.on(k(l,"end"),function(c){d&&(d=!1,b.end&&b.end(f(c),c))})}}}]);var t=["$parse","$timeout","$rootElement",function(f,
k,e){function a(a,d,b){for(var c=0;c<a.length;c+=2){var g=a[c+1],e=b;if(25>Math.abs(a[c]-d)&&25>Math.abs(g-e))return a.splice(c,c+2),!0}return!1}function b(b){if(!(2500<Date.now()-u)){var d=b.touches&&b.touches.length?b.touches:[b],e=d[0].clientX,d=d[0].clientY;if(!(1>e&&1>d||h&&h[0]===e&&h[1]===d)){h&&(h=null);var c=b.target;"label"===p.lowercase(c.nodeName||c[0]&&c[0].nodeName)&&(h=[e,d]);a(g,e,d)||(b.stopPropagation(),b.preventDefault(),b.target&&b.target.blur&&b.target.blur())}}}function l(a){a=
a.touches&&a.touches.length?a.touches:[a];var b=a[0].clientX,e=a[0].clientY;g.push(b,e);k(function(){for(var a=0;a<g.length;a+=2)if(g[a]===b&&g[a+1]===e){g.splice(a,a+2);break}},2500,!1)}var u,g,h;return function(h,d,k){var c=f(k.ngClick),n=!1,q,s,t,v;d.on("touchstart",function(a){n=!0;q=a.target?a.target:a.srcElement;3===q.nodeType&&(q=q.parentNode);d.addClass("ng-click-active");s=Date.now();a=a.originalEvent||a;a=(a.touches&&a.touches.length?a.touches:[a])[0];t=a.clientX;v=a.clientY});d.on("touchcancel",
function(a){n=!1;d.removeClass("ng-click-active")});d.on("touchend",function(c){var h=Date.now()-s,f=c.originalEvent||c,m=(f.changedTouches&&f.changedTouches.length?f.changedTouches:f.touches&&f.touches.length?f.touches:[f])[0],f=m.clientX,m=m.clientY,w=Math.sqrt(Math.pow(f-t,2)+Math.pow(m-v,2));n&&750>h&&12>w&&(g||(e[0].addEventListener("click",b,!0),e[0].addEventListener("touchstart",l,!0),g=[]),u=Date.now(),a(g,f,m),q&&q.blur(),p.isDefined(k.disabled)&&!1!==k.disabled||d.triggerHandler("click",
[c]));n=!1;d.removeClass("ng-click-active")});d.onclick=function(a){};d.on("click",function(a,b){h.$apply(function(){c(h,{$event:b||a})})});d.on("mousedown",function(a){d.addClass("ng-click-active")});d.on("mousemove mouseup",function(a){d.removeClass("ng-click-active")})}}];v("ngSwipeLeft",-1,"swipeleft");v("ngSwipeRight",1,"swiperight")})(window,window.angular);
//# sourceMappingURL=angular-touch.min.js.map

/**
 * Angular Dynamic Locale - 0.1.32
 * https://github.com/lgalfaso/angular-dynamic-locale
 * License: MIT
 */

!function(a,b){"function"==typeof define&&define.amd?define([],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){"use strict";return angular.module("tmh.dynamicLocale",[]).config(["$provide",function(a){function b(a){return a.$stateful=!0,a}a.decorator("dateFilter",["$delegate",b]),a.decorator("numberFilter",["$delegate",b]),a.decorator("currencyFilter",["$delegate",b])}]).constant("tmhDynamicLocale.STORAGE_KEY","tmhDynamicLocale.locale").provider("tmhDynamicLocale",["tmhDynamicLocale.STORAGE_KEY",function(a){function b(a,b,c,d){var f=document.createElement("script"),g=e?e:document.getElementsByTagName("body")[0],h=!1;f.type="text/javascript",f.readyState?f.onreadystatechange=function(){("complete"===f.readyState||"loaded"===f.readyState)&&(f.onreadystatechange=null,d(function(){h||(h=!0,g.removeChild(f),b())},30,!1))}:(f.onload=function(){h||(h=!0,g.removeChild(f),b())},f.onerror=function(){h||(h=!0,g.removeChild(f),c())}),f.src=a,f.async=!0,g.appendChild(f)}function c(a,c,d,e,h,i,l){function m(a,b){g===d&&(angular.forEach(a,function(c,d){b[d]?angular.isArray(b[d])&&(a[d].length=b[d].length):delete a[d]}),angular.forEach(b,function(c,d){angular.isArray(b[d])||angular.isObject(b[d])?(a[d]||(a[d]=angular.isArray(b[d])?[]:{}),m(a[d],b[d])):a[d]=b[d]}))}if(k[d])return g=d,k[d];var n,o=h.defer();return d===g?o.resolve(c):(n=i.get(d))?(g=d,e.$evalAsync(function(){m(c,n),f.put(j,d),e.$broadcast("$localeChangeSuccess",d,c),o.resolve(c)})):(g=d,k[d]=o.promise,b(a,function(){var a=angular.injector(["ngLocale"]),b=a.get("$locale");m(c,b),i.put(d,b),delete k[d],e.$applyAsync(function(){f.put(j,d),e.$broadcast("$localeChangeSuccess",d,c),o.resolve(c)})},function(){delete k[d],e.$applyAsync(function(){g===d&&(g=c.id),e.$broadcast("$localeChangeError",d),o.reject(d)})},l)),o.promise}var d,e,f,g,h="angular/i18n/angular-locale_{{locale}}.js",i="tmhDynamicLocaleStorageCache",j=a,k={},l={};this.localeLocationPattern=function(a){return a?(h=a,this):h},this.appendScriptTo=function(a){e=a},this.useStorage=function(a){i=a},this.useCookieStorage=function(){this.useStorage("$cookieStore")},this.defaultLocale=function(a){d=a},this.storageKey=function(a){return a?(j=a,this):j},this.addLocalePatternValue=function(a,b){l[a]=b},this.$get=["$rootScope","$injector","$interpolate","$locale","$q","tmhDynamicLocaleCache","$timeout",function(a,b,e,k,m,n,o){function p(b){var d={locale:b,angularVersion:angular.version.full};return c(q(angular.extend({},l,d)),k,b,a,m,n,o)}var q=e(h);return f=b.get(i),a.$evalAsync(function(){var a;(a=f.get(j)||d)&&p(a)}),{set:p,get:function(){return g}}}]}]).provider("tmhDynamicLocaleCache",function(){this.$get=["$cacheFactory",function(a){return a("tmh.dynamicLocales")}]}).provider("tmhDynamicLocaleStorageCache",function(){this.$get=["$cacheFactory",function(a){return a("tmh.dynamicLocales.store")}]}).run(["tmhDynamicLocale",angular.noop]),"tmh.dynamicLocale"});
//# sourceMappingURL=tmhDynamicLocale.min.js.map

(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("jquery"), require("angular"), require("jquery-ui/datepicker"));
	else if(typeof define === 'function' && define.amd)
		define(["jquery", "angular", "jquery-ui/datepicker"], factory);
	else if(typeof exports === 'object')
		exports["angularUiDate"] = factory(require("jquery"), require("angular"), require("jquery-ui/datepicker"));
	else
		root["angularUiDate"] = factory(root["jQuery"], root["angular"], root["jquery-ui/datepicker"]);
})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__) {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "assets";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _jquery = __webpack_require__(1);

	var _jquery2 = _interopRequireDefault(_jquery);

	var _angular = __webpack_require__(2);

	var _angular2 = _interopRequireDefault(_angular);

	var _datepicker = __webpack_require__(3);

	var _datepicker2 = _interopRequireDefault(_datepicker);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	// sets up jQuery with the datepicker plugin

	exports.default = _angular2.default.module('ui.date', []).constant('uiDateConfig', {}).constant('uiDateFormatConfig', '').factory('uiDateConverter', ['uiDateFormatConfig', function (uiDateFormatConfig) {
	  return {
	    stringToDate: stringToDate,
	    dateToString: dateToString
	  };

	  function dateToString(uiDateFormat, value) {
	    var dateFormat = uiDateFormat || uiDateFormatConfig;
	    if (value) {
	      if (dateFormat) {
	        try {
	          return _jquery2.default.datepicker.formatDate(dateFormat, value);
	        } catch (formatException) {
	          return undefined;
	        }
	      }

	      if (value.toISOString) {
	        return value.toISOString();
	      }
	    }
	    return null;
	  }

	  function stringToDate(dateFormat, valueToParse) {
	    dateFormat = dateFormat || uiDateFormatConfig;

	    if (_angular2.default.isDate(valueToParse) && !isNaN(valueToParse)) {
	      return valueToParse;
	    }

	    if (_angular2.default.isString(valueToParse)) {
	      if (dateFormat) {
	        return _jquery2.default.datepicker.parseDate(dateFormat, valueToParse);
	      }

	      var isoDate = new Date(valueToParse);
	      return isNaN(isoDate.getTime()) ? null : isoDate;
	    }

	    if (_angular2.default.isNumber(valueToParse)) {
	      // presumably timestamp to date object
	      return new Date(valueToParse);
	    }

	    return null;
	  }
	}]).directive('uiDate', ['uiDateConfig', 'uiDateConverter', function uiDateDirective(uiDateConfig, uiDateConverter) {

	  return {
	    require: '?ngModel',
	    link: function link(scope, element, attrs, controller) {

	      var $element = (0, _jquery2.default)(element);

	      var getOptions = function getOptions() {
	        return _angular2.default.extend({}, uiDateConfig, scope.$eval(attrs.uiDate));
	      };
	      var initDateWidget = function initDateWidget() {
	        var showing = false;
	        var opts = getOptions();

	        function setVal(forcedUpdate) {
	          var keys = ['Hours', 'Minutes', 'Seconds', 'Milliseconds'];
	          var isDate = _angular2.default.isDate(controller.$modelValue);
	          var preserve = {};

	          if (!forcedUpdate && isDate && controller.$modelValue.toDateString() === $element.datepicker('getDate').toDateString()) {
	            return;
	          }

	          if (isDate) {
	            _angular2.default.forEach(keys, function (key) {
	              preserve[key] = controller.$modelValue['get' + key]();
	            });
	          }

	          var newViewValue = $element.datepicker('getDate');

	          if (isDate) {
	            _angular2.default.forEach(keys, function (key) {
	              newViewValue['set' + key](preserve[key]);
	            });
	          }

	          controller.$setViewValue(newViewValue);
	        }

	        // If we have a controller (i.e. ngModelController) then wire it up
	        if (controller) {
	          // Set the view value in a $apply block when users selects
	          // (calling directive user's function too if provided)
	          var _onSelect = opts.onSelect || _angular2.default.noop;
	          opts.onSelect = function (value, picker) {
	            scope.$apply(function () {
	              showing = true;
	              setVal();
	              $element.blur();
	              _onSelect(value, picker, $element);
	            });
	          };

	          var _beforeShow = opts.beforeShow || _angular2.default.noop;
	          opts.beforeShow = function (input, picker) {
	            showing = true;
	            _beforeShow(input, picker, $element);
	          };

	          var _onClose = opts.onClose || _angular2.default.noop;
	          opts.onClose = function (value, picker) {
	            showing = false;
	            _onClose(value, picker, $element);
	          };

	          element.on('focus', function (focusEvent) {
	            if (attrs.readonly) {
	              focusEvent.stopImmediatePropagation();
	            }
	          });

	          $element.off('blur.datepicker').on('blur.datepicker', function () {
	            if (!showing) {
	              scope.$apply(function () {
	                $element.datepicker('setDate', $element.datepicker('getDate'));
	                setVal();
	              });
	            }
	          });

	          controller.$validators.uiDateValidator = function uiDateValidator(modelValue, viewValue) {
	            return viewValue === null || viewValue === '' || _angular2.default.isDate(uiDateConverter.stringToDate(attrs.uiDateFormat, viewValue));
	          };

	          controller.$parsers.push(function uiDateParser(valueToParse) {
	            return uiDateConverter.stringToDate(attrs.uiDateFormat, valueToParse);
	          });

	          // Update the date picker when the model changes
	          controller.$render = function () {
	            // Force a render to override whatever is in the input text box
	            if (_angular2.default.isDate(controller.$modelValue) === false && _angular2.default.isString(controller.$modelValue)) {
	              controller.$modelValue = uiDateConverter.stringToDate(attrs.uiDateFormat, controller.$modelValue);
	            }
	            $element.datepicker('setDate', controller.$modelValue);
	          };
	        }
	        // Check if the $element already has a datepicker.
	        //

	        if ($element.data('datepicker')) {
	          // Updates the datepicker options
	          $element.datepicker('option', opts);
	          $element.datepicker('refresh');
	        } else {
	          // Creates the new datepicker widget
	          $element.datepicker(opts);

	          // Cleanup on destroy, prevent memory leaking
	          $element.on('$destroy', function () {
	            $element.datepicker('hide');
	            $element.datepicker('destroy');
	          });
	        }

	        if (controller) {
	          controller.$render();
	          // Update the model with the value from the datepicker after parsed
	          setVal(true);
	        }
	      };

	      // Watch for changes to the directives options
	      scope.$watch(getOptions, initDateWidget, true);
	    }
	  };
	}]).directive('uiDateFormat', ['uiDateConverter', function (uiDateConverter) {
	  return {
	    require: 'ngModel',
	    link: function link(scope, element, attrs, modelCtrl) {
	      var dateFormat = attrs.uiDateFormat;

	      // Use the datepicker with the attribute value as the dateFormat string to convert to and from a string
	      modelCtrl.$formatters.unshift(function (value) {
	        return uiDateConverter.stringToDate(dateFormat, value);
	      });

	      modelCtrl.$parsers.push(function (value) {
	        return uiDateConverter.dateToString(dateFormat, value);
	      });
	    }
	  };
	}]);

/***/ },
/* 1 */
/***/ function(module, exports) {

	module.exports = __WEBPACK_EXTERNAL_MODULE_1__;

/***/ },
/* 2 */
/***/ function(module, exports) {

	module.exports = __WEBPACK_EXTERNAL_MODULE_2__;

/***/ },
/* 3 */
/***/ function(module, exports) {

	module.exports = __WEBPACK_EXTERNAL_MODULE_3__;

/***/ }
/******/ ])
});
;
//# sourceMappingURL=date.js.map

/*
 jQuery UI Slider plugin wrapper
*/
angular.module('ui.slider', []).value('uiSliderConfig',{}).directive('uiSlider', ['uiSliderConfig', '$timeout', function(uiSliderConfig, $timeout) {
    uiSliderConfig = uiSliderConfig || {};
    return {
        require: 'ngModel',
        compile: function() {
            var preLink = function (scope, elm, attrs, ngModel) {

                function parseNumber(n, decimals) {
                    return (decimals) ? parseFloat(n) : parseInt(n, 10);
                }

                var directiveOptions = angular.copy(scope.$eval(attrs.uiSlider));
                var options = angular.extend(directiveOptions || {}, uiSliderConfig);
                // Object holding range values
                var prevRangeValues = {
                    min: null,
                    max: null
                };

                // convenience properties
                var properties = ['min', 'max', 'step', 'lowerBound', 'upperBound'];
                var useDecimals = (!angular.isUndefined(attrs.useDecimals)) ? true : false;
                var updateOn = (angular.isDefined(options['updateOn'])) ? options['updateOn'] : 'slide'

                var init = function() {
                    // When ngModel is assigned an array of values then range is expected to be true.
                    // Warn user and change range to true else an error occurs when trying to drag handle
                    if (angular.isArray(ngModel.$viewValue) && options.range !== true) {
                        console.warn('Change your range option of ui-slider. When assigning ngModel an array of values then the range option should be set to true.');
                        options.range = true;
                    }

                    // Ensure the convenience properties are passed as options if they're defined
                    // This avoids init ordering issues where the slider's initial state (eg handle
                    // position) is calculated using widget defaults
                    // Note the properties take precedence over any duplicates in options
                    angular.forEach(properties, function(property) {
                        if (angular.isDefined(attrs[property])) {
                            options[property] = parseNumber(attrs[property], useDecimals);
                        }
                    });

                    elm.slider(options);
                    init = angular.noop;
                };

                // Find out if decimals are to be used for slider
                angular.forEach(properties, function(property) {
                    // support {{}} and watch for updates
                    attrs.$observe(property, function(newVal) {
                        if (!!newVal) {
                            init();
                            options[property] = parseNumber(newVal, useDecimals);
                            elm.slider('option', property, parseNumber(newVal, useDecimals));
                            ngModel.$render();
                        }
                    });
                });
                attrs.$observe('disabled', function(newVal) {
                    init();
                    elm.slider('option', 'disabled', !!newVal);
                });

                // Watch ui-slider (byVal) for changes and update
                scope.$watch(attrs.uiSlider, function(newVal) {
                    init();
                    if(newVal !== undefined) {
                      elm.slider('option', newVal);
                    }
                }, true);

                // Late-bind to prevent compiler clobbering
                $timeout(init, 0, true);

                // Update model value from slider
                elm.bind(updateOn, function(event, ui) {
                    var valuesChanged;

                    if (ui.values) {
                        var boundedValues = ui.values.slice();

                        if (options.lowerBound && boundedValues[0] < options.lowerBound) {
                            boundedValues[0] = Math.max(boundedValues[0], options.lowerBound);
                        }
                        if (options.upperBound && boundedValues[1] > options.upperBound) {
                            boundedValues[1] = Math.min(boundedValues[1], options.upperBound);
                        }

                        if (boundedValues[0] !== ui.values[0] || boundedValues[1] !== ui.values[1]) {
                            valuesChanged = true;
                            ui.values = boundedValues;
                        }
                    } else {
                        var boundedValue = ui.value;

                        if (options.lowerBound && boundedValue < options.lowerBound) {
                            boundedValue = Math.max(boundedValue, options.lowerBound);
                        }
                        if (options.upperBound && boundedValue > options.upperBound) {
                            boundedValue = Math.min(boundedValue, options.upperBound);
                        }

                        if (boundedValue !== ui.value) {
                            valuesChanged = true;
                            ui.value = boundedValue;
                        }
                    }


                    ngModel.$setViewValue(ui.values || ui.value);
                    $(ui.handle).find('.ui-slider-tip').text(ui.value);
                    scope.$apply();

                    if (valuesChanged) {
                        setTimeout(function() {
                            elm.slider('value', ui.values || ui.value);
                        }, 0);

                        return false;
                    }
                });

                // Update slider from model value
                ngModel.$render = function() {
                    init();
                    var method = options.range === true ? 'values' : 'value';

                    if (options.range !== true && isNaN(ngModel.$viewValue) && !(ngModel.$viewValue instanceof Array)) {
                        ngModel.$viewValue = 0;
                    }
                    else if (options.range && !angular.isDefined(ngModel.$viewValue)) {
                            ngModel.$viewValue = [0,0];
                    }

                    // Do some sanity check of range values
                    if (options.range === true) {
                        // previously, the model was a string b/c it was in a text input, need to convert to a array.
                        // make sure input exists, comma exists once, and it is a string.
                        if (ngModel.$viewValue && angular.isString(ngModel.$viewValue) && (ngModel.$viewValue.match(/,/g) || []).length === 1) {
                            // transform string model into array.
                            var valueArr = ngModel.$viewValue.split(',');
                            ngModel.$viewValue = [Number(valueArr[0]), Number(valueArr[1])];
                        }
                        // Check outer bounds for min and max values
                        if (angular.isDefined(options.min) && options.min > ngModel.$viewValue[0]) {
                            ngModel.$viewValue[0] = options.min;
                        }
                        if (angular.isDefined(options.max) && options.max < ngModel.$viewValue[1]) {
                            ngModel.$viewValue[1] = options.max;
                        }

                        // Check min and max range values
                        if (ngModel.$viewValue[0] > ngModel.$viewValue[1]) {
                            // Min value should be less to equal to max value
                            if (prevRangeValues.min >= ngModel.$viewValue[1]) {
                                ngModel.$viewValue[1] = prevRangeValues.min;
                            }
                            // Max value should be less to equal to min value
                            if (prevRangeValues.max <= ngModel.$viewValue[0]) {
                                ngModel.$viewValue[0] = prevRangeValues.max;
                            }
                        }

                        // Store values for later user
                        prevRangeValues.min = ngModel.$viewValue[0];
                        prevRangeValues.max = ngModel.$viewValue[1];

                    }
                    elm.slider(method, ngModel.$viewValue);
                };

                scope.$watch(attrs.ngModel, function() {
                    if (options.range === true) {
                        ngModel.$render();

                        $(elm).find('.ui-slider-tip').each(function(i, tipElm) {
                            $(tipElm).text(ngModel.$viewValue[i]);
                        });
                    } else {
                        $(elm).find('.ui-slider-tip').text(ngModel.$viewValue);
                    }
                }, true);

                function destroy() {
                    if (elm.hasClass('ui-slider')) {
                        elm.slider('destroy');
                    }
                }

                scope.$on("$destroy", destroy);
                elm.one('$destroy', destroy);
            };

            var postLink = function (scope, element, attrs, ngModel) {
                // Add tick marks if 'tick' and 'step' attributes have been setted on element.
                // Support horizontal slider bar so far. 'tick' and 'step' attributes are required.
                var options = angular.extend({}, scope.$eval(attrs.uiSlider));
                var properties = ['min', 'max', 'step', 'tick', 'tip'];
                angular.forEach(properties, function(property) {
                    if (angular.isDefined(attrs[property])) {
                        options[property] = attrs[property];
                    }
                });
                if (angular.isDefined(options['tick']) && angular.isDefined(options['step'])) {
                    var total = parseInt( (parseInt(options['max']) - parseInt(options['min'])) /parseInt(options['step']));
                    for (var i = total; i >= 0; i--) {
                        var left = ((i / total) * 100) + '%';
                        $("<div/>").addClass("ui-slider-tick").appendTo(element).css({left: left});
                    };
                }
                if(angular.isDefined(options['tip'])) {
                    $timeout(function(){
                        var handles = element.find('.ui-slider-handle');
                        if(handles && handles.length>1 && ngModel.$viewValue && angular.isArray(ngModel.$viewValue)){
                            $(handles[0]).append('<div class="ui-slider-tip">'+ngModel.$viewValue[0]+'</div>');
                            $(handles[1]).append('<div class="ui-slider-tip">'+ngModel.$viewValue[1]+'</div>');
                        }else{
                            element.find('.ui-slider-handle').append('<div class="ui-slider-tip">'+ngModel.$viewValue+'</div>');
                        }
                    },10);
                }
            }

            return {
                pre: preLink,
                post: postLink
            };
        }
    };
}]);

/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under the MIT license
 */
if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(a){"use strict";var b=a.fn.jquery.split(" ")[0].split(".");if(b[0]<2&&b[1]<9||1==b[0]&&9==b[1]&&b[2]<1||b[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(jQuery),+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){if(a(b.target).is(this))return b.handleObj.handler.apply(this,arguments)}})})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var c=a(this),e=c.data("bs.alert");e||c.data("bs.alert",e=new d(this)),"string"==typeof b&&e[b].call(c)})}var c='[data-dismiss="alert"]',d=function(b){a(b).on("click",c,this.close)};d.VERSION="3.3.7",d.TRANSITION_DURATION=150,d.prototype.close=function(b){function c(){g.detach().trigger("closed.bs.alert").remove()}var e=a(this),f=e.attr("data-target");f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,""));var g=a("#"===f?[]:f);b&&b.preventDefault(),g.length||(g=e.closest(".alert")),g.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(g.removeClass("in"),a.support.transition&&g.hasClass("fade")?g.one("bsTransitionEnd",c).emulateTransitionEnd(d.TRANSITION_DURATION):c())};var e=a.fn.alert;a.fn.alert=b,a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on("click.bs.alert.data-api",c,d.prototype.close)}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof b&&b;e||d.data("bs.button",e=new c(this,f)),"toggle"==b?e.toggle():b&&e.setState(b)})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.isLoading=!1};c.VERSION="3.3.7",c.DEFAULTS={loadingText:"loading..."},c.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c).prop(c,!0)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c).prop(c,!1))},this),0)},c.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")?(c.prop("checked")&&(a=!1),b.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==c.prop("type")&&(c.prop("checked")!==this.$element.hasClass("active")&&(a=!1),this.$element.toggleClass("active")),c.prop("checked",this.$element.hasClass("active")),a&&c.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var d=a.fn.button;a.fn.button=b,a.fn.button.Constructor=c,a.fn.button.noConflict=function(){return a.fn.button=d,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(c){var d=a(c.target).closest(".btn");b.call(d,"toggle"),a(c.target).is('input[type="radio"], input[type="checkbox"]')||(c.preventDefault(),d.is("input,button")?d.trigger("focus"):d.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(b){a(b.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(b.type))})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},c.DEFAULTS,d.data(),"object"==typeof b&&b),g="string"==typeof b?b:f.slide;e||d.data("bs.carousel",e=new c(this,f)),"number"==typeof b?e.to(b):g?e[g]():f.interval&&e.pause().cycle()})}var c=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",a.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};c.VERSION="3.3.7",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},c.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},c.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},c.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b),d="prev"==a&&0===c||"next"==a&&c==this.$items.length-1;if(d&&!this.options.wrap)return b;var e="prev"==a?-1:1,f=(c+e)%this.$items.length;return this.$items.eq(f)},c.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(a>this.$items.length-1||a<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?"next":"prev",this.$items.eq(a))},c.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){if(!this.sliding)return this.slide("next")},c.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},c.prototype.slide=function(b,d){var e=this.$element.find(".item.active"),f=d||this.getItemForDirection(b,e),g=this.interval,h="next"==b?"left":"right",i=this;if(f.hasClass("active"))return this.sliding=!1;var j=f[0],k=a.Event("slide.bs.carousel",{relatedTarget:j,direction:h});if(this.$element.trigger(k),!k.isDefaultPrevented()){if(this.sliding=!0,g&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var l=a(this.$indicators.children()[this.getItemIndex(f)]);l&&l.addClass("active")}var m=a.Event("slid.bs.carousel",{relatedTarget:j,direction:h});return a.support.transition&&this.$element.hasClass("slide")?(f.addClass(b),f[0].offsetWidth,e.addClass(h),f.addClass(h),e.one("bsTransitionEnd",function(){f.removeClass([b,h].join(" ")).addClass("active"),e.removeClass(["active",h].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger(m)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(e.removeClass("active"),f.addClass("active"),this.sliding=!1,this.$element.trigger(m)),g&&this.cycle(),this}};var d=a.fn.carousel;a.fn.carousel=b,a.fn.carousel.Constructor=c,a.fn.carousel.noConflict=function(){return a.fn.carousel=d,this};var e=function(c){var d,e=a(this),f=a(e.attr("data-target")||(d=e.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""));if(f.hasClass("carousel")){var g=a.extend({},f.data(),e.data()),h=e.attr("data-slide-to");h&&(g.interval=!1),b.call(f,g),h&&f.data("bs.carousel").to(h),c.preventDefault()}};a(document).on("click.bs.carousel.data-api","[data-slide]",e).on("click.bs.carousel.data-api","[data-slide-to]",e),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var c=a(this);b.call(c,c.data())})})}(jQuery),+function(a){"use strict";function b(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(d)}function c(b){return this.each(function(){var c=a(this),e=c.data("bs.collapse"),f=a.extend({},d.DEFAULTS,c.data(),"object"==typeof b&&b);!e&&f.toggle&&/show|hide/.test(b)&&(f.toggle=!1),e||c.data("bs.collapse",e=new d(this,f)),"string"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.$trigger=a('[data-toggle="collapse"][href="#'+b.id+'"],[data-toggle="collapse"][data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};d.VERSION="3.3.7",d.TRANSITION_DURATION=350,d.DEFAULTS={toggle:!0},d.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&(b=e.data("bs.collapse"),b&&b.transitioning))){var f=a.Event("show.bs.collapse");if(this.$element.trigger(f),!f.isDefaultPrevented()){e&&e.length&&(c.call(e,"hide"),b||e.data("bs.collapse",null));var g=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[g](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var h=function(){this.$element.removeClass("collapsing").addClass("collapse in")[g](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return h.call(this);var i=a.camelCase(["scroll",g].join("-"));this.$element.one("bsTransitionEnd",a.proxy(h,this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])}}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var e=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?void this.$element[c](0).one("bsTransitionEnd",a.proxy(e,this)).emulateTransitionEnd(d.TRANSITION_DURATION):e.call(this)}}},d.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},d.prototype.getParent=function(){return a(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(c,d){var e=a(d);this.addAriaAndCollapsedClass(b(e),e)},this)).end()},d.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var e=a.fn.collapse;a.fn.collapse=c,a.fn.collapse.Constructor=d,a.fn.collapse.noConflict=function(){return a.fn.collapse=e,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(d){var e=a(this);e.attr("data-target")||d.preventDefault();var f=b(e),g=f.data("bs.collapse"),h=g?"toggle":e.data();c.call(f,h)})}(jQuery),+function(a){"use strict";function b(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}function c(c){c&&3===c.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=b(d),f={relatedTarget:this};e.hasClass("open")&&(c&&"click"==c.type&&/input|textarea/i.test(c.target.tagName)&&a.contains(e[0],c.target)||(e.trigger(c=a.Event("hide.bs.dropdown",f)),c.isDefaultPrevented()||(d.attr("aria-expanded","false"),e.removeClass("open").trigger(a.Event("hidden.bs.dropdown",f)))))}))}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})}var e=".dropdown-backdrop",f='[data-toggle="dropdown"]',g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.3.7",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=b(e),g=f.hasClass("open");if(c(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",c);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),f.toggleClass("open").trigger(a.Event("shown.bs.dropdown",h))}return!1}},g.prototype.keydown=function(c){if(/(38|40|27|32)/.test(c.which)&&!/input|textarea/i.test(c.target.tagName)){var d=a(this);if(c.preventDefault(),c.stopPropagation(),!d.is(".disabled, :disabled")){var e=b(d),g=e.hasClass("open");if(!g&&27!=c.which||g&&27==c.which)return 27==c.which&&e.find(f).trigger("focus"),d.trigger("click");var h=" li:not(.disabled):visible a",i=e.find(".dropdown-menu"+h);if(i.length){var j=i.index(c.target);38==c.which&&j>0&&j--,40==c.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",c).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f,g.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",g.prototype.keydown)}(jQuery),+function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.3.7",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){d.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass("in"),d.enforceFocus();var f=a.Event("shown.bs.modal",{relatedTarget:b});e?d.$dialog.one("bsTransitionEnd",function(){d.$element.trigger("focus").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger("focus").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){document===a.target||this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},c.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a(document.createElement("div")).addClass("modal-backdrop "+e).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;f?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof b&&b;!e&&/destroy|hide/.test(b)||(e||d.data("bs.tooltip",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",a,b)};c.VERSION="3.3.7",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},c.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusin"==b.type?"focus":"hover"]=!0),c.tip().hasClass("in")||"in"==c.hoverState?void(c.hoverState="in"):(clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);if(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusout"==b.type?"focus":"hover"]=!1),!c.isInStateTrue())return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},c.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr("id",g),this.$element.attr("aria-describedby",g),this.options.animation&&f.addClass("fade");var h="function"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,j=i.test(h);j&&(h=h.replace(i,"")||"top"),f.detach().css({top:0,left:0,display:"block"}).addClass(h).data("bs."+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.getPosition(this.$viewport);h="bottom"==h&&k.bottom+m>o.bottom?"top":"top"==h&&k.top-m<o.top?"bottom":"right"==h&&k.right+l>o.width?"left":"left"==h&&k.left-l<o.left?"right":h,f.removeClass(n).addClass(h)}var p=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(p,h);var q=function(){var a=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",q).emulateTransitionEnd(c.TRANSITION_DURATION):q()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},c.prototype.hide=function(b){function d(){"in"!=e.hoverState&&f.detach(),e.$element&&e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),b&&b()}var e=this,f=a(this.$tip),g=a.Event("hide.bs."+this.type);if(this.$element.trigger(g),!g.isDefaultPrevented())return f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this},c.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=window.SVGElement&&c instanceof window.SVGElement,g=d?{top:0,left:0}:f?null:b.offset(),h={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},i=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,h,i,g)},c.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.right&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},c.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass("in")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null,a.$element=null})};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b;!e&&/destroy|hide/.test(b)||(e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");c.VERSION="3.3.7",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery),+function(a){"use strict";function b(c,d){this.$body=a(document.body),this.$scrollElement=a(a(c).is(document.body)?window:c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",a.proxy(this.process,this)),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})}b.VERSION="3.3.7",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b=this,c="offset",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c="position",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data("target")||b.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){
this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")},b.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new c(this)),"string"==typeof b&&e[b]()})}var c=function(b){this.element=a(b)};c.VERSION="3.3.7",c.TRANSITION_DURATION=150,c.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a"),f=a.Event("hide.bs.tab",{relatedTarget:b[0]}),g=a.Event("show.bs.tab",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(d);this.activate(b.closest("li"),c),this.activate(h,h.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:b[0]}),b.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})}}},c.prototype.activate=function(b,d,e){function f(){g.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),h?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu").length&&b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),e&&e()}var g=d.find("> .active"),h=e&&a.support.transition&&(g.length&&g.hasClass("fade")||!!d.find("> .fade").length);g.length&&h?g.one("bsTransitionEnd",f).emulateTransitionEnd(c.TRANSITION_DURATION):f(),g.removeClass("in")};var d=a.fn.tab;a.fn.tab=b,a.fn.tab.Constructor=c,a.fn.tab.noConflict=function(){return a.fn.tab=d,this};var e=function(c){c.preventDefault(),b.call(a(this),"show")};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',e).on("click.bs.tab.data-api",'[data-toggle="pill"]',e)}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof b&&b;e||d.data("bs.affix",e=new c(this,f)),"string"==typeof b&&e[b]()})}var c=function(b,d){this.options=a.extend({},c.DEFAULTS,d),this.$target=a(this.options.target).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};c.VERSION="3.3.7",c.RESET="affix affix-top affix-bottom",c.DEFAULTS={offset:0,target:window},c.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&"top"==this.affixed)return e<c&&"top";if("bottom"==this.affixed)return null!=c?!(e+this.unpin<=f.top)&&"bottom":!(e+g<=a-d)&&"bottom";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&e<=c?"top":null!=d&&i+j>=a-d&&"bottom"},c.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(c.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},c.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},c.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=this.$element.height(),d=this.options.offset,e=d.top,f=d.bottom,g=Math.max(a(document).height(),a(document.body).height());"object"!=typeof d&&(f=e=d),"function"==typeof e&&(e=d.top(this.$element)),"function"==typeof f&&(f=d.bottom(this.$element));var h=this.getState(g,b,e,f);if(this.affixed!=h){null!=this.unpin&&this.$element.css("top","");var i="affix"+(h?"-"+h:""),j=a.Event(i+".bs.affix");if(this.$element.trigger(j),j.isDefaultPrevented())return;this.affixed=h,this.unpin="bottom"==h?this.getPinnedOffset():null,this.$element.removeClass(c.RESET).addClass(i).trigger(i.replace("affix","affixed")+".bs.affix")}"bottom"==h&&this.$element.offset({top:g-b-f})}};var d=a.fn.affix;a.fn.affix=b,a.fn.affix.Constructor=c,a.fn.affix.noConflict=function(){return a.fn.affix=d,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var c=a(this),d=c.data();d.offset=d.offset||{},null!=d.offsetBottom&&(d.offset.bottom=d.offsetBottom),null!=d.offsetTop&&(d.offset.top=d.offsetTop),b.call(c,d)})})}(jQuery);

/** @preserve jQuery.floatThead 2.0.3 - http://mkoryak.github.io/floatThead/ - Copyright (c) 2012 - 2017 Misha Koryak **/
!function(t){function e(t,e){if(8==f){var o=v.width(),n=s.debounce(function(){var t=v.width();o!=t&&(o=t,e())},1);v.on(t,n)}else v.on(t,s.debounce(e,1))}function o(e){var o=e[0],n=o.parentElement;do{var r=window.getComputedStyle(n).getPropertyValue("overflow");if("visible"!=r)break}while(n=n.parentElement);return t(n==document.body?[]:n)}function n(t){window&&window.console&&window.console.error&&window.console.error("jQuery.floatThead: "+t)}function r(t){var e=t.getBoundingClientRect();return e.width||e.right-e.left}function a(){var t=document.createElement("scrolltester");t.style.cssText="width:100px;height:100px;overflow:scroll!important;position:absolute;top:-9999px;display:block",document.body.appendChild(t);var e=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),e}function i(t){if(t.dataTableSettings)for(var e=0;e<t.dataTableSettings.length;e++){var o=t.dataTableSettings[e].nTable;if(t[0]==o)return!0}return!1}function l(t,e,o){var n=o?"outerWidth":"width";if(p&&t.css("max-width")){var r=0;o&&(r+=parseInt(t.css("borderLeft"),10),r+=parseInt(t.css("borderRight"),10));for(var a=0;a<e.length;a++)r+=e.get(a).offsetWidth;return r}return t[n]()}t.floatThead=t.floatThead||{},t.floatThead.defaults={headerCellSelector:"tr:visible:first>*:visible",zIndex:1001,position:"auto",top:0,bottom:0,scrollContainer:function(){return t([])},responsiveContainer:function(){return t([])},getSizingRow:function(t){return t.find("tbody tr:visible:first>*:visible")},floatTableClass:"floatThead-table",floatWrapperClass:"floatThead-wrapper",floatContainerClass:"floatThead-container",copyTableClass:!0,autoReflow:!1,debug:!1,support:{bootstrap:!0,datatables:!0,jqueryUI:!0,perfectScrollbar:!0}};var s=window._||function(){var e={},o=Object.prototype.hasOwnProperty,n=["Arguments","Function","String","Number","Date","RegExp"];e.has=function(t,e){return o.call(t,e)},e.keys=Object.keys||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var o=[];for(var n in t)e.has(t,n)&&o.push(n);return o};var r=0;return e.uniqueId=function(t){var e=++r+"";return t?t+e:e},t.each(n,function(){var t=this;e["is"+t]=function(e){return Object.prototype.toString.call(e)=="[object "+t+"]"}}),e.debounce=function(t,e,o){var n,r,a,i,l;return function(){a=this,r=arguments,i=new Date;var s=function(){var d=new Date-i;e>d?n=setTimeout(s,e-d):(n=null,o||(l=t.apply(a,r)))},d=o&&!n;return n||(n=setTimeout(s,e)),d&&(l=t.apply(a,r)),l}},e}(),d="undefined"!=typeof MutationObserver,f=function(){for(var t=3,e=document.createElement("b"),o=e.all||[];t=1+t,e.innerHTML="<!--[if gt IE "+t+"]><i><![endif]-->",o[0];);return t>4?t:document.documentMode}(),c=/Gecko\//.test(navigator.userAgent),u=/WebKit\//.test(navigator.userAgent);f||c||u||(f=11);var p=function(){if(u){var e=t("<div>").css("width",0).append(t("<table>").css("max-width","100%").append(t("<tr>").append(t("<th>").append(t("<div>").css("min-width",100).text("X")))));t("body").append(e);var o=0==e.find("table").width();return e.remove(),o}return!1},h=!c&&!f,v=t(window);if(!window.matchMedia){var b=window.onbeforeprint,w=window.onafterprint;window.onbeforeprint=function(){b&&b(),v.triggerHandler("beforeprint")},window.onafterprint=function(){w&&w(),v.triggerHandler("afterprint")}}t.fn.floatThead=function(c){if(c=c||{},8>f)return this;var b=null;if(s.isFunction(p)&&(p=p()),s.isString(c)){var w=c,g=Array.prototype.slice.call(arguments,1),m=this;return this.filter("table").each(function(){var e=t(this),o=e.data("floatThead-lazy");o&&e.floatThead(o);var n=e.data("floatThead-attached");if(n&&s.isFunction(n[w])){var r=n[w].apply(this,g);void 0!==r&&(m=r)}}),m}var y=t.extend({},t.floatThead.defaults||{},c);if(t.each(c,function(e){e in t.floatThead.defaults||!y.debug||n("Used ["+e+"] key to init plugin, but that param is not an option for the plugin. Valid options are: "+s.keys(t.floatThead.defaults).join(", "))}),y.debug){var T=t.fn.jquery.split(".");1==parseInt(T[0],10)&&parseInt(T[1],10)<=7&&n("jQuery version "+t.fn.jquery+" detected! This plugin supports 1.8 or better, or 1.7.x with jQuery UI 1.8.24 -> http://jqueryui.com/resources/download/jquery-ui-1.8.24.zip")}return this.filter(":not(."+y.floatTableClass+")").each(function(){function c(t){return t+".fth-"+R+".floatTHead"}function p(){var e=0;if(k.children("tr:visible").each(function(){e+=t(this).outerHeight(!0)}),"collapse"==M.css("border-collapse")){var o=parseInt(M.css("border-top-width"),10),n=parseInt(M.find("thead tr:first").find(">*:first").css("border-top-width"),10);o>n&&(e-=o/2)}st.outerHeight(e),dt.outerHeight(e)}function w(){var t=l(M,ut,!0),e=V?P:U,o=e.width()||t,n="hidden"!=e.css("overflow-y")?o-N.vertical:o;if(at.width(n),G){var r=100*t/n;tt.css("width",r+"%")}else tt.outerWidth(t)}function g(){D=(s.isFunction(y.top)?y.top(M):y.top)||0,O=(s.isFunction(y.bottom)?y.bottom(M):y.bottom)||0}function m(){var e,o=k.find(y.headerCellSelector);if(nt?e=ot.find("col").length:(e=0,o.each(function(){e+=parseInt(t(this).attr("colspan")||1,10)})),e!=Q){Q=e;for(var n,r=[],a=[],i=[],l=0;e>l;l++)n=o.eq(l).text(),r.push('<th class="floatThead-col" aria-label="'+n+'"/>'),a.push("<col/>"),i.push(t("<fthtd>").css({display:"table-cell",height:0,width:"auto"}));a=a.join(""),r=r.join(""),h&&(rt.empty(),rt.append(i),ut=rt.find("fthtd")),st.html(r),dt=st.find("th"),nt||ot.html(a),ft=ot.find("col"),et.html(a),ct=et.find("col")}return e}function T(){if(!F){if(F=!0,X){var t=l(M,ut,!0),e=J.width();t>e&&M.css("minWidth",t)}M.css(vt),tt.css(vt),tt.append(k),E.before(lt),p()}}function C(){F&&(F=!1,X&&M.width(wt),lt.detach(),M.prepend(k),M.css(bt),tt.css(bt),M.css("minWidth",gt),M.css("minWidth",l(M,ut)))}function x(t){mt!=t&&(mt=t,M.triggerHandler("floatThead",[t,at]))}function j(t){X!=t&&(X=t,at.css({position:X?"absolute":"fixed"}))}function S(t,e,o,n){return h?o:n?y.getSizingRow(t,e,o):e}function z(){var t,e=m();return function(){var o=at.scrollLeft();ft=ot.find("col");var n=S(M,ft,ut,f);if(n.length==e&&e>0){if(!nt)for(t=0;e>t;t++)ft.eq(t).css("width","");C();var a=[];for(t=0;e>t;t++)a[t]=r(n.get(t));for(t=0;e>t;t++)ct.eq(t).width(a[t]),ft.eq(t).width(a[t]);T()}else tt.append(k),M.css(bt),tt.css(bt),p();at.scrollLeft(o),M.triggerHandler("reflowed",[at])}}function I(t){var e=U.css("border-"+t+"-width"),o=0;return e&&~e.indexOf("px")&&(o=parseInt(e,10)),o}function L(){return"auto"==P.css("overflow-x")}function W(){var t,e=U.scrollTop(),o=0,n=B?Y.outerHeight(!0):0,r=K?n:-n,a=at.height(),i=M.offset(),l=0,s=0;if(G){var d=U.offset();o=i.top-d.top+e,B&&K&&(o+=n),l=I("left"),s=I("top"),o-=s}else t=i.top-D-a+O+N.horizontal;var f=v.scrollTop(),c=v.scrollLeft(),p=function(){return(L()?P:U).scrollLeft()||0},h=p();return function(d){V=L();var b=M[0].offsetWidth<=0&&M[0].offsetHeight<=0;if(!b&&it)return it=!1,setTimeout(function(){M.triggerHandler("reflow")},1),null;if(b&&(it=!0,!X))return null;if("windowScroll"==d)f=v.scrollTop(),c=v.scrollLeft();else if("containerScroll"==d)if(P.length){if(!V)return;h=P.scrollLeft()}else e=U.scrollTop(),h=U.scrollLeft();else"init"!=d&&(f=v.scrollTop(),c=v.scrollLeft(),e=U.scrollTop(),h=p());if(!u||!(0>f||0>c)){if(Z)j("windowScrollDone"==d?!0:!1);else if("windowScrollDone"==d)return null;i=M.offset(),B&&K&&(i.top+=n);var w,g,m=M.outerHeight();if(G&&X){if(o>=e){var y=o-e+s;w=y>0?y:0,x(!1)}else w=_?s:e,x(!0);g=l}else!G&&X?(f>t+m+r?w=m-a+r:i.top>=f+D?(w=0,C(),x(!1)):(w=D+f-i.top+o+(K?n:0),T(),x(!0)),g=h):G&&!X?(o>e||e-o>m?(w=i.top-f,C(),x(!1)):(w=i.top+e-f-o,T(),x(!0)),g=i.left+h-c):G||X||(f>t+m+r?w=m+D-f+t+r:i.top>f+D?(w=i.top-f,T(),x(!1)):(w=D,x(!0)),g=i.left+h-c);return{top:Math.round(w),left:Math.round(g)}}}}function H(){var t=null,e=null,o=null;return function(n,r,a){if(null!=n&&(t!=n.top||e!=n.left)){if(8===f)at.css({top:n.top,left:n.left});else{var i="translateX("+n.left+"px) translateY("+n.top+"px)";at.css({"-webkit-transform":i,"-moz-transform":i,"-ms-transform":i,"-o-transform":i,transform:i,top:0,left:0})}t=n.top,e=n.left}r&&w(),a&&p();var l=(V?P:U).scrollLeft();X&&o==l||(at.scrollLeft(l),o=l)}}function q(){if(U.length)if(y.support&&y.support.perfectScrollbar&&U.data().perfectScrollbar)N={horizontal:0,vertical:0};else{if("scroll"==U.css("overflow-x"))N.horizontal=A;else{var t=U.width(),e=l(M,ut),o=r>n?A:0;N.horizontal=e>t-o?A:0}if("scroll"==U.css("overflow-y"))N.vertical=A;else{var n=U.height(),r=M.height(),a=e>t?A:0;N.vertical=r>n-a?A:0}}}var R=s.uniqueId(),M=t(this);if(M.data("floatThead-attached"))return!0;if(!M.is("table"))throw new Error('jQuery.floatThead must be run on a table element. ex: $("table").floatThead();');d=y.autoReflow&&d;var k=M.children("thead:first"),E=M.children("tbody:first");if(0==k.length||0==E.length)return y.debug&&n(0==k.length?"The thead element is missing.":"The tbody element is missing."),M.data("floatThead-lazy",y),void M.unbind("reflow").one("reflow",function(){M.floatThead(y)});M.data("floatThead-lazy")&&M.unbind("reflow"),M.data("floatThead-lazy",!1);var D,O,F=!0,N={vertical:0,horizontal:0},A=a(),Q=0;y.scrollContainer===!0&&(y.scrollContainer=o);var U=y.scrollContainer(M)||t([]),G=U.length>0,P=G?t([]):y.responsiveContainer(M)||t([]),V=L(),X=null;"auto"==y.position?X=null:"fixed"==y.position?X=!1:"absolute"==y.position?X=!0:y.debug&&n('Invalid value given to "position" option, valid is "fixed", "absolute" and "auto". You passed: ',y.position),null==X&&(X=G);var Y=M.find("caption"),B=1==Y.length;if(B)var K="top"===(Y.css("caption-side")||Y.attr("align")||"top");var $=t("<fthfoot>").css({display:"table-footer-group","border-spacing":0,height:0,"border-collapse":"collapse",visibility:"hidden"}),_=!1,J=t([]),Z=9>=f&&!G&&X,tt=t("<table/>"),et=t("<colgroup/>"),ot=M.children("colgroup:first"),nt=!0;0==ot.length&&(ot=t("<colgroup/>"),nt=!1);var rt=t("<fthtr>").css({display:"table-row","border-spacing":0,height:0,"border-collapse":"collapse"}),at=t("<div>").css("overflow","hidden").attr("aria-hidden","true"),it=!1,lt=t("<thead/>"),st=t('<tr class="size-row" aria-hidden="true"/>'),dt=t([]),ft=t([]),ct=t([]),ut=t([]);lt.append(st),M.prepend(ot),h&&($.append(rt),M.append($)),tt.append(et),at.append(tt),y.copyTableClass&&tt.attr("class",M.attr("class")),tt.attr({cellpadding:M.attr("cellpadding"),cellspacing:M.attr("cellspacing"),border:M.attr("border")});var pt=M.css("display");if(tt.css({borderCollapse:M.css("borderCollapse"),border:M.css("border"),display:pt}),G||tt.css("width","auto"),"none"==pt&&(it=!0),tt.addClass(y.floatTableClass).css({margin:0,"border-bottom-width":0}),X){var ht=function(e,o){var n=e.css("position"),r="relative"==n||"absolute"==n,a=e;if(!r||o){var i={paddingLeft:e.css("paddingLeft"),paddingRight:e.css("paddingRight")};at.css(i),a=e.data("floatThead-containerWrap")||e.wrap(t("<div>").addClass(y.floatWrapperClass).css({position:"relative",clear:"both"})).parent(),e.data("floatThead-containerWrap",a),_=!0}return a};G?(J=ht(U,!0),J.prepend(at)):(J=ht(M),M.before(at))}else M.before(at);at.css({position:X?"absolute":"fixed",marginTop:0,top:X?0:"auto",zIndex:y.zIndex,willChange:"transform"}),at.addClass(y.floatContainerClass),g();var vt={"table-layout":"fixed"},bt={"table-layout":M.css("tableLayout")||"auto"},wt=M[0].style.width||"",gt=M.css("minWidth")||"",mt=!1;q();var yt,Tt=function(){(yt=z())()};Tt();var Ct=W(),xt=H();xt(Ct("init"),!0);var jt,St=s.debounce(function(){xt(Ct("windowScrollDone"),!1)},1),zt=function(){xt(Ct("windowScroll"),!1),Z&&St()},It=function(){xt(Ct("containerScroll"),!1)},Lt=function(){M.is(":hidden")||(g(),q(),Tt(),Ct=W(),(xt=H())(Ct("resize"),!0,!0))},Wt=s.debounce(function(){M.is(":hidden")||(q(),g(),Tt(),Ct=W(),xt(Ct("reflow"),!0))},1),Ht=function(){C()},qt=function(){T()},Rt=function(t){t.matches?Ht():qt()};if(window.matchMedia&&window.matchMedia("print").addListener?(jt=window.matchMedia("print"),jt.addListener(Rt)):(v.on("beforeprint",Ht),v.on("afterprint",qt)),G?X?U.on(c("scroll"),It):(U.on(c("scroll"),It),v.on(c("scroll"),zt)):(P.on(c("scroll"),It),v.on(c("scroll"),zt)),v.on(c("load"),Wt),e(c("resize"),Lt),M.on("reflow",Wt),y.support&&y.support.datatables&&i(M)&&M.on("filter",Wt).on("sort",Wt).on("page",Wt),y.support&&y.support.bootstrap&&v.on(c("shown.bs.tab"),Wt),y.support&&y.support.jqueryUI&&v.on(c("tabsactivate"),Wt),d){var Mt=null;s.isFunction(y.autoReflow)&&(Mt=y.autoReflow(M,U)),Mt||(Mt=U.length?U[0]:M[0]),b=new MutationObserver(function(t){for(var e=function(t){return t&&t[0]&&("THEAD"==t[0].nodeName||"TD"==t[0].nodeName||"TH"==t[0].nodeName)},o=0;o<t.length;o++)if(!e(t[o].addedNodes)&&!e(t[o].removedNodes)){Wt();break}}),b.observe(Mt,{childList:!0,subtree:!0})}M.data("floatThead-attached",{destroy:function(){var t=".fth-"+R;return C(),M.css(bt),ot.remove(),h&&$.remove(),lt.parent().length&&lt.replaceWith(k),x(!1),d&&(b.disconnect(),b=null),M.off("reflow reflowed"),U.off(t),P.off(t),_&&(U.length?U.unwrap():M.unwrap()),G?U.data("floatThead-containerWrap",!1):M.data("floatThead-containerWrap",!1),M.css("minWidth",gt),at.remove(),M.data("floatThead-attached",!1),v.off(t),jt&&jt.removeListener(Rt),Ht=qt=function(){},function(){return M.floatThead(y)}},reflow:function(){Wt()},setHeaderHeight:function(){p()},getFloatContainer:function(){return at},getRowGroups:function(){return F?at.find(">table>thead").add(M.children("tbody,tfoot")):M.children("thead,tbody,tfoot")}})}),this}}(function(){var t=window.jQuery;return"undefined"!=typeof module&&module.exports&&!t&&(t=require("jquery")),t}());

!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.proj4=b()}(this,function(){"use strict";function a(a,b){if(a[b])return a[b];for(var c,d,e=Object.keys(a),f=b.toLowerCase().replace(Ob,""),g=-1;++g<e.length;)if(c=e[g],d=c.toLowerCase().replace(Ob,""),d===f)return a[c]}function b(a){if("string"!=typeof a)throw new Error("not a string");this.text=a.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Qb}function c(a){var c=new b(a);return c.output()}function d(a,b,c){Array.isArray(b)&&(c.unshift(b),b=null);var d=b?{}:a,f=c.reduce(function(a,b){return e(b,a),a},d);b&&(a[b]=f)}function e(a,b){if(!Array.isArray(a))return void(b[a]=!0);var c=a.shift();if("PARAMETER"===c&&(c=a.shift()),1===a.length)return Array.isArray(a[0])?(b[c]={},void e(a[0],b[c])):void(b[c]=a[0]);if(!a.length)return void(b[c]=!0);if("TOWGS84"===c)return void(b[c]=a);Array.isArray(c)||(b[c]={});var f;switch(c){case"UNIT":case"PRIMEM":case"VERT_DATUM":return b[c]={name:a[0].toLowerCase(),convert:a[1]},void(3===a.length&&e(a[2],b[c]));case"SPHEROID":case"ELLIPSOID":return b[c]={name:a[0],a:a[1],rf:a[2]},void(4===a.length&&e(a[3],b[c]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return a[0]=["name",a[0]],void d(b,c,a);default:for(f=-1;++f<a.length;)if(!Array.isArray(a[f]))return e(a,b[c]);return d(b,c,a)}}function f(a,b){var c=b[0],d=b[1];!(c in a)&&d in a&&(a[c]=a[d],3===b.length&&(a[c]=b[2](a[c])))}function g(a){return a*_b}function h(a){function b(b){var c=a.to_meter||1;return b*c}"GEOGCS"===a.type?a.projName="longlat":"LOCAL_CS"===a.type?(a.projName="identity",a.local=!0):"object"==typeof a.PROJECTION?a.projName=Object.keys(a.PROJECTION)[0]:a.projName=a.PROJECTION,a.UNIT&&(a.units=a.UNIT.name.toLowerCase(),"metre"===a.units&&(a.units="meter"),a.UNIT.convert&&("GEOGCS"===a.type?a.DATUM&&a.DATUM.SPHEROID&&(a.to_meter=a.UNIT.convert*a.DATUM.SPHEROID.a):(a.to_meter=a.UNIT.convert,10)));var c=a.GEOGCS;"GEOGCS"===a.type&&(c=a),c&&(c.DATUM?a.datumCode=c.DATUM.name.toLowerCase():a.datumCode=c.name.toLowerCase(),"d_"===a.datumCode.slice(0,2)&&(a.datumCode=a.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==a.datumCode&&"new_zealand_1949"!==a.datumCode||(a.datumCode="nzgd49"),"wgs_1984"===a.datumCode&&("Mercator_Auxiliary_Sphere"===a.PROJECTION&&(a.sphere=!0),a.datumCode="wgs84"),"_ferro"===a.datumCode.slice(-6)&&(a.datumCode=a.datumCode.slice(0,-6)),"_jakarta"===a.datumCode.slice(-8)&&(a.datumCode=a.datumCode.slice(0,-8)),~a.datumCode.indexOf("belge")&&(a.datumCode="rnb72"),c.DATUM&&c.DATUM.SPHEROID&&(a.ellps=c.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===a.ellps.toLowerCase().slice(0,13)&&(a.ellps="intl"),a.a=c.DATUM.SPHEROID.a,a.rf=parseFloat(c.DATUM.SPHEROID.rf,10)),~a.datumCode.indexOf("osgb_1936")&&(a.datumCode="osgb36")),a.b&&!isFinite(a.b)&&(a.b=a.a);var d=function(b){return f(a,b)},e=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",g],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",g],["x0","false_easting",b],["y0","false_northing",b],["long0","central_meridian",g],["lat0","latitude_of_origin",g],["lat0","standard_parallel_1",g],["lat1","standard_parallel_1",g],["lat2","standard_parallel_2",g],["alpha","azimuth",g],["srsCode","name"]];e.forEach(d),a.long0||!a.longc||"Albers_Conic_Equal_Area"!==a.projName&&"Lambert_Azimuthal_Equal_Area"!==a.projName||(a.long0=a.longc),a.lat_ts||!a.lat1||"Stereographic_South_Pole"!==a.projName&&"Polar Stereographic (variant B)"!==a.projName||(a.lat0=g(a.lat1>0?90:-90),a.lat_ts=a.lat1)}function i(a){var b=this;if(2===arguments.length){var c=arguments[1];"string"==typeof c?"+"===c.charAt(0)?i[a]=Pb(arguments[1]):i[a]=ac(arguments[1]):i[a]=c}else if(1===arguments.length){if(Array.isArray(a))return a.map(function(a){Array.isArray(a)?i.apply(b,a):i(a)});if("string"==typeof a){if(a in i)return i[a]}else"EPSG"in a?i["EPSG:"+a.EPSG]=a:"ESRI"in a?i["ESRI:"+a.ESRI]=a:"IAU2000"in a?i["IAU2000:"+a.IAU2000]=a:console.log(a);return}}function j(a){return"string"==typeof a}function k(a){return a in i}function l(a){return bc.some(function(b){return a.indexOf(b)>-1})}function m(a){return"+"===a[0]}function n(a){return j(a)?k(a)?i[a]:l(a)?ac(a):m(a)?Pb(a):void 0:a}function o(){var a=this.b/this.a;this.es=1-a*a,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=dc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function p(a){var b=a.x,c=a.y;if(c*Ib>90&&c*Ib<-90&&b*Ib>180&&b*Ib<-180)return null;var d,e;if(Math.abs(Math.abs(c)-Cb)<=Gb)return null;if(this.sphere)d=this.x0+this.a*this.k0*fc(b-this.long0),e=this.y0+this.a*this.k0*Math.log(Math.tan(Jb+.5*c));else{var f=Math.sin(c),g=gc(this.e,c,f);d=this.x0+this.a*this.k0*fc(b-this.long0),e=this.y0-this.a*this.k0*Math.log(g)}return a.x=d,a.y=e,a}function q(a){var b,c,d=a.x-this.x0,e=a.y-this.y0;if(this.sphere)c=Cb-2*Math.atan(Math.exp(-e/(this.a*this.k0)));else{var f=Math.exp(-e/(this.a*this.k0));if(c=hc(this.e,f),c===-9999)return null}return b=fc(this.long0+d/(this.a*this.k0)),a.x=b,a.y=c,a}function r(){}function s(a){return a}function t(a,b){var c=oc.length;return a.names?(oc[c]=a,a.names.forEach(function(a){nc[a.toLowerCase()]=c}),this):(console.log(b),!0)}function u(a){if(!a)return!1;var b=a.toLowerCase();return"undefined"!=typeof nc[b]&&oc[nc[b]]?oc[nc[b]]:void 0}function v(){mc.forEach(t)}function w(a,b,c,d){var e=a*a,f=b*b,g=(e-f)/e,h=0;d?(a*=1-g*(Db+g*(Eb+g*Fb)),e=a*a,g=0):h=Math.sqrt(g);var i=(e-f)/f;return{es:g,e:h,ep2:i}}function x(b,c,d,e,f){if(!b){var g=a(qc,e);g||(g=rc),b=g.a,c=g.b,d=g.rf}return d&&!c&&(c=(1-1/d)*b),(0===d||Math.abs(b-c)<Gb)&&(f=!0,c=b),{a:b,b:c,rf:d,sphere:f}}function y(a,b,c,d,e,f){var g={};return void 0===a||"none"===a?g.datum_type=Ab:g.datum_type=zb,b&&(g.datum_params=b.map(parseFloat),0===g.datum_params[0]&&0===g.datum_params[1]&&0===g.datum_params[2]||(g.datum_type=xb),g.datum_params.length>3&&(0===g.datum_params[3]&&0===g.datum_params[4]&&0===g.datum_params[5]&&0===g.datum_params[6]||(g.datum_type=yb,g.datum_params[3]*=Bb,g.datum_params[4]*=Bb,g.datum_params[5]*=Bb,g.datum_params[6]=g.datum_params[6]/1e6+1))),g.a=c,g.b=d,g.es=e,g.ep2=f,g}function z(b,c){if(!(this instanceof z))return new z(b);c=c||function(a){if(a)throw a};var d=n(b);if("object"!=typeof d)return void c(b);var e=z.projections.get(d.projName);if(!e)return void c(b);if(d.datumCode&&"none"!==d.datumCode){var f=a(sc,d.datumCode);f&&(d.datum_params=f.towgs84?f.towgs84.split(","):null,d.ellps=f.ellipse,d.datumName=f.datumName?f.datumName:d.datumCode)}d.k0=d.k0||1,d.axis=d.axis||"enu",d.ellps=d.ellps||"wgs84";var g=x(d.a,d.b,d.rf,d.ellps,d.sphere),h=w(g.a,g.b,g.rf,d.R_A),i=d.datum||y(d.datumCode,d.datum_params,g.a,g.b,h.es,h.ep2);cc(this,d),cc(this,e),this.a=g.a,this.b=g.b,this.rf=g.rf,this.sphere=g.sphere,this.es=h.es,this.e=h.e,this.ep2=h.ep2,this.datum=i,this.init(),c(null,this)}function A(a,b){return a.datum_type===b.datum_type&&(!(a.a!==b.a||Math.abs(a.es-b.es)>5e-11)&&(a.datum_type===xb?a.datum_params[0]===b.datum_params[0]&&a.datum_params[1]===b.datum_params[1]&&a.datum_params[2]===b.datum_params[2]:a.datum_type!==yb||a.datum_params[0]===b.datum_params[0]&&a.datum_params[1]===b.datum_params[1]&&a.datum_params[2]===b.datum_params[2]&&a.datum_params[3]===b.datum_params[3]&&a.datum_params[4]===b.datum_params[4]&&a.datum_params[5]===b.datum_params[5]&&a.datum_params[6]===b.datum_params[6]))}function B(a,b,c){var d,e,f,g,h=a.x,i=a.y,j=a.z?a.z:0;if(i<-Cb&&i>-1.001*Cb)i=-Cb;else if(i>Cb&&i<1.001*Cb)i=Cb;else if(i<-Cb||i>Cb)return null;return h>Math.PI&&(h-=2*Math.PI),e=Math.sin(i),g=Math.cos(i),f=e*e,d=c/Math.sqrt(1-b*f),{x:(d+j)*g*Math.cos(h),y:(d+j)*g*Math.sin(h),z:(d*(1-b)+j)*e}}function C(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=1e-12,v=u*u,w=30,x=a.x,y=a.y,z=a.z?a.z:0;if(e=Math.sqrt(x*x+y*y),f=Math.sqrt(x*x+y*y+z*z),e/c<u){if(r=0,f/c<u)return s=Cb,t=-d,{x:a.x,y:a.y,z:a.z}}else r=Math.atan2(y,x);g=z/f,h=e/f,i=1/Math.sqrt(1-b*(2-b)*h*h),l=h*(1-b)*i,m=g*i,q=0;do q++,k=c/Math.sqrt(1-b*m*m),t=e*l+z*m-k*(1-b*m*m),j=b*k/(k+t),i=1/Math.sqrt(1-j*(2-j)*h*h),n=h*(1-j)*i,o=g*i,p=o*l-n*m,l=n,m=o;while(p*p>v&&q<w);return s=Math.atan(o/Math.abs(n)),{x:r,y:s,z:t}}function D(a,b,c){if(b===xb)return{x:a.x+c[0],y:a.y+c[1],z:a.z+c[2]};if(b===yb){var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],j=c[6];return{x:j*(a.x-i*a.y+h*a.z)+d,y:j*(i*a.x+a.y-g*a.z)+e,z:j*(-h*a.x+g*a.y+a.z)+f}}}function E(a,b,c){if(b===xb)return{x:a.x-c[0],y:a.y-c[1],z:a.z-c[2]};if(b===yb){var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],j=c[6],k=(a.x-d)/j,l=(a.y-e)/j,m=(a.z-f)/j;return{x:k+i*l-h*m,y:-i*k+l+g*m,z:h*k-g*l+m}}}function F(a){return a===xb||a===yb}function G(a,b){return(a.datum.datum_type===xb||a.datum.datum_type===yb)&&"WGS84"!==b.datumCode||(b.datum.datum_type===xb||b.datum.datum_type===yb)&&"WGS84"!==a.datumCode}function H(a,b,c){var d;return Array.isArray(c)&&(c=vc(c)),a.datum&&b.datum&&G(a,b)&&(d=new z("WGS84"),c=H(a,d,c),a=d),"enu"!==a.axis&&(c=uc(a,!1,c)),"longlat"===a.projName?c={x:c.x*Hb,y:c.y*Hb}:(a.to_meter&&(c={x:c.x*a.to_meter,y:c.y*a.to_meter}),c=a.inverse(c)),a.from_greenwich&&(c.x+=a.from_greenwich),c=tc(a.datum,b.datum,c),b.from_greenwich&&(c={x:c.x-b.from_greenwich,y:c.y}),"longlat"===b.projName?c={x:c.x*Ib,y:c.y*Ib}:(c=b.forward(c),b.to_meter&&(c={x:c.x/b.to_meter,y:c.y/b.to_meter})),"enu"!==b.axis?uc(b,!0,c):c}function I(a,b,c){var d;return Array.isArray(c)?(d=H(a,b,c),3===c.length?[d.x,d.y,d.z]:[d.x,d.y]):H(a,b,c)}function J(a){return a instanceof z?a:a.oProj?a.oProj:z(a)}function K(a,b,c){a=J(a);var d,e=!1;return"undefined"==typeof b?(b=a,a=wc,e=!0):("undefined"!=typeof b.x||Array.isArray(b))&&(c=b,b=a,a=wc,e=!0),b=J(b),c?I(a,b,c):(d={forward:function(c){return I(a,b,c)},inverse:function(c){return I(b,a,c)}},e&&(d.oProj=b),d)}function L(a,b){return b=b||5,T(Q({lat:a[1],lon:a[0]}),b)}function M(a){var b=R(X(a.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat,b.lon,b.lat]:[b.left,b.bottom,b.right,b.top]}function N(a){var b=R(X(a.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat]:[(b.left+b.right)/2,(b.top+b.bottom)/2]}function O(a){return a*(Math.PI/180)}function P(a){return 180*(a/Math.PI)}function Q(a){var b,c,d,e,f,g,h,i,j,k=a.lat,l=a.lon,m=6378137,n=.00669438,o=.9996,p=O(k),q=O(l);j=Math.floor((l+180)/6)+1,180===l&&(j=60),k>=56&&k<64&&l>=3&&l<12&&(j=32),k>=72&&k<84&&(l>=0&&l<9?j=31:l>=9&&l<21?j=33:l>=21&&l<33?j=35:l>=33&&l<42&&(j=37)),b=6*(j-1)-180+3,i=O(b),c=n/(1-n),d=m/Math.sqrt(1-n*Math.sin(p)*Math.sin(p)),e=Math.tan(p)*Math.tan(p),f=c*Math.cos(p)*Math.cos(p),g=Math.cos(p)*(q-i),h=m*((1-n/4-3*n*n/64-5*n*n*n/256)*p-(3*n/8+3*n*n/32+45*n*n*n/1024)*Math.sin(2*p)+(15*n*n/256+45*n*n*n/1024)*Math.sin(4*p)-35*n*n*n/3072*Math.sin(6*p));var r=o*d*(g+(1-e+f)*g*g*g/6+(5-18*e+e*e+72*f-58*c)*g*g*g*g*g/120)+5e5,s=o*(h+d*Math.tan(p)*(g*g/2+(5-e+9*f+4*f*f)*g*g*g*g/24+(61-58*e+e*e+600*f-330*c)*g*g*g*g*g*g/720));return k<0&&(s+=1e7),{northing:Math.round(s),easting:Math.round(r),zoneNumber:j,zoneLetter:S(k)}}function R(a){var b=a.northing,c=a.easting,d=a.zoneLetter,e=a.zoneNumber;if(e<0||e>60)return null;var f,g,h,i,j,k,l,m,n,o,p=.9996,q=6378137,r=.00669438,s=(1-Math.sqrt(1-r))/(1+Math.sqrt(1-r)),t=c-5e5,u=b;d<"N"&&(u-=1e7),m=6*(e-1)-180+3,f=r/(1-r),l=u/p,n=l/(q*(1-r/4-3*r*r/64-5*r*r*r/256)),o=n+(3*s/2-27*s*s*s/32)*Math.sin(2*n)+(21*s*s/16-55*s*s*s*s/32)*Math.sin(4*n)+151*s*s*s/96*Math.sin(6*n),g=q/Math.sqrt(1-r*Math.sin(o)*Math.sin(o)),h=Math.tan(o)*Math.tan(o),i=f*Math.cos(o)*Math.cos(o),j=q*(1-r)/Math.pow(1-r*Math.sin(o)*Math.sin(o),1.5),k=t/(g*p);var v=o-g*Math.tan(o)/j*(k*k/2-(5+3*h+10*i-4*i*i-9*f)*k*k*k*k/24+(61+90*h+298*i+45*h*h-252*f-3*i*i)*k*k*k*k*k*k/720);v=P(v);var w=(k-(1+2*h+i)*k*k*k/6+(5-2*i+28*h-3*i*i+8*f+24*h*h)*k*k*k*k*k/120)/Math.cos(o);w=m+P(w);var x;if(a.accuracy){var y=R({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber});x={top:y.lat,right:y.lon,bottom:v,left:w}}else x={lat:v,lon:w};return x}function S(a){var b="Z";return 84>=a&&a>=72?b="X":72>a&&a>=64?b="W":64>a&&a>=56?b="V":56>a&&a>=48?b="U":48>a&&a>=40?b="T":40>a&&a>=32?b="S":32>a&&a>=24?b="R":24>a&&a>=16?b="Q":16>a&&a>=8?b="P":8>a&&a>=0?b="N":0>a&&a>=-8?b="M":-8>a&&a>=-16?b="L":-16>a&&a>=-24?b="K":-24>a&&a>=-32?b="J":-32>a&&a>=-40?b="H":-40>a&&a>=-48?b="G":-48>a&&a>=-56?b="F":-56>a&&a>=-64?b="E":-64>a&&a>=-72?b="D":-72>a&&a>=-80&&(b="C"),b}function T(a,b){var c="00000"+a.easting,d="00000"+a.northing;return a.zoneNumber+a.zoneLetter+U(a.easting,a.northing,a.zoneNumber)+c.substr(c.length-5,b)+d.substr(d.length-5,b)}function U(a,b,c){var d=V(c),e=Math.floor(a/1e5),f=Math.floor(b/1e5)%20;return W(e,f,d)}function V(a){var b=a%xc;return 0===b&&(b=xc),b}function W(a,b,c){var d=c-1,e=yc.charCodeAt(d),f=zc.charCodeAt(d),g=e+a-1,h=f+b,i=!1;g>Ec&&(g=g-Ec+Ac-1,i=!0),(g===Bc||e<Bc&&g>Bc||(g>Bc||e<Bc)&&i)&&g++,(g===Cc||e<Cc&&g>Cc||(g>Cc||e<Cc)&&i)&&(g++,g===Bc&&g++),g>Ec&&(g=g-Ec+Ac-1),h>Dc?(h=h-Dc+Ac-1,i=!0):i=!1,(h===Bc||f<Bc&&h>Bc||(h>Bc||f<Bc)&&i)&&h++,(h===Cc||f<Cc&&h>Cc||(h>Cc||f<Cc)&&i)&&(h++,h===Bc&&h++),h>Dc&&(h=h-Dc+Ac-1);var j=String.fromCharCode(g)+String.fromCharCode(h);return j}function X(a){if(a&&0===a.length)throw"MGRSPoint coverting from nothing";for(var b,c=a.length,d=null,e="",f=0;!/[A-Z]/.test(b=a.charAt(f));){if(f>=2)throw"MGRSPoint bad conversion from: "+a;e+=b,f++}var g=parseInt(e,10);if(0===f||f+3>c)throw"MGRSPoint bad conversion from: "+a;var h=a.charAt(f++);if(h<="A"||"B"===h||"Y"===h||h>="Z"||"I"===h||"O"===h)throw"MGRSPoint zone letter "+h+" not handled: "+a;d=a.substring(f,f+=2);for(var i=V(g),j=Y(d.charAt(0),i),k=Z(d.charAt(1),i);k<$(h);)k+=2e6;var l=c-f;if(l%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var m,n,o,p,q,r=l/2,s=0,t=0;return r>0&&(m=1e5/Math.pow(10,r),n=a.substring(f,f+r),s=parseFloat(n)*m,o=a.substring(f+r),t=parseFloat(o)*m),p=s+j,q=t+k,{easting:p,northing:q,zoneLetter:h,zoneNumber:g,accuracy:m}}function Y(a,b){for(var c=yc.charCodeAt(b-1),d=1e5,e=!1;c!==a.charCodeAt(0);){if(c++,c===Bc&&c++,c===Cc&&c++,c>Ec){if(e)throw"Bad character: "+a;c=Ac,e=!0}d+=1e5}return d}function Z(a,b){if(a>"V")throw"MGRSPoint given invalid Northing "+a;for(var c=zc.charCodeAt(b-1),d=0,e=!1;c!==a.charCodeAt(0);){if(c++,c===Bc&&c++,c===Cc&&c++,c>Dc){if(e)throw"Bad character: "+a;c=Ac,e=!0}d+=1e5}return d}function $(a){var b;switch(a){case"C":b=11e5;break;case"D":b=2e6;break;case"E":b=28e5;break;case"F":b=37e5;break;case"G":b=46e5;break;case"H":b=55e5;break;case"J":b=64e5;break;case"K":b=73e5;break;case"L":b=82e5;break;case"M":b=91e5;break;case"N":b=0;break;case"P":b=8e5;break;case"Q":b=17e5;break;case"R":b=26e5;break;case"S":b=35e5;break;case"T":b=44e5;break;case"U":b=53e5;break;case"V":b=62e5;break;case"W":b=7e6;break;case"X":b=79e5;break;default:b=-1}if(b>=0)return b;throw"Invalid zone letter: "+a}function Point(a,b,c){if(!(this instanceof Point))return new Point(a,b,c);if(Array.isArray(a))this.x=a[0],this.y=a[1],this.z=a[2]||0;else if("object"==typeof a)this.x=a.x,this.y=a.y,this.z=a.z||0;else if("string"==typeof a&&"undefined"==typeof b){var d=a.split(",");this.x=parseFloat(d[0],10),this.y=parseFloat(d[1],10),this.z=parseFloat(d[2],10)||0}else this.x=a,this.y=b,this.z=c||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function _(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Tc(this.es),this.ml0=Uc(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function aa(a){var b,c,d,e=a.x,f=a.y,g=fc(e-this.long0),h=Math.sin(f),i=Math.cos(f);if(this.es){var j=i*g,k=Math.pow(j,2),l=this.ep2*Math.pow(i,2),m=Math.pow(l,2),n=Math.abs(i)>Gb?Math.tan(f):0,o=Math.pow(n,2),p=Math.pow(o,2);b=1-this.es*Math.pow(h,2),j/=Math.sqrt(b);var q=Uc(f,h,i,this.en);c=this.a*(this.k0*j*(1+k/6*(1-o+l+k/20*(5-18*o+p+14*l-58*o*l+k/42*(61+179*p-p*o-479*o)))))+this.x0,d=this.a*(this.k0*(q-this.ml0+h*g*j/2*(1+k/12*(5-o+9*l+4*m+k/30*(61+p-58*o+270*l-330*o*l+k/56*(1385+543*p-p*o-3111*o))))))+this.y0}else{var r=i*Math.sin(g);if(Math.abs(Math.abs(r)-1)<Gb)return 93;if(c=.5*this.a*this.k0*Math.log((1+r)/(1-r))+this.x0,d=i*Math.cos(g)/Math.sqrt(1-Math.pow(r,2)),r=Math.abs(d),r>=1){if(r-1>Gb)return 93;d=0}else d=Math.acos(d);f<0&&(d=-d),d=this.a*this.k0*(d-this.lat0)+this.y0}return a.x=c,a.y=d,a}function ba(a){var b,c,d,e,f=(a.x-this.x0)*(1/this.a),g=(a.y-this.y0)*(1/this.a);if(this.es)if(b=this.ml0+g/this.k0,c=Wc(b,this.es,this.en),Math.abs(c)<Cb){var h=Math.sin(c),i=Math.cos(c),j=Math.abs(i)>Gb?Math.tan(c):0,k=this.ep2*Math.pow(i,2),l=Math.pow(k,2),m=Math.pow(j,2),n=Math.pow(m,2);b=1-this.es*Math.pow(h,2);var o=f*Math.sqrt(b)/this.k0,p=Math.pow(o,2);b*=j,d=c-b*p/(1-this.es)*.5*(1-p/12*(5+3*m-9*k*m+k-4*l-p/30*(61+90*m-252*k*m+45*n+46*k-p/56*(1385+3633*m+4095*n+1574*n*m)))),e=fc(this.long0+o*(1-p/6*(1+2*m+k-p/20*(5+28*m+24*n+8*k*m+6*k-p/42*(61+662*m+1320*n+720*n*m))))/i)}else d=Cb*ec(g),e=0;else{var q=Math.exp(f/this.k0),r=.5*(q-1/q),s=this.lat0+g/this.k0,t=Math.cos(s);b=Math.sqrt((1-Math.pow(t,2))/(1+Math.pow(r,2))),d=Math.asin(b),g<0&&(d=-d),e=0===r&&0===t?0:fc(Math.atan2(r,t)+this.long0)}return a.x=e,a.y=d,a}function ca(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var a=this.es/(1+Math.sqrt(1-this.es)),b=a/(2-a),c=b;this.cgb[0]=b*(2+b*(-2/3+b*(-2+b*(116/45+b*(26/45+b*(-2854/675)))))),this.cbg[0]=b*(-2+b*(2/3+b*(4/3+b*(-82/45+b*(32/45+b*(4642/4725)))))),c*=b,this.cgb[1]=c*(7/3+b*(-1.6+b*(-227/45+b*(2704/315+b*(2323/945))))),this.cbg[1]=c*(5/3+b*(-16/15+b*(-13/9+b*(904/315+b*(-1522/945))))),c*=b,this.cgb[2]=c*(56/15+b*(-136/35+b*(-1262/105+b*(73814/2835)))),this.cbg[2]=c*(-26/15+b*(34/21+b*(1.6+b*(-12686/2835)))),c*=b,this.cgb[3]=c*(4279/630+b*(-332/35+b*(-399572/14175))),this.cbg[3]=c*(1237/630+b*(-2.4+b*(-24832/14175))),c*=b,this.cgb[4]=c*(4174/315+b*(-144838/6237)),this.cbg[4]=c*(-734/315+b*(109598/31185)),c*=b,this.cgb[5]=c*(601676/22275),this.cbg[5]=c*(444337/155925),c=Math.pow(b,2),this.Qn=this.k0/(1+b)*(1+c*(.25+c*(1/64+c/256))),this.utg[0]=b*(-.5+b*(2/3+b*(-37/96+b*(1/360+b*(81/512+b*(-96199/604800)))))),this.gtu[0]=b*(.5+b*(-2/3+b*(5/16+b*(41/180+b*(-127/288+b*(7891/37800)))))),this.utg[1]=c*(-1/48+b*(-1/15+b*(437/1440+b*(-46/105+b*(1118711/3870720))))),this.gtu[1]=c*(13/48+b*(-.6+b*(557/1440+b*(281/630+b*(-1983433/1935360))))),c*=b,this.utg[2]=c*(-17/480+b*(37/840+b*(209/4480+b*(-5569/90720)))),this.gtu[2]=c*(61/240+b*(-103/140+b*(15061/26880+b*(167603/181440)))),c*=b,this.utg[3]=c*(-4397/161280+b*(11/504+b*(830251/7257600))),this.gtu[3]=c*(49561/161280+b*(-179/168+b*(6601661/7257600))),c*=b,this.utg[4]=c*(-4583/161280+b*(108847/3991680)),this.gtu[4]=c*(34729/80640+b*(-3418889/1995840)),c*=b,this.utg[5]=c*-.03233083094085698,this.gtu[5]=.6650675310896665*c;var d=bd(this.cbg,this.lat0);this.Zb=-this.Qn*(d+cd(this.gtu,2*d))}function da(a){var b=fc(a.x-this.long0),c=a.y;c=bd(this.cbg,c);var d=Math.sin(c),e=Math.cos(c),f=Math.sin(b),g=Math.cos(b);c=Math.atan2(d,g*e),b=Math.atan2(f*e,$c(d,e*g)),b=ad(Math.tan(b));var h=ed(this.gtu,2*c,2*b);c+=h[0],b+=h[1];var i,j;return Math.abs(b)<=2.623395162778?(i=this.a*(this.Qn*b)+this.x0,j=this.a*(this.Qn*c+this.Zb)+this.y0):(i=1/0,j=1/0),a.x=i,a.y=j,a}function ea(a){var b=(a.x-this.x0)*(1/this.a),c=(a.y-this.y0)*(1/this.a);c=(c-this.Zb)/this.Qn,b/=this.Qn;var d,e;if(Math.abs(b)<=2.623395162778){var f=ed(this.utg,2*c,2*b);c+=f[0],b+=f[1],b=Math.atan(Zc(b));var g=Math.sin(c),h=Math.cos(c),i=Math.sin(b),j=Math.cos(b);c=Math.atan2(g*j,$c(i,j*h)),b=Math.atan2(i,j*h),d=fc(b+this.long0),e=bd(this.cgb,c)}else d=1/0,e=1/0;return a.x=d,a.y=e,a}function fa(){var a=hd(this.zone,this.long0);if(void 0===a)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(a)-183)*Hb,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,gd.init.apply(this),this.forward=gd.forward,this.inverse=gd.inverse}function ga(){var a=Math.sin(this.lat0),b=Math.cos(this.lat0);b*=b,this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a),this.C=Math.sqrt(1+this.es*b*b/(1-this.es)),this.phic0=Math.asin(a/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Jb)/(Math.pow(Math.tan(.5*this.lat0+Jb),this.C)*ld(this.e*a,this.ratexp))}function ha(a){var b=a.x,c=a.y;return a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*c+Jb),this.C)*ld(this.e*Math.sin(c),this.ratexp))-Cb,a.x=this.C*b,a}function ia(a){for(var b=1e-14,c=a.x/this.C,d=a.y,e=Math.pow(Math.tan(.5*d+Jb)/this.K,1/this.C),f=md;f>0&&(d=2*Math.atan(e*ld(this.e*Math.sin(a.y),-.5*this.e))-Cb,!(Math.abs(d-a.y)<b));--f)a.y=d;return f?(a.x=c,a.y=d,a):null}function ja(){od.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function ka(a){var b,c,d,e;return a.x=fc(a.x-this.long0),od.forward.apply(this,[a]),b=Math.sin(a.y),c=Math.cos(a.y),d=Math.cos(a.x),e=this.k0*this.R2/(1+this.sinc0*b+this.cosc0*c*d),a.x=e*c*Math.sin(a.x),a.y=e*(this.cosc0*b-this.sinc0*c*d),a.x=this.a*a.x+this.x0,a.y=this.a*a.y+this.y0,a}function la(a){var b,c,d,e,f;if(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,f=Math.sqrt(a.x*a.x+a.y*a.y)){var g=2*Math.atan2(f,this.R2);b=Math.sin(g),c=Math.cos(g),e=Math.asin(c*this.sinc0+a.y*b*this.cosc0/f),d=Math.atan2(a.x*b,f*this.cosc0*c-a.y*this.sinc0*b)}else e=this.phic0,d=0;return a.x=d,a.y=e,od.inverse.apply(this,[a]),a.x=fc(a.x+this.long0),a}function ma(a,b,c){return b*=c,Math.tan(.5*(Cb+a))*Math.pow((1-b)/(1+b),.5*c)}function na(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Gb&&(this.k0=.5*(1+ec(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Gb&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Gb&&(this.k0=.5*this.cons*dc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/gc(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=dc(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Cb,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function oa(a){var b,c,d,e,f,g,h=a.x,i=a.y,j=Math.sin(i),k=Math.cos(i),l=fc(h-this.long0);return Math.abs(Math.abs(h-this.long0)-Math.PI)<=Gb&&Math.abs(i+this.lat0)<=Gb?(a.x=NaN,a.y=NaN,a):this.sphere?(b=2*this.k0/(1+this.sinlat0*j+this.coslat0*k*Math.cos(l)),a.x=this.a*b*k*Math.sin(l)+this.x0,a.y=this.a*b*(this.coslat0*j-this.sinlat0*k*Math.cos(l))+this.y0,a):(c=2*Math.atan(this.ssfn_(i,j,this.e))-Cb,e=Math.cos(c),d=Math.sin(c),Math.abs(this.coslat0)<=Gb?(f=gc(this.e,i*this.con,this.con*j),g=2*this.a*this.k0*f/this.cons,a.x=this.x0+g*Math.sin(h-this.long0),a.y=this.y0-this.con*g*Math.cos(h-this.long0),a):(Math.abs(this.sinlat0)<Gb?(b=2*this.a*this.k0/(1+e*Math.cos(l)),a.y=b*d):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*d+this.cosX0*e*Math.cos(l))),a.y=b*(this.cosX0*d-this.sinX0*e*Math.cos(l))+this.y0),a.x=b*e*Math.sin(l)+this.x0,a))}function pa(a){a.x-=this.x0,a.y-=this.y0;var b,c,d,e,f,g=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere){var h=2*Math.atan(g/(.5*this.a*this.k0));return b=this.long0,c=this.lat0,g<=Gb?(a.x=b,a.y=c,a):(c=Math.asin(Math.cos(h)*this.sinlat0+a.y*Math.sin(h)*this.coslat0/g),b=fc(Math.abs(this.coslat0)<Gb?this.lat0>0?this.long0+Math.atan2(a.x,-1*a.y):this.long0+Math.atan2(a.x,a.y):this.long0+Math.atan2(a.x*Math.sin(h),g*this.coslat0*Math.cos(h)-a.y*this.sinlat0*Math.sin(h))),a.x=b,a.y=c,a)}if(Math.abs(this.coslat0)<=Gb){if(g<=Gb)return c=this.lat0,b=this.long0,a.x=b,a.y=c,a;a.x*=this.con,a.y*=this.con,d=g*this.cons/(2*this.a*this.k0),c=this.con*hc(this.e,d),b=this.con*fc(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else e=2*Math.atan(g*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,g<=Gb?f=this.X0:(f=Math.asin(Math.cos(e)*this.sinX0+a.y*Math.sin(e)*this.cosX0/g),b=fc(this.long0+Math.atan2(a.x*Math.sin(e),g*this.cosX0*Math.cos(e)-a.y*this.sinX0*Math.sin(e)))),c=-1*hc(this.e,Math.tan(.5*(Cb+f)));return a.x=b,a.y=c,a}function qa(){var a=this.lat0;this.lambda0=this.long0;var b=Math.sin(a),c=this.a,d=this.rf,e=1/d,f=2*e-Math.pow(e,2),g=this.e=Math.sqrt(f);this.R=this.k0*c*Math.sqrt(1-f)/(1-f*Math.pow(b,2)),this.alpha=Math.sqrt(1+f/(1-f)*Math.pow(Math.cos(a),4)),this.b0=Math.asin(b/this.alpha);var h=Math.log(Math.tan(Math.PI/4+this.b0/2)),i=Math.log(Math.tan(Math.PI/4+a/2)),j=Math.log((1+g*b)/(1-g*b));this.K=h-this.alpha*i+this.alpha*g/2*j}function ra(a){var b=Math.log(Math.tan(Math.PI/4-a.y/2)),c=this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))),d=-this.alpha*(b+c)+this.K,e=2*(Math.atan(Math.exp(d))-Math.PI/4),f=this.alpha*(a.x-this.lambda0),g=Math.atan(Math.sin(f)/(Math.sin(this.b0)*Math.tan(e)+Math.cos(this.b0)*Math.cos(f))),h=Math.asin(Math.cos(this.b0)*Math.sin(e)-Math.sin(this.b0)*Math.cos(e)*Math.cos(f));return a.y=this.R/2*Math.log((1+Math.sin(h))/(1-Math.sin(h)))+this.y0,a.x=this.R*g+this.x0,a}function sa(a){for(var b=a.x-this.x0,c=a.y-this.y0,d=b/this.R,e=2*(Math.atan(Math.exp(c/this.R))-Math.PI/4),f=Math.asin(Math.cos(this.b0)*Math.sin(e)+Math.sin(this.b0)*Math.cos(e)*Math.cos(d)),g=Math.atan(Math.sin(d)/(Math.cos(this.b0)*Math.cos(d)-Math.sin(this.b0)*Math.tan(e))),h=this.lambda0+g/this.alpha,i=0,j=f,k=-1e3,l=0;Math.abs(j-k)>1e-7;){if(++l>20)return;i=1/this.alpha*(Math.log(Math.tan(Math.PI/4+f/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(j))/2)),k=j,j=2*Math.atan(Math.exp(i))-Math.PI/2}return a.x=h,a.y=j,a}function ta(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),b=Math.cos(this.lat0),c=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(b,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-c*c);var d=gc(this.e,this.lat0,a),e=this.bl/b*Math.sqrt((1-this.es)/(1-c*c));e*e<1&&(e=1);var f,g;if(isNaN(this.longc)){var h=gc(this.e,this.lat1,Math.sin(this.lat1)),i=gc(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(e+Math.sqrt(e*e-1))*Math.pow(d,this.bl):this.el=(e-Math.sqrt(e*e-1))*Math.pow(d,this.bl);var j=Math.pow(h,this.bl),k=Math.pow(i,this.bl);f=this.el/j,g=.5*(f-1/f);var l=(this.el*this.el-k*j)/(this.el*this.el+k*j),m=(k-j)/(k+j),n=fc(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(l*Math.tan(.5*this.bl*n)/m)/this.bl,this.long0=fc(this.long0);var o=fc(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*o)/g),this.alpha=Math.asin(e*Math.sin(this.gamma0))}else f=this.lat0>=0?e+Math.sqrt(e*e-1):e-Math.sqrt(e*e-1),this.el=f*Math.pow(d,this.bl),g=.5*(f-1/f),this.gamma0=Math.asin(Math.sin(this.alpha)/e),this.long0=this.longc-Math.asin(g*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(e*e-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(e*e-1),Math.cos(this.alpha))}function ua(a){var b,c,d,e=a.x,f=a.y,g=fc(e-this.long0);if(Math.abs(Math.abs(f)-Cb)<=Gb)d=f>0?-1:1,c=this.al/this.bl*Math.log(Math.tan(Jb+d*this.gamma0*.5)),b=-1*d*Cb*this.al/this.bl;else{var h=gc(this.e,f,Math.sin(f)),i=this.el/Math.pow(h,this.bl),j=.5*(i-1/i),k=.5*(i+1/i),l=Math.sin(this.bl*g),m=(j*Math.sin(this.gamma0)-l*Math.cos(this.gamma0))/k;c=Math.abs(Math.abs(m)-1)<=Gb?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-m)/(1+m))/this.bl,b=Math.abs(Math.cos(this.bl*g))<=Gb?this.al*this.bl*g:this.al*Math.atan2(j*Math.cos(this.gamma0)+l*Math.sin(this.gamma0),Math.cos(this.bl*g))/this.bl}return this.no_rot?(a.x=this.x0+b,a.y=this.y0+c):(b-=this.uc,a.x=this.x0+c*Math.cos(this.alpha)+b*Math.sin(this.alpha),a.y=this.y0+b*Math.cos(this.alpha)-c*Math.sin(this.alpha)),a}function va(a){var b,c;this.no_rot?(c=a.y-this.y0,b=a.x-this.x0):(c=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var d=Math.exp(-1*this.bl*c/this.al),e=.5*(d-1/d),f=.5*(d+1/d),g=Math.sin(this.bl*b/this.al),h=(g*Math.cos(this.gamma0)+e*Math.sin(this.gamma0))/f,i=Math.pow(this.el/Math.sqrt((1+h)/(1-h)),1/this.bl);return Math.abs(h-1)<Gb?(a.x=this.long0,a.y=Cb):Math.abs(h+1)<Gb?(a.x=this.long0,a.y=-1*Cb):(a.y=hc(this.e,i),a.x=fc(this.long0-Math.atan2(e*Math.cos(this.gamma0)-g*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl)),a}function wa(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Gb)){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var b=Math.sin(this.lat1),c=Math.cos(this.lat1),d=dc(this.e,b,c),e=gc(this.e,this.lat1,b),f=Math.sin(this.lat2),g=Math.cos(this.lat2),h=dc(this.e,f,g),i=gc(this.e,this.lat2,f),j=gc(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Gb?this.ns=Math.log(d/h)/Math.log(e/i):this.ns=b,isNaN(this.ns)&&(this.ns=b),this.f0=d/(this.ns*Math.pow(e,this.ns)),this.rh=this.a*this.f0*Math.pow(j,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function xa(a){var b=a.x,c=a.y;Math.abs(2*Math.abs(c)-Math.PI)<=Gb&&(c=ec(c)*(Cb-2*Gb));var d,e,f=Math.abs(Math.abs(c)-Cb);if(f>Gb)d=gc(this.e,c,Math.sin(c)),e=this.a*this.f0*Math.pow(d,this.ns);else{if(f=c*this.ns,f<=0)return null;e=0}var g=this.ns*fc(b-this.long0);return a.x=this.k0*(e*Math.sin(g))+this.x0,a.y=this.k0*(this.rh-e*Math.cos(g))+this.y0,a}function ya(a){var b,c,d,e,f,g=(a.x-this.x0)/this.k0,h=this.rh-(a.y-this.y0)/this.k0;this.ns>0?(b=Math.sqrt(g*g+h*h),c=1):(b=-Math.sqrt(g*g+h*h),c=-1);var i=0;if(0!==b&&(i=Math.atan2(c*g,c*h)),0!==b||this.ns>0){if(c=1/this.ns,d=Math.pow(b/(this.a*this.f0),c),e=hc(this.e,d),e===-9999)return null}else e=-Cb;return f=fc(i/this.ns+this.long0),a.x=f,a.y=e,a}function za(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Aa(a){var b,c,d,e,f,g,h,i=a.x,j=a.y,k=fc(i-this.long0);return b=Math.pow((1+this.e*Math.sin(j))/(1-this.e*Math.sin(j)),this.alfa*this.e/2),c=2*(Math.atan(this.k*Math.pow(Math.tan(j/2+this.s45),this.alfa)/b)-this.s45),d=-k*this.alfa,
e=Math.asin(Math.cos(this.ad)*Math.sin(c)+Math.sin(this.ad)*Math.cos(c)*Math.cos(d)),f=Math.asin(Math.cos(c)*Math.sin(d)/Math.cos(e)),g=this.n*f,h=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(e/2+this.s45),this.n),a.y=h*Math.cos(g)/1,a.x=h*Math.sin(g)/1,this.czech||(a.y*=-1,a.x*=-1),a}function Ba(a){var b,c,d,e,f,g,h,i,j=a.x;a.x=a.y,a.y=j,this.czech||(a.y*=-1,a.x*=-1),g=Math.sqrt(a.x*a.x+a.y*a.y),f=Math.atan2(a.y,a.x),e=f/Math.sin(this.s0),d=2*(Math.atan(Math.pow(this.ro0/g,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),b=Math.asin(Math.cos(this.ad)*Math.sin(d)-Math.sin(this.ad)*Math.cos(d)*Math.cos(e)),c=Math.asin(Math.cos(d)*Math.sin(e)/Math.cos(b)),a.x=this.long0-c/this.alfa,h=b,i=0;var k=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.e/2))-this.s45),Math.abs(h-a.y)<1e-10&&(i=1),h=a.y,k+=1;while(0===i&&k<15);return k>=15?null:a}function Ca(){this.sphere||(this.e0=Cd(this.es),this.e1=Dd(this.es),this.e2=Ed(this.es),this.e3=Fd(this.es),this.ml0=this.a*Bd(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Da(a){var b,c,d=a.x,e=a.y;if(d=fc(d-this.long0),this.sphere)b=this.a*Math.asin(Math.cos(e)*Math.sin(d)),c=this.a*(Math.atan2(Math.tan(e),Math.cos(d))-this.lat0);else{var f=Math.sin(e),g=Math.cos(e),h=Gd(this.a,this.e,f),i=Math.tan(e)*Math.tan(e),j=d*Math.cos(e),k=j*j,l=this.es*g*g/(1-this.es),m=this.a*Bd(this.e0,this.e1,this.e2,this.e3,e);b=h*j*(1-k*i*(1/6-(8-i+8*l)*k/120)),c=m-this.ml0+h*f/g*k*(.5+(5-i+6*l)*k/24)}return a.x=b+this.x0,a.y=c+this.y0,a}function Ea(a){a.x-=this.x0,a.y-=this.y0;var b,c,d=a.x/this.a,e=a.y/this.a;if(this.sphere){var f=e+this.lat0;b=Math.asin(Math.sin(f)*Math.cos(d)),c=Math.atan2(Math.tan(d),Math.cos(f))}else{var g=this.ml0/this.a+e,h=Id(g,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(h)-Cb)<=Gb)return a.x=this.long0,a.y=Cb,e<0&&(a.y*=-1),a;var i=Gd(this.a,this.e,Math.sin(h)),j=i*i*i/this.a/this.a*(1-this.es),k=Math.pow(Math.tan(h),2),l=d*this.a/i,m=l*l;b=h-i*Math.tan(h)/j*l*l*(.5-(1+3*k)*l*l/24),c=l*(1-m*(k/3+(1+3*k)*k*m/15))/Math.cos(h)}return a.x=fc(c+this.long0),a.y=Hd(b),a}function Fa(){var a=Math.abs(this.lat0);if(Math.abs(a-Cb)<Gb?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(a)<Gb?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var b;switch(this.qp=Ld(this.e,1),this.mmf=.5/(1-this.es),this.apa=Ia(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),b=Math.sin(this.lat0),this.sinb1=Ld(this.e,b)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*b*b)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Ga(a){var b,c,d,e,f,g,h,i,j,k,l=a.x,m=a.y;if(l=fc(l-this.long0),this.sphere){if(f=Math.sin(m),k=Math.cos(m),d=Math.cos(l),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c=this.mode===this.EQUIT?1+k*d:1+this.sinph0*f+this.cosph0*k*d,c<=Gb)return null;c=Math.sqrt(2/c),b=c*k*Math.sin(l),c*=this.mode===this.EQUIT?f:this.cosph0*f-this.sinph0*k*d}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(d=-d),Math.abs(m+this.phi0)<Gb)return null;c=Jb-.5*m,c=2*(this.mode===this.S_POLE?Math.cos(c):Math.sin(c)),b=c*Math.sin(l),c*=d}}else{switch(h=0,i=0,j=0,d=Math.cos(l),e=Math.sin(l),f=Math.sin(m),g=Ld(this.e,f),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(h=g/this.qp,i=Math.sqrt(1-h*h)),this.mode){case this.OBLIQ:j=1+this.sinb1*h+this.cosb1*i*d;break;case this.EQUIT:j=1+i*d;break;case this.N_POLE:j=Cb+m,g=this.qp-g;break;case this.S_POLE:j=m-Cb,g=this.qp+g}if(Math.abs(j)<Gb)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:j=Math.sqrt(2/j),c=this.mode===this.OBLIQ?this.ymf*j*(this.cosb1*h-this.sinb1*i*d):(j=Math.sqrt(2/(1+i*d)))*h*this.ymf,b=this.xmf*j*i*e;break;case this.N_POLE:case this.S_POLE:g>=0?(b=(j=Math.sqrt(g))*e,c=d*(this.mode===this.S_POLE?j:-j)):b=c=0}}return a.x=this.a*b+this.x0,a.y=this.a*c+this.y0,a}function Ha(a){a.x-=this.x0,a.y-=this.y0;var b,c,d,e,f,g,h,i=a.x/this.a,j=a.y/this.a;if(this.sphere){var k,l=0,m=0;if(k=Math.sqrt(i*i+j*j),c=.5*k,c>1)return null;switch(c=2*Math.asin(c),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(m=Math.sin(c),l=Math.cos(c)),this.mode){case this.EQUIT:c=Math.abs(k)<=Gb?0:Math.asin(j*m/k),i*=m,j=l*k;break;case this.OBLIQ:c=Math.abs(k)<=Gb?this.phi0:Math.asin(l*this.sinph0+j*m*this.cosph0/k),i*=m*this.cosph0,j=(l-Math.sin(c)*this.sinph0)*k;break;case this.N_POLE:j=-j,c=Cb-c;break;case this.S_POLE:c-=Cb}b=0!==j||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(i,j):0}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(i/=this.dd,j*=this.dd,g=Math.sqrt(i*i+j*j),g<Gb)return a.x=0,a.y=this.phi0,a;e=2*Math.asin(.5*g/this.rq),d=Math.cos(e),i*=e=Math.sin(e),this.mode===this.OBLIQ?(h=d*this.sinb1+j*e*this.cosb1/g,f=this.qp*h,j=g*this.cosb1*d-j*this.sinb1*e):(h=j*e/g,f=this.qp*h,j=g*d)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(j=-j),f=i*i+j*j,!f)return a.x=0,a.y=this.phi0,a;h=1-f/this.qp,this.mode===this.S_POLE&&(h=-h)}b=Math.atan2(i,j),c=Ja(Math.asin(h),this.apa)}return a.x=fc(this.long0+b),a.y=c,a}function Ia(a){var b,c=[];return c[0]=a*Qd,b=a*a,c[0]+=b*Rd,c[1]=b*Td,b*=a,c[0]+=b*Sd,c[1]+=b*Ud,c[2]=b*Vd,c}function Ja(a,b){var c=a+a;return a+b[0]*Math.sin(c)+b[1]*Math.sin(c+c)+b[2]*Math.sin(c+c+c)}function Ka(){Math.abs(this.lat1+this.lat2)<Gb||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=dc(this.e3,this.sin_po,this.cos_po),this.qs1=Ld(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=dc(this.e3,this.sin_po,this.cos_po),this.qs2=Ld(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Ld(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>Gb?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function La(a){var b=a.x,c=a.y;this.sin_phi=Math.sin(c),this.cos_phi=Math.cos(c);var d=Ld(this.e3,this.sin_phi,this.cos_phi),e=this.a*Math.sqrt(this.c-this.ns0*d)/this.ns0,f=this.ns0*fc(b-this.long0),g=e*Math.sin(f)+this.x0,h=this.rh-e*Math.cos(f)+this.y0;return a.x=g,a.y=h,a}function Ma(a){var b,c,d,e,f,g;return a.x-=this.x0,a.y=this.rh-a.y+this.y0,this.ns0>=0?(b=Math.sqrt(a.x*a.x+a.y*a.y),d=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),d=-1),e=0,0!==b&&(e=Math.atan2(d*a.x,d*a.y)),d=b*this.ns0/this.a,this.sphere?g=Math.asin((this.c-d*d)/(2*this.ns0)):(c=(this.c-d*d)/this.ns0,g=this.phi1z(this.e3,c)),f=fc(e/this.ns0+this.long0),a.x=f,a.y=g,a}function Na(a,b){var c,d,e,f,g,h=Yd(.5*b);if(a<Gb)return h;for(var i=a*a,j=1;j<=25;j++)if(c=Math.sin(h),d=Math.cos(h),e=a*c,f=1-e*e,g=.5*f*f/d*(b/(1-i)-c/f+.5/a*Math.log((1-e)/(1+e))),h+=g,Math.abs(g)<=1e-7)return h;return null}function Oa(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Pa(a){var b,c,d,e,f,g,h,i,j=a.x,k=a.y;return d=fc(j-this.long0),b=Math.sin(k),c=Math.cos(k),e=Math.cos(d),g=this.sin_p14*b+this.cos_p14*c*e,f=1,g>0||Math.abs(g)<=Gb?(h=this.x0+this.a*f*c*Math.sin(d)/g,i=this.y0+this.a*f*(this.cos_p14*b-this.sin_p14*c*e)/g):(h=this.x0+this.infinity_dist*c*Math.sin(d),i=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*c*e)),a.x=h,a.y=i,a}function Qa(a){var b,c,d,e,f,g;return a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,(b=Math.sqrt(a.x*a.x+a.y*a.y))?(e=Math.atan2(b,this.rc),c=Math.sin(e),d=Math.cos(e),g=Yd(d*this.sin_p14+a.y*c*this.cos_p14/b),f=Math.atan2(a.x*c,b*this.cos_p14*d-a.y*this.sin_p14*c),f=fc(this.long0+f)):(g=this.phic0,f=0),a.x=f,a.y=g,a}function Ra(){this.sphere||(this.k0=dc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Sa(a){var b,c,d=a.x,e=a.y,f=fc(d-this.long0);if(this.sphere)b=this.x0+this.a*f*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(e)/Math.cos(this.lat_ts);else{var g=Ld(this.e,Math.sin(e));b=this.x0+this.a*this.k0*f,c=this.y0+this.a*g*.5/this.k0}return a.x=b,a.y=c,a}function Ta(a){a.x-=this.x0,a.y-=this.y0;var b,c;return this.sphere?(b=fc(this.long0+a.x/this.a/Math.cos(this.lat_ts)),c=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(c=be(this.e,2*a.y*this.k0/this.a),b=fc(this.long0+a.x/(this.a*this.k0))),a.x=b,a.y=c,a}function Ua(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Va(a){var b=a.x,c=a.y,d=fc(b-this.long0),e=Hd(c-this.lat0);return a.x=this.x0+this.a*d*this.rc,a.y=this.y0+this.a*e,a}function Wa(a){var b=a.x,c=a.y;return a.x=fc(this.long0+(b-this.x0)/(this.a*this.rc)),a.y=Hd(this.lat0+(c-this.y0)/this.a),a}function Xa(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Cd(this.es),this.e1=Dd(this.es),this.e2=Ed(this.es),this.e3=Fd(this.es),this.ml0=this.a*Bd(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Ya(a){var b,c,d,e=a.x,f=a.y,g=fc(e-this.long0);if(d=g*Math.sin(f),this.sphere)Math.abs(f)<=Gb?(b=this.a*g,c=-1*this.a*this.lat0):(b=this.a*Math.sin(d)/Math.tan(f),c=this.a*(Hd(f-this.lat0)+(1-Math.cos(d))/Math.tan(f)));else if(Math.abs(f)<=Gb)b=this.a*g,c=-1*this.ml0;else{var h=Gd(this.a,this.e,Math.sin(f))/Math.tan(f);b=h*Math.sin(d),c=this.a*Bd(this.e0,this.e1,this.e2,this.e3,f)-this.ml0+h*(1-Math.cos(d))}return a.x=b+this.x0,a.y=c+this.y0,a}function Za(a){var b,c,d,e,f,g,h,i,j;if(d=a.x-this.x0,e=a.y-this.y0,this.sphere)if(Math.abs(e+this.a*this.lat0)<=Gb)b=fc(d/this.a+this.long0),c=0;else{g=this.lat0+e/this.a,h=d*d/this.a/this.a+g*g,i=g;var k;for(f=ge;f;--f)if(k=Math.tan(i),j=-1*(g*(i*k+1)-i-.5*(i*i+h)*k)/((i-g)/k-1),i+=j,Math.abs(j)<=Gb){c=i;break}b=fc(this.long0+Math.asin(d*Math.tan(i)/this.a)/Math.sin(c))}else if(Math.abs(e+this.ml0)<=Gb)c=0,b=fc(this.long0+d/this.a);else{g=(this.ml0+e)/this.a,h=d*d/this.a/this.a+g*g,i=g;var l,m,n,o,p;for(f=ge;f;--f)if(p=this.e*Math.sin(i),l=Math.sqrt(1-p*p)*Math.tan(i),m=this.a*Bd(this.e0,this.e1,this.e2,this.e3,i),n=this.e0-2*this.e1*Math.cos(2*i)+4*this.e2*Math.cos(4*i)-6*this.e3*Math.cos(6*i),o=m/this.a,j=(g*(l*o+1)-o-.5*l*(o*o+h))/(this.es*Math.sin(2*i)*(o*o+h-2*g*o)/(4*l)+(g-o)*(l*n-2/Math.sin(2*i))-n),i-=j,Math.abs(j)<=Gb){c=i;break}l=Math.sqrt(1-this.es*Math.pow(Math.sin(c),2))*Math.tan(c),b=fc(this.long0+Math.asin(d*l/this.a)/Math.sin(c))}return a.x=b,a.y=c,a}function $a(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function _a(a){var b,c=a.x,d=a.y,e=d-this.lat0,f=c-this.long0,g=e/Bb*1e-5,h=f,i=1,j=0;for(b=1;b<=10;b++)i*=g,j+=this.A[b]*i;var k,l,m=j,n=h,o=1,p=0,q=0,r=0;for(b=1;b<=6;b++)k=o*m-p*n,l=p*m+o*n,o=k,p=l,q=q+this.B_re[b]*o-this.B_im[b]*p,r=r+this.B_im[b]*o+this.B_re[b]*p;return a.x=r*this.a+this.x0,a.y=q*this.a+this.y0,a}function ab(a){var b,c,d,e=a.x,f=a.y,g=e-this.x0,h=f-this.y0,i=h/this.a,j=g/this.a,k=1,l=0,m=0,n=0;for(b=1;b<=6;b++)c=k*i-l*j,d=l*i+k*j,k=c,l=d,m=m+this.C_re[b]*k-this.C_im[b]*l,n=n+this.C_im[b]*k+this.C_re[b]*l;for(var o=0;o<this.iterations;o++){var p,q,r=m,s=n,t=i,u=j;for(b=2;b<=6;b++)p=r*m-s*n,q=s*m+r*n,r=p,s=q,t+=(b-1)*(this.B_re[b]*r-this.B_im[b]*s),u+=(b-1)*(this.B_im[b]*r+this.B_re[b]*s);r=1,s=0;var v=this.B_re[1],w=this.B_im[1];for(b=2;b<=6;b++)p=r*m-s*n,q=s*m+r*n,r=p,s=q,v+=b*(this.B_re[b]*r-this.B_im[b]*s),w+=b*(this.B_im[b]*r+this.B_re[b]*s);var x=v*v+w*w;m=(t*v+u*w)/x,n=(u*v-t*w)/x}var y=m,z=n,A=1,B=0;for(b=1;b<=9;b++)A*=y,B+=this.D[b]*A;var C=this.lat0+B*Bb*1e5,D=this.long0+z;return a.x=D,a.y=C,a}function bb(){}function cb(a){var b=a.x,c=a.y,d=fc(b-this.long0),e=this.x0+this.a*d,f=this.y0+this.a*Math.log(Math.tan(Math.PI/4+c/2.5))*1.25;return a.x=e,a.y=f,a}function db(a){a.x-=this.x0,a.y-=this.y0;var b=fc(this.long0+a.x/this.a),c=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);return a.x=b,a.y=c,a}function eb(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Tc(this.es)}function fb(a){var b,c,d=a.x,e=a.y;if(d=fc(d-this.long0),this.sphere){if(this.m)for(var f=this.n*Math.sin(e),g=ne;g;--g){var h=(this.m*e+Math.sin(e)-f)/(this.m+Math.cos(e));if(e-=h,Math.abs(h)<Gb)break}else e=1!==this.n?Math.asin(this.n*Math.sin(e)):e;b=this.a*this.C_x*d*(this.m+Math.cos(e)),c=this.a*this.C_y*e}else{var i=Math.sin(e),j=Math.cos(e);c=this.a*Uc(e,i,j,this.en),b=this.a*d*j/Math.sqrt(1-this.es*i*i)}return a.x=b,a.y=c,a}function gb(a){var b,c,d,e;return a.x-=this.x0,d=a.x/this.a,a.y-=this.y0,b=a.y/this.a,this.sphere?(b/=this.C_y,d/=this.C_x*(this.m+Math.cos(b)),this.m?b=Yd((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=Yd(Math.sin(b)/this.n)),d=fc(d+this.long0),b=Hd(b)):(b=Wc(a.y/this.a,this.es,this.en),e=Math.abs(b),e<Cb?(e=Math.sin(b),c=this.long0+a.x*Math.sqrt(1-this.es*e*e)/(this.a*Math.cos(b)),d=fc(c)):e-Gb<Cb&&(d=this.long0)),a.x=d,a.y=b,a}function hb(){}function ib(a){for(var b=a.x,c=a.y,d=fc(b-this.long0),e=c,f=Math.PI*Math.sin(c),g=0;!0;g++){var h=-(e+Math.sin(e)-f)/(1+Math.cos(e));if(e+=h,Math.abs(h)<Gb)break}e/=2,Math.PI/2-Math.abs(c)<Gb&&(d=0);var i=.900316316158*this.a*d*Math.cos(e)+this.x0,j=1.4142135623731*this.a*Math.sin(e)+this.y0;return a.x=i,a.y=j,a}function jb(a){var b,c;a.x-=this.x0,a.y-=this.y0,c=a.y/(1.4142135623731*this.a),Math.abs(c)>.999999999999&&(c=.999999999999),b=Math.asin(c);var d=fc(this.long0+a.x/(.900316316158*this.a*Math.cos(b)));d<-Math.PI&&(d=-Math.PI),d>Math.PI&&(d=Math.PI),c=(2*b+Math.sin(2*b))/Math.PI,Math.abs(c)>1&&(c=1);var e=Math.asin(c);return a.x=d,a.y=e,a}function kb(){Math.abs(this.lat1+this.lat2)<Gb||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Cd(this.es),this.e1=Dd(this.es),this.e2=Ed(this.es),this.e3=Fd(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=dc(this.e,this.sinphi,this.cosphi),this.ml1=Bd(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Gb?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=dc(this.e,this.sinphi,this.cosphi),this.ml2=Bd(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Bd(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function lb(a){var b,c=a.x,d=a.y;if(this.sphere)b=this.a*(this.g-d);else{var e=Bd(this.e0,this.e1,this.e2,this.e3,d);b=this.a*(this.g-e)}var f=this.ns*fc(c-this.long0),g=this.x0+b*Math.sin(f),h=this.y0+this.rh-b*Math.cos(f);return a.x=g,a.y=h,a}function mb(a){a.x-=this.x0,a.y=this.rh-a.y+this.y0;var b,c,d,e;this.ns>=0?(c=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(c=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);var f=0;if(0!==c&&(f=Math.atan2(b*a.x,b*a.y)),this.sphere)return e=fc(this.long0+f/this.ns),d=Hd(this.g-c/this.a),a.x=e,a.y=d,a;var g=this.g-c/this.a;return d=Id(g,this.e0,this.e1,this.e2,this.e3),e=fc(this.long0+f/this.ns),a.x=e,a.y=d,a}function nb(){this.R=this.a}function ob(a){var b,c,d=a.x,e=a.y,f=fc(d-this.long0);Math.abs(e)<=Gb&&(b=this.x0+this.R*f,c=this.y0);var g=Yd(2*Math.abs(e/Math.PI));(Math.abs(f)<=Gb||Math.abs(Math.abs(e)-Cb)<=Gb)&&(b=this.x0,c=e>=0?this.y0+Math.PI*this.R*Math.tan(.5*g):this.y0+Math.PI*this.R*-Math.tan(.5*g));var h=.5*Math.abs(Math.PI/f-f/Math.PI),i=h*h,j=Math.sin(g),k=Math.cos(g),l=k/(j+k-1),m=l*l,n=l*(2/j-1),o=n*n,p=Math.PI*this.R*(h*(l-o)+Math.sqrt(i*(l-o)*(l-o)-(o+i)*(m-o)))/(o+i);f<0&&(p=-p),b=this.x0+p;var q=i+l;return p=Math.PI*this.R*(n*q-h*Math.sqrt((o+i)*(i+1)-q*q))/(o+i),c=e>=0?this.y0+p:this.y0-p,a.x=b,a.y=c,a}function pb(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;return a.x-=this.x0,a.y-=this.y0,l=Math.PI*this.R,d=a.x/l,e=a.y/l,f=d*d+e*e,g=-Math.abs(e)*(1+f),h=g-2*e*e+d*d,i=-2*g+1+2*e*e+f*f,n=e*e/i+(2*h*h*h/i/i/i-9*g*h/i/i)/27,j=(g-h*h/3/i)/i,k=2*Math.sqrt(-j/3),l=3*n/j/k,Math.abs(l)>1&&(l=l>=0?1:-1),m=Math.acos(l)/3,c=a.y>=0?(-k*Math.cos(m+Math.PI/3)-h/3/i)*Math.PI:-(-k*Math.cos(m+Math.PI/3)-h/3/i)*Math.PI,b=Math.abs(d)<Gb?this.long0:fc(this.long0+Math.PI*(f-1+Math.sqrt(1+2*(d*d-e*e)+f*f))/2/d),a.x=b,a.y=c,a}function qb(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function rb(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=a.x,z=a.y,A=Math.sin(a.y),B=Math.cos(a.y),C=fc(y-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=Gb?(a.x=this.x0+this.a*(Cb-z)*Math.sin(C),a.y=this.y0-this.a*(Cb-z)*Math.cos(C),a):Math.abs(this.sin_p12+1)<=Gb?(a.x=this.x0+this.a*(Cb+z)*Math.sin(C),a.y=this.y0+this.a*(Cb+z)*Math.cos(C),a):(s=this.sin_p12*A+this.cos_p12*B*Math.cos(C),q=Math.acos(s),r=q/Math.sin(q),a.x=this.x0+this.a*r*B*Math.sin(C),a.y=this.y0+this.a*r*(this.cos_p12*A-this.sin_p12*B*Math.cos(C)),a):(b=Cd(this.es),c=Dd(this.es),d=Ed(this.es),e=Fd(this.es),Math.abs(this.sin_p12-1)<=Gb?(f=this.a*Bd(b,c,d,e,Cb),g=this.a*Bd(b,c,d,e,z),a.x=this.x0+(f-g)*Math.sin(C),a.y=this.y0-(f-g)*Math.cos(C),a):Math.abs(this.sin_p12+1)<=Gb?(f=this.a*Bd(b,c,d,e,Cb),g=this.a*Bd(b,c,d,e,z),a.x=this.x0+(f+g)*Math.sin(C),a.y=this.y0+(f+g)*Math.cos(C),a):(h=A/B,i=Gd(this.a,this.e,this.sin_p12),j=Gd(this.a,this.e,A),k=Math.atan((1-this.es)*h+this.es*i*this.sin_p12/(j*B)),l=Math.atan2(Math.sin(C),this.cos_p12*Math.tan(k)-this.sin_p12*Math.cos(C)),t=0===l?Math.asin(this.cos_p12*Math.sin(k)-this.sin_p12*Math.cos(k)):Math.abs(Math.abs(l)-Math.PI)<=Gb?-Math.asin(this.cos_p12*Math.sin(k)-this.sin_p12*Math.cos(k)):Math.asin(Math.sin(C)*Math.cos(k)/Math.sin(l)),m=this.e*this.sin_p12/Math.sqrt(1-this.es),n=this.e*this.cos_p12*Math.cos(l)/Math.sqrt(1-this.es),o=m*n,p=n*n,u=t*t,v=u*t,w=v*t,x=w*t,q=i*t*(1-u*p*(1-p)/6+v/8*o*(1-2*p)+w/120*(p*(4-7*p)-3*m*m*(1-7*p))-x/48*o),a.x=this.x0+q*Math.sin(l),a.y=this.y0+q*Math.cos(l),a))}function sb(a){a.x-=this.x0,a.y-=this.y0;var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;if(this.sphere){if(b=Math.sqrt(a.x*a.x+a.y*a.y),b>2*Cb*this.a)return;return c=b/this.a,d=Math.sin(c),e=Math.cos(c),f=this.long0,Math.abs(b)<=Gb?g=this.lat0:(g=Yd(e*this.sin_p12+a.y*d*this.cos_p12/b),h=Math.abs(this.lat0)-Cb,f=fc(Math.abs(h)<=Gb?this.lat0>=0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y):this.long0+Math.atan2(a.x*d,b*this.cos_p12*e-a.y*this.sin_p12*d))),a.x=f,a.y=g,a}return i=Cd(this.es),j=Dd(this.es),k=Ed(this.es),l=Fd(this.es),Math.abs(this.sin_p12-1)<=Gb?(m=this.a*Bd(i,j,k,l,Cb),b=Math.sqrt(a.x*a.x+a.y*a.y),n=m-b,g=Id(n/this.a,i,j,k,l),f=fc(this.long0+Math.atan2(a.x,-1*a.y)),a.x=f,a.y=g,a):Math.abs(this.sin_p12+1)<=Gb?(m=this.a*Bd(i,j,k,l,Cb),b=Math.sqrt(a.x*a.x+a.y*a.y),n=b-m,g=Id(n/this.a,i,j,k,l),f=fc(this.long0+Math.atan2(a.x,a.y)),a.x=f,a.y=g,a):(b=Math.sqrt(a.x*a.x+a.y*a.y),q=Math.atan2(a.x,a.y),o=Gd(this.a,this.e,this.sin_p12),r=Math.cos(q),s=this.e*this.cos_p12*r,t=-s*s/(1-this.es),u=3*this.es*(1-t)*this.sin_p12*this.cos_p12*r/(1-this.es),v=b/o,w=v-t*(1+t)*Math.pow(v,3)/6-u*(1+3*t)*Math.pow(v,4)/24,x=1-t*w*w/2-v*w*w*w/6,p=Math.asin(this.sin_p12*Math.cos(w)+this.cos_p12*Math.sin(w)*r),f=fc(this.long0+Math.asin(Math.sin(q)*Math.sin(w)/Math.cos(p))),g=Math.atan((1-this.es*x*this.sin_p12/Math.sin(p))*Math.tan(p)/(1-this.es)),a.x=f,a.y=g,a)}function tb(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function ub(a){var b,c,d,e,f,g,h,i,j=a.x,k=a.y;return d=fc(j-this.long0),b=Math.sin(k),c=Math.cos(k),e=Math.cos(d),g=this.sin_p14*b+this.cos_p14*c*e,f=1,(g>0||Math.abs(g)<=Gb)&&(h=this.a*f*c*Math.sin(d),i=this.y0+this.a*f*(this.cos_p14*b-this.sin_p14*c*e)),a.x=h,a.y=i,a}function vb(a){var b,c,d,e,f,g,h;return a.x-=this.x0,a.y-=this.y0,b=Math.sqrt(a.x*a.x+a.y*a.y),c=Yd(b/this.a),d=Math.sin(c),e=Math.cos(c),g=this.long0,Math.abs(b)<=Gb?(h=this.lat0,a.x=g,a.y=h,a):(h=Yd(e*this.sin_p14+a.y*d*this.cos_p14/b),f=Math.abs(this.lat0)-Cb,Math.abs(f)<=Gb?(g=fc(this.lat0>=0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y)),a.x=g,a.y=h,a):(g=fc(this.long0+Math.atan2(a.x*d,b*this.cos_p14*e-a.y*this.sin_p14*d)),a.x=g,a.y=h,a))}var wb=function(a){a("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),a("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),a("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),a.WGS84=a["EPSG:4326"],a["EPSG:3785"]=a["EPSG:3857"],a.GOOGLE=a["EPSG:3857"],a["EPSG:900913"]=a["EPSG:3857"],a["EPSG:102113"]=a["EPSG:3857"]},xb=1,yb=2,zb=4,Ab=5,Bb=484813681109536e-20,Cb=Math.PI/2,Db=.16666666666666666,Eb=.04722222222222222,Fb=.022156084656084655,Gb="undefined"==typeof Number.EPSILON?1e-10:Number.EPSILON,Hb=.017453292519943295,Ib=57.29577951308232,Jb=Math.PI/4,Kb=2*Math.PI,Lb=3.14159265359,Mb={};Mb.greenwich=0,Mb.lisbon=-9.131906111111,Mb.paris=2.337229166667,Mb.bogota=-74.080916666667,Mb.madrid=-3.687938888889,Mb.rome=12.452333333333,Mb.bern=7.439583333333,Mb.jakarta=106.807719444444,Mb.ferro=-17.666666666667,Mb.brussels=4.367975,Mb.stockholm=18.058277777778,Mb.athens=23.7163375,Mb.oslo=10.722916666667;var Nb={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},Ob=/[\s_\-\/\(\)]/g,Pb=function(b){var c,d,e,f={},g=b.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,b){var c=b.split("=");return c.push(!0),a[c[0].toLowerCase()]=c[1],a},{}),h={proj:"projName",datum:"datumCode",rf:function(a){f.rf=parseFloat(a)},lat_0:function(a){f.lat0=a*Hb},lat_1:function(a){f.lat1=a*Hb},lat_2:function(a){f.lat2=a*Hb},lat_ts:function(a){f.lat_ts=a*Hb},lon_0:function(a){f.long0=a*Hb},lon_1:function(a){f.long1=a*Hb},lon_2:function(a){f.long2=a*Hb},alpha:function(a){f.alpha=parseFloat(a)*Hb},lonc:function(a){f.longc=a*Hb},x_0:function(a){f.x0=parseFloat(a)},y_0:function(a){f.y0=parseFloat(a)},k_0:function(a){f.k0=parseFloat(a)},k:function(a){f.k0=parseFloat(a)},a:function(a){f.a=parseFloat(a)},b:function(a){f.b=parseFloat(a)},r_a:function(){f.R_A=!0},zone:function(a){f.zone=parseInt(a,10)},south:function(){f.utmSouth=!0},towgs84:function(a){f.datum_params=a.split(",").map(function(a){return parseFloat(a)})},to_meter:function(a){f.to_meter=parseFloat(a)},units:function(b){f.units=b;var c=a(Nb,b);c&&(f.to_meter=c.to_meter)},from_greenwich:function(a){f.from_greenwich=a*Hb},pm:function(b){var c=a(Mb,b);f.from_greenwich=(c?c:parseFloat(b))*Hb},nadgrids:function(a){"@null"===a?f.datumCode="none":f.nadgrids=a},axis:function(a){var b="ewnsud";3===a.length&&b.indexOf(a.substr(0,1))!==-1&&b.indexOf(a.substr(1,1))!==-1&&b.indexOf(a.substr(2,1))!==-1&&(f.axis=a)}};for(c in g)d=g[c],c in h?(e=h[c],"function"==typeof e?e(d):f[e]=d):f[c]=d;return"string"==typeof f.datumCode&&"WGS84"!==f.datumCode&&(f.datumCode=f.datumCode.toLowerCase()),f},Qb=1,Rb=2,Sb=3,Tb=4,Ub=5,Vb=-1,Wb=/\s/,Xb=/[A-Za-z]/,Yb=/[A-Za-z84]/,Zb=/[,\]]/,$b=/[\d\.E\-\+]/;b.prototype.readCharicter=function(){var a=this.text[this.place++];if(this.state!==Tb)for(;Wb.test(a);){if(this.place>=this.text.length)return;a=this.text[this.place++]}switch(this.state){case Qb:return this.neutral(a);case Rb:return this.keyword(a);case Tb:return this.quoted(a);case Ub:return this.afterquote(a);case Sb:return this.number(a);case Vb:return}},b.prototype.afterquote=function(a){if('"'===a)return this.word+='"',void(this.state=Tb);if(Zb.test(a))return this.word=this.word.trim(),void this.afterItem(a);throw new Error("havn't handled \""+a+'" in afterquote yet, index '+this.place)},b.prototype.afterItem=function(a){return","===a?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=Qb)):"]"===a?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=Qb,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=Vb))):void 0},b.prototype.number=function(a){if($b.test(a))return void(this.word+=a);if(Zb.test(a))return this.word=parseFloat(this.word),void this.afterItem(a);throw new Error("havn't handled \""+a+'" in number yet, index '+this.place)},b.prototype.quoted=function(a){return'"'===a?void(this.state=Ub):void(this.word+=a)},b.prototype.keyword=function(a){if(Yb.test(a))return void(this.word+=a);if("["===a){var b=[];return b.push(this.word),this.level++,null===this.root?this.root=b:this.currentObject.push(b),this.stack.push(this.currentObject),this.currentObject=b,void(this.state=Qb)}if(Zb.test(a))return void this.afterItem(a);throw new Error("havn't handled \""+a+'" in keyword yet, index '+this.place)},b.prototype.neutral=function(a){if(Xb.test(a))return this.word=a,void(this.state=Rb);if('"'===a)return this.word="",void(this.state=Tb);if($b.test(a))return this.word=a,void(this.state=Sb);if(Zb.test(a))return void this.afterItem(a);throw new Error("havn't handled \""+a+'" in neutral yet, index '+this.place)},b.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===Vb)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var _b=.017453292519943295,ac=function(a){var b=c(a),d=b.shift(),f=b.shift();b.unshift(["name",f]),b.unshift(["type",d]);var g={};return e(b,g),h(g),g};wb(i);var bc=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],cc=function(a,b){a=a||{};var c,d;if(!b)return a;for(d in b)c=b[d],void 0!==c&&(a[d]=c);return a},dc=function(a,b,c){var d=a*b;return c/Math.sqrt(1-d*d)},ec=function(a){return a<0?-1:1},fc=function(a){return Math.abs(a)<=Lb?a:a-ec(a)*Kb},gc=function(a,b,c){var d=a*c,e=.5*a;return d=Math.pow((1-d)/(1+d),e),Math.tan(.5*(Cb-b))/d},hc=function(a,b){for(var c,d,e=.5*a,f=Cb-2*Math.atan(b),g=0;g<=15;g++)if(c=a*Math.sin(f),d=Cb-2*Math.atan(b*Math.pow((1-c)/(1+c),e))-f,f+=d,Math.abs(d)<=1e-10)return f;return-9999},ic=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"],jc={init:o,forward:p,inverse:q,names:ic},kc=["longlat","identity"],lc={init:r,forward:s,inverse:s,names:kc},mc=[jc,lc],nc={},oc=[],pc={start:v,add:t,get:u},qc={};qc.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},qc.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},qc.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},qc.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},qc.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},qc.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},qc.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},qc.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},qc.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},qc.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},qc.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},qc.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},qc.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},qc.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},qc.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},qc.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},qc.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},qc.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},qc.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},qc.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},qc.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},qc.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},qc.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},qc.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},qc.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},qc.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},qc.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},qc.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},qc.hough={a:6378270,rf:297,ellipseName:"Hough"},qc.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},qc.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},qc.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},qc.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},qc.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},qc.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},qc.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},qc.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},qc.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},qc.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},qc.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},qc.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var rc=qc.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};qc.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var sc={};sc.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},sc.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},sc.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},sc.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},sc.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},sc.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},sc.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},sc.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},sc.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},sc.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},sc.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},sc.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},sc.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},sc.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},sc.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},sc.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},z.projections=pc,z.projections.start();
var tc=function(a,b,c){return A(a,b)?c:a.datum_type===Ab||b.datum_type===Ab?c:a.es!==b.es||a.a!==b.a||F(a.datum_type)||F(b.datum_type)?(c=B(c,a.es,a.a),F(a.datum_type)&&(c=D(c,a.datum_type,a.datum_params)),F(b.datum_type)&&(c=E(c,b.datum_type,b.datum_params)),C(c,b.es,b.a,b.b)):c},uc=function(a,b,c){var d,e,f,g=c.x,h=c.y,i=c.z||0,j={};for(f=0;f<3;f++)if(!b||2!==f||void 0!==c.z)switch(0===f?(d=g,e="x"):1===f?(d=h,e="y"):(d=i,e="z"),a.axis[f]){case"e":j[e]=d;break;case"w":j[e]=-d;break;case"n":j[e]=d;break;case"s":j[e]=-d;break;case"u":void 0!==c[e]&&(j.z=d);break;case"d":void 0!==c[e]&&(j.z=-d);break;default:return null}return j},vc=function(a){var b={x:a[0],y:a[1]};return a.length>2&&(b.z=a[2]),a.length>3&&(b.m=a[3]),b},wc=z("WGS84"),xc=6,yc="AJSAJS",zc="AFAFAF",Ac=65,Bc=73,Cc=79,Dc=86,Ec=90,Fc={forward:L,inverse:M,toPoint:N};Point.fromMGRS=function(a){return new Point(N(a))},Point.prototype.toMGRS=function(a){return L([this.x,this.y],a)};var Gc="2.4.3",Hc=1,Ic=.25,Jc=.046875,Kc=.01953125,Lc=.01068115234375,Mc=.75,Nc=.46875,Oc=.013020833333333334,Pc=.007120768229166667,Qc=.3645833333333333,Rc=.005696614583333333,Sc=.3076171875,Tc=function(a){var b=[];b[0]=Hc-a*(Ic+a*(Jc+a*(Kc+a*Lc))),b[1]=a*(Mc-a*(Jc+a*(Kc+a*Lc)));var c=a*a;return b[2]=c*(Nc-a*(Oc+a*Pc)),c*=a,b[3]=c*(Qc-a*Rc),b[4]=c*a*Sc,b},Uc=function(a,b,c,d){return c*=b,b*=b,d[0]*a-c*(d[1]+b*(d[2]+b*(d[3]+b*d[4])))},Vc=20,Wc=function(a,b,c){for(var d=1/(1-b),e=a,f=Vc;f;--f){var g=Math.sin(e),h=1-b*g*g;if(h=(Uc(e,g,Math.cos(e),c)-a)*(h*Math.sqrt(h))*d,e-=h,Math.abs(h)<Gb)return e}return e},Xc=["Transverse_Mercator","Transverse Mercator","tmerc"],Yc={init:_,forward:aa,inverse:ba,names:Xc},Zc=function(a){var b=Math.exp(a);return b=(b-1/b)/2},$c=function(a,b){a=Math.abs(a),b=Math.abs(b);var c=Math.max(a,b),d=Math.min(a,b)/(c?c:1);return c*Math.sqrt(1+Math.pow(d,2))},_c=function(a){var b=1+a,c=b-1;return 0===c?a:a*Math.log(b)/c},ad=function(a){var b=Math.abs(a);return b=_c(b*(1+b/($c(1,b)+1))),a<0?-b:b},bd=function(a,b){for(var c,d=2*Math.cos(2*b),e=a.length-1,f=a[e],g=0;--e>=0;)c=-g+d*f+a[e],g=f,f=c;return b+c*Math.sin(2*b)},cd=function(a,b){for(var c,d=2*Math.cos(b),e=a.length-1,f=a[e],g=0;--e>=0;)c=-g+d*f+a[e],g=f,f=c;return Math.sin(b)*c},dd=function(a){var b=Math.exp(a);return b=(b+1/b)/2},ed=function(a,b,c){for(var d,e,f=Math.sin(b),g=Math.cos(b),h=Zc(c),i=dd(c),j=2*g*i,k=-2*f*h,l=a.length-1,m=a[l],n=0,o=0,p=0;--l>=0;)d=o,e=n,o=m,n=p,m=-d+j*o-k*n+a[l],p=-e+k*o+j*n;return j=f*i,k=g*h,[j*m-k*p,j*p+k*m]},fd=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"],gd={init:ca,forward:da,inverse:ea,names:fd},hd=function(a,b){if(void 0===a){if(a=Math.floor(30*(fc(b)+Math.PI)/Math.PI)+1,a<0)return 0;if(a>60)return 60}return a},id="etmerc",jd=["Universal Transverse Mercator System","utm"],kd={init:fa,names:jd,dependsOn:id},ld=function(a,b){return Math.pow((1-a)/(1+a),b)},md=20,nd=["gauss"],od={init:ga,forward:ha,inverse:ia,names:nd},pd=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"],qd={init:ja,forward:ka,inverse:la,names:pd},rd=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],sd={init:na,forward:oa,inverse:pa,names:rd,ssfn_:ma},td=["somerc"],ud={init:qa,forward:ra,inverse:sa,names:td},vd=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"],wd={init:ta,forward:ua,inverse:va,names:vd},xd=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"],yd={init:wa,forward:xa,inverse:ya,names:xd},zd=["Krovak","krovak"],Ad={init:za,forward:Aa,inverse:Ba,names:zd},Bd=function(a,b,c,d,e){return a*e-b*Math.sin(2*e)+c*Math.sin(4*e)-d*Math.sin(6*e)},Cd=function(a){return 1-.25*a*(1+a/16*(3+1.25*a))},Dd=function(a){return.375*a*(1+.25*a*(1+.46875*a))},Ed=function(a){return.05859375*a*a*(1+.75*a)},Fd=function(a){return a*a*a*(35/3072)},Gd=function(a,b,c){var d=b*c;return a/Math.sqrt(1-d*d)},Hd=function(a){return Math.abs(a)<Cb?a:a-ec(a)*Math.PI},Id=function(a,b,c,d,e){var f,g;f=a/b;for(var h=0;h<15;h++)if(g=(a-(b*f-c*Math.sin(2*f)+d*Math.sin(4*f)-e*Math.sin(6*f)))/(b-2*c*Math.cos(2*f)+4*d*Math.cos(4*f)-6*e*Math.cos(6*f)),f+=g,Math.abs(g)<=1e-10)return f;return NaN},Jd=["Cassini","Cassini_Soldner","cass"],Kd={init:Ca,forward:Da,inverse:Ea,names:Jd},Ld=function(a,b){var c;return a>1e-7?(c=a*b,(1-a*a)*(b/(1-c*c)-.5/a*Math.log((1-c)/(1+c)))):2*b},Md=1,Nd=2,Od=3,Pd=4,Qd=.3333333333333333,Rd=.17222222222222222,Sd=.10257936507936508,Td=.06388888888888888,Ud=.0664021164021164,Vd=.016415012942191543,Wd=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],Xd={init:Fa,forward:Ga,inverse:Ha,names:Wd,S_POLE:Md,N_POLE:Nd,EQUIT:Od,OBLIQ:Pd},Yd=function(a){return Math.abs(a)>1&&(a=a>1?1:-1),Math.asin(a)},Zd=["Albers_Conic_Equal_Area","Albers","aea"],$d={init:Ka,forward:La,inverse:Ma,names:Zd,phi1z:Na},_d=["gnom"],ae={init:Oa,forward:Pa,inverse:Qa,names:_d},be=function(a,b){var c=1-(1-a*a)/(2*a)*Math.log((1-a)/(1+a));if(Math.abs(Math.abs(b)-c)<1e-6)return b<0?-1*Cb:Cb;for(var d,e,f,g,h=Math.asin(.5*b),i=0;i<30;i++)if(e=Math.sin(h),f=Math.cos(h),g=a*e,d=Math.pow(1-g*g,2)/(2*f)*(b/(1-a*a)-e/(1-g*g)+.5/a*Math.log((1-g)/(1+g))),h+=d,Math.abs(d)<=1e-10)return h;return NaN},ce=["cea"],de={init:Ra,forward:Sa,inverse:Ta,names:ce},ee=["Equirectangular","Equidistant_Cylindrical","eqc"],fe={init:Ua,forward:Va,inverse:Wa,names:ee},ge=20,he=["Polyconic","poly"],ie={init:Xa,forward:Ya,inverse:Za,names:he},je=["New_Zealand_Map_Grid","nzmg"],ke={init:$a,forward:_a,inverse:ab,names:je},le=["Miller_Cylindrical","mill"],me={init:bb,forward:cb,inverse:db,names:le},ne=20,oe=["Sinusoidal","sinu"],pe={init:eb,forward:fb,inverse:gb,names:oe},qe=["Mollweide","moll"],re={init:hb,forward:ib,inverse:jb,names:qe},se=["Equidistant_Conic","eqdc"],te={init:kb,forward:lb,inverse:mb,names:se},ue=["Van_der_Grinten_I","VanDerGrinten","vandg"],ve={init:nb,forward:ob,inverse:pb,names:ue},we=["Azimuthal_Equidistant","aeqd"],xe={init:qb,forward:rb,inverse:sb,names:we},ye=["ortho"],ze={init:tb,forward:ub,inverse:vb,names:ye},Ae=function(proj4){proj4.Proj.projections.add(Yc),proj4.Proj.projections.add(gd),proj4.Proj.projections.add(kd),proj4.Proj.projections.add(qd),proj4.Proj.projections.add(sd),proj4.Proj.projections.add(ud),proj4.Proj.projections.add(wd),proj4.Proj.projections.add(yd),proj4.Proj.projections.add(Ad),proj4.Proj.projections.add(Kd),proj4.Proj.projections.add(Xd),proj4.Proj.projections.add($d),proj4.Proj.projections.add(ae),proj4.Proj.projections.add(de),proj4.Proj.projections.add(fe),proj4.Proj.projections.add(ie),proj4.Proj.projections.add(ke),proj4.Proj.projections.add(me),proj4.Proj.projections.add(pe),proj4.Proj.projections.add(re),proj4.Proj.projections.add(te),proj4.Proj.projections.add(ve),proj4.Proj.projections.add(xe),proj4.Proj.projections.add(ze)};return K.defaultDatum="WGS84",K.Proj=z,K.WGS84=new K.Proj("WGS84"),K.Point=Point,K.toPoint=vc,K.defs=i,K.transform=H,K.mgrs=Fc,K.version=Gc,Ae(K),K});

/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var saveAs=saveAs||function(e){"use strict";if(typeof e==="undefined"||typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,a=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},i=/constructor/i.test(e.HTMLElement)||e.safari,f=/CriOS\/[\d]+/.test(navigator.userAgent),u=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},s="application/octet-stream",d=1e3*40,c=function(e){var t=function(){if(typeof e==="string"){n().revokeObjectURL(e)}else{e.remove()}};setTimeout(t,d)},l=function(e,t,n){t=[].concat(t);var r=t.length;while(r--){var o=e["on"+t[r]];if(typeof o==="function"){try{o.call(e,n||e)}catch(a){u(a)}}}},p=function(e){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)){return new Blob([String.fromCharCode(65279),e],{type:e.type})}return e},v=function(t,u,d){if(!d){t=p(t)}var v=this,w=t.type,m=w===s,y,h=function(){l(v,"writestart progress write writeend".split(" "))},S=function(){if((f||m&&i)&&e.FileReader){var r=new FileReader;r.onloadend=function(){var t=f?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");var n=e.open(t,"_blank");if(!n)e.location.href=t;t=undefined;v.readyState=v.DONE;h()};r.readAsDataURL(t);v.readyState=v.INIT;return}if(!y){y=n().createObjectURL(t)}if(m){e.location.href=y}else{var o=e.open(y,"_blank");if(!o){e.location.href=y}}v.readyState=v.DONE;h();c(y)};v.readyState=v.INIT;if(o){y=n().createObjectURL(t);setTimeout(function(){r.href=y;r.download=u;a(r);h();c(y);v.readyState=v.DONE});return}S()},w=v.prototype,m=function(e,t,n){return new v(e,t||e.name||"download",n)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(e,t,n){t=t||e.name||"download";if(!n){e=p(e)}return navigator.msSaveOrOpenBlob(e,t)}}w.abort=function(){};w.readyState=w.INIT=0;w.WRITING=1;w.DONE=2;w.error=w.onwritestart=w.onprogress=w.onwrite=w.onabort=w.onerror=w.onwriteend=null;return m}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content);if(typeof module!=="undefined"&&module.exports){module.exports.saveAs=saveAs}else if(typeof define!=="undefined"&&define!==null&&define.amd!==null){define("FileSaver.js",function(){return saveAs})}

// https://d3js.org Version 4.10.0. Copyright 2017 Mike Bostock.
(function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.d3=t.d3||{})})(this,function(t){"use strict";function n(t){return function(n,e){return ss(t(n),e)}}function e(t,n){return[t,n]}function r(t,n,e){var r=(n-t)/Math.max(0,e),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Ts?10:o>=ks?5:o>=Ns?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Ts?10:o>=ks?5:o>=Ns?2:1)}function i(t,n,e){var r=Math.abs(n-t)/Math.max(0,e),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Ts?i*=10:o>=ks?i*=5:o>=Ns&&(i*=2),n<t?-i:i}function o(t){return t.length}function u(t){return"translate("+(t+.5)+",0)"}function a(t){return"translate(0,"+(t+.5)+")"}function c(t){return function(n){return+t(n)}}function s(t){var n=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(n=Math.round(n)),function(e){return+t(e)+n}}function f(){return!this.__axis}function l(t,n){function e(e){var u=null==i?n.ticks?n.ticks.apply(n,r):n.domain():i,a=null==o?n.tickFormat?n.tickFormat.apply(n,r):Ls:o,y=Math.max(l,0)+p,g=n.range(),m=+g[0]+.5,x=+g[g.length-1]+.5,b=(n.bandwidth?s:c)(n.copy()),w=e.selection?e.selection():e,M=w.selectAll(".domain").data([null]),T=w.selectAll(".tick").data(u,n).order(),k=T.exit(),N=T.enter().append("g").attr("class","tick"),S=T.select("line"),E=T.select("text");M=M.merge(M.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),T=T.merge(N),S=S.merge(N.append("line").attr("stroke","#000").attr(v+"2",d*l)),E=E.merge(N.append("text").attr("fill","#000").attr(v,d*y).attr("dy",t===qs?"0em":t===Ds?"0.71em":"0.32em")),e!==w&&(M=M.transition(e),T=T.transition(e),S=S.transition(e),E=E.transition(e),k=k.transition(e).attr("opacity",Fs).attr("transform",function(t){return isFinite(t=b(t))?_(t):this.getAttribute("transform")}),N.attr("opacity",Fs).attr("transform",function(t){var n=this.parentNode.__axis;return _(n&&isFinite(n=n(t))?n:b(t))})),k.remove(),M.attr("d",t===Os||t==Us?"M"+d*h+","+m+"H0.5V"+x+"H"+d*h:"M"+m+","+d*h+"V0.5H"+x+"V"+d*h),T.attr("opacity",1).attr("transform",function(t){return _(b(t))}),S.attr(v+"2",d*l),E.attr(v,d*y).text(a),w.filter(f).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Us?"start":t===Os?"end":"middle"),w.each(function(){this.__axis=b})}var r=[],i=null,o=null,l=6,h=6,p=3,d=t===qs||t===Os?-1:1,v=t===Os||t===Us?"x":"y",_=t===qs||t===Ds?u:a;return e.scale=function(t){return arguments.length?(n=t,e):n},e.ticks=function(){return r=Rs.call(arguments),e},e.tickArguments=function(t){return arguments.length?(r=null==t?[]:Rs.call(t),e):r.slice()},e.tickValues=function(t){return arguments.length?(i=null==t?null:Rs.call(t),e):i&&i.slice()},e.tickFormat=function(t){return arguments.length?(o=t,e):o},e.tickSize=function(t){return arguments.length?(l=h=+t,e):l},e.tickSizeInner=function(t){return arguments.length?(l=+t,e):l},e.tickSizeOuter=function(t){return arguments.length?(h=+t,e):h},e.tickPadding=function(t){return arguments.length?(p=+t,e):p},e}function h(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new p(r)}function p(t){this._=t}function d(t,n){return t.trim().split(/^|\s+/).map(function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})}function v(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}function _(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=Is,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}function y(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===Ys&&n.documentElement.namespaceURI===Ys?n.createElement(t):n.createElementNS(e,t)}}function g(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function m(){return new x}function x(){this._="@"+(++Xs).toString(36)}function b(t,n,e){return t=w(t,n,e),function(n){var e=n.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||t.call(this,n)}}function w(n,e,r){return function(i){var o=t.event;t.event=i;try{n.call(this,this.__data__,e,r)}finally{t.event=o}}}function M(t){return t.trim().split(/^|\s+/).map(function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}})}function T(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,o=n.length;r<o;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.capture);++i?n.length=i:delete this.__on}}}function k(t,n,e){var r=Gs.hasOwnProperty(t.type)?b:w;return function(i,o,u){var a,c=this.__on,s=r(n,o,u);if(c)for(var f=0,l=c.length;f<l;++f)if((a=c[f]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=s,a.capture=e),void(a.value=n);this.addEventListener(t.type,s,e),a={type:t.type,name:t.name,value:n,listener:s,capture:e},c?c.push(a):this.__on=[a]}}function N(n,e,r,i){var o=t.event;n.sourceEvent=t.event,t.event=n;try{return e.apply(r,i)}finally{t.event=o}}function S(){}function E(){return[]}function A(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function C(t,n,e,r,i,o){for(var u,a=0,c=n.length,s=o.length;a<s;++a)(u=n[a])?(u.__data__=o[a],r[a]=u):e[a]=new A(t,o[a]);for(;a<c;++a)(u=n[a])&&(i[a]=u)}function z(t,n,e,r,i,o,u){var a,c,s,f={},l=n.length,h=o.length,p=new Array(l);for(a=0;a<l;++a)(c=n[a])&&(p[a]=s=of+u.call(c,c.__data__,a,n),s in f?i[a]=c:f[s]=c);for(a=0;a<h;++a)(c=f[s=of+u.call(t,o[a],a,o)])?(r[a]=c,c.__data__=o[a],f[s]=null):e[a]=new A(t,o[a]);for(a=0;a<l;++a)(c=n[a])&&f[p[a]]===c&&(i[a]=c)}function P(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function R(t){return function(){this.removeAttribute(t)}}function L(t){return function(){this.removeAttributeNS(t.space,t.local)}}function q(t,n){return function(){this.setAttribute(t,n)}}function U(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function D(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function O(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function F(t){return function(){this.style.removeProperty(t)}}function I(t,n,e){return function(){this.style.setProperty(t,n,e)}}function Y(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function B(t,n){return t.style.getPropertyValue(n)||uf(t).getComputedStyle(t,null).getPropertyValue(n)}function j(t){return function(){delete this[t]}}function H(t,n){return function(){this[t]=n}}function X(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function $(t){return t.trim().split(/^|\s+/)}function V(t){return t.classList||new W(t)}function W(t){this._node=t,this._names=$(t.getAttribute("class")||"")}function Z(t,n){for(var e=V(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function G(t,n){for(var e=V(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function J(t){return function(){Z(this,t)}}function Q(t){return function(){G(this,t)}}function K(t,n){return function(){(n.apply(this,arguments)?Z:G)(this,t)}}function tt(){this.textContent=""}function nt(t){return function(){this.textContent=t}}function et(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function rt(){this.innerHTML=""}function it(t){return function(){this.innerHTML=t}}function ot(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function ut(){this.nextSibling&&this.parentNode.appendChild(this)}function at(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ct(){return null}function st(){var t=this.parentNode;t&&t.removeChild(this)}function ft(t,n,e){var r=uf(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function lt(t,n){return function(){return ft(this,t,n)}}function ht(t,n){return function(){return ft(this,t,n.apply(this,arguments))}}function pt(t,n){this._groups=t,this._parents=n}function dt(){return new pt([[document.documentElement]],af)}function vt(){t.event.stopImmediatePropagation()}function _t(t,n){var e=t.document.documentElement,r=cf(t).on("dragstart.drag",null);n&&(r.on("click.drag",ff,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}function yt(t,n,e,r,i,o,u,a,c,s){this.target=t,this.type=n,this.subject=e,this.identifier=r,this.active=i,this.x=o,this.y=u,this.dx=a,this.dy=c,this._=s}function gt(){return!t.event.button}function mt(){return this.parentNode}function xt(n){return null==n?{x:t.event.x,y:t.event.y}:n}function bt(){return"ontouchstart"in this}function wt(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function Mt(){}function Tt(t){var n;return t=(t+"").trim().toLowerCase(),(n=yf.exec(t))?(n=parseInt(n[1],16),new At(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1)):(n=gf.exec(t))?kt(parseInt(n[1],16)):(n=mf.exec(t))?new At(n[1],n[2],n[3],1):(n=xf.exec(t))?new At(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=bf.exec(t))?Nt(n[1],n[2],n[3],n[4]):(n=wf.exec(t))?Nt(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=Mf.exec(t))?Ct(n[1],n[2]/100,n[3]/100,1):(n=Tf.exec(t))?Ct(n[1],n[2]/100,n[3]/100,n[4]):kf.hasOwnProperty(t)?kt(kf[t]):"transparent"===t?new At(NaN,NaN,NaN,0):null}function kt(t){return new At(t>>16&255,t>>8&255,255&t,1)}function Nt(t,n,e,r){return r<=0&&(t=n=e=NaN),new At(t,n,e,r)}function St(t){return t instanceof Mt||(t=Tt(t)),t?(t=t.rgb(),new At(t.r,t.g,t.b,t.opacity)):new At}function Et(t,n,e,r){return 1===arguments.length?St(t):new At(t,n,e,null==r?1:r)}function At(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function Ct(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new Rt(t,n,e,r)}function zt(t){if(t instanceof Rt)return new Rt(t.h,t.s,t.l,t.opacity);if(t instanceof Mt||(t=Tt(t)),!t)return new Rt;if(t instanceof Rt)return t;var n=(t=t.rgb()).r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),o=Math.max(n,e,r),u=NaN,a=o-i,c=(o+i)/2;return a?(u=n===o?(e-r)/a+6*(e<r):e===o?(r-n)/a+2:(n-e)/a+4,a/=c<.5?o+i:2-o-i,u*=60):a=c>0&&c<1?0:u,new Rt(u,a,c,t.opacity)}function Pt(t,n,e,r){return 1===arguments.length?zt(t):new Rt(t,n,e,null==r?1:r)}function Rt(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function Lt(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}function qt(t){if(t instanceof Dt)return new Dt(t.l,t.a,t.b,t.opacity);if(t instanceof Ht){var n=t.h*Nf;return new Dt(t.l,Math.cos(n)*t.c,Math.sin(n)*t.c,t.opacity)}t instanceof At||(t=St(t));var e=Yt(t.r),r=Yt(t.g),i=Yt(t.b),o=Ot((.4124564*e+.3575761*r+.1804375*i)/Ef),u=Ot((.2126729*e+.7151522*r+.072175*i)/Af);return new Dt(116*u-16,500*(o-u),200*(u-Ot((.0193339*e+.119192*r+.9503041*i)/Cf)),t.opacity)}function Ut(t,n,e,r){return 1===arguments.length?qt(t):new Dt(t,n,e,null==r?1:r)}function Dt(t,n,e,r){this.l=+t,this.a=+n,this.b=+e,this.opacity=+r}function Ot(t){return t>Lf?Math.pow(t,1/3):t/Rf+zf}function Ft(t){return t>Pf?t*t*t:Rf*(t-zf)}function It(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Yt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Bt(t){if(t instanceof Ht)return new Ht(t.h,t.c,t.l,t.opacity);t instanceof Dt||(t=qt(t));var n=Math.atan2(t.b,t.a)*Sf;return new Ht(n<0?n+360:n,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function jt(t,n,e,r){return 1===arguments.length?Bt(t):new Ht(t,n,e,null==r?1:r)}function Ht(t,n,e,r){this.h=+t,this.c=+n,this.l=+e,this.opacity=+r}function Xt(t){if(t instanceof Vt)return new Vt(t.h,t.s,t.l,t.opacity);t instanceof At||(t=St(t));var n=t.r/255,e=t.g/255,r=t.b/255,i=(Bf*r+If*n-Yf*e)/(Bf+If-Yf),o=r-i,u=(Ff*(e-i)-Df*o)/Of,a=Math.sqrt(u*u+o*o)/(Ff*i*(1-i)),c=a?Math.atan2(u,o)*Sf-120:NaN;return new Vt(c<0?c+360:c,a,i,t.opacity)}function $t(t,n,e,r){return 1===arguments.length?Xt(t):new Vt(t,n,e,null==r?1:r)}function Vt(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function Wt(t,n,e,r,i){var o=t*t,u=o*t;return((1-3*t+3*o-u)*n+(4-6*o+3*u)*e+(1+3*t+3*o-3*u)*r+u*i)/6}function Zt(t,n){return function(e){return t+e*n}}function Gt(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}function Jt(t,n){var e=n-t;return e?Zt(t,e>180||e<-180?e-360*Math.round(e/360):e):Jf(isNaN(t)?n:t)}function Qt(t){return 1==(t=+t)?Kt:function(n,e){return e-n?Gt(n,e,t):Jf(isNaN(n)?e:n)}}function Kt(t,n){var e=n-t;return e?Zt(t,e):Jf(isNaN(t)?n:t)}function tn(t){return function(n){var e,r,i=n.length,o=new Array(i),u=new Array(i),a=new Array(i);for(e=0;e<i;++e)r=Et(n[e]),o[e]=r.r||0,u[e]=r.g||0,a[e]=r.b||0;return o=t(o),u=t(u),a=t(a),r.opacity=1,function(t){return r.r=o(t),r.g=u(t),r.b=a(t),r+""}}}function nn(t){return function(){return t}}function en(t){return function(n){return t(n)+""}}function rn(t,n,e,r){function i(t){return t.length?t.pop()+" ":""}function o(t,r,i,o,u,a){if(t!==i||r!==o){var c=u.push("translate(",null,n,null,e);a.push({i:c-4,x:rl(t,i)},{i:c-2,x:rl(r,o)})}else(i||o)&&u.push("translate("+i+n+o+e)}function u(t,n,e,o){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),o.push({i:e.push(i(e)+"rotate(",null,r)-2,x:rl(t,n)})):n&&e.push(i(e)+"rotate("+n+r)}function a(t,n,e,o){t!==n?o.push({i:e.push(i(e)+"skewX(",null,r)-2,x:rl(t,n)}):n&&e.push(i(e)+"skewX("+n+r)}function c(t,n,e,r,o,u){if(t!==e||n!==r){var a=o.push(i(o)+"scale(",null,",",null,")");u.push({i:a-4,x:rl(t,e)},{i:a-2,x:rl(n,r)})}else 1===e&&1===r||o.push(i(o)+"scale("+e+","+r+")")}return function(n,e){var r=[],i=[];return n=t(n),e=t(e),o(n.translateX,n.translateY,e.translateX,e.translateY,r,i),u(n.rotate,e.rotate,r,i),a(n.skewX,e.skewX,r,i),c(n.scaleX,n.scaleY,e.scaleX,e.scaleY,r,i),n=e=null,function(t){for(var n,e=-1,o=i.length;++e<o;)r[(n=i[e]).i]=n.x(t);return r.join("")}}}function on(t){return((t=Math.exp(t))+1/t)/2}function un(t){return((t=Math.exp(t))-1/t)/2}function an(t){return((t=Math.exp(2*t))-1)/(t+1)}function cn(t){return function(n,e){var r=t((n=Pt(n)).h,(e=Pt(e)).h),i=Kt(n.s,e.s),o=Kt(n.l,e.l),u=Kt(n.opacity,e.opacity);return function(t){return n.h=r(t),n.s=i(t),n.l=o(t),n.opacity=u(t),n+""}}}function sn(t){return function(n,e){var r=t((n=jt(n)).h,(e=jt(e)).h),i=Kt(n.c,e.c),o=Kt(n.l,e.l),u=Kt(n.opacity,e.opacity);return function(t){return n.h=r(t),n.c=i(t),n.l=o(t),n.opacity=u(t),n+""}}}function fn(t){return function n(e){function r(n,r){var i=t((n=$t(n)).h,(r=$t(r)).h),o=Kt(n.s,r.s),u=Kt(n.l,r.l),a=Kt(n.opacity,r.opacity);return function(t){return n.h=i(t),n.s=o(t),n.l=u(Math.pow(t,e)),n.opacity=a(t),n+""}}return e=+e,r.gamma=n,r}(1)}function ln(){return El||(zl(hn),El=Cl.now()+Al)}function hn(){El=0}function pn(){this._call=this._time=this._next=null}function dn(t,n,e){var r=new pn;return r.restart(t,n,e),r}function vn(){ln(),++Ml;for(var t,n=Vf;n;)(t=El-n._time)>=0&&n._call.call(null,t),n=n._next;--Ml}function _n(){El=(Sl=Cl.now())+Al,Ml=Tl=0;try{vn()}finally{Ml=0,gn(),El=0}}function yn(){var t=Cl.now(),n=t-Sl;n>Nl&&(Al-=n,Sl=t)}function gn(){for(var t,n,e=Vf,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Vf=n);Wf=t,mn(r)}function mn(t){if(!Ml){Tl&&(Tl=clearTimeout(Tl));var n=t-El;n>24?(t<1/0&&(Tl=setTimeout(_n,n)),kl&&(kl=clearInterval(kl))):(kl||(Sl=El,kl=setInterval(yn,Nl)),Ml=1,zl(_n))}}function xn(t,n){var e=t.__transition;if(!e||!(e=e[n])||e.state>ql)throw new Error("too late");return e}function bn(t,n){var e=t.__transition;if(!e||!(e=e[n])||e.state>Dl)throw new Error("too late");return e}function wn(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("too late");return e}function Mn(t,n,e){function r(c){var s,f,l,h;if(e.state!==Ul)return o();for(s in a)if((h=a[s]).name===e.name){if(h.state===Ol)return Pl(r);h.state===Fl?(h.state=Yl,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete a[s]):+s<n&&(h.state=Yl,h.timer.stop(),delete a[s])}if(Pl(function(){e.state===Ol&&(e.state=Fl,e.timer.restart(i,e.delay,e.time),i(c))}),e.state=Dl,e.on.call("start",t,t.__data__,e.index,e.group),e.state===Dl){for(e.state=Ol,u=new Array(l=e.tween.length),s=0,f=-1;s<l;++s)(h=e.tween[s].value.call(t,t.__data__,e.index,e.group))&&(u[++f]=h);u.length=f+1}}function i(n){for(var r=n<e.duration?e.ease.call(null,n/e.duration):(e.timer.restart(o),e.state=Il,1),i=-1,a=u.length;++i<a;)u[i].call(null,r);e.state===Il&&(e.on.call("end",t,t.__data__,e.index,e.group),o())}function o(){e.state=Yl,e.timer.stop(),delete a[n];for(var r in a)return;delete t.__transition}var u,a=t.__transition;a[n]=e,e.timer=dn(function(t){e.state=Ul,e.timer.restart(r,e.delay,e.time),e.delay<=t&&r(t-e.delay)},0,e.time)}function Tn(t,n){var e,r;return function(){var i=bn(this,t),o=i.tween;if(o!==e)for(var u=0,a=(r=e=o).length;u<a;++u)if(r[u].name===n){(r=r.slice()).splice(u,1);break}i.tween=r}}function kn(t,n,e){var r,i;if("function"!=typeof e)throw new Error;return function(){var o=bn(this,t),u=o.tween;if(u!==r){i=(r=u).slice();for(var a={name:n,value:e},c=0,s=i.length;c<s;++c)if(i[c].name===n){i[c]=a;break}c===s&&i.push(a)}o.tween=i}}function Nn(t,n,e){var r=t._id;return t.each(function(){var t=bn(this,r);(t.value||(t.value={}))[n]=e.apply(this,arguments)}),function(t){return wn(t,r).value[n]}}function Sn(t){return function(){this.removeAttribute(t)}}function En(t){return function(){this.removeAttributeNS(t.space,t.local)}}function An(t,n,e){var r,i;return function(){var o=this.getAttribute(t);return o===e?null:o===r?i:i=n(r=o,e)}}function Cn(t,n,e){var r,i;return function(){var o=this.getAttributeNS(t.space,t.local);return o===e?null:o===r?i:i=n(r=o,e)}}function zn(t,n,e){var r,i,o;return function(){var u,a=e(this);{if(null!=a)return(u=this.getAttribute(t))===a?null:u===r&&a===i?o:o=n(r=u,i=a);this.removeAttribute(t)}}}function Pn(t,n,e){var r,i,o;return function(){var u,a=e(this);{if(null!=a)return(u=this.getAttributeNS(t.space,t.local))===a?null:u===r&&a===i?o:o=n(r=u,i=a);this.removeAttributeNS(t.space,t.local)}}}function Rn(t,n){function e(){var e=this,r=n.apply(e,arguments);return r&&function(n){e.setAttributeNS(t.space,t.local,r(n))}}return e._value=n,e}function Ln(t,n){function e(){var e=this,r=n.apply(e,arguments);return r&&function(n){e.setAttribute(t,r(n))}}return e._value=n,e}function qn(t,n){return function(){xn(this,t).delay=+n.apply(this,arguments)}}function Un(t,n){return n=+n,function(){xn(this,t).delay=n}}function Dn(t,n){return function(){bn(this,t).duration=+n.apply(this,arguments)}}function On(t,n){return n=+n,function(){bn(this,t).duration=n}}function Fn(t,n){if("function"!=typeof n)throw new Error;return function(){bn(this,t).ease=n}}function In(t){return(t+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||"start"===t})}function Yn(t,n,e){var r,i,o=In(n)?xn:bn;return function(){var u=o(this,t),a=u.on;a!==r&&(i=(r=a).copy()).on(n,e),u.on=i}}function Bn(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}function jn(t,n){var e,r,i;return function(){var o=B(this,t),u=(this.style.removeProperty(t),B(this,t));return o===u?null:o===e&&u===r?i:i=n(e=o,r=u)}}function Hn(t){return function(){this.style.removeProperty(t)}}function Xn(t,n,e){var r,i;return function(){var o=B(this,t);return o===e?null:o===r?i:i=n(r=o,e)}}function $n(t,n,e){var r,i,o;return function(){var u=B(this,t),a=e(this);return null==a&&(this.style.removeProperty(t),a=B(this,t)),u===a?null:u===r&&a===i?o:o=n(r=u,i=a)}}function Vn(t,n,e){function r(){var r=this,i=n.apply(r,arguments);return i&&function(n){r.style.setProperty(t,i(n),e)}}return r._value=n,r}function Wn(t){return function(){this.textContent=t}}function Zn(t){return function(){var n=t(this);this.textContent=null==n?"":n}}function Gn(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function Jn(t){return dt().transition(t)}function Qn(){return++$l}function Kn(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function te(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function ne(t){return(1-Math.cos(Jl*t))/2}function ee(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function re(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}function ie(t){return(t=+t)<Kl?ch*t*t:t<nh?ch*(t-=th)*t+eh:t<ih?ch*(t-=rh)*t+oh:ch*(t-=uh)*t+ah}function oe(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))return _h.time=ln(),_h;return e}function ue(){t.event.stopImmediatePropagation()}function ae(t){return{type:t}}function ce(){return!t.event.button}function se(){var t=this.ownerSVGElement||this;return[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function fe(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function le(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function he(n){function e(t){var e=t.property("__brush",a).selectAll(".overlay").data([ae("overlay")]);e.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Eh.overlay).merge(e).each(function(){var t=fe(this).extent;cf(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),t.selectAll(".selection").data([ae("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Eh.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var i=t.selectAll(".handle").data(n.handles,function(t){return t.type});i.exit().remove(),i.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return Eh[t.type]}),t.each(r).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",u)}function r(){var t=cf(this),n=fe(this).selection;n?(t.selectAll(".selection").style("display",null).attr("x",n[0][0]).attr("y",n[0][1]).attr("width",n[1][0]-n[0][0]).attr("height",n[1][1]-n[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?n[1][0]-p/2:n[0][0]-p/2}).attr("y",function(t){return"s"===t.type[0]?n[1][1]-p/2:n[0][1]-p/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?n[1][0]-n[0][0]+p:p}).attr("height",function(t){return"e"===t.type||"w"===t.type?n[1][1]-n[0][1]+p:p})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function i(t,n){return t.__brush.emitter||new o(t,n)}function o(t,n){this.that=t,this.args=n,this.state=t.__brush,this.active=0}function u(){function e(){var t=Ks(w);!L||x||b||(Math.abs(t[0]-U[0])>Math.abs(t[1]-U[1])?b=!0:x=!0),U=t,m=!0,xh(),o()}function o(){var t;switch(y=U[0]-q[0],g=U[1]-q[1],T){case wh:case bh:k&&(y=Math.max(C-a,Math.min(P-p,y)),s=a+y,d=p+y),N&&(g=Math.max(z-l,Math.min(R-v,g)),h=l+g,_=v+g);break;case Mh:k<0?(y=Math.max(C-a,Math.min(P-a,y)),s=a+y,d=p):k>0&&(y=Math.max(C-p,Math.min(P-p,y)),s=a,d=p+y),N<0?(g=Math.max(z-l,Math.min(R-l,g)),h=l+g,_=v):N>0&&(g=Math.max(z-v,Math.min(R-v,g)),h=l,_=v+g);break;case Th:k&&(s=Math.max(C,Math.min(P,a-y*k)),d=Math.max(C,Math.min(P,p+y*k))),N&&(h=Math.max(z,Math.min(R,l-g*N)),_=Math.max(z,Math.min(R,v+g*N)))}d<s&&(k*=-1,t=a,a=p,p=t,t=s,s=d,d=t,M in Ah&&F.attr("cursor",Eh[M=Ah[M]])),_<h&&(N*=-1,t=l,l=v,v=t,t=h,h=_,_=t,M in Ch&&F.attr("cursor",Eh[M=Ch[M]])),S.selection&&(A=S.selection),x&&(s=A[0][0],d=A[1][0]),b&&(h=A[0][1],_=A[1][1]),A[0][0]===s&&A[0][1]===h&&A[1][0]===d&&A[1][1]===_||(S.selection=[[s,h],[d,_]],r.call(w),D.brush())}function u(){if(ue(),t.event.touches){if(t.event.touches.length)return;c&&clearTimeout(c),c=setTimeout(function(){c=null},500),O.on("touchmove.brush touchend.brush touchcancel.brush",null)}else _t(t.event.view,m),I.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);O.attr("pointer-events","all"),F.attr("cursor",Eh.overlay),S.selection&&(A=S.selection),le(A)&&(S.selection=null,r.call(w)),D.end()}if(t.event.touches){if(t.event.changedTouches.length<t.event.touches.length)return xh()}else if(c)return;if(f.apply(this,arguments)){var a,s,l,h,p,d,v,_,y,g,m,x,b,w=this,M=t.event.target.__data__.type,T="selection"===(t.event.metaKey?M="overlay":M)?bh:t.event.altKey?Th:Mh,k=n===Nh?null:zh[M],N=n===kh?null:Ph[M],S=fe(w),E=S.extent,A=S.selection,C=E[0][0],z=E[0][1],P=E[1][0],R=E[1][1],L=k&&N&&t.event.shiftKey,q=Ks(w),U=q,D=i(w,arguments).beforestart();"overlay"===M?S.selection=A=[[a=n===Nh?C:q[0],l=n===kh?z:q[1]],[p=n===Nh?P:a,v=n===kh?R:l]]:(a=A[0][0],l=A[0][1],p=A[1][0],v=A[1][1]),s=a,h=l,d=p,_=v;var O=cf(w).attr("pointer-events","none"),F=O.selectAll(".overlay").attr("cursor",Eh[M]);if(t.event.touches)O.on("touchmove.brush",e,!0).on("touchend.brush touchcancel.brush",u,!0);else{var I=cf(t.event.view).on("keydown.brush",function(){switch(t.event.keyCode){case 16:L=k&&N;break;case 18:T===Mh&&(k&&(p=d-y*k,a=s+y*k),N&&(v=_-g*N,l=h+g*N),T=Th,o());break;case 32:T!==Mh&&T!==Th||(k<0?p=d-y:k>0&&(a=s-y),N<0?v=_-g:N>0&&(l=h-g),T=wh,F.attr("cursor",Eh.selection),o());break;default:return}xh()},!0).on("keyup.brush",function(){switch(t.event.keyCode){case 16:L&&(x=b=L=!1,o());break;case 18:T===Th&&(k<0?p=d:k>0&&(a=s),N<0?v=_:N>0&&(l=h),T=Mh,o());break;case 32:T===wh&&(t.event.altKey?(k&&(p=d-y*k,a=s+y*k),N&&(v=_-g*N,l=h+g*N),T=Th):(k<0?p=d:k>0&&(a=s),N<0?v=_:N>0&&(l=h),T=Mh),F.attr("cursor",Eh[M]),o());break;default:return}xh()},!0).on("mousemove.brush",e,!0).on("mouseup.brush",u,!0);lf(t.event.view)}ue(),jl(w),r.call(w),D.start()}}function a(){var t=this.__brush||{selection:null};return t.extent=s.apply(this,arguments),t.dim=n,t}var c,s=se,f=ce,l=h(e,"start","brush","end"),p=6;return e.move=function(t,e){t.selection?t.on("start.brush",function(){i(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){i(this,arguments).end()}).tween("brush",function(){function t(t){u.selection=1===t&&le(s)?null:f(t),r.call(o),a.brush()}var o=this,u=o.__brush,a=i(o,arguments),c=u.selection,s=n.input("function"==typeof e?e.apply(this,arguments):e,u.extent),f=cl(c,s);return c&&s?t:t(1)}):t.each(function(){var t=this,o=arguments,u=t.__brush,a=n.input("function"==typeof e?e.apply(t,o):e,u.extent),c=i(t,o).beforestart();jl(t),u.selection=null==a||le(a)?null:a,r.call(t),c.start().brush().end()})},o.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){N(new mh(e,t,n.output(this.state.selection)),l.apply,l,[t,this.that,this.args])}},e.extent=function(t){return arguments.length?(s="function"==typeof t?t:gh([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),e):s},e.filter=function(t){return arguments.length?(f="function"==typeof t?t:gh(!!t),e):f},e.handleSize=function(t){return arguments.length?(p=+t,e):p},e.on=function(){var t=l.on.apply(l,arguments);return t===l?e:t},e}function pe(t){return function(n,e){return t(n.source.value+n.target.value,e.source.value+e.target.value)}}function de(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ve(){return new de}function _e(t){return t.source}function ye(t){return t.target}function ge(t){return t.radius}function me(t){return t.startAngle}function xe(t){return t.endAngle}function be(){}function we(t,n){var e=new be;if(t instanceof be)t.each(function(t,n){e.set(n,t)});else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==n)for(;++i<o;)e.set(i,t[i]);else for(;++i<o;)e.set(n(r=t[i],i,t),r)}else if(t)for(var u in t)e.set(u,t[u]);return e}function Me(){return{}}function Te(t,n,e){t[n]=e}function ke(){return we()}function Ne(t,n,e){t.set(n,e)}function Se(){}function Ee(t,n){var e=new Se;if(t instanceof Se)t.each(function(t){e.add(t)});else if(t){var r=-1,i=t.length;if(null==n)for(;++r<i;)e.add(t[r]);else for(;++r<i;)e.add(n(t[r],r,t))}return e}function Ae(t){return new Function("d","return {"+t.map(function(t,n){return JSON.stringify(t)+": d["+n+"]"}).join(",")+"}")}function Ce(t,n){var e=Ae(t);return function(r,i){return n(e(r),i,t)}}function ze(t){var n=Object.create(null),e=[];return t.forEach(function(t){for(var r in t)r in n||e.push(n[r]=r)}),e}function Pe(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,o,u,a,c,s,f,l,h,p=t._root,d={data:r},v=t._x0,_=t._y0,y=t._x1,g=t._y1;if(!p)return t._root=d,t;for(;p.length;)if((s=n>=(o=(v+y)/2))?v=o:y=o,(f=e>=(u=(_+g)/2))?_=u:g=u,i=p,!(p=p[l=f<<1|s]))return i[l]=d,t;if(a=+t._x.call(null,p.data),c=+t._y.call(null,p.data),n===a&&e===c)return d.next=p,i?i[l]=d:t._root=d,t;do{i=i?i[l]=new Array(4):t._root=new Array(4),(s=n>=(o=(v+y)/2))?v=o:y=o,(f=e>=(u=(_+g)/2))?_=u:g=u}while((l=f<<1|s)==(h=(c>=u)<<1|a>=o));return i[h]=p,i[l]=d,t}function Re(t){return t[0]}function Le(t){return t[1]}function qe(t,n,e){var r=new Ue(null==n?Re:n,null==e?Le:e,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Ue(t,n,e,r,i,o){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function De(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}function Oe(t){return t.x+t.vx}function Fe(t){return t.y+t.vy}function Ie(t){return t.index}function Ye(t,n){var e=t.get(n);if(!e)throw new Error("missing: "+n);return e}function Be(t){return t.x}function je(t){return t.y}function He(t){return new Xe(t)}function Xe(t){if(!(n=vp.exec(t)))throw new Error("invalid format: "+t);var n,e=n[1]||" ",r=n[2]||">",i=n[3]||"-",o=n[4]||"",u=!!n[5],a=n[6]&&+n[6],c=!!n[7],s=n[8]&&+n[8].slice(1),f=n[9]||"";"n"===f?(c=!0,f="g"):dp[f]||(f=""),(u||"0"===e&&"="===r)&&(u=!0,e="0",r="="),this.fill=e,this.align=r,this.sign=i,this.symbol=o,this.zero=u,this.width=a,this.comma=c,this.precision=s,this.type=f}function $e(n){return _p=mp(n),t.format=_p.format,t.formatPrefix=_p.formatPrefix,_p}function Ve(){this.reset()}function We(t,n,e){var r=t.s=n+e,i=r-n,o=r-i;t.t=n-o+(e-i)}function Ze(t){return t>1?0:t<-1?rd:Math.acos(t)}function Ge(t){return t>1?id:t<-1?-id:Math.asin(t)}function Je(t){return(t=yd(t/2))*t}function Qe(){}function Ke(t,n){t&&wd.hasOwnProperty(t.type)&&wd[t.type](t,n)}function tr(t,n,e){var r,i=-1,o=t.length-e;for(n.lineStart();++i<o;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function nr(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)tr(t[e],n,1);n.polygonEnd()}function er(){Nd.point=ir}function rr(){or(Tp,kp)}function ir(t,n){Nd.point=or,Tp=t,kp=n,Np=t*=cd,Sp=hd(n=(n*=cd)/2+od),Ep=yd(n)}function or(t,n){n=(n*=cd)/2+od;var e=(t*=cd)-Np,r=e>=0?1:-1,i=r*e,o=hd(n),u=yd(n),a=Ep*u,c=Sp*o+a*hd(i),s=a*r*yd(i);Td.add(ld(s,c)),Np=t,Sp=o,Ep=u}function ur(t){return[ld(t[1],t[0]),Ge(t[2])]}function ar(t){var n=t[0],e=t[1],r=hd(e);return[r*hd(n),r*yd(n),yd(e)]}function cr(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function sr(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function fr(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function lr(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function hr(t){var n=md(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}function pr(t,n){Dp.push(Op=[Ap=t,zp=t]),n<Cp&&(Cp=n),n>Pp&&(Pp=n)}function dr(t,n){var e=ar([t*cd,n*cd]);if(Up){var r=sr(Up,e),i=sr([r[1],-r[0],0],r);hr(i),i=ur(i);var o,u=t-Rp,a=u>0?1:-1,c=i[0]*ad*a,s=sd(u)>180;s^(a*Rp<c&&c<a*t)?(o=i[1]*ad)>Pp&&(Pp=o):(c=(c+360)%360-180,s^(a*Rp<c&&c<a*t)?(o=-i[1]*ad)<Cp&&(Cp=o):(n<Cp&&(Cp=n),n>Pp&&(Pp=n))),s?t<Rp?xr(Ap,t)>xr(Ap,zp)&&(zp=t):xr(t,zp)>xr(Ap,zp)&&(Ap=t):zp>=Ap?(t<Ap&&(Ap=t),t>zp&&(zp=t)):t>Rp?xr(Ap,t)>xr(Ap,zp)&&(zp=t):xr(t,zp)>xr(Ap,zp)&&(Ap=t)}else Dp.push(Op=[Ap=t,zp=t]);n<Cp&&(Cp=n),n>Pp&&(Pp=n),Up=e,Rp=t}function vr(){Ed.point=dr}function _r(){Op[0]=Ap,Op[1]=zp,Ed.point=pr,Up=null}function yr(t,n){if(Up){var e=t-Rp;Sd.add(sd(e)>180?e+(e>0?360:-360):e)}else Lp=t,qp=n;Nd.point(t,n),dr(t,n)}function gr(){Nd.lineStart()}function mr(){yr(Lp,qp),Nd.lineEnd(),sd(Sd)>ed&&(Ap=-(zp=180)),Op[0]=Ap,Op[1]=zp,Up=null}function xr(t,n){return(n-=t)<0?n+360:n}function br(t,n){return t[0]-n[0]}function wr(t,n){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}function Mr(t,n){t*=cd;var e=hd(n*=cd);Tr(e*hd(t),e*yd(t),yd(n))}function Tr(t,n,e){Yp+=(t-Yp)/++Fp,Bp+=(n-Bp)/Fp,jp+=(e-jp)/Fp}function kr(){Ad.point=Nr}function Nr(t,n){t*=cd;var e=hd(n*=cd);Qp=e*hd(t),Kp=e*yd(t),td=yd(n),Ad.point=Sr,Tr(Qp,Kp,td)}function Sr(t,n){t*=cd;var e=hd(n*=cd),r=e*hd(t),i=e*yd(t),o=yd(n),u=ld(md((u=Kp*o-td*i)*u+(u=td*r-Qp*o)*u+(u=Qp*i-Kp*r)*u),Qp*r+Kp*i+td*o);Ip+=u,Hp+=u*(Qp+(Qp=r)),Xp+=u*(Kp+(Kp=i)),$p+=u*(td+(td=o)),Tr(Qp,Kp,td)}function Er(){Ad.point=Mr}function Ar(){Ad.point=zr}function Cr(){Pr(Gp,Jp),Ad.point=Mr}function zr(t,n){Gp=t,Jp=n,t*=cd,n*=cd,Ad.point=Pr;var e=hd(n);Qp=e*hd(t),Kp=e*yd(t),td=yd(n),Tr(Qp,Kp,td)}function Pr(t,n){t*=cd;var e=hd(n*=cd),r=e*hd(t),i=e*yd(t),o=yd(n),u=Kp*o-td*i,a=td*r-Qp*o,c=Qp*i-Kp*r,s=md(u*u+a*a+c*c),f=Ge(s),l=s&&-f/s;Vp+=l*u,Wp+=l*a,Zp+=l*c,Ip+=f,Hp+=f*(Qp+(Qp=r)),Xp+=f*(Kp+(Kp=i)),$p+=f*(td+(td=o)),Tr(Qp,Kp,td)}function Rr(t,n){return[t>rd?t-ud:t<-rd?t+ud:t,n]}function Lr(t,n,e){return(t%=ud)?n||e?zd(Ur(t),Dr(n,e)):Ur(t):n||e?Dr(n,e):Rr}function qr(t){return function(n,e){return n+=t,[n>rd?n-ud:n<-rd?n+ud:n,e]}}function Ur(t){var n=qr(t);return n.invert=qr(-t),n}function Dr(t,n){function e(t,n){var e=hd(n),a=hd(t)*e,c=yd(t)*e,s=yd(n),f=s*r+a*i;return[ld(c*o-f*u,a*r-s*i),Ge(f*o+c*u)]}var r=hd(t),i=yd(t),o=hd(n),u=yd(n);return e.invert=function(t,n){var e=hd(n),a=hd(t)*e,c=yd(t)*e,s=yd(n),f=s*o-c*u;return[ld(c*o+s*u,a*r+f*i),Ge(f*r-a*i)]},e}function Or(t,n,e,r,i,o){if(e){var u=hd(n),a=yd(n),c=r*e;null==i?(i=n+r*ud,o=n-c/2):(i=Fr(u,i),o=Fr(u,o),(r>0?i<o:i>o)&&(i+=r*ud));for(var s,f=i;r>0?f>o:f<o;f-=c)s=ur([u,-a*hd(f),-a*yd(f)]),t.point(s[0],s[1])}}function Fr(t,n){(n=ar(n))[0]-=t,hr(n);var e=Ze(-n[1]);return((-n[2]<0?-e:e)+ud-ed)%ud}function Ir(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Yr(t){if(n=t.length){for(var n,e,r=0,i=t[0];++r<n;)i.n=e=t[r],e.p=i,i=e;i.n=e=t[0],e.p=i}}function Br(t,n,e,r){function i(i,o){return t<=i&&i<=e&&n<=o&&o<=r}function o(i,o,a,s){var f=0,l=0;if(null==i||(f=u(i,a))!==(l=u(o,a))||c(i,o)<0^a>0)do{s.point(0===f||3===f?t:e,f>1?r:n)}while((f=(f+a+4)%4)!==l);else s.point(o[0],o[1])}function u(r,i){return sd(r[0]-t)<ed?i>0?0:3:sd(r[0]-e)<ed?i>0?2:1:sd(r[1]-n)<ed?i>0?1:0:i>0?3:2}function a(t,n){return c(t.x,n.x)}function c(t,n){var e=u(t,1),r=u(n,1);return e!==r?e-r:0===e?n[1]-t[1]:1===e?t[0]-n[0]:2===e?t[1]-n[1]:n[0]-t[0]}return function(u){function c(t,n){i(t,n)&&w.point(t,n)}function s(){for(var n=0,e=0,i=h.length;e<i;++e)for(var o,u,a=h[e],c=1,s=a.length,f=a[0],l=f[0],p=f[1];c<s;++c)o=l,u=p,l=(f=a[c])[0],p=f[1],u<=r?p>r&&(l-o)*(r-u)>(p-u)*(t-o)&&++n:p<=r&&(l-o)*(r-u)<(p-u)*(t-o)&&--n;return n}function f(o,u){var a=i(o,u);if(h&&p.push([o,u]),x)d=o,v=u,_=a,x=!1,a&&(w.lineStart(),w.point(o,u));else if(a&&m)w.point(o,u);else{var c=[y=Math.max(Zd,Math.min(Wd,y)),g=Math.max(Zd,Math.min(Wd,g))],s=[o=Math.max(Zd,Math.min(Wd,o)),u=Math.max(Zd,Math.min(Wd,u))];Xd(c,s,t,n,e,r)?(m||(w.lineStart(),w.point(c[0],c[1])),w.point(s[0],s[1]),a||w.lineEnd(),b=!1):a&&(w.lineStart(),w.point(o,u),b=!1)}y=o,g=u,m=a}var l,h,p,d,v,_,y,g,m,x,b,w=u,M=Hd(),T={point:c,lineStart:function(){T.point=f,h&&h.push(p=[]),x=!0,m=!1,y=g=NaN},lineEnd:function(){l&&(f(d,v),_&&m&&M.rejoin(),l.push(M.result())),T.point=c,m&&w.lineEnd()},polygonStart:function(){w=M,l=[],h=[],b=!0},polygonEnd:function(){var t=s(),n=b&&t,e=(l=Cs(l)).length;(n||e)&&(u.polygonStart(),n&&(u.lineStart(),o(null,null,1,u),u.lineEnd()),e&&Vd(l,a,t,o,u),u.polygonEnd()),w=u,l=h=p=null}};return T}}function jr(){Kd.point=Kd.lineEnd=Qe}function Hr(t,n){Pd=t*=cd,Rd=yd(n*=cd),Ld=hd(n),Kd.point=Xr}function Xr(t,n){t*=cd;var e=yd(n*=cd),r=hd(n),i=sd(t-Pd),o=hd(i),u=r*yd(i),a=Ld*e-Rd*r*o,c=Rd*e+Ld*r*o;Qd.add(ld(md(u*u+a*a),c)),Pd=t,Rd=e,Ld=r}function $r(t,n){return!(!t||!ov.hasOwnProperty(t.type))&&ov[t.type](t,n)}function Vr(t,n){return 0===rv(t,n)}function Wr(t,n){var e=rv(t[0],t[1]);return rv(t[0],n)+rv(n,t[1])<=e+ed}function Zr(t,n){return!!Jd(t.map(Gr),Jr(n))}function Gr(t){return(t=t.map(Jr)).pop(),t}function Jr(t){return[t[0]*cd,t[1]*cd]}function Qr(t,n,e){var r=Ms(t,n-ed,e).concat(n);return function(t){return r.map(function(n){return[t,n]})}}function Kr(t,n,e){var r=Ms(t,n-ed,e).concat(n);return function(t){return r.map(function(n){return[n,t]})}}function ti(){function t(){return{type:"MultiLineString",coordinates:n()}}function n(){return Ms(pd(o/_)*_,i,_).map(h).concat(Ms(pd(s/y)*y,c,y).map(p)).concat(Ms(pd(r/d)*d,e,d).filter(function(t){return sd(t%_)>ed}).map(f)).concat(Ms(pd(a/v)*v,u,v).filter(function(t){return sd(t%y)>ed}).map(l))}var e,r,i,o,u,a,c,s,f,l,h,p,d=10,v=d,_=90,y=360,g=2.5;return t.lines=function(){return n().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[h(o).concat(p(c).slice(1),h(i).reverse().slice(1),p(s).reverse().slice(1))]}},t.extent=function(n){return arguments.length?t.extentMajor(n).extentMinor(n):t.extentMinor()},t.extentMajor=function(n){return arguments.length?(o=+n[0][0],i=+n[1][0],s=+n[0][1],c=+n[1][1],o>i&&(n=o,o=i,i=n),s>c&&(n=s,s=c,c=n),t.precision(g)):[[o,s],[i,c]]},t.extentMinor=function(n){return arguments.length?(r=+n[0][0],e=+n[1][0],a=+n[0][1],u=+n[1][1],r>e&&(n=r,r=e,e=n),a>u&&(n=a,a=u,u=n),t.precision(g)):[[r,a],[e,u]]},t.step=function(n){return arguments.length?t.stepMajor(n).stepMinor(n):t.stepMinor()},t.stepMajor=function(n){return arguments.length?(_=+n[0],y=+n[1],t):[_,y]},t.stepMinor=function(n){return arguments.length?(d=+n[0],v=+n[1],t):[d,v]},t.precision=function(n){return arguments.length?(g=+n,f=Qr(a,u,90),l=Kr(r,e,g),h=Qr(s,c,90),p=Kr(o,i,g),t):g},t.extentMajor([[-180,-90+ed],[180,90-ed]]).extentMinor([[-180,-80-ed],[180,80+ed]])}function ni(){sv.point=ei}function ei(t,n){sv.point=ri,qd=Dd=t,Ud=Od=n}function ri(t,n){cv.add(Od*t-Dd*n),Dd=t,Od=n}function ii(){ri(qd,Ud)}function oi(t,n){vv+=t,_v+=n,++yv}function ui(){Tv.point=ai}function ai(t,n){Tv.point=ci,oi(Yd=t,Bd=n)}function ci(t,n){var e=t-Yd,r=n-Bd,i=md(e*e+r*r);gv+=i*(Yd+t)/2,mv+=i*(Bd+n)/2,xv+=i,oi(Yd=t,Bd=n)}function si(){Tv.point=oi}function fi(){Tv.point=hi}function li(){pi(Fd,Id)}function hi(t,n){Tv.point=pi,oi(Fd=Yd=t,Id=Bd=n)}function pi(t,n){var e=t-Yd,r=n-Bd,i=md(e*e+r*r);gv+=i*(Yd+t)/2,mv+=i*(Bd+n)/2,xv+=i,bv+=(i=Bd*t-Yd*n)*(Yd+t),wv+=i*(Bd+n),Mv+=3*i,oi(Yd=t,Bd=n)}function di(t){this._context=t}function vi(t,n){zv.point=_i,Nv=Ev=t,Sv=Av=n}function _i(t,n){Ev-=t,Av-=n,Cv.add(md(Ev*Ev+Av*Av)),Ev=t,Av=n}function yi(){this._string=[]}function gi(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function mi(t){return t.length>1}function xi(t,n){return((t=t.x)[0]<0?t[1]-id-ed:id-t[1])-((n=n.x)[0]<0?n[1]-id-ed:id-n[1])}function bi(t,n,e,r){var i,o,u=yd(t-e);return sd(u)>ed?fd((yd(n)*(o=hd(r))*yd(e)-yd(r)*(i=hd(n))*yd(t))/(i*o*u)):(n+r)/2}function wi(t){return function(n){var e=new Mi;for(var r in t)e[r]=t[r];return e.stream=n,e}}function Mi(){}function Ti(t,n,e){var r=n[1][0]-n[0][0],i=n[1][1]-n[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),Md(e,t.stream(dv));var u=dv.result(),a=Math.min(r/(u[1][0]-u[0][0]),i/(u[1][1]-u[0][1])),c=+n[0][0]+(r-a*(u[1][0]+u[0][0]))/2,s=+n[0][1]+(i-a*(u[1][1]+u[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([c,s])}function ki(t,n,e){return Ti(t,[[0,0],n],e)}function Ni(t){return wi({point:function(n,e){n=t(n,e),this.stream.point(n[0],n[1])}})}function Si(t,n){function e(r,i,o,u,a,c,s,f,l,h,p,d,v,_){var y=s-r,g=f-i,m=y*y+g*g;if(m>4*n&&v--){var x=u+h,b=a+p,w=c+d,M=md(x*x+b*b+w*w),T=Ge(w/=M),k=sd(sd(w)-1)<ed||sd(o-l)<ed?(o+l)/2:ld(b,x),N=t(k,T),S=N[0],E=N[1],A=S-r,C=E-i,z=g*A-y*C;(z*z/m>n||sd((y*A+g*C)/m-.5)>.3||u*h+a*p+c*d<Uv)&&(e(r,i,o,u,a,c,S,E,k,x/=M,b/=M,w,v,_),_.point(S,E),e(S,E,k,x,b,w,s,f,l,h,p,d,v,_))}}return function(n){function r(e,r){e=t(e,r),n.point(e[0],e[1])}function i(){y=NaN,w.point=o,n.lineStart()}function o(r,i){var o=ar([r,i]),u=t(r,i);e(y,g,_,m,x,b,y=u[0],g=u[1],_=r,m=o[0],x=o[1],b=o[2],qv,n),n.point(y,g)}function u(){w.point=r,n.lineEnd()}function a(){i(),w.point=c,w.lineEnd=s}function c(t,n){o(f=t,n),l=y,h=g,p=m,d=x,v=b,w.point=o}function s(){e(y,g,_,m,x,b,l,h,f,p,d,v,qv,n),w.lineEnd=u,u()}var f,l,h,p,d,v,_,y,g,m,x,b,w={point:r,lineStart:i,lineEnd:u,polygonStart:function(){n.polygonStart(),w.lineStart=a},polygonEnd:function(){n.polygonEnd(),w.lineStart=i}};return w}}function Ei(t){return Ai(function(){return t})()}function Ai(t){function n(t){return t=f(t[0]*cd,t[1]*cd),[t[0]*_+a,c-t[1]*_]}function e(t){return(t=f.invert((t[0]-a)/_,(c-t[1])/_))&&[t[0]*ad,t[1]*ad]}function r(t,n){return t=u(t,n),[t[0]*_+a,c-t[1]*_]}function i(){f=zd(s=Lr(b,w,M),u);var t=u(m,x);return a=y-t[0]*_,c=g+t[1]*_,o()}function o(){return d=v=null,n}var u,a,c,s,f,l,h,p,d,v,_=150,y=480,g=250,m=0,x=0,b=0,w=0,M=0,T=null,k=Rv,N=null,S=uv,E=.5,A=Dv(r,E);return n.stream=function(t){return d&&v===t?d:d=Ov(k(s,A(S(v=t))))},n.clipAngle=function(t){return arguments.length?(k=+t?Lv(T=t*cd,6*cd):(T=null,Rv),o()):T*ad},n.clipExtent=function(t){return arguments.length?(S=null==t?(N=l=h=p=null,uv):Br(N=+t[0][0],l=+t[0][1],h=+t[1][0],p=+t[1][1]),o()):null==N?null:[[N,l],[h,p]]},n.scale=function(t){return arguments.length?(_=+t,i()):_},n.translate=function(t){return arguments.length?(y=+t[0],g=+t[1],i()):[y,g]},n.center=function(t){return arguments.length?(m=t[0]%360*cd,x=t[1]%360*cd,i()):[m*ad,x*ad]},n.rotate=function(t){return arguments.length?(b=t[0]%360*cd,w=t[1]%360*cd,M=t.length>2?t[2]%360*cd:0,i()):[b*ad,w*ad,M*ad]},n.precision=function(t){return arguments.length?(A=Dv(r,E=t*t),o()):md(E)},n.fitExtent=function(t,e){return Ti(n,t,e)},n.fitSize=function(t,e){return ki(n,t,e)},function(){return u=t.apply(this,arguments),n.invert=u.invert&&e,i()}}function Ci(t){var n=0,e=rd/3,r=Ai(t),i=r(n,e);return i.parallels=function(t){return arguments.length?r(n=t[0]*cd,e=t[1]*cd):[n*ad,e*ad]},i}function zi(t){function n(t,n){return[t*e,yd(n)/e]}var e=hd(t);return n.invert=function(t,n){return[t/e,Ge(n*e)]},n}function Pi(t,n){function e(t,n){var e=md(o-2*i*yd(n))/i;return[e*yd(t*=i),u-e*hd(t)]}var r=yd(t),i=(r+yd(n))/2;if(sd(i)<ed)return zi(t);var o=1+r*(2*i-r),u=md(o)/i;return e.invert=function(t,n){var e=u-n;return[ld(t,sd(e))/i*gd(e),Ge((o-(t*t+e*e)*i*i)/(2*i))]},e}function Ri(t){var n=t.length;return{point:function(e,r){for(var i=-1;++i<n;)t[i].point(e,r)},sphere:function(){for(var e=-1;++e<n;)t[e].sphere()},lineStart:function(){for(var e=-1;++e<n;)t[e].lineStart()},lineEnd:function(){for(var e=-1;++e<n;)t[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<n;)t[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<n;)t[e].polygonEnd()}}}function Li(t){return function(n,e){var r=hd(n),i=hd(e),o=t(r*i);return[o*i*yd(n),o*yd(e)]}}function qi(t){return function(n,e){var r=md(n*n+e*e),i=t(r),o=yd(i),u=hd(i);return[ld(n*o,r*u),Ge(r&&e*o/r)]}}function Ui(t,n){return[t,vd(xd((id+n)/2))]}function Di(t){function n(){var n=rd*a(),u=o(jd(o.rotate()).invert([0,0]));return s(null==f?[[u[0]-n,u[1]-n],[u[0]+n,u[1]+n]]:t===Ui?[[Math.max(u[0]-n,f),e],[Math.min(u[0]+n,r),i]]:[[f,Math.max(u[1]-n,e)],[r,Math.min(u[1]+n,i)]])}var e,r,i,o=Ei(t),u=o.center,a=o.scale,c=o.translate,s=o.clipExtent,f=null;return o.scale=function(t){return arguments.length?(a(t),n()):a()},o.translate=function(t){return arguments.length?(c(t),n()):c()},o.center=function(t){return arguments.length?(u(t),n()):u()},o.clipExtent=function(t){return arguments.length?(null==t?f=e=r=i=null:(f=+t[0][0],e=+t[0][1],r=+t[1][0],i=+t[1][1]),n()):null==f?null:[[f,e],[r,i]]},n()}function Oi(t){return xd((id+t)/2)}function Fi(t,n){function e(t,n){o>0?n<-id+ed&&(n=-id+ed):n>id-ed&&(n=id-ed);var e=o/_d(Oi(n),i);return[e*yd(i*t),o-e*hd(i*t)]}var r=hd(t),i=t===n?yd(t):vd(r/hd(n))/vd(Oi(n)/Oi(t)),o=r*_d(Oi(t),i)/i;return i?(e.invert=function(t,n){var e=o-n,r=gd(i)*md(t*t+e*e);return[ld(t,sd(e))/i*gd(e),2*fd(_d(o/r,1/i))-id]},e):Ui}function Ii(t,n){return[t,n]}function Yi(t,n){function e(t,n){var e=o-n,r=i*t;return[e*yd(r),o-e*hd(r)]}var r=hd(t),i=t===n?yd(t):(r-hd(n))/(n-t),o=r/i+t;return sd(i)<ed?Ii:(e.invert=function(t,n){var e=o-n;return[ld(t,sd(e))/i*gd(e),o-gd(i)*md(t*t+e*e)]},e)}function Bi(t,n){var e=hd(n),r=hd(t)*e;return[e*yd(t)/r,yd(n)/r]}function ji(t,n,e,r){return 1===t&&1===n&&0===e&&0===r?uv:wi({point:function(i,o){this.stream.point(i*t+e,o*n+r)}})}function Hi(t,n){return[hd(n)*yd(t),yd(n)]}function Xi(t,n){var e=hd(n),r=1+hd(t)*e;return[e*yd(t)/r,yd(n)/r]}function $i(t,n){return[vd(xd((id+n)/2)),-t]}function Vi(t,n){return t.parent===n.parent?1:2}function Wi(t){return t.reduce(Zi,0)/t.length}function Zi(t,n){return t+n.x}function Gi(t){return 1+t.reduce(Ji,0)}function Ji(t,n){return Math.max(t,n.y)}function Qi(t){for(var n;n=t.children;)t=n[0];return t}function Ki(t){for(var n;n=t.children;)t=n[n.length-1];return t}function to(t){var n=0,e=t.children,r=e&&e.length;if(r)for(;--r>=0;)n+=e[r].value;else n=1;t.value=n}function no(t,n){if(t===n)return t;var e=t.ancestors(),r=n.ancestors(),i=null;for(t=e.pop(),n=r.pop();t===n;)i=t,t=e.pop(),n=r.pop();return i}function eo(t,n){var e,r,i,o,u,a=new uo(t),c=+t.value&&(a.value=t.value),s=[a];for(null==n&&(n=ro);e=s.pop();)if(c&&(e.value=+e.data.value),(i=n(e.data))&&(u=i.length))for(e.children=new Array(u),o=u-1;o>=0;--o)s.push(r=e.children[o]=new uo(i[o])),r.parent=e,r.depth=e.depth+1;return a.eachBefore(oo)}function ro(t){return t.children}function io(t){t.data=t.data.data}function oo(t){var n=0;do{t.height=n}while((t=t.parent)&&t.height<++n)}function uo(t){this.data=t,this.depth=this.height=0,this.parent=null}function ao(t){for(var n,e,r=t.length;r;)e=Math.random()*r--|0,n=t[r],t[r]=t[e],t[e]=n;return t}function co(t,n){var e,r;if(lo(n,t))return[n];for(e=0;e<t.length;++e)if(so(n,t[e])&&lo(vo(t[e],n),t))return[t[e],n];for(e=0;e<t.length-1;++e)for(r=e+1;r<t.length;++r)if(so(vo(t[e],t[r]),n)&&so(vo(t[e],n),t[r])&&so(vo(t[r],n),t[e])&&lo(_o(t[e],t[r],n),t))return[t[e],t[r],n];throw new Error}function so(t,n){var e=t.r-n.r,r=n.x-t.x,i=n.y-t.y;return e<0||e*e<r*r+i*i}function fo(t,n){var e=t.r-n.r+1e-6,r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function lo(t,n){for(var e=0;e<n.length;++e)if(!fo(t,n[e]))return!1;return!0}function ho(t){switch(t.length){case 1:return po(t[0]);case 2:return vo(t[0],t[1]);case 3:return _o(t[0],t[1],t[2])}}function po(t){return{x:t.x,y:t.y,r:t.r}}function vo(t,n){var e=t.x,r=t.y,i=t.r,o=n.x,u=n.y,a=n.r,c=o-e,s=u-r,f=a-i,l=Math.sqrt(c*c+s*s);return{x:(e+o+c/l*f)/2,y:(r+u+s/l*f)/2,r:(l+i+a)/2}}function _o(t,n,e){var r=t.x,i=t.y,o=t.r,u=n.x,a=n.y,c=n.r,s=e.x,f=e.y,l=e.r,h=r-u,p=r-s,d=i-a,v=i-f,_=c-o,y=l-o,g=r*r+i*i-o*o,m=g-u*u-a*a+c*c,x=g-s*s-f*f+l*l,b=p*d-h*v,w=(d*x-v*m)/(2*b)-r,M=(v*_-d*y)/b,T=(p*m-h*x)/(2*b)-i,k=(h*y-p*_)/b,N=M*M+k*k-1,S=2*(o+w*M+T*k),E=w*w+T*T-o*o,A=-(N?(S+Math.sqrt(S*S-4*N*E))/(2*N):E/S);return{x:r+w+M*A,y:i+T+k*A,r:A}}function yo(t,n,e){var r=t.x,i=t.y,o=n.r+e.r,u=t.r+e.r,a=n.x-r,c=n.y-i,s=a*a+c*c;if(s){var f=.5+((u*=u)-(o*=o))/(2*s),l=Math.sqrt(Math.max(0,2*o*(u+s)-(u-=s)*u-o*o))/(2*s);e.x=r+f*a+l*c,e.y=i+f*c-l*a}else e.x=r+u,e.y=i}function go(t,n){var e=n.x-t.x,r=n.y-t.y,i=t.r+n.r;return i*i-1e-6>e*e+r*r}function mo(t){var n=t._,e=t.next._,r=n.r+e.r,i=(n.x*e.r+e.x*n.r)/r,o=(n.y*e.r+e.y*n.r)/r;return i*i+o*o}function xo(t){this._=t,this.next=null,this.previous=null}function bo(t){if(!(i=t.length))return 0;var n,e,r,i,o,u,a,c,s,f,l;if(n=t[0],n.x=0,n.y=0,!(i>1))return n.r;if(e=t[1],n.x=-e.r,e.x=n.r,e.y=0,!(i>2))return n.r+e.r;yo(e,n,r=t[2]),n=new xo(n),e=new xo(e),r=new xo(r),n.next=r.previous=e,e.next=n.previous=r,r.next=e.previous=n;t:for(a=3;a<i;++a){yo(n._,e._,r=t[a]),r=new xo(r),c=e.next,s=n.previous,f=e._.r,l=n._.r;do{if(f<=l){if(go(c._,r._)){e=c,n.next=e,e.previous=n,--a;continue t}f+=c._.r,c=c.next}else{if(go(s._,r._)){(n=s).next=e,e.previous=n,--a;continue t}l+=s._.r,s=s.previous}}while(c!==s.next);for(r.previous=n,r.next=e,n.next=e.previous=e=r,o=mo(n);(r=r.next)!==e;)(u=mo(r))<o&&(n=r,o=u);e=n.next}for(n=[e._],r=e;(r=r.next)!==e;)n.push(r._);for(r=Hv(n),a=0;a<i;++a)n=t[a],n.x-=r.x,n.y-=r.y;return r.r}function wo(t){return null==t?null:Mo(t)}function Mo(t){if("function"!=typeof t)throw new Error;return t}function To(){return 0}function ko(t){return Math.sqrt(t.value)}function No(t){return function(n){n.children||(n.r=Math.max(0,+t(n)||0))}}function So(t,n){return function(e){if(r=e.children){var r,i,o,u=r.length,a=t(e)*n||0;if(a)for(i=0;i<u;++i)r[i].r+=a;if(o=bo(r),a)for(i=0;i<u;++i)r[i].r-=a;e.r=o+a}}}function Eo(t){return function(n){var e=n.parent;n.r*=t,e&&(n.x=e.x+t*n.x,n.y=e.y+t*n.y)}}function Ao(t){return t.id}function Co(t){return t.parentId}function zo(t,n){return t.parent===n.parent?1:2}function Po(t){var n=t.children;return n?n[0]:t.t}function Ro(t){var n=t.children;return n?n[n.length-1]:t.t}function Lo(t,n,e){var r=e/(n.i-t.i);n.c-=r,n.s+=e,t.c+=r,n.z+=e,n.m+=e}function qo(t){for(var n,e=0,r=0,i=t.children,o=i.length;--o>=0;)(n=i[o]).z+=e,n.m+=e,e+=n.s+(r+=n.c)}function Uo(t,n,e){return t.a.parent===n.parent?t.a:e}function Do(t,n){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}function Oo(t){for(var n,e,r,i,o,u=new Do(t,0),a=[u];n=a.pop();)if(r=n._.children)for(n.children=new Array(o=r.length),i=o-1;i>=0;--i)a.push(e=n.children[i]=new Do(r[i],i)),e.parent=n;return(u.parent=new Do(null,0)).children=[u],u}function Fo(t,n,e,r,i,o){for(var u,a,c,s,f,l,h,p,d,v,_,y=[],g=n.children,m=0,x=0,b=g.length,w=n.value;m<b;){c=i-e,s=o-r;do{f=g[x++].value}while(!f&&x<b);for(l=h=f,_=f*f*(v=Math.max(s/c,c/s)/(w*t)),d=Math.max(h/_,_/l);x<b;++x){if(f+=a=g[x].value,a<l&&(l=a),a>h&&(h=a),_=f*f*v,(p=Math.max(h/_,_/l))>d){f-=a;break}d=p}y.push(u={value:f,dice:c<s,children:g.slice(m,x)}),u.dice?Vv(u,e,r,i,w?r+=s*f/w:o):Jv(u,e,r,w?e+=c*f/w:i,o),w-=f,m=x}return y}function Io(t,n){return t[0]-n[0]||t[1]-n[1]}function Yo(t){for(var n=t.length,e=[0,1],r=2,i=2;i<n;++i){for(;r>1&&n_(t[e[r-2]],t[e[r-1]],t[i])<=0;)--r;e[r++]=i}return e.slice(0,r)}function Bo(t){this._size=t,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function jo(t){if(!t._start)try{Ho(t)}catch(n){if(t._tasks[t._ended+t._active-1])$o(t,n);else if(!t._data)throw n}}function Ho(t){for(;t._start=t._waiting&&t._active<t._size;){var n=t._ended+t._active,e=t._tasks[n],r=e.length-1,i=e[r];e[r]=Xo(t,n),--t._waiting,++t._active,e=i.apply(null,e),t._tasks[n]&&(t._tasks[n]=e||r_)}}function Xo(t,n){return function(e,r){t._tasks[n]&&(--t._active,++t._ended,t._tasks[n]=null,null==t._error&&(null!=e?$o(t,e):(t._data[n]=r,t._waiting?jo(t):Vo(t))))}}function $o(t,n){var e,r=t._tasks.length;for(t._error=n,t._data=void 0,t._waiting=NaN;--r>=0;)if((e=t._tasks[r])&&(t._tasks[r]=null,e.abort))try{e.abort()}catch(n){}t._active=NaN,Vo(t)}function Vo(t){if(!t._active&&t._call){var n=t._data;t._data=void 0,t._call(t._error,n)}}function Wo(t){if(null==t)t=1/0;else if(!((t=+t)>=1))throw new Error("invalid concurrency");return new Bo(t)}function Zo(t){return function(n,e){t(null==n?e:null)}}function Go(t){var n=t.responseType;return n&&"text"!==n?t.response:t.responseText}function Jo(t,n){return function(e){return t(e.responseText,n)}}function Qo(t){function n(n){var o=n+"",u=e.get(o);if(!u){if(i!==M_)return i;e.set(o,u=r.push(n))}return t[(u-1)%t.length]}var e=we(),r=[],i=M_;return t=null==t?[]:w_.call(t),n.domain=function(t){if(!arguments.length)return r.slice();r=[],e=we();for(var i,o,u=-1,a=t.length;++u<a;)e.has(o=(i=t[u])+"")||e.set(o,r.push(i));return n},n.range=function(e){return arguments.length?(t=w_.call(e),n):t.slice()},n.unknown=function(t){return arguments.length?(i=t,n):i},n.copy=function(){return Qo().domain(r).range(t).unknown(i)},n}function Ko(){function t(){var t=i().length,r=u[1]<u[0],l=u[r-0],h=u[1-r];n=(h-l)/Math.max(1,t-c+2*s),a&&(n=Math.floor(n)),l+=(h-l-n*(t-c))*f,e=n*(1-c),a&&(l=Math.round(l),e=Math.round(e));var p=Ms(t).map(function(t){return l+n*t});return o(r?p.reverse():p)}var n,e,r=Qo().unknown(void 0),i=r.domain,o=r.range,u=[0,1],a=!1,c=0,s=0,f=.5;return delete r.unknown,r.domain=function(n){return arguments.length?(i(n),t()):i()},r.range=function(n){return arguments.length?(u=[+n[0],+n[1]],t()):u.slice()},r.rangeRound=function(n){return u=[+n[0],+n[1]],a=!0,t()},r.bandwidth=function(){return e},r.step=function(){return n},r.round=function(n){return arguments.length?(a=!!n,t()):a},r.padding=function(n){return arguments.length?(c=s=Math.max(0,Math.min(1,n)),t()):c},r.paddingInner=function(n){return arguments.length?(c=Math.max(0,Math.min(1,n)),t()):c},r.paddingOuter=function(n){return arguments.length?(s=Math.max(0,Math.min(1,n)),t()):s},r.align=function(n){return arguments.length?(f=Math.max(0,Math.min(1,n)),t()):f},r.copy=function(){return Ko().domain(i()).range(u).round(a).paddingInner(c).paddingOuter(s).align(f)},t()}function tu(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return tu(n())},t}function nu(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:T_(n)}function eu(t){return function(n,e){var r=t(n=+n,e=+e);return function(t){return t<=n?0:t>=e?1:r(t)}}}function ru(t){return function(n,e){var r=t(n=+n,e=+e);return function(t){return t<=0?n:t>=1?e:r(t)}}}function iu(t,n,e,r){var i=t[0],o=t[1],u=n[0],a=n[1];return o<i?(i=e(o,i),u=r(a,u)):(i=e(i,o),u=r(u,a)),function(t){return u(i(t))}}function ou(t,n,e,r){var i=Math.min(t.length,n.length)-1,o=new Array(i),u=new Array(i),a=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++a<i;)o[a]=e(t[a],t[a+1]),u[a]=r(n[a],n[a+1]);return function(n){var e=hs(t,n,1,i)-1;return u[e](o[e](n))}}function uu(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function au(t,n){function e(){return i=Math.min(a.length,c.length)>2?ou:iu,o=u=null,r}function r(n){return(o||(o=i(a,c,f?eu(t):t,s)))(+n)}var i,o,u,a=N_,c=N_,s=cl,f=!1;return r.invert=function(t){return(u||(u=i(c,a,nu,f?ru(n):n)))(+t)},r.domain=function(t){return arguments.length?(a=b_.call(t,k_),e()):a.slice()},r.range=function(t){return arguments.length?(c=w_.call(t),e()):c.slice()},r.rangeRound=function(t){return c=w_.call(t),s=sl,e()},r.clamp=function(t){return arguments.length?(f=!!t,e()):f},r.interpolate=function(t){return arguments.length?(s=t,e()):s},e()}function cu(t){var n=t.domain;return t.ticks=function(t){var e=n();return Ss(e[0],e[e.length-1],null==t?10:t)},t.tickFormat=function(t,e){return S_(n(),t,e)},t.nice=function(e){null==e&&(e=10);var i,o=n(),u=0,a=o.length-1,c=o[u],s=o[a];return s<c&&(i=c,c=s,s=i,i=u,u=a,a=i),(i=r(c,s,e))>0?i=r(c=Math.floor(c/i)*i,s=Math.ceil(s/i)*i,e):i<0&&(i=r(c=Math.ceil(c*i)/i,s=Math.floor(s*i)/i,e)),i>0?(o[u]=Math.floor(c/i)*i,o[a]=Math.ceil(s/i)*i,n(o)):i<0&&(o[u]=Math.ceil(c*i)/i,o[a]=Math.floor(s*i)/i,n(o)),t},t}function su(){var t=au(nu,rl);return t.copy=function(){return uu(t,su())},cu(t)}function fu(){function t(t){return+t}var n=[0,1];return t.invert=t,t.domain=t.range=function(e){return arguments.length?(n=b_.call(e,k_),t):n.slice()},t.copy=function(){return fu().domain(n)},cu(t)}function lu(t,n){return(n=Math.log(n/t))?function(e){return Math.log(e/t)/n}:T_(n)}function hu(t,n){return t<0?function(e){return-Math.pow(-n,e)*Math.pow(-t,1-e)}:function(e){return Math.pow(n,e)*Math.pow(t,1-e)}}function pu(t){return isFinite(t)?+("1e"+t):t<0?0:t}function du(t){return 10===t?pu:t===Math.E?Math.exp:function(n){return Math.pow(t,n)}}function vu(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(n){return Math.log(n)/t})}function _u(t){return function(n){return-t(-n)}}function yu(){function n(){return o=vu(i),u=du(i),r()[0]<0&&(o=_u(o),u=_u(u)),e}var e=au(lu,hu).domain([1,10]),r=e.domain,i=10,o=vu(10),u=du(10);return e.base=function(t){return arguments.length?(i=+t,n()):i},e.domain=function(t){return arguments.length?(r(t),n()):r()},e.ticks=function(t){var n,e=r(),a=e[0],c=e[e.length-1];(n=c<a)&&(h=a,a=c,c=h);var s,f,l,h=o(a),p=o(c),d=null==t?10:+t,v=[];if(!(i%1)&&p-h<d){if(h=Math.round(h)-1,p=Math.round(p)+1,a>0){for(;h<p;++h)for(f=1,s=u(h);f<i;++f)if(!((l=s*f)<a)){if(l>c)break;v.push(l)}}else for(;h<p;++h)for(f=i-1,s=u(h);f>=1;--f)if(!((l=s*f)<a)){if(l>c)break;v.push(l)}}else v=Ss(h,p,Math.min(p-h,d)).map(u);return n?v.reverse():v},e.tickFormat=function(n,r){if(null==r&&(r=10===i?".0e":","),"function"!=typeof r&&(r=t.format(r)),n===1/0)return r;null==n&&(n=10);var a=Math.max(1,i*n/e.ticks().length);return function(t){var n=t/u(Math.round(o(t)));return n*i<i-.5&&(n*=i),n<=a?r(t):""}},e.nice=function(){return r(E_(r(),{floor:function(t){return u(Math.floor(o(t)))},ceil:function(t){return u(Math.ceil(o(t)))}}))},e.copy=function(){return uu(e,yu().base(i))},e}function gu(t,n){return t<0?-Math.pow(-t,n):Math.pow(t,n)}function mu(){var t=1,n=au(function(n,e){return(e=gu(e,t)-(n=gu(n,t)))?function(r){return(gu(r,t)-n)/e}:T_(e)},function(n,e){return e=gu(e,t)-(n=gu(n,t)),function(r){return gu(n+e*r,1/t)}}),e=n.domain;return n.exponent=function(n){return arguments.length?(t=+n,e(e())):t},n.copy=function(){return uu(n,mu().exponent(t))},cu(n)}function xu(){function t(){var t=0,o=Math.max(1,r.length);for(i=new Array(o-1);++t<o;)i[t-1]=As(e,t/o);return n}function n(t){if(!isNaN(t=+t))return r[hs(i,t)]}var e=[],r=[],i=[];return n.invertExtent=function(t){var n=r.indexOf(t);return n<0?[NaN,NaN]:[n>0?i[n-1]:e[0],n<i.length?i[n]:e[e.length-1]]},n.domain=function(n){if(!arguments.length)return e.slice();e=[];for(var r,i=0,o=n.length;i<o;++i)null==(r=n[i])||isNaN(r=+r)||e.push(r);return e.sort(ss),t()},n.range=function(n){return arguments.length?(r=w_.call(n),t()):r.slice()},n.quantiles=function(){return i.slice()},n.copy=function(){return xu().domain(e).range(r)},n}function bu(){function t(t){if(t<=t)return u[hs(o,t,0,i)]}function n(){var n=-1;for(o=new Array(i);++n<i;)o[n]=((n+1)*r-(n-i)*e)/(i+1);return t}var e=0,r=1,i=1,o=[.5],u=[0,1];return t.domain=function(t){return arguments.length?(e=+t[0],r=+t[1],n()):[e,r]},t.range=function(t){return arguments.length?(i=(u=w_.call(t)).length-1,n()):u.slice()},t.invertExtent=function(t){var n=u.indexOf(t);return n<0?[NaN,NaN]:n<1?[e,o[0]]:n>=i?[o[i-1],r]:[o[n-1],o[n]]},t.copy=function(){return bu().domain([e,r]).range(u)},cu(t)}function wu(){function t(t){if(t<=t)return e[hs(n,t,0,r)]}var n=[.5],e=[0,1],r=1;return t.domain=function(i){return arguments.length?(n=w_.call(i),r=Math.min(n.length,e.length-1),t):n.slice()},t.range=function(i){return arguments.length?(e=w_.call(i),r=Math.min(n.length,e.length-1),t):e.slice()},t.invertExtent=function(t){var r=e.indexOf(t);return[n[r-1],n[r]]},t.copy=function(){return wu().domain(n).range(e)},t}function Mu(t,n,e,r){function i(n){return t(n=new Date(+n)),n}return i.floor=i,i.ceil=function(e){return t(e=new Date(e-1)),n(e,1),t(e),e},i.round=function(t){var n=i(t),e=i.ceil(t);return t-n<e-t?n:e},i.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},i.range=function(e,r,o){var u=[];if(e=i.ceil(e),o=null==o?1:Math.floor(o),!(e<r&&o>0))return u;do{u.push(new Date(+e))}while(n(e,o),t(e),e<r);return u},i.filter=function(e){return Mu(function(n){if(n>=n)for(;t(n),!e(n);)n.setTime(n-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;n(t,-1),!e(t););else for(;--r>=0;)for(;n(t,1),!e(t););})},e&&(i.count=function(n,r){return A_.setTime(+n),C_.setTime(+r),t(A_),t(C_),Math.floor(e(A_,C_))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(n){return r(n)%t==0}:function(n){return i.count(0,n)%t==0}):i:null}),i}function Tu(t){return Mu(function(n){n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+7*n)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*R_)/L_})}function ku(t){return Mu(function(n){n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+7*n)},function(t,n){return(n-t)/L_})}function Nu(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Su(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Eu(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function Au(t){function n(t,n){return function(e){var r,i,o,u=[],a=-1,c=0,s=t.length;for(e instanceof Date||(e=new Date(+e));++a<s;)37===t.charCodeAt(a)&&(u.push(t.slice(c,a)),null!=(i=Py[r=t.charAt(++a)])?r=t.charAt(++a):i="e"===r?" ":"0",(o=n[r])&&(r=o(e,i)),u.push(r),c=a+1);return u.push(t.slice(c,a)),u.join("")}}function e(t,n){return function(e){var i=Eu(1900);if(r(i,t,e+="",0)!=e.length)return null;if("p"in i&&(i.H=i.H%12+12*i.p),"W"in i||"U"in i){"w"in i||(i.w="W"in i?1:0);var o="Z"in i?Su(Eu(i.y)).getUTCDay():n(Eu(i.y)).getDay();i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(o+5)%7:i.w+7*i.U-(o+6)%7}return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Su(i)):n(i)}}function r(t,n,e,r){for(var i,o,u=0,a=n.length,c=e.length;u<a;){if(r>=c)return-1;if(37===(i=n.charCodeAt(u++))){if(i=n.charAt(u++),!(o=T[i in Py?n.charAt(u++):i])||(r=o(t,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}var i=t.dateTime,o=t.date,u=t.time,a=t.periods,c=t.days,s=t.shortDays,f=t.months,l=t.shortMonths,h=Pu(a),p=Ru(a),d=Pu(c),v=Ru(c),_=Pu(s),y=Ru(s),g=Pu(f),m=Ru(f),x=Pu(l),b=Ru(l),w={a:function(t){return s[t.getDay()]},A:function(t){return c[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return f[t.getMonth()]},c:null,d:Wu,e:Wu,H:Zu,I:Gu,j:Ju,L:Qu,m:Ku,M:ta,p:function(t){return a[+(t.getHours()>=12)]},S:na,U:ea,w:ra,W:ia,x:null,X:null,y:oa,Y:ua,Z:aa,"%":wa},M={a:function(t){return s[t.getUTCDay()]},A:function(t){return c[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return f[t.getUTCMonth()]},c:null,d:ca,e:ca,H:sa,I:fa,j:la,L:ha,m:pa,M:da,p:function(t){return a[+(t.getUTCHours()>=12)]},S:va,U:_a,w:ya,W:ga,x:null,X:null,y:ma,Y:xa,Z:ba,"%":wa},T={a:function(t,n,e){var r=_.exec(n.slice(e));return r?(t.w=y[r[0].toLowerCase()],e+r[0].length):-1},A:function(t,n,e){var r=d.exec(n.slice(e));return r?(t.w=v[r[0].toLowerCase()],e+r[0].length):-1},b:function(t,n,e){var r=x.exec(n.slice(e));return r?(t.m=b[r[0].toLowerCase()],e+r[0].length):-1},B:function(t,n,e){var r=g.exec(n.slice(e));return r?(t.m=m[r[0].toLowerCase()],e+r[0].length):-1},c:function(t,n,e){return r(t,i,n,e)},d:Yu,e:Yu,H:ju,I:ju,j:Bu,L:$u,m:Iu,M:Hu,p:function(t,n,e){var r=h.exec(n.slice(e));return r?(t.p=p[r[0].toLowerCase()],e+r[0].length):-1},S:Xu,U:qu,w:Lu,W:Uu,x:function(t,n,e){return r(t,o,n,e)},X:function(t,n,e){return r(t,u,n,e)},y:Ou,Y:Du,Z:Fu,"%":Vu};return w.x=n(o,w),w.X=n(u,w),w.c=n(i,w),M.x=n(o,M),M.X=n(u,M),M.c=n(i,M),{format:function(t){var e=n(t+="",w);return e.toString=function(){return t},e},parse:function(t){var n=e(t+="",Nu);return n.toString=function(){return t},n},utcFormat:function(t){var e=n(t+="",M);return e.toString=function(){return t},e},utcParse:function(t){var n=e(t,Su);return n.toString=function(){return t},n}}}function Cu(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<e?new Array(e-o+1).join(n)+i:i)}function zu(t){return t.replace(qy,"\\$&")}function Pu(t){return new RegExp("^(?:"+t.map(zu).join("|")+")","i")}function Ru(t){for(var n={},e=-1,r=t.length;++e<r;)n[t[e].toLowerCase()]=e;return n}function Lu(t,n,e){var r=Ry.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function qu(t,n,e){var r=Ry.exec(n.slice(e));return r?(t.U=+r[0],e+r[0].length):-1}function Uu(t,n,e){var r=Ry.exec(n.slice(e));return r?(t.W=+r[0],e+r[0].length):-1}function Du(t,n,e){var r=Ry.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function Ou(t,n,e){var r=Ry.exec(n.slice(e,e+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),e+r[0].length):-1}function Fu(t,n,e){var r=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(n.slice(e,e+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),e+r[0].length):-1}function Iu(t,n,e){var r=Ry.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function Yu(t,n,e){var r=Ry.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function Bu(t,n,e){var r=Ry.exec(n.slice(e,e+3));return r?(t.m=0,t.d=+r[0],e+r[0].length):-1}function ju(t,n,e){var r=Ry.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function Hu(t,n,e){var r=Ry.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function Xu(t,n,e){var r=Ry.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function $u(t,n,e){var r=Ry.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function Vu(t,n,e){var r=Ly.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function Wu(t,n){return Cu(t.getDate(),n,2)}function Zu(t,n){return Cu(t.getHours(),n,2)}function Gu(t,n){return Cu(t.getHours()%12||12,n,2)}function Ju(t,n){return Cu(1+Y_.count(oy(t),t),n,3)}function Qu(t,n){return Cu(t.getMilliseconds(),n,3)}function Ku(t,n){return Cu(t.getMonth()+1,n,2)}function ta(t,n){return Cu(t.getMinutes(),n,2)}function na(t,n){return Cu(t.getSeconds(),n,2)}function ea(t,n){return Cu(j_.count(oy(t),t),n,2)}function ra(t){return t.getDay()}function ia(t,n){return Cu(H_.count(oy(t),t),n,2)}function oa(t,n){return Cu(t.getFullYear()%100,n,2)}function ua(t,n){return Cu(t.getFullYear()%1e4,n,4)}function aa(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+Cu(n/60|0,"0",2)+Cu(n%60,"0",2)}function ca(t,n){return Cu(t.getUTCDate(),n,2)}function sa(t,n){return Cu(t.getUTCHours(),n,2)}function fa(t,n){return Cu(t.getUTCHours()%12||12,n,2)}function la(t,n){return Cu(1+ly.count(Ay(t),t),n,3)}function ha(t,n){return Cu(t.getUTCMilliseconds(),n,3)}function pa(t,n){return Cu(t.getUTCMonth()+1,n,2)}function da(t,n){return Cu(t.getUTCMinutes(),n,2)}function va(t,n){return Cu(t.getUTCSeconds(),n,2)}function _a(t,n){return Cu(py.count(Ay(t),t),n,2)}function ya(t){return t.getUTCDay()}function ga(t,n){return Cu(dy.count(Ay(t),t),n,2)}function ma(t,n){return Cu(t.getUTCFullYear()%100,n,2)}function xa(t,n){return Cu(t.getUTCFullYear()%1e4,n,4)}function ba(){return"+0000"}function wa(){return"%"}function Ma(n){return Cy=Au(n),t.timeFormat=Cy.format,t.timeParse=Cy.parse,t.utcFormat=Cy.utcFormat,t.utcParse=Cy.utcParse,Cy}function Ta(t){return new Date(t)}function ka(t){return t instanceof Date?+t:+new Date(+t)}function Na(t,n,e,r,o,u,a,c,s){function f(i){return(a(i)<i?v:u(i)<i?_:o(i)<i?y:r(i)<i?g:n(i)<i?e(i)<i?m:x:t(i)<i?b:w)(i)}function l(n,e,r,o){if(null==n&&(n=10),"number"==typeof n){var u=Math.abs(r-e)/n,a=fs(function(t){return t[2]}).right(M,u);a===M.length?(o=i(e/Hy,r/Hy,n),n=t):a?(o=(a=M[u/M[a-1][2]<M[a][2]/u?a-1:a])[1],n=a[0]):(o=i(e,r,n),n=c)}return null==o?n:n.every(o)}var h=au(nu,rl),p=h.invert,d=h.domain,v=s(".%L"),_=s(":%S"),y=s("%I:%M"),g=s("%I %p"),m=s("%a %d"),x=s("%b %d"),b=s("%B"),w=s("%Y"),M=[[a,1,Oy],[a,5,5*Oy],[a,15,15*Oy],[a,30,30*Oy],[u,1,Fy],[u,5,5*Fy],[u,15,15*Fy],[u,30,30*Fy],[o,1,Iy],[o,3,3*Iy],[o,6,6*Iy],[o,12,12*Iy],[r,1,Yy],[r,2,2*Yy],[e,1,By],[n,1,jy],[n,3,3*jy],[t,1,Hy]];return h.invert=function(t){return new Date(p(t))},h.domain=function(t){return arguments.length?d(b_.call(t,ka)):d().map(Ta)},h.ticks=function(t,n){var e,r=d(),i=r[0],o=r[r.length-1],u=o<i;return u&&(e=i,i=o,o=e),e=l(t,i,o,n),e=e?e.range(i,o+1):[],u?e.reverse():e},h.tickFormat=function(t,n){return null==n?f:s(n)},h.nice=function(t,n){var e=d();return(t=l(t,e[0],e[e.length-1],n))?d(E_(e,t)):h},h.copy=function(){return uu(h,Na(t,n,e,r,o,u,a,c,s))},h}function Sa(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}}function Ea(t){function n(n){var o=(n-e)/(r-e);return t(i?Math.max(0,Math.min(1,o)):o)}var e=0,r=1,i=!1;return n.domain=function(t){return arguments.length?(e=+t[0],r=+t[1],n):[e,r]},n.clamp=function(t){return arguments.length?(i=!!t,n):i},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return Ea(t).domain([e,r]).clamp(i)},cu(n)}function Aa(t){return t>1?0:t<-1?pg:Math.acos(t)}function Ca(t){return t>=1?dg:t<=-1?-dg:Math.asin(t)}function za(t){return t.innerRadius}function Pa(t){return t.outerRadius}function Ra(t){return t.startAngle}function La(t){return t.endAngle}function qa(t){return t&&t.padAngle}function Ua(t,n,e,r,i,o,u,a){var c=e-t,s=r-n,f=u-i,l=a-o,h=(f*(n-o)-l*(t-i))/(l*c-f*s);return[t+h*c,n+h*s]}function Da(t,n,e,r,i,o,u){var a=t-e,c=n-r,s=(u?o:-o)/lg(a*a+c*c),f=s*c,l=-s*a,h=t+f,p=n+l,d=e+f,v=r+l,_=(h+d)/2,y=(p+v)/2,g=d-h,m=v-p,x=g*g+m*m,b=i-o,w=h*v-d*p,M=(m<0?-1:1)*lg(cg(0,b*b*x-w*w)),T=(w*m-g*M)/x,k=(-w*g-m*M)/x,N=(w*m+g*M)/x,S=(-w*g+m*M)/x,E=T-_,A=k-y,C=N-_,z=S-y;return E*E+A*A>C*C+z*z&&(T=N,k=S),{cx:T,cy:k,x01:-f,y01:-l,x11:T*(i/b-1),y11:k*(i/b-1)}}function Oa(t){this._context=t}function Fa(t){return t[0]}function Ia(t){return t[1]}function Ya(t){this._curve=t}function Ba(t){function n(n){return new Ya(t(n))}return n._curve=t,n}function ja(t){var n=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?n(Ba(t)):n()._curve},t}function Ha(t){return t.source}function Xa(t){return t.target}function $a(t){function n(){var n,a=kg.call(arguments),c=e.apply(this,a),s=r.apply(this,a);if(u||(u=n=ve()),t(u,+i.apply(this,(a[0]=c,a)),+o.apply(this,a),+i.apply(this,(a[0]=s,a)),+o.apply(this,a)),n)return u=null,n+""||null}var e=Ha,r=Xa,i=Fa,o=Ia,u=null;return n.source=function(t){return arguments.length?(e=t,n):e},n.target=function(t){return arguments.length?(r=t,n):r},n.x=function(t){return arguments.length?(i="function"==typeof t?t:ig(+t),n):i},n.y=function(t){return arguments.length?(o="function"==typeof t?t:ig(+t),n):o},n.context=function(t){return arguments.length?(u=null==t?null:t,n):u},n}function Va(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n=(n+r)/2,e,n,i,r,i)}function Wa(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n,e=(e+i)/2,r,e,r,i)}function Za(t,n,e,r,i){var o=Tg(n,e),u=Tg(n,e=(e+i)/2),a=Tg(r,e),c=Tg(r,i);t.moveTo(o[0],o[1]),t.bezierCurveTo(u[0],u[1],a[0],a[1],c[0],c[1])}function Ga(t,n,e){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+e)/6)}function Ja(t){this._context=t}function Qa(t){this._context=t}function Ka(t){this._context=t}function tc(t,n){this._basis=new Ja(t),this._beta=n}function nc(t,n,e){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-n),t._y2+t._k*(t._y1-e),t._x2,t._y2)}function ec(t,n){this._context=t,this._k=(1-n)/6}function rc(t,n){this._context=t,this._k=(1-n)/6}function ic(t,n){this._context=t,this._k=(1-n)/6}function oc(t,n,e){var r=t._x1,i=t._y1,o=t._x2,u=t._y2;if(t._l01_a>hg){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>hg){var s=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*s+t._x1*t._l23_2a-n*t._l12_2a)/f,u=(u*s+t._y1*t._l23_2a-e*t._l12_2a)/f}t._context.bezierCurveTo(r,i,o,u,t._x2,t._y2)}function uc(t,n){this._context=t,this._alpha=n}function ac(t,n){this._context=t,this._alpha=n}function cc(t,n){this._context=t,this._alpha=n}function sc(t){this._context=t}function fc(t){return t<0?-1:1}function lc(t,n,e){var r=t._x1-t._x0,i=n-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),u=(e-t._y1)/(i||r<0&&-0),a=(o*i+u*r)/(r+i);return(fc(o)+fc(u))*Math.min(Math.abs(o),Math.abs(u),.5*Math.abs(a))||0}function hc(t,n){var e=t._x1-t._x0;return e?(3*(t._y1-t._y0)/e-n)/2:n}function pc(t,n,e){var r=t._x0,i=t._y0,o=t._x1,u=t._y1,a=(o-r)/3;t._context.bezierCurveTo(r+a,i+a*n,o-a,u-a*e,o,u)}function dc(t){this._context=t}function vc(t){this._context=new _c(t)}function _c(t){this._context=t}function yc(t){this._context=t}function gc(t){var n,e,r=t.length-1,i=new Array(r),o=new Array(r),u=new Array(r);for(i[0]=0,o[0]=2,u[0]=t[0]+2*t[1],n=1;n<r-1;++n)i[n]=1,o[n]=4,u[n]=4*t[n]+2*t[n+1];for(i[r-1]=2,o[r-1]=7,u[r-1]=8*t[r-1]+t[r],n=1;n<r;++n)e=i[n]/o[n-1],o[n]-=e,u[n]-=e*u[n-1];for(i[r-1]=u[r-1]/o[r-1],n=r-2;n>=0;--n)i[n]=(u[n]-i[n+1])/o[n];for(o[r-1]=(t[r]+i[r-1])/2,n=0;n<r-1;++n)o[n]=2*t[n+1]-i[n+1];return[i,o]}function mc(t,n){this._context=t,this._t=n}function xc(t,n){return t[n]}function bc(t){for(var n,e=0,r=-1,i=t.length;++r<i;)(n=+t[r][1])&&(e+=n);return e}function wc(t){return t[0]}function Mc(t){return t[1]}function Tc(){this._=null}function kc(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Nc(t,n){var e=n,r=n.R,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function Sc(t,n){var e=n,r=n.L,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function Ec(t){for(;t.L;)t=t.L;return t}function Ac(t,n,e,r){var i=[null,null],o=um.push(i)-1;return i.left=t,i.right=n,e&&zc(i,t,n,e),r&&zc(i,n,t,r),im[t.index].halfedges.push(o),im[n.index].halfedges.push(o),i}function Cc(t,n,e){var r=[n,e];return r.left=t,r}function zc(t,n,e,r){t[0]||t[1]?t.left===e?t[1]=r:t[0]=r:(t[0]=r,t.left=n,t.right=e)}function Pc(t,n,e,r,i){var o,u=t[0],a=t[1],c=u[0],s=u[1],f=0,l=1,h=a[0]-c,p=a[1]-s;if(o=n-c,h||!(o>0)){if(o/=h,h<0){if(o<f)return;o<l&&(l=o)}else if(h>0){if(o>l)return;o>f&&(f=o)}if(o=r-c,h||!(o<0)){if(o/=h,h<0){if(o>l)return;o>f&&(f=o)}else if(h>0){if(o<f)return;o<l&&(l=o)}if(o=e-s,p||!(o>0)){if(o/=p,p<0){if(o<f)return;o<l&&(l=o)}else if(p>0){if(o>l)return;o>f&&(f=o)}if(o=i-s,p||!(o<0)){if(o/=p,p<0){if(o>l)return;o>f&&(f=o)}else if(p>0){if(o<f)return;o<l&&(l=o)}return!(f>0||l<1)||(f>0&&(t[0]=[c+f*h,s+f*p]),l<1&&(t[1]=[c+l*h,s+l*p]),!0)}}}}}function Rc(t,n,e,r,i){var o=t[1];if(o)return!0;var u,a,c=t[0],s=t.left,f=t.right,l=s[0],h=s[1],p=f[0],d=f[1],v=(l+p)/2,_=(h+d)/2;if(d===h){if(v<n||v>=r)return;if(l>p){if(c){if(c[1]>=i)return}else c=[v,e];o=[v,i]}else{if(c){if(c[1]<e)return}else c=[v,i];o=[v,e]}}else if(u=(l-p)/(d-h),a=_-u*v,u<-1||u>1)if(l>p){if(c){if(c[1]>=i)return}else c=[(e-a)/u,e];o=[(i-a)/u,i]}else{if(c){if(c[1]<e)return}else c=[(i-a)/u,i];o=[(e-a)/u,e]}else if(h<d){if(c){if(c[0]>=r)return}else c=[n,u*n+a];o=[r,u*r+a]}else{if(c){if(c[0]<n)return}else c=[r,u*r+a];o=[n,u*n+a]}return t[0]=c,t[1]=o,!0}function Lc(t,n,e,r){for(var i,o=um.length;o--;)Rc(i=um[o],t,n,e,r)&&Pc(i,t,n,e,r)&&(Math.abs(i[0][0]-i[1][0])>sm||Math.abs(i[0][1]-i[1][1])>sm)||delete um[o]}function qc(t){return im[t.index]={site:t,halfedges:[]}}function Uc(t,n){var e=t.site,r=n.left,i=n.right;return e===i&&(i=r,r=e),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(e===r?(r=n[1],i=n[0]):(r=n[0],i=n[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Dc(t,n){return n[+(n.left!==t.site)]}function Oc(t,n){return n[+(n.left===t.site)]}function Fc(){for(var t,n,e,r,i=0,o=im.length;i<o;++i)if((t=im[i])&&(r=(n=t.halfedges).length)){var u=new Array(r),a=new Array(r);for(e=0;e<r;++e)u[e]=e,a[e]=Uc(t,um[n[e]]);for(u.sort(function(t,n){return a[n]-a[t]}),e=0;e<r;++e)a[e]=n[u[e]];for(e=0;e<r;++e)n[e]=a[e]}}function Ic(t,n,e,r){var i,o,u,a,c,s,f,l,h,p,d,v,_=im.length,y=!0;for(i=0;i<_;++i)if(o=im[i]){for(u=o.site,a=(c=o.halfedges).length;a--;)um[c[a]]||c.splice(a,1);for(a=0,s=c.length;a<s;)d=(p=Oc(o,um[c[a]]))[0],v=p[1],l=(f=Dc(o,um[c[++a%s]]))[0],h=f[1],(Math.abs(d-l)>sm||Math.abs(v-h)>sm)&&(c.splice(a,0,um.push(Cc(u,p,Math.abs(d-t)<sm&&r-v>sm?[t,Math.abs(l-t)<sm?h:r]:Math.abs(v-r)<sm&&e-d>sm?[Math.abs(h-r)<sm?l:e,r]:Math.abs(d-e)<sm&&v-n>sm?[e,Math.abs(l-e)<sm?h:n]:Math.abs(v-n)<sm&&d-t>sm?[Math.abs(h-n)<sm?l:t,n]:null))-1),++s);s&&(y=!1)}if(y){var g,m,x,b=1/0;for(i=0,y=null;i<_;++i)(o=im[i])&&(x=(g=(u=o.site)[0]-t)*g+(m=u[1]-n)*m)<b&&(b=x,y=o);if(y){var w=[t,n],M=[t,r],T=[e,r],k=[e,n];y.halfedges.push(um.push(Cc(u=y.site,w,M))-1,um.push(Cc(u,M,T))-1,um.push(Cc(u,T,k))-1,um.push(Cc(u,k,w))-1)}}for(i=0;i<_;++i)(o=im[i])&&(o.halfedges.length||delete im[i])}function Yc(){kc(this),this.x=this.y=this.arc=this.site=this.cy=null}function Bc(t){var n=t.P,e=t.N;if(n&&e){var r=n.site,i=t.site,o=e.site;if(r!==o){var u=i[0],a=i[1],c=r[0]-u,s=r[1]-a,f=o[0]-u,l=o[1]-a,h=2*(c*l-s*f);if(!(h>=-fm)){var p=c*c+s*s,d=f*f+l*l,v=(l*p-s*d)/h,_=(c*d-f*p)/h,y=am.pop()||new Yc;y.arc=t,y.site=i,y.x=v+u,y.y=(y.cy=_+a)+Math.sqrt(v*v+_*_),t.circle=y;for(var g=null,m=om._;m;)if(y.y<m.y||y.y===m.y&&y.x<=m.x){if(!m.L){g=m.P;break}m=m.L}else{if(!m.R){g=m;break}m=m.R}om.insert(g,y),g||(em=y)}}}}function jc(t){var n=t.circle;n&&(n.P||(em=n.N),om.remove(n),am.push(n),kc(n),t.circle=null)}function Hc(){kc(this),this.edge=this.site=this.circle=null}function Xc(t){var n=cm.pop()||new Hc;return n.site=t,n}function $c(t){jc(t),rm.remove(t),cm.push(t),kc(t)}function Vc(t){var n=t.circle,e=n.x,r=n.cy,i=[e,r],o=t.P,u=t.N,a=[t];$c(t);for(var c=o;c.circle&&Math.abs(e-c.circle.x)<sm&&Math.abs(r-c.circle.cy)<sm;)o=c.P,a.unshift(c),$c(c),c=o;a.unshift(c),jc(c);for(var s=u;s.circle&&Math.abs(e-s.circle.x)<sm&&Math.abs(r-s.circle.cy)<sm;)u=s.N,a.push(s),$c(s),s=u;a.push(s),jc(s);var f,l=a.length;for(f=1;f<l;++f)s=a[f],c=a[f-1],zc(s.edge,c.site,s.site,i);c=a[0],(s=a[l-1]).edge=Ac(c.site,s.site,null,i),Bc(c),Bc(s)}function Wc(t){for(var n,e,r,i,o=t[0],u=t[1],a=rm._;a;)if((r=Zc(a,u)-o)>sm)a=a.L;else{if(!((i=o-Gc(a,u))>sm)){r>-sm?(n=a.P,e=a):i>-sm?(n=a,e=a.N):n=e=a;break}if(!a.R){n=a;break}a=a.R}qc(t);var c=Xc(t);if(rm.insert(n,c),n||e){if(n===e)return jc(n),e=Xc(n.site),rm.insert(c,e),c.edge=e.edge=Ac(n.site,c.site),Bc(n),void Bc(e);if(e){jc(n),jc(e);var s=n.site,f=s[0],l=s[1],h=t[0]-f,p=t[1]-l,d=e.site,v=d[0]-f,_=d[1]-l,y=2*(h*_-p*v),g=h*h+p*p,m=v*v+_*_,x=[(_*g-p*m)/y+f,(h*m-v*g)/y+l];zc(e.edge,s,d,x),c.edge=Ac(s,t,null,x),e.edge=Ac(t,d,null,x),Bc(n),Bc(e)}else c.edge=Ac(n.site,c.site)}}function Zc(t,n){var e=t.site,r=e[0],i=e[1],o=i-n;if(!o)return r;var u=t.P;if(!u)return-1/0;var a=(e=u.site)[0],c=e[1],s=c-n;if(!s)return a;var f=a-r,l=1/o-1/s,h=f/s;return l?(-h+Math.sqrt(h*h-2*l*(f*f/(-2*s)-c+s/2+i-o/2)))/l+r:(r+a)/2}function Gc(t,n){var e=t.N;if(e)return Zc(e,n);var r=t.site;return r[1]===n?r[0]:1/0}function Jc(t,n,e){return(t[0]-e[0])*(n[1]-t[1])-(t[0]-n[0])*(e[1]-t[1])}function Qc(t,n){return n[1]-t[1]||n[0]-t[0]}function Kc(t,n){var e,r,i,o=t.sort(Qc).pop();for(um=[],im=new Array(t.length),rm=new Tc,om=new Tc;;)if(i=em,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===e&&o[1]===r||(Wc(o),e=o[0],r=o[1]),o=t.pop();else{if(!i)break;Vc(i.arc)}if(Fc(),n){var u=+n[0][0],a=+n[0][1],c=+n[1][0],s=+n[1][1];Lc(u,a,c,s),Ic(u,a,c,s)}this.edges=um,this.cells=im,rm=om=um=im=null}function ts(t,n,e){this.target=t,this.type=n,this.transform=e}function ns(t,n,e){this.k=t,this.x=n,this.y=e}function es(t){return t.__zoom||hm}function rs(){t.event.stopImmediatePropagation()}function is(){return!t.event.button}function os(){var t,n,e=this;return e instanceof SVGElement?(t=(e=e.ownerSVGElement||e).width.baseVal.value,n=e.height.baseVal.value):(t=e.clientWidth,n=e.clientHeight),[[0,0],[t,n]]}function us(){return this.__zoom||hm}function as(){return-t.event.deltaY*(t.event.deltaMode?120:1)/500}function cs(){return"ontouchstart"in this}var ss=function(t,n){return t<n?-1:t>n?1:t>=n?0:NaN},fs=function(t){return 1===t.length&&(t=n(t)),{left:function(n,e,r,i){for(null==r&&(r=0),null==i&&(i=n.length);r<i;){var o=r+i>>>1;t(n[o],e)<0?r=o+1:i=o}return r},right:function(n,e,r,i){for(null==r&&(r=0),null==i&&(i=n.length);r<i;){var o=r+i>>>1;t(n[o],e)>0?i=o:r=o+1}return r}}},ls=fs(ss),hs=ls.right,ps=ls.left,ds=function(t){return null===t?NaN:+t},vs=function(t,n){var e,r,i=t.length,o=0,u=-1,a=0,c=0;if(null==n)for(;++u<i;)isNaN(e=ds(t[u]))||(c+=(r=e-a)*(e-(a+=r/++o)));else for(;++u<i;)isNaN(e=ds(n(t[u],u,t)))||(c+=(r=e-a)*(e-(a+=r/++o)));if(o>1)return c/(o-1)},_s=function(t,n){var e=vs(t,n);return e?Math.sqrt(e):e},ys=function(t,n){var e,r,i,o=t.length,u=-1;if(null==n){for(;++u<o;)if(null!=(e=t[u])&&e>=e)for(r=i=e;++u<o;)null!=(e=t[u])&&(r>e&&(r=e),i<e&&(i=e))}else for(;++u<o;)if(null!=(e=n(t[u],u,t))&&e>=e)for(r=i=e;++u<o;)null!=(e=n(t[u],u,t))&&(r>e&&(r=e),i<e&&(i=e));return[r,i]},gs=Array.prototype,ms=gs.slice,xs=gs.map,bs=function(t){return function(){return t}},ws=function(t){return t},Ms=function(t,n,e){t=+t,n=+n,e=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+e;for(var r=-1,i=0|Math.max(0,Math.ceil((n-t)/e)),o=new Array(i);++r<i;)o[r]=t+r*e;return o},Ts=Math.sqrt(50),ks=Math.sqrt(10),Ns=Math.sqrt(2),Ss=function(t,n,e){var i,o,u,a=n<t,c=-1;if(a&&(i=t,t=n,n=i),0===(u=r(t,n,e))||!isFinite(u))return[];if(u>0)for(t=Math.ceil(t/u),n=Math.floor(n/u),o=new Array(i=Math.ceil(n-t+1));++c<i;)o[c]=(t+c)*u;else for(t=Math.floor(t*u),n=Math.ceil(n*u),o=new Array(i=Math.ceil(t-n+1));++c<i;)o[c]=(t-c)/u;return a&&o.reverse(),o},Es=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},As=function(t,n,e){if(null==e&&(e=ds),r=t.length){if((n=+n)<=0||r<2)return+e(t[0],0,t);if(n>=1)return+e(t[r-1],r-1,t);var r,i=(r-1)*n,o=Math.floor(i),u=+e(t[o],o,t);return u+(+e(t[o+1],o+1,t)-u)*(i-o)}},Cs=function(t){for(var n,e,r,i=t.length,o=-1,u=0;++o<i;)u+=t[o].length;for(e=new Array(u);--i>=0;)for(n=(r=t[i]).length;--n>=0;)e[--u]=r[n];return e},zs=function(t,n){var e,r,i=t.length,o=-1;if(null==n){for(;++o<i;)if(null!=(e=t[o])&&e>=e)for(r=e;++o<i;)null!=(e=t[o])&&r>e&&(r=e)}else for(;++o<i;)if(null!=(e=n(t[o],o,t))&&e>=e)for(r=e;++o<i;)null!=(e=n(t[o],o,t))&&r>e&&(r=e);return r},Ps=function(t){if(!(i=t.length))return[];for(var n=-1,e=zs(t,o),r=new Array(e);++n<e;)for(var i,u=-1,a=r[n]=new Array(i);++u<i;)a[u]=t[u][n];return r},Rs=Array.prototype.slice,Ls=function(t){return t},qs=1,Us=2,Ds=3,Os=4,Fs=1e-6,Is={value:function(){}};p.prototype=h.prototype={constructor:p,on:function(t,n){var e,r=this._,i=d(t+"",r),o=-1,u=i.length;{if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++o<u;)if(e=(t=i[o]).type)r[e]=_(r[e],t.name,n);else if(null==n)for(e in r)r[e]=_(r[e],t.name,null);return this}for(;++o<u;)if((e=(t=i[o]).type)&&(e=v(r[e],t.name)))return e}},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new p(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,i=new Array(e),o=0;o<e;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,e=(r=this._[t]).length;o<e;++o)r[o].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};var Ys="http://www.w3.org/1999/xhtml",Bs={svg:"http://www.w3.org/2000/svg",xhtml:Ys,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},js=function(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),Bs.hasOwnProperty(n)?{space:Bs[n],local:t}:t},Hs=function(t){var n=js(t);return(n.local?g:y)(n)},Xs=0;x.prototype=m.prototype={constructor:x,get:function(t){for(var n=this._;!(n in t);)if(!(t=t.parentNode))return;return t[n]},set:function(t,n){return t[this._]=n},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var $s=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var Vs=document.documentElement;if(!Vs.matches){var Ws=Vs.webkitMatchesSelector||Vs.msMatchesSelector||Vs.mozMatchesSelector||Vs.oMatchesSelector;$s=function(t){return function(){return Ws.call(this,t)}}}}var Zs=$s,Gs={};t.event=null,"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Gs={mouseenter:"mouseover",mouseleave:"mouseout"}));var Js=function(){for(var n,e=t.event;n=e.sourceEvent;)e=n;return e},Qs=function(t,n){var e=t.ownerSVGElement||t;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=n.clientX,r.y=n.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var i=t.getBoundingClientRect();return[n.clientX-i.left-t.clientLeft,n.clientY-i.top-t.clientTop]},Ks=function(t){var n=Js();return n.changedTouches&&(n=n.changedTouches[0]),Qs(t,n)},tf=function(t){return null==t?S:function(){return this.querySelector(t)}},nf=function(t){return null==t?E:function(){return this.querySelectorAll(t)}},ef=function(t){return new Array(t.length)};A.prototype={constructor:A,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var rf=function(t){return function(){return t}},of="$",uf=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};W.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var af=[null];pt.prototype=dt.prototype={constructor:pt,select:function(t){"function"!=typeof t&&(t=tf(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,u,a=n[i],c=a.length,s=r[i]=new Array(c),f=0;f<c;++f)(o=a[f])&&(u=t.call(o,o.__data__,f,a))&&("__data__"in o&&(u.__data__=o.__data__),s[f]=u);return new pt(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=nf(t));for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var u,a=n[o],c=a.length,s=0;s<c;++s)(u=a[s])&&(r.push(t.call(u,u.__data__,s,a)),i.push(u));return new pt(r,i)},filter:function(t){"function"!=typeof t&&(t=Zs(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,u=n[i],a=u.length,c=r[i]=[],s=0;s<a;++s)(o=u[s])&&t.call(o,o.__data__,s,u)&&c.push(o);return new pt(r,this._parents)},data:function(t,n){if(!t)return p=new Array(this.size()),s=-1,this.each(function(t){p[++s]=t}),p;var e=n?z:C,r=this._parents,i=this._groups;"function"!=typeof t&&(t=rf(t));for(var o=i.length,u=new Array(o),a=new Array(o),c=new Array(o),s=0;s<o;++s){var f=r[s],l=i[s],h=l.length,p=t.call(f,f&&f.__data__,s,r),d=p.length,v=a[s]=new Array(d),_=u[s]=new Array(d);e(f,l,v,_,c[s]=new Array(h),p,n);for(var y,g,m=0,x=0;m<d;++m)if(y=v[m]){for(m>=x&&(x=m+1);!(g=_[x])&&++x<d;);y._next=g||null}}return u=new pt(u,r),u._enter=a,u._exit=c,u},enter:function(){return new pt(this._enter||this._groups.map(ef),this._parents)},exit:function(){return new pt(this._exit||this._groups.map(ef),this._parents)},merge:function(t){for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),u=new Array(r),a=0;a<o;++a)for(var c,s=n[a],f=e[a],l=s.length,h=u[a]=new Array(l),p=0;p<l;++p)(c=s[p]||f[p])&&(h[p]=c);for(;a<r;++a)u[a]=n[a];return new pt(u,this._parents)},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],o=i.length-1,u=i[o];--o>=0;)(r=i[o])&&(u&&u!==r.nextSibling&&u.parentNode.insertBefore(r,u),u=r);return this},sort:function(t){t||(t=P);for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i){for(var o,u=n[i],a=u.length,c=r[i]=new Array(a),s=0;s<a;++s)(o=u[s])&&(c[s]=o);c.sort(function(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e})}return new pt(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each(function(){t[++n]=this}),t},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var u=r[i];if(u)return u}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,o=n[e],u=0,a=o.length;u<a;++u)(i=o[u])&&t.call(i,i.__data__,u,o);return this},attr:function(t,n){var e=js(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?L:R:"function"==typeof n?e.local?O:D:e.local?U:q)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?F:"function"==typeof n?Y:I)(t,n,null==e?"":e)):B(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?j:"function"==typeof n?X:H)(t,n)):this.node()[t]},classed:function(t,n){var e=$(t+"");if(arguments.length<2){for(var r=V(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?K:n?J:Q)(e,n))},text:function(t){return arguments.length?this.each(null==t?tt:("function"==typeof t?et:nt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?rt:("function"==typeof t?ot:it)(t)):this.node().innerHTML},raise:function(){return this.each(ut)},lower:function(){return this.each(at)},append:function(t){var n="function"==typeof t?t:Hs(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})},insert:function(t,n){var e="function"==typeof t?t:Hs(t),r=null==n?ct:"function"==typeof n?n:tf(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(st)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,o=M(t+""),u=o.length;{if(!(arguments.length<2)){for(a=n?k:T,null==e&&(e=!1),r=0;r<u;++r)this.each(a(o[r],n,e));return this}var a=this.node().__on;if(a)for(var c,s=0,f=a.length;s<f;++s)for(r=0,c=a[s];r<u;++r)if((i=o[r]).type===c.type&&i.name===c.name)return c.value}},dispatch:function(t,n){return this.each(("function"==typeof n?ht:lt)(t,n))}};var cf=function(t){return"string"==typeof t?new pt([[document.querySelector(t)]],[document.documentElement]):new pt([[t]],af)},sf=function(t,n,e){arguments.length<3&&(e=n,n=Js().changedTouches);for(var r,i=0,o=n?n.length:0;i<o;++i)if((r=n[i]).identifier===e)return Qs(t,r);return null},ff=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},lf=function(t){var n=t.document.documentElement,e=cf(t).on("dragstart.drag",ff,!0);"onselectstart"in n?e.on("selectstart.drag",ff,!0):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")},hf=function(t){return function(){return t}};yt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var pf=function(t,n,e){t.prototype=n.prototype=e,e.constructor=t},df="\\s*([+-]?\\d+)\\s*",vf="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",_f="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",yf=/^#([0-9a-f]{3})$/,gf=/^#([0-9a-f]{6})$/,mf=new RegExp("^rgb\\("+[df,df,df]+"\\)$"),xf=new RegExp("^rgb\\("+[_f,_f,_f]+"\\)$"),bf=new RegExp("^rgba\\("+[df,df,df,vf]+"\\)$"),wf=new RegExp("^rgba\\("+[_f,_f,_f,vf]+"\\)$"),Mf=new RegExp("^hsl\\("+[vf,_f,_f]+"\\)$"),Tf=new RegExp("^hsla\\("+[vf,_f,_f,vf]+"\\)$"),kf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pf(Mt,Tt,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),pf(At,Et,wt(Mt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new At(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new At(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),pf(Rt,Pt,wt(Mt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Rt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Rt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new At(Lt(t>=240?t-240:t+120,i,r),Lt(t,i,r),Lt(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Nf=Math.PI/180,Sf=180/Math.PI,Ef=.95047,Af=1,Cf=1.08883,zf=4/29,Pf=6/29,Rf=3*Pf*Pf,Lf=Pf*Pf*Pf;pf(Dt,Ut,wt(Mt,{brighter:function(t){return new Dt(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Dt(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,n=isNaN(this.a)?t:t+this.a/500,e=isNaN(this.b)?t:t-this.b/200;return t=Af*Ft(t),n=Ef*Ft(n),e=Cf*Ft(e),new At(It(3.2404542*n-1.5371385*t-.4985314*e),It(-.969266*n+1.8760108*t+.041556*e),It(.0556434*n-.2040259*t+1.0572252*e),this.opacity)}})),pf(Ht,jt,wt(Mt,{brighter:function(t){return new Ht(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Ht(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return qt(this).rgb()}}));var qf=-.14861,Uf=1.78277,Df=-.29227,Of=-.90649,Ff=1.97294,If=Ff*Of,Yf=Ff*Uf,Bf=Uf*Df-Of*qf;pf(Vt,$t,wt(Mt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Vt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Vt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Nf,n=+this.l,e=isNaN(this.s)?0:this.s*n*(1-n),r=Math.cos(t),i=Math.sin(t);return new At(255*(n+e*(qf*r+Uf*i)),255*(n+e*(Df*r+Of*i)),255*(n+e*(Ff*r)),this.opacity)}}));var jf,Hf,Xf,$f,Vf,Wf,Zf=function(t){var n=t.length-1;return function(e){var r=e<=0?e=0:e>=1?(e=1,n-1):Math.floor(e*n),i=t[r],o=t[r+1],u=r>0?t[r-1]:2*i-o,a=r<n-1?t[r+2]:2*o-i;return Wt((e-r/n)*n,u,i,o,a)}},Gf=function(t){var n=t.length;return function(e){var r=Math.floor(((e%=1)<0?++e:e)*n),i=t[(r+n-1)%n],o=t[r%n],u=t[(r+1)%n],a=t[(r+2)%n];return Wt((e-r/n)*n,i,o,u,a)}},Jf=function(t){return function(){return t}},Qf=function t(n){function e(t,n){var e=r((t=Et(t)).r,(n=Et(n)).r),i=r(t.g,n.g),o=r(t.b,n.b),u=Kt(t.opacity,n.opacity);return function(n){return t.r=e(n),t.g=i(n),t.b=o(n),t.opacity=u(n),t+""}}var r=Qt(n);return e.gamma=t,e}(1),Kf=tn(Zf),tl=tn(Gf),nl=function(t,n){var e,r=n?n.length:0,i=t?Math.min(r,t.length):0,o=new Array(r),u=new Array(r);for(e=0;e<i;++e)o[e]=cl(t[e],n[e]);for(;e<r;++e)u[e]=n[e];return function(t){for(e=0;e<i;++e)u[e]=o[e](t);return u}},el=function(t,n){var e=new Date;return t=+t,n-=t,function(r){return e.setTime(t+n*r),e}},rl=function(t,n){return t=+t,n-=t,function(e){return t+n*e}},il=function(t,n){var e,r={},i={};null!==t&&"object"==typeof t||(t={}),null!==n&&"object"==typeof n||(n={});for(e in n)e in t?r[e]=cl(t[e],n[e]):i[e]=n[e];return function(t){for(e in r)i[e]=r[e](t);return i}},ol=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ul=new RegExp(ol.source,"g"),al=function(t,n){var e,r,i,o=ol.lastIndex=ul.lastIndex=0,u=-1,a=[],c=[];for(t+="",n+="";(e=ol.exec(t))&&(r=ul.exec(n));)(i=r.index)>o&&(i=n.slice(o,i),a[u]?a[u]+=i:a[++u]=i),(e=e[0])===(r=r[0])?a[u]?a[u]+=r:a[++u]=r:(a[++u]=null,c.push({i:u,x:rl(e,r)})),o=ul.lastIndex;return o<n.length&&(i=n.slice(o),a[u]?a[u]+=i:a[++u]=i),a.length<2?c[0]?en(c[0].x):nn(n):(n=c.length,function(t){for(var e,r=0;r<n;++r)a[(e=c[r]).i]=e.x(t);return a.join("")})},cl=function(t,n){var e,r=typeof n;return null==n||"boolean"===r?Jf(n):("number"===r?rl:"string"===r?(e=Tt(n))?(n=e,Qf):al:n instanceof Tt?Qf:n instanceof Date?el:Array.isArray(n)?nl:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?il:rl)(t,n)},sl=function(t,n){return t=+t,n-=t,function(e){return Math.round(t+n*e)}},fl=180/Math.PI,ll={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},hl=function(t,n,e,r,i,o){var u,a,c;return(u=Math.sqrt(t*t+n*n))&&(t/=u,n/=u),(c=t*e+n*r)&&(e-=t*c,r-=n*c),(a=Math.sqrt(e*e+r*r))&&(e/=a,r/=a,c/=a),t*r<n*e&&(t=-t,n=-n,c=-c,u=-u),{translateX:i,translateY:o,rotate:Math.atan2(n,t)*fl,skewX:Math.atan(c)*fl,scaleX:u,scaleY:a}},pl=rn(function(t){return"none"===t?ll:(jf||(jf=document.createElement("DIV"),Hf=document.documentElement,Xf=document.defaultView),jf.style.transform=t,t=Xf.getComputedStyle(Hf.appendChild(jf),null).getPropertyValue("transform"),Hf.removeChild(jf),t=t.slice(7,-1).split(","),hl(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),dl=rn(function(t){return null==t?ll:($f||($f=document.createElementNS("http://www.w3.org/2000/svg","g")),$f.setAttribute("transform",t),(t=$f.transform.baseVal.consolidate())?(t=t.matrix,hl(t.a,t.b,t.c,t.d,t.e,t.f)):ll)},", ",")",")"),vl=Math.SQRT2,_l=function(t,n){var e,r,i=t[0],o=t[1],u=t[2],a=n[0],c=n[1],s=n[2],f=a-i,l=c-o,h=f*f+l*l;if(h<1e-12)r=Math.log(s/u)/vl,e=function(t){return[i+t*f,o+t*l,u*Math.exp(vl*t*r)]};else{var p=Math.sqrt(h),d=(s*s-u*u+4*h)/(2*u*2*p),v=(s*s-u*u-4*h)/(2*s*2*p),_=Math.log(Math.sqrt(d*d+1)-d),y=Math.log(Math.sqrt(v*v+1)-v);r=(y-_)/vl,e=function(t){var n=t*r,e=on(_),a=u/(2*p)*(e*an(vl*n+_)-un(_));return[i+a*f,o+a*l,u*e/on(vl*n+_)]}}return e.duration=1e3*r,e},yl=cn(Jt),gl=cn(Kt),ml=sn(Jt),xl=sn(Kt),bl=fn(Jt),wl=fn(Kt),Ml=0,Tl=0,kl=0,Nl=1e3,Sl=0,El=0,Al=0,Cl="object"==typeof performance&&performance.now?performance:Date,zl="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};pn.prototype=dn.prototype={constructor:pn,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?ln():+e)+(null==n?0:+n),this._next||Wf===this||(Wf?Wf._next=this:Vf=this,Wf=this),this._call=t,this._time=e,mn()},stop:function(){this._call&&(this._call=null,this._time=1/0,mn())}};var Pl=function(t,n,e){var r=new pn;return n=null==n?0:+n,r.restart(function(e){r.stop(),t(e+n)},n,e),r},Rl=h("start","end","interrupt"),Ll=[],ql=0,Ul=1,Dl=2,Ol=3,Fl=4,Il=5,Yl=6,Bl=function(t,n,e,r,i,o){var u=t.__transition;if(u){if(e in u)return}else t.__transition={};Mn(t,e,{name:n,index:r,group:i,on:Rl,tween:Ll,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:ql})},jl=function(t,n){var e,r,i,o=t.__transition,u=!0;if(o){n=null==n?null:n+"";for(i in o)(e=o[i]).name===n?(r=e.state>Dl&&e.state<Il,e.state=Yl,e.timer.stop(),r&&e.on.call("interrupt",t,t.__data__,e.index,e.group),delete o[i]):u=!1;u&&delete t.__transition}},Hl=function(t,n){var e;return("number"==typeof n?rl:n instanceof Tt?Qf:(e=Tt(n))?(n=e,Qf):al)(t,n)},Xl=dt.prototype.constructor,$l=0,Vl=dt.prototype;Gn.prototype=Jn.prototype={constructor:Gn,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=tf(t));for(var r=this._groups,i=r.length,o=new Array(i),u=0;u<i;++u)for(var a,c,s=r[u],f=s.length,l=o[u]=new Array(f),h=0;h<f;++h)(a=s[h])&&(c=t.call(a,a.__data__,h,s))&&("__data__"in a&&(c.__data__=a.__data__),l[h]=c,Bl(l[h],n,e,h,l,wn(a,e)));return new Gn(o,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=nf(t));for(var r=this._groups,i=r.length,o=[],u=[],a=0;a<i;++a)for(var c,s=r[a],f=s.length,l=0;l<f;++l)if(c=s[l]){for(var h,p=t.call(c,c.__data__,l,s),d=wn(c,e),v=0,_=p.length;v<_;++v)(h=p[v])&&Bl(h,n,e,v,p,d);o.push(p),u.push(c)}return new Gn(o,u,n,e)},filter:function(t){"function"!=typeof t&&(t=Zs(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,u=n[i],a=u.length,c=r[i]=[],s=0;s<a;++s)(o=u[s])&&t.call(o,o.__data__,s,u)&&c.push(o);return new Gn(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),u=new Array(r),a=0;a<o;++a)for(var c,s=n[a],f=e[a],l=s.length,h=u[a]=new Array(l),p=0;p<l;++p)(c=s[p]||f[p])&&(h[p]=c);for(;a<r;++a)u[a]=n[a];return new Gn(u,this._parents,this._name,this._id)},selection:function(){return new Xl(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=Qn(),r=this._groups,i=r.length,o=0;o<i;++o)for(var u,a=r[o],c=a.length,s=0;s<c;++s)if(u=a[s]){var f=wn(u,n);Bl(u,t,e,s,a,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Gn(r,this._parents,t,e)},call:Vl.call,nodes:Vl.nodes,node:Vl.node,size:Vl.size,empty:Vl.empty,each:Vl.each,on:function(t,n){var e=this._id;return arguments.length<2?wn(this.node(),e).on.on(t):this.each(Yn(e,t,n))},attr:function(t,n){var e=js(t),r="transform"===e?dl:Hl;return this.attrTween(t,"function"==typeof n?(e.local?Pn:zn)(e,r,Nn(this,"attr."+t,n)):null==n?(e.local?En:Sn)(e):(e.local?Cn:An)(e,r,n+""))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;var r=js(t);return this.tween(e,(r.local?Rn:Ln)(r,n))},style:function(t,n,e){var r="transform"==(t+="")?pl:Hl;return null==n?this.styleTween(t,jn(t,r)).on("end.style."+t,Hn(t)):this.styleTween(t,"function"==typeof n?$n(t,r,Nn(this,"style."+t,n)):Xn(t,r,n+""),e)},styleTween:function(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!=typeof n)throw new Error;return this.tween(r,Vn(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?Zn(Nn(this,"text",t)):Wn(null==t?"":t+""))},remove:function(){return this.on("end.remove",Bn(this._id))},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r,i=wn(this.node(),e).tween,o=0,u=i.length;o<u;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==n?Tn:kn)(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?qn:Un)(n,t)):wn(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?Dn:On)(n,t)):wn(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(Fn(n,t)):wn(this.node(),n).ease}};var Wl=function t(n){function e(t){return Math.pow(t,n)}return n=+n,e.exponent=t,e}(3),Zl=function t(n){function e(t){return 1-Math.pow(1-t,n)}return n=+n,e.exponent=t,e}(3),Gl=function t(n){function e(t){return((t*=2)<=1?Math.pow(t,n):2-Math.pow(2-t,n))/2}return n=+n,e.exponent=t,e}(3),Jl=Math.PI,Ql=Jl/2,Kl=4/11,th=6/11,nh=8/11,eh=.75,rh=9/11,ih=10/11,oh=.9375,uh=21/22,ah=63/64,ch=1/Kl/Kl,sh=function t(n){function e(t){return t*t*((n+1)*t-n)}return n=+n,e.overshoot=t,e}(1.70158),fh=function t(n){function e(t){return--t*t*((n+1)*t+n)+1}return n=+n,e.overshoot=t,e}(1.70158),lh=function t(n){function e(t){return((t*=2)<1?t*t*((n+1)*t-n):(t-=2)*t*((n+1)*t+n)+2)/2}return n=+n,e.overshoot=t,e}(1.70158),hh=2*Math.PI,ph=function t(n,e){function r(t){return n*Math.pow(2,10*--t)*Math.sin((i-t)/e)}var i=Math.asin(1/(n=Math.max(1,n)))*(e/=hh);return r.amplitude=function(n){return t(n,e*hh)},r.period=function(e){return t(n,e)},r}(1,.3),dh=function t(n,e){function r(t){return 1-n*Math.pow(2,-10*(t=+t))*Math.sin((t+i)/e)}var i=Math.asin(1/(n=Math.max(1,n)))*(e/=hh);return r.amplitude=function(n){return t(n,e*hh)},r.period=function(e){return t(n,e)},r}(1,.3),vh=function t(n,e){function r(t){return((t=2*t-1)<0?n*Math.pow(2,10*t)*Math.sin((i-t)/e):2-n*Math.pow(2,-10*t)*Math.sin((i+t)/e))/2}var i=Math.asin(1/(n=Math.max(1,n)))*(e/=hh);return r.amplitude=function(n){return t(n,e*hh)},r.period=function(e){return t(n,e)},r}(1,.3),_h={time:null,delay:0,duration:250,ease:te};dt.prototype.interrupt=function(t){return this.each(function(){jl(this,t)})},dt.prototype.transition=function(t){var n,e;t instanceof Gn?(n=t._id,t=t._name):(n=Qn(),(e=_h).time=ln(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var u,a=r[o],c=a.length,s=0;s<c;++s)(u=a[s])&&Bl(u,t,n,s,a,e||oe(u,n));return new Gn(r,this._parents,t,n)};var yh=[null],gh=function(t){return function(){return t}},mh=function(t,n,e){this.target=t,this.type=n,this.selection=e},xh=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},bh={name:"drag"},wh={name:"space"},Mh={name:"handle"},Th={name:"center"},kh={name:"x",handles:["e","w"].map(ae),input:function(t,n){return t&&[[t[0],n[0][1]],[t[1],n[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Nh={name:"y",handles:["n","s"].map(ae),input:function(t,n){return t&&[[n[0][0],t[0]],[n[1][0],t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Sh={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(ae),input:function(t){return t},output:function(t){return t}},Eh={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ah={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Ch={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},zh={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Ph={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1},Rh=Math.cos,Lh=Math.sin,qh=Math.PI,Uh=qh/2,Dh=2*qh,Oh=Math.max,Fh=Array.prototype.slice,Ih=function(t){return function(){return t}},Yh=Math.PI,Bh=2*Yh,jh=Bh-1e-6;de.prototype=ve.prototype={constructor:de,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+r)},bezierCurveTo:function(t,n,e,r,i,o){this._+="C"+ +t+","+ +n+","+ +e+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,n,e,r,i){t=+t,n=+n,e=+e,r=+r,i=+i;var o=this._x1,u=this._y1,a=e-t,c=r-n,s=o-t,f=u-n,l=s*s+f*f;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(l>1e-6)if(Math.abs(f*a-c*s)>1e-6&&i){var h=e-o,p=r-u,d=a*a+c*c,v=h*h+p*p,_=Math.sqrt(d),y=Math.sqrt(l),g=i*Math.tan((Yh-Math.acos((d+l-v)/(2*_*y)))/2),m=g/y,x=g/_;Math.abs(m-1)>1e-6&&(this._+="L"+(t+m*s)+","+(n+m*f)),this._+="A"+i+","+i+",0,0,"+ +(f*h>s*p)+","+(this._x1=t+x*a)+","+(this._y1=n+x*c)}else this._+="L"+(this._x1=t)+","+(this._y1=n);else;},arc:function(t,n,e,r,i,o){t=+t,n=+n;var u=(e=+e)*Math.cos(r),a=e*Math.sin(r),c=t+u,s=n+a,f=1^o,l=o?r-i:i-r;if(e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+c+","+s:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-s)>1e-6)&&(this._+="L"+c+","+s),e&&(l<0&&(l=l%Bh+Bh),l>jh?this._+="A"+e+","+e+",0,1,"+f+","+(t-u)+","+(n-a)+"A"+e+","+e+",0,1,"+f+","+(this._x1=c)+","+(this._y1=s):l>1e-6&&(this._+="A"+e+","+e+",0,"+ +(l>=Yh)+","+f+","+(this._x1=t+e*Math.cos(i))+","+(this._y1=n+e*Math.sin(i))))},rect:function(t,n,e,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +r+"h"+-e+"Z"},toString:function(){return this._}};be.prototype=we.prototype={constructor:be,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,n){return this["$"+t]=n,this},remove:function(t){var n="$"+t;return n in this&&delete this[n]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(n.slice(1));return t},values:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(this[n]);return t},entries:function(){var t=[];for(var n in this)"$"===n[0]&&t.push({key:n.slice(1),value:this[n]});return t},size:function(){var t=0;for(var n in this)"$"===n[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var n in this)"$"===n[0]&&t(this[n],n.slice(1),this)}};var Hh=we.prototype;Se.prototype=Ee.prototype={constructor:Se,has:Hh.has,add:function(t){return t+="",this["$"+t]=t,this},remove:Hh.remove,clear:Hh.clear,values:Hh.keys,size:Hh.size,empty:Hh.empty,each:Hh.each};var Xh=function(t){function n(t,n){function e(){if(f>=s)return a;if(i)return i=!1,u;var n,e=f;if(34===t.charCodeAt(e)){for(var r=e;r++<s;)if(34===t.charCodeAt(r)){if(34!==t.charCodeAt(r+1))break;++r}return f=r+2,13===(n=t.charCodeAt(r+1))?(i=!0,10===t.charCodeAt(r+2)&&++f):10===n&&(i=!0),t.slice(e+1,r).replace(/""/g,'"')}for(;f<s;){var c=1;if(10===(n=t.charCodeAt(f++)))i=!0;else if(13===n)i=!0,10===t.charCodeAt(f)&&(++f,++c);else if(n!==o)continue;return t.slice(e,f-c)}return t.slice(e)}for(var r,i,u={},a={},c=[],s=t.length,f=0,l=0;(r=e())!==a;){for(var h=[];r!==u&&r!==a;)h.push(r),r=e();n&&null==(h=n(h,l++))||c.push(h)}return c}function e(n){return n.map(r).join(t)}function r(t){return null==t?"":i.test(t+="")?'"'+t.replace(/\"/g,'""')+'"':t}var i=new RegExp('["'+t+"\n\r]"),o=t.charCodeAt(0);return{parse:function(t,e){var r,i,o=n(t,function(t,n){if(r)return r(t,n-1);i=t,r=e?Ce(t,e):Ae(t)});return o.columns=i,o},parseRows:n,format:function(n,e){return null==e&&(e=ze(n)),[e.map(r).join(t)].concat(n.map(function(n){return e.map(function(t){return r(n[t])}).join(t)})).join("\n")},formatRows:function(t){return t.map(e).join("\n")}}},$h=Xh(","),Vh=$h.parse,Wh=$h.parseRows,Zh=$h.format,Gh=$h.formatRows,Jh=Xh("\t"),Qh=Jh.parse,Kh=Jh.parseRows,tp=Jh.format,np=Jh.formatRows,ep=function(t){return function(){return t}},rp=function(){return 1e-6*(Math.random()-.5)},ip=function(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i},op=qe.prototype=Ue.prototype;op.copy=function(){var t,n,e=new Ue(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return e;if(!r.length)return e._root=De(r),e;for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(n=r.source[i])&&(n.length?t.push({source:n,target:r.target[i]=new Array(4)}):r.target[i]=De(n));return e},op.add=function(t){var n=+this._x.call(null,t),e=+this._y.call(null,t);return Pe(this.cover(n,e),n,e,t)},op.addAll=function(t){var n,e,r,i,o=t.length,u=new Array(o),a=new Array(o),c=1/0,s=1/0,f=-1/0,l=-1/0;for(e=0;e<o;++e)isNaN(r=+this._x.call(null,n=t[e]))||isNaN(i=+this._y.call(null,n))||(u[e]=r,a[e]=i,r<c&&(c=r),r>f&&(f=r),i<s&&(s=i),i>l&&(l=i));for(f<c&&(c=this._x0,f=this._x1),l<s&&(s=this._y0,l=this._y1),this.cover(c,s).cover(f,l),e=0;e<o;++e)Pe(this,u[e],a[e],t[e]);return this},op.cover=function(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,o=(r=Math.floor(n))+1;else{if(!(e>t||t>i||r>n||n>o))return this;var u,a,c=i-e,s=this._root;switch(a=(n<(r+o)/2)<<1|t<(e+i)/2){case 0:do{u=new Array(4),u[a]=s,s=u}while(c*=2,i=e+c,o=r+c,t>i||n>o);break;case 1:do{u=new Array(4),u[a]=s,s=u}while(c*=2,e=i-c,o=r+c,e>t||n>o);break;case 2:do{u=new Array(4),u[a]=s,s=u}while(c*=2,i=e+c,r=o-c,t>i||r>n);break;case 3:do{u=new Array(4),u[a]=s,s=u}while(c*=2,e=i-c,r=o-c,e>t||r>n)}this._root&&this._root.length&&(this._root=s)}return this._x0=e,this._y0=r,this._x1=i,this._y1=o,this},op.data=function(){var t=[];return this.visit(function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)}),t},op.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},op.find=function(t,n,e){var r,i,o,u,a,c,s,f=this._x0,l=this._y0,h=this._x1,p=this._y1,d=[],v=this._root;for(v&&d.push(new ip(v,f,l,h,p)),null==e?e=1/0:(f=t-e,l=n-e,h=t+e,p=n+e,e*=e);c=d.pop();)if(!(!(v=c.node)||(i=c.x0)>h||(o=c.y0)>p||(u=c.x1)<f||(a=c.y1)<l))if(v.length){var _=(i+u)/2,y=(o+a)/2;d.push(new ip(v[3],_,y,u,a),new ip(v[2],i,y,_,a),new ip(v[1],_,o,u,y),new ip(v[0],i,o,_,y)),(s=(n>=y)<<1|t>=_)&&(c=d[d.length-1],d[d.length-1]=d[d.length-1-s],d[d.length-1-s]=c)}else{var g=t-+this._x.call(null,v.data),m=n-+this._y.call(null,v.data),x=g*g+m*m;if(x<e){var b=Math.sqrt(e=x);f=t-b,l=n-b,h=t+b,p=n+b,r=v.data}}return r},op.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(u=+this._y.call(null,t)))return this;var n,e,r,i,o,u,a,c,s,f,l,h,p=this._root,d=this._x0,v=this._y0,_=this._x1,y=this._y1;if(!p)return this;if(p.length)for(;;){if((s=o>=(a=(d+_)/2))?d=a:_=a,(f=u>=(c=(v+y)/2))?v=c:y=c,n=p,!(p=p[l=f<<1|s]))return this;if(!p.length)break;(n[l+1&3]||n[l+2&3]||n[l+3&3])&&(e=n,h=l)}for(;p.data!==t;)if(r=p,!(p=p.next))return this;return(i=p.next)&&delete p.next,r?(i?r.next=i:delete r.next,this):n?(i?n[l]=i:delete n[l],(p=n[0]||n[1]||n[2]||n[3])&&p===(n[3]||n[2]||n[1]||n[0])&&!p.length&&(e?e[h]=p:this._root=p),this):(this._root=i,this)},op.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},op.root=function(){return this._root},op.size=function(){var t=0;return this.visit(function(n){if(!n.length)do{++t}while(n=n.next)}),t},op.visit=function(t){var n,e,r,i,o,u,a=[],c=this._root;for(c&&a.push(new ip(c,this._x0,this._y0,this._x1,this._y1));n=a.pop();)if(!t(c=n.node,r=n.x0,i=n.y0,o=n.x1,u=n.y1)&&c.length){var s=(r+o)/2,f=(i+u)/2;(e=c[3])&&a.push(new ip(e,s,f,o,u)),(e=c[2])&&a.push(new ip(e,r,f,s,u)),(e=c[1])&&a.push(new ip(e,s,i,o,f)),(e=c[0])&&a.push(new ip(e,r,i,s,f))}return this},op.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new ip(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var o,u=n.x0,a=n.y0,c=n.x1,s=n.y1,f=(u+c)/2,l=(a+s)/2;(o=i[0])&&e.push(new ip(o,u,a,f,l)),(o=i[1])&&e.push(new ip(o,f,a,c,l)),(o=i[2])&&e.push(new ip(o,u,l,f,s)),(o=i[3])&&e.push(new ip(o,f,l,c,s))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this},op.x=function(t){return arguments.length?(this._x=t,this):this._x},op.y=function(t){return arguments.length?(this._y=t,this):this._y};var up,ap=10,cp=Math.PI*(3-Math.sqrt(5)),sp=function(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]},fp=function(t){return(t=sp(Math.abs(t)))?t[1]:NaN},lp=function(t,n){return function(e,r){for(var i=e.length,o=[],u=0,a=t[0],c=0;i>0&&a>0&&(c+a+1>r&&(a=Math.max(1,r-c)),o.push(e.substring(i-=a,i+a)),!((c+=a+1)>r));)a=t[u=(u+1)%t.length];return o.reverse().join(n)}},hp=function(t){return function(n){return n.replace(/[0-9]/g,function(n){return t[+n]})}},pp=function(t,n){var e=sp(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},dp={"":function(t,n){t:for(var e,r=(t=t.toPrecision(n)).length,i=1,o=-1;i<r;++i)switch(t[i]){case".":o=e=i;break;case"0":0===o&&(o=i),e=i;break;case"e":break t;default:o>0&&(o=0)}return o>0?t.slice(0,o)+t.slice(e+1):t},"%":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return pp(100*t,n)},r:pp,s:function(t,n){var e=sp(t,n);if(!e)return t+"";var r=e[0],i=e[1],o=i-(up=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,u=r.length;return o===u?r:o>u?r+new Array(o-u+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+sp(t,Math.max(0,n+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},vp=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;He.prototype=Xe.prototype,Xe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var _p,yp=function(t){return t},gp=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],mp=function(t){function n(t){function n(t){var n,r,u,f=_,x=y;if("c"===v)x=g(t)+x,t="";else{var b=(t=+t)<0;if(t=g(Math.abs(t),d),b&&0==+t&&(b=!1),f=(b?"("===s?s:"-":"-"===s||"("===s?"":s)+f,x=x+("s"===v?gp[8+up/3]:"")+(b&&"("===s?")":""),m)for(n=-1,r=t.length;++n<r;)if(48>(u=t.charCodeAt(n))||u>57){x=(46===u?i+t.slice(n+1):t.slice(n))+x,t=t.slice(0,n);break}}p&&!l&&(t=e(t,1/0));var w=f.length+t.length+x.length,M=w<h?new Array(h-w+1).join(a):"";switch(p&&l&&(t=e(M+t,M.length?h-x.length:1/0),M=""),c){case"<":t=f+t+x+M;break;case"=":t=f+M+t+x;break;case"^":t=M.slice(0,w=M.length>>1)+f+t+x+M.slice(w);break;default:t=M+f+t+x}return o(t)}var a=(t=He(t)).fill,c=t.align,s=t.sign,f=t.symbol,l=t.zero,h=t.width,p=t.comma,d=t.precision,v=t.type,_="$"===f?r[0]:"#"===f&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",y="$"===f?r[1]:/[%p]/.test(v)?u:"",g=dp[v],m=!v||/[defgprs%]/.test(v);return d=null==d?v?6:12:/[gprs]/.test(v)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),n.toString=function(){return t+""},n}var e=t.grouping&&t.thousands?lp(t.grouping,t.thousands):yp,r=t.currency,i=t.decimal,o=t.numerals?hp(t.numerals):yp,u=t.percent||"%";return{format:n,formatPrefix:function(t,e){var r=n((t=He(t),t.type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(fp(e)/3))),o=Math.pow(10,-i),u=gp[8+i/3];return function(t){return r(o*t)+u}}}};$e({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var xp=function(t){return Math.max(0,-fp(Math.abs(t)))},bp=function(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(fp(n)/3)))-fp(Math.abs(t)))},wp=function(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,fp(n)-fp(t))+1},Mp=function(){return new Ve};Ve.prototype={constructor:Ve,reset:function(){this.s=this.t=0},add:function(t){We(nd,t,this.t),We(this,nd.s,this.s),this.s?this.t+=nd.t:this.s=nd.t},valueOf:function(){return this.s}};var Tp,kp,Np,Sp,Ep,Ap,Cp,zp,Pp,Rp,Lp,qp,Up,Dp,Op,Fp,Ip,Yp,Bp,jp,Hp,Xp,$p,Vp,Wp,Zp,Gp,Jp,Qp,Kp,td,nd=new Ve,ed=1e-6,rd=Math.PI,id=rd/2,od=rd/4,ud=2*rd,ad=180/rd,cd=rd/180,sd=Math.abs,fd=Math.atan,ld=Math.atan2,hd=Math.cos,pd=Math.ceil,dd=Math.exp,vd=Math.log,_d=Math.pow,yd=Math.sin,gd=Math.sign||function(t){return t>0?1:t<0?-1:0},md=Math.sqrt,xd=Math.tan,bd={Feature:function(t,n){Ke(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)Ke(e[r].geometry,n)}},wd={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){tr(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)tr(e[r],n,0)},Polygon:function(t,n){nr(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)nr(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)Ke(e[r],n)}},Md=function(t,n){t&&bd.hasOwnProperty(t.type)?bd[t.type](t,n):Ke(t,n)},Td=Mp(),kd=Mp(),Nd={point:Qe,lineStart:Qe,lineEnd:Qe,polygonStart:function(){Td.reset(),Nd.lineStart=er,Nd.lineEnd=rr},polygonEnd:function(){var t=+Td;kd.add(t<0?ud+t:t),this.lineStart=this.lineEnd=this.point=Qe},sphere:function(){kd.add(ud)}},Sd=Mp(),Ed={point:pr,lineStart:vr,lineEnd:_r,polygonStart:function(){Ed.point=yr,Ed.lineStart=gr,Ed.lineEnd=mr,Sd.reset(),Nd.polygonStart()},polygonEnd:function(){Nd.polygonEnd(),Ed.point=pr,Ed.lineStart=vr,Ed.lineEnd=_r,Td<0?(Ap=-(zp=180),Cp=-(Pp=90)):Sd>ed?Pp=90:Sd<-ed&&(Cp=-90),Op[0]=Ap,Op[1]=zp}},Ad={sphere:Qe,point:Mr,lineStart:kr,lineEnd:Er,polygonStart:function(){Ad.lineStart=Ar,Ad.lineEnd=Cr},polygonEnd:function(){Ad.lineStart=kr,Ad.lineEnd=Er}},Cd=function(t){return function(){return t}},zd=function(t,n){function e(e,r){return e=t(e,r),n(e[0],e[1])}return t.invert&&n.invert&&(e.invert=function(e,r){return(e=n.invert(e,r))&&t.invert(e[0],e[1])}),e};Rr.invert=Rr;var Pd,Rd,Ld,qd,Ud,Dd,Od,Fd,Id,Yd,Bd,jd=function(t){function n(n){return n=t(n[0]*cd,n[1]*cd),n[0]*=ad,n[1]*=ad,n}return t=Lr(t[0]*cd,t[1]*cd,t.length>2?t[2]*cd:0),n.invert=function(n){return n=t.invert(n[0]*cd,n[1]*cd),n[0]*=ad,n[1]*=ad,n},n},Hd=function(){var t,n=[];return{point:function(n,e){t.push([n,e])},lineStart:function(){n.push(t=[])},lineEnd:Qe,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}},Xd=function(t,n,e,r,i,o){var u,a=t[0],c=t[1],s=0,f=1,l=n[0]-a,h=n[1]-c;if(u=e-a,l||!(u>0)){if(u/=l,l<0){if(u<s)return;u<f&&(f=u)}else if(l>0){if(u>f)return;u>s&&(s=u)}if(u=i-a,l||!(u<0)){if(u/=l,l<0){if(u>f)return;u>s&&(s=u)}else if(l>0){if(u<s)return;u<f&&(f=u)}if(u=r-c,h||!(u>0)){if(u/=h,h<0){if(u<s)return;u<f&&(f=u)}else if(h>0){if(u>f)return;u>s&&(s=u)}if(u=o-c,h||!(u<0)){if(u/=h,h<0){if(u>f)return;u>s&&(s=u)}else if(h>0){if(u<s)return;u<f&&(f=u)}return s>0&&(t[0]=a+s*l,t[1]=c+s*h),f<1&&(n[0]=a+f*l,n[1]=c+f*h),!0}}}}},$d=function(t,n){return sd(t[0]-n[0])<ed&&sd(t[1]-n[1])<ed},Vd=function(t,n,e,r,i){var o,u,a=[],c=[];if(t.forEach(function(t){if(!((n=t.length-1)<=0)){var n,e,r=t[0],u=t[n];if($d(r,u)){for(i.lineStart(),o=0;o<n;++o)i.point((r=t[o])[0],r[1]);i.lineEnd()}else a.push(e=new Ir(r,t,null,!0)),c.push(e.o=new Ir(r,null,e,!1)),a.push(e=new Ir(u,t,null,!1)),c.push(e.o=new Ir(u,null,e,!0))}}),a.length){for(c.sort(n),Yr(a),Yr(c),o=0,u=c.length;o<u;++o)c[o].e=e=!e;for(var s,f,l=a[0];;){for(var h=l,p=!0;h.v;)if((h=h.n)===l)return;s=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(o=0,u=s.length;o<u;++o)i.point((f=s[o])[0],f[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(p)for(s=h.p.z,o=s.length-1;o>=0;--o)i.point((f=s[o])[0],f[1]);else r(h.x,h.p.x,-1,i);h=h.p}s=(h=h.o).z,p=!p}while(!h.v);i.lineEnd()}}},Wd=1e9,Zd=-Wd,Gd=Mp(),Jd=function(t,n){var e=n[0],r=n[1],i=[yd(e),-hd(e),0],o=0,u=0;Gd.reset();for(var a=0,c=t.length;a<c;++a)if(f=(s=t[a]).length)for(var s,f,l=s[f-1],h=l[0],p=l[1]/2+od,d=yd(p),v=hd(p),_=0;_<f;++_,h=g,d=x,v=b,l=y){var y=s[_],g=y[0],m=y[1]/2+od,x=yd(m),b=hd(m),w=g-h,M=w>=0?1:-1,T=M*w,k=T>rd,N=d*x;if(Gd.add(ld(N*M*yd(T),v*b+N*hd(T))),o+=k?w+M*ud:w,k^h>=e^g>=e){var S=sr(ar(l),ar(y));hr(S);var E=sr(i,S);hr(E);var A=(k^w>=0?-1:1)*Ge(E[2]);(r>A||r===A&&(S[0]||S[1]))&&(u+=k^w>=0?1:-1)}}return(o<-ed||o<ed&&Gd<-ed)^1&u},Qd=Mp(),Kd={sphere:Qe,point:Qe,lineStart:function(){Kd.point=Hr,Kd.lineEnd=jr},lineEnd:Qe,polygonStart:Qe,polygonEnd:Qe},tv=function(t){return Qd.reset(),Md(t,Kd),+Qd},nv=[null,null],ev={type:"LineString",coordinates:nv},rv=function(t,n){return nv[0]=t,nv[1]=n,tv(ev)},iv={Feature:function(t,n){return $r(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)if($r(e[r].geometry,n))return!0;return!1}},ov={Sphere:function(){return!0},Point:function(t,n){return Vr(t.coordinates,n)},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(Vr(e[r],n))return!0;return!1},LineString:function(t,n){return Wr(t.coordinates,n)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(Wr(e[r],n))return!0;return!1},Polygon:function(t,n){return Zr(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(Zr(e[r],n))return!0;return!1},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)if($r(e[r],n))return!0;return!1}},uv=function(t){return t},av=Mp(),cv=Mp(),sv={point:Qe,lineStart:Qe,lineEnd:Qe,polygonStart:function(){sv.lineStart=ni,sv.lineEnd=ii},polygonEnd:function(){sv.lineStart=sv.lineEnd=sv.point=Qe,av.add(sd(cv)),cv.reset()},result:function(){var t=av/2;return av.reset(),t}},fv=1/0,lv=fv,hv=-fv,pv=hv,dv={point:function(t,n){t<fv&&(fv=t),t>hv&&(hv=t),n<lv&&(lv=n),n>pv&&(pv=n)},lineStart:Qe,lineEnd:Qe,polygonStart:Qe,polygonEnd:Qe,result:function(){var t=[[fv,lv],[hv,pv]];return hv=pv=-(lv=fv=1/0),t}},vv=0,_v=0,yv=0,gv=0,mv=0,xv=0,bv=0,wv=0,Mv=0,Tv={point:oi,lineStart:ui,lineEnd:si,polygonStart:function(){Tv.lineStart=fi,Tv.lineEnd=li},polygonEnd:function(){Tv.point=oi,Tv.lineStart=ui,Tv.lineEnd=si},result:function(){var t=Mv?[bv/Mv,wv/Mv]:xv?[gv/xv,mv/xv]:yv?[vv/yv,_v/yv]:[NaN,NaN];return vv=_v=yv=gv=mv=xv=bv=wv=Mv=0,t}};di.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._context.moveTo(t,n),this._point=1;break;case 1:this._context.lineTo(t,n);break;default:this._context.moveTo(t+this._radius,n),this._context.arc(t,n,this._radius,0,ud)}},result:Qe};var kv,Nv,Sv,Ev,Av,Cv=Mp(),zv={point:Qe,lineStart:function(){zv.point=vi},lineEnd:function(){kv&&_i(Nv,Sv),zv.point=Qe},polygonStart:function(){kv=!0},polygonEnd:function(){kv=null},result:function(){var t=+Cv;return Cv.reset(),t}};yi.prototype={_radius:4.5,_circle:gi(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._string.push("M",t,",",n),this._point=1;break;case 1:this._string.push("L",t,",",n);break;default:null==this._circle&&(this._circle=gi(this._radius)),this._string.push("M",t,",",n,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var Pv=function(t,n,e,r){return function(i,o){function u(n,e){var r=i(n,e);t(n=r[0],e=r[1])&&o.point(n,e)}function a(t,n){var e=i(t,n);_.point(e[0],e[1])}function c(){b.point=a,_.lineStart()}function s(){b.point=u,_.lineEnd()}function f(t,n){v.push([t,n]);var e=i(t,n);m.point(e[0],e[1])}function l(){m.lineStart(),v=[]}function h(){f(v[0][0],v[0][1]),m.lineEnd();var t,n,e,r,i=m.clean(),u=g.result(),a=u.length;if(v.pop(),p.push(v),v=null,a)if(1&i){if(e=u[0],(n=e.length-1)>0){for(x||(o.polygonStart(),x=!0),o.lineStart(),t=0;t<n;++t)o.point((r=e[t])[0],r[1]);o.lineEnd()}}else a>1&&2&i&&u.push(u.pop().concat(u.shift())),d.push(u.filter(mi))}var p,d,v,_=n(o),y=i.invert(r[0],r[1]),g=Hd(),m=n(g),x=!1,b={point:u,lineStart:c,lineEnd:s,polygonStart:function(){b.point=f,b.lineStart=l,b.lineEnd=h,d=[],p=[]},polygonEnd:function(){b.point=u,b.lineStart=c,b.lineEnd=s,d=Cs(d);var t=Jd(p,y);d.length?(x||(o.polygonStart(),x=!0),Vd(d,xi,t,e,o)):t&&(x||(o.polygonStart(),x=!0),o.lineStart(),e(null,null,1,o),o.lineEnd()),x&&(o.polygonEnd(),x=!1),d=p=null},sphere:function(){o.polygonStart(),o.lineStart(),e(null,null,1,o),o.lineEnd(),o.polygonEnd()}};return b}},Rv=Pv(function(){return!0},function(t){var n,e=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),n=1},point:function(o,u){var a=o>0?rd:-rd,c=sd(o-e);sd(c-rd)<ed?(t.point(e,r=(r+u)/2>0?id:-id),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),t.point(o,r),n=0):i!==a&&c>=rd&&(sd(e-i)<ed&&(e-=i*ed),sd(o-a)<ed&&(o-=a*ed),r=bi(e,r,o,u),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),n=0),t.point(e=o,r=u),i=a},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-n}}},function(t,n,e,r){var i;if(null==t)i=e*id,r.point(-rd,i),r.point(0,i),r.point(rd,i),r.point(rd,0),r.point(rd,-i),r.point(0,-i),r.point(-rd,-i),r.point(-rd,0),r.point(-rd,i);else if(sd(t[0]-n[0])>ed){var o=t[0]<n[0]?rd:-rd;i=e*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(n[0],n[1])},[-rd,-id]),Lv=function(t,n){function e(t,n){return hd(t)*hd(n)>o}function r(t,n,e){var r=[1,0,0],i=sr(ar(t),ar(n)),u=cr(i,i),a=i[0],c=u-a*a;if(!c)return!e&&t;var s=o*u/c,f=-o*a/c,l=sr(r,i),h=lr(r,s);fr(h,lr(i,f));var p=l,d=cr(h,p),v=cr(p,p),_=d*d-v*(cr(h,h)-1);if(!(_<0)){var y=md(_),g=lr(p,(-d-y)/v);if(fr(g,h),g=ur(g),!e)return g;var m,x=t[0],b=n[0],w=t[1],M=n[1];b<x&&(m=x,x=b,b=m);var T=b-x,k=sd(T-rd)<ed,N=k||T<ed;if(!k&&M<w&&(m=w,w=M,M=m),N?k?w+M>0^g[1]<(sd(g[0]-x)<ed?w:M):w<=g[1]&&g[1]<=M:T>rd^(x<=g[0]&&g[0]<=b)){var S=lr(p,(-d+y)/v);return fr(S,h),[g,ur(S)]}}}function i(n,e){var r=u?t:rd-t,i=0;return n<-r?i|=1:n>r&&(i|=2),e<-r?i|=4:e>r&&(i|=8),i}var o=hd(t),u=o>0,a=sd(o)>ed;return Pv(e,function(t){var n,o,c,s,f;return{lineStart:function(){s=c=!1,f=1},point:function(l,h){var p,d=[l,h],v=e(l,h),_=u?v?0:i(l,h):v?i(l+(l<0?rd:-rd),h):0;if(!n&&(s=c=v)&&t.lineStart(),v!==c&&(!(p=r(n,d))||$d(n,p)||$d(d,p))&&(d[0]+=ed,d[1]+=ed,v=e(d[0],d[1])),v!==c)f=0,v?(t.lineStart(),p=r(d,n),t.point(p[0],p[1])):(p=r(n,d),t.point(p[0],p[1]),t.lineEnd()),n=p;else if(a&&n&&u^v){var y;_&o||!(y=r(d,n,!0))||(f=0,u?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!v||n&&$d(n,d)||t.point(d[0],d[1]),n=d,c=v,o=_},lineEnd:function(){c&&t.lineEnd(),n=null},clean:function(){return f|(s&&c)<<1}}},function(e,r,i,o){Or(o,t,n,i,e,r)},u?[0,-t]:[-rd,t-rd])};Mi.prototype={constructor:Mi,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var qv=16,Uv=hd(30*cd),Dv=function(t,n){return+n?Si(t,n):Ni(t)},Ov=wi({point:function(t,n){this.stream.point(t*cd,n*cd)}}),Fv=function(){return Ci(Pi).scale(155.424).center([0,33.6442])},Iv=function(){return Fv().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])},Yv=Li(function(t){return md(2/(1+t))});Yv.invert=qi(function(t){return 2*Ge(t/2)});var Bv=Li(function(t){return(t=Ze(t))&&t/yd(t)});Bv.invert=qi(function(t){return t});Ui.invert=function(t,n){return[t,2*fd(dd(n))-id]};Ii.invert=Ii;Bi.invert=qi(fd);Hi.invert=qi(Ge);Xi.invert=qi(function(t){return 2*fd(t)});$i.invert=function(t,n){return[-n,2*fd(dd(t))-id]};uo.prototype=eo.prototype={constructor:uo,count:function(){return this.eachAfter(to)},each:function(t){var n,e,r,i,o=this,u=[o];do{for(n=u.reverse(),u=[];o=n.pop();)if(t(o),e=o.children)for(r=0,i=e.length;r<i;++r)u.push(e[r])}while(u.length);return this},eachAfter:function(t){for(var n,e,r,i=this,o=[i],u=[];i=o.pop();)if(u.push(i),n=i.children)for(e=0,r=n.length;e<r;++e)o.push(n[e]);for(;i=u.pop();)t(i);return this},eachBefore:function(t){for(var n,e,r=this,i=[r];r=i.pop();)if(t(r),n=r.children)for(e=n.length-1;e>=0;--e)i.push(n[e]);return this},sum:function(t){return this.eachAfter(function(n){for(var e=+t(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)e+=r[i].value;n.value=e})},sort:function(t){return this.eachBefore(function(n){n.children&&n.children.sort(t)})},path:function(t){for(var n=this,e=no(n,t),r=[n];n!==e;)n=n.parent,r.push(n);for(var i=r.length;t!==e;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n},descendants:function(){var t=[];return this.each(function(n){t.push(n)}),t},leaves:function(){var t=[];return this.eachBefore(function(n){n.children||t.push(n)}),t},links:function(){var t=this,n=[];return t.each(function(e){e!==t&&n.push({source:e.parent,target:e})}),n},copy:function(){return eo(this).eachBefore(io)}};var jv=Array.prototype.slice,Hv=function(t){for(var n,e,r=0,i=(t=ao(jv.call(t))).length,o=[];r<i;)n=t[r],e&&fo(e,n)?++r:(e=ho(o=co(o,n)),r=0);return e},Xv=function(t){return function(){return t}},$v=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},Vv=function(t,n,e,r,i){for(var o,u=t.children,a=-1,c=u.length,s=t.value&&(r-n)/t.value;++a<c;)(o=u[a]).y0=e,o.y1=i,o.x0=n,o.x1=n+=o.value*s},Wv="$",Zv={depth:-1},Gv={};Do.prototype=Object.create(uo.prototype);var Jv=function(t,n,e,r,i){for(var o,u=t.children,a=-1,c=u.length,s=t.value&&(i-e)/t.value;++a<c;)(o=u[a]).x0=n,o.x1=r,o.y0=e,o.y1=e+=o.value*s},Qv=(1+Math.sqrt(5))/2,Kv=function t(n){function e(t,e,r,i,o){Fo(n,t,e,r,i,o)}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(Qv),t_=function t(n){function e(t,e,r,i,o){if((u=t._squarify)&&u.ratio===n)for(var u,a,c,s,f,l=-1,h=u.length,p=t.value;++l<h;){for(c=(a=u[l]).children,s=a.value=0,f=c.length;s<f;++s)a.value+=c[s].value;a.dice?Vv(a,e,r,i,r+=(o-r)*a.value/p):Jv(a,e,r,e+=(i-e)*a.value/p,o),p-=a.value}else t._squarify=u=Fo(n,t,e,r,i,o),u.ratio=n}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(Qv),n_=function(t,n,e){return(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])},e_=[].slice,r_={};Bo.prototype=Wo.prototype={constructor:Bo,defer:function(t){if("function"!=typeof t)throw new Error("invalid callback");if(this._call)throw new Error("defer after await");if(null!=this._error)return this;var n=e_.call(arguments,1);return n.push(t),++this._waiting,this._tasks.push(n),jo(this),this},abort:function(){return null==this._error&&$o(this,new Error("abort")),this},await:function(t){if("function"!=typeof t)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=function(n,e){t.apply(null,[n].concat(e))},Vo(this),this},awaitAll:function(t){if("function"!=typeof t)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=t,Vo(this),this}};var i_=function(){return Math.random()},o_=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return n()*e+t}}return e.source=t,e}(i_),u_=function t(n){function e(t,e){var r,i;return t=null==t?0:+t,e=null==e?1:+e,function(){var o;if(null!=r)o=r,r=null;else do{r=2*n()-1,o=2*n()-1,i=r*r+o*o}while(!i||i>1);return t+e*o*Math.sqrt(-2*Math.log(i)/i)}}return e.source=t,e}(i_),a_=function t(n){function e(){var t=u_.source(n).apply(this,arguments);return function(){return Math.exp(t())}}return e.source=t,e}(i_),c_=function t(n){function e(t){return function(){for(var e=0,r=0;r<t;++r)e+=n();return e}}return e.source=t,e}(i_),s_=function t(n){function e(t){var e=c_.source(n)(t);return function(){return e()/t}}return e.source=t,e}(i_),f_=function t(n){function e(t){return function(){return-Math.log(1-n())/t}}return e.source=t,e}(i_),l_=function(t,n){function e(t){var n,e=s.status;if(!e&&Go(s)||e>=200&&e<300||304===e){if(o)try{n=o.call(r,s)}catch(t){return void a.call("error",r,t)}else n=s;a.call("load",r,n)}else a.call("error",r,t)}var r,i,o,u,a=h("beforesend","progress","load","error"),c=we(),s=new XMLHttpRequest,f=null,l=null,p=0;if("undefined"==typeof XDomainRequest||"withCredentials"in s||!/^(http(s)?:)?\/\//.test(t)||(s=new XDomainRequest),"onload"in s?s.onload=s.onerror=s.ontimeout=e:s.onreadystatechange=function(t){s.readyState>3&&e(t)},s.onprogress=function(t){a.call("progress",r,t)},r={header:function(t,n){return t=(t+"").toLowerCase(),arguments.length<2?c.get(t):(null==n?c.remove(t):c.set(t,n+""),r)},mimeType:function(t){return arguments.length?(i=null==t?null:t+"",r):i},responseType:function(t){return arguments.length?(u=t,r):u},timeout:function(t){return arguments.length?(p=+t,r):p},user:function(t){return arguments.length<1?f:(f=null==t?null:t+"",r)},password:function(t){return arguments.length<1?l:(l=null==t?null:t+"",r)},response:function(t){return o=t,r},get:function(t,n){return r.send("GET",t,n)},post:function(t,n){return r.send("POST",t,n)},send:function(n,e,o){return s.open(n,t,!0,f,l),null==i||c.has("accept")||c.set("accept",i+",*/*"),s.setRequestHeader&&c.each(function(t,n){s.setRequestHeader(n,t)}),null!=i&&s.overrideMimeType&&s.overrideMimeType(i),null!=u&&(s.responseType=u),p>0&&(s.timeout=p),null==o&&"function"==typeof e&&(o=e,e=null),null!=o&&1===o.length&&(o=Zo(o)),null!=o&&r.on("error",o).on("load",function(t){o(null,t)}),a.call("beforesend",r,s),s.send(null==e?null:e),r},abort:function(){return s.abort(),r},on:function(){var t=a.on.apply(a,arguments);return t===a?r:t}},null!=n){if("function"!=typeof n)throw new Error("invalid callback: "+n);return r.get(n)}return r},h_=function(t,n){return function(e,r){var i=l_(e).mimeType(t).response(n);if(null!=r){if("function"!=typeof r)throw new Error("invalid callback: "+r);return i.get(r)}return i}},p_=h_("text/html",function(t){return document.createRange().createContextualFragment(t.responseText)}),d_=h_("application/json",function(t){return JSON.parse(t.responseText)}),v_=h_("text/plain",function(t){return t.responseText}),__=h_("application/xml",function(t){var n=t.responseXML;if(!n)throw new Error("parse error");return n}),y_=function(t,n){return function(e,r,i){arguments.length<3&&(i=r,r=null);var o=l_(e).mimeType(t);return o.row=function(t){return arguments.length?o.response(Jo(n,r=t)):r},o.row(r),i?o.get(i):o}},g_=y_("text/csv",Vh),m_=y_("text/tab-separated-values",Qh),x_=Array.prototype,b_=x_.map,w_=x_.slice,M_={name:"implicit"},T_=function(t){return function(){return t}},k_=function(t){return+t},N_=[0,1],S_=function(n,e,r){var o,u=n[0],a=n[n.length-1],c=i(u,a,null==e?10:e);switch((r=He(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(u),Math.abs(a));return null!=r.precision||isNaN(o=bp(c,s))||(r.precision=o),t.formatPrefix(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=wp(c,Math.max(Math.abs(u),Math.abs(a))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=xp(c))||(r.precision=o-2*("%"===r.type))}return t.format(r)},E_=function(t,n){var e,r=0,i=(t=t.slice()).length-1,o=t[r],u=t[i];return u<o&&(e=r,r=i,i=e,e=o,o=u,u=e),t[r]=n.floor(o),t[i]=n.ceil(u),t},A_=new Date,C_=new Date,z_=Mu(function(){},function(t,n){t.setTime(+t+n)},function(t,n){return n-t});z_.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Mu(function(n){n.setTime(Math.floor(n/t)*t)},function(n,e){n.setTime(+n+e*t)},function(n,e){return(e-n)/t}):z_:null};var P_=z_.range,R_=6e4,L_=6048e5,q_=Mu(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,n){t.setTime(+t+1e3*n)},function(t,n){return(n-t)/1e3},function(t){return t.getUTCSeconds()}),U_=q_.range,D_=Mu(function(t){t.setTime(Math.floor(t/R_)*R_)},function(t,n){t.setTime(+t+n*R_)},function(t,n){return(n-t)/R_},function(t){return t.getMinutes()}),O_=D_.range,F_=Mu(function(t){var n=t.getTimezoneOffset()*R_%36e5;n<0&&(n+=36e5),t.setTime(36e5*Math.floor((+t-n)/36e5)+n)},function(t,n){t.setTime(+t+36e5*n)},function(t,n){return(n-t)/36e5},function(t){return t.getHours()}),I_=F_.range,Y_=Mu(function(t){t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*R_)/864e5},function(t){return t.getDate()-1}),B_=Y_.range,j_=Tu(0),H_=Tu(1),X_=Tu(2),$_=Tu(3),V_=Tu(4),W_=Tu(5),Z_=Tu(6),G_=j_.range,J_=H_.range,Q_=X_.range,K_=$_.range,ty=V_.range,ny=W_.range,ey=Z_.range,ry=Mu(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,n){t.setMonth(t.getMonth()+n)},function(t,n){return n.getMonth()-t.getMonth()+12*(n.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),iy=ry.range,oy=Mu(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n)},function(t,n){return n.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});oy.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Mu(function(n){n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,e){n.setFullYear(n.getFullYear()+e*t)}):null};var uy=oy.range,ay=Mu(function(t){t.setUTCSeconds(0,0)},function(t,n){t.setTime(+t+n*R_)},function(t,n){return(n-t)/R_},function(t){return t.getUTCMinutes()}),cy=ay.range,sy=Mu(function(t){t.setUTCMinutes(0,0,0)},function(t,n){t.setTime(+t+36e5*n)},function(t,n){return(n-t)/36e5},function(t){return t.getUTCHours()}),fy=sy.range,ly=Mu(function(t){t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n)},function(t,n){return(n-t)/864e5},function(t){return t.getUTCDate()-1}),hy=ly.range,py=ku(0),dy=ku(1),vy=ku(2),_y=ku(3),yy=ku(4),gy=ku(5),my=ku(6),xy=py.range,by=dy.range,wy=vy.range,My=_y.range,Ty=yy.range,ky=gy.range,Ny=my.range,Sy=Mu(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCMonth(t.getUTCMonth()+n)},function(t,n){return n.getUTCMonth()-t.getUTCMonth()+12*(n.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),Ey=Sy.range,Ay=Mu(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n)},function(t,n){return n.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Ay.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Mu(function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e*t)}):null};var Cy,zy=Ay.range,Py={"-":"",_:" ",0:"0"},Ry=/^\s*\d+/,Ly=/^%/,qy=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;Ma({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Uy=Date.prototype.toISOString?function(t){return t.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),Dy=+new Date("2000-01-01T00:00:00.000Z")?function(t){var n=new Date(t);return isNaN(n)?null:n}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ"),Oy=1e3,Fy=60*Oy,Iy=60*Fy,Yy=24*Iy,By=7*Yy,jy=30*Yy,Hy=365*Yy,Xy=function(t){return t.match(/.{6}/g).map(function(t){return"#"+t})},$y=Xy("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Vy=Xy("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Wy=Xy("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),Zy=Xy("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),Gy=wl($t(300,.5,0),$t(-240,.5,1)),Jy=wl($t(-100,.75,.35),$t(80,1.5,.8)),Qy=wl($t(260,.75,.35),$t(80,1.5,.8)),Ky=$t(),tg=Sa(Xy("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),ng=Sa(Xy("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),eg=Sa(Xy("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),rg=Sa(Xy("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),ig=function(t){return function(){return t}},og=Math.abs,ug=Math.atan2,ag=Math.cos,cg=Math.max,sg=Math.min,fg=Math.sin,lg=Math.sqrt,hg=1e-12,pg=Math.PI,dg=pg/2,vg=2*pg;Oa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n)}}};var _g=function(t){return new Oa(t)},yg=function(){function t(t){var a,c,s,f=t.length,l=!1;for(null==i&&(u=o(s=ve())),a=0;a<=f;++a)!(a<f&&r(c=t[a],a,t))===l&&((l=!l)?u.lineStart():u.lineEnd()),l&&u.point(+n(c,a,t),+e(c,a,t));if(s)return u=null,s+""||null}var n=Fa,e=Ia,r=ig(!0),i=null,o=_g,u=null;return t.x=function(e){return arguments.length?(n="function"==typeof e?e:ig(+e),t):n},t.y=function(n){return arguments.length?(e="function"==typeof n?n:ig(+n),t):e},t.defined=function(n){return arguments.length?(r="function"==typeof n?n:ig(!!n),t):r},t.curve=function(n){return arguments.length?(o=n,null!=i&&(u=o(i)),t):o},t.context=function(n){return arguments.length?(null==n?i=u=null:u=o(i=n),t):i},t},gg=function(){function t(t){var n,f,l,h,p,d=t.length,v=!1,_=new Array(d),y=new Array(d);for(null==a&&(s=c(p=ve())),n=0;n<=d;++n){if(!(n<d&&u(h=t[n],n,t))===v)if(v=!v)f=n,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),l=n-1;l>=f;--l)s.point(_[l],y[l]);s.lineEnd(),s.areaEnd()}v&&(_[n]=+e(h,n,t),y[n]=+i(h,n,t),s.point(r?+r(h,n,t):_[n],o?+o(h,n,t):y[n]))}if(p)return s=null,p+""||null}function n(){return yg().defined(u).curve(c).context(a)}var e=Fa,r=null,i=ig(0),o=Ia,u=ig(!0),a=null,c=_g,s=null;return t.x=function(n){return arguments.length?(e="function"==typeof n?n:ig(+n),r=null,t):e},t.x0=function(n){return arguments.length?(e="function"==typeof n?n:ig(+n),t):e},t.x1=function(n){return arguments.length?(r=null==n?null:"function"==typeof n?n:ig(+n),t):r},t.y=function(n){return arguments.length?(i="function"==typeof n?n:ig(+n),o=null,t):i},t.y0=function(n){return arguments.length?(i="function"==typeof n?n:ig(+n),t):i},t.y1=function(n){return arguments.length?(o=null==n?null:"function"==typeof n?n:ig(+n),t):o},t.lineX0=t.lineY0=function(){return n().x(e).y(i)},t.lineY1=function(){return n().x(e).y(o)},t.lineX1=function(){return n().x(r).y(i)},t.defined=function(n){return arguments.length?(u="function"==typeof n?n:ig(!!n),t):u},t.curve=function(n){return arguments.length?(c=n,null!=a&&(s=c(a)),t):c},t.context=function(n){return arguments.length?(null==n?a=s=null:s=c(a=n),t):a},t},mg=function(t,n){return n<t?-1:n>t?1:n>=t?0:NaN},xg=function(t){return t},bg=Ba(_g);Ya.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,n){this._curve.point(n*Math.sin(t),n*-Math.cos(t))}};var wg=function(){return ja(yg().curve(bg))},Mg=function(){var t=gg().curve(bg),n=t.curve,e=t.lineX0,r=t.lineX1,i=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return ja(e())},delete t.lineX0,t.lineEndAngle=function(){return ja(r())},delete t.lineX1,t.lineInnerRadius=function(){return ja(i())},delete t.lineY0,t.lineOuterRadius=function(){return ja(o())},delete t.lineY1,t.curve=function(t){return arguments.length?n(Ba(t)):n()._curve},t},Tg=function(t,n){return[(n=+n)*Math.cos(t-=Math.PI/2),n*Math.sin(t)]},kg=Array.prototype.slice,Ng={draw:function(t,n){var e=Math.sqrt(n/pg);t.moveTo(e,0),t.arc(0,0,e,0,vg)}},Sg={draw:function(t,n){var e=Math.sqrt(n/5)/2;t.moveTo(-3*e,-e),t.lineTo(-e,-e),t.lineTo(-e,-3*e),t.lineTo(e,-3*e),t.lineTo(e,-e),t.lineTo(3*e,-e),t.lineTo(3*e,e),t.lineTo(e,e),t.lineTo(e,3*e),t.lineTo(-e,3*e),t.lineTo(-e,e),t.lineTo(-3*e,e),t.closePath()}},Eg=Math.sqrt(1/3),Ag=2*Eg,Cg={draw:function(t,n){var e=Math.sqrt(n/Ag),r=e*Eg;t.moveTo(0,-e),t.lineTo(r,0),t.lineTo(0,e),t.lineTo(-r,0),t.closePath()}},zg=Math.sin(pg/10)/Math.sin(7*pg/10),Pg=Math.sin(vg/10)*zg,Rg=-Math.cos(vg/10)*zg,Lg={draw:function(t,n){var e=Math.sqrt(.8908130915292852*n),r=Pg*e,i=Rg*e;t.moveTo(0,-e),t.lineTo(r,i);for(var o=1;o<5;++o){var u=vg*o/5,a=Math.cos(u),c=Math.sin(u);t.lineTo(c*e,-a*e),t.lineTo(a*r-c*i,c*r+a*i)}t.closePath()}},qg={draw:function(t,n){var e=Math.sqrt(n),r=-e/2;t.rect(r,r,e,e)}},Ug=Math.sqrt(3),Dg={draw:function(t,n){var e=-Math.sqrt(n/(3*Ug));t.moveTo(0,2*e),t.lineTo(-Ug*e,-e),t.lineTo(Ug*e,-e),t.closePath()}},Og=-.5,Fg=Math.sqrt(3)/2,Ig=1/Math.sqrt(12),Yg=3*(Ig/2+1),Bg={draw:function(t,n){var e=Math.sqrt(n/Yg),r=e/2,i=e*Ig,o=r,u=e*Ig+e,a=-o,c=u;t.moveTo(r,i),t.lineTo(o,u),t.lineTo(a,c),t.lineTo(Og*r-Fg*i,Fg*r+Og*i),t.lineTo(Og*o-Fg*u,Fg*o+Og*u),t.lineTo(Og*a-Fg*c,Fg*a+Og*c),t.lineTo(Og*r+Fg*i,Og*i-Fg*r),t.lineTo(Og*o+Fg*u,Og*u-Fg*o),t.lineTo(Og*a+Fg*c,Og*c-Fg*a),t.closePath()}},jg=[Ng,Sg,Cg,qg,Lg,Dg,Bg],Hg=function(){};Ja.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ga(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ga(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};Qa.prototype={areaStart:Hg,areaEnd:Hg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x2=t,this._y2=n;break;case 1:this._point=2,this._x3=t,this._y3=n;break;case 2:this._point=3,this._x4=t,this._y4=n,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+n)/6);break;default:Ga(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};Ka.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var e=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 3:this._point=4;default:Ga(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};tc.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,n=this._y,e=t.length-1;if(e>0)for(var r,i=t[0],o=n[0],u=t[e]-i,a=n[e]-o,c=-1;++c<=e;)r=c/e,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+r*u),this._beta*n[c]+(1-this._beta)*(o+r*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,n){this._x.push(+t),this._y.push(+n)}};var Xg=function t(n){function e(t){return 1===n?new Ja(t):new tc(t,n)}return e.beta=function(n){return t(+n)},e}(.85);ec.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:nc(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2,this._x1=t,this._y1=n;break;case 2:this._point=3;default:nc(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var $g=function t(n){function e(t){return new ec(t,n)}return e.tension=function(n){return t(+n)},e}(0);rc.prototype={areaStart:Hg,areaEnd:Hg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:nc(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Vg=function t(n){function e(t){return new rc(t,n)}return e.tension=function(n){return t(+n)},e}(0);ic.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:nc(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Wg=function t(n){function e(t){return new ic(t,n)}return e.tension=function(n){return t(+n)},e}(0);uc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3;default:oc(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Zg=function t(n){function e(t){return n?new uc(t,n):new ec(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);ac.prototype={areaStart:Hg,areaEnd:Hg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:oc(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Gg=function t(n){function e(t){return n?new ac(t,n):new rc(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);cc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:oc(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Jg=function t(n){function e(t){return n?new cc(t,n):new ic(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);sc.prototype={areaStart:Hg,areaEnd:Hg,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,n){t=+t,n=+n,this._point?this._context.lineTo(t,n):(this._point=1,this._context.moveTo(t,n))}};dc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:pc(this,this._t0,hc(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var e=NaN;if(t=+t,n=+n,t!==this._x1||n!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,pc(this,hc(this,e=lc(this,t,n)),e);break;default:pc(this,this._t0,e=lc(this,t,n))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=e}}},(vc.prototype=Object.create(dc.prototype)).point=function(t,n){dc.prototype.point.call(this,n,t)},_c.prototype={moveTo:function(t,n){this._context.moveTo(n,t)},closePath:function(){this._context.closePath()},lineTo:function(t,n){this._context.lineTo(n,t)},bezierCurveTo:function(t,n,e,r,i,o){this._context.bezierCurveTo(n,t,r,e,o,i)}},yc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,n=this._y,e=t.length;if(e)if(this._line?this._context.lineTo(t[0],n[0]):this._context.moveTo(t[0],n[0]),2===e)this._context.lineTo(t[1],n[1]);else for(var r=gc(t),i=gc(n),o=0,u=1;u<e;++o,++u)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[u],n[u]);(this._line||0!==this._line&&1===e)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,n){this._x.push(+t),this._y.push(+n)}};mc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var e=this._x*(1-this._t)+t*this._t;this._context.lineTo(e,this._y),this._context.lineTo(e,n)}}this._x=t,this._y=n}};var Qg=function(t,n){if((i=t.length)>1)for(var e,r,i,o=1,u=t[n[0]],a=u.length;o<i;++o)for(r=u,u=t[n[o]],e=0;e<a;++e)u[e][1]+=u[e][0]=isNaN(r[e][1])?r[e][0]:r[e][1]},Kg=function(t){for(var n=t.length,e=new Array(n);--n>=0;)e[n]=n;return e},tm=function(t){var n=t.map(bc);return Kg(t).sort(function(t,e){return n[t]-n[e]})},nm=function(t){return function(){return t}};Tc.prototype={constructor:Tc,insert:function(t,n){var e,r,i;if(t){if(n.P=t,n.N=t.N,t.N&&(t.N.P=n),t.N=n,t.R){for(t=t.R;t.L;)t=t.L;t.L=n}else t.R=n;e=t}else this._?(t=Ec(this._),n.P=null,n.N=t,t.P=t.L=n,e=t):(n.P=n.N=null,this._=n,e=null);for(n.L=n.R=null,n.U=e,n.C=!0,t=n;e&&e.C;)e===(r=e.U).L?(i=r.R)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.R&&(Nc(this,e),e=(t=e).U),e.C=!1,r.C=!0,Sc(this,r)):(i=r.L)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.L&&(Sc(this,e),e=(t=e).U),e.C=!1,r.C=!0,Nc(this,r)),e=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var n,e,r,i=t.U,o=t.L,u=t.R;if(e=o?u?Ec(u):o:u,i?i.L===t?i.L=e:i.R=e:this._=e,o&&u?(r=e.C,e.C=t.C,e.L=o,o.U=e,e!==u?(i=e.U,e.U=t.U,t=e.R,i.L=t,e.R=u,u.U=e):(e.U=i,i=e,t=e.R)):(r=t.C,t=e),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((n=i.R).C&&(n.C=!1,i.C=!0,Nc(this,i),n=i.R),n.L&&n.L.C||n.R&&n.R.C){n.R&&n.R.C||(n.L.C=!1,n.C=!0,Sc(this,n),n=i.R),n.C=i.C,i.C=n.R.C=!1,Nc(this,i),t=this._;break}}else if((n=i.L).C&&(n.C=!1,i.C=!0,Sc(this,i),n=i.L),n.L&&n.L.C||n.R&&n.R.C){n.L&&n.L.C||(n.R.C=!1,n.C=!0,Nc(this,n),n=i.L),n.C=i.C,i.C=n.L.C=!1,Sc(this,i),t=this._;break}n.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var em,rm,im,om,um,am=[],cm=[],sm=1e-6,fm=1e-12;Kc.prototype={constructor:Kc,polygons:function(){var t=this.edges;return this.cells.map(function(n){var e=n.halfedges.map(function(e){return Dc(n,t[e])});return e.data=n.site.data,e})},triangles:function(){var t=[],n=this.edges;return this.cells.forEach(function(e,r){if(o=(i=e.halfedges).length)for(var i,o,u,a=e.site,c=-1,s=n[i[o-1]],f=s.left===a?s.right:s.left;++c<o;)u=f,f=(s=n[i[c]]).left===a?s.right:s.left,u&&f&&r<u.index&&r<f.index&&Jc(a,u,f)<0&&t.push([a.data,u.data,f.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,n,e){for(var r,i,o=this,u=o._found||0,a=o.cells.length;!(i=o.cells[u]);)if(++u>=a)return null;var c=t-i.site[0],s=n-i.site[1],f=c*c+s*s;do{i=o.cells[r=u],u=null,i.halfedges.forEach(function(e){var r=o.edges[e],a=r.left;if(a!==i.site&&a||(a=r.right)){var c=t-a[0],s=n-a[1],l=c*c+s*s;l<f&&(f=l,u=a.index)}})}while(null!==u);return o._found=r,null==e||f<=e*e?i.site:null}};var lm=function(t){return function(){return t}};ns.prototype={constructor:ns,scale:function(t){return 1===t?this:new ns(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new ns(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var hm=new ns(1,0,0);es.prototype=ns.prototype;var pm=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()};t.version="4.10.0",t.bisect=hs,t.bisectRight=hs,t.bisectLeft=ps,t.ascending=ss,t.bisector=fs,t.cross=function(t,n,r){var i,o,u,a,c=t.length,s=n.length,f=new Array(c*s);for(null==r&&(r=e),i=u=0;i<c;++i)for(a=t[i],o=0;o<s;++o,++u)f[u]=r(a,n[o]);return f},t.descending=function(t,n){return n<t?-1:n>t?1:n>=t?0:NaN},t.deviation=_s,t.extent=ys,t.histogram=function(){function t(t){var o,u,a=t.length,c=new Array(a);for(o=0;o<a;++o)c[o]=n(t[o],o,t);var s=e(c),f=s[0],l=s[1],h=r(c,f,l);Array.isArray(h)||(h=i(f,l,h),h=Ms(Math.ceil(f/h)*h,Math.floor(l/h)*h,h));for(var p=h.length;h[0]<=f;)h.shift(),--p;for(;h[p-1]>l;)h.pop(),--p;var d,v=new Array(p+1);for(o=0;o<=p;++o)(d=v[o]=[]).x0=o>0?h[o-1]:f,d.x1=o<p?h[o]:l;for(o=0;o<a;++o)f<=(u=c[o])&&u<=l&&v[hs(h,u,0,p)].push(t[o]);return v}var n=ws,e=ys,r=Es;return t.value=function(e){return arguments.length?(n="function"==typeof e?e:bs(e),t):n},t.domain=function(n){return arguments.length?(e="function"==typeof n?n:bs([n[0],n[1]]),t):e},t.thresholds=function(n){return arguments.length?(r="function"==typeof n?n:bs(Array.isArray(n)?ms.call(n):n),t):r},t},t.thresholdFreedmanDiaconis=function(t,n,e){return t=xs.call(t,ds).sort(ss),Math.ceil((e-n)/(2*(As(t,.75)-As(t,.25))*Math.pow(t.length,-1/3)))},t.thresholdScott=function(t,n,e){return Math.ceil((e-n)/(3.5*_s(t)*Math.pow(t.length,-1/3)))},t.thresholdSturges=Es,t.max=function(t,n){var e,r,i=t.length,o=-1;if(null==n){for(;++o<i;)if(null!=(e=t[o])&&e>=e)for(r=e;++o<i;)null!=(e=t[o])&&e>r&&(r=e)}else for(;++o<i;)if(null!=(e=n(t[o],o,t))&&e>=e)for(r=e;++o<i;)null!=(e=n(t[o],o,t))&&e>r&&(r=e);return r},t.mean=function(t,n){var e,r=t.length,i=r,o=-1,u=0;if(null==n)for(;++o<r;)isNaN(e=ds(t[o]))?--i:u+=e;else for(;++o<r;)isNaN(e=ds(n(t[o],o,t)))?--i:u+=e;if(i)return u/i},t.median=function(t,n){var e,r=t.length,i=-1,o=[];if(null==n)for(;++i<r;)isNaN(e=ds(t[i]))||o.push(e);else for(;++i<r;)isNaN(e=ds(n(t[i],i,t)))||o.push(e);return As(o.sort(ss),.5)},t.merge=Cs,t.min=zs,t.pairs=function(t,n){null==n&&(n=e);for(var r=0,i=t.length-1,o=t[0],u=new Array(i<0?0:i);r<i;)u[r]=n(o,o=t[++r]);return u},t.permute=function(t,n){for(var e=n.length,r=new Array(e);e--;)r[e]=t[n[e]];return r},t.quantile=As,t.range=Ms,t.scan=function(t,n){if(e=t.length){var e,r,i=0,o=0,u=t[o];for(null==n&&(n=ss);++i<e;)(n(r=t[i],u)<0||0!==n(u,u))&&(u=r,o=i);return 0===n(u,u)?o:void 0}},t.shuffle=function(t,n,e){for(var r,i,o=(null==e?t.length:e)-(n=null==n?0:+n);o;)i=Math.random()*o--|0,r=t[o+n],t[o+n]=t[i+n],t[i+n]=r;return t},t.sum=function(t,n){var e,r=t.length,i=-1,o=0;if(null==n)for(;++i<r;)(e=+t[i])&&(o+=e);else for(;++i<r;)(e=+n(t[i],i,t))&&(o+=e);return o},t.ticks=Ss,t.tickIncrement=r,t.tickStep=i,t.transpose=Ps,t.variance=vs,t.zip=function(){return Ps(arguments)},t.axisTop=function(t){return l(qs,t)},t.axisRight=function(t){return l(Us,t)},t.axisBottom=function(t){return l(Ds,t)},t.axisLeft=function(t){return l(Os,t)},t.brush=function(){return he(Sh)},t.brushX=function(){return he(kh)},t.brushY=function(){return he(Nh)},t.brushSelection=function(t){var n=t.__brush;return n?n.dim.output(n.selection):null},t.chord=function(){function t(t){var o,u,a,c,s,f,l=t.length,h=[],p=Ms(l),d=[],v=[],_=v.groups=new Array(l),y=new Array(l*l);for(o=0,s=-1;++s<l;){for(u=0,f=-1;++f<l;)u+=t[s][f];h.push(u),d.push(Ms(l)),o+=u}for(e&&p.sort(function(t,n){return e(h[t],h[n])}),r&&d.forEach(function(n,e){n.sort(function(n,i){return r(t[e][n],t[e][i])})}),c=(o=Oh(0,Dh-n*l)/o)?n:Dh/l,u=0,s=-1;++s<l;){for(a=u,f=-1;++f<l;){var g=p[s],m=d[g][f],x=t[g][m],b=u,w=u+=x*o;y[m*l+g]={index:g,subindex:m,startAngle:b,endAngle:w,value:x}}_[g]={index:g,startAngle:a,endAngle:u,value:h[g]},u+=c}for(s=-1;++s<l;)for(f=s-1;++f<l;){var M=y[f*l+s],T=y[s*l+f];(M.value||T.value)&&v.push(M.value<T.value?{source:T,target:M}:{source:M,target:T})}return i?v.sort(i):v}var n=0,e=null,r=null,i=null;return t.padAngle=function(e){return arguments.length?(n=Oh(0,e),t):n},t.sortGroups=function(n){return arguments.length?(e=n,t):e},t.sortSubgroups=function(n){return arguments.length?(r=n,t):r},t.sortChords=function(n){return arguments.length?(null==n?i=null:(i=pe(n))._=n,t):i&&i._},t},t.ribbon=function(){function t(){var t,a=Fh.call(arguments),c=n.apply(this,a),s=e.apply(this,a),f=+r.apply(this,(a[0]=c,a)),l=i.apply(this,a)-Uh,h=o.apply(this,a)-Uh,p=f*Rh(l),d=f*Lh(l),v=+r.apply(this,(a[0]=s,a)),_=i.apply(this,a)-Uh,y=o.apply(this,a)-Uh;if(u||(u=t=ve()),u.moveTo(p,d),u.arc(0,0,f,l,h),l===_&&h===y||(u.quadraticCurveTo(0,0,v*Rh(_),v*Lh(_)),u.arc(0,0,v,_,y)),u.quadraticCurveTo(0,0,p,d),u.closePath(),t)return u=null,t+""||null}var n=_e,e=ye,r=ge,i=me,o=xe,u=null;return t.radius=function(n){return arguments.length?(r="function"==typeof n?n:Ih(+n),t):r},t.startAngle=function(n){return arguments.length?(i="function"==typeof n?n:Ih(+n),t):i},t.endAngle=function(n){return arguments.length?(o="function"==typeof n?n:Ih(+n),t):o},t.source=function(e){return arguments.length?(n=e,t):n},t.target=function(n){return arguments.length?(e=n,t):e},t.context=function(n){return arguments.length?(u=null==n?null:n,t):u},t},t.nest=function(){function t(n,i,u,a){if(i>=o.length)return null!=e&&n.sort(e),null!=r?r(n):n;for(var c,s,f,l=-1,h=n.length,p=o[i++],d=we(),v=u();++l<h;)(f=d.get(c=p(s=n[l])+""))?f.push(s):d.set(c,[s]);return d.each(function(n,e){a(v,e,t(n,i,u,a))}),v}function n(t,e){if(++e>o.length)return t;var i,a=u[e-1];return null!=r&&e>=o.length?i=t.entries():(i=[],t.each(function(t,r){i.push({key:r,values:n(t,e)})})),null!=a?i.sort(function(t,n){return a(t.key,n.key)}):i}var e,r,i,o=[],u=[];return i={object:function(n){return t(n,0,Me,Te)},map:function(n){return t(n,0,ke,Ne)},entries:function(e){return n(t(e,0,ke,Ne),0)},key:function(t){return o.push(t),i},sortKeys:function(t){return u[o.length-1]=t,i},sortValues:function(t){return e=t,i},rollup:function(t){return r=t,i}}},t.set=Ee,t.map=we,t.keys=function(t){var n=[];for(var e in t)n.push(e);return n},t.values=function(t){var n=[];for(var e in t)n.push(t[e]);return n},t.entries=function(t){var n=[];for(var e in t)n.push({key:e,value:t[e]});return n},t.color=Tt,t.rgb=Et,t.hsl=Pt,t.lab=Ut,t.hcl=jt,t.cubehelix=$t,t.dispatch=h,t.drag=function(){function n(t){t.on("mousedown.drag",e).filter(bt).on("touchstart.drag",o).on("touchmove.drag",u).on("touchend.drag touchcancel.drag",a).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function e(){if(!p&&d.apply(this,arguments)){var n=c("mouse",v.apply(this,arguments),Ks,this,arguments);n&&(cf(t.event.view).on("mousemove.drag",r,!0).on("mouseup.drag",i,!0),lf(t.event.view),vt(),l=!1,s=t.event.clientX,f=t.event.clientY,n("start"))}}function r(){if(ff(),!l){var n=t.event.clientX-s,e=t.event.clientY-f;l=n*n+e*e>x}y.mouse("drag")}function i(){cf(t.event.view).on("mousemove.drag mouseup.drag",null),_t(t.event.view,l),ff(),y.mouse("end")}function o(){if(d.apply(this,arguments)){var n,e,r=t.event.changedTouches,i=v.apply(this,arguments),o=r.length;for(n=0;n<o;++n)(e=c(r[n].identifier,i,sf,this,arguments))&&(vt(),e("start"))}}function u(){var n,e,r=t.event.changedTouches,i=r.length;for(n=0;n<i;++n)(e=y[r[n].identifier])&&(ff(),e("drag"))}function a(){var n,e,r=t.event.changedTouches,i=r.length;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),n=0;n<i;++n)(e=y[r[n].identifier])&&(vt(),e("end"))}function c(e,r,i,o,u){var a,c,s,f=i(r,e),l=g.copy();if(N(new yt(n,"beforestart",a,e,m,f[0],f[1],0,0,l),function(){return null!=(t.event.subject=a=_.apply(o,u))&&(c=a.x-f[0]||0,s=a.y-f[1]||0,!0)}))return function t(h){var p,d=f;switch(h){case"start":y[e]=t,p=m++;break;case"end":delete y[e],--m;case"drag":f=i(r,e),p=m}N(new yt(n,h,a,e,p,f[0]+c,f[1]+s,f[0]-d[0],f[1]-d[1],l),l.apply,l,[h,o,u])}}var s,f,l,p,d=gt,v=mt,_=xt,y={},g=h("start","drag","end"),m=0,x=0;return n.filter=function(t){return arguments.length?(d="function"==typeof t?t:hf(!!t),n):d},n.container=function(t){return arguments.length?(v="function"==typeof t?t:hf(t),n):v},n.subject=function(t){return arguments.length?(_="function"==typeof t?t:hf(t),n):_},n.on=function(){var t=g.on.apply(g,arguments);return t===g?n:t},n.clickDistance=function(t){return arguments.length?(x=(t=+t)*t,n):Math.sqrt(x)},n},t.dragDisable=lf,t.dragEnable=_t,t.dsvFormat=Xh,t.csvParse=Vh,t.csvParseRows=Wh,t.csvFormat=Zh,t.csvFormatRows=Gh,t.tsvParse=Qh,t.tsvParseRows=Kh,t.tsvFormat=tp,t.tsvFormatRows=np,t.easeLinear=function(t){return+t},t.easeQuad=Kn,t.easeQuadIn=function(t){return t*t},t.easeQuadOut=function(t){return t*(2-t)},t.easeQuadInOut=Kn,t.easeCubic=te,t.easeCubicIn=function(t){return t*t*t},t.easeCubicOut=function(t){return--t*t*t+1},t.easeCubicInOut=te,t.easePoly=Gl,t.easePolyIn=Wl,t.easePolyOut=Zl,t.easePolyInOut=Gl,t.easeSin=ne,t.easeSinIn=function(t){return 1-Math.cos(t*Ql)},t.easeSinOut=function(t){return Math.sin(t*Ql)},t.easeSinInOut=ne,t.easeExp=ee,t.easeExpIn=function(t){return Math.pow(2,10*t-10)},t.easeExpOut=function(t){return 1-Math.pow(2,-10*t)},t.easeExpInOut=ee,t.easeCircle=re,t.easeCircleIn=function(t){return 1-Math.sqrt(1-t*t)},t.easeCircleOut=function(t){return Math.sqrt(1- --t*t)},t.easeCircleInOut=re,t.easeBounce=ie,t.easeBounceIn=function(t){return 1-ie(1-t)},t.easeBounceOut=ie,t.easeBounceInOut=function(t){return((t*=2)<=1?1-ie(1-t):ie(t-1)+1)/2},t.easeBack=lh,t.easeBackIn=sh,t.easeBackOut=fh,t.easeBackInOut=lh,t.easeElastic=dh,t.easeElasticIn=ph,t.easeElasticOut=dh,t.easeElasticInOut=vh,t.forceCenter=function(t,n){function e(){var e,i,o=r.length,u=0,a=0;for(e=0;e<o;++e)u+=(i=r[e]).x,a+=i.y;for(u=u/o-t,a=a/o-n,e=0;e<o;++e)(i=r[e]).x-=u,i.y-=a}var r;return null==t&&(t=0),null==n&&(n=0),e.initialize=function(t){r=t},e.x=function(n){return arguments.length?(t=+n,e):t},e.y=function(t){return arguments.length?(n=+t,e):n},e},t.forceCollide=function(t){function n(){for(var t,n,r,c,s,f,l,h=i.length,p=0;p<a;++p)for(n=qe(i,Oe,Fe).visitAfter(e),t=0;t<h;++t)r=i[t],f=o[r.index],l=f*f,c=r.x+r.vx,s=r.y+r.vy,n.visit(function(t,n,e,i,o){var a=t.data,h=t.r,p=f+h;if(!a)return n>c+p||i<c-p||e>s+p||o<s-p;if(a.index>r.index){var d=c-a.x-a.vx,v=s-a.y-a.vy,_=d*d+v*v;_<p*p&&(0===d&&(d=rp(),_+=d*d),0===v&&(v=rp(),_+=v*v),_=(p-(_=Math.sqrt(_)))/_*u,r.vx+=(d*=_)*(p=(h*=h)/(l+h)),r.vy+=(v*=_)*p,a.vx-=d*(p=1-p),a.vy-=v*p)}})}function e(t){if(t.data)return t.r=o[t.data.index];for(var n=t.r=0;n<4;++n)t[n]&&t[n].r>t.r&&(t.r=t[n].r)}function r(){if(i){var n,e,r=i.length;for(o=new Array(r),n=0;n<r;++n)e=i[n],o[e.index]=+t(e,n,i)}}var i,o,u=1,a=1;return"function"!=typeof t&&(t=ep(null==t?1:+t)),n.initialize=function(t){i=t,r()},n.iterations=function(t){return arguments.length?(a=+t,n):a},n.strength=function(t){return arguments.length?(u=+t,n):u},n.radius=function(e){return arguments.length?(t="function"==typeof e?e:ep(+e),r(),n):t},n},t.forceLink=function(t){function n(n){for(var e=0,r=t.length;e<p;++e)for(var i,a,c,f,l,h,d,v=0;v<r;++v)a=(i=t[v]).source,f=(c=i.target).x+c.vx-a.x-a.vx||rp(),l=c.y+c.vy-a.y-a.vy||rp(),f*=h=((h=Math.sqrt(f*f+l*l))-u[v])/h*n*o[v],l*=h,c.vx-=f*(d=s[v]),c.vy-=l*d,a.vx+=f*(d=1-d),a.vy+=l*d}function e(){if(a){var n,e,l=a.length,h=t.length,p=we(a,f);for(n=0,c=new Array(l);n<h;++n)(e=t[n]).index=n,"object"!=typeof e.source&&(e.source=Ye(p,e.source)),"object"!=typeof e.target&&(e.target=Ye(p,e.target)),c[e.source.index]=(c[e.source.index]||0)+1,c[e.target.index]=(c[e.target.index]||0)+1;for(n=0,s=new Array(h);n<h;++n)e=t[n],s[n]=c[e.source.index]/(c[e.source.index]+c[e.target.index]);o=new Array(h),r(),u=new Array(h),i()}}function r(){if(a)for(var n=0,e=t.length;n<e;++n)o[n]=+l(t[n],n,t)}function i(){if(a)for(var n=0,e=t.length;n<e;++n)u[n]=+h(t[n],n,t)}var o,u,a,c,s,f=Ie,l=function(t){return 1/Math.min(c[t.source.index],c[t.target.index])},h=ep(30),p=1;return null==t&&(t=[]),n.initialize=function(t){a=t,e()},n.links=function(r){return arguments.length?(t=r,e(),n):t},n.id=function(t){return arguments.length?(f=t,n):f},n.iterations=function(t){return arguments.length?(p=+t,n):p},n.strength=function(t){return arguments.length?(l="function"==typeof t?t:ep(+t),r(),n):l},n.distance=function(t){return arguments.length?(h="function"==typeof t?t:ep(+t),i(),n):h},n},t.forceManyBody=function(){function t(t){var n,a=i.length,c=qe(i,Be,je).visitAfter(e);for(u=t,n=0;n<a;++n)o=i[n],c.visit(r)}function n(){if(i){var t,n,e=i.length;for(a=new Array(e),t=0;t<e;++t)n=i[t],a[n.index]=+c(n,t,i)}}function e(t){var n,e,r,i,o,u=0;if(t.length){for(r=i=o=0;o<4;++o)(n=t[o])&&(e=n.value)&&(u+=e,r+=e*n.x,i+=e*n.y);t.x=r/u,t.y=i/u}else{(n=t).x=n.data.x,n.y=n.data.y;do{u+=a[n.data.index]}while(n=n.next)}t.value=u}function r(t,n,e,r){if(!t.value)return!0;var i=t.x-o.x,c=t.y-o.y,h=r-n,p=i*i+c*c;if(h*h/l<p)return p<f&&(0===i&&(i=rp(),p+=i*i),0===c&&(c=rp(),p+=c*c),p<s&&(p=Math.sqrt(s*p)),o.vx+=i*t.value*u/p,o.vy+=c*t.value*u/p),!0;if(!(t.length||p>=f)){(t.data!==o||t.next)&&(0===i&&(i=rp(),p+=i*i),0===c&&(c=rp(),p+=c*c),p<s&&(p=Math.sqrt(s*p)));do{t.data!==o&&(h=a[t.data.index]*u/p,o.vx+=i*h,o.vy+=c*h)}while(t=t.next)}}var i,o,u,a,c=ep(-30),s=1,f=1/0,l=.81;return t.initialize=function(t){i=t,n()},t.strength=function(e){return arguments.length?(c="function"==typeof e?e:ep(+e),n(),t):c},t.distanceMin=function(n){return arguments.length?(s=n*n,t):Math.sqrt(s)},t.distanceMax=function(n){return arguments.length?(f=n*n,t):Math.sqrt(f)},t.theta=function(n){return arguments.length?(l=n*n,t):Math.sqrt(l)},t},t.forceSimulation=function(t){function n(){e(),d.call("tick",o),u<a&&(p.stop(),d.call("end",o))}function e(){var n,e,r=t.length;for(u+=(s-u)*c,l.each(function(t){t(u)}),n=0;n<r;++n)null==(e=t[n]).fx?e.x+=e.vx*=f:(e.x=e.fx,e.vx=0),null==e.fy?e.y+=e.vy*=f:(e.y=e.fy,e.vy=0)}function r(){for(var n,e=0,r=t.length;e<r;++e){if(n=t[e],n.index=e,isNaN(n.x)||isNaN(n.y)){var i=ap*Math.sqrt(e),o=e*cp;n.x=i*Math.cos(o),n.y=i*Math.sin(o)}(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}}function i(n){return n.initialize&&n.initialize(t),n}var o,u=1,a=.001,c=1-Math.pow(a,1/300),s=0,f=.6,l=we(),p=dn(n),d=h("tick","end");return null==t&&(t=[]),r(),o={tick:e,restart:function(){return p.restart(n),o},stop:function(){return p.stop(),o},nodes:function(n){return arguments.length?(t=n,r(),l.each(i),o):t},alpha:function(t){return arguments.length?(u=+t,o):u},alphaMin:function(t){return arguments.length?(a=+t,o):a},alphaDecay:function(t){return arguments.length?(c=+t,o):+c},alphaTarget:function(t){return arguments.length?(s=+t,o):s},velocityDecay:function(t){return arguments.length?(f=1-t,o):1-f},force:function(t,n){return arguments.length>1?(null==n?l.remove(t):l.set(t,i(n)),o):l.get(t)},find:function(n,e,r){var i,o,u,a,c,s=0,f=t.length;for(null==r?r=1/0:r*=r,s=0;s<f;++s)(u=(i=n-(a=t[s]).x)*i+(o=e-a.y)*o)<r&&(c=a,r=u);return c},on:function(t,n){return arguments.length>1?(d.on(t,n),o):d.on(t)}}},t.forceX=function(t){function n(t){for(var n,e=0,u=r.length;e<u;++e)(n=r[e]).vx+=(o[e]-n.x)*i[e]*t}function e(){if(r){var n,e=r.length;for(i=new Array(e),o=new Array(e),n=0;n<e;++n)i[n]=isNaN(o[n]=+t(r[n],n,r))?0:+u(r[n],n,r)}}var r,i,o,u=ep(.1);return"function"!=typeof t&&(t=ep(null==t?0:+t)),n.initialize=function(t){r=t,e()},n.strength=function(t){return arguments.length?(u="function"==typeof t?t:ep(+t),e(),n):u},n.x=function(r){return arguments.length?(t="function"==typeof r?r:ep(+r),e(),n):t},n},t.forceY=function(t){function n(t){for(var n,e=0,u=r.length;e<u;++e)(n=r[e]).vy+=(o[e]-n.y)*i[e]*t}function e(){if(r){var n,e=r.length;for(i=new Array(e),o=new Array(e),n=0;n<e;++n)i[n]=isNaN(o[n]=+t(r[n],n,r))?0:+u(r[n],n,r)}}var r,i,o,u=ep(.1);return"function"!=typeof t&&(t=ep(null==t?0:+t)),n.initialize=function(t){r=t,e()},n.strength=function(t){return arguments.length?(u="function"==typeof t?t:ep(+t),e(),n):u},n.y=function(r){return arguments.length?(t="function"==typeof r?r:ep(+r),e(),n):t},n},t.formatDefaultLocale=$e,t.formatLocale=mp,t.formatSpecifier=He,t.precisionFixed=xp,t.precisionPrefix=bp,t.precisionRound=wp,t.geoArea=function(t){return kd.reset(),Md(t,Nd),2*kd},t.geoBounds=function(t){var n,e,r,i,o,u,a;if(Pp=zp=-(Ap=Cp=1/0),Dp=[],Md(t,Ed),e=Dp.length){for(Dp.sort(br),n=1,o=[r=Dp[0]];n<e;++n)wr(r,(i=Dp[n])[0])||wr(r,i[1])?(xr(r[0],i[1])>xr(r[0],r[1])&&(r[1]=i[1]),xr(i[0],r[1])>xr(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(u=-1/0,n=0,r=o[e=o.length-1];n<=e;r=i,++n)i=o[n],(a=xr(r[1],i[0]))>u&&(u=a,Ap=i[0],zp=r[1])}return Dp=Op=null,Ap===1/0||Cp===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ap,Cp],[zp,Pp]]},t.geoCentroid=function(t){Fp=Ip=Yp=Bp=jp=Hp=Xp=$p=Vp=Wp=Zp=0,Md(t,Ad);var n=Vp,e=Wp,r=Zp,i=n*n+e*e+r*r;return i<1e-12&&(n=Hp,e=Xp,r=$p,Ip<ed&&(n=Yp,e=Bp,r=jp),(i=n*n+e*e+r*r)<1e-12)?[NaN,NaN]:[ld(e,n)*ad,Ge(r/md(i))*ad]},t.geoCircle=function(){function t(){var t=r.apply(this,arguments),a=i.apply(this,arguments)*cd,c=o.apply(this,arguments)*cd;return n=[],e=Lr(-t[0]*cd,-t[1]*cd,0).invert,Or(u,a,c,1),t={type:"Polygon",coordinates:[n]},n=e=null,t}var n,e,r=Cd([0,0]),i=Cd(90),o=Cd(6),u={point:function(t,r){n.push(t=e(t,r)),t[0]*=ad,t[1]*=ad}};return t.center=function(n){return arguments.length?(r="function"==typeof n?n:Cd([+n[0],+n[1]]),t):r},t.radius=function(n){return arguments.length?(i="function"==typeof n?n:Cd(+n),t):i},t.precision=function(n){return arguments.length?(o="function"==typeof n?n:Cd(+n),t):o},t},t.geoClipExtent=function(){var t,n,e,r=0,i=0,o=960,u=500;return e={stream:function(e){return t&&n===e?t:t=Br(r,i,o,u)(n=e)},extent:function(a){return arguments.length?(r=+a[0][0],i=+a[0][1],o=+a[1][0],u=+a[1][1],t=n=null,e):[[r,i],[o,u]]}}},t.geoContains=function(t,n){return(t&&iv.hasOwnProperty(t.type)?iv[t.type]:$r)(t,n)},t.geoDistance=rv,t.geoGraticule=ti,t.geoGraticule10=function(){return ti()()},t.geoInterpolate=function(t,n){var e=t[0]*cd,r=t[1]*cd,i=n[0]*cd,o=n[1]*cd,u=hd(r),a=yd(r),c=hd(o),s=yd(o),f=u*hd(e),l=u*yd(e),h=c*hd(i),p=c*yd(i),d=2*Ge(md(Je(o-r)+u*c*Je(i-e))),v=yd(d),_=d?function(t){var n=yd(t*=d)/v,e=yd(d-t)/v,r=e*f+n*h,i=e*l+n*p,o=e*a+n*s;return[ld(i,r)*ad,ld(o,md(r*r+i*i))*ad]}:function(){return[e*ad,r*ad]};return _.distance=d,_},t.geoLength=tv,t.geoPath=function(t,n){function e(t){return t&&("function"==typeof o&&i.pointRadius(+o.apply(this,arguments)),Md(t,r(i))),i.result()}var r,i,o=4.5;return e.area=function(t){return Md(t,r(sv)),sv.result()},e.measure=function(t){return Md(t,r(zv)),zv.result()},e.bounds=function(t){return Md(t,r(dv)),dv.result()},e.centroid=function(t){return Md(t,r(Tv)),Tv.result()},e.projection=function(n){return arguments.length?(r=null==n?(t=null,uv):(t=n).stream,e):t},e.context=function(t){return arguments.length?(i=null==t?(n=null,new yi):new di(n=t),"function"!=typeof o&&i.pointRadius(o),e):n},e.pointRadius=function(t){return arguments.length?(o="function"==typeof t?t:(i.pointRadius(+t),+t),e):o},e.projection(t).context(n)},t.geoAlbers=Iv,t.geoAlbersUsa=function(){function t(t){var n=t[0],e=t[1];return a=null,i.point(n,e),a||(o.point(n,e),a)||(u.point(n,e),a)}function n(){return e=r=null,t}var e,r,i,o,u,a,c=Iv(),s=Fv().rotate([154,0]).center([-2,58.5]).parallels([55,65]),f=Fv().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,n){a=[t,n]}};return t.invert=function(t){var n=c.scale(),e=c.translate(),r=(t[0]-e[0])/n,i=(t[1]-e[1])/n;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?f:c).invert(t)},t.stream=function(t){return e&&r===t?e:e=Ri([c.stream(r=t),s.stream(t),f.stream(t)])},t.precision=function(t){return arguments.length?(c.precision(t),s.precision(t),f.precision(t),n()):c.precision()},t.scale=function(n){return arguments.length?(c.scale(n),s.scale(.35*n),f.scale(n),t.translate(c.translate())):c.scale()},t.translate=function(t){if(!arguments.length)return c.translate();var e=c.scale(),r=+t[0],a=+t[1];return i=c.translate(t).clipExtent([[r-.455*e,a-.238*e],[r+.455*e,a+.238*e]]).stream(l),o=s.translate([r-.307*e,a+.201*e]).clipExtent([[r-.425*e+ed,a+.12*e+ed],[r-.214*e-ed,a+.234*e-ed]]).stream(l),u=f.translate([r-.205*e,a+.212*e]).clipExtent([[r-.214*e+ed,a+.166*e+ed],[r-.115*e-ed,a+.234*e-ed]]).stream(l),n()},t.fitExtent=function(n,e){return Ti(t,n,e)},t.fitSize=function(n,e){return ki(t,n,e)},t.scale(1070)},t.geoAzimuthalEqualArea=function(){return Ei(Yv).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=Yv,t.geoAzimuthalEquidistant=function(){return Ei(Bv).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=Bv,t.geoConicConformal=function(){return Ci(Fi).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=Fi,t.geoConicEqualArea=Fv,t.geoConicEqualAreaRaw=Pi,t.geoConicEquidistant=function(){return Ci(Yi).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=Yi,t.geoEquirectangular=function(){return Ei(Ii).scale(152.63)},t.geoEquirectangularRaw=Ii,t.geoGnomonic=function(){return Ei(Bi).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=Bi,t.geoIdentity=function(){function t(){return i=o=null,u}var n,e,r,i,o,u,a=1,c=0,s=0,f=1,l=1,h=uv,p=null,d=uv;return u={stream:function(t){return i&&o===t?i:i=h(d(o=t))},clipExtent:function(i){return arguments.length?(d=null==i?(p=n=e=r=null,uv):Br(p=+i[0][0],n=+i[0][1],e=+i[1][0],r=+i[1][1]),t()):null==p?null:[[p,n],[e,r]]},scale:function(n){return arguments.length?(h=ji((a=+n)*f,a*l,c,s),t()):a},translate:function(n){return arguments.length?(h=ji(a*f,a*l,c=+n[0],s=+n[1]),t()):[c,s]},reflectX:function(n){return arguments.length?(h=ji(a*(f=n?-1:1),a*l,c,s),t()):f<0},reflectY:function(n){return arguments.length?(h=ji(a*f,a*(l=n?-1:1),c,s),t()):l<0},fitExtent:function(t,n){return Ti(u,t,n)},fitSize:function(t,n){return ki(u,t,n)}}},t.geoProjection=Ei,t.geoProjectionMutator=Ai,t.geoMercator=function(){return Di(Ui).scale(961/ud)},t.geoMercatorRaw=Ui,t.geoOrthographic=function(){return Ei(Hi).scale(249.5).clipAngle(90+ed)},t.geoOrthographicRaw=Hi,t.geoStereographic=function(){return Ei(Xi).scale(250).clipAngle(142)},t.geoStereographicRaw=Xi,t.geoTransverseMercator=function(){var t=Di($i),n=t.center,e=t.rotate;return t.center=function(t){return arguments.length?n([-t[1],t[0]]):(t=n(),[t[1],-t[0]])},t.rotate=function(t){return arguments.length?e([t[0],t[1],t.length>2?t[2]+90:90]):(t=e(),[t[0],t[1],t[2]-90])},e([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=$i,t.geoRotation=jd,t.geoStream=Md,t.geoTransform=function(t){return{stream:wi(t)}},t.cluster=function(){function t(t){var o,u=0;t.eachAfter(function(t){var e=t.children;e?(t.x=Wi(e),t.y=Gi(e)):(t.x=o?u+=n(t,o):0,t.y=0,o=t)});var a=Qi(t),c=Ki(t),s=a.x-n(a,c)/2,f=c.x+n(c,a)/2;return t.eachAfter(i?function(n){n.x=(n.x-t.x)*e,n.y=(t.y-n.y)*r}:function(n){n.x=(n.x-s)/(f-s)*e,n.y=(1-(t.y?n.y/t.y:1))*r})}var n=Vi,e=1,r=1,i=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(n){return arguments.length?(i=!1,e=+n[0],r=+n[1],t):i?null:[e,r]},t.nodeSize=function(n){return arguments.length?(i=!0,e=+n[0],r=+n[1],t):i?[e,r]:null},t},t.hierarchy=eo,t.pack=function(){function t(t){return t.x=e/2,t.y=r/2,n?t.eachBefore(No(n)).eachAfter(So(i,.5)).eachBefore(Eo(1)):t.eachBefore(No(ko)).eachAfter(So(To,1)).eachAfter(So(i,t.r/Math.min(e,r))).eachBefore(Eo(Math.min(e,r)/(2*t.r))),t}var n=null,e=1,r=1,i=To;return t.radius=function(e){return arguments.length?(n=wo(e),t):n},t.size=function(n){return arguments.length?(e=+n[0],r=+n[1],t):[e,r]},t.padding=function(n){return arguments.length?(i="function"==typeof n?n:Xv(+n),t):i},t},t.packSiblings=function(t){return bo(t),t},t.packEnclose=Hv,t.partition=function(){function t(t){var u=t.height+1;return t.x0=t.y0=i,t.x1=e,t.y1=r/u,t.eachBefore(n(r,u)),o&&t.eachBefore($v),t}function n(t,n){return function(e){e.children&&Vv(e,e.x0,t*(e.depth+1)/n,e.x1,t*(e.depth+2)/n);var r=e.x0,o=e.y0,u=e.x1-i,a=e.y1-i;u<r&&(r=u=(r+u)/2),a<o&&(o=a=(o+a)/2),e.x0=r,e.y0=o,e.x1=u,e.y1=a}}var e=1,r=1,i=0,o=!1;return t.round=function(n){return arguments.length?(o=!!n,t):o},t.size=function(n){return arguments.length?(e=+n[0],r=+n[1],t):[e,r]},t.padding=function(n){return arguments.length?(i=+n,t):i},t},t.stratify=function(){function t(t){var r,i,o,u,a,c,s,f=t.length,l=new Array(f),h={};for(i=0;i<f;++i)r=t[i],a=l[i]=new uo(r),null!=(c=n(r,i,t))&&(c+="")&&(h[s=Wv+(a.id=c)]=s in h?Gv:a);for(i=0;i<f;++i)if(a=l[i],null!=(c=e(t[i],i,t))&&(c+="")){if(!(u=h[Wv+c]))throw new Error("missing: "+c);if(u===Gv)throw new Error("ambiguous: "+c);u.children?u.children.push(a):u.children=[a],a.parent=u}else{if(o)throw new Error("multiple roots");o=a}if(!o)throw new Error("no root");if(o.parent=Zv,o.eachBefore(function(t){t.depth=t.parent.depth+1,--f}).eachBefore(oo),o.parent=null,f>0)throw new Error("cycle");return o}var n=Ao,e=Co;return t.id=function(e){return arguments.length?(n=Mo(e),t):n},t.parentId=function(n){return arguments.length?(e=Mo(n),t):e},t},t.tree=function(){function t(t){var r=Oo(t);if(r.eachAfter(n),r.parent.m=-r.z,r.eachBefore(e),c)t.eachBefore(i);else{var s=t,f=t,l=t;t.eachBefore(function(t){t.x<s.x&&(s=t),t.x>f.x&&(f=t),t.depth>l.depth&&(l=t)});var h=s===f?1:o(s,f)/2,p=h-s.x,d=u/(f.x+h+p),v=a/(l.depth||1);t.eachBefore(function(t){t.x=(t.x+p)*d,t.y=t.depth*v})}return t}function n(t){var n=t.children,e=t.parent.children,i=t.i?e[t.i-1]:null;if(n){qo(t);var u=(n[0].z+n[n.length-1].z)/2;i?(t.z=i.z+o(t._,i._),t.m=t.z-u):t.z=u}else i&&(t.z=i.z+o(t._,i._));t.parent.A=r(t,i,t.parent.A||e[0])}function e(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function r(t,n,e){if(n){for(var r,i=t,u=t,a=n,c=i.parent.children[0],s=i.m,f=u.m,l=a.m,h=c.m;a=Ro(a),i=Po(i),a&&i;)c=Po(c),(u=Ro(u)).a=t,(r=a.z+l-i.z-s+o(a._,i._))>0&&(Lo(Uo(a,t,e),t,r),s+=r,f+=r),l+=a.m,s+=i.m,h+=c.m,f+=u.m;a&&!Ro(u)&&(u.t=a,u.m+=l-f),i&&!Po(c)&&(c.t=i,c.m+=s-h,e=t)}return e}function i(t){t.x*=u,t.y=t.depth*a}var o=zo,u=1,a=1,c=null;return t.separation=function(n){return arguments.length?(o=n,t):o},t.size=function(n){return arguments.length?(c=!1,u=+n[0],a=+n[1],t):c?null:[u,a]},t.nodeSize=function(n){return arguments.length?(c=!0,u=+n[0],a=+n[1],t):c?[u,a]:null},t},t.treemap=function(){function t(t){return t.x0=t.y0=0,t.x1=i,t.y1=o,t.eachBefore(n),u=[0],r&&t.eachBefore($v),t}function n(t){var n=u[t.depth],r=t.x0+n,i=t.y0+n,o=t.x1-n,h=t.y1-n;o<r&&(r=o=(r+o)/2),h<i&&(i=h=(i+h)/2),t.x0=r,t.y0=i,t.x1=o,t.y1=h,t.children&&(n=u[t.depth+1]=a(t)/2,r+=l(t)-n,i+=c(t)-n,o-=s(t)-n,h-=f(t)-n,o<r&&(r=o=(r+o)/2),h<i&&(i=h=(i+h)/2),e(t,r,i,o,h))}var e=Kv,r=!1,i=1,o=1,u=[0],a=To,c=To,s=To,f=To,l=To;return t.round=function(n){return arguments.length?(r=!!n,t):r},t.size=function(n){return arguments.length?(i=+n[0],o=+n[1],t):[i,o]},t.tile=function(n){return arguments.length?(e=Mo(n),t):e},t.padding=function(n){return arguments.length?t.paddingInner(n).paddingOuter(n):t.paddingInner()},t.paddingInner=function(n){return arguments.length?(a="function"==typeof n?n:Xv(+n),t):a},t.paddingOuter=function(n){return arguments.length?t.paddingTop(n).paddingRight(n).paddingBottom(n).paddingLeft(n):t.paddingTop()},t.paddingTop=function(n){return arguments.length?(c="function"==typeof n?n:Xv(+n),t):c},t.paddingRight=function(n){return arguments.length?(s="function"==typeof n?n:Xv(+n),t):s},t.paddingBottom=function(n){return arguments.length?(f="function"==typeof n?n:Xv(+n),t):f},t.paddingLeft=function(n){return arguments.length?(l="function"==typeof n?n:Xv(+n),t):l},t},t.treemapBinary=function(t,n,e,r,i){function o(t,n,e,r,i,u,a){if(t>=n-1){var s=c[t];return s.x0=r,s.y0=i,s.x1=u,void(s.y1=a)}for(var l=f[t],h=e/2+l,p=t+1,d=n-1;p<d;){var v=p+d>>>1;f[v]<h?p=v+1:d=v}h-f[p-1]<f[p]-h&&t+1<p&&--p;var _=f[p]-l,y=e-_;if(u-r>a-i){var g=(r*y+u*_)/e;o(t,p,_,r,i,g,a),o(p,n,y,g,i,u,a)}else{var m=(i*y+a*_)/e;o(t,p,_,r,i,u,m),o(p,n,y,r,m,u,a)}}var u,a,c=t.children,s=c.length,f=new Array(s+1);for(f[0]=a=u=0;u<s;++u)f[u+1]=a+=c[u].value;o(0,s,t.value,n,e,r,i)},t.treemapDice=Vv,t.treemapSlice=Jv,t.treemapSliceDice=function(t,n,e,r,i){(1&t.depth?Jv:Vv)(t,n,e,r,i)},t.treemapSquarify=Kv,t.treemapResquarify=t_,t.interpolate=cl,t.interpolateArray=nl,t.interpolateBasis=Zf,t.interpolateBasisClosed=Gf,t.interpolateDate=el,t.interpolateNumber=rl,t.interpolateObject=il,t.interpolateRound=sl,t.interpolateString=al,t.interpolateTransformCss=pl,t.interpolateTransformSvg=dl,t.interpolateZoom=_l,t.interpolateRgb=Qf,t.interpolateRgbBasis=Kf,t.interpolateRgbBasisClosed=tl,t.interpolateHsl=yl,t.interpolateHslLong=gl,t.interpolateLab=function(t,n){var e=Kt((t=Ut(t)).l,(n=Ut(n)).l),r=Kt(t.a,n.a),i=Kt(t.b,n.b),o=Kt(t.opacity,n.opacity);return function(n){return t.l=e(n),t.a=r(n),t.b=i(n),t.opacity=o(n),t+""}},t.interpolateHcl=ml,t.interpolateHclLong=xl,t.interpolateCubehelix=bl,t.interpolateCubehelixLong=wl,t.quantize=function(t,n){for(var e=new Array(n),r=0;r<n;++r)e[r]=t(r/(n-1));return e},t.path=ve,t.polygonArea=function(t){for(var n,e=-1,r=t.length,i=t[r-1],o=0;++e<r;)n=i,i=t[e],o+=n[1]*i[0]-n[0]*i[1];return o/2},t.polygonCentroid=function(t){for(var n,e,r=-1,i=t.length,o=0,u=0,a=t[i-1],c=0;++r<i;)n=a,a=t[r],c+=e=n[0]*a[1]-a[0]*n[1],o+=(n[0]+a[0])*e,u+=(n[1]+a[1])*e;return c*=3,[o/c,u/c]},t.polygonHull=function(t){if((e=t.length)<3)return null;var n,e,r=new Array(e),i=new Array(e);for(n=0;n<e;++n)r[n]=[+t[n][0],+t[n][1],n];for(r.sort(Io),n=0;n<e;++n)i[n]=[r[n][0],-r[n][1]];var o=Yo(r),u=Yo(i),a=u[0]===o[0],c=u[u.length-1]===o[o.length-1],s=[];for(n=o.length-1;n>=0;--n)s.push(t[r[o[n]][2]]);for(n=+a;n<u.length-c;++n)s.push(t[r[u[n]][2]]);return s},t.polygonContains=function(t,n){for(var e,r,i=t.length,o=t[i-1],u=n[0],a=n[1],c=o[0],s=o[1],f=!1,l=0;l<i;++l)e=(o=t[l])[0],(r=o[1])>a!=s>a&&u<(c-e)*(a-r)/(s-r)+e&&(f=!f),c=e,s=r;return f},t.polygonLength=function(t){for(var n,e,r=-1,i=t.length,o=t[i-1],u=o[0],a=o[1],c=0;++r<i;)n=u,e=a,n-=u=(o=t[r])[0],e-=a=o[1],c+=Math.sqrt(n*n+e*e);return c},t.quadtree=qe,t.queue=Wo,t.randomUniform=o_,t.randomNormal=u_,t.randomLogNormal=a_,t.randomBates=s_,t.randomIrwinHall=c_,t.randomExponential=f_,t.request=l_,t.html=p_,t.json=d_,t.text=v_,t.xml=__,t.csv=g_,t.tsv=m_,t.scaleBand=Ko,t.scalePoint=function(){return tu(Ko().paddingInner(1))},t.scaleIdentity=fu,t.scaleLinear=su,t.scaleLog=yu,t.scaleOrdinal=Qo,t.scaleImplicit=M_,t.scalePow=mu,t.scaleSqrt=function(){return mu().exponent(.5)},t.scaleQuantile=xu,t.scaleQuantize=bu,t.scaleThreshold=wu,t.scaleTime=function(){return Na(oy,ry,j_,Y_,F_,D_,q_,z_,t.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},t.scaleUtc=function(){return Na(Ay,Sy,py,ly,sy,ay,q_,z_,t.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},t.schemeCategory10=$y,t.schemeCategory20b=Vy,t.schemeCategory20c=Wy,t.schemeCategory20=Zy,t.interpolateCubehelixDefault=Gy,t.interpolateRainbow=function(t){(t<0||t>1)&&(t-=Math.floor(t));var n=Math.abs(t-.5);return Ky.h=360*t-100,Ky.s=1.5-1.5*n,Ky.l=.8-.9*n,Ky+""},t.interpolateWarm=Jy,t.interpolateCool=Qy,t.interpolateViridis=tg,t.interpolateMagma=ng,t.interpolateInferno=eg,t.interpolatePlasma=rg,t.scaleSequential=Ea,t.creator=Hs,t.local=m,t.matcher=Zs,t.mouse=Ks,t.namespace=js,t.namespaces=Bs,t.select=cf,t.selectAll=function(t){return"string"==typeof t?new pt([document.querySelectorAll(t)],[document.documentElement]):new pt([null==t?[]:t],af)},t.selection=dt,t.selector=tf,t.selectorAll=nf,t.style=B,t.touch=sf,t.touches=function(t,n){null==n&&(n=Js().touches);for(var e=0,r=n?n.length:0,i=new Array(r);e<r;++e)i[e]=Qs(t,n[e]);return i},t.window=uf,t.customEvent=N,t.arc=function(){function t(){var t,s,f=+n.apply(this,arguments),l=+e.apply(this,arguments),h=o.apply(this,arguments)-dg,p=u.apply(this,arguments)-dg,d=og(p-h),v=p>h;if(c||(c=t=ve()),l<f&&(s=l,l=f,f=s),l>hg)if(d>vg-hg)c.moveTo(l*ag(h),l*fg(h)),c.arc(0,0,l,h,p,!v),f>hg&&(c.moveTo(f*ag(p),f*fg(p)),c.arc(0,0,f,p,h,v));else{var _,y,g=h,m=p,x=h,b=p,w=d,M=d,T=a.apply(this,arguments)/2,k=T>hg&&(i?+i.apply(this,arguments):lg(f*f+l*l)),N=sg(og(l-f)/2,+r.apply(this,arguments)),S=N,E=N;if(k>hg){var A=Ca(k/f*fg(T)),C=Ca(k/l*fg(T));(w-=2*A)>hg?(A*=v?1:-1,x+=A,b-=A):(w=0,x=b=(h+p)/2),(M-=2*C)>hg?(C*=v?1:-1,g+=C,m-=C):(M=0,g=m=(h+p)/2)}var z=l*ag(g),P=l*fg(g),R=f*ag(b),L=f*fg(b);if(N>hg){var q=l*ag(m),U=l*fg(m),D=f*ag(x),O=f*fg(x);if(d<pg){var F=w>hg?Ua(z,P,D,O,q,U,R,L):[R,L],I=z-F[0],Y=P-F[1],B=q-F[0],j=U-F[1],H=1/fg(Aa((I*B+Y*j)/(lg(I*I+Y*Y)*lg(B*B+j*j)))/2),X=lg(F[0]*F[0]+F[1]*F[1]);S=sg(N,(f-X)/(H-1)),E=sg(N,(l-X)/(H+1))}}M>hg?E>hg?(_=Da(D,O,z,P,l,E,v),y=Da(q,U,R,L,l,E,v),c.moveTo(_.cx+_.x01,_.cy+_.y01),E<N?c.arc(_.cx,_.cy,E,ug(_.y01,_.x01),ug(y.y01,y.x01),!v):(c.arc(_.cx,_.cy,E,ug(_.y01,_.x01),ug(_.y11,_.x11),!v),c.arc(0,0,l,ug(_.cy+_.y11,_.cx+_.x11),ug(y.cy+y.y11,y.cx+y.x11),!v),c.arc(y.cx,y.cy,E,ug(y.y11,y.x11),ug(y.y01,y.x01),!v))):(c.moveTo(z,P),c.arc(0,0,l,g,m,!v)):c.moveTo(z,P),f>hg&&w>hg?S>hg?(_=Da(R,L,q,U,f,-S,v),y=Da(z,P,D,O,f,-S,v),c.lineTo(_.cx+_.x01,_.cy+_.y01),S<N?c.arc(_.cx,_.cy,S,ug(_.y01,_.x01),ug(y.y01,y.x01),!v):(c.arc(_.cx,_.cy,S,ug(_.y01,_.x01),ug(_.y11,_.x11),!v),c.arc(0,0,f,ug(_.cy+_.y11,_.cx+_.x11),ug(y.cy+y.y11,y.cx+y.x11),v),c.arc(y.cx,y.cy,S,ug(y.y11,y.x11),ug(y.y01,y.x01),!v))):c.arc(0,0,f,b,x,v):c.lineTo(R,L)}else c.moveTo(0,0);if(c.closePath(),t)return c=null,t+""||null}var n=za,e=Pa,r=ig(0),i=null,o=Ra,u=La,a=qa,c=null;return t.centroid=function(){var t=(+n.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+o.apply(this,arguments)+ +u.apply(this,arguments))/2-pg/2;return[ag(r)*t,fg(r)*t]},t.innerRadius=function(e){return arguments.length?(n="function"==typeof e?e:ig(+e),t):n},t.outerRadius=function(n){return arguments.length?(e="function"==typeof n?n:ig(+n),t):e},t.cornerRadius=function(n){return arguments.length?(r="function"==typeof n?n:ig(+n),t):r},t.padRadius=function(n){return arguments.length?(i=null==n?null:"function"==typeof n?n:ig(+n),t):i},t.startAngle=function(n){return arguments.length?(o="function"==typeof n?n:ig(+n),t):o},t.endAngle=function(n){return arguments.length?(u="function"==typeof n?n:ig(+n),t):u},t.padAngle=function(n){return arguments.length?(a="function"==typeof n?n:ig(+n),t):a},t.context=function(n){return arguments.length?(c=null==n?null:n,t):c},t},t.area=gg,t.line=yg,t.pie=function(){function t(t){var a,c,s,f,l,h=t.length,p=0,d=new Array(h),v=new Array(h),_=+i.apply(this,arguments),y=Math.min(vg,Math.max(-vg,o.apply(this,arguments)-_)),g=Math.min(Math.abs(y)/h,u.apply(this,arguments)),m=g*(y<0?-1:1);for(a=0;a<h;++a)(l=v[d[a]=a]=+n(t[a],a,t))>0&&(p+=l);for(null!=e?d.sort(function(t,n){return e(v[t],v[n])}):null!=r&&d.sort(function(n,e){return r(t[n],t[e])}),a=0,s=p?(y-h*m)/p:0;a<h;++a,_=f)c=d[a],f=_+((l=v[c])>0?l*s:0)+m,v[c]={data:t[c],index:a,value:l,startAngle:_,endAngle:f,padAngle:g};return v}var n=xg,e=mg,r=null,i=ig(0),o=ig(vg),u=ig(0);return t.value=function(e){return arguments.length?(n="function"==typeof e?e:ig(+e),t):n},t.sortValues=function(n){return arguments.length?(e=n,r=null,t):e},t.sort=function(n){return arguments.length?(r=n,e=null,t):r},t.startAngle=function(n){return arguments.length?(i="function"==typeof n?n:ig(+n),t):i},t.endAngle=function(n){return arguments.length?(o="function"==typeof n?n:ig(+n),t):o},t.padAngle=function(n){return arguments.length?(u="function"==typeof n?n:ig(+n),t):u},t},t.areaRadial=Mg,t.radialArea=Mg,t.lineRadial=wg,t.radialLine=wg,t.pointRadial=Tg,t.linkHorizontal=function(){return $a(Va)},t.linkVertical=function(){return $a(Wa)},t.linkRadial=function(){var t=$a(Za);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t},t.symbol=function(){function t(){var t;if(r||(r=t=ve()),n.apply(this,arguments).draw(r,+e.apply(this,arguments)),t)return r=null,t+""||null}var n=ig(Ng),e=ig(64),r=null;return t.type=function(e){return arguments.length?(n="function"==typeof e?e:ig(e),t):n},t.size=function(n){return arguments.length?(e="function"==typeof n?n:ig(+n),t):e},t.context=function(n){return arguments.length?(r=null==n?null:n,t):r},t},t.symbols=jg,t.symbolCircle=Ng,t.symbolCross=Sg,t.symbolDiamond=Cg,t.symbolSquare=qg,t.symbolStar=Lg,t.symbolTriangle=Dg,t.symbolWye=Bg,t.curveBasisClosed=function(t){return new Qa(t)},t.curveBasisOpen=function(t){return new Ka(t)},t.curveBasis=function(t){return new Ja(t)},t.curveBundle=Xg,t.curveCardinalClosed=Vg,t.curveCardinalOpen=Wg,t.curveCardinal=$g,t.curveCatmullRomClosed=Gg,t.curveCatmullRomOpen=Jg,t.curveCatmullRom=Zg,t.curveLinearClosed=function(t){return new sc(t)},t.curveLinear=_g,t.curveMonotoneX=function(t){return new dc(t)},t.curveMonotoneY=function(t){return new vc(t)},t.curveNatural=function(t){return new yc(t)},t.curveStep=function(t){return new mc(t,.5)},t.curveStepAfter=function(t){return new mc(t,1)},t.curveStepBefore=function(t){return new mc(t,0)},t.stack=function(){function t(t){var o,u,a=n.apply(this,arguments),c=t.length,s=a.length,f=new Array(s);for(o=0;o<s;++o){for(var l,h=a[o],p=f[o]=new Array(c),d=0;d<c;++d)p[d]=l=[0,+i(t[d],h,d,t)],l.data=t[d];p.key=h}for(o=0,u=e(f);o<s;++o)f[u[o]].index=o;return r(f,u),f}var n=ig([]),e=Kg,r=Qg,i=xc;return t.keys=function(e){return arguments.length?(n="function"==typeof e?e:ig(kg.call(e)),t):n},t.value=function(n){return arguments.length?(i="function"==typeof n?n:ig(+n),t):i},t.order=function(n){return arguments.length?(e=null==n?Kg:"function"==typeof n?n:ig(kg.call(n)),t):e},t.offset=function(n){return arguments.length?(r=null==n?Qg:n,t):r},t},t.stackOffsetExpand=function(t,n){if((r=t.length)>0){for(var e,r,i,o=0,u=t[0].length;o<u;++o){for(i=e=0;e<r;++e)i+=t[e][o][1]||0;if(i)for(e=0;e<r;++e)t[e][o][1]/=i}Qg(t,n)}},t.stackOffsetDiverging=function(t,n){if((a=t.length)>1)for(var e,r,i,o,u,a,c=0,s=t[n[0]].length;c<s;++c)for(o=u=0,e=0;e<a;++e)(i=(r=t[n[e]][c])[1]-r[0])>=0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=u,r[0]=u+=i):r[0]=o},t.stackOffsetNone=Qg,t.stackOffsetSilhouette=function(t,n){if((e=t.length)>0){for(var e,r=0,i=t[n[0]],o=i.length;r<o;++r){for(var u=0,a=0;u<e;++u)a+=t[u][r][1]||0;i[r][1]+=i[r][0]=-a/2}Qg(t,n)}},t.stackOffsetWiggle=function(t,n){if((i=t.length)>0&&(r=(e=t[n[0]]).length)>0){for(var e,r,i,o=0,u=1;u<r;++u){for(var a=0,c=0,s=0;a<i;++a){for(var f=t[n[a]],l=f[u][1]||0,h=(l-(f[u-1][1]||0))/2,p=0;p<a;++p){var d=t[n[p]];h+=(d[u][1]||0)-(d[u-1][1]||0)}c+=l,s+=h*l}e[u-1][1]+=e[u-1][0]=o,c&&(o-=s/c)}e[u-1][1]+=e[u-1][0]=o,Qg(t,n)}},t.stackOrderAscending=tm,t.stackOrderDescending=function(t){return tm(t).reverse()},t.stackOrderInsideOut=function(t){var n,e,r=t.length,i=t.map(bc),o=Kg(t).sort(function(t,n){return i[n]-i[t]}),u=0,a=0,c=[],s=[];for(n=0;n<r;++n)e=o[n],u<a?(u+=i[e],c.push(e)):(a+=i[e],s.push(e));return s.reverse().concat(c)},t.stackOrderNone=Kg,t.stackOrderReverse=function(t){return Kg(t).reverse()},t.timeInterval=Mu,t.timeMillisecond=z_,t.timeMilliseconds=P_,t.utcMillisecond=z_,t.utcMilliseconds=P_,t.timeSecond=q_,t.timeSeconds=U_,t.utcSecond=q_,t.utcSeconds=U_,t.timeMinute=D_,t.timeMinutes=O_,t.timeHour=F_,t.timeHours=I_,t.timeDay=Y_,t.timeDays=B_,t.timeWeek=j_,t.timeWeeks=G_,t.timeSunday=j_,t.timeSundays=G_,t.timeMonday=H_,t.timeMondays=J_,t.timeTuesday=X_,t.timeTuesdays=Q_,t.timeWednesday=$_,t.timeWednesdays=K_,t.timeThursday=V_,t.timeThursdays=ty,t.timeFriday=W_,t.timeFridays=ny,t.timeSaturday=Z_,t.timeSaturdays=ey,t.timeMonth=ry,t.timeMonths=iy,t.timeYear=oy,t.timeYears=uy,t.utcMinute=ay,t.utcMinutes=cy,t.utcHour=sy,t.utcHours=fy,t.utcDay=ly,t.utcDays=hy,t.utcWeek=py,t.utcWeeks=xy,t.utcSunday=py,t.utcSundays=xy,t.utcMonday=dy,t.utcMondays=by,t.utcTuesday=vy,t.utcTuesdays=wy,t.utcWednesday=_y,t.utcWednesdays=My,t.utcThursday=yy,t.utcThursdays=Ty,t.utcFriday=gy,t.utcFridays=ky,t.utcSaturday=my,t.utcSaturdays=Ny,t.utcMonth=Sy,t.utcMonths=Ey,t.utcYear=Ay,t.utcYears=zy,t.timeFormatDefaultLocale=Ma,t.timeFormatLocale=Au,t.isoFormat=Uy,t.isoParse=Dy,t.now=ln,t.timer=dn,t.timerFlush=vn,t.timeout=Pl,t.interval=function(t,n,e){var r=new pn,i=n;return null==n?(r.restart(t,n,e),r):(n=+n,e=null==e?ln():+e,r.restart(function o(u){u+=i,r.restart(o,i+=n,e),t(u)},n,e),r)},t.transition=Jn,t.active=function(t,n){var e,r,i=t.__transition;if(i){n=null==n?null:n+"";for(r in i)if((e=i[r]).state>Ul&&e.name===n)return new Gn([[t]],yh,n,+r)}return null},t.interrupt=jl,t.voronoi=function(){function t(t){return new Kc(t.map(function(r,i){var o=[Math.round(n(r,i,t)/sm)*sm,Math.round(e(r,i,t)/sm)*sm];return o.index=i,o.data=r,o}),r)}var n=wc,e=Mc,r=null;return t.polygons=function(n){return t(n).polygons()},t.links=function(n){return t(n).links()},t.triangles=function(n){return t(n).triangles()},t.x=function(e){return arguments.length?(n="function"==typeof e?e:nm(+e),t):n},t.y=function(n){return arguments.length?(e="function"==typeof n?n:nm(+n),t):e},t.extent=function(n){return arguments.length?(r=null==n?null:[[+n[0][0],+n[0][1]],[+n[1][0],+n[1][1]]],t):r&&[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},t.size=function(n){return arguments.length?(r=null==n?null:[[0,0],[+n[0],+n[1]]],t):r&&[r[1][0]-r[0][0],r[1][1]-r[0][1]]},t},t.zoom=function(){function n(t){t.property("__zoom",us).on("wheel.zoom",s).on("mousedown.zoom",f).on("dblclick.zoom",l).filter(cs).on("touchstart.zoom",p).on("touchmove.zoom",d).on("touchend.zoom touchcancel.zoom",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function e(t,n){return(n=Math.max(b,Math.min(w,n)))===t.k?t:new ns(n,t.x,t.y)}function r(t,n,e){var r=n[0]-e[0]*t.k,i=n[1]-e[1]*t.k;return r===t.x&&i===t.y?t:new ns(t.k,r,i)}function i(t,n){var e=t.invertX(n[0][0])-M,r=t.invertX(n[1][0])-T,i=t.invertY(n[0][1])-k,o=t.invertY(n[1][1])-S;return t.translate(r>e?(e+r)/2:Math.min(0,e)||Math.max(0,r),o>i?(i+o)/2:Math.min(0,i)||Math.max(0,o))}function o(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function u(t,n,e){t.on("start.zoom",function(){a(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){a(this,arguments).end()}).tween("zoom",function(){var t=this,r=arguments,i=a(t,r),u=m.apply(t,r),c=e||o(u),s=Math.max(u[1][0]-u[0][0],u[1][1]-u[0][1]),f=t.__zoom,l="function"==typeof n?n.apply(t,r):n,h=A(f.invert(c).concat(s/f.k),l.invert(c).concat(s/l.k));return function(t){if(1===t)t=l;else{var n=h(t),e=s/n[2];t=new ns(e,c[0]-n[0]*e,c[1]-n[1]*e)}i.zoom(null,t)}})}function a(t,n){for(var e,r=0,i=C.length;r<i;++r)if((e=C[r]).that===t)return e;return new c(t,n)}function c(t,n){this.that=t,this.args=n,this.index=-1,this.active=0,this.extent=m.apply(t,n)}function s(){if(g.apply(this,arguments)){var t=a(this,arguments),n=this.__zoom,o=Math.max(b,Math.min(w,n.k*Math.pow(2,x.apply(this,arguments)))),u=Ks(this);if(t.wheel)t.mouse[0][0]===u[0]&&t.mouse[0][1]===u[1]||(t.mouse[1]=n.invert(t.mouse[0]=u)),clearTimeout(t.wheel);else{if(n.k===o)return;t.mouse=[u,n.invert(u)],jl(this),t.start()}pm(),t.wheel=setTimeout(function(){t.wheel=null,t.end()},R),t.zoom("mouse",i(r(e(n,o),t.mouse[0],t.mouse[1]),t.extent))}}function f(){if(!y&&g.apply(this,arguments)){var n=a(this,arguments),e=cf(t.event.view).on("mousemove.zoom",function(){if(pm(),!n.moved){var e=t.event.clientX-u,o=t.event.clientY-c;n.moved=e*e+o*o>L}n.zoom("mouse",i(r(n.that.__zoom,n.mouse[0]=Ks(n.that),n.mouse[1]),n.extent))},!0).on("mouseup.zoom",function(){e.on("mousemove.zoom mouseup.zoom",null),_t(t.event.view,n.moved),pm(),n.end()},!0),o=Ks(this),u=t.event.clientX,c=t.event.clientY;lf(t.event.view),rs(),n.mouse=[o,this.__zoom.invert(o)],jl(this),n.start()}}function l(){if(g.apply(this,arguments)){var o=this.__zoom,a=Ks(this),c=o.invert(a),s=i(r(e(o,o.k*(t.event.shiftKey?.5:2)),a,c),m.apply(this,arguments));pm(),E>0?cf(this).transition().duration(E).call(u,s,a):cf(this).call(n.transform,s)}}function p(){if(g.apply(this,arguments)){var n,e,r,i,o=a(this,arguments),u=t.event.changedTouches,c=u.length;for(rs(),e=0;e<c;++e)r=u[e],i=[i=sf(this,u,r.identifier),this.__zoom.invert(i),r.identifier],o.touch0?o.touch1||(o.touch1=i):(o.touch0=i,n=!0);if(_&&(_=clearTimeout(_),!o.touch1))return o.end(),void((i=cf(this).on("dblclick.zoom"))&&i.apply(this,arguments));n&&(_=setTimeout(function(){_=null},P),jl(this),o.start())}}function d(){var n,o,u,c,s=a(this,arguments),f=t.event.changedTouches,l=f.length;for(pm(),_&&(_=clearTimeout(_)),n=0;n<l;++n)o=f[n],u=sf(this,f,o.identifier),s.touch0&&s.touch0[2]===o.identifier?s.touch0[0]=u:s.touch1&&s.touch1[2]===o.identifier&&(s.touch1[0]=u);if(o=s.that.__zoom,s.touch1){var h=s.touch0[0],p=s.touch0[1],d=s.touch1[0],v=s.touch1[1],y=(y=d[0]-h[0])*y+(y=d[1]-h[1])*y,g=(g=v[0]-p[0])*g+(g=v[1]-p[1])*g;o=e(o,Math.sqrt(y/g)),u=[(h[0]+d[0])/2,(h[1]+d[1])/2],c=[(p[0]+v[0])/2,(p[1]+v[1])/2]}else{if(!s.touch0)return;u=s.touch0[0],c=s.touch0[1]}s.zoom("touch",i(r(o,u,c),s.extent))}function v(){var n,e,r=a(this,arguments),i=t.event.changedTouches,o=i.length;for(rs(),y&&clearTimeout(y),y=setTimeout(function(){y=null},P),n=0;n<o;++n)e=i[n],r.touch0&&r.touch0[2]===e.identifier?delete r.touch0:r.touch1&&r.touch1[2]===e.identifier&&delete r.touch1;r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0?r.touch0[1]=this.__zoom.invert(r.touch0[0]):r.end()}var _,y,g=is,m=os,x=as,b=0,w=1/0,M=-w,T=w,k=M,S=T,E=250,A=_l,C=[],z=h("start","zoom","end"),P=500,R=150,L=0;return n.transform=function(t,n){var e=t.selection?t.selection():t;e.property("__zoom",us),t!==e?u(t,n):e.interrupt().each(function(){a(this,arguments).start().zoom(null,"function"==typeof n?n.apply(this,arguments):n).end()})},n.scaleBy=function(t,e){n.scaleTo(t,function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)})},n.scaleTo=function(t,u){n.transform(t,function(){var t=m.apply(this,arguments),n=this.__zoom,a=o(t),c=n.invert(a);return i(r(e(n,"function"==typeof u?u.apply(this,arguments):u),a,c),t)})},n.translateBy=function(t,e,r){n.transform(t,function(){return i(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof r?r.apply(this,arguments):r),m.apply(this,arguments))})},n.translateTo=function(t,e,r){n.transform(t,function(){var t=m.apply(this,arguments),n=this.__zoom,u=o(t);return i(hm.translate(u[0],u[1]).scale(n.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof r?-r.apply(this,arguments):-r),t)})},c.prototype={start:function(){return 1==++this.active&&(this.index=C.push(this)-1,this.emit("start")),this},zoom:function(t,n){return this.mouse&&"mouse"!==t&&(this.mouse[1]=n.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=n.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=n.invert(this.touch1[0])),this.that.__zoom=n,this.emit("zoom"),this},end:function(){return 0==--this.active&&(C.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(t){N(new ts(n,t,this.that.__zoom),z.apply,z,[t,this.that,this.args])}},n.wheelDelta=function(t){return arguments.length?(x="function"==typeof t?t:lm(+t),n):x},n.filter=function(t){return arguments.length?(g="function"==typeof t?t:lm(!!t),n):g},n.extent=function(t){return arguments.length?(m="function"==typeof t?t:lm([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),n):m},n.scaleExtent=function(t){return arguments.length?(b=+t[0],w=+t[1],n):[b,w]},n.translateExtent=function(t){return arguments.length?(M=+t[0][0],T=+t[1][0],k=+t[0][1],S=+t[1][1],n):[[M,k],[T,S]]},n.duration=function(t){return arguments.length?(E=+t,n):E},n.interpolate=function(t){return arguments.length?(A=t,n):A},n.on=function(){var t=z.on.apply(z,arguments);return t===z?n:t},n.clickDistance=function(t){return arguments.length?(L=(t=+t)*t,n):Math.sqrt(L)},n},t.zoomTransform=es,t.zoomIdentity=hm,Object.defineProperty(t,"__esModule",{value:!0})});

/*!
 * typeahead.js 1.1.1
 * https://github.com/twitter/typeahead.js
 * Copyright 2013-2017 Twitter, Inc. and other contributors; Licensed MIT
 */

!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(c){return a.Bloodhound=b(c)}):"object"==typeof exports?module.exports=b(require("jquery")):a.Bloodhound=b(a.jQuery)}(this,function(a){var b=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a},isArray:a.isArray,isFunction:a.isFunction,isObject:a.isPlainObject,isUndefined:function(a){return"undefined"==typeof a},isElement:function(a){return!(!a||1!==a.nodeType)},isJQuery:function(b){return b instanceof a},toStr:function(a){return b.isUndefined(a)||null===a?"":a+""},bind:a.proxy,each:function(b,c){function d(a,b){return c(b,a)}a.each(b,d)},map:a.map,filter:a.grep,every:function(b,c){var d=!0;return b?(a.each(b,function(a,e){if(!(d=c.call(null,e,a,b)))return!1}),!!d):d},some:function(b,c){var d=!1;return b?(a.each(b,function(a,e){if(d=c.call(null,e,a,b))return!1}),!!d):d},mixin:a.extend,identity:function(a){return a},clone:function(b){return a.extend(!0,{},b)},getIdGenerator:function(){var a=0;return function(){return a++}},templatify:function(b){function c(){return String(b)}return a.isFunction(b)?b:c},defer:function(a){setTimeout(a,0)},debounce:function(a,b,c){var d,e;return function(){var f,g,h=this,i=arguments;return f=function(){d=null,c||(e=a.apply(h,i))},g=c&&!d,clearTimeout(d),d=setTimeout(f,b),g&&(e=a.apply(h,i)),e}},throttle:function(a,b){var c,d,e,f,g,h;return g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)},function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,j<=0?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},stringify:function(a){return b.isString(a)?a:JSON.stringify(a)},guid:function(){function a(a){var b=(Math.random().toString(16)+"000000000").substr(2,8);return a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b}return"tt-"+a()+a(!0)+a(!0)+a()},noop:function(){}}}(),c="1.1.1",d=function(){"use strict";function a(a){return a=b.toStr(a),a?a.split(/\s+/):[]}function c(a){return a=b.toStr(a),a?a.split(/\W+/):[]}function d(a){a=b.toStr(a);var c=[],d="";return b.each(a.split(""),function(a){a.match(/\s+/)?d="":(c.push(d+a),d+=a)}),c}function e(a){return function(c){return c=b.isArray(c)?c:[].slice.call(arguments,0),function(d){var e=[];return b.each(c,function(c){e=e.concat(a(b.toStr(d[c])))}),e}}}return{nonword:c,whitespace:a,ngram:d,obj:{nonword:e(c),whitespace:e(a),ngram:e(d)}}}(),e=function(){"use strict";function c(c){this.maxSize=b.isNumber(c)?c:100,this.reset(),this.maxSize<=0&&(this.set=this.get=a.noop)}function d(){this.head=this.tail=null}function e(a,b){this.key=a,this.val=b,this.prev=this.next=null}return b.mixin(c.prototype,{set:function(a,b){var c,d=this.list.tail;this.size>=this.maxSize&&(this.list.remove(d),delete this.hash[d.key],this.size--),(c=this.hash[a])?(c.val=b,this.list.moveToFront(c)):(c=new e(a,b),this.list.add(c),this.hash[a]=c,this.size++)},get:function(a){var b=this.hash[a];if(b)return this.list.moveToFront(b),b.val},reset:function(){this.size=0,this.hash={},this.list=new d}}),b.mixin(d.prototype,{add:function(a){this.head&&(a.next=this.head,this.head.prev=a),this.head=a,this.tail=this.tail||a},remove:function(a){a.prev?a.prev.next=a.next:this.head=a.next,a.next?a.next.prev=a.prev:this.tail=a.prev},moveToFront:function(a){this.remove(a),this.add(a)}}),c}(),f=function(){"use strict";function c(a,c){this.prefix=["__",a,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+b.escapeRegExChars(this.prefix)),this.ls=c||h,!this.ls&&this._noop()}function d(){return(new Date).getTime()}function e(a){return JSON.stringify(b.isUndefined(a)?null:a)}function f(b){return a.parseJSON(b)}function g(a){var b,c,d=[],e=h.length;for(b=0;b<e;b++)(c=h.key(b)).match(a)&&d.push(c.replace(a,""));return d}var h;try{h=window.localStorage,h.setItem("~~~","!"),h.removeItem("~~~")}catch(a){h=null}return b.mixin(c.prototype,{_prefix:function(a){return this.prefix+a},_ttlKey:function(a){return this._prefix(a)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=b.noop},_safeSet:function(a,b){try{this.ls.setItem(a,b)}catch(a){"QuotaExceededError"===a.name&&(this.clear(),this._noop())}},get:function(a){return this.isExpired(a)&&this.remove(a),f(this.ls.getItem(this._prefix(a)))},set:function(a,c,f){return b.isNumber(f)?this._safeSet(this._ttlKey(a),e(d()+f)):this.ls.removeItem(this._ttlKey(a)),this._safeSet(this._prefix(a),e(c))},remove:function(a){return this.ls.removeItem(this._ttlKey(a)),this.ls.removeItem(this._prefix(a)),this},clear:function(){var a,b=g(this.keyMatcher);for(a=b.length;a--;)this.remove(b[a]);return this},isExpired:function(a){var c=f(this.ls.getItem(this._ttlKey(a)));return!!(b.isNumber(c)&&d()>c)}}),c}(),g=function(){"use strict";function c(a){a=a||{},this.maxPendingRequests=a.maxPendingRequests||6,this.cancelled=!1,this.lastReq=null,this._send=a.transport,this._get=a.limiter?a.limiter(this._get):this._get,this._cache=a.cache===!1?new e(0):g}var d=0,f={},g=new e(10);return c.setMaxPendingRequests=function(a){this.maxPendingRequests=a},c.resetCache=function(){g.reset()},b.mixin(c.prototype,{_fingerprint:function(b){return b=b||{},b.url+b.type+a.param(b.data||{})},_get:function(a,b){function c(a){b(null,a),j._cache.set(h,a)}function e(){b(!0)}function g(){d--,delete f[h],j.onDeckRequestArgs&&(j._get.apply(j,j.onDeckRequestArgs),j.onDeckRequestArgs=null)}var h,i,j=this;h=this._fingerprint(a),this.cancelled||h!==this.lastReq||((i=f[h])?i.done(c).fail(e):d<this.maxPendingRequests?(d++,f[h]=this._send(a).done(c).fail(e).always(g)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(c,d){var e,f;d=d||a.noop,c=b.isString(c)?{url:c}:c||{},f=this._fingerprint(c),this.cancelled=!1,this.lastReq=f,(e=this._cache.get(f))?d(null,e):this._get(c,d)},cancel:function(){this.cancelled=!0}}),c}(),h=window.SearchIndex=function(){"use strict";function c(c){c=c||{},c.datumTokenizer&&c.queryTokenizer||a.error("datumTokenizer and queryTokenizer are both required"),this.identify=c.identify||b.stringify,this.datumTokenizer=c.datumTokenizer,this.queryTokenizer=c.queryTokenizer,this.matchAnyQueryToken=c.matchAnyQueryToken,this.reset()}function d(a){return a=b.filter(a,function(a){return!!a}),a=b.map(a,function(a){return a.toLowerCase()})}function e(){var a={};return a[i]=[],a[h]={},a}function f(a){for(var b={},c=[],d=0,e=a.length;d<e;d++)b[a[d]]||(b[a[d]]=!0,c.push(a[d]));return c}function g(a,b){var c=0,d=0,e=[];a=a.sort(),b=b.sort();for(var f=a.length,g=b.length;c<f&&d<g;)a[c]<b[d]?c++:a[c]>b[d]?d++:(e.push(a[c]),c++,d++);return e}var h="c",i="i";return b.mixin(c.prototype,{bootstrap:function(a){this.datums=a.datums,this.trie=a.trie},add:function(a){var c=this;a=b.isArray(a)?a:[a],b.each(a,function(a){var f,g;c.datums[f=c.identify(a)]=a,g=d(c.datumTokenizer(a)),b.each(g,function(a){var b,d,g;for(b=c.trie,d=a.split("");g=d.shift();)b=b[h][g]||(b[h][g]=e()),b[i].push(f)})})},get:function(a){var c=this;return b.map(a,function(a){return c.datums[a]})},search:function(a){var c,e,j=this;return c=d(this.queryTokenizer(a)),b.each(c,function(a){var b,c,d,f;if(e&&0===e.length&&!j.matchAnyQueryToken)return!1;for(b=j.trie,c=a.split("");b&&(d=c.shift());)b=b[h][d];if(b&&0===c.length)f=b[i].slice(0),e=e?g(e,f):f;else if(!j.matchAnyQueryToken)return e=[],!1}),e?b.map(f(e),function(a){return j.datums[a]}):[]},all:function(){var a=[];for(var b in this.datums)a.push(this.datums[b]);return a},reset:function(){this.datums={},this.trie=e()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),c}(),i=function(){"use strict";function a(a){this.url=a.url,this.ttl=a.ttl,this.cache=a.cache,this.prepare=a.prepare,this.transform=a.transform,this.transport=a.transport,this.thumbprint=a.thumbprint,this.storage=new f(a.cacheKey)}var c;return c={data:"data",protocol:"protocol",thumbprint:"thumbprint"},b.mixin(a.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(a){this.cache&&(this.storage.set(c.data,a,this.ttl),this.storage.set(c.protocol,location.protocol,this.ttl),this.storage.set(c.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var a,b={};return this.cache?(b.data=this.storage.get(c.data),b.protocol=this.storage.get(c.protocol),b.thumbprint=this.storage.get(c.thumbprint),a=b.thumbprint!==this.thumbprint||b.protocol!==location.protocol,b.data&&!a?b.data:null):null},fromNetwork:function(a){function b(){a(!0)}function c(b){a(null,e.transform(b))}var d,e=this;a&&(d=this.prepare(this._settings()),this.transport(d).fail(b).done(c))},clear:function(){return this.storage.clear(),this}}),a}(),j=function(){"use strict";function a(a){this.url=a.url,this.prepare=a.prepare,this.transform=a.transform,this.indexResponse=a.indexResponse,this.transport=new g({cache:a.cache,limiter:a.limiter,transport:a.transport,maxPendingRequests:a.maxPendingRequests})}return b.mixin(a.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(a,b){function c(a,c){b(a?[]:e.transform(c))}var d,e=this;if(b)return a=a||"",d=this.prepare(a,this._settings()),this.transport.get(d,c)},cancelLastRequest:function(){this.transport.cancel()}}),a}(),k=function(){"use strict";function d(d){var e;return d?(e={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:b.identity,transform:b.identity,transport:null},d=b.isString(d)?{url:d}:d,d=b.mixin(e,d),!d.url&&a.error("prefetch requires url to be set"),d.transform=d.filter||d.transform,d.cacheKey=d.cacheKey||d.url,d.thumbprint=c+d.thumbprint,d.transport=d.transport?h(d.transport):a.ajax,d):null}function e(c){var d;if(c)return d={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:b.identity,transport:null},c=b.isString(c)?{url:c}:c,c=b.mixin(d,c),!c.url&&a.error("remote requires url to be set"),c.transform=c.filter||c.transform,c.prepare=f(c),c.limiter=g(c),c.transport=c.transport?h(c.transport):a.ajax,delete c.replace,delete c.wildcard,delete c.rateLimitBy,delete c.rateLimitWait,c}function f(a){function b(a,b){return b.url=f(b.url,a),b}function c(a,b){return b.url=b.url.replace(g,encodeURIComponent(a)),b}function d(a,b){return b}var e,f,g;return e=a.prepare,f=a.replace,g=a.wildcard,e?e:e=f?b:a.wildcard?c:d}function g(a){function c(a){return function(c){return b.debounce(c,a)}}function d(a){return function(c){return b.throttle(c,a)}}var e,f,g;return e=a.limiter,f=a.rateLimitBy,g=a.rateLimitWait,e||(e=/^throttle$/i.test(f)?d(g):c(g)),e}function h(c){return function(d){function e(a){b.defer(function(){g.resolve(a)})}function f(a){b.defer(function(){g.reject(a)})}var g=a.Deferred();return c(d,e,f),g}}return function(c){var f,g;return f={initialize:!0,identify:b.stringify,datumTokenizer:null,queryTokenizer:null,matchAnyQueryToken:!1,sufficient:5,indexRemote:!1,sorter:null,local:[],prefetch:null,remote:null},c=b.mixin(f,c||{}),!c.datumTokenizer&&a.error("datumTokenizer is required"),!c.queryTokenizer&&a.error("queryTokenizer is required"),g=c.sorter,c.sorter=g?function(a){return a.sort(g)}:b.identity,c.local=b.isFunction(c.local)?c.local():c.local,c.prefetch=d(c.prefetch),c.remote=e(c.remote),c}}(),l=function(){"use strict";function c(a){a=k(a),this.sorter=a.sorter,this.identify=a.identify,this.sufficient=a.sufficient,this.indexRemote=a.indexRemote,this.local=a.local,this.remote=a.remote?new j(a.remote):null,this.prefetch=a.prefetch?new i(a.prefetch):null,this.index=new h({identify:this.identify,datumTokenizer:a.datumTokenizer,queryTokenizer:a.queryTokenizer}),a.initialize!==!1&&this.initialize()}var e;return e=window&&window.Bloodhound,c.noConflict=function(){return window&&(window.Bloodhound=e),c},c.tokenizers=d,b.mixin(c.prototype,{__ttAdapter:function(){function a(a,b,d){return c.search(a,b,d)}function b(a,b){return c.search(a,b)}var c=this;return this.remote?a:b},_loadPrefetch:function(){function b(a,b){return a?c.reject():(e.add(b),e.prefetch.store(e.index.serialize()),void c.resolve())}var c,d,e=this;return c=a.Deferred(),this.prefetch?(d=this.prefetch.fromCache())?(this.index.bootstrap(d),c.resolve()):this.prefetch.fromNetwork(b):c.resolve(),c.promise()},_initialize:function(){function a(){b.add(b.local)}var b=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(a),this.initPromise},initialize:function(a){return!this.initPromise||a?this._initialize():this.initPromise},add:function(a){return this.index.add(a),this},get:function(a){return a=b.isArray(a)?a:[].slice.call(arguments),this.index.get(a)},search:function(a,c,d){function e(a){var c=[];b.each(a,function(a){!b.some(f,function(b){return g.identify(a)===g.identify(b)})&&c.push(a)}),g.indexRemote&&g.add(c),d(c)}var f,g=this;return c=c||b.noop,d=d||b.noop,f=this.sorter(this.index.search(a)),c(this.remote?f.slice():f),this.remote&&f.length<this.sufficient?this.remote.get(a,e):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return g.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),c}();return l}),function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(a){return b(a)}):"object"==typeof exports?module.exports=b(require("jquery")):b(a.jQuery)}(this,function(a){var b=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a},isArray:a.isArray,isFunction:a.isFunction,isObject:a.isPlainObject,isUndefined:function(a){return"undefined"==typeof a},isElement:function(a){return!(!a||1!==a.nodeType)},isJQuery:function(b){return b instanceof a},toStr:function(a){return b.isUndefined(a)||null===a?"":a+""},bind:a.proxy,each:function(b,c){function d(a,b){return c(b,a)}a.each(b,d)},map:a.map,filter:a.grep,every:function(b,c){var d=!0;return b?(a.each(b,function(a,e){if(!(d=c.call(null,e,a,b)))return!1}),!!d):d},some:function(b,c){var d=!1;return b?(a.each(b,function(a,e){if(d=c.call(null,e,a,b))return!1}),!!d):d},mixin:a.extend,identity:function(a){return a},clone:function(b){return a.extend(!0,{},b)},getIdGenerator:function(){var a=0;return function(){return a++}},templatify:function(b){function c(){return String(b)}return a.isFunction(b)?b:c},defer:function(a){setTimeout(a,0)},debounce:function(a,b,c){var d,e;return function(){var f,g,h=this,i=arguments;return f=function(){d=null,c||(e=a.apply(h,i))},g=c&&!d,clearTimeout(d),d=setTimeout(f,b),g&&(e=a.apply(h,i)),e}},throttle:function(a,b){var c,d,e,f,g,h;return g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)},function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,j<=0?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},stringify:function(a){return b.isString(a)?a:JSON.stringify(a)},guid:function(){function a(a){var b=(Math.random().toString(16)+"000000000").substr(2,8);return a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b}return"tt-"+a()+a(!0)+a(!0)+a()},noop:function(){}}}(),c=function(){"use strict";function a(a){var g,h;return h=b.mixin({},f,a),g={css:e(),classes:h,html:c(h),selectors:d(h)},{css:g.css,html:g.html,classes:g.classes,selectors:g.selectors,mixin:function(a){b.mixin(a,g)}}}function c(a){return{wrapper:'<span class="'+a.wrapper+'"></span>',menu:'<div role="listbox" class="'+a.menu+'"></div>'}}function d(a){var c={};return b.each(a,function(a,b){c[b]="."+a}),c}function e(){var a={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return b.isMsie()&&b.mixin(a.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),a}var f={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return a}(),d=function(){"use strict";function c(b){b&&b.el||a.error("EventBus initialized without el"),this.$el=a(b.el)}var d,e;return d="typeahead:",e={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},b.mixin(c.prototype,{_trigger:function(b,c){var e=a.Event(d+b);return this.$el.trigger.call(this.$el,e,c||[]),e},before:function(a){var b,c;return b=[].slice.call(arguments,1),c=this._trigger("before"+a,b),c.isDefaultPrevented()},trigger:function(a){var b;this._trigger(a,[].slice.call(arguments,1)),(b=e[a])&&this._trigger(b,[].slice.call(arguments,1))}}),c}(),e=function(){"use strict";function a(a,b,c,d){var e;if(!c)return this;for(b=b.split(i),c=d?h(c,d):c,this._callbacks=this._callbacks||{};e=b.shift();)this._callbacks[e]=this._callbacks[e]||{sync:[],async:[]},this._callbacks[e][a].push(c);return this}function b(b,c,d){return a.call(this,"async",b,c,d)}function c(b,c,d){return a.call(this,"sync",b,c,d)}function d(a){var b;if(!this._callbacks)return this;for(a=a.split(i);b=a.shift();)delete this._callbacks[b];return this}function e(a){var b,c,d,e,g;if(!this._callbacks)return this;for(a=a.split(i),d=[].slice.call(arguments,1);(b=a.shift())&&(c=this._callbacks[b]);)e=f(c.sync,this,[b].concat(d)),g=f(c.async,this,[b].concat(d)),e()&&j(g);return this}function f(a,b,c){function d(){for(var d,e=0,f=a.length;!d&&e<f;e+=1)d=a[e].apply(b,c)===!1;return!d}return d}function g(){var a;return a=window.setImmediate?function(a){setImmediate(function(){a()})}:function(a){setTimeout(function(){a()},0)}}function h(a,b){return a.bind?a.bind(b):function(){a.apply(b,[].slice.call(arguments,0))}}var i=/\s+/,j=g();return{onSync:c,onAsync:b,off:d,trigger:e}}(),f=function(a){"use strict";function c(a){return f[a.toUpperCase()]||a}function d(a,d,e,f){for(var g,h=[],i=0,j=a.length;i<j;i++){var k=b.escapeRegExChars(a[i]);f&&(k=k.replace(/\S/g,c)),h.push(k)}return g=e?"\\b("+h.join("|")+")\\b":"("+h.join("|")+")",d?new RegExp(g):new RegExp(g,"i")}var e={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1,diacriticInsensitive:!1},f={A:"[AaªÀ-Åà-åĀ-ąǍǎȀ-ȃȦȧᴬᵃḀḁẚẠ-ảₐ℀℁℻⒜Ⓐⓐ㍱-㍴㎀-㎄㎈㎉㎩-㎯㏂㏊㏟㏿Ａａ]",B:"[BbᴮᵇḂ-ḇℬ⒝Ⓑⓑ㍴㎅-㎇㏃㏈㏔㏝Ｂｂ]",C:"[CcÇçĆ-čᶜ℀ℂ℃℅℆ℭⅭⅽ⒞Ⓒⓒ㍶㎈㎉㎝㎠㎤㏄-㏇Ｃｃ]",D:"[DdĎďǄ-ǆǱ-ǳᴰᵈḊ-ḓⅅⅆⅮⅾ⒟Ⓓⓓ㋏㍲㍷-㍹㎗㎭-㎯㏅㏈Ｄｄ]",E:"[EeÈ-Ëè-ëĒ-ěȄ-ȇȨȩᴱᵉḘ-ḛẸ-ẽₑ℡ℯℰⅇ⒠Ⓔⓔ㉐㋍㋎Ｅｅ]",F:"[FfᶠḞḟ℉ℱ℻⒡Ⓕⓕ㎊-㎌㎙ﬀ-ﬄＦｆ]",G:"[GgĜ-ģǦǧǴǵᴳᵍḠḡℊ⒢Ⓖⓖ㋌㋍㎇㎍-㎏㎓㎬㏆㏉㏒㏿Ｇｇ]",H:"[HhĤĥȞȟʰᴴḢ-ḫẖℋ-ℎ⒣Ⓗⓗ㋌㍱㎐-㎔㏊㏋㏗Ｈｈ]",I:"[IiÌ-Ïì-ïĨ-İĲĳǏǐȈ-ȋᴵᵢḬḭỈ-ịⁱℐℑℹⅈⅠ-ⅣⅥ-ⅨⅪⅫⅰ-ⅳⅵ-ⅸⅺⅻ⒤Ⓘⓘ㍺㏌㏕ﬁﬃＩｉ]",J:"[JjĲ-ĵǇ-ǌǰʲᴶⅉ⒥ⒿⓙⱼＪｊ]",K:"[KkĶķǨǩᴷᵏḰ-ḵK⒦Ⓚⓚ㎄㎅㎉㎏㎑㎘㎞㎢㎦㎪㎸㎾㏀㏆㏍-㏏Ｋｋ]",L:"[LlĹ-ŀǇ-ǉˡᴸḶḷḺ-ḽℒℓ℡Ⅼⅼ⒧Ⓛⓛ㋏㎈㎉㏐-㏓㏕㏖㏿ﬂﬄＬｌ]",M:"[MmᴹᵐḾ-ṃ℠™ℳⅯⅿ⒨Ⓜⓜ㍷-㍹㎃㎆㎎㎒㎖㎙-㎨㎫㎳㎷㎹㎽㎿㏁㏂㏎㏐㏔-㏖㏘㏙㏞㏟Ｍｍ]",N:"[NnÑñŃ-ŉǊ-ǌǸǹᴺṄ-ṋⁿℕ№⒩Ⓝⓝ㎁㎋㎚㎱㎵㎻㏌㏑Ｎｎ]",O:"[OoºÒ-Öò-öŌ-őƠơǑǒǪǫȌ-ȏȮȯᴼᵒỌ-ỏₒ℅№ℴ⒪Ⓞⓞ㍵㏇㏒㏖Ｏｏ]",P:"[PpᴾᵖṔ-ṗℙ⒫Ⓟⓟ㉐㍱㍶㎀㎊㎩-㎬㎰㎴㎺㏋㏗-㏚Ｐｐ]",Q:"[Qqℚ⒬Ⓠⓠ㏃Ｑｑ]",R:"[RrŔ-řȐ-ȓʳᴿᵣṘ-ṛṞṟ₨ℛ-ℝ⒭Ⓡⓡ㋍㍴㎭-㎯㏚㏛Ｒｒ]",S:"[SsŚ-šſȘșˢṠ-ṣ₨℁℠⒮Ⓢⓢ㎧㎨㎮-㎳㏛㏜ﬆＳｓ]",T:"[TtŢ-ťȚțᵀᵗṪ-ṱẗ℡™⒯Ⓣⓣ㉐㋏㎔㏏ﬅﬆＴｔ]",U:"[UuÙ-Üù-üŨ-ųƯưǓǔȔ-ȗᵁᵘᵤṲ-ṷỤ-ủ℆⒰Ⓤⓤ㍳㍺Ｕｕ]",V:"[VvᵛᵥṼ-ṿⅣ-Ⅷⅳ-ⅷ⒱Ⓥⓥⱽ㋎㍵㎴-㎹㏜㏞Ｖｖ]",W:"[WwŴŵʷᵂẀ-ẉẘ⒲Ⓦⓦ㎺-㎿㏝Ｗｗ]",X:"[XxˣẊ-ẍₓ℻Ⅸ-Ⅻⅸ-ⅻ⒳Ⓧⓧ㏓Ｘｘ]",Y:"[YyÝýÿŶ-ŸȲȳʸẎẏẙỲ-ỹ⒴Ⓨⓨ㏉Ｙｙ]",Z:"[ZzŹ-žǱ-ǳᶻẐ-ẕℤℨ⒵Ⓩⓩ㎐-㎔Ｚｚ]"};return function(c){function f(b){var d,e,f;return(d=h.exec(b.data))&&(f=a.createElement(c.tagName),c.className&&(f.className=c.className),e=b.splitText(d.index),e.splitText(d[0].length),f.appendChild(e.cloneNode(!0)),b.parentNode.replaceChild(f,e)),!!d}function g(a,b){for(var c,d=3,e=0;e<a.childNodes.length;e++)c=a.childNodes[e],c.nodeType===d?e+=b(c)?1:0:g(c,b)}var h;c=b.mixin({},e,c),c.node&&c.pattern&&(c.pattern=b.isArray(c.pattern)?c.pattern:[c.pattern],h=d(c.pattern,c.caseSensitive,c.wordsOnly,c.diacriticInsensitive),g(c.node,f))}}(window.document),g=function(){"use strict";function c(c,e){c=c||{},c.input||a.error("input is missing"),e.mixin(this),this.$hint=a(c.hint),this.$input=a(c.input),this.$input.attr({"aria-activedescendant":"","aria-owns":this.$input.attr("id")+"_listbox",role:"combobox","aria-readonly":"true","aria-autocomplete":"list"}),a(e.menu).attr("id",this.$input.attr("id")+"_listbox"),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=d(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=b.noop),this.onSync("cursorchange",this._updateDescendent)}function d(b){return a('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:b.css("font-family"),fontSize:b.css("font-size"),fontStyle:b.css("font-style"),fontVariant:b.css("font-variant"),fontWeight:b.css("font-weight"),wordSpacing:b.css("word-spacing"),letterSpacing:b.css("letter-spacing"),textIndent:b.css("text-indent"),textRendering:b.css("text-rendering"),textTransform:b.css("text-transform")}).insertAfter(b)}function f(a,b){return c.normalizeQuery(a)===c.normalizeQuery(b)}function g(a){return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey}var h;return h={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},c.normalizeQuery=function(a){return b.toStr(a).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},b.mixin(c.prototype,e,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(a){var b=h[a.which||a.keyCode];this._managePreventDefault(b,a),b&&this._shouldTrigger(b,a)&&this.trigger(b+"Keyed",a)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(a,b){var c;switch(a){case"up":case"down":c=!g(b);break;default:c=!1}c&&b.preventDefault()},_shouldTrigger:function(a,b){var c;switch(a){case"tab":c=!g(b);break;default:c=!0}return c},_checkLanguageDirection:function(){var a=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==a&&(this.dir=a,this.$hint.attr("dir",a),this.trigger("langDirChanged",a))},_setQuery:function(a,b){var c,d;c=f(a,this.query),d=!!c&&this.query.length!==a.length,this.query=a,b||c?!b&&d&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},_updateDescendent:function(a,b){this.$input.attr("aria-activedescendant",b)},bind:function(){var a,c,d,e,f=this;return a=b.bind(this._onBlur,this),c=b.bind(this._onFocus,this),d=b.bind(this._onKeydown,this),e=b.bind(this._onInput,this),this.$input.on("blur.tt",a).on("focus.tt",c).on("keydown.tt",d),!b.isMsie()||b.isMsie()>9?this.$input.on("input.tt",e):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(a){h[a.which||a.keyCode]||b.defer(b.bind(f._onInput,f,a))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(a,b){this.setInputValue(a),this._setQuery(a,b)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(a){this.$input.val(a),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(a){this.$hint.val(a)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var a,b,c,d;a=this.getInputValue(),b=this.getHint(),c=a!==b&&0===b.indexOf(a),d=""!==a&&c&&!this.hasOverflow(),!d&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var a=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=a},isCursorAtEnd:function(){var a,c,d;return a=this.$input.val().length,c=this.$input[0].selectionStart,b.isNumber(c)?c===a:!document.selection||(d=document.selection.createRange(),d.moveStart("character",-a),a===d.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=a("<div>")}}),c}(),h=function(){"use strict";function c(c,e){c=c||{},c.templates=c.templates||{},c.templates.notFound=c.templates.notFound||c.templates.empty,c.source||a.error("missing source"),c.node||a.error("missing node"),c.name&&!h(c.name)&&a.error("invalid dataset name: "+c.name),e.mixin(this),this.highlight=!!c.highlight,this.name=b.toStr(c.name||j()),this.limit=c.limit||5,this.displayFn=d(c.display||c.displayKey),this.templates=g(c.templates,this.displayFn),this.source=c.source.__ttAdapter?c.source.__ttAdapter():c.source,this.async=b.isUndefined(c.async)?this.source.length>2:!!c.async,this._resetLastSuggestion(),this.$el=a(c.node).attr("role","presentation").addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function d(a){function c(b){return b[a]}return a=a||b.stringify,b.isFunction(a)?a:c}function g(c,d){function e(c){return a('<div role="option">').attr("id",b.guid()).text(d(c))}return{notFound:c.notFound&&b.templatify(c.notFound),pending:c.pending&&b.templatify(c.pending),header:c.header&&b.templatify(c.header),footer:c.footer&&b.templatify(c.footer),suggestion:c.suggestion||e}}function h(a){return/^[_a-zA-Z0-9-]+$/.test(a)}var i,j;return i={dataset:"tt-selectable-dataset",val:"tt-selectable-display",obj:"tt-selectable-object"},j=b.getIdGenerator(),c.extractData=function(b){var c=a(b);return c.data(i.obj)?{dataset:c.data(i.dataset)||"",val:c.data(i.val)||"",obj:c.data(i.obj)||null}:null},b.mixin(c.prototype,e,{_overwrite:function(a,b){b=b||[],b.length?this._renderSuggestions(a,b):this.async&&this.templates.pending?this._renderPending(a):!this.async&&this.templates.notFound?this._renderNotFound(a):this._empty(),this.trigger("rendered",b,!1,this.name)},_append:function(a,b){b=b||[],b.length&&this.$lastSuggestion.length?this._appendSuggestions(a,b):b.length?this._renderSuggestions(a,b):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(a),this.trigger("rendered",b,!0,this.name)},_renderSuggestions:function(a,b){var c;c=this._getSuggestionsFragment(a,b),this.$lastSuggestion=c.children().last(),this.$el.html(c).prepend(this._getHeader(a,b)).append(this._getFooter(a,b))},_appendSuggestions:function(a,b){var c,d;c=this._getSuggestionsFragment(a,b),d=c.children().last(),this.$lastSuggestion.after(c),this.$lastSuggestion=d},_renderPending:function(a){var b=this.templates.pending;this._resetLastSuggestion(),b&&this.$el.html(b({query:a,dataset:this.name}))},_renderNotFound:function(a){var b=this.templates.notFound;this._resetLastSuggestion(),b&&this.$el.html(b({query:a,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(c,d){var e,g=this;return e=document.createDocumentFragment(),b.each(d,function(b){var d,f;f=g._injectQuery(c,b),d=a(g.templates.suggestion(f)).data(i.dataset,g.name).data(i.obj,b).data(i.val,g.displayFn(b)).addClass(g.classes.suggestion+" "+g.classes.selectable),e.appendChild(d[0])}),this.highlight&&f({className:this.classes.highlight,node:e,pattern:c}),a(e)},_getFooter:function(a,b){return this.templates.footer?this.templates.footer({query:a,suggestions:b,dataset:this.name}):null},_getHeader:function(a,b){return this.templates.header?this.templates.header({query:a,suggestions:b,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=a()},_injectQuery:function(a,c){return b.isObject(c)?b.mixin({_query:a},c):c},update:function(b){function c(a){g||(g=!0,a=(a||[]).slice(0,e.limit),h=a.length,e._overwrite(b,a),h<e.limit&&e.async&&e.trigger("asyncRequested",b,e.name))}function d(c){if(c=c||[],!f&&h<e.limit){e.cancel=a.noop;var d=Math.abs(h-e.limit);h+=d,e._append(b,c.slice(0,d)),e.async&&e.trigger("asyncReceived",b,e.name)}}var e=this,f=!1,g=!1,h=0;this.cancel(),this.cancel=function(){f=!0,e.cancel=a.noop,e.async&&e.trigger("asyncCanceled",b,e.name)},this.source(b,c,d),!g&&c([])},cancel:a.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=a("<div>")}}),c}(),i=function(){"use strict";function c(c,d){function e(b){var c=f.$node.find(b.node).first();return b.node=c.length?c:a("<div>").appendTo(f.$node),new h(b,d)}var f=this;c=c||{},c.node||a.error("node is required"),d.mixin(this),this.$node=a(c.node),this.query=null,this.datasets=b.map(c.datasets,e)}return b.mixin(c.prototype,e,{_onSelectableClick:function(b){this.trigger("selectableClicked",a(b.currentTarget))},_onRendered:function(a,b,c,d){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",b,c,d)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){return b.every(this.datasets,b.bind(function(a){var b=a.isEmpty();return this.$node.attr("aria-expanded",!b),b},this))},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var a=this.getActiveSelectable();a&&a.removeClass(this.classes.cursor)},_ensureVisible:function(a){var b,c,d,e;b=a.position().top,c=b+a.outerHeight(!0),d=this.$node.scrollTop(),e=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),b<0?this.$node.scrollTop(d+b):e<c&&this.$node.scrollTop(d+(c-e))},bind:function(){var c,d=this;return c=b.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,c),this.$node.on("mouseover",this.selectors.selectable,function(){d.setCursor(a(this))}),this.$node.on("mouseleave",function(){d._removeCursor()}),b.each(this.datasets,function(a){a.onSync("asyncRequested",d._propagate,d).onSync("asyncCanceled",d._propagate,d).onSync("asyncReceived",d._propagate,d).onSync("rendered",d._onRendered,d).onSync("cleared",d._onCleared,d)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.scrollTop(0),this.$node.addClass(this.classes.open)},close:function(){this.$node.attr("aria-expanded",!1),this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(a){this.$node.attr("dir",a)},selectableRelativeToCursor:function(a){var b,c,d,e;return c=this.getActiveSelectable(),b=this._getSelectables(),d=c?b.index(c):-1,e=d+a,e=(e+1)%(b.length+1)-1,e=e<-1?b.length-1:e,e===-1?null:b.eq(e)},setCursor:function(a){this._removeCursor(),(a=a&&a.first())&&(a.addClass(this.classes.cursor),this._ensureVisible(a))},getSelectableData:function(a){return a&&a.length?h.extractData(a):null},getActiveSelectable:function(){var a=this._getSelectables().filter(this.selectors.cursor).first();return a.length?a:null},getTopSelectable:function(){var a=this._getSelectables().first();return a.length?a:null},update:function(a){function c(b){b.update(a)}var d=a!==this.query;return d&&(this.query=a,b.each(this.datasets,c)),d},empty:function(){function a(a){a.clear()}b.each(this.datasets,a),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){function c(a){a.destroy()}this.$node.off(".tt"),this.$node=a("<div>"),b.each(this.datasets,c)}}),c}(),j=function(){
"use strict";function c(c){this.$el=a("<span></span>",{role:"status","aria-live":"polite"}).css({position:"absolute",padding:"0",border:"0",height:"1px",width:"1px","margin-bottom":"-1px","margin-right":"-1px",overflow:"hidden",clip:"rect(0 0 0 0)","white-space":"nowrap"}),c.$input.after(this.$el),b.each(c.menu.datasets,b.bind(function(a){a.onSync&&(a.onSync("rendered",b.bind(this.update,this)),a.onSync("cleared",b.bind(this.cleared,this)))},this))}return b.mixin(c.prototype,{update:function(a,b){var c,d=b.length;c=1===d?{result:"result",is:"is"}:{result:"results",is:"are"},this.$el.text(d+" "+c.result+" "+c.is+" available, use up and down arrow keys to navigate.")},cleared:function(){this.$el.text("")}}),c}(),k=function(){"use strict";function a(){i.apply(this,[].slice.call(arguments,0))}var c=i.prototype;return b.mixin(a.prototype,i.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),c.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),c.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),c._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),c._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(a){return this.$node.css("ltr"===a?this.css.ltr:this.css.rtl),c.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),a}(),l=function(){"use strict";function c(c,e){var f,g,h,i,j,k,l,m,n,o,p;c=c||{},c.input||a.error("missing input"),c.menu||a.error("missing menu"),c.eventBus||a.error("missing event bus"),e.mixin(this),this.eventBus=c.eventBus,this.minLength=b.isNumber(c.minLength)?c.minLength:1,this.input=c.input,this.menu=c.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),f=d(this,"activate","open","_onFocused"),g=d(this,"deactivate","_onBlurred"),h=d(this,"isActive","isOpen","_onEnterKeyed"),i=d(this,"isActive","isOpen","_onTabKeyed"),j=d(this,"isActive","_onEscKeyed"),k=d(this,"isActive","open","_onUpKeyed"),l=d(this,"isActive","open","_onDownKeyed"),m=d(this,"isActive","isOpen","_onLeftKeyed"),n=d(this,"isActive","isOpen","_onRightKeyed"),o=d(this,"_openIfActive","_onQueryChanged"),p=d(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",f,this).onSync("blurred",g,this).onSync("enterKeyed",h,this).onSync("tabKeyed",i,this).onSync("escKeyed",j,this).onSync("upKeyed",k,this).onSync("downKeyed",l,this).onSync("leftKeyed",m,this).onSync("rightKeyed",n,this).onSync("queryChanged",o,this).onSync("whitespaceChanged",p,this).onSync("langDirChanged",this._onLangDirChanged,this)}function d(a){var c=[].slice.call(arguments,1);return function(){var d=[].slice.call(arguments);b.each(c,function(b){return a[b].apply(a,d)})}}return b.mixin(c.prototype,{_hacks:function(){var c,d;c=this.input.$input||a("<div>"),d=this.menu.$node||a("<div>"),c.on("blur.tt",function(a){var e,f,g;e=document.activeElement,f=d.is(e),g=d.has(e).length>0,b.isMsie()&&(f||g)&&(a.preventDefault(),a.stopImmediatePropagation(),b.defer(function(){c.focus()}))}),d.on("mousedown.tt",function(a){a.preventDefault()})},_onSelectableClicked:function(a,b){this.select(b)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(a,b,c,d){this._updateHint(),this.eventBus.trigger("render",b,c,d)},_onAsyncRequested:function(a,b,c){this.eventBus.trigger("asyncrequest",c,b)},_onAsyncCanceled:function(a,b,c){this.eventBus.trigger("asynccancel",c,b)},_onAsyncReceived:function(a,b,c){this.eventBus.trigger("asyncreceive",c,b)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(a,b){var c;(c=this.menu.getActiveSelectable())&&this.select(c)&&(b.preventDefault(),b.stopPropagation())},_onTabKeyed:function(a,b){var c;(c=this.menu.getActiveSelectable())?this.select(c)&&b.preventDefault():(c=this.menu.getTopSelectable())&&this.autocomplete(c)&&b.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getActiveSelectable()||this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getActiveSelectable()||this.menu.getTopSelectable())},_onQueryChanged:function(a,b){this._minLengthMet(b)?this.menu.update(b):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(a,b){this.dir!==b&&(this.dir=b,this.menu.setLanguageDirection(b))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(a){return a=b.isString(a)?a:this.input.getQuery()||"",a.length>=this.minLength},_updateHint:function(){var a,c,d,e,f,h,i;a=this.menu.getTopSelectable(),c=this.menu.getSelectableData(a),d=this.input.getInputValue(),!c||b.isBlankString(d)||this.input.hasOverflow()?this.input.clearHint():(e=g.normalizeQuery(d),f=b.escapeRegExChars(e),h=new RegExp("^(?:"+f+")(.+$)","i"),i=h.exec(c.val),i&&this.input.setHint(d+i[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return!!this.isActive()||!(!this.isEnabled()||this.eventBus.before("active"))&&(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return!this.isActive()||!this.eventBus.before("idle")&&(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0)},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(a){this.input.setQuery(b.toStr(a))},getVal:function(){return this.input.getQuery()},select:function(a){var b=this.menu.getSelectableData(a);return!(!b||this.eventBus.before("select",b.obj,b.dataset))&&(this.input.setQuery(b.val,!0),this.eventBus.trigger("select",b.obj,b.dataset),this.close(),!0)},autocomplete:function(a){var b,c,d;return b=this.input.getQuery(),c=this.menu.getSelectableData(a),d=c&&b!==c.val,!(!d||this.eventBus.before("autocomplete",c.obj,c.dataset))&&(this.input.setQuery(c.val),this.eventBus.trigger("autocomplete",c.obj,c.dataset),!0)},moveCursor:function(a){var b,c,d,e,f,g,h;return b=this.input.getQuery(),c=this.menu.selectableRelativeToCursor(a),d=this.menu.getSelectableData(c),e=d?d.obj:null,f=d?d.dataset:null,h=c?c.attr("id"):null,this.input.trigger("cursorchange",h),g=this._minLengthMet()&&this.menu.update(b),!g&&!this.eventBus.before("cursorchange",e,f)&&(this.menu.setCursor(c),d?this.input.setInputValue(d.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",e,f),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),c}();!function(){"use strict";function e(b,c){b.each(function(){var b,d=a(this);(b=d.data(q.typeahead))&&c(b,d)})}function f(a,b){return a.clone().addClass(b.classes.hint).removeData().css(b.css.hint).css(m(a)).prop("readonly",!0).removeAttr("id name placeholder required").attr({spellcheck:"false",tabindex:-1})}function h(a,b){a.data(q.attrs,{dir:a.attr("dir"),autocomplete:a.attr("autocomplete"),spellcheck:a.attr("spellcheck"),style:a.attr("style")}),a.addClass(b.classes.input).attr({spellcheck:!1});try{!a.attr("dir")&&a.attr("dir","auto")}catch(a){}return a}function m(a){return{backgroundAttachment:a.css("background-attachment"),backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function n(a){var c,d;c=a.data(q.www),d=a.parent().filter(c.selectors.wrapper),b.each(a.data(q.attrs),function(c,d){b.isUndefined(c)?a.removeAttr(d):a.attr(d,c)}),a.removeData(q.typeahead).removeData(q.www).removeData(q.attr).removeClass(c.classes.input),d.length&&(a.detach().insertAfter(d),d.remove())}function o(c){var d,e;return d=b.isJQuery(c)||b.isElement(c),e=d?a(c).first():[],e.length?e:null}var p,q,r;p=a.fn.typeahead,q={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},r={initialize:function(e,m){function n(){var c,n,r,s,t,u,v,w,x,y,z,A;b.each(m,function(a){a.highlight=!!e.highlight}),c=a(this),n=a(p.html.wrapper),r=o(e.hint),s=o(e.menu),t=e.hint!==!1&&!r,u=e.menu!==!1&&!s,t&&(r=f(c,p)),u&&(s=a(p.html.menu).css(p.css.menu)),r&&r.val(""),c=h(c,p),(t||u)&&(n.css(p.css.wrapper),c.css(t?p.css.input:p.css.inputWithNoHint),c.wrap(n).parent().prepend(t?r:null).append(u?s:null)),A=u?k:i,v=new d({el:c}),w=new g({hint:r,input:c},p),x=new A({node:s,datasets:m},p),y=new j({$input:c,menu:x}),z=new l({input:w,menu:x,eventBus:v,minLength:e.minLength},p),c.data(q.www,p),c.data(q.typeahead,z)}var p;return m=b.isArray(m)?m:[].slice.call(arguments,1),e=e||{},p=c(e.classNames),this.each(n)},isEnabled:function(){var a;return e(this.first(),function(b){a=b.isEnabled()}),a},enable:function(){return e(this,function(a){a.enable()}),this},disable:function(){return e(this,function(a){a.disable()}),this},isActive:function(){var a;return e(this.first(),function(b){a=b.isActive()}),a},activate:function(){return e(this,function(a){a.activate()}),this},deactivate:function(){return e(this,function(a){a.deactivate()}),this},isOpen:function(){var a;return e(this.first(),function(b){a=b.isOpen()}),a},open:function(){return e(this,function(a){a.open()}),this},close:function(){return e(this,function(a){a.close()}),this},select:function(b){var c=!1,d=a(b);return e(this.first(),function(a){c=a.select(d)}),c},autocomplete:function(b){var c=!1,d=a(b);return e(this.first(),function(a){c=a.autocomplete(d)}),c},moveCursor:function(a){var b=!1;return e(this.first(),function(c){b=c.moveCursor(a)}),b},val:function(a){var c;return arguments.length?(e(this,function(c){c.setVal(b.toStr(a))}),this):(e(this.first(),function(a){c=a.getVal()}),c)},destroy:function(){return e(this,function(a,b){n(b),a.destroy()}),this}},a.fn.typeahead=function(a){return r[a]?r[a].apply(this,[].slice.call(arguments,1)):r.initialize.apply(this,arguments)},a.fn.typeahead.noConflict=function(){return a.fn.typeahead=p,this}}()});

/**
 * JSTS. See https://github.com/bjornharrtell/jsts
 * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_EDLv1.txt
 * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_EPLv1.txt
 * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_LICENSE_ES6_COLLECTIONS.txt
 * @license
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.jsts=t.jsts||{})}(this,function(t){"use strict";function e(){}function n(){}function i(){}function r(){}function s(){}function o(){}function a(){}function u(t){this.name="RuntimeException",this.message=t,this.stack=(new Error).stack,Error.call(this,t)}function l(){if(0===arguments.length)u.call(this);else if(1===arguments.length){var t=arguments[0];u.call(this,t)}}function h(){}function c(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)c.call(this,0,0);else if(1===arguments.length){var t=arguments[0];c.call(this,t.x,t.y,t.z)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];c.call(this,e,n,c.NULL_ORDINATE)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this.x=i,this.y=r,this.z=s}}function f(){if(this.dimensionsToTest=2,0===arguments.length)f.call(this,2);else if(1===arguments.length){var t=arguments[0];if(2!==t&&3!==t)throw new n("only 2 or 3 dimensions may be specified");this.dimensionsToTest=t}}function g(){}function d(){}function p(t){this.message=t||""}function m(){}function v(t){this.message=t||""}function y(t){this.message=t||""}function x(){this.array_=[],arguments[0]instanceof d&&this.addAll(arguments[0])}function E(){if(x.apply(this),0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}}function I(){if(this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof c){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof I){var e=arguments[0];this.init(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];this.init(r,s,o,a)}}function N(){}function C(){N.call(this,"Projective point not representable on the Cartesian plane.")}function S(){}function L(){}function w(t){this.str=t}function R(t){this.value=t}function T(){}function O(){if(this.hi=0,this.lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof O){var e=arguments[0];this.init(e)}else if("string"==typeof arguments[0]){var n=arguments[0];O.call(this,O.parse(n))}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i,r)}}function P(){}function b(){}function _(){}function M(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];this.x=e,this.y=n,this.w=1}else if(arguments[0]instanceof M&&arguments[1]instanceof M){var i=arguments[0],r=arguments[1];this.x=i.y*r.w-r.y*i.w,this.y=r.x*i.w-i.x*r.w,this.w=i.x*r.y-r.x*i.y}else if(arguments[0]instanceof c&&arguments[1]instanceof c){var s=arguments[0],o=arguments[1];this.x=s.y-o.y,this.y=o.x-s.x,this.w=s.x*o.y-o.x*s.y}}else if(3===arguments.length){var a=arguments[0],u=arguments[1],l=arguments[2];this.x=a,this.y=u,this.w=l}else if(4===arguments.length){var h=arguments[0],f=arguments[1],g=arguments[2],d=arguments[3],p=h.y-f.y,m=f.x-h.x,v=h.x*f.y-f.x*h.y,y=g.y-d.y,x=d.x-g.x,E=g.x*d.y-d.x*g.y;this.x=m*E-x*v,this.y=y*v-p*E,this.w=p*x-y*m}}function D(){}function A(){}function F(){this.envelope=null,this.factory=null,this.SRID=null,this.userData=null;var t=arguments[0];this.factory=t,this.SRID=t.getSRID()}function G(){}function q(){}function B(){}function V(){}function z(){}function k(){}function Y(){}function U(){}function X(){}function H(){}function W(){}function j(){}function K(){this.array_=[],arguments[0]instanceof d&&this.addAll(arguments[0])}function Z(t){return null==t?uo:t.color}function Q(t){return null==t?null:t.parent}function J(t,e){null!==t&&(t.color=e)}function $(t){return null==t?null:t.left}function tt(t){return null==t?null:t.right}function et(){this.root_=null,this.size_=0}function nt(){}function it(){}function rt(){this.array_=[],arguments[0]instanceof d&&this.addAll(arguments[0])}function st(){}function ot(){}function at(){}function ut(){}function lt(){this.geometries=null;var t=arguments[0],e=arguments[1];if(F.call(this,e),null===t&&(t=[]),F.hasNullElements(t))throw new n("geometries must not contain null elements");this.geometries=t}function ht(){var t=arguments[0],e=arguments[1];lt.call(this,t,e)}function ct(){if(this.geom=null,this.geomFact=null,this.bnRule=null,this.endpointMap=null,1===arguments.length){var t=arguments[0];ct.call(this,t,q.MOD2_BOUNDARY_RULE)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.geom=e,this.geomFact=e.getFactory(),this.bnRule=n}}function ft(){this.count=null}function gt(){}function dt(){}function pt(){}function mt(){}function vt(){}function yt(){}function xt(){}function Et(){}function It(){this.points=null;var t=arguments[0],e=arguments[1];F.call(this,e),this.init(t)}function Nt(){}function Ct(){this.coordinates=null;var t=arguments[0],e=arguments[1];F.call(this,e),this.init(t)}function St(){}function Lt(){this.shell=null,this.holes=null;var t=arguments[0],e=arguments[1],i=arguments[2];if(F.call(this,i),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),F.hasNullElements(e))throw new n("holes must not contain null elements");if(t.isEmpty()&&F.hasNonEmptyElements(e))throw new n("shell is empty but holes are not");this.shell=t,this.holes=e}function wt(){var t=arguments[0],e=arguments[1];lt.call(this,t,e)}function Rt(){if(arguments[0]instanceof c&&arguments[1]instanceof $t){var t=arguments[0],e=arguments[1];Rt.call(this,e.getCoordinateSequenceFactory().create(t),e)}else if(oo(arguments[0],b)&&arguments[1]instanceof $t){var n=arguments[0],i=arguments[1];It.call(this,n,i),this.validateConstruction()}}function Tt(){var t=arguments[0],e=arguments[1];lt.call(this,t,e)}function Ot(){if(this.factory=null,this.isUserDataCopied=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.factory=t}}function Pt(){}function bt(){}function _t(){}function Mt(){}function Dt(){if(this.dimension=3,this.coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];Dt.call(this,t,3)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.coordinates=new Array(e).fill(null);for(var n=0;n<e;n++)this.coordinates[n]=new c}else if(oo(arguments[0],b)){var i=arguments[0];if(null===i)return this.coordinates=new Array(0).fill(null),null;this.dimension=i.getDimension(),this.coordinates=new Array(i.size()).fill(null);for(var n=0;n<this.coordinates.length;n++)this.coordinates[n]=i.getCoordinateCopy(n)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],s=arguments[1];this.coordinates=r,this.dimension=s,null===r&&(this.coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var o=arguments[0],a=arguments[1];this.coordinates=new Array(o).fill(null),this.dimension=a;for(var n=0;n<o;n++)this.coordinates[n]=new c}}function At(){}function Ft(t,e){return t===e||t!==t&&e!==e}function Gt(t){this.add?t.forEach(this.add,this):t.forEach(function(t){this.set(t[0],t[1])},this)}function qt(t){return this.has(t)&&(this._keys.splice(ho,1),this._values.splice(ho,1),this._itp.forEach(function(t){ho<t[0]&&t[0]--})),ho>-1}function Bt(t){return this.has(t)?this._values[ho]:void 0}function Vt(t,e){if(this.objectOnly&&e!==Object(e))throw new TypeError("Invalid value used as weak collection key");if(e!==e||0===e)for(ho=t.length;ho--&&!Ft(t[ho],e););else ho=t.indexOf(e);return ho>-1}function zt(t){return Vt.call(this,this._keys,t)}function kt(t,e){return this.has(t)?this._values[ho]=e:this._values[this._keys.push(t)-1]=e,this}function Yt(){(this._keys||0).length=this._values.length=0}function Ut(){return Wt(this._itp,this._keys)}function Xt(){return Wt(this._itp,this._values)}function Ht(){return Wt(this._itp,this._keys,this._values)}function Wt(t,e,n){var i=[0],r=!1;return t.push(i),{next:function(){var s,o=i[0];return!r&&o<e.length?(s=n?[e[o],n[o]]:e[o],i[0]++):(r=!0,t.splice(t.indexOf(i),1)),{done:r,value:s}}}}function jt(){return this._values.length}function Kt(t,e){for(var n=this.entries();;){var i=n.next();if(i.done)break;t.call(e,i.value[1],i.value[0],this)}}function Zt(){this.map_=new go}function Qt(){if(this.modelType=null,this.scale=null,0===arguments.length)this.modelType=Qt.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Jt){var t=arguments[0];this.modelType=t,t===Qt.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var e=arguments[0];this.modelType=Qt.FIXED,this.setScale(e)}else if(arguments[0]instanceof Qt){var n=arguments[0];this.modelType=n.modelType,this.scale=n.scale}}function Jt(){this.name=null;var t=arguments[0];this.name=t,Jt.nameToTypeMap.put(t,this)}function $t(){if(this.precisionModel=null,this.coordinateSequenceFactory=null,this.SRID=null,0===arguments.length)$t.call(this,new Qt,0);else if(1===arguments.length){if(oo(arguments[0],D)){var t=arguments[0];$t.call(this,new Qt,0,t)}else if(arguments[0]instanceof Qt){var e=arguments[0];$t.call(this,e,0,$t.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];$t.call(this,n,i,$t.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.precisionModel=r,this.coordinateSequenceFactory=o,this.SRID=s}}function te(t){this.geometryFactory=t||new $t}function ee(t){this.parser=new te(t)}function ne(){this.result=null,this.inputLines=Array(2).fill().map(function(){return Array(2)}),this.intPt=new Array(2).fill(null),this.intLineIndex=null,this._isProper=null,this.pa=null,this.pb=null,this.precisionModel=null,this.intPt[0]=new c,this.intPt[1]=new c,this.pa=this.intPt[0],this.pb=this.intPt[1],this.result=0}function ie(){ne.apply(this)}function re(){}function se(){this.p=null,this.crossingCount=0,this.isPointOnSegment=!1;var t=arguments[0];this.p=t}function oe(){}function ae(){if(this.p0=null,this.p1=null,0===arguments.length)ae.call(this,new c,new c);else if(1===arguments.length){var t=arguments[0];ae.call(this,t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0=e,this.p1=n}else if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];ae.call(this,new c(i,r),new c(s,o))}}function ue(){if(this.matrix=null,0===arguments.length)this.matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(ot.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){var t=arguments[0];ue.call(this),this.set(t)}else if(arguments[0]instanceof ue){var e=arguments[0];ue.call(this),this.matrix[S.INTERIOR][S.INTERIOR]=e.matrix[S.INTERIOR][S.INTERIOR],this.matrix[S.INTERIOR][S.BOUNDARY]=e.matrix[S.INTERIOR][S.BOUNDARY],this.matrix[S.INTERIOR][S.EXTERIOR]=e.matrix[S.INTERIOR][S.EXTERIOR],this.matrix[S.BOUNDARY][S.INTERIOR]=e.matrix[S.BOUNDARY][S.INTERIOR],this.matrix[S.BOUNDARY][S.BOUNDARY]=e.matrix[S.BOUNDARY][S.BOUNDARY],this.matrix[S.BOUNDARY][S.EXTERIOR]=e.matrix[S.BOUNDARY][S.EXTERIOR],this.matrix[S.EXTERIOR][S.INTERIOR]=e.matrix[S.EXTERIOR][S.INTERIOR],this.matrix[S.EXTERIOR][S.BOUNDARY]=e.matrix[S.EXTERIOR][S.BOUNDARY],this.matrix[S.EXTERIOR][S.EXTERIOR]=e.matrix[S.EXTERIOR][S.EXTERIOR]}}function le(){this.areaBasePt=null,this.triangleCent3=new c,this.areasum2=0,this.cg3=new c,this.lineCentSum=new c,this.totalLength=0,this.ptCount=0,this.ptCentSum=new c;var t=arguments[0];this.areaBasePt=null,this.add(t)}function he(t){this.message=t||""}function ce(){this.array_=[]}function fe(){this.treeSet=new rt,this.list=new x}function ge(){if(this.geomFactory=null,this.inputPts=null,1===arguments.length){var t=arguments[0];ge.call(this,ge.extractCoordinates(t),t.getFactory())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputPts=fe.filterCoordinates(e),this.geomFactory=n}}function de(){this.origin=null;var t=arguments[0];this.origin=t}function pe(){this.inputGeom=null,this.factory=null,this.pruneEmptyGeometry=!0,this.preserveGeometryCollectionType=!0,this.preserveCollections=!1,this.preserveType=!1}function me(){if(this.snapTolerance=0,this.srcPts=null,this.seg=new ae,this.allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof It&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];me.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.srcPts=n,this._isClosed=me.isClosed(n),this.snapTolerance=i}}function ve(){this.srcGeom=null;var t=arguments[0];this.srcGeom=t}function ye(){if(pe.apply(this),this.snapTolerance=null,this.snapPts=null,this.isSelfSnap=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this.snapTolerance=t,this.snapPts=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.snapTolerance=n,this.snapPts=i,this.isSelfSnap=r}}function xe(){this.isFirst=!0,this.commonMantissaBitsCount=53,this.commonBits=0,this.commonSignExp=null}function Ee(){this.commonCoord=null,this.ccFilter=new Ie}function Ie(){this.commonBitsX=new xe,this.commonBitsY=new xe}function Ne(){this.trans=null;var t=arguments[0];this.trans=t}function Ce(){this.parent=null,this.atStart=null,this.max=null,this.index=null,this.subcollectionIterator=null;var t=arguments[0];this.parent=t,this.atStart=!0,this.index=0,this.max=t.getNumGeometries()}function Se(){if(this.boundaryRule=q.OGC_SFS_BOUNDARY_RULE,this.isIn=null,this.numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new n("Rule must be non-null");this.boundaryRule=t}}function Le(){}function we(){}function Re(){this.pts=null,this.data=null;var t=arguments[0],e=arguments[1];this.pts=t,this.data=e}function Te(){}function Oe(){this.bounds=null,this.item=null;var t=arguments[0],e=arguments[1];this.bounds=t,this.item=e}function Pe(){this._size=null,this.items=null,this._size=0,this.items=new x,this.items.add(null)}function be(){}function _e(){}function Me(){if(this.childBoundables=new x,this.bounds=null,this.level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.level=t}}function De(){this.boundable1=null,this.boundable2=null,this._distance=null,this.itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.boundable1=t,this.boundable2=e,this.itemDistance=n,this._distance=this.distance()}function Ae(){if(this.root=null,this.built=!1,this.itemBoundables=new x,this.nodeCapacity=null,0===arguments.length)Ae.call(this,Ae.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];h.isTrue(t>1,"Node capacity must be greater than 1"),this.nodeCapacity=t}}function Fe(){}function Ge(){}function qe(){if(0===arguments.length)qe.call(this,qe.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];Ae.call(this,t)}}function Be(){var t=arguments[0];Me.call(this,t)}function Ve(){}function ze(){this.segString=null,this.coord=null,this.segmentIndex=null,this.segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.segString=t,this.coord=new c(e),this.segmentIndex=n,this.segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))}function ke(){this.nodeMap=new et,this.edge=null;var t=arguments[0];this.edge=t}function Ye(){this.nodeList=null,this.edge=null,this.nodeIt=null,this.currNode=null,this.nextNode=null,this.currSegIndex=0;var t=arguments[0];this.nodeList=t,this.edge=t.getEdge(),this.nodeIt=t.iterator(),this.readNextNode()}function Ue(){}function Xe(){this.nodeList=new ke(this),this.pts=null,this.data=null;var t=arguments[0],e=arguments[1];this.pts=t,this.data=e}function He(){this.tempEnv1=new I,this.tempEnv2=new I,this.overlapSeg1=new ae,this.overlapSeg2=new ae}function We(){this.pts=null,this.start=null,this.end=null,this.env=null,this.context=null,this.id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.pts=t,this.start=e,this.end=n,this.context=i}function je(){}function Ke(){}function Ze(){}function Qe(){if(this.segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}}function Je(){if(this.monoChains=new x,this.index=new qe,this.idCounter=0,this.nodedSegStrings=null,this.nOverlaps=0,0===arguments.length);else if(1===arguments.length){var t=arguments[0];Qe.call(this,t)}}function $e(){He.apply(this),this.si=null;var t=arguments[0];this.si=t}function tn(){if(this.pt=null,1===arguments.length){var t=arguments[0];u.call(this,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];u.call(this,tn.msgWithCoord(e,n)),this.name="TopologyException",this.pt=new c(n)}}function en(){}function nn(){this.findAllIntersections=!1,this.isCheckEndSegmentsOnly=!1,this.li=null,this.interiorIntersection=null,this.intSegments=null,this.intersections=new x,this.intersectionCount=0,this.keepIntersections=!0;var t=arguments[0];this.li=t,this.interiorIntersection=null}function rn(){this.li=new ie,this.segStrings=null,this.findAllIntersections=!1,this.segInt=null,this._isValid=!0;var t=arguments[0];this.segStrings=t}function sn(){this.nv=null;var t=arguments[0];this.nv=new rn(sn.toSegmentStrings(t))}function on(){this.mapOp=null;var t=arguments[0];this.mapOp=t}function an(){}function un(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[an.ON]=e}else if(arguments[0]instanceof un){var n=arguments[0];if(this.init(n.location.length),null!==n)for(var i=0;i<this.location.length;i++)this.location[i]=n.location[i]}}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.init(3),this.location[an.ON]=r,this.location[an.LEFT]=s,this.location[an.RIGHT]=o}}function ln(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new un(t),this.elt[1]=new un(t)}else if(arguments[0]instanceof ln){var e=arguments[0];this.elt[0]=new un(e.elt[0]),this.elt[1]=new un(e.elt[1])}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.elt[0]=new un(S.NONE),this.elt[1]=new un(S.NONE),this.elt[n].setLocation(i)}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.elt[0]=new un(r,s,o),this.elt[1]=new un(r,s,o)}else if(4===arguments.length){var a=arguments[0],u=arguments[1],l=arguments[2],h=arguments[3];this.elt[0]=new un(S.NONE,S.NONE,S.NONE),this.elt[1]=new un(S.NONE,S.NONE,S.NONE),this.elt[a].setLocations(u,l,h)}}function hn(){this.startDe=null,this.maxNodeDegree=-1,this.edges=new x,this.pts=new x,this.label=new ln(S.NONE),this.ring=null,this._isHole=null,this.shell=null,this.holes=new x,this.geometryFactory=null;var t=arguments[0],e=arguments[1];this.geometryFactory=e,this.computePoints(t),this.computeRing()}function cn(){var t=arguments[0],e=arguments[1];hn.call(this,t,e)}function fn(){var t=arguments[0],e=arguments[1];hn.call(this,t,e)}function gn(){if(this.label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.label=t}}function dn(){gn.apply(this),this.coord=null,this.edges=null;var t=arguments[0],e=arguments[1];this.coord=t,this.edges=e,this.label=new ln(0,S.NONE)}function pn(){this.nodeMap=new et,this.nodeFact=null;var t=arguments[0];this.nodeFact=t}function mn(){if(this.edge=null,this.label=null,this.node=null,this.p0=null,this.p1=null,this.dx=null,this.dy=null,this.quadrant=null,1===arguments.length){var t=arguments[0];this.edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];mn.call(this,e,n,i,null)}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];mn.call(this,r),this.init(s,o),this.label=a}}function vn(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this.sym=null,this.next=null,this.nextMin=null,this.edgeRing=null,this.minEdgeRing=null,this.depth=[0,-999,-999];var t=arguments[0],e=arguments[1];if(mn.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()}function yn(){}function xn(){if(this.edges=new x,this.nodes=null,this.edgeEndList=new x,0===arguments.length)this.nodes=new pn(new yn);else if(1===arguments.length){var t=arguments[0];this.nodes=new pn(t)}}function En(){this.geometryFactory=null,this.shellList=new x;var t=arguments[0];this.geometryFactory=t}function In(){this.op=null,this.geometryFactory=null,this.ptLocator=null,this.lineEdgesList=new x,this.resultLineList=new x;var t=arguments[0],e=arguments[1],n=arguments[2];this.op=t,this.geometryFactory=e,this.ptLocator=n}function Nn(){this.op=null,this.geometryFactory=null,this.resultPointList=new x;var t=arguments[0],e=arguments[1];arguments[2];this.op=t,this.geometryFactory=e}function Cn(){}function Sn(){this.geom=null;var t=arguments[0];this.geom=t}function Ln(){this.edgeMap=new et,this.edgeList=null,this.ptInAreaLocation=[S.NONE,S.NONE]}function wn(){Ln.apply(this),this.resultAreaEdgeList=null,this.label=null,this.SCANNING_FOR_INCOMING=1,this.LINKING_TO_OUTGOING=2}function Rn(){yn.apply(this)}function Tn(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e}function On(){if(this.label=null,this.xValue=null,this.eventType=null,this.insertEvent=null,this.deleteEventIndex=null,this.obj=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.eventType=On.DELETE,this.xValue=t,this.insertEvent=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.eventType=On.INSERT,this.label=n,this.xValue=i,this.obj=r}}function Pn(){}function bn(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.properIntersectionPoint=null,this.li=null,this.includeProper=null,this.recordIsolated=null,this.isSelfIntersection=null,this.numIntersections=0,this.numTests=0,this.bdyNodes=null,this._isDone=!1,this.isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.li=t,this.includeProper=e,this.recordIsolated=n}function _n(){Pn.apply(this),this.events=new x,this.nOverlaps=null}function Mn(){this.min=i.POSITIVE_INFINITY,this.max=i.NEGATIVE_INFINITY}function Dn(){}function An(){Mn.apply(this),this.item=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.min=t,this.max=e,this.item=n}function Fn(){Mn.apply(this),this.node1=null,this.node2=null;var t=arguments[0],e=arguments[1];this.node1=t,this.node2=e,this.buildExtent(this.node1,this.node2)}function Gn(){this.leaves=new x,this.root=null,this.level=0}function qn(){if(this.lines=null,this.isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this.lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.lines=e,this.isForcedToLineString=n}}function Bn(){this.items=new x}function Vn(){this.index=null;var t=arguments[0];if(!oo(t,St))throw new n("Argument must be Polygonal");this.index=new kn(t)}function zn(){this.counter=null;var t=arguments[0];this.counter=t}function kn(){this.index=new Gn;var t=arguments[0];this.init(t)}function Yn(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new c(t),this.segmentIndex=e,this.dist=n}function Un(){this.nodeMap=new et,this.edge=null;var t=arguments[0];this.edge=t}function Xn(){}function Hn(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new I,this.env2=new I;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Xn;this.startIndex=e.getChainStartIndices(this.pts)}function Wn(){this.depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var e=0;e<3;e++)this.depth[t][e]=Wn.NULL_VALUE}function jn(){if(gn.apply(this),this.pts=null,this.env=null,this.eiList=new Un(this),this.name=null,this.mce=null,this._isIsolated=!0,this.depth=new Wn,this.depthDelta=0,1===arguments.length){var t=arguments[0];jn.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pts=e,this.label=n}}function Kn(){if(xn.apply(this),this.parentGeom=null,this.lineEdgeMap=new Zt,this.boundaryNodeRule=null,this.useBoundaryDeterminationRule=!0,this.argIndex=null,this.boundaryNodes=null,this._hasTooFewPoints=!1,this.invalidPoint=null,this.areaPtLocator=null,this.ptLocator=new Se,2===arguments.length){var t=arguments[0],e=arguments[1];Kn.call(this,t,e,q.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.argIndex=n,this.parentGeom=i,this.boundaryNodeRule=r,null!==i&&this.add(i)}}function Zn(){if(this.li=new ie,this.resultPrecisionModel=null,this.arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this.arg=new Array(1).fill(null),this.arg[0]=new Kn(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Zn.call(this,e,n,q.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];i.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this.arg=new Array(2).fill(null),this.arg[0]=new Kn(0,i,s),this.arg[1]=new Kn(1,r,s)}}function Qn(){this.pts=null,this._orientation=null;var t=arguments[0];this.pts=t,this._orientation=Qn.orientation(t)}function Jn(){this.edges=new x,this.ocaMap=new et}function $n(){this.ptLocator=new Se,this.geomFact=null,this.resultGeom=null,this.graph=null,this.edgeList=new Jn,this.resultPolyList=new x,this.resultLineList=new x,this.resultPointList=new x;var t=arguments[0],e=arguments[1];Zn.call(this,t,e),this.graph=new xn(new Rn),this.geomFact=t.getFactory()}function ti(){this.geom=new Array(2).fill(null),this.snapTolerance=null,this.cbr=null;var t=arguments[0],e=arguments[1];this.geom[0]=t,this.geom[1]=e,this.computeSnapTolerance()}function ei(){this.geom=new Array(2).fill(null);var t=arguments[0],e=arguments[1];this.geom[0]=t,this.geom[1]=e}function ni(){this.factory=null,this.interiorPoint=null,this.maxWidth=0;var t=arguments[0];this.factory=t.getFactory(),this.add(t)}function ii(){this.poly=null,this.centreY=null,this.hiY=i.MAX_VALUE,this.loY=-i.MAX_VALUE;var t=arguments[0];this.poly=t,this.hiY=t.getEnvelopeInternal().getMaxY(),this.loY=t.getEnvelopeInternal().getMinY(),this.centreY=ni.avg(this.loY,this.hiY)}function ri(){this.centroid=null,this.minDistance=i.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.addInterior(t),null===this.interiorPoint&&this.addEndpoints(t)}function si(){this.centroid=null,this.minDistance=i.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.add(t)}function oi(){this.tempEnv1=new I,this.selectedSegment=new ae}function ai(){this.items=new x,this.subnode=[null,null]}function ui(){if(this.min=null,this.max=null,0===arguments.length)this.min=0,this.max=0;else if(1===arguments.length){var t=arguments[0];this.init(t.min,t.max)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.init(e,n)}}function li(){}function hi(t,e){var n,i,r,s,o={32:{d:127,c:128,b:0,a:0},64:{d:32752,c:0,b:0,a:0}},a={32:8,64:11}[t];if(s||(n=e<0||1/e<0,isFinite(e)||(s=o[t],n&&(s.d+=1<<t/4-1),i=Math.pow(2,a)-1,r=0)),!s){for(i={32:127,64:1023}[t],r=Math.abs(e);r>=2;)i++,r/=2;for(;r<1&&i>0;)i--,r*=2;i<=0&&(r/=2),32===t&&i>254&&(s={d:n?255:127,c:128,b:0,a:0},i=Math.pow(2,a)-1,r=0)}return i}function ci(){this.pt=0,this.level=0,this.interval=null;var t=arguments[0];this.computeKey(t)}function fi(){ai.apply(this),this.interval=null,this.centre=null,this.level=null;var t=arguments[0],e=arguments[1];this.interval=t,this.level=e,this.centre=(t.getMin()+t.getMax())/2}function gi(){}function di(){ai.apply(this)}function pi(){this.root=null,this.minExtent=1,this.root=new di}function mi(){}function vi(){this.ring=null,this.tree=null,this.crossings=0,this.interval=new ui;var t=arguments[0];this.ring=t,this.buildIndex()}function yi(){oi.apply(this),this.mcp=null,this.p=null;var t=arguments[0],e=arguments[1];this.mcp=t,this.p=e}function xi(){}function Ei(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.p0=t,this.p1=e,this.p2=n}function Ii(){this.input=null,this.extremalPts=null,this.centre=null,this.radius=0;var t=arguments[0];this.input=t}function Ni(){if(this.inputGeom=null,this.isConvex=null,this.convexHullPts=null,this.minBaseSeg=new ae,this.minWidthPt=null,this.minPtIndex=null,this.minWidth=0,1===arguments.length){var t=arguments[0];Ni.call(this,t,!1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputGeom=e,this.isConvex=n}}function Ci(){this.inputGeom=null,this.distanceTolerance=null;var t=arguments[0];this.inputGeom=t}function Si(){pe.apply(this),this.distanceTolerance=null;var t=arguments[0];this.distanceTolerance=t}function Li(){this._orig=null,this._sym=null,this._next=null;var t=arguments[0];this._orig=t}function wi(){this._isMarked=!1;var t=arguments[0];Li.call(this,t)}function Ri(){this.vertexMap=new Zt}function Ti(){this._isStart=!1;var t=arguments[0];wi.call(this,t)}function Oi(){Ri.apply(this)}function Pi(){this.result=null,this.factory=null,this.graph=null,this.lines=new x,this.nodeEdgeStack=new ce,this.ringStartEdge=null,this.graph=new Oi}function bi(){this.items=new x,this.subnode=new Array(4).fill(null)}function _i(){this.pt=new c,this.level=0,this.env=null;var t=arguments[0];this.computeKey(t)}function Mi(){bi.apply(this),this.env=null,this.centrex=null,this.centrey=null,this.level=null;var t=arguments[0],e=arguments[1];this.env=t,this.level=e,this.centrex=(t.getMinX()+t.getMaxX())/2,this.centrey=(t.getMinY()+t.getMaxY())/2}function Di(){bi.apply(this)}function Ai(){this.root=null,this.minExtent=1,this.root=new Di}function Fi(t){this.geometryFactory=t||new $t}function Gi(t){this.geometryFactory=t||new $t,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Fi(this.geometryFactory)}function qi(){this.parser=new Fi(this.geometryFactory)}function Bi(t){this.geometryFactory=t||new $t,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new te(this.geometryFactory)}function Vi(t){return[t.x,t.y]}function zi(t,e){this.geometryFactory=t||new $t,this.ol=e||"undefined"!=typeof ol&&ol}function ki(){if(this.noder=null,this.scaleFactor=null,this.offsetX=null,this.offsetY=null,this.isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];ki.call(this,t,e,0,0)}else if(4===arguments.length){var n=arguments[0],i=arguments[1];arguments[2],arguments[3];this.noder=n,this.scaleFactor=i,this.isScaled=!this.isIntegerPrecision()}}function Yi(){if(this.inputGeom=null,this.isClosedEndpointsInInterior=!0,this.nonSimpleLocation=null,1===arguments.length){var t=arguments[0];this.inputGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputGeom=e,this.isClosedEndpointsInInterior=!n.isInBoundary(2)}}function Ui(){this.pt=null,this.isClosed=null,this.degree=null;var t=arguments[0];this.pt=t,this.isClosed=!1,this.degree=0}function Xi(){if(this.quadrantSegments=Xi.DEFAULT_QUADRANT_SEGMENTS,this.endCapStyle=Xi.CAP_ROUND,this.joinStyle=Xi.JOIN_ROUND,this.mitreLimit=Xi.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,
this.simplifyFactor=Xi.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(n)}else if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(r),this.setJoinStyle(s),this.setMitreLimit(o)}}function Hi(){this.minIndex=-1,this.minCoord=null,this.minDe=null,this.orientedDe=null}function Wi(){this.array_=[]}function ji(){this.finder=null,this.dirEdgeList=new x,this.nodes=new x,this.rightMostCoord=null,this.env=null,this.finder=new Hi}function Ki(){this.inputLine=null,this.distanceTol=null,this.isDeleted=null,this.angleOrientation=oe.COUNTERCLOCKWISE;var t=arguments[0];this.inputLine=t}function Zi(){this.ptList=null,this.precisionModel=null,this.minimimVertexDistance=0,this.ptList=new x}function Qi(){this.maxCurveSegmentError=0,this.filletAngleQuantum=null,this.closingSegLengthFactor=1,this.segList=null,this.distance=0,this.precisionModel=null,this.bufParams=null,this.li=null,this.s0=null,this.s1=null,this.s2=null,this.seg0=new ae,this.seg1=new ae,this.offset0=new ae,this.offset1=new ae,this.side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.precisionModel=t,this.bufParams=e,this.li=new ie,this.filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===Xi.JOIN_ROUND&&(this.closingSegLengthFactor=Qi.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}function Ji(){this.distance=0,this.precisionModel=null,this.bufParams=null;var t=arguments[0],e=arguments[1];this.precisionModel=t,this.bufParams=e}function $i(){this.subgraphs=null,this.seg=new ae,this.cga=new oe;var t=arguments[0];this.subgraphs=t}function tr(){this.upwardSeg=null,this.leftDepth=null;var t=arguments[0],e=arguments[1];this.upwardSeg=new ae(t),this.leftDepth=e}function er(){this.inputGeom=null,this.distance=null,this.curveBuilder=null,this.curveList=new x;var t=arguments[0],e=arguments[1],n=arguments[2];this.inputGeom=t,this.distance=e,this.curveBuilder=n}function nr(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.hasInterior=!1,this.properIntersectionPoint=null,this.li=null,this.isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this.li=t}function ir(){this.bufParams=null,this.workingPrecisionModel=null,this.workingNoder=null,this.geomFact=null,this.graph=null,this.edgeList=new Jn;var t=arguments[0];this.bufParams=t}function rr(){this.li=new ie,this.segStrings=null;var t=arguments[0];this.segStrings=t}function sr(){this.li=null,this.pt=null,this.originalPt=null,this.ptScaled=null,this.p0Scaled=null,this.p1Scaled=null,this.scaleFactor=null,this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,this.corner=new Array(4).fill(null),this.safeEnv=null;var t=arguments[0],e=arguments[1],i=arguments[2];if(this.originalPt=t,this.pt=t,this.scaleFactor=e,this.li=i,e<=0)throw new n("Scale factor must be non-zero");1!==e&&(this.pt=new c(this.scale(t.x),this.scale(t.y)),this.p0Scaled=new c,this.p1Scaled=new c),this.initCorners(this.pt)}function or(){this.index=null;var t=arguments[0];this.index=t}function ar(){oi.apply(this),this.hotPixel=null,this.parentEdge=null,this.hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.hotPixel=t,this.parentEdge=e,this.hotPixelVertexIndex=n}function ur(){this.li=null,this.interiorIntersections=null;var t=arguments[0];this.li=t,this.interiorIntersections=new x}function lr(){this.pm=null,this.li=null,this.scaleFactor=null,this.noder=null,this.pointSnapper=null,this.nodedSegStrings=null;var t=arguments[0];this.pm=t,this.li=new ie,this.li.setPrecisionModel(t),this.scaleFactor=t.getScale()}function hr(){if(this.argGeom=null,this.distance=null,this.bufParams=new Xi,this.resultGeometry=null,this.saveException=null,1===arguments.length){var t=arguments[0];this.argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.argGeom=e,this.bufParams=n}}function cr(){this.comps=null;var t=arguments[0];this.comps=t}function fr(){if(this.component=null,this.segIndex=null,this.pt=null,2===arguments.length){var t=arguments[0],e=arguments[1];fr.call(this,t,fr.INSIDE_AREA,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.component=n,this.segIndex=i,this.pt=r}}function gr(){this.pts=null;var t=arguments[0];this.pts=t}function dr(){this.locations=null;var t=arguments[0];this.locations=t}function pr(){if(this.geom=null,this.terminateDistance=0,this.ptLocator=new Se,this.minDistanceLocation=null,this.minDistance=i.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];pr.call(this,t,e,0)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],s=arguments[2];this.geom=new Array(2).fill(null),this.geom[0]=n,this.geom[1]=r,this.terminateDistance=s}}function mr(){this.factory=null,this.directedEdges=new x,this.coordinates=null;var t=arguments[0];this.factory=t}function vr(){this._isMarked=!1,this._isVisited=!1,this.data=null}function yr(){vr.apply(this),this.parentEdge=null,this.from=null,this.to=null,this.p0=null,this.p1=null,this.sym=null,this.edgeDirection=null,this.quadrant=null,this.angle=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.from=t,this.to=e,this.edgeDirection=i,this.p0=t.getCoordinate(),this.p1=n;var r=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y;this.quadrant=je.quadrant(r,s),this.angle=Math.atan2(s,r)}function xr(){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];yr.call(this,t,e,n,i)}function Er(){if(vr.apply(this),this.dirEdge=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];this.setDirectedEdges(t,e)}}function Ir(){this.outEdges=new x,this.sorted=!1}function Nr(){if(vr.apply(this),this.pt=null,this.deStar=null,1===arguments.length){var t=arguments[0];Nr.call(this,t,new Ir)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pt=e,this.deStar=n}}function Cr(){Er.apply(this),this.line=null;var t=arguments[0];this.line=t}function Sr(){this.nodeMap=new et}function Lr(){this.edges=new K,this.dirEdges=new K,this.nodeMap=new Sr}function wr(){Lr.apply(this)}function Rr(){this.graph=new wr,this.mergedLineStrings=null,this.factory=null,this.edgeStrings=null}function Tr(){this.edgeRing=null,this.next=null,this.label=-1;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];yr.call(this,t,e,n,i)}function Or(){Er.apply(this),this.line=null;var t=arguments[0];this.line=t}function Pr(){this.geometryFactory=new $t,this.geomGraph=null,this.disconnectedRingcoord=null;var t=arguments[0];this.geomGraph=t}function br(){}function _r(){if(this.edgeEnds=new x,1===arguments.length){var t=arguments[0];_r.call(this,null,t)}else if(2===arguments.length){var e=(arguments[0],arguments[1]);mn.call(this,e.getEdge(),e.getCoordinate(),e.getDirectedCoordinate(),new ln(e.getLabel())),this.insert(e)}}function Mr(){Ln.apply(this)}function Dr(){var t=arguments[0],e=arguments[1];dn.call(this,t,e)}function Ar(){yn.apply(this)}function Fr(){this.nodes=new pn(new Ar)}function Gr(){this.li=new ie,this.geomGraph=null,this.nodeGraph=new Fr,this.invalidPoint=null;var t=arguments[0];this.geomGraph=t}function qr(){this.graph=null,this.rings=new x,this.totalEnv=new I,this.index=null,this.nestedPt=null;var t=arguments[0];this.graph=t}function Br(){if(this.errorType=null,this.pt=null,1===arguments.length){var t=arguments[0];Br.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.errorType=e,null!==n&&(this.pt=n.copy())}}function Vr(){this.parentGeometry=null,this.isSelfTouchingRingFormingHoleValid=!1,this.validErr=null;var t=arguments[0];this.parentGeometry=t}function zr(){this.factory=null,this.deList=new x,this.lowestEdge=null,this.ring=null,this.ringPts=null,this.holes=null,this.shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;var t=arguments[0];this.factory=t}function kr(){}function Yr(){Lr.apply(this),this.factory=null;var t=arguments[0];this.factory=t}function Ur(){if(this.lineStringAdder=new Xr(this),this.graph=null,this.dangles=new x,this.cutEdges=new x,this.invalidRingLines=new x,this.holeList=null,this.shellList=null,this.polyList=null,this.isCheckingRingsValid=!0,this.extractOnlyPolygonal=null,this.geomFactory=null,0===arguments.length)Ur.call(this,!1);else if(1===arguments.length){var t=arguments[0];this.extractOnlyPolygonal=t}}function Xr(){this.p=null;var t=arguments[0];this.p=t}function Hr(){this.li=new ie,this.ptLocator=new Se,this.arg=null,this.nodes=new pn(new Ar),this.im=null,this.isolatedEdges=new x,this.invalidPoint=null;var t=arguments[0];this.arg=t}function Wr(){this.rectEnv=null;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal()}function jr(){this.li=new ie,this.rectEnv=null,this.diagUp0=null,this.diagUp1=null,this.diagDown0=null,this.diagDown1=null;var t=arguments[0];this.rectEnv=t,this.diagUp0=new c(t.getMinX(),t.getMinY()),this.diagUp1=new c(t.getMaxX(),t.getMaxY()),this.diagDown0=new c(t.getMinX(),t.getMaxY()),this.diagDown1=new c(t.getMaxX(),t.getMinY())}function Kr(){this._isDone=!1}function Zr(){this.rectangle=null,this.rectEnv=null;var t=arguments[0];this.rectangle=t,this.rectEnv=t.getEnvelopeInternal()}function Qr(){Kr.apply(this),this.rectEnv=null,this._intersects=!1;var t=arguments[0];this.rectEnv=t}function Jr(){Kr.apply(this),this.rectSeq=null,this.rectEnv=null,this._containsPoint=!1;var t=arguments[0];this.rectSeq=t.getExteriorRing().getCoordinateSequence(),this.rectEnv=t.getEnvelopeInternal()}function $r(){Kr.apply(this),this.rectEnv=null,this.rectIntersector=null,this.hasIntersection=!1,this.p0=new c,this.p1=new c;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal(),this.rectIntersector=new jr(this.rectEnv)}function ts(){if(this._relate=null,2===arguments.length){var t=arguments[0],e=arguments[1];Zn.call(this,t,e),this._relate=new Hr(this.arg)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];Zn.call(this,n,i,r),this._relate=new Hr(this.arg)}}function es(){this.geomFactory=null,this.skipEmpty=!1,this.inputGeoms=null;var t=arguments[0];this.geomFactory=es.extractFactory(t),this.inputGeoms=t}function ns(){this.pointGeom=null,this.otherGeom=null,this.geomFact=null;var t=arguments[0],e=arguments[1];this.pointGeom=t,this.otherGeom=e,this.geomFact=e.getFactory()}function is(){this.sortIndex=-1,this.comps=null;var t=arguments[0],e=arguments[1];this.sortIndex=t,this.comps=e}function rs(){this.inputPolys=null,this.geomFactory=null;var t=arguments[0];this.inputPolys=t,null===this.inputPolys&&(this.inputPolys=new x)}function ss(){if(this.polygons=new x,this.lines=new x,this.points=new x,this.geomFact=null,1===arguments.length){if(oo(arguments[0],d)){var t=arguments[0];this.extract(t)}else if(arguments[0]instanceof F){var e=arguments[0];this.extract(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.geomFact=i,this.extract(n)}}function os(){Ot.CoordinateOperation.apply(this),this.targetPM=null,this.removeCollapsed=!0;var t=arguments[0],e=arguments[1];this.targetPM=t,this.removeCollapsed=e}function as(){this.targetPM=null,this.removeCollapsed=!0,this.changePrecisionModel=!1,this.isPointwise=!1;var t=arguments[0];this.targetPM=t}function us(){this.pts=null,this.usePt=null,this.distanceTolerance=null,this.seg=new ae;var t=arguments[0];this.pts=t}function ls(){this.inputGeom=null,this.distanceTolerance=null,this.isEnsureValidTopology=!0;var t=arguments[0];this.inputGeom=t}function hs(){pe.apply(this),this.isEnsureValidTopology=!0,this.distanceTolerance=null;var t=arguments[0],e=arguments[1];this.isEnsureValidTopology=t,this.distanceTolerance=e}function cs(){if(this.parent=null,this.index=null,2===arguments.length){var t=arguments[0],e=arguments[1];cs.call(this,t,e,null,-1)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],s=arguments[3];ae.call(this,n,i),this.parent=r,this.index=s}}function fs(){if(this.parentLine=null,this.segs=null,this.resultSegs=new x,this.minimumSize=null,1===arguments.length){var t=arguments[0];fs.call(this,t,2)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.parentLine=e,this.minimumSize=n,this.init()}}function gs(){this.index=new Ai}function ds(){this.querySeg=null,this.items=new x;var t=arguments[0];this.querySeg=t}function ps(){this.li=new ie,this.inputIndex=new gs,this.outputIndex=new gs,this.line=null,this.linePts=null,this.distanceTolerance=0;var t=arguments[0],e=arguments[1];this.inputIndex=t,this.outputIndex=e}function ms(){this.inputIndex=new gs,this.outputIndex=new gs,this.distanceTolerance=0}function vs(){this.inputGeom=null,this.lineSimplifier=new ms,this.linestringMap=null;var t=arguments[0];this.inputGeom=t}function ys(){pe.apply(this),this.linestringMap=null;var t=arguments[0];this.linestringMap=t}function xs(){this.tps=null;var t=arguments[0];this.tps=t}function Es(){this.seg=null,this.segLen=null,this.splitPt=null,this.minimumLen=0;var t=arguments[0];this.seg=t,this.segLen=t.getLength()}function Is(){}function Ns(){}function Cs(){}function Ss(){if(this.p=null,1===arguments.length){var t=arguments[0];this.p=new c(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p=new c(e,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this.p=new c(i,r,s)}}function Ls(){this._isOnConstraint=null,this.constraint=null;var t=arguments[0];Ss.call(this,t)}function ws(){this._rot=null,this.vertex=null,this.next=null,this.data=null}function Rs(){this.subdiv=null,this.isUsingTolerance=!1;var t=arguments[0];this.subdiv=t,this.isUsingTolerance=t.getTolerance()>0}function Ts(){}function Os(){this.subdiv=null,this.lastEdge=null;var t=arguments[0];this.subdiv=t,this.init()}function Ps(){if(this.seg=null,1===arguments.length){if("string"==typeof arguments[0]){var t=arguments[0];u.call(this,t)}else if(arguments[0]instanceof ae){var e=arguments[0];u.call(this,"Locate failed to converge (at edge: "+e+").  Possible causes include invalid Subdivision topology or very close sites"),this.seg=new ae(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];u.call(this,Ps.msgWithSpatial(n,i)),this.seg=new ae(i)}}function bs(){}function _s(){this.visitedKey=0,this.quadEdges=new x,this.startingEdge=null,this.tolerance=null,this.edgeCoincidenceTolerance=null,this.frameVertex=new Array(3).fill(null),this.frameEnv=null,this.locator=null,this.seg=new ae,this.triEdges=new Array(3).fill(null);var t=arguments[0],e=arguments[1];this.tolerance=e,this.edgeCoincidenceTolerance=e/_s.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(t),this.startingEdge=this.initSubdiv(),this.locator=new Os(this)}function Ms(){}function Ds(){this.triList=new x}function As(){this.triList=new x}function Fs(){this.coordList=new E,this.triCoords=new x}function Gs(){if(this.ls=null,this.data=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.ls=new ae(t,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.ls=new ae(n,i),this.data=r}else if(6===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2],u=arguments[3],l=arguments[4],h=arguments[5];Gs.call(this,new c(s,o,a),new c(u,l,h))}else if(7===arguments.length){var f=arguments[0],g=arguments[1],d=arguments[2],p=arguments[3],m=arguments[4],v=arguments[5],y=arguments[6];Gs.call(this,new c(f,g,d),new c(p,m,v),y)}}function qs(){}function Bs(){if(this.p=null,this.data=null,this.left=null,this.right=null,this.count=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.p=new c(t),this.left=null,this.right=null,this.count=1,this.data=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.p=new c(n,i),this.left=null,this.right=null,this.count=1,this.data=r}}function Vs(){if(this.root=null,this.numberOfNodes=null,this.tolerance=null,0===arguments.length)Vs.call(this,0);else if(1===arguments.length){var t=arguments[0];this.tolerance=t}}function zs(){this.tolerance=null,this.matchNode=null,this.matchDist=0,this.p=null;var t=arguments[0],e=arguments[1];this.p=t,this.tolerance=e}function ks(){this.initialVertices=null,this.segVertices=null,this.segments=new x,this.subdiv=null,this.incDel=null,this.convexHull=null,this.splitFinder=new Ns,this.kdt=null,this.vertexFactory=null,this.computeAreaEnv=null,this.splitPt=null,this.tolerance=null;var t=arguments[0],e=arguments[1];this.initialVertices=new x(t),this.tolerance=e,this.kdt=new Vs(e)}function Ys(){this.siteCoords=null,this.tolerance=0,this.subdiv=null}function Us(){this.siteCoords=null,this.constraintLines=null,this.tolerance=0,this.subdiv=null,this.constraintVertexMap=new et}function Xs(){this.siteCoords=null,this.tolerance=0,this.subdiv=null,this.clipEnv=null,this.diagramEnv=null}function Hs(){if(this.componentIndex=0,this.segmentIndex=0,this.segmentFraction=0,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.componentIndex=t.componentIndex,this.segmentIndex=t.segmentIndex,this.segmentFraction=t.segmentFraction}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Hs.call(this,0,e,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this.componentIndex=i,this.segmentIndex=r,this.segmentFraction=s,this.normalize()}else if(4===arguments.length){var o=arguments[0],a=arguments[1],u=arguments[2],l=arguments[3];this.componentIndex=o,this.segmentIndex=a,this.segmentFraction=u,l&&this.normalize()}}function Ws(){if(this.linearGeom=null,this.numLines=null,this.currentLine=null,this.componentIndex=0,this.vertexIndex=0,1===arguments.length){var t=arguments[0];Ws.call(this,t,0,0)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];Ws.call(this,e,i.getComponentIndex(),Ws.segmentEndVertexIndex(i))}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];if(!oo(r,nt))throw new n("Lineal geometry is required");this.linearGeom=r,this.numLines=r.getNumGeometries(),this.componentIndex=s,this.vertexIndex=o,this.loadCurrentLine()}}function js(){this.linearGeom=null;var t=arguments[0];this.linearGeom=t}function Ks(){this.linearGeom=null;var t=arguments[0];this.linearGeom=t}function Zs(){this.geomFact=null,this.lines=new x,this.coordList=null,this.ignoreInvalidLines=!1,this.fixInvalidLines=!1,this.lastPt=null;var t=arguments[0];this.geomFact=t}function Qs(){this.line=null;var t=arguments[0];this.line=t}function Js(){this.linearGeom=null;var t=arguments[0];this.linearGeom=t,this.checkGeometryType()}function $s(){this.linearGeom=null;var t=arguments[0];this.linearGeom=t}function to(){this.linearGeom=null;var t=arguments[0];this.linearGeom=t}function eo(){this.linearGeom=null;var t=arguments[0];this.linearGeom=t}function no(){}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(void 0===this||null===this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,i=1 in arguments?parseInt(Number(arguments[1]),10)||0:0;i=i<0?Math.max(n+i,0):Math.min(i,n);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(r=r<0?Math.max(n+arguments[2],0):Math.min(r,n);i<r;)e[i]=t,++i;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!==t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var io=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};io(e.prototype,{interfaces_:function(){return[]},getClass:function(){return e}}),e.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n},i.isNaN=function(t){return Number.isNaN(t)},i.doubleToLongBits=function(t){return t},i.longBitsToDouble=function(t){return t},i.isInfinite=function(t){return!Number.isFinite(t)},i.MAX_VALUE=Number.MAX_VALUE,u.prototype=Object.create(Error.prototype),u.prototype.constructor=Error;var ro=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t};ro(l,u),io(l.prototype,{interfaces_:function(){return[]},getClass:function(){return l}}),io(h.prototype,{interfaces_:function(){return[]},getClass:function(){return h}}),h.shouldNeverReachHere=function(){if(0===arguments.length)h.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new l("Should never reach here"+(null!==t?": "+t:""))}},h.isTrue=function(){if(1===arguments.length){var t=arguments[0];h.isTrue(t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!e)throw null===n?new l:new l(n)}},h.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];h.equals(t,e,null)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(!i.equals(n))throw new l("Expected "+n+" but encountered "+i+(null!==r?": "+r:""))}},io(c.prototype,{setOrdinate:function(t,e){switch(t){case c.X:this.x=e;break;case c.Y:this.y=e;break;case c.Z:this.z=e;break;default:throw new n("Invalid ordinate index: "+t)}},equals2D:function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var n=arguments[0],i=arguments[1];return!!e.equalsWithTolerance(this.x,n.x,i)&&!!e.equalsWithTolerance(this.y,n.y,i)}},getOrdinate:function(t){switch(t){case c.X:return this.x;case c.Y:return this.y;case c.Z:return this.z}throw new n("Invalid ordinate index: "+t)},equals3D:function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||i.isNaN(this.z)&&i.isNaN(t.z))},equals:function(t){return t instanceof c&&this.equals2D(t)},equalInZ:function(t,n){return e.equalsWithTolerance(this.z,t.z,n)},compareTo:function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},clone:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return h.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}},copy:function(){return new c(this)},toString:function(){return"("+this.x+", "+this.y+", "+this.z+")"},distance3D:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},distance:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},hashCode:function(){var t=17;return t=37*t+c.hashCode(this.x),t=37*t+c.hashCode(this.y)},setCoordinate:function(t){this.x=t.x,this.y=t.y,this.z=t.z},interfaces_:function(){return[r,s,a]},getClass:function(){return c}}),c.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=i.doubleToLongBits(t);return Math.trunc(e^e>>>32)}},io(f.prototype,{compare:function(t,e){var n=t,i=e,r=f.compare(n.x,i.x);if(0!==r)return r;var s=f.compare(n.y,i.y);return 0!==s?s:this.dimensionsToTest<=2?0:f.compare(n.z,i.z)},interfaces_:function(){return[o]},getClass:function(){return f}}),f.compare=function(t,e){return t<e?-1:t>e?1:i.isNaN(t)?i.isNaN(e)?0:-1:i.isNaN(e)?1:0},c.DimensionalComparator=f,c.serialVersionUID=0x5cbf2c235c7e5800,c.NULL_ORDINATE=i.NaN,c.X=0,c.Y=1,c.Z=2,g.prototype.hasNext=function(){},g.prototype.next=function(){},g.prototype.remove=function(){},d.prototype.add=function(){},d.prototype.addAll=function(){},d.prototype.isEmpty=function(){},d.prototype.iterator=function(){},d.prototype.size=function(){},d.prototype.toArray=function(){},d.prototype.remove=function(){},p.prototype=new Error,p.prototype.name="IndexOutOfBoundsException",m.prototype=Object.create(d.prototype),m.prototype.constructor=m,m.prototype.get=function(){},m.prototype.set=function(){},m.prototype.isEmpty=function(){},v.prototype=new Error,v.prototype.name="NoSuchElementException",y.prototype=new Error,y.prototype.name="OperationNotSupported",x.prototype=Object.create(m.prototype),x.prototype.constructor=x,x.prototype.ensureCapacity=function(){},x.prototype.interfaces_=function(){return[m,d]},x.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},x.prototype.clear=function(){this.array_=[]},x.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},x.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},x.prototype.iterator=function(){return new so(this)},x.prototype.get=function(t){if(t<0||t>=this.size())throw new p;return this.array_[t]},x.prototype.isEmpty=function(){return 0===this.array_.length},x.prototype.size=function(){return this.array_.length},x.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},x.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e};var so=function(t){this.arrayList_=t,this.position_=0};so.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new v;return this.arrayList_.get(this.position_++)},so.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},so.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},so.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},ro(E,x),io(E.prototype,{getCoordinate:function(t){return this.get(t)},addAll:function(){if(2===arguments.length){for(var t=arguments[0],e=arguments[1],n=!1,i=t.iterator();i.hasNext();)this.add(i.next(),e),n=!0;return n}return x.prototype.addAll.apply(this,arguments)},clone:function(){for(var t=x.prototype.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).copy());return t},toCoordinateArray:function(){return this.toArray(E.coordArrayType)},add:function(){if(1===arguments.length){var t=arguments[0];x.prototype.add.call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var e=arguments[0],n=arguments[1];return this.add(e,n,!0),!0}if(arguments[0]instanceof c&&"boolean"==typeof arguments[1]){var i=arguments[0],r=arguments[1];if(!r&&this.size()>=1){var s=this.get(this.size()-1);if(s.equals2D(i))return null}x.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1];return this.add(o,a),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var u=arguments[0],l=arguments[1],h=arguments[2];if(h)for(var f=0;f<u.length;f++)this.add(u[f],l);else for(var f=u.length-1;f>=0;f--)this.add(u[f],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof c){var g=arguments[0],d=arguments[1],p=arguments[2];if(!p){var m=this.size();if(m>0){if(g>0){var v=this.get(g-1);if(v.equals2D(d))return null}if(g<m){var y=this.get(g);if(y.equals2D(d))return null}}}x.prototype.add.call(this,g,d)}}else if(4===arguments.length){var E=arguments[0],I=arguments[1],N=arguments[2],C=arguments[3],S=1;N>C&&(S=-1);for(var f=N;f!==C;f+=S)this.add(E[f],I);return!0}},closeRing:function(){this.size()>0&&this.add(new c(this.get(0)),!1)},interfaces_:function(){return[]},getClass:function(){return E}}),E.coordArrayType=new Array(0).fill(null),io(I.prototype,{getArea:function(){return this.getWidth()*this.getHeight()},equals:function(t){if(!(t instanceof I))return!1;var e=t;return this.isNull()?e.isNull():this.maxx===e.getMaxX()&&this.maxy===e.getMaxY()&&this.minx===e.getMinX()&&this.miny===e.getMinY()},intersection:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new I;var e=this.minx>t.minx?this.minx:t.minx,n=this.miny>t.miny?this.miny:t.miny;return new I(e,this.maxx<t.maxx?this.maxx:t.maxx,n,this.maxy<t.maxy?this.maxy:t.maxy)},isNull:function(){return this.maxx<this.minx},getMaxX:function(){return this.maxx},covers:function(){if(1===arguments.length){if(arguments[0]instanceof c){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof I){var e=arguments[0];return!this.isNull()&&!e.isNull()&&(e.getMinX()>=this.minx&&e.getMaxX()<=this.maxx&&e.getMinY()>=this.miny&&e.getMaxY()<=this.maxy)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&(n>=this.minx&&n<=this.maxx&&i>=this.miny&&i<=this.maxy)}},intersects:function(){if(1===arguments.length){if(arguments[0]instanceof I){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t.minx>this.maxx||t.maxx<this.minx||t.miny>this.maxy||t.maxy<this.miny)}if(arguments[0]instanceof c){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this.maxx||n<this.minx||i>this.maxy||i<this.miny)}},getMinY:function(){return this.miny},getMinX:function(){return this.minx},expandToInclude:function(){if(1===arguments.length){if(arguments[0]instanceof c){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof I){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this.minx=e.getMinX(),this.maxx=e.getMaxX(),this.miny=e.getMinY(),this.maxy=e.getMaxY()):(e.minx<this.minx&&(this.minx=e.minx),e.maxx>this.maxx&&(this.maxx=e.maxx),e.miny<this.miny&&(this.miny=e.miny),e.maxy>this.maxy&&(this.maxy=e.maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this.minx=n,this.maxx=n,this.miny=i,this.maxy=i):(n<this.minx&&(this.minx=n),n>this.maxx&&(this.maxx=n),i<this.miny&&(this.miny=i),i>this.maxy&&(this.maxy=i))}},minExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},getWidth:function(){return this.isNull()?0:this.maxx-this.minx},compareTo:function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this.minx<e.minx?-1:this.minx>e.minx?1:this.miny<e.miny?-1:this.miny>e.miny?1:this.maxx<e.maxx?-1:this.maxx>e.maxx?1:this.maxy<e.maxy?-1:this.maxy>e.maxy?1:0},translate:function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},toString:function(){return"Env["+this.minx+" : "+this.maxx+", "+this.miny+" : "+this.maxy+"]"},setToNull:function(){this.minx=0,this.maxx=-1,this.miny=0,this.maxy=-1},getHeight:function(){return this.isNull()?0:this.maxy-this.miny},maxExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},expandBy:function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this.minx-=e,this.maxx+=e,this.miny-=n,this.maxy+=n,(this.minx>this.maxx||this.miny>this.maxy)&&this.setToNull()}},contains:function(){if(1===arguments.length){if(arguments[0]instanceof I){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof c){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},centre:function(){return this.isNull()?null:new c((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},init:function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof c){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof I){var e=arguments[0];this.minx=e.minx,this.maxx=e.maxx,this.miny=e.miny,this.maxy=e.maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];r<s?(this.minx=r,this.maxx=s):(this.minx=s,this.maxx=r),o<a?(this.miny=o,this.maxy=a):(this.miny=a,this.maxy=o)}},getMaxY:function(){return this.maxy},distance:function(t){if(this.intersects(t))return 0;var e=0
;this.maxx<t.minx?e=t.minx-this.maxx:this.minx>t.maxx&&(e=this.minx-t.maxx);var n=0;return this.maxy<t.miny?n=t.miny-this.maxy:this.miny>t.maxy&&(n=this.miny-t.maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},hashCode:function(){var t=17;return t=37*t+c.hashCode(this.minx),t=37*t+c.hashCode(this.maxx),t=37*t+c.hashCode(this.miny),t=37*t+c.hashCode(this.maxy)},interfaces_:function(){return[r,a]},getClass:function(){return I}}),I.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],a=Math.min(s.x,o.x),u=Math.max(s.x,o.x),l=Math.min(i.x,r.x),h=Math.max(i.x,r.x);return!(l>u)&&(!(h<a)&&(a=Math.min(s.y,o.y),u=Math.max(s.y,o.y),l=Math.min(i.y,r.y),h=Math.max(i.y,r.y),!(l>u)&&!(h<a)))}},I.serialVersionUID=0x51845cd552189800,ro(C,N),io(C.prototype,{interfaces_:function(){return[]},getClass:function(){return C}}),io(S.prototype,{interfaces_:function(){return[]},getClass:function(){return S}}),S.toLocationSymbol=function(t){switch(t){case S.EXTERIOR:return"e";case S.BOUNDARY:return"b";case S.INTERIOR:return"i";case S.NONE:return"-"}throw new n("Unknown location value: "+t)},S.INTERIOR=0,S.BOUNDARY=1,S.EXTERIOR=2,S.NONE=-1;var oo=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1};io(L.prototype,{interfaces_:function(){return[]},getClass:function(){return L}}),L.log10=function(t){var e=Math.log(t);return i.isInfinite(e)?e:i.isNaN(e)?e:e/L.LOG_10},L.min=function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r},L.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],s=arguments[2];return i<r?r:i>s?s:i}},L.wrap=function(t,e){return t<0?e- -t%e:t%e},L.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=t;return e>i&&(i=e),n>i&&(i=n),i}if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3],i=r;return s>i&&(i=s),o>i&&(i=o),a>i&&(i=a),i}},L.average=function(t,e){return(t+e)/2},L.LOG_10=Math.log(10),w.prototype.append=function(t){this.str+=t},w.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},w.prototype.toString=function(t){return this.str},R.prototype.intValue=function(){return this.value},R.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},R.isNaN=function(t){return Number.isNaN(t)},T.isWhitespace=function(t){return t<=32&&t>=0||127==t},T.toUpperCase=function(t){return t.toUpperCase()},io(O.prototype,{le:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<=t.lo},extractSignificantDigits:function(t,e){var n=this.abs(),i=O.magnitude(n.hi),r=O.TEN.pow(i);n=n.divide(r),n.gt(O.TEN)?(n=n.divide(O.TEN),i+=1):n.lt(O.ONE)&&(n=n.multiply(O.TEN),i-=1);for(var s=i+1,o=new w,a=O.MAX_PRINT_DIGITS-1,u=0;u<=a;u++){t&&u===s&&o.append(".");var l=Math.trunc(n.hi);if(l<0)break;var h=!1,c=0;l>9?(h=!0,c="9"):c="0"+l,o.append(c),n=n.subtract(O.valueOf(l)).multiply(O.TEN),h&&n.selfAdd(O.TEN);var f=!0,g=O.magnitude(n.hi);if(g<0&&Math.abs(g)>=a-u&&(f=!1),!f)break}return e[0]=i,o.toString()},sqr:function(){return this.multiply(this)},doubleValue:function(){return this.hi+this.lo},subtract:function(){if(arguments[0]instanceof O){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},equals:function(){if(1===arguments.length){var t=arguments[0];return this.hi===t.hi&&this.lo===t.lo}},isZero:function(){return 0===this.hi&&0===this.lo},selfSubtract:function(){if(arguments[0]instanceof O){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t.hi,-t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},getSpecialNumberString:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},min:function(t){return this.le(t)?this:t},selfDivide:function(){if(1===arguments.length){if(arguments[0]instanceof O){var t=arguments[0];return this.selfDivide(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,s=null,o=null,a=null,u=null,l=null,h=null,c=null;return u=this.hi/n,l=O.SPLIT*u,r=l-u,c=O.SPLIT*n,r=l-r,s=u-r,o=c-n,h=u*n,o=c-o,a=n-o,c=r*o-h+r*a+s*o+s*a,l=(this.hi-h-c+this.lo-u*i)/n,c=u+l,this.hi=c,this.lo=u-c+l,this}},dump:function(){return"DD<"+this.hi+", "+this.lo+">"},divide:function(){if(arguments[0]instanceof O){var t=arguments[0],e=null,n=null,r=null,s=null,o=null,a=null,u=null,l=null;o=this.hi/t.hi,a=O.SPLIT*o,e=a-o,l=O.SPLIT*t.hi,e=a-e,n=o-e,r=l-t.hi,u=o*t.hi,r=l-r,s=t.hi-r,l=e*r-u+e*s+n*r+n*s,a=(this.hi-u-l+this.lo-o*t.lo)/t.hi,l=o+a;return new O(l,o-l+a)}if("number"==typeof arguments[0]){var h=arguments[0];return i.isNaN(h)?O.createNaN():O.copy(this).selfDivide(h,0)}},ge:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>=t.lo},pow:function(t){if(0===t)return O.valueOf(1);var e=new O(this),n=O.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),(i/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},ceil:function(){if(this.isNaN())return O.NaN;var t=Math.ceil(this.hi),e=0;return t===this.hi&&(e=Math.ceil(this.lo)),new O(t,e)},compareTo:function(t){var e=t;return this.hi<e.hi?-1:this.hi>e.hi?1:this.lo<e.lo?-1:this.lo>e.lo?1:0},rint:function(){return this.isNaN()?this:this.add(.5).floor()},setValue:function(){if(arguments[0]instanceof O){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},max:function(t){return this.ge(t)?this:t},sqrt:function(){if(this.isZero())return O.valueOf(0);if(this.isNegative())return O.NaN;var t=1/Math.sqrt(this.hi),e=this.hi*t,n=O.valueOf(e),i=this.subtract(n.sqr()),r=i.hi*(.5*t);return n.add(r)},selfAdd:function(){if(1===arguments.length){if(arguments[0]instanceof O){var t=arguments[0];return this.selfAdd(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,i=null,r=null,s=null,o=null,a=null;return r=this.hi+e,o=r-this.hi,s=r-o,s=e-o+(this.hi-s),a=s+this.lo,n=r+a,i=a+(r-n),this.hi=n+i,this.lo=i+(n-this.hi),this}}else if(2===arguments.length){var u=arguments[0],l=arguments[1],n=null,i=null,h=null,c=null,r=null,s=null,o=null,a=null;r=this.hi+u,h=this.lo+l,o=r-this.hi,a=h-this.lo,s=r-o,c=h-a,s=u-o+(this.hi-s),c=l-a+(this.lo-c),o=s+h,n=r+o,i=o+(r-n),o=c+i;var f=n+o,g=o+(n-f);return this.hi=f,this.lo=g,this}},selfMultiply:function(){if(1===arguments.length){if(arguments[0]instanceof O){var t=arguments[0];return this.selfMultiply(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,s=null,o=null,a=null,u=null,l=null;u=O.SPLIT*this.hi,r=u-this.hi,l=O.SPLIT*n,r=u-r,s=this.hi-r,o=l-n,u=this.hi*n,o=l-o,a=n-o,l=r*o-u+r*a+s*o+s*a+(this.hi*i+this.lo*n);var h=u+l;r=u-h;var c=l+r;return this.hi=h,this.lo=c,this}},selfSqr:function(){return this.selfMultiply(this)},floor:function(){if(this.isNaN())return O.NaN;var t=Math.floor(this.hi),e=0;return t===this.hi&&(e=Math.floor(this.lo)),new O(t,e)},negate:function(){return this.isNaN()?this:new O(-this.hi,-this.lo)},clone:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}},multiply:function(){if(arguments[0]instanceof O){var t=arguments[0];return t.isNaN()?O.createNaN():O.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return i.isNaN(e)?O.createNaN():O.copy(this).selfMultiply(e,0)}},isNaN:function(){return i.isNaN(this.hi)},intValue:function(){return Math.trunc(this.hi)},toString:function(){var t=O.magnitude(this.hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},toStandardNotation:function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+O.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var s=i-n.length,o=O.stringOfChar("0",s);r=n+o+".0"}return this.isNegative()?"-"+r:r},reciprocal:function(){var t=null,e=null,n=null,i=null,r=null,s=null,o=null,a=null;r=1/this.hi,s=O.SPLIT*r,t=s-r,a=O.SPLIT*this.hi,t=s-t,e=r-t,n=a-this.hi,o=r*this.hi,n=a-n,i=this.hi-n,a=t*n-o+t*i+e*n+e*i,s=(1-o-a-r*this.lo)/this.hi;var u=r+s;return new O(u,r-u+s)},toSciNotation:function(){if(this.isZero())return O.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=O.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new IllegalStateException("Found leading zero: "+n);var r="";n.length>1&&(r=n.substring(1));var s=n.charAt(0)+"."+r;return this.isNegative()?"-"+s+i:s+i},abs:function(){return this.isNaN()?O.NaN:this.isNegative()?this.negate():new O(this)},isPositive:function(){return this.hi>0||0===this.hi&&this.lo>0},lt:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<t.lo},add:function(){if(arguments[0]instanceof O){var t=arguments[0];return O.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return O.copy(this).selfAdd(e)}},init:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.hi=t,this.lo=0}else if(arguments[0]instanceof O){var e=arguments[0];this.hi=e.hi,this.lo=e.lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.hi=n,this.lo=i}},gt:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>t.lo},isNegative:function(){return this.hi<0||0===this.hi&&this.lo<0},trunc:function(){return this.isNaN()?O.NaN:this.isPositive()?this.floor():this.ceil()},signum:function(){return this.hi>0?1:this.hi<0?-1:this.lo>0?1:this.lo<0?-1:0},interfaces_:function(){return[a,r,s]},getClass:function(){return O}}),O.sqr=function(t){return O.valueOf(t).selfMultiply(t)},O.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return O.parse(t)}if("number"==typeof arguments[0]){return new O(arguments[0])}},O.sqrt=function(t){return O.valueOf(t).sqrt()},O.parse=function(t){for(var e=0,n=t.length;T.isWhitespace(t.charAt(e));)e++;var i=!1;if(e<n){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var s=new O,o=0,a=0,u=0;;){if(e>=n)break;var l=t.charAt(e);if(e++,T.isDigit(l)){var h=l-"0";s.selfMultiply(O.TEN),s.selfAdd(h),o++}else{if("."!==l){if("e"===l||"E"===l){var c=t.substring(e);try{u=R.parseInt(c)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+c+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+l+"' at position "+e+" in string "+t)}a=o}}var f=s,g=o-a-u;if(0===g)f=s;else if(g>0){var d=O.TEN.pow(g);f=s.divide(d)}else if(g<0){var d=O.TEN.pow(-g);f=s.multiply(d)}return i?f.negate():f},O.createNaN=function(){return new O(i.NaN,i.NaN)},O.copy=function(t){return new O(t)},O.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i},O.stringOfChar=function(t,e){for(var n=new w,i=0;i<e;i++)n.append(t);return n.toString()},O.PI=new O(3.141592653589793,1.2246467991473532e-16),O.TWO_PI=new O(6.283185307179586,2.4492935982947064e-16),O.PI_2=new O(1.5707963267948966,6.123233995736766e-17),O.E=new O(2.718281828459045,1.4456468917292502e-16),O.NaN=new O(i.NaN,i.NaN),O.EPS=1.23259516440783e-32,O.SPLIT=134217729,O.MAX_PRINT_DIGITS=32,O.TEN=O.valueOf(10),O.ONE=O.valueOf(1),O.SCI_NOT_EXPONENT_CHAR="E",O.SCI_NOT_ZERO="0.0E0",io(P.prototype,{interfaces_:function(){return[]},getClass:function(){return P}}),P.orientationIndex=function(t,e,n){var i=P.orientationIndexFilter(t,e,n);if(i<=1)return i;var r=O.valueOf(e.x).selfAdd(-t.x),s=O.valueOf(e.y).selfAdd(-t.y),o=O.valueOf(n.x).selfAdd(-e.x),a=O.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(s.selfMultiply(o)).signum()},P.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},P.intersection=function(t,e,n,i){var r=O.valueOf(i.y).selfSubtract(n.y).selfMultiply(O.valueOf(e.x).selfSubtract(t.x)),s=O.valueOf(i.x).selfSubtract(n.x).selfMultiply(O.valueOf(e.y).selfSubtract(t.y)),o=r.subtract(s),a=O.valueOf(i.x).selfSubtract(n.x).selfMultiply(O.valueOf(t.y).selfSubtract(n.y)),u=O.valueOf(i.y).selfSubtract(n.y).selfMultiply(O.valueOf(t.x).selfSubtract(n.x)),l=a.subtract(u),h=l.selfDivide(o).doubleValue(),f=O.valueOf(t.x).selfAdd(O.valueOf(e.x).selfSubtract(t.x).selfMultiply(h)).doubleValue(),g=O.valueOf(e.x).selfSubtract(t.x).selfMultiply(O.valueOf(t.y).selfSubtract(n.y)),d=O.valueOf(e.y).selfSubtract(t.y).selfMultiply(O.valueOf(t.x).selfSubtract(n.x)),p=g.subtract(d),m=p.selfDivide(o).doubleValue();return new c(f,O.valueOf(n.y).selfAdd(O.valueOf(i.y).selfSubtract(n.y).selfMultiply(m)).doubleValue())},P.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),s=(t.y-n.y)*(e.x-n.x),o=r-s;if(r>0){if(s<=0)return P.signum(o);i=r+s}else{if(!(r<0))return P.signum(o);if(s>=0)return P.signum(o);i=-r-s}var a=P.DP_SAFE_EPSILON*i;return o>=a||-o>=a?P.signum(o):2},P.signum=function(t){return t>0?1:t<0?-1:0},P.DP_SAFE_EPSILON=1e-15,io(b.prototype,{setOrdinate:function(t,e,n){},size:function(){},getOrdinate:function(t,e){},getCoordinate:function(){if(1===arguments.length){arguments[0]}else if(2===arguments.length){arguments[0],arguments[1]}},getCoordinateCopy:function(t){},getDimension:function(){},getX:function(t){},clone:function(){},expandEnvelope:function(t){},copy:function(){},getY:function(t){},toCoordinateArray:function(){},interfaces_:function(){return[s]},getClass:function(){return b}}),b.X=0,b.Y=1,b.Z=2,b.M=3,_.arraycopy=function(t,e,n,i,r){for(var s=0,o=e;o<e+r;o++)n[i+s]=t[o],s++},_.getProperty=function(t){return{"line.separator":"\n"}[t]},io(M.prototype,{getY:function(){var t=this.y/this.w;if(i.isNaN(t)||i.isInfinite(t))throw new C;return t},getX:function(){var t=this.x/this.w;if(i.isNaN(t)||i.isInfinite(t))throw new C;return t},getCoordinate:function(){var t=new c;return t.x=this.getX(),t.y=this.getY(),t},interfaces_:function(){return[]},getClass:function(){return M}}),M.intersection=function(t,e,n,r){var s=t.y-e.y,o=e.x-t.x,a=t.x*e.y-e.x*t.y,u=n.y-r.y,l=r.x-n.x,h=n.x*r.y-r.x*n.y,f=o*h-l*a,g=u*a-s*h,d=s*l-u*o,p=f/d,m=g/d;if(i.isNaN(p)||i.isInfinite(p)||i.isNaN(m)||i.isInfinite(m))throw new C;return new c(p,m)},io(D.prototype,{create:function(){if(1===arguments.length){if(arguments[0]instanceof Array){arguments[0]}else if(oo(arguments[0],b)){arguments[0]}}else if(2===arguments.length){arguments[0],arguments[1]}},interfaces_:function(){return[]},getClass:function(){return D}}),io(A.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return A}}),io(F.prototype,{isGeometryCollection:function(){return this.getSortIndex()===F.SORTINDEX_GEOMETRYCOLLECTION},getFactory:function(){return this.factory},getGeometryN:function(t){return this},getArea:function(){return 0},isRectangle:function(){return!1},equals:function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof F))return!1;var n=e;return this.equalsExact(n)}}},equalsExact:function(t){return this===t||this.equalsExact(t,0)},geometryChanged:function(){this.apply(F.geometryChangedFilter)},geometryChangedAction:function(){this.envelope=null},equalsNorm:function(t){return null!==t&&this.norm().equalsExact(t.norm())},getLength:function(){return 0},getNumGeometries:function(){return 1},compareTo:function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1],e=n;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(n,i)}},getUserData:function(){return this.userData},getSRID:function(){return this.SRID},getEnvelope:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},checkNotGeometryCollection:function(t){if(t.getSortIndex()===F.SORTINDEX_GEOMETRYCOLLECTION)throw new n("This method does not support GeometryCollection arguments")},equal:function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},norm:function(){var t=this.copy();return t.normalize(),t},getPrecisionModel:function(){return this.factory.getPrecisionModel()},getEnvelopeInternal:function(){return null===this.envelope&&(this.envelope=this.computeEnvelopeInternal()),new I(this.envelope)},setSRID:function(t){this.SRID=t},setUserData:function(t){this.userData=t},compare:function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),s=i.next(),o=r.compareTo(s);if(0!==o)return o}return n.hasNext()?1:i.hasNext()?-1:0},hashCode:function(){return this.getEnvelopeInternal().hashCode()},isGeometryCollectionOrDerived:function(){return this.getSortIndex()===F.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===F.SORTINDEX_MULTIPOINT||this.getSortIndex()===F.SORTINDEX_MULTILINESTRING||this.getSortIndex()===F.SORTINDEX_MULTIPOLYGON},interfaces_:function(){return[s,r,a]},getClass:function(){return F}}),F.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},F.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},F.serialVersionUID=0x799ea46522854c00,F.SORTINDEX_POINT=0,F.SORTINDEX_MULTIPOINT=1,F.SORTINDEX_LINESTRING=2,F.SORTINDEX_LINEARRING=3,F.SORTINDEX_MULTILINESTRING=4,F.SORTINDEX_POLYGON=5,F.SORTINDEX_MULTIPOLYGON=6,F.SORTINDEX_GEOMETRYCOLLECTION=7,F.geometryChangedFilter={interfaces_:function(){return[A]},filter:function(t){t.geometryChangedAction()}},io(G.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return G}}),io(q.prototype,{isInBoundary:function(t){},interfaces_:function(){return[]},getClass:function(){return q}}),io(B.prototype,{isInBoundary:function(t){return t%2==1},interfaces_:function(){return[q]},getClass:function(){return B}}),io(V.prototype,{isInBoundary:function(t){return t>0},interfaces_:function(){return[q]},getClass:function(){return V}}),io(z.prototype,{isInBoundary:function(t){return t>1},interfaces_:function(){return[q]},getClass:function(){return z}}),io(k.prototype,{isInBoundary:function(t){return 1===t},interfaces_:function(){return[q]},getClass:function(){return k}}),q.Mod2BoundaryNodeRule=B,q.EndPointBoundaryNodeRule=V,q.MultiValentEndPointBoundaryNodeRule=z,q.MonoValentEndPointBoundaryNodeRule=k,q.MOD2_BOUNDARY_RULE=new B,q.ENDPOINT_BOUNDARY_RULE=new V,q.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new z,q.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new k,q.OGC_SFS_BOUNDARY_RULE=q.MOD2_BOUNDARY_RULE,io(Y.prototype,{interfaces_:function(){return[]},getClass:function(){return Y}}),Y.isRing=function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])},Y.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(Y.indexOf(i,e)<0)return i}return null},Y.scroll=function(t,e){var n=Y.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);_.arraycopy(t,n,i,0,t.length-n),_.arraycopy(t,0,i,t.length-n,n),_.arraycopy(i,0,t,0,t.length)},Y.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var n=0;n<i.length;n++)if(0!==s.compare(i[n],r[n]))return!1;return!0}},Y.intersection=function(t,e){for(var n=new E,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},Y.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Y.removeRepeatedPoints=function(t){return Y.hasRepeatedPoints(t)?new E(t,!1).toCoordinateArray():t},Y.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},Y.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,n=0;n<t.length;n++)null!==t[n]&&(i[r++]=t[n]);return i},Y.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new c(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4],n=0;n<a;n++)s[o+n]=new c(i[r+n])},Y.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},Y.envelope=function(t){for(var e=new I,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Y.toCoordinateArray=function(t){return t.toArray(Y.coordArrayType)},Y.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Y.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Y.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},Y.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},Y.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Y.extract=function(t,e,n){e=L.clamp(e,0,t.length),n=L.clamp(n,-1,t.length);var i=n-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var s=0,o=e;o<=n;o++)r[s++]=t[o];return r},io(U.prototype,{compare:function(t,e){var n=t,i=e;return Y.compare(n,i)},interfaces_:function(){return[o]},getClass:function(){return U}}),io(X.prototype,{compare:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=Y.compare(n,i);return Y.isEqualReversed(n,i)?0:r},OLDcompare:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=Y.increasingDirection(n),s=Y.increasingDirection(i),o=r>0?0:n.length-1,a=s>0?0:n.length-1,u=0;u<n.length;u++){var l=n[o].compareTo(i[a]);if(0!==l)return l;o+=r,a+=s}return 0},interfaces_:function(){return[o]},getClass:function(){return X}}),Y.ForwardComparator=U,Y.BidirectionalComparator=X,Y.coordArrayType=new Array(0).fill(null),H.prototype.get=function(){},H.prototype.put=function(){},H.prototype.size=function(){},H.prototype.values=function(){},H.prototype.entrySet=function(){},W.prototype=new H,j.prototype=new d,j.prototype.contains=function(){},K.prototype=new j,K.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++){if(this.array_[e]===t)return!0}return!1},K.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},K.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},K.prototype.remove=function(t){throw new javascript.util.OperationNotSupported},K.prototype.size=function(){return this.array_.length},K.prototype.isEmpty=function(){return 0===this.array_.length},K.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},K.prototype.iterator=function(){return new ao(this)};var ao=function(t){this.hashSet_=t,this.position_=0};ao.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new v;return this.hashSet_.array_[this.position_++]},ao.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},ao.prototype.remove=function(){throw new y};var uo=0;et.prototype=new W,et.prototype.get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},et.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:uo,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(i>0)){var s=r.value;return r.value=e,s}r=r.right}}while(null!==r);var o={key:t,left:null,right:null,value:e,parent:n,color:uo,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=o:n.right=o,this.fixAfterInsertion(o),this.size_++,null},et.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!=this.root_&&1==t.parent.color;)if(Q(t)==$(Q(Q(t)))){var e=tt(Q(Q(t)));1==Z(e)?(J(Q(t),uo),J(e,uo),J(Q(Q(t)),1),t=Q(Q(t))):(t==tt(Q(t))&&(t=Q(t),this.rotateLeft(t)),J(Q(t),uo),J(Q(Q(t)),1),this.rotateRight(Q(Q(t))))}else{var e=$(Q(Q(t)));1==Z(e)?(J(Q(t),uo),J(e,uo),J(Q(Q(t)),1),t=Q(Q(t))):(t==$(Q(t))&&(t=Q(t),this.rotateRight(t)),J(Q(t),uo),J(Q(Q(t)),1),this.rotateLeft(Q(Q(t))))}this.root_.color=uo},et.prototype.values=function(){var t=new x,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=et.successor(e));)t.add(e.value);return t},et.prototype.entrySet=function(){var t=new K,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=et.successor(e));)t.add(e);return t},et.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left==t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},et.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right==t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},et.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},et.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var e=t.parent,n=t;null!==e&&n===e.right;)n=e,e=e.parent;return e},et.prototype.size=function(){return this.size_},io(nt.prototype,{interfaces_:function(){return[]},getClass:function(){return nt}}),it.prototype=new j,rt.prototype=new it,rt.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++){if(0===this.array_[e].compareTo(t))return!0}return!1},rt.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++){if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0}return this.array_.push(t),!0},rt.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},rt.prototype.remove=function(t){throw new y},rt.prototype.size=function(){return this.array_.length},rt.prototype.isEmpty=function(){return 0===this.array_.length},rt.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},rt.prototype.iterator=function(){return new lo(this)};var lo=function(t){this.treeSet_=t,this.position_=0};lo.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new v;return this.treeSet_.array_[this.position_++]},lo.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},lo.prototype.remove=function(){throw new y},st.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)return i=function(t,e){return t.compareTo(e)},void r.sort(i);if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else{if(3===arguments.length){e=r.slice(arguments[1],arguments[2]),e.sort();var s=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<s.length;t++)r.push(s[t]);return}if(4===arguments.length){for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),s=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<s.length;t++)r.push(s[t]);return}}},st.asList=function(t){for(var e=new x,n=0,i=t.length;n<i;n++)e.add(t[n]);return e},io(ot.prototype,{interfaces_:function(){return[]},getClass:function(){return ot}}),ot.toDimensionSymbol=function(t){switch(t){case ot.FALSE:return ot.SYM_FALSE;case ot.TRUE:return ot.SYM_TRUE;case ot.DONTCARE:return ot.SYM_DONTCARE;case ot.P:return ot.SYM_P;case ot.L:return ot.SYM_L;case ot.A:return ot.SYM_A}throw new n("Unknown dimension value: "+t)},ot.toDimensionValue=function(t){switch(T.toUpperCase(t)){case ot.SYM_FALSE:return ot.FALSE;case ot.SYM_TRUE:return ot.TRUE;case ot.SYM_DONTCARE:return ot.DONTCARE;case ot.SYM_P:return ot.P;case ot.SYM_L:return ot.L;case ot.SYM_A:return ot.A}throw new n("Unknown dimension symbol: "+t)},ot.P=0,ot.L=1,ot.A=2,ot.FALSE=-1,ot.TRUE=-2,ot.DONTCARE=-3,ot.SYM_FALSE="F",ot.SYM_TRUE="T",ot.SYM_DONTCARE="*",ot.SYM_P="0",ot.SYM_L="1",ot.SYM_A="2",io(at.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return at}}),io(ut.prototype,{filter:function(t,e){},isDone:function(){},isGeometryChanged:function(){},interfaces_:function(){return[]},getClass:function(){return ut}}),ro(lt,F),io(lt.prototype,{computeEnvelopeInternal:function(){for(var t=new I,e=0;e<this.geometries.length;e++)t.expandToInclude(this.geometries[e].getEnvelopeInternal());return t},getGeometryN:function(t){return this.geometries[t]},getSortIndex:function(){return F.SORTINDEX_GEOMETRYCOLLECTION},getCoordinates:function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this.geometries.length;n++)for(var i=this.geometries[n].getCoordinates(),r=0;r<i.length;r++)e++,t[e]=i[r];return t},getArea:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getArea();return t},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this.geometries.length!==n.geometries.length)return!1;for(var i=0;i<this.geometries.length;i++)if(!this.geometries[i].equalsExact(n.geometries[i],e))return!1;return!0}return F.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<this.geometries.length;t++)this.geometries[t].normalize();st.sort(this.geometries)},getCoordinate:function(){return this.isEmpty()?null:this.geometries[0].getCoordinate()},getBoundaryDimension:function(){for(var t=ot.FALSE,e=0;e<this.geometries.length;e++)t=Math.max(t,this.geometries[e].getBoundaryDimension());return t},getDimension:function(){for(var t=ot.FALSE,e=0;e<this.geometries.length;e++)t=Math.max(t,this.geometries[e].getDimension());return t},getLength:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getLength();return t},getNumPoints:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getNumPoints();return t},getNumGeometries:function(){return this.geometries.length},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[n]=this.geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=new rt(st.asList(this.geometries)),n=new rt(st.asList(t.geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],s=i,o=this.getNumGeometries(),a=s.getNumGeometries(),u=0;u<o&&u<a;){var l=this.getGeometryN(u),h=s.getGeometryN(u),c=l.compareToSameClass(h,r);if(0!==c)return c;u++}return u<o?1:u<a?-1:0}},apply:function(){if(oo(arguments[0],G))for(var t=arguments[0],e=0;e<this.geometries.length;e++)this.geometries[e].apply(t);else if(oo(arguments[0],ut)){
var n=arguments[0];if(0===this.geometries.length)return null;for(var e=0;e<this.geometries.length&&(this.geometries[e].apply(n),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(oo(arguments[0],at)){var i=arguments[0];i.filter(this);for(var e=0;e<this.geometries.length;e++)this.geometries[e].apply(i)}else if(oo(arguments[0],A)){var r=arguments[0];r.filter(this);for(var e=0;e<this.geometries.length;e++)this.geometries[e].apply(r)}},getBoundary:function(){return this.checkNotGeometryCollection(this),h.shouldNeverReachHere(),null},clone:function(){var t=F.prototype.clone.call(this);t.geometries=new Array(this.geometries.length).fill(null);for(var e=0;e<this.geometries.length;e++)t.geometries[e]=this.geometries[e].clone();return t},getGeometryType:function(){return"GeometryCollection"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new lt(t,this.factory)},isEmpty:function(){for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isEmpty())return!1;return!0},interfaces_:function(){return[]},getClass:function(){return lt}}),lt.serialVersionUID=-0x4f07bcb1f857d800,ro(ht,lt),io(ht.prototype,{getSortIndex:function(){return F.SORTINDEX_MULTILINESTRING},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&lt.prototype.equalsExact.call(this,t,e)}return lt.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return this.isClosed()?ot.FALSE:0},isClosed:function(){if(this.isEmpty())return!1;for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isClosed())return!1;return!0},getDimension:function(){return 1},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[t-1-n]=this.geometries[n].reverse();return this.getFactory().createMultiLineString(e)},getBoundary:function(){return new ct(this).getBoundary()},getGeometryType:function(){return"MultiLineString"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new ht(t,this.factory)},interfaces_:function(){return[nt]},getClass:function(){return ht}}),ht.serialVersionUID=0x7155d2ab4afa8000,io(ct.prototype,{boundaryMultiLineString:function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this.geomFact.createPoint(e[0]):this.geomFact.createMultiPointFromCoords(e)},getBoundary:function(){return this.geom instanceof It?this.boundaryLineString(this.geom):this.geom instanceof ht?this.boundaryMultiLineString(this.geom):this.geom.getBoundary()},boundaryLineString:function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){return this.bnRule.isInBoundary(2)?t.getStartPoint():this.geomFact.createMultiPoint()}return this.geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},getEmptyMultiPoint:function(){return this.geomFact.createMultiPoint()},computeBoundaryCoordinates:function(t){var e=new x;this.endpointMap=new et;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this.endpointMap.entrySet().iterator();r.hasNext();){var s=r.next(),o=s.getValue(),a=o.count;this.bnRule.isInBoundary(a)&&e.add(s.getKey())}return Y.toCoordinateArray(e)},addEndpoint:function(t){var e=this.endpointMap.get(t);null===e&&(e=new ft,this.endpointMap.put(t,e)),e.count++},interfaces_:function(){return[]},getClass:function(){return ct}}),ct.getBoundary=function(){if(1===arguments.length){var t=arguments[0],e=new ct(t);return e.getBoundary()}if(2===arguments.length){var n=arguments[0],i=arguments[1],e=new ct(n,i);return e.getBoundary()}},io(ft.prototype,{interfaces_:function(){return[]},getClass:function(){return ft}}),io(xt.prototype,{interfaces_:function(){return[]},getClass:function(){return xt}}),xt.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return new String(n)},xt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new mt,n=new gt(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],s="",o=new dt(xt.getStackTrace(i)),a=new yt(o),u=0;u<r;u++)try{s+=a.readLine()+xt.NEWLINE}catch(t){if(!(t instanceof vt))throw t;h.shouldNeverReachHere()}return s}},xt.split=function(t,e){for(var n=e.length,i=new x,r=""+t,s=r.indexOf(e);s>=0;){var o=r.substring(0,s);i.add(o),r=r.substring(s+n),s=r.indexOf(e)}r.length>0&&i.add(r);for(var a=new Array(i.size()).fill(null),u=0;u<a.length;u++)a[u]=i.get(u);return a},xt.toString=function(){if(1===arguments.length){var t=arguments[0];return xt.SIMPLE_ORDINATE_FORMAT.format(t)}},xt.spaces=function(t){return xt.chars(" ",t)},xt.NEWLINE=_.getProperty("line.separator"),xt.SIMPLE_ORDINATE_FORMAT=new pt("0.#"),io(Et.prototype,{interfaces_:function(){return[]},getClass:function(){return Et}}),Et.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),s=0;s<r;s++)n.setOrdinate(i,s,t.getOrdinate(e,s))},Et.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&(t.getOrdinate(0,b.X)===t.getOrdinate(e-1,b.X)&&t.getOrdinate(0,b.Y)===t.getOrdinate(e-1,b.Y))},Et.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var r=Math.min(t.getDimension(),e.getDimension()),s=0;s<n;s++)for(var o=0;o<r;o++){var a=t.getOrdinate(s,o),u=e.getOrdinate(s,o);if(t.getOrdinate(s,o)!==e.getOrdinate(s,o)&&(!i.isNaN(a)||!i.isNaN(u)))return!1}return!0},Et.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(Et.copy(e,0,i,0,r),r>0)for(var s=r;s<n;s++)Et.copy(e,r-1,i,s,1);return i},Et.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)Et.swap(t,i,e-i)},Et.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},Et.copy=function(t,e,n,i,r){for(var s=0;s<r;s++)Et.copyCoord(t,e+s,n,i+s)},Et.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new w;i.append("(");for(var r=0;r<e;r++){r>0&&i.append(" ");for(var s=0;s<n;s++)s>0&&i.append(","),i.append(xt.toString(t.getOrdinate(r,s)))}return i.append(")"),i.toString()}},Et.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Et.createClosedRing(t,e,4):e.getOrdinate(0,b.X)===e.getOrdinate(n-1,b.X)&&e.getOrdinate(0,b.Y)===e.getOrdinate(n-1,b.Y)?e:Et.createClosedRing(t,e,n+1)},Et.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();Et.copy(e,0,i,0,r);for(var s=r;s<n;s++)Et.copy(e,0,i,s,1);return i},ro(It,F),io(It.prototype,{computeEnvelopeInternal:function(){return this.isEmpty()?new I:this.points.expandEnvelope(new I)},isRing:function(){return this.isClosed()&&this.isSimple()},getSortIndex:function(){return F.SORTINDEX_LINESTRING},getCoordinates:function(){return this.points.toCoordinateArray()},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this.points.size()!==n.points.size())return!1;for(var i=0;i<this.points.size();i++)if(!this.equal(this.points.getCoordinate(i),n.points.getCoordinate(i),e))return!1;return!0}return F.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<Math.trunc(this.points.size()/2);t++){var e=this.points.size()-1-t;if(!this.points.getCoordinate(t).equals(this.points.getCoordinate(e)))return this.points.getCoordinate(t).compareTo(this.points.getCoordinate(e))>0&&Et.reverse(this.points),null}},getCoordinate:function(){return this.isEmpty()?null:this.points.getCoordinate(0)},getBoundaryDimension:function(){return this.isClosed()?ot.FALSE:0},isClosed:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},getEndPoint:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},getDimension:function(){return 1},getLength:function(){return oe.computeLength(this.points)},getNumPoints:function(){return this.points.size()},reverse:function(){var t=this.points.copy();return Et.reverse(t),this.getFactory().createLineString(t)},compareToSameClass:function(){if(1===arguments.length){for(var t=arguments[0],e=t,n=0,i=0;n<this.points.size()&&i<e.points.size();){var r=this.points.getCoordinate(n).compareTo(e.points.getCoordinate(i));if(0!==r)return r;n++,i++}return n<this.points.size()?1:i<e.points.size()?-1:0}if(2===arguments.length){var s=arguments[0],o=arguments[1],e=s;return o.compare(this.points,e.points)}},apply:function(){if(oo(arguments[0],G))for(var t=arguments[0],e=0;e<this.points.size();e++)t.filter(this.points.getCoordinate(e));else if(oo(arguments[0],ut)){var n=arguments[0];if(0===this.points.size())return null;for(var e=0;e<this.points.size()&&(n.filter(this.points,e),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(oo(arguments[0],at)){var i=arguments[0];i.filter(this)}else if(oo(arguments[0],A)){var r=arguments[0];r.filter(this)}},getBoundary:function(){return new ct(this).getBoundary()},isEquivalentClass:function(t){return t instanceof It},clone:function(){var t=F.prototype.clone.call(this);return t.points=this.points.clone(),t},getCoordinateN:function(t){return this.points.getCoordinate(t)},getGeometryType:function(){return"LineString"},copy:function(){return new It(this.points.copy(),this.factory)},getCoordinateSequence:function(){return this.points},isEmpty:function(){return 0===this.points.size()},init:function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new n("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this.points=t},isCoordinate:function(t){for(var e=0;e<this.points.size();e++)if(this.points.getCoordinate(e).equals(t))return!0;return!1},getStartPoint:function(){return this.isEmpty()?null:this.getPointN(0)},getPointN:function(t){return this.getFactory().createPoint(this.points.getCoordinate(t))},interfaces_:function(){return[nt]},getClass:function(){return It}}),It.serialVersionUID=0x2b2b51ba435c8e00,io(Nt.prototype,{interfaces_:function(){return[]},getClass:function(){return Nt}}),ro(Ct,F),io(Ct.prototype,{computeEnvelopeInternal:function(){if(this.isEmpty())return new I;var t=new I;return t.expandToInclude(this.coordinates.getX(0),this.coordinates.getY(0)),t},getSortIndex:function(){return F.SORTINDEX_POINT},getCoordinates:function(){return this.isEmpty()?[]:[this.getCoordinate()]},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return F.prototype.equalsExact.apply(this,arguments)},normalize:function(){},getCoordinate:function(){return 0!==this.coordinates.size()?this.coordinates.getCoordinate(0):null},getBoundaryDimension:function(){return ot.FALSE},getDimension:function(){return 0},getNumPoints:function(){return this.isEmpty()?0:1},reverse:function(){return this.copy()},getX:function(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getCoordinate().compareTo(e.getCoordinate())}if(2===arguments.length){var n=arguments[0],i=arguments[1],e=n;return i.compare(this.coordinates,e.coordinates)}},apply:function(){if(oo(arguments[0],G)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(oo(arguments[0],ut)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this.coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else if(oo(arguments[0],at)){var n=arguments[0];n.filter(this)}else if(oo(arguments[0],A)){var i=arguments[0];i.filter(this)}},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},clone:function(){var t=F.prototype.clone.call(this);return t.coordinates=this.coordinates.clone(),t},getGeometryType:function(){return"Point"},copy:function(){return new Ct(this.coordinates.copy(),this.factory)},getCoordinateSequence:function(){return this.coordinates},getY:function(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y},isEmpty:function(){return 0===this.coordinates.size()},init:function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),h.isTrue(t.size()<=1),this.coordinates=t},isSimple:function(){return!0},interfaces_:function(){return[Nt]},getClass:function(){return Ct}}),Ct.serialVersionUID=0x44077bad161cbc00,io(St.prototype,{interfaces_:function(){return[]},getClass:function(){return St}}),ro(Lt,F),io(Lt.prototype,{computeEnvelopeInternal:function(){return this.shell.getEnvelopeInternal()},getSortIndex:function(){return F.SORTINDEX_POLYGON},getCoordinates:function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this.shell.getCoordinates(),i=0;i<n.length;i++)e++,t[e]=n[i];for(var r=0;r<this.holes.length;r++)for(var s=this.holes[r].getCoordinates(),o=0;o<s.length;o++)e++,t[e]=s[o];return t},getArea:function(){var t=0;t+=Math.abs(oe.signedArea(this.shell.getCoordinateSequence()));for(var e=0;e<this.holes.length;e++)t-=Math.abs(oe.signedArea(this.holes[e].getCoordinateSequence()));return t},isRectangle:function(){if(0!==this.getNumInteriorRing())return!1;if(null===this.shell)return!1;if(5!==this.shell.getNumPoints())return!1;for(var t=this.shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var s=t.getX(0),o=t.getY(0),n=1;n<=4;n++){var i=t.getX(n),r=t.getY(n);if(i!==s===(r!==o))return!1;s=i,o=r}return!0},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t,i=this.shell,r=n.shell;if(!i.equalsExact(r,e))return!1;if(this.holes.length!==n.holes.length)return!1;for(var s=0;s<this.holes.length;s++)if(!this.holes[s].equalsExact(n.holes[s],e))return!1;return!0}return F.prototype.equalsExact.apply(this,arguments)},normalize:function(){if(0===arguments.length){this.normalize(this.shell,!0);for(var t=0;t<this.holes.length;t++)this.normalize(this.holes[t],!1);st.sort(this.holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);_.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=Y.minCoordinate(e.getCoordinates());Y.scroll(i,r),_.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],oe.isCCW(e.getCoordinates())===n&&Y.reverse(e.getCoordinates())}},getCoordinate:function(){return this.shell.getCoordinate()},getNumInteriorRing:function(){return this.holes.length},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},getLength:function(){var t=0;t+=this.shell.getLength();for(var e=0;e<this.holes.length;e++)t+=this.holes[e].getLength();return t},getNumPoints:function(){for(var t=this.shell.getNumPoints(),e=0;e<this.holes.length;e++)t+=this.holes[e].getNumPoints();return t},reverse:function(){var t=this.copy();t.shell=this.shell.copy().reverse(),t.holes=new Array(this.holes.length).fill(null);for(var e=0;e<this.holes.length;e++)t.holes[e]=this.holes[e].copy().reverse();return t},convexHull:function(){return this.getExteriorRing().convexHull()},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=this.shell,n=t.shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[0],r=arguments[1],s=i,e=this.shell,n=s.shell,o=e.compareToSameClass(n,r);if(0!==o)return o;for(var a=this.getNumInteriorRing(),u=s.getNumInteriorRing(),l=0;l<a&&l<u;){var h=this.getInteriorRingN(l),c=s.getInteriorRingN(l),f=h.compareToSameClass(c,r);if(0!==f)return f;l++}return l<a?1:l<u?-1:0}},apply:function(){if(oo(arguments[0],G)){var t=arguments[0];this.shell.apply(t);for(var e=0;e<this.holes.length;e++)this.holes[e].apply(t)}else if(oo(arguments[0],ut)){var n=arguments[0];if(this.shell.apply(n),!n.isDone())for(var e=0;e<this.holes.length&&(this.holes[e].apply(n),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(oo(arguments[0],at)){var i=arguments[0];i.filter(this)}else if(oo(arguments[0],A)){var r=arguments[0];r.filter(this),this.shell.apply(r);for(var e=0;e<this.holes.length;e++)this.holes[e].apply(r)}},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this.holes.length+1).fill(null);t[0]=this.shell;for(var e=0;e<this.holes.length;e++)t[e+1]=this.holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},clone:function(){var t=F.prototype.clone.call(this);t.shell=this.shell.clone(),t.holes=new Array(this.holes.length).fill(null);for(var e=0;e<this.holes.length;e++)t.holes[e]=this.holes[e].clone();return t},getGeometryType:function(){return"Polygon"},copy:function(){for(var t=this.shell.copy(),e=new Array(this.holes.length).fill(null),n=0;n<e.length;n++)e[n]=this.holes[n].copy();return new Lt(t,e,this.factory)},getExteriorRing:function(){return this.shell},isEmpty:function(){return this.shell.isEmpty()},getInteriorRingN:function(t){return this.holes[t]},interfaces_:function(){return[St]},getClass:function(){return Lt}}),Lt.serialVersionUID=-0x307ffefd8dc97200,ro(wt,lt),io(wt.prototype,{getSortIndex:function(){return F.SORTINDEX_MULTIPOINT},isValid:function(){return!0},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&lt.prototype.equalsExact.call(this,t,e)}return lt.prototype.equalsExact.apply(this,arguments)},getCoordinate:function(){if(1===arguments.length){var t=arguments[0];return this.geometries[t].getCoordinate()}return lt.prototype.getCoordinate.apply(this,arguments)},getBoundaryDimension:function(){return ot.FALSE},getDimension:function(){return 0},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},getGeometryType:function(){return"MultiPoint"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new wt(t,this.factory)},interfaces_:function(){return[Nt]},getClass:function(){return wt}}),wt.serialVersionUID=-0x6fb1ed4162e0fc00,ro(Rt,It),io(Rt.prototype,{getSortIndex:function(){return F.SORTINDEX_LINEARRING},getBoundaryDimension:function(){return ot.FALSE},isClosed:function(){return!!this.isEmpty()||It.prototype.isClosed.call(this)},reverse:function(){var t=this.points.copy();return Et.reverse(t),this.getFactory().createLinearRing(t)},validateConstruction:function(){if(!this.isEmpty()&&!It.prototype.isClosed.call(this))throw new n("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<Rt.MINIMUM_VALID_SIZE)throw new n("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},getGeometryType:function(){return"LinearRing"},copy:function(){return new Rt(this.points.copy(),this.factory)},interfaces_:function(){return[]},getClass:function(){return Rt}}),Rt.MINIMUM_VALID_SIZE=4,Rt.serialVersionUID=-0x3b229e262367a600,ro(Tt,lt),io(Tt.prototype,{getSortIndex:function(){return F.SORTINDEX_MULTIPOLYGON},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&lt.prototype.equalsExact.call(this,t,e)}return lt.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[n]=this.geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new x,e=0;e<this.geometries.length;e++)for(var n=this.geometries[e],i=n.getBoundary(),r=0;r<i.getNumGeometries();r++)t.add(i.getGeometryN(r));var s=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(s))},getGeometryType:function(){return"MultiPolygon"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new Tt(t,this.factory)},interfaces_:function(){return[St]},getClass:function(){return Tt}}),Tt.serialVersionUID=-0x7a5aa1369171980,io(Ot.prototype,{setCopyUserData:function(t){this.isUserDataCopied=t},edit:function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this.isUserDataCopied&&n.setUserData(t.getUserData()),n},editInternal:function(t,e){return null===this.factory&&(this.factory=t.getFactory()),t instanceof lt?this.editGeometryCollection(t,e):t instanceof Lt?this.editPolygon(t,e):t instanceof Ct?e.edit(t,this.factory):t instanceof It?e.edit(t,this.factory):(h.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},editGeometryCollection:function(t,e){for(var n=e.edit(t,this.factory),i=new x,r=0;r<n.getNumGeometries();r++){var s=this.edit(n.getGeometryN(r),e);null===s||s.isEmpty()||i.add(s)}return n.getClass()===wt?this.factory.createMultiPoint(i.toArray([])):n.getClass()===ht?this.factory.createMultiLineString(i.toArray([])):n.getClass()===Tt?this.factory.createMultiPolygon(i.toArray([])):this.factory.createGeometryCollection(i.toArray([]))},editPolygon:function(t,e){var n=e.edit(t,this.factory);if(null===n&&(n=this.factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this.factory.createPolygon();for(var r=new x,s=0;s<n.getNumInteriorRing();s++){var o=this.edit(n.getInteriorRingN(s),e);null===o||o.isEmpty()||r.add(o)}return this.factory.createPolygon(i,r.toArray([]))},interfaces_:function(){return[]},getClass:function(){return Ot}}),Ot.GeometryEditorOperation=Pt,io(bt.prototype,{edit:function(t,e){return t},interfaces_:function(){return[Pt]},getClass:function(){return bt}}),io(_t.prototype,{edit:function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof Rt?e.createLinearRing(n):t instanceof It?e.createLineString(n):t instanceof Ct?n.length>0?e.createPoint(n[0]):e.createPoint():t},interfaces_:function(){return[Pt]},getClass:function(){return _t}}),io(Mt.prototype,{edit:function(t,e){return t instanceof Rt?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof It?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Ct?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},interfaces_:function(){return[Pt]},getClass:function(){return Mt}}),Ot.NoOpGeometryOperation=bt,Ot.CoordinateOperation=_t,Ot.CoordinateSequenceOperation=Mt,io(Dt.prototype,{setOrdinate:function(t,e,i){switch(e){case b.X:this.coordinates[t].x=i;break;case b.Y:this.coordinates[t].y=i;break;case b.Z:this.coordinates[t].z=i;break;default:throw new n("invalid ordinateIndex")}},size:function(){return this.coordinates.length},getOrdinate:function(t,e){switch(e){case b.X:return this.coordinates[t].x;case b.Y:return this.coordinates[t].y;case b.Z:return this.coordinates[t].z}return i.NaN},getCoordinate:function(){if(1===arguments.length){var t=arguments[0];return this.coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this.coordinates[e].x,n.y=this.coordinates[e].y,n.z=this.coordinates[e].z}},getCoordinateCopy:function(t){return new c(this.coordinates[t])},getDimension:function(){return this.dimension},getX:function(t){return this.coordinates[t].x},clone:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this.coordinates.length;e++)t[e]=this.coordinates[e].clone();return new Dt(t,this.dimension)},expandEnvelope:function(t){for(var e=0;e<this.coordinates.length;e++)t.expandToInclude(this.coordinates[e]);return t},copy:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this.coordinates.length;e++)t[e]=this.coordinates[e].copy();return new Dt(t,this.dimension)},toString:function(){if(this.coordinates.length>0){var t=new w(17*this.coordinates.length);t.append("("),t.append(this.coordinates[0]);for(var e=1;e<this.coordinates.length;e++)t.append(", "),t.append(this.coordinates[e]);return t.append(")"),t.toString()}return"()"},getY:function(t){return this.coordinates[t].y},toCoordinateArray:function(){return this.coordinates},interfaces_:function(){return[b,a]},getClass:function(){return Dt}}),Dt.serialVersionUID=-0xcb44a778db18e00,io(At.prototype,{readResolve:function(){return At.instance()},create:function(){if(1===arguments.length){if(arguments[0]instanceof Array){return new Dt(arguments[0])}if(oo(arguments[0],b)){return new Dt(arguments[0])}}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new Dt(t):new Dt(t,e)}},interfaces_:function(){return[D,a]},getClass:function(){return At}}),At.instance=function(){return At.instanceObject},At.serialVersionUID=-0x38e49fa6cf6f2e00,At.instanceObject=new At;var ho,co=Object.defineProperty,fo=function(t,e){function n(t){if(!this||this.constructor!==n)return new n(t);this._keys=[],this._values=[],this._itp=[],this.objectOnly=e,t&&Gt.call(this,t)}return e||co(t,"size",{get:jt}),t.constructor=n,n.prototype=t,n}({delete:qt,has:zt,get:Bt,set:kt,keys:Ut,values:Xt,entries:Ht,forEach:Kt,clear:Yt}),go="undefined"!=typeof Map&&Map.prototype.values?Map:fo;Zt.prototype=new H,Zt.prototype.get=function(t){return this.map_.get(t)||null},Zt.prototype.put=function(t,e){return this.map_.set(t,e),e},Zt.prototype.values=function(){for(var t=new x,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},Zt.prototype.entrySet=function(){var t=new K;return this.map_.entries().forEach(function(e){return t.add(e)}),t},Zt.prototype.size=function(){return this.map_.size()},io(Qt.prototype,{equals:function(t){if(!(t instanceof Qt))return!1;var e=t;return this.modelType===e.modelType&&this.scale===e.scale},compareTo:function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new R(n).compareTo(new R(i))},getScale:function(){return this.scale},isFloating:function(){return this.modelType===Qt.FLOATING||this.modelType===Qt.FLOATING_SINGLE},getType:function(){return this.modelType},toString:function(){var t="UNKNOWN";return this.modelType===Qt.FLOATING?t="Floating":this.modelType===Qt.FLOATING_SINGLE?t="Floating-Single":this.modelType===Qt.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},makePrecise:function(){if("number"==typeof arguments[0]){var t=arguments[0];if(i.isNaN(t))return t;if(this.modelType===Qt.FLOATING_SINGLE){return t}return this.modelType===Qt.FIXED?Math.round(t*this.scale)/this.scale:t}if(arguments[0]instanceof c){var e=arguments[0];if(this.modelType===Qt.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},getMaximumSignificantDigits:function(){var t=16;return this.modelType===Qt.FLOATING?t=16:this.modelType===Qt.FLOATING_SINGLE?t=6:this.modelType===Qt.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},setScale:function(t){this.scale=Math.abs(t)},interfaces_:function(){return[a,r]},getClass:function(){return Qt}}),Qt.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},io(Jt.prototype,{readResolve:function(){return Jt.nameToTypeMap.get(this.name)},toString:function(){return this.name},interfaces_:function(){return[a]},getClass:function(){return Jt}}),Jt.serialVersionUID=-552860263173159e4,Jt.nameToTypeMap=new Zt,Qt.Type=Jt,Qt.serialVersionUID=0x6bee6404e9a25c00,Qt.FIXED=new Jt("FIXED"),Qt.FLOATING=new Jt("FLOATING"),Qt.FLOATING_SINGLE=new Jt("FLOATING SINGLE"),Qt.maximumPreciseValue=9007199254740992,io($t.prototype,{toGeometry:function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new c(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new c(t.getMinX(),t.getMinY()),new c(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new c(t.getMinX(),t.getMinY()),new c(t.getMinX(),t.getMaxY()),new c(t.getMaxX(),t.getMaxY()),new c(t.getMaxX(),t.getMinY()),new c(t.getMinX(),t.getMinY())]),null)},createLineString:function(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(oo(arguments[0],b)){return new It(arguments[0],this)}}},createMultiLineString:function(){if(0===arguments.length)return new ht(null,this);if(1===arguments.length){return new ht(arguments[0],this)}},buildGeometry:function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var s=r.next(),o=s.getClass();null===e&&(e=o),o!==e&&(n=!0),s.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection($t.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof Lt)return this.createMultiPolygon($t.toPolygonArray(t));if(a instanceof It)return this.createMultiLineString($t.toLineStringArray(t));if(a instanceof Ct)return this.createMultiPoint($t.toPointArray(t));h.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},createMultiPointFromCoords:function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},createPoint:function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof c){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(oo(arguments[0],b)){return new Ct(arguments[0],this)}}},getCoordinateSequenceFactory:function(){return this.coordinateSequenceFactory},createPolygon:function(){if(0===arguments.length)return new Lt(null,null,this);if(1===arguments.length){if(oo(arguments[0],b)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Rt){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return new Lt(i,r,this)}},getSRID:function(){return this.SRID},createGeometryCollection:function(){if(0===arguments.length)return new lt(null,this);if(1===arguments.length){return new lt(arguments[0],this)}},createGeometry:function(t){return new Ot(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return arguments[1],this.coordinateSequenceFactory.create(t)}}})},getPrecisionModel:function(){return this.precisionModel},createLinearRing:function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(oo(arguments[0],b)){return new Rt(arguments[0],this)}}},createMultiPolygon:function(){if(0===arguments.length)return new Tt(null,this);if(1===arguments.length){return new Tt(arguments[0],this)}},createMultiPoint:function(){if(0===arguments.length)return new wt(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){return new wt(arguments[0],this)}if(arguments[0]instanceof Array){var t=arguments[0]
;return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(oo(arguments[0],b)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),i=0;i<e.size();i++){var r=this.getCoordinateSequenceFactory().create(1,e.getDimension());Et.copy(e,i,r,0,1),n[i]=this.createPoint(r)}return this.createMultiPoint(n)}}},interfaces_:function(){return[a]},getClass:function(){return $t}}),$t.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},$t.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},$t.getDefaultCoordinateSequenceFactory=function(){return At.instance()},$t.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},$t.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},$t.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},$t.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},$t.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},$t.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},$t.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},$t.serialVersionUID=-0x5ea75f2051eeb400;var po={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};io(te.prototype,{read:function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=po.typeStr.exec(t);if(-1!==t.search("EMPTY")&&(r=po.emptyTypeStr.exec(t),r[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],vo[n]&&(e=vo[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},write:function(t){return this.extractGeometry(t)},extractGeometry:function(t){var e=t.getGeometryType().toLowerCase();if(!mo[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+mo[e].apply(this,[t])+")"}});var mo={coordinate:function(t){return t.x+" "+t.y},point:function(t){return mo.coordinate.call(this,t.coordinates.coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t.geometries.length;n<i;++n)e.push("("+mo.point.apply(this,[t.geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t.points.coordinates.length;n<i;++n)e.push(mo.coordinate.apply(this,[t.points.coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t.points.coordinates.length;n<i;++n)e.push(mo.coordinate.apply(this,[t.points.coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t.geometries.length;n<i;++n)e.push("("+mo.linestring.apply(this,[t.geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+mo.linestring.apply(this,[t.shell])+")");for(var n=0,i=t.holes.length;n<i;++n)e.push("("+mo.linestring.apply(this,[t.holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t.geometries.length;n<i;++n)e.push("("+mo.polygon.apply(this,[t.geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t.geometries.length;n<i;++n)e.push(this.extractGeometry(t.geometries[n]));return e.join(",")}},vo={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(po.spaces);return this.geometryFactory.createPoint(new c(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,s=n.length;r<s;++r)e=n[r].replace(po.trimParens,"$1"),i.push(vo.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,s=n.length;r<s;++r)e=n[r].trim().split(po.spaces),i.push(new c(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,s=n.length;r<s;++r)e=n[r].trim().split(po.spaces),i.push(new c(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(po.parenComma),i=[],r=0,s=n.length;r<s;++r)e=n[r].replace(po.trimParens,"$1"),i.push(vo.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,s=t.trim().split(po.parenComma),o=[],a=0,u=s.length;a<u;++a)e=s[a].replace(po.trimParens,"$1"),n=vo.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n.points),0===a?r=i:o.push(i);return this.geometryFactory.createPolygon(r,o)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(po.doubleParenComma),i=[],r=0,s=n.length;r<s;++r)e=n[r].replace(po.trimParens,"$1"),i.push(vo.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var e=t.trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}};io(ee.prototype,{write:function(t){return this.parser.write(t)}}),io(ee,{toLineString:function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}),io(ne.prototype,{getIndexAlongSegment:function(t,e){return this.computeIntLineIndex(),this.intLineIndex[t][e]},getTopologySummary:function(){var t=new w;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},computeIntersection:function(t,e,n,i){this.inputLines[0][0]=t,this.inputLines[0][1]=e,this.inputLines[1][0]=n,this.inputLines[1][1]=i,this.result=this.computeIntersect(t,e,n,i)},getIntersectionNum:function(){return this.result},computeIntLineIndex:function(){if(0===arguments.length)null===this.intLineIndex&&(this.intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0],e=this.getEdgeDistance(t,0),n=this.getEdgeDistance(t,1);e>n?(this.intLineIndex[t][0]=0,this.intLineIndex[t][1]=1):(this.intLineIndex[t][0]=1,this.intLineIndex[t][1]=0)}},isProper:function(){return this.hasIntersection()&&this._isProper},setPrecisionModel:function(t){this.precisionModel=t},isInteriorIntersection:function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this.result;e++)if(!this.intPt[e].equals2D(this.inputLines[t][0])&&!this.intPt[e].equals2D(this.inputLines[t][1]))return!0;return!1}},getIntersection:function(t){return this.intPt[t]},isEndPoint:function(){return this.hasIntersection()&&!this._isProper},hasIntersection:function(){return this.result!==ne.NO_INTERSECTION},getEdgeDistance:function(t,e){return ne.computeEdgeDistance(this.intPt[e],this.inputLines[t][0],this.inputLines[t][1])},isCollinear:function(){return this.result===ne.COLLINEAR_INTERSECTION},toString:function(){return ee.toLineString(this.inputLines[0][0],this.inputLines[0][1])+" - "+ee.toLineString(this.inputLines[1][0],this.inputLines[1][1])+this.getTopologySummary()},getEndpoint:function(t,e){return this.inputLines[t][e]},isIntersection:function(t){for(var e=0;e<this.result;e++)if(this.intPt[e].equals2D(t))return!0;return!1},getIntersectionAlongSegment:function(t,e){return this.computeIntLineIndex(),this.intPt[this.intLineIndex[t][e]]},interfaces_:function(){return[]},getClass:function(){return ne}}),ne.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),s=-1;if(t.equals(e))s=0;else if(t.equals(n))s=i>r?i:r;else{var o=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);s=i>r?o:a,0!==s||t.equals(e)||(s=Math.max(o,a))}return h.isTrue(!(0===s&&!t.equals(e)),"Bad distance calculation"),s},ne.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,s=Math.sqrt(i*i+r*r);return h.isTrue(!(0===s&&!t.equals(e)),"Invalid distance calculation"),s},ne.DONT_INTERSECT=0,ne.DO_INTERSECT=1,ne.COLLINEAR=2,ne.NO_INTERSECTION=0,ne.POINT_INTERSECTION=1,ne.COLLINEAR_INTERSECTION=2,ro(ie,ne),io(ie.prototype,{isInSegmentEnvelopes:function(t){var e=new I(this.inputLines[0][0],this.inputLines[0][1]),n=new I(this.inputLines[1][0],this.inputLines[1][1]);return e.contains(t)&&n.contains(t)},computeIntersection:function(){if(3!==arguments.length)return ne.prototype.computeIntersection.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2];if(this._isProper=!1,I.intersects(e,n,t)&&0===oe.orientationIndex(e,n,t)&&0===oe.orientationIndex(n,e,t))return this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this.result=ne.POINT_INTERSECTION,null;this.result=ne.NO_INTERSECTION},normalizeToMinimum:function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},safeHCoordinateIntersection:function(t,e,n,i){var r=null;try{r=M.intersection(t,e,n,i)}catch(s){if(!(s instanceof C))throw s;r=ie.nearestEndpoint(t,e,n,i)}return r},intersection:function(t,e,n,i){var r=this.intersectionWithNormalization(t,e,n,i);return this.isInSegmentEnvelopes(r)||(r=new c(ie.nearestEndpoint(t,e,n,i))),null!==this.precisionModel&&this.precisionModel.makePrecise(r),r},smallestInAbsValue:function(t,e,n,i){var r=t,s=Math.abs(r);return Math.abs(e)<s&&(r=e,s=Math.abs(e)),Math.abs(n)<s&&(r=n,s=Math.abs(n)),Math.abs(i)<s&&(r=i),r},checkDD:function(t,e,n,i,r){var s=P.intersection(t,e,n,i),o=this.isInSegmentEnvelopes(s);_.out.println("DD in env = "+o+"  --------------------- "+s),r.distance(s)>1e-4&&_.out.println("Distance = "+r.distance(s))},intersectionWithNormalization:function(t,e,n,i){var r=new c(t),s=new c(e),o=new c(n),a=new c(i),u=new c;this.normalizeToEnvCentre(r,s,o,a,u);var l=this.safeHCoordinateIntersection(r,s,o,a);return l.x+=u.x,l.y+=u.y,l},computeCollinearIntersection:function(t,e,n,i){var r=I.intersects(t,e,n),s=I.intersects(t,e,i),o=I.intersects(n,i,t),a=I.intersects(n,i,e);return r&&s?(this.intPt[0]=n,this.intPt[1]=i,ne.COLLINEAR_INTERSECTION):o&&a?(this.intPt[0]=t,this.intPt[1]=e,ne.COLLINEAR_INTERSECTION):r&&o?(this.intPt[0]=n,this.intPt[1]=t,!n.equals(t)||s||a?ne.COLLINEAR_INTERSECTION:ne.POINT_INTERSECTION):r&&a?(this.intPt[0]=n,this.intPt[1]=e,!n.equals(e)||s||o?ne.COLLINEAR_INTERSECTION:ne.POINT_INTERSECTION):s&&o?(this.intPt[0]=i,this.intPt[1]=t,!i.equals(t)||r||a?ne.COLLINEAR_INTERSECTION:ne.POINT_INTERSECTION):s&&a?(this.intPt[0]=i,this.intPt[1]=e,!i.equals(e)||r||o?ne.COLLINEAR_INTERSECTION:ne.POINT_INTERSECTION):ne.NO_INTERSECTION},normalizeToEnvCentre:function(t,e,n,i,r){var s=t.x<e.x?t.x:e.x,o=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,u=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,h=n.y<i.y?n.y:i.y,c=n.x>i.x?n.x:i.x,f=n.y>i.y?n.y:i.y,g=s>l?s:l,d=a<c?a:c,p=o>h?o:h,m=u<f?u:f,v=(g+d)/2,y=(p+m)/2;r.x=v,r.y=y,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},computeIntersect:function(t,e,n,i){if(this._isProper=!1,!I.intersects(t,e,n,i))return ne.NO_INTERSECTION;var r=oe.orientationIndex(t,e,n),s=oe.orientationIndex(t,e,i);if(r>0&&s>0||r<0&&s<0)return ne.NO_INTERSECTION;var o=oe.orientationIndex(n,i,t),a=oe.orientationIndex(n,i,e);return o>0&&a>0||o<0&&a<0?ne.NO_INTERSECTION:0===r&&0===s&&0===o&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===s||0===o||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this.intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this.intPt[0]=e:0===r?this.intPt[0]=new c(n):0===s?this.intPt[0]=new c(i):0===o?this.intPt[0]=new c(t):0===a&&(this.intPt[0]=new c(e))):(this._isProper=!0,this.intPt[0]=this.intersection(t,e,n,i)),ne.POINT_INTERSECTION)},interfaces_:function(){return[]},getClass:function(){return ie}}),ie.nearestEndpoint=function(t,e,n,i){var r=t,s=oe.distancePointLine(t,n,i),o=oe.distancePointLine(e,n,i);return o<s&&(s=o,r=e),o=oe.distancePointLine(n,t,e),o<s&&(s=o,r=n),o=oe.distancePointLine(i,t,e),o<s&&(s=o,r=i),r},io(re.prototype,{interfaces_:function(){return[]},getClass:function(){return re}}),re.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,s=n.x-e.x,o=n.y-e.y;return re.signOfDet2x2(i,r,s,o)},re.signOfDet2x2=function(t,e,n,i){var r=null,s=null,o=null,a=0;if(r=1,0===t||0===i)return 0===e||0===n?0:e>0?n>0?-r:r:n>0?r:-r;if(0===e||0===n)return i>0?t>0?r:-r:t>0?-r:r;if(0<e?0<i?e<=i||(r=-r,s=t,t=n,n=s,s=e,e=i,i=s):e<=-i?(r=-r,n=-n,i=-i):(s=t,t=-n,n=s,s=e,e=-i,i=s):0<i?-e<=i?(r=-r,t=-t,e=-e):(s=-t,t=n,n=s,s=-e,e=i,i=s):e>=i?(t=-t,e=-e,n=-n,i=-i):(r=-r,s=-t,t=-n,n=s,s=-e,e=-i,i=s),0<t){if(!(0<n))return r;if(!(t<=n))return r}else{if(0<n)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if(a+=1,o=Math.floor(n/t),n-=o*t,(i-=o*e)<0)return-r;if(i>e)return r;if(t>n+n){if(e<i+i)return r}else{if(e>i+i)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if(o=Math.floor(t/n),t-=o*n,(e-=o*i)<0)return r;if(e>i)return-r;if(n>t+t){if(i<e+e)return-r}else{if(i>e+e)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}},io(se.prototype,{countSegment:function(t,e){if(t.x<this.p.x&&e.x<this.p.x)return null;if(this.p.x===e.x&&this.p.y===e.y)return this.isPointOnSegment=!0,null;if(t.y===this.p.y&&e.y===this.p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this.p.x>=n&&this.p.x<=i&&(this.isPointOnSegment=!0),null}if(t.y>this.p.y&&e.y<=this.p.y||e.y>this.p.y&&t.y<=this.p.y){var r=t.x-this.p.x,s=t.y-this.p.y,o=e.x-this.p.x,a=e.y-this.p.y,u=re.signOfDet2x2(r,s,o,a);if(0===u)return this.isPointOnSegment=!0,null;a<s&&(u=-u),u>0&&this.crossingCount++}},isPointInPolygon:function(){return this.getLocation()!==S.EXTERIOR},getLocation:function(){return this.isPointOnSegment?S.BOUNDARY:this.crossingCount%2==1?S.INTERIOR:S.EXTERIOR},isOnSegment:function(){return this.isPointOnSegment},interfaces_:function(){return[]},getClass:function(){return se}}),se.locatePointInRing=function(){if(arguments[0]instanceof c&&oo(arguments[1],b)){for(var t=arguments[0],e=arguments[1],n=new se(t),i=new c,r=new c,s=1;s<e.size();s++)if(e.getCoordinate(s,i),e.getCoordinate(s-1,r),n.countSegment(i,r),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof c&&arguments[1]instanceof Array){for(var o=arguments[0],a=arguments[1],n=new se(o),s=1;s<a.length;s++){var i=a[s],r=a[s-1];if(n.countSegment(i,r),n.isOnSegment())return n.getLocation()}return n.getLocation()}},io(oe.prototype,{interfaces_:function(){return[]},getClass:function(){return oe}}),oe.orientationIndex=function(t,e,n){return P.orientationIndex(t,e,n)},oe.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,s=t[i+1].y;e+=r*(t[i-1].y-s)}return e/2}if(oo(arguments[0],b)){var o=arguments[0],a=o.size();if(a<3)return 0;var u=new c,l=new c,h=new c;o.getCoordinate(0,l),o.getCoordinate(1,h);var n=l.x;h.x-=n;for(var e=0,i=1;i<a-1;i++)u.y=l.y,l.x=h.x,l.y=h.y,o.getCoordinate(i+1,h),h.x-=n,e+=l.x*(u.y-h.y);return e/2}},oe.distanceLineLine=function(t,e,n,i){if(t.equals(e))return oe.distancePointLine(t,n,i);if(n.equals(i))return oe.distancePointLine(i,t,e);var r=!1;if(I.intersects(t,e,n,i)){var s=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===s)r=!0;else{var o=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=(t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y),u=a/s,l=o/s;(l<0||l>1||u<0||u>1)&&(r=!0)}}else r=!0;return r?L.min(oe.distancePointLine(t,n,i),oe.distancePointLine(e,n,i),oe.distancePointLine(n,t,e),oe.distancePointLine(i,t,e)):0},oe.isPointInRing=function(t,e){return oe.locatePointInRing(t,e)!==S.EXTERIOR},oe.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new c;t.getCoordinate(0,i);for(var r=i.x,s=i.y,o=1;o<e;o++){t.getCoordinate(o,i);var a=i.x,u=i.y,l=a-r,h=u-s;n+=Math.sqrt(l*l+h*h),r=a,s=u}return n},oe.isCCW=function(t){var e=t.length-1;if(e<3)throw new n("Ring has fewer than 4 points, so orientation cannot be determined");for(var i=t[0],r=0,s=1;s<=e;s++){var o=t[s];o.y>i.y&&(i=o,r=s)}var a=r;do{(a-=1)<0&&(a=e)}while(t[a].equals2D(i)&&a!==r);var u=r;do{u=(u+1)%e}while(t[u].equals2D(i)&&u!==r);var l=t[a],h=t[u];if(l.equals2D(i)||h.equals2D(i)||l.equals2D(h))return!1;var c=oe.computeOrientation(l,i,h);return 0===c?l.x>h.x:c>0},oe.locatePointInRing=function(t,e){return se.locatePointInRing(t,e)},oe.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},oe.computeOrientation=function(t,e,n){return oe.orientationIndex(t,e,n)},oe.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new n("Line array must contain at least one vertex");for(var i=t.distance(e[0]),r=0;r<e.length-1;r++){var s=oe.distancePointLine(t,e[r],e[r+1]);s<i&&(i=s)}return i}if(3===arguments.length){var o=arguments[0],a=arguments[1],u=arguments[2];if(a.x===u.x&&a.y===u.y)return o.distance(a);var l=(u.x-a.x)*(u.x-a.x)+(u.y-a.y)*(u.y-a.y),h=((o.x-a.x)*(u.x-a.x)+(o.y-a.y)*(u.y-a.y))/l;if(h<=0)return o.distance(a);if(h>=1)return o.distance(u);var c=((a.y-o.y)*(u.x-a.x)-(a.x-o.x)*(u.y-a.y))/l;return Math.abs(c)*Math.sqrt(l)}},oe.isOnLine=function(t,e){for(var n=new ie,i=1;i<e.length;i++){var r=e[i-1],s=e[i];if(n.computeIntersection(t,r,s),n.hasIntersection())return!0}return!1},oe.CLOCKWISE=-1,oe.RIGHT=oe.CLOCKWISE,oe.COUNTERCLOCKWISE=1,oe.LEFT=oe.COUNTERCLOCKWISE,oe.COLLINEAR=0,oe.STRAIGHT=oe.COLLINEAR,io(ae.prototype,{minX:function(){return Math.min(this.p0.x,this.p1.x)},orientationIndex:function(){if(arguments[0]instanceof ae){var t=arguments[0],e=oe.orientationIndex(this.p0,this.p1,t.p0),n=oe.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0?Math.max(e,n):e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof c){var i=arguments[0];return oe.orientationIndex(this.p0,this.p1,i)}},toGeometry:function(t){return t.createLineString([this.p0,this.p1])},isVertical:function(){return this.p0.x===this.p1.x},equals:function(t){if(!(t instanceof ae))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},intersection:function(t){var e=new ie;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},project:function(){if(arguments[0]instanceof c){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new c(t);var e=this.projectionFactor(t),n=new c;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof ae){var i=arguments[0],r=this.projectionFactor(i.p0),s=this.projectionFactor(i.p1);if(r>=1&&s>=1)return null;if(r<=0&&s<=0)return null;var o=this.project(i.p0);r<0&&(o=this.p0),r>1&&(o=this.p1);var a=this.project(i.p1);return s<0&&(a=this.p0),s>1&&(a=this.p1),new ae(o,a)}},normalize:function(){this.p1.compareTo(this.p0)<0&&this.reverse()},angle:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},getCoordinate:function(t){return 0===t?this.p0:this.p1},distancePerpendicular:function(t){return oe.distancePointLinePerpendicular(t,this.p0,this.p1)},minY:function(){return Math.min(this.p0.y,this.p1.y)},midPoint:function(){return ae.midPoint(this.p0,this.p1)},projectionFactor:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,r=e*e+n*n;return r<=0?i.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/r},closestPoints:function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),r=i.MAX_VALUE,s=null,o=this.closestPoint(t.p0);r=o.distance(t.p0),n[0]=o,n[1]=t.p0;var a=this.closestPoint(t.p1);(s=a.distance(t.p1))<r&&(r=s,n[0]=a,n[1]=t.p1);var u=t.closestPoint(this.p0);(s=u.distance(this.p0))<r&&(r=s,n[0]=this.p0,n[1]=u);var l=t.closestPoint(this.p1);return s=l.distance(this.p1),s<r&&(r=s,n[0]=this.p1,n[1]=l),n},closestPoint:function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},maxX:function(){return Math.max(this.p0.x,this.p1.x)},getLength:function(){return this.p0.distance(this.p1)},compareTo:function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},reverse:function(){var t=this.p0;this.p0=this.p1,this.p1=t},equalsTopo:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)},lineIntersection:function(t){try{return M.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof C))throw t}return null},maxY:function(){return Math.max(this.p0.y,this.p1.y)},pointAlongOffset:function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,o=Math.sqrt(r*r+s*s),a=0,u=0;if(0!==e){if(o<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");a=e*r/o,u=e*s/o}return new c(n-u,i+a)},setCoordinates:function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},segmentFraction:function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||i.isNaN(e))&&(e=1),e},toString:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},isHorizontal:function(){return this.p0.y===this.p1.y},distance:function(){if(arguments[0]instanceof ae){var t=arguments[0];return oe.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof c){var e=arguments[0];return oe.distancePointLine(e,this.p0,this.p1)}},pointAlong:function(t){var e=new c;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},hashCode:function(){var t=java.lang.Double.doubleToLongBits(this.p0.x);t^=31*java.lang.Double.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=java.lang.Double.doubleToLongBits(this.p1.x);return n^=31*java.lang.Double.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},interfaces_:function(){return[r,a]},getClass:function(){return ae}}),ae.midPoint=function(t,e){return new c((t.x+e.x)/2,(t.y+e.y)/2)},ae.serialVersionUID=0x2d2172135f411c00,io(ue.prototype,{isIntersects:function(){return!this.isDisjoint()},isCovers:function(){return(ue.isTrue(this.matrix[S.INTERIOR][S.INTERIOR])||ue.isTrue(this.matrix[S.INTERIOR][S.BOUNDARY])||ue.isTrue(this.matrix[S.BOUNDARY][S.INTERIOR])||ue.isTrue(this.matrix[S.BOUNDARY][S.BOUNDARY]))&&this.matrix[S.EXTERIOR][S.INTERIOR]===ot.FALSE&&this.matrix[S.EXTERIOR][S.BOUNDARY]===ot.FALSE},isCoveredBy:function(){return(ue.isTrue(this.matrix[S.INTERIOR][S.INTERIOR])||ue.isTrue(this.matrix[S.INTERIOR][S.BOUNDARY])||ue.isTrue(this.matrix[S.BOUNDARY][S.INTERIOR])||ue.isTrue(this.matrix[S.BOUNDARY][S.BOUNDARY]))&&this.matrix[S.INTERIOR][S.EXTERIOR]===ot.FALSE&&this.matrix[S.BOUNDARY][S.EXTERIOR]===ot.FALSE},set:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this.matrix[n][i]=ot.toDimensionValue(t.charAt(e))}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.matrix[r][s]=o}},isContains:function(){return ue.isTrue(this.matrix[S.INTERIOR][S.INTERIOR])&&this.matrix[S.EXTERIOR][S.INTERIOR]===ot.FALSE&&this.matrix[S.EXTERIOR][S.BOUNDARY]===ot.FALSE},setAtLeast:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this.setAtLeast(n,i,ot.toDimensionValue(t.charAt(e)))}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.matrix[r][s]<o&&(this.matrix[r][s]=o)}},setAtLeastIfValid:function(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)},isWithin:function(){return ue.isTrue(this.matrix[S.INTERIOR][S.INTERIOR])&&this.matrix[S.INTERIOR][S.EXTERIOR]===ot.FALSE&&this.matrix[S.BOUNDARY][S.EXTERIOR]===ot.FALSE},isTouches:function(t,e){return t>e?this.isTouches(e,t):(t===ot.A&&e===ot.A||t===ot.L&&e===ot.L||t===ot.L&&e===ot.A||t===ot.P&&e===ot.A||t===ot.P&&e===ot.L)&&(this.matrix[S.INTERIOR][S.INTERIOR]===ot.FALSE&&(ue.isTrue(this.matrix[S.INTERIOR][S.BOUNDARY])||ue.isTrue(this.matrix[S.BOUNDARY][S.INTERIOR])||ue.isTrue(this.matrix[S.BOUNDARY][S.BOUNDARY])))},isOverlaps:function(t,e){return t===ot.P&&e===ot.P||t===ot.A&&e===ot.A?ue.isTrue(this.matrix[S.INTERIOR][S.INTERIOR])&&ue.isTrue(this.matrix[S.INTERIOR][S.EXTERIOR])&&ue.isTrue(this.matrix[S.EXTERIOR][S.INTERIOR]):t===ot.L&&e===ot.L&&(1===this.matrix[S.INTERIOR][S.INTERIOR]&&ue.isTrue(this.matrix[S.INTERIOR][S.EXTERIOR])&&ue.isTrue(this.matrix[S.EXTERIOR][S.INTERIOR]))},isEquals:function(t,e){return t===e&&(ue.isTrue(this.matrix[S.INTERIOR][S.INTERIOR])&&this.matrix[S.INTERIOR][S.EXTERIOR]===ot.FALSE&&this.matrix[S.BOUNDARY][S.EXTERIOR]===ot.FALSE&&this.matrix[S.EXTERIOR][S.INTERIOR]===ot.FALSE&&this.matrix[S.EXTERIOR][S.BOUNDARY]===ot.FALSE)},toString:function(){for(var t=new w("123456789"),e=0;e<3;e++)for(var n=0;n<3;n++)t.setCharAt(3*e+n,ot.toDimensionSymbol(this.matrix[e][n]));return t.toString()},setAll:function(t){for(var e=0;e<3;e++)for(var n=0;n<3;n++)this.matrix[e][n]=t},get:function(t,e){return this.matrix[t][e]},transpose:function(){var t=this.matrix[1][0];return this.matrix[1][0]=this.matrix[0][1],this.matrix[0][1]=t,t=this.matrix[2][0],this.matrix[2][0]=this.matrix[0][2],this.matrix[0][2]=t,t=this.matrix[2][1],this.matrix[2][1]=this.matrix[1][2],this.matrix[1][2]=t,this},matches:function(t){if(9!==t.length)throw new n("Should be length 9: "+t);for(var e=0;e<3;e++)for(var i=0;i<3;i++)if(!ue.matches(this.matrix[e][i],t.charAt(3*e+i)))return!1;return!0},add:function(t){for(var e=0;e<3;e++)for(var n=0;n<3;n++)this.setAtLeast(e,n,t.get(e,n))},isDisjoint:function(){return this.matrix[S.INTERIOR][S.INTERIOR]===ot.FALSE&&this.matrix[S.INTERIOR][S.BOUNDARY]===ot.FALSE&&this.matrix[S.BOUNDARY][S.INTERIOR]===ot.FALSE&&this.matrix[S.BOUNDARY][S.BOUNDARY]===ot.FALSE},isCrosses:function(t,e){return t===ot.P&&e===ot.L||t===ot.P&&e===ot.A||t===ot.L&&e===ot.A?ue.isTrue(this.matrix[S.INTERIOR][S.INTERIOR])&&ue.isTrue(this.matrix[S.INTERIOR][S.EXTERIOR]):t===ot.L&&e===ot.P||t===ot.A&&e===ot.P||t===ot.A&&e===ot.L?ue.isTrue(this.matrix[S.INTERIOR][S.INTERIOR])&&ue.isTrue(this.matrix[S.EXTERIOR][S.INTERIOR]):t===ot.L&&e===ot.L&&0===this.matrix[S.INTERIOR][S.INTERIOR]},interfaces_:function(){return[s]},getClass:function(){return ue}}),ue.matches=function(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){var t=arguments[0],e=arguments[1];return e===ot.SYM_DONTCARE||(e===ot.SYM_TRUE&&(t>=0||t===ot.TRUE)||(e===ot.SYM_FALSE&&t===ot.FALSE||(e===ot.SYM_P&&t===ot.P||(e===ot.SYM_L&&t===ot.L||e===ot.SYM_A&&t===ot.A))))}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){var n=arguments[0],i=arguments[1];return new ue(n).matches(i)}},ue.isTrue=function(t){return t>=0||t===ot.TRUE};var yo=Object.freeze({Coordinate:c,CoordinateList:E,Envelope:I,LineSegment:ae,GeometryFactory:$t,Geometry:F,Point:Ct,LineString:It,LinearRing:Rt,Polygon:Lt,GeometryCollection:lt,MultiPoint:wt,MultiLineString:ht,MultiPolygon:Tt,Dimension:ot,IntersectionMatrix:ue,PrecisionModel:Qt});io(le.prototype,{addPoint:function(t){this.ptCount+=1,this.ptCentSum.x+=t.x,this.ptCentSum.y+=t.y},setBasePoint:function(t){null===this.areaBasePt&&(this.areaBasePt=t)},addLineSegments:function(t){for(var e=0,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);if(0!==i){e+=i;var r=(t[n].x+t[n+1].x)/2;this.lineCentSum.x+=i*r;var s=(t[n].y+t[n+1].y)/2;this.lineCentSum.y+=i*s}}this.totalLength+=e,0===e&&t.length>0&&this.addPoint(t[0])},addHole:function(t){for(var e=oe.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},getCentroid:function(){var t=new c;if(Math.abs(this.areasum2)>0)t.x=this.cg3.x/3/this.areasum2,t.y=this.cg3.y/3/this.areasum2;else if(this.totalLength>0)t.x=this.lineCentSum.x/this.totalLength,t.y=this.lineCentSum.y/this.totalLength;else{if(!(this.ptCount>0))return null;t.x=this.ptCentSum.x/this.ptCount,t.y=this.ptCentSum.y/this.ptCount}return t},addShell:function(t){t.length>0&&this.setBasePoint(t[0]);for(var e=!oe.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},addTriangle:function(t,e,n,i){var r=i?1:-1;le.centroid3(t,e,n,this.triangleCent3);var s=le.area2(t,e,n);this.cg3.x+=r*s*this.triangleCent3.x,this.cg3.y+=r*s*this.triangleCent3.y,this.areasum2+=r*s},add:function(){if(arguments[0]instanceof Lt){var t=arguments[0];this.addShell(t.getExteriorRing().getCoordinates());for(var e=0;e<t.getNumInteriorRing();e++)this.addHole(t.getInteriorRingN(e).getCoordinates())}else if(arguments[0]instanceof F){var n=arguments[0];if(n.isEmpty())return null;if(n instanceof Ct)this.addPoint(n.getCoordinate());else if(n instanceof It)this.addLineSegments(n.getCoordinates());else if(n instanceof Lt){var i=n;this.add(i)}else if(n instanceof lt)for(var r=n,e=0;e<r.getNumGeometries();e++)this.add(r.getGeometryN(e))}},interfaces_:function(){return[]},getClass:function(){return le}}),le.area2=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)},le.centroid3=function(t,e,n,i){return i.x=t.x+e.x+n.x,i.y=t.y+e.y+n.y,null},le.getCentroid=function(t){return new le(t).getCentroid()},he.prototype=new Error,he.prototype.name="EmptyStackException",ce.prototype=new m,ce.prototype.add=function(t){return this.array_.push(t),!0},ce.prototype.get=function(t){if(t<0||t>=this.size())throw new IndexOutOfBoundsException;return this.array_[t]},ce.prototype.push=function(t){return this.array_.push(t),t},ce.prototype.pop=function(t){if(0===this.array_.length)throw new he;return this.array_.pop()},ce.prototype.peek=function(){if(0===this.array_.length)throw new he;return this.array_[this.array_.length-1]},ce.prototype.empty=function(){return 0===this.array_.length},ce.prototype.isEmpty=function(){return this.empty()},ce.prototype.search=function(t){return this.array_.indexOf(t)},ce.prototype.size=function(){return this.array_.length},ce.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},io(fe.prototype,{filter:function(t){this.treeSet.contains(t)||(this.list.add(t),this.treeSet.add(t))},getCoordinates:function(){var t=new Array(this.list.size()).fill(null);return this.list.toArray(t)},interfaces_:function(){return[G]},getClass:function(){return fe}}),fe.filterCoordinates=function(t){for(var e=new fe,n=0;n<t.length;n++)e.filter(t[n]);return e.getCoordinates()},io(ge.prototype,{preSort:function(t){for(var e=null,n=1;n<t.length;n++)(t[n].y<t[0].y||t[n].y===t[0].y&&t[n].x<t[0].x)&&(e=t[0],t[0]=t[n],t[n]=e);return st.sort(t,1,t.length,new de(t[0])),t},computeOctRing:function(t){var e=this.computeOctPts(t),n=new E;return n.add(e,!1),n.size()<3?null:(n.closeRing(),n.toCoordinateArray())},lineOrPolygon:function(t){if(t=this.cleanRing(t),3===t.length)return this.geomFactory.createLineString([t[0],t[1]]);var e=this.geomFactory.createLinearRing(t);return this.geomFactory.createPolygon(e,null)},cleanRing:function(t){h.equals(t[0],t[t.length-1]);for(var e=new x,n=null,i=0;i<=t.length-2;i++){var r=t[i],s=t[i+1];r.equals(s)||(null!==n&&this.isBetween(n,r,s)||(e.add(r),n=r))}e.add(t[t.length-1]);var o=new Array(e.size()).fill(null);return e.toArray(o)},isBetween:function(t,e,n){if(0!==oe.computeOrientation(t,e,n))return!1;if(t.x!==n.x){
if(t.x<=e.x&&e.x<=n.x)return!0;if(n.x<=e.x&&e.x<=t.x)return!0}if(t.y!==n.y){if(t.y<=e.y&&e.y<=n.y)return!0;if(n.y<=e.y&&e.y<=t.y)return!0}return!1},reduce:function(t){var e=this.computeOctRing(t);if(null===e)return t;for(var n=new rt,i=0;i<e.length;i++)n.add(e[i]);for(var i=0;i<t.length;i++)oe.isPointInRing(t[i],e)||n.add(t[i]);var r=Y.toCoordinateArray(n);return r.length<3?this.padArray3(r):r},getConvexHull:function(){if(0===this.inputPts.length)return this.geomFactory.createGeometryCollection(null);if(1===this.inputPts.length)return this.geomFactory.createPoint(this.inputPts[0]);if(2===this.inputPts.length)return this.geomFactory.createLineString(this.inputPts);var t=this.inputPts;this.inputPts.length>50&&(t=this.reduce(this.inputPts));var e=this.preSort(t),n=this.grahamScan(e),i=this.toCoordinateArray(n);return this.lineOrPolygon(i)},padArray3:function(t){for(var e=new Array(3).fill(null),n=0;n<e.length;n++)n<t.length?e[n]=t[n]:e[n]=t[0];return e},computeOctPts:function(t){for(var e=new Array(8).fill(null),n=0;n<e.length;n++)e[n]=t[0];for(var i=1;i<t.length;i++)t[i].x<e[0].x&&(e[0]=t[i]),t[i].x-t[i].y<e[1].x-e[1].y&&(e[1]=t[i]),t[i].y>e[2].y&&(e[2]=t[i]),t[i].x+t[i].y>e[3].x+e[3].y&&(e[3]=t[i]),t[i].x>e[4].x&&(e[4]=t[i]),t[i].x-t[i].y>e[5].x-e[5].y&&(e[5]=t[i]),t[i].y<e[6].y&&(e[6]=t[i]),t[i].x+t[i].y<e[7].x+e[7].y&&(e[7]=t[i]);return e},toCoordinateArray:function(t){for(var e=new Array(t.size()).fill(null),n=0;n<t.size();n++){var i=t.get(n);e[n]=i}return e},grahamScan:function(t){var e=null,n=new ce;e=n.push(t[0]),e=n.push(t[1]),e=n.push(t[2]);for(var i=3;i<t.length;i++){for(e=n.pop();!n.empty()&&oe.computeOrientation(n.peek(),e,t[i])>0;)e=n.pop();e=n.push(e),e=n.push(t[i])}return e=n.push(t[0]),n},interfaces_:function(){return[]},getClass:function(){return ge}}),ge.extractCoordinates=function(t){var e=new fe;return t.apply(e),e.getCoordinates()},io(de.prototype,{compare:function(t,e){var n=t,i=e;return de.polarCompare(this.origin,n,i)},interfaces_:function(){return[o]},getClass:function(){return de}}),de.polarCompare=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,s=n.x-t.x,o=n.y-t.y,a=oe.computeOrientation(t,e,n);if(a===oe.COUNTERCLOCKWISE)return 1;if(a===oe.CLOCKWISE)return-1;var u=i*i+r*r,l=s*s+o*o;return u<l?-1:u>l?1:0},ge.RadialComparator=de,io(pe.prototype,{transformPoint:function(t,e){return this.factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},transformPolygon:function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof Rt&&!i.isEmpty()||(n=!1);for(var r=new x,s=0;s<t.getNumInteriorRing();s++){var o=this.transformLinearRing(t.getInteriorRingN(s),t);null===o||o.isEmpty()||(o instanceof Rt||(n=!1),r.add(o))}if(n)return this.factory.createPolygon(i,r.toArray([]));var a=new x;return null!==i&&a.add(i),a.addAll(r),this.factory.buildGeometry(a)},createCoordinateSequence:function(t){return this.factory.getCoordinateSequenceFactory().create(t)},getInputGeometry:function(){return this.inputGeom},transformMultiLineString:function(t,e){for(var n=new x,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},transformCoordinates:function(t,e){return this.copy(t)},transformLineString:function(t,e){return this.factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},transformMultiPoint:function(t,e){for(var n=new x,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},transformMultiPolygon:function(t,e){for(var n=new x,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},copy:function(t){return t.copy()},transformGeometryCollection:function(t,e){for(var n=new x,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this.pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this.preserveGeometryCollectionType?this.factory.createGeometryCollection($t.toGeometryArray(n)):this.factory.buildGeometry(n)},transform:function(t){if(this.inputGeom=t,this.factory=t.getFactory(),t instanceof Ct)return this.transformPoint(t,null);if(t instanceof wt)return this.transformMultiPoint(t,null);if(t instanceof Rt)return this.transformLinearRing(t,null);if(t instanceof It)return this.transformLineString(t,null);if(t instanceof ht)return this.transformMultiLineString(t,null);if(t instanceof Lt)return this.transformPolygon(t,null);if(t instanceof Tt)return this.transformMultiPolygon(t,null);if(t instanceof lt)return this.transformGeometryCollection(t,null);throw new n("Unknown Geometry subtype: "+t.getClass().getName())},transformLinearRing:function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this.factory.createLinearRing(null);var i=n.size();return i>0&&i<4&&!this.preserveType?this.factory.createLineString(n):this.factory.createLinearRing(n)},interfaces_:function(){return[]},getClass:function(){return pe}}),io(me.prototype,{snapVertices:function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),s=this.findSnapForVertex(r,e);null!==s&&(t.set(i,new c(s)),0===i&&this._isClosed&&t.set(t.size()-1,new c(s)))}},findSnapForVertex:function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this.snapTolerance)return e[n]}return null},snapTo:function(t){var e=new E(this.srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},snapSegments:function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],s=this.findSegmentIndexToSnap(r,t);s>=0&&t.add(s+1,new c(r),!1)}},findSegmentIndexToSnap:function(t,e){for(var n=i.MAX_VALUE,r=-1,s=0;s<e.size()-1;s++){if(this.seg.p0=e.get(s),this.seg.p1=e.get(s+1),this.seg.p0.equals2D(t)||this.seg.p1.equals2D(t)){if(this.allowSnappingToSourceVertices)continue;return-1}var o=this.seg.distance(t);o<this.snapTolerance&&o<n&&(n=o,r=s)}return r},setAllowSnappingToSourceVertices:function(t){this.allowSnappingToSourceVertices=t},interfaces_:function(){return[]},getClass:function(){return me}}),me.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])},io(ve.prototype,{snapTo:function(t,e){return new ye(e,this.extractTargetCoordinates(t)).transform(this.srcGeom)},snapToSelf:function(t,e){var n=this.extractTargetCoordinates(this.srcGeom),i=new ye(t,n,!0),r=i.transform(this.srcGeom),s=r;return e&&oo(s,St)&&(s=r.buffer(0)),s},computeSnapTolerance:function(t){return this.computeMinimumSegmentLength(t)/10},extractTargetCoordinates:function(t){for(var e=new rt,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},computeMinimumSegmentLength:function(t){for(var e=i.MAX_VALUE,n=0;n<t.length-1;n++){var r=t[n].distance(t[n+1]);r<e&&(e=r)}return e},interfaces_:function(){return[]},getClass:function(){return ve}}),ve.snap=function(t,e,n){var i=new Array(2).fill(null),r=new ve(t);i[0]=r.snapTo(e,n);var s=new ve(e);return i[1]=s.snapTo(i[0],n),i},ve.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=ve.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===Qt.FIXED){var i=1/n.getScale()*2/1.415;i>e&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],s=arguments[1];return Math.min(ve.computeOverlaySnapTolerance(r),ve.computeOverlaySnapTolerance(s))}},ve.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*ve.SNAP_PRECISION_FACTOR},ve.snapToSelf=function(t,e,n){return new ve(t).snapToSelf(e,n)},ve.SNAP_PRECISION_FACTOR=1e-9,ro(ye,pe),io(ye.prototype,{snapLine:function(t,e){var n=new me(t,this.snapTolerance);return n.setAllowSnappingToSourceVertices(this.isSelfSnap),n.snapTo(e)},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this.snapPts);return this.factory.getCoordinateSequenceFactory().create(i)},interfaces_:function(){return[]},getClass:function(){return ye}}),io(xe.prototype,{getCommon:function(){return i.longBitsToDouble(this.commonBits)},add:function(t){var e=i.doubleToLongBits(t);return this.isFirst?(this.commonBits=e,this.commonSignExp=xe.signExpBits(this.commonBits),this.isFirst=!1,null):xe.signExpBits(e)!==this.commonSignExp?(this.commonBits=0,null):(this.commonMantissaBitsCount=xe.numCommonMostSigMantissaBits(this.commonBits,e),void(this.commonBits=xe.zeroLowerBits(this.commonBits,64-(12+this.commonMantissaBitsCount))))},toString:function(){if(1===arguments.length){var t=arguments[0],e=i.longBitsToDouble(t),n=Long.toBinaryString(t),r="0000000000000000000000000000000000000000000000000000000000000000"+n,s=r.substring(r.length-64);return s.substring(0,1)+"  "+s.substring(1,12)+"(exp) "+s.substring(12)+" [ "+e+" ]"}},interfaces_:function(){return[]},getClass:function(){return xe}}),xe.getBit=function(t,e){return 0!=(t&1<<e)?1:0},xe.signExpBits=function(t){return t>>52},xe.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},xe.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;i>=0;i--){if(xe.getBit(t,i)!==xe.getBit(e,i))return n;n++}return 52},io(Ee.prototype,{addCommonBits:function(t){var e=new Ne(this.commonCoord);t.apply(e),t.geometryChanged()},removeCommonBits:function(t){if(0===this.commonCoord.x&&0===this.commonCoord.y)return t;var e=new c(this.commonCoord);e.x=-e.x,e.y=-e.y;var n=new Ne(e);return t.apply(n),t.geometryChanged(),t},getCommonCoordinate:function(){return this.commonCoord},add:function(t){t.apply(this.ccFilter),this.commonCoord=this.ccFilter.getCommonCoordinate()},interfaces_:function(){return[]},getClass:function(){return Ee}}),io(Ie.prototype,{filter:function(t){this.commonBitsX.add(t.x),this.commonBitsY.add(t.y)},getCommonCoordinate:function(){return new c(this.commonBitsX.getCommon(),this.commonBitsY.getCommon())},interfaces_:function(){return[G]},getClass:function(){return Ie}}),io(Ne.prototype,{filter:function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},isDone:function(){return!1},isGeometryChanged:function(){return!0},interfaces_:function(){return[ut]},getClass:function(){return Ne}}),Ee.CommonCoordinateFilter=Ie,Ee.Translater=Ne,io(Ce.prototype,{next:function(){if(this.atStart)return this.atStart=!1,Ce.isAtomic(this.parent)&&this.index++,this.parent;if(null!==this.subcollectionIterator){if(this.subcollectionIterator.hasNext())return this.subcollectionIterator.next();this.subcollectionIterator=null}if(this.index>=this.max)throw new v;var t=this.parent.getGeometryN(this.index++);return t instanceof lt?(this.subcollectionIterator=new Ce(t),this.subcollectionIterator.next()):t},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){if(this.atStart)return!0;if(null!==this.subcollectionIterator){if(this.subcollectionIterator.hasNext())return!0;this.subcollectionIterator=null}return!(this.index>=this.max)},interfaces_:function(){return[g]},getClass:function(){return Ce}}),Ce.isAtomic=function(t){return!(t instanceof lt)},io(Se.prototype,{locateInternal:function(){if(arguments[0]instanceof c&&arguments[1]instanceof Lt){var t=arguments[0],e=arguments[1];if(e.isEmpty())return S.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===S.EXTERIOR)return S.EXTERIOR;if(i===S.BOUNDARY)return S.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var s=e.getInteriorRingN(r),o=this.locateInPolygonRing(t,s);if(o===S.INTERIOR)return S.EXTERIOR;if(o===S.BOUNDARY)return S.BOUNDARY}return S.INTERIOR}if(arguments[0]instanceof c&&arguments[1]instanceof It){var a=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(a))return S.EXTERIOR;var l=u.getCoordinates();return u.isClosed()||!a.equals(l[0])&&!a.equals(l[l.length-1])?oe.isOnLine(a,l)?S.INTERIOR:S.EXTERIOR:S.BOUNDARY}if(arguments[0]instanceof c&&arguments[1]instanceof Ct){var h=arguments[0];return arguments[1].getCoordinate().equals2D(h)?S.INTERIOR:S.EXTERIOR}},locateInPolygonRing:function(t,e){return e.getEnvelopeInternal().intersects(t)?oe.locatePointInRing(t,e.getCoordinates()):S.EXTERIOR},intersects:function(t,e){return this.locate(t,e)!==S.EXTERIOR},updateLocationInfo:function(t){t===S.INTERIOR&&(this.isIn=!0),t===S.BOUNDARY&&this.numBoundaries++},computeLocation:function(t,e){if(e instanceof Ct&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof It)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Lt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof ht)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof Tt)for(var s=e,i=0;i<s.getNumGeometries();i++){var o=s.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,o))}else if(e instanceof lt)for(var a=new Ce(e);a.hasNext();){var u=a.next();u!==e&&this.computeLocation(t,u)}},locate:function(t,e){return e.isEmpty()?S.EXTERIOR:e instanceof It?this.locateInternal(t,e):e instanceof Lt?this.locateInternal(t,e):(this.isIn=!1,this.numBoundaries=0,this.computeLocation(t,e),this.boundaryRule.isInBoundary(this.numBoundaries)?S.BOUNDARY:this.numBoundaries>0||this.isIn?S.INTERIOR:S.EXTERIOR)},interfaces_:function(){return[]},getClass:function(){return Se}}),io(Le.prototype,{interfaces_:function(){return[]},getClass:function(){return Le}}),Le.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new n("Cannot compute the octant for point ( "+t+", "+e+" )");var i=Math.abs(t),r=Math.abs(e);return t>=0?e>=0?i>=r?0:1:i>=r?7:6:e>=0?i>=r?3:2:i>=r?4:5}if(arguments[0]instanceof c&&arguments[1]instanceof c){var s=arguments[0],o=arguments[1],a=o.x-s.x,u=o.y-s.y;if(0===a&&0===u)throw new n("Cannot compute the octant for two identical points "+s);return Le.octant(a,u)}},io(we.prototype,{getCoordinates:function(){},size:function(){},getCoordinate:function(t){},isClosed:function(){},setData:function(t){},getData:function(){},interfaces_:function(){return[]},getClass:function(){return we}}),io(Re.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:Le.octant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},getData:function(){return this.data},toString:function(){return ee.toLineString(new Dt(this.pts))},interfaces_:function(){return[we]},getClass:function(){return Re}}),io(Te.prototype,{getBounds:function(){},interfaces_:function(){return[]},getClass:function(){return Te}}),io(Oe.prototype,{getItem:function(){return this.item},getBounds:function(){return this.bounds},interfaces_:function(){return[Te,a]},getClass:function(){return Oe}}),io(Pe.prototype,{poll:function(){if(this.isEmpty())return null;var t=this.items.get(1);return this.items.set(1,this.items.get(this._size)),this._size-=1,this.reorder(1),t},size:function(){return this._size},reorder:function(t){for(var e=null,n=this.items.get(t);2*t<=this._size&&(e=2*t,e!==this._size&&this.items.get(e+1).compareTo(this.items.get(e))<0&&e++,this.items.get(e).compareTo(n)<0);t=e)this.items.set(t,this.items.get(e));this.items.set(t,n)},clear:function(){this._size=0,this.items.clear()},isEmpty:function(){return 0===this._size},add:function(t){this.items.add(null),this._size+=1;var e=this._size;for(this.items.set(0,t);t.compareTo(this.items.get(Math.trunc(e/2)))<0;e/=2)this.items.set(e,this.items.get(Math.trunc(e/2)));this.items.set(e,t)},interfaces_:function(){return[]},getClass:function(){return Pe}}),io(be.prototype,{visitItem:function(t){},interfaces_:function(){return[]},getClass:function(){return be}}),io(_e.prototype,{insert:function(t,e){},remove:function(t,e){},query:function(){if(1===arguments.length){arguments[0]}else if(2===arguments.length){arguments[0],arguments[1]}},interfaces_:function(){return[]},getClass:function(){return _e}}),io(Me.prototype,{getLevel:function(){return this.level},size:function(){return this.childBoundables.size()},getChildBoundables:function(){return this.childBoundables},addChildBoundable:function(t){h.isTrue(null===this.bounds),this.childBoundables.add(t)},isEmpty:function(){return this.childBoundables.isEmpty()},getBounds:function(){return null===this.bounds&&(this.bounds=this.computeBounds()),this.bounds},interfaces_:function(){return[Te,a]},getClass:function(){return Me}}),Me.serialVersionUID=0x5a1e55ec41369800;var xo={reverseOrder:function(){return{compare:function(t,e){return e.compareTo(t)}}},min:function(t){return xo.sort(t),t.get(0)},sort:function(t,e){var n=t.toArray();e?st.sort(n,e):st.sort(n);for(var i=t.iterator(),r=0,s=n.length;r<s;r++)i.next(),i.set(n[r])},singletonList:function(t){var e=new x;return e.add(t),e}};io(De.prototype,{expandToQueue:function(t,e){var i=De.isComposite(this.boundable1),r=De.isComposite(this.boundable2);if(i&&r)return De.area(this.boundable1)>De.area(this.boundable2)?(this.expand(this.boundable1,this.boundable2,t,e),null):(this.expand(this.boundable2,this.boundable1,t,e),null);if(i)return this.expand(this.boundable1,this.boundable2,t,e),null;if(r)return this.expand(this.boundable2,this.boundable1,t,e),null;throw new n("neither boundable is composite")},isLeaves:function(){return!(De.isComposite(this.boundable1)||De.isComposite(this.boundable2))},compareTo:function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},expand:function(t,e,n,i){for(var r=t.getChildBoundables(),s=r.iterator();s.hasNext();){var o=s.next(),a=new De(o,e,this.itemDistance);a.getDistance()<i&&n.add(a)}},getBoundable:function(t){return 0===t?this.boundable1:this.boundable2},getDistance:function(){return this._distance},distance:function(){return this.isLeaves()?this.itemDistance.distance(this.boundable1,this.boundable2):this.boundable1.getBounds().distance(this.boundable2.getBounds())},interfaces_:function(){return[r]},getClass:function(){return De}}),De.area=function(t){return t.getBounds().getArea()},De.isComposite=function(t){return t instanceof Me},io(Ae.prototype,{getNodeCapacity:function(){return this.nodeCapacity},lastNode:function(t){return t.get(t.size()-1)},size:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this.root));if(1===arguments.length){for(var t=arguments[0],e=0,n=t.getChildBoundables().iterator();n.hasNext();){var i=n.next();i instanceof Me?e+=this.size(i):i instanceof Oe&&(e+=1)}return e}},removeItem:function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Oe&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},itemsTree:function(){if(0===arguments.length){this.build();var t=this.itemsTree(this.root);return null===t?new x:t}if(1===arguments.length){for(var e=arguments[0],n=new x,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof Me){var s=this.itemsTree(r);null!==s&&n.add(s)}else r instanceof Oe?n.add(r.getItem()):h.shouldNeverReachHere()}return n.size()<=0?null:n}},insert:function(t,e){h.isTrue(!this.built,"Cannot insert items into an STR packed R-tree after it has been built."),this.itemBoundables.add(new Oe(t,e))},boundablesAtLevel:function(){if(1===arguments.length){var t=arguments[0],e=new x;return this.boundablesAtLevel(t,this.root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(h.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var s=i.getChildBoundables().iterator();s.hasNext();){var o=s.next();o instanceof Me?this.boundablesAtLevel(n,o,r):(h.isTrue(o instanceof Oe),-1===n&&r.add(o))}return null}},query:function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new x;return this.isEmpty()?e:(this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.query(t,this.root,e),e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this.root.getBounds(),n)&&this.query(n,this.root,i)}else if(3===arguments.length)if(oo(arguments[2],be)&&arguments[0]instanceof Object&&arguments[1]instanceof Me)for(var r=arguments[0],s=arguments[1],o=arguments[2],a=s.getChildBoundables(),u=0;u<a.size();u++){var l=a.get(u);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof Me?this.query(r,l,o):l instanceof Oe?o.visitItem(l.getItem()):h.shouldNeverReachHere())}else if(oo(arguments[2],m)&&arguments[0]instanceof Object&&arguments[1]instanceof Me)for(var c=arguments[0],f=arguments[1],g=arguments[2],a=f.getChildBoundables(),u=0;u<a.size();u++){var l=a.get(u);this.getIntersectsOp().intersects(l.getBounds(),c)&&(l instanceof Me?this.query(c,l,g):l instanceof Oe?g.add(l.getItem()):h.shouldNeverReachHere())}},build:function(){if(this.built)return null;this.root=this.itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1),this.itemBoundables=null,this.built=!0},getRoot:function(){return this.build(),this.root},remove:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.remove(t,this.root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],s=this.removeItem(i,r);if(s)return!0;for(var o=null,a=i.getChildBoundables().iterator();a.hasNext();){var u=a.next();if(this.getIntersectsOp().intersects(u.getBounds(),n)&&(u instanceof Me&&(s=this.remove(n,u,r)))){o=u;break}}return null!==o&&o.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(o),s}},createHigherLevels:function(t,e){h.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},depth:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this.root));if(1===arguments.length){for(var t=arguments[0],e=0,n=t.getChildBoundables().iterator();n.hasNext();){var i=n.next();if(i instanceof Me){var r=this.depth(i);r>e&&(e=r)}}return e+1}},createParentBoundables:function(t,e){h.isTrue(!t.isEmpty());var n=new x;n.add(this.createNode(e));var i=new x(t);xo.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var s=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(s)}return n},isEmpty:function(){return this.built?this.root.isEmpty():this.itemBoundables.isEmpty()},interfaces_:function(){return[a]},getClass:function(){return Ae}}),Ae.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},Ae.IntersectsOp=Fe,Ae.serialVersionUID=-0x35ef64c82d4c5400,Ae.DEFAULT_NODE_CAPACITY=10,io(Ge.prototype,{distance:function(t,e){},interfaces_:function(){return[]},getClass:function(){return Ge}}),ro(qe,Ae),io(qe.prototype,{createParentBoundablesFromVerticalSlices:function(t,e){h.isTrue(t.length>0);for(var n=new x,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},createNode:function(t){return new Be(t)},size:function(){return 0===arguments.length?Ae.prototype.size.call(this):Ae.prototype.size.apply(this,arguments)},insert:function(){if(2!==arguments.length)return Ae.prototype.insert.apply(this,arguments);var t=arguments[0],e=arguments[1];if(t.isNull())return null;Ae.prototype.insert.call(this,t,e)},getIntersectsOp:function(){return qe.intersectsOp},verticalSlices:function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),s=0;s<e;s++){i[s]=new x;for(var o=0;r.hasNext()&&o<n;){var a=r.next();i[s].add(a),o++}}return i},query:function(){if(1===arguments.length){var t=arguments[0];return Ae.prototype.query.call(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];Ae.prototype.query.call(this,e,n)}else if(3===arguments.length)if(oo(arguments[2],be)&&arguments[0]instanceof Object&&arguments[1]instanceof Me){var i=arguments[0],r=arguments[1],s=arguments[2];Ae.prototype.query.call(this,i,r,s)}else if(oo(arguments[2],m)&&arguments[0]instanceof Object&&arguments[1]instanceof Me){var o=arguments[0],a=arguments[1],u=arguments[2];Ae.prototype.query.call(this,o,a,u)}},getComparator:function(){return qe.yComparator},createParentBoundablesFromVerticalSlice:function(t,e){return Ae.prototype.createParentBoundables.call(this,t,e)},remove:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return Ae.prototype.remove.call(this,t,e)}return Ae.prototype.remove.apply(this,arguments)},depth:function(){return 0===arguments.length?Ae.prototype.depth.call(this):Ae.prototype.depth.apply(this,arguments)},createParentBoundables:function(t,e){h.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new x(t);xo.sort(i,qe.xComparator);var r=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(r,e)},nearestNeighbour:function(){if(1===arguments.length){if(oo(arguments[0],Ge)){var t=arguments[0],e=new De(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof De){var n=arguments[0];return this.nearestNeighbour(n,i.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof qe&&oo(arguments[1],Ge)){var r=arguments[0],s=arguments[1],e=new De(this.getRoot(),r.getRoot(),s);return this.nearestNeighbour(e)}if(arguments[0]instanceof De&&"number"==typeof arguments[1]){var o=arguments[0],a=arguments[1],u=a,l=null,h=new Pe;for(h.add(o);!h.isEmpty()&&u>0;){var c=h.poll(),f=c.getDistance();if(f>=u)break;c.isLeaves()?(u=f,l=c):c.expandToQueue(h,u)}return[l.getBoundable(0).getItem(),l.getBoundable(1).getItem()]}}else if(3===arguments.length){var g=arguments[0],d=arguments[1],p=arguments[2],m=new Oe(g,d),e=new De(this.getRoot(),m,p);return this.nearestNeighbour(e)[0]}},interfaces_:function(){return[_e,a]},getClass:function(){return qe}}),qe.centreX=function(t){return qe.avg(t.getMinX(),t.getMaxX())},qe.avg=function(t,e){return(t+e)/2},qe.centreY=function(t){return qe.avg(t.getMinY(),t.getMaxY())},ro(Be,Me),io(Be.prototype,{computeBounds:function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new I(n.getBounds()):t.expandToInclude(n.getBounds())}return t},interfaces_:function(){return[]},getClass:function(){return Be}}),qe.STRtreeNode=Be,qe.serialVersionUID=0x39920f7d5f261e0,qe.xComparator={interfaces_:function(){return[o]},compare:function(t,e){return Ae.compareDoubles(qe.centreX(t.getBounds()),qe.centreX(e.getBounds()))}},qe.yComparator={interfaces_:function(){return[o]},compare:function(t,e){return Ae.compareDoubles(qe.centreY(t.getBounds()),qe.centreY(e.getBounds()))}},qe.intersectsOp={interfaces_:function(){return[IntersectsOp]},intersects:function(t,e){return t.intersects(e)}},qe.DEFAULT_NODE_CAPACITY=10,io(Ve.prototype,{interfaces_:function(){return[]},getClass:function(){return Ve}}),Ve.relativeSign=function(t,e){return t<e?-1:t>e?1:0},Ve.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=Ve.relativeSign(e.x,n.x),r=Ve.relativeSign(e.y,n.y);switch(t){case 0:return Ve.compareValue(i,r);case 1:return Ve.compareValue(r,i);case 2:return Ve.compareValue(r,-i);case 3:return Ve.compareValue(-i,r);case 4:return Ve.compareValue(-i,-r);case 5:return Ve.compareValue(-r,-i);case 6:return Ve.compareValue(-r,i);case 7:return Ve.compareValue(i,-r)}return h.shouldNeverReachHere("invalid octant value"),0},Ve.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0},io(ze.prototype,{getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},compareTo:function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:Ve.compare(this.segmentOctant,this.coord,e.coord)},isEndPoint:function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},isInterior:function(){return this._isInterior},interfaces_:function(){return[r]},getClass:function(){return ze}}),io(ke.prototype,{getSplitCoordinates:function(){var t=new E;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},addCollapsedNodes:function(){var t=new x;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this.edge.getCoordinate(n),n)}},print:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},findCollapsesFromExistingVertices:function(t){for(var e=0;e<this.edge.size()-2;e++){var n=this.edge.getCoordinate(e),i=(this.edge.getCoordinate(e+1),this.edge.getCoordinate(e+2));n.equals2D(i)&&t.add(new R(e+1))}},addEdgeCoordinates:function(t,e,n){var i=e.segmentIndex-t.segmentIndex+2,r=this.edge.getCoordinate(e.segmentIndex),s=e.isInterior()||!e.coord.equals2D(r);s||i--;n.add(new c(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this.edge.getCoordinate(o));s&&n.add(new c(e.coord))},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},findCollapseIndex:function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},findCollapsesFromInsertedNodes:function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new R(e[0])),i=r}},getEdge:function(){return this.edge},addEndpoints:function(){var t=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0),this.add(this.edge.getCoordinate(t),t)},createSplitEdge:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var s=new Array(n).fill(null),o=0;s[o++]=new c(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)s[o++]=this.edge.getCoordinate(a);return r&&(s[o]=new c(e.coord)),new Xe(s,this.edge.getData())},add:function(t,e){var n=new ze(this.edge,t,e,this.edge.getSegmentOctant(e)),i=this.nodeMap.get(n);return null!==i?(h.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this.nodeMap.put(n,n),n)},checkSplitEdgesCorrectness:function(t){var e=this.edge.getCoordinates(),n=t.get(0),i=n.getCoordinate(0);if(!i.equals2D(e[0]))throw new u("bad split edge start point at "+i);var r=t.get(t.size()-1),s=r.getCoordinates(),o=s[s.length-1];if(!o.equals2D(e[e.length-1]))throw new u("bad split edge end point at "+o)},interfaces_:function(){return[]},getClass:function(){return ke}}),io(Ye.prototype,{next:function(){return null===this.currNode?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):null===this.nextNode?null:this.nextNode.segmentIndex===this.currNode.segmentIndex?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):(this.nextNode.segmentIndex,this.currNode.segmentIndex,null)},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){return null!==this.nextNode},readNextNode:function(){this.nodeIt.hasNext()?this.nextNode=this.nodeIt.next():this.nextNode=null},interfaces_:function(){return[g]},getClass:function(){return Ye}}),io(Ue.prototype,{addIntersection:function(t,e){},interfaces_:function(){return[we]},getClass:function(){return Ue}}),
io(Xe.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},safeOctant:function(t,e){return t.equals2D(e)?0:Le.octant(t,e)},getData:function(){return this.data},addIntersection:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=(arguments[2],arguments[3]),s=new c(n.getIntersection(r));this.addIntersection(s,i)}},toString:function(){return ee.toLineString(new Dt(this.pts))},getNodeList:function(){return this.nodeList},addIntersectionNode:function(t,e){var n=e,i=n+1;if(i<this.pts.length){var r=this.pts[i];t.equals2D(r)&&(n=i)}return this.nodeList.add(t,n)},addIntersections:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},interfaces_:function(){return[Ue]},getClass:function(){return Xe}}),Xe.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new x;return Xe.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){var s=r.next();s.getNodeList().addSplitEdges(i)}},io(He.prototype,{overlap:function(){if(2===arguments.length){arguments[0],arguments[1]}else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t.getLineSegment(e,this.overlapSeg1),n.getLineSegment(i,this.overlapSeg2),this.overlap(this.overlapSeg1,this.overlapSeg2)}},interfaces_:function(){return[]},getClass:function(){return He}}),io(We.prototype,{getLineSegment:function(t,e){e.p0=this.pts[t],e.p1=this.pts[t+1]},computeSelect:function(t,e,n,i){var r=this.pts[e],s=this.pts[n];if(i.tempEnv1.init(r,s),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var o=Math.trunc((e+n)/2);e<o&&this.computeSelect(t,e,o,i),o<n&&this.computeSelect(t,o,n,i)},getCoordinates:function(){for(var t=new Array(this.end-this.start+1).fill(null),e=0,n=this.start;n<=this.end;n++)t[e++]=this.pts[n];return t},computeOverlaps:function(t,e){this.computeOverlapsInternal(this.start,this.end,t,t.start,t.end,e)},setId:function(t){this.id=t},select:function(t,e){this.computeSelect(t,this.start,this.end,e)},getEnvelope:function(){if(null===this.env){var t=this.pts[this.start],e=this.pts[this.end];this.env=new I(t,e)}return this.env},getEndIndex:function(){return this.end},getStartIndex:function(){return this.start},getContext:function(){return this.context},getId:function(){return this.id},computeOverlapsInternal:function(t,e,n,i,r,s){var o=this.pts[t],a=this.pts[e],u=n.pts[i],l=n.pts[r];if(e-t==1&&r-i==1)return s.overlap(this,t,n,i),null;if(s.tempEnv1.init(o,a),s.tempEnv2.init(u,l),!s.tempEnv1.intersects(s.tempEnv2))return null;var h=Math.trunc((t+e)/2),c=Math.trunc((i+r)/2);t<h&&(i<c&&this.computeOverlapsInternal(t,h,n,i,c,s),c<r&&this.computeOverlapsInternal(t,h,n,c,r,s)),h<e&&(i<c&&this.computeOverlapsInternal(h,e,n,i,c,s),c<r&&this.computeOverlapsInternal(h,e,n,c,r,s))},interfaces_:function(){return[]},getClass:function(){return We}}),io(je.prototype,{interfaces_:function(){return[]},getClass:function(){return je}}),je.isNorthern=function(t){return t===je.NE||t===je.NW},je.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},je.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e,i=t>e?t:e;return 0===n&&3===i?3:n},je.isInHalfPlane=function(t,e){return e===je.SE?t===je.SE||t===je.SW:t===e||t===e+1},je.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new n("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?je.NE:je.SE:e>=0?je.NW:je.SW}if(arguments[0]instanceof c&&arguments[1]instanceof c){var i=arguments[0],r=arguments[1];if(r.x===i.x&&r.y===i.y)throw new n("Cannot compute the quadrant for two identical points "+i);return r.x>=i.x?r.y>=i.y?je.NE:je.SE:r.y>=i.y?je.NW:je.SW}},je.NE=0,je.NW=1,je.SW=2,je.SE=3,io(Ke.prototype,{interfaces_:function(){return[]},getClass:function(){return Ke}}),Ke.getChainStartIndices=function(t){var e=0,n=new x;n.add(new R(e));do{var i=Ke.findChainEnd(t,e);n.add(new R(i)),e=i}while(e<t.length-1);return Ke.toIntArray(n)},Ke.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=je.quadrant(t[n],t[n+1]),r=e+1;r<t.length;){if(!t[r-1].equals2D(t[r])){if(je.quadrant(t[r-1],t[r])!==i)break}r++}return r-1},Ke.getChains=function(){if(1===arguments.length){var t=arguments[0];return Ke.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new x,r=Ke.getChainStartIndices(e),s=0;s<r.length-1;s++){var o=new We(e,r[s],r[s+1],n);i.add(o)}return i}},Ke.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},io(Ze.prototype,{computeNodes:function(t){},getNodedSubstrings:function(){},interfaces_:function(){return[]},getClass:function(){return Ze}}),io(Qe.prototype,{setSegmentIntersector:function(t){this.segInt=t},interfaces_:function(){return[Ze]},getClass:function(){return Qe}}),ro(Je,Qe),io(Je.prototype,{getMonotoneChains:function(){return this.monoChains},getNodedSubstrings:function(){return Xe.getNodedSubstrings(this.nodedSegStrings)},getIndex:function(){return this.index},add:function(t){for(var e=Ke.getChains(t.getCoordinates(),t),n=e.iterator();n.hasNext();){var i=n.next();i.setId(this.idCounter++),this.index.insert(i.getEnvelope(),i),this.monoChains.add(i)}},computeNodes:function(t){this.nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},intersectChains:function(){for(var t=new $e(this.segInt),e=this.monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this.index.query(n.getEnvelope()),r=i.iterator();r.hasNext();){var s=r.next();if(s.getId()>n.getId()&&(n.computeOverlaps(s,t),this.nOverlaps++),this.segInt.isDone())return null}},interfaces_:function(){return[]},getClass:function(){return Je}}),ro($e,He),io($e.prototype,{overlap:function(){if(4!==arguments.length)return He.prototype.overlap.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=t.getContext(),s=n.getContext();this.si.processIntersections(r,e,s,i)},interfaces_:function(){return[]},getClass:function(){return $e}}),Je.SegmentOverlapAction=$e,ro(tn,u),io(tn.prototype,{getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return tn}}),tn.msgWithCoord=function(t,e){return null!==e?t+" [ "+e+" ]":t},io(en.prototype,{processIntersections:function(t,e,n,i){},isDone:function(){},interfaces_:function(){return[]},getClass:function(){return en}}),io(nn.prototype,{getInteriorIntersection:function(){return this.interiorIntersection},setCheckEndSegmentsOnly:function(t){this.isCheckEndSegmentsOnly=t},getIntersectionSegments:function(){return this.intSegments},count:function(){return this.intersectionCount},getIntersections:function(){return this.intersections},setFindAllIntersections:function(t){this.findAllIntersections=t},setKeepIntersections:function(t){this.keepIntersections=t},processIntersections:function(t,e,n,i){if(!this.findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this.isCheckEndSegmentsOnly){if(!(this.isEndSegment(t,e)||this.isEndSegment(n,i)))return null}var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,s,o,a),this.li.hasIntersection()&&this.li.isInteriorIntersection()&&(this.intSegments=new Array(4).fill(null),this.intSegments[0]=r,this.intSegments[1]=s,this.intSegments[2]=o,this.intSegments[3]=a,this.interiorIntersection=this.li.getIntersection(0),this.keepIntersections&&this.intersections.add(this.interiorIntersection),this.intersectionCount++)},isEndSegment:function(t,e){return 0===e||e>=t.size()-2},hasIntersection:function(){return null!==this.interiorIntersection},isDone:function(){return!this.findAllIntersections&&null!==this.interiorIntersection},interfaces_:function(){return[en]},getClass:function(){return nn}}),nn.createAllIntersectionsFinder=function(t){var e=new nn(t);return e.setFindAllIntersections(!0),e},nn.createAnyIntersectionFinder=function(t){return new nn(t)},nn.createIntersectionCounter=function(t){var e=new nn(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e},io(rn.prototype,{execute:function(){if(null!==this.segInt)return null;this.checkInteriorIntersections()},getIntersections:function(){return this.segInt.getIntersections()},isValid:function(){return this.execute(),this._isValid},setFindAllIntersections:function(t){this.findAllIntersections=t},checkInteriorIntersections:function(){this._isValid=!0,this.segInt=new nn(this.li),this.segInt.setFindAllIntersections(this.findAllIntersections);var t=new Je;if(t.setSegmentIntersector(this.segInt),t.computeNodes(this.segStrings),this.segInt.hasIntersection())return this._isValid=!1,null},checkValid:function(){if(this.execute(),!this._isValid)throw new tn(this.getErrorMessage(),this.segInt.getInteriorIntersection())},getErrorMessage:function(){if(this._isValid)return"no intersections found";var t=this.segInt.getIntersectionSegments();return"found non-noded intersection between "+ee.toLineString(t[0],t[1])+" and "+ee.toLineString(t[2],t[3])},interfaces_:function(){return[]},getClass:function(){return rn}}),rn.computeIntersections=function(t){var e=new rn(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()},io(sn.prototype,{checkValid:function(){this.nv.checkValid()},interfaces_:function(){return[]},getClass:function(){return sn}}),sn.toSegmentStrings=function(t){for(var e=new x,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Re(i.getCoordinates(),i))}return e},sn.checkValid=function(t){new sn(t).checkValid()},io(on.prototype,{map:function(t){for(var e=new x,n=0;n<t.getNumGeometries();n++){var i=this.mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection($t.toGeometryArray(e))},interfaces_:function(){return[]},getClass:function(){return on}}),on.map=function(t,e){return new on(e).map(t)},io(an.prototype,{interfaces_:function(){return[]},getClass:function(){return an}}),an.opposite=function(t){return t===an.LEFT?an.RIGHT:t===an.RIGHT?an.LEFT:t},an.ON=0,an.LEFT=1,an.RIGHT=2,io(un.prototype,{setAllLocations:function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},isNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==S.NONE)return!1;return!0},setAllLocationsIfNull:function(t){for(var e=0;e<this.location.length;e++)this.location[e]===S.NONE&&(this.location[e]=t)},isLine:function(){return 1===this.location.length},merge:function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[an.ON]=this.location[an.ON],e[an.LEFT]=S.NONE,e[an.RIGHT]=S.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===S.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},getLocations:function(){return this.location},flip:function(){if(this.location.length<=1)return null;var t=this.location[an.LEFT];this.location[an.LEFT]=this.location[an.RIGHT],this.location[an.RIGHT]=t},toString:function(){var t=new w;return this.location.length>1&&t.append(S.toLocationSymbol(this.location[an.LEFT])),t.append(S.toLocationSymbol(this.location[an.ON])),this.location.length>1&&t.append(S.toLocationSymbol(this.location[an.RIGHT])),t.toString()},setLocations:function(t,e,n){this.location[an.ON]=t,this.location[an.LEFT]=e,this.location[an.RIGHT]=n},get:function(t){return t<this.location.length?this.location[t]:S.NONE},isArea:function(){return this.location.length>1},isAnyNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===S.NONE)return!0;return!1},setLocation:function(){if(1===arguments.length){var t=arguments[0];this.setLocation(an.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},init:function(t){this.location=new Array(t).fill(null),this.setAllLocations(S.NONE)},isEqualOnSide:function(t,e){return this.location[e]===t.location[e]},allPositionsEqual:function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},interfaces_:function(){return[]},getClass:function(){return un}}),io(ln.prototype,{getGeometryCount:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},setAllLocations:function(t,e){this.elt[t].setAllLocations(e)},isNull:function(t){return this.elt[t].isNull()},setAllLocationsIfNull:function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},isLine:function(t){return this.elt[t].isLine()},merge:function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new un(t.elt[e]):this.elt[e].merge(t.elt[e])},flip:function(){this.elt[0].flip(),this.elt[1].flip()},getLocation:function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(an.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},toString:function(){var t=new w;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},isArea:function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},isAnyNull:function(t){return this.elt[t].isAnyNull()},setLocation:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(an.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},isEqualOnSide:function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},allPositionsEqual:function(t,e){return this.elt[t].allPositionsEqual(e)},toLine:function(t){this.elt[t].isArea()&&(this.elt[t]=new un(this.elt[t].location[0]))},interfaces_:function(){return[]},getClass:function(){return ln}}),ln.toLineLabel=function(t){for(var e=new ln(S.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e},io(hn.prototype,{computeRing:function(){if(null!==this.ring)return null;for(var t=new Array(this.pts.size()).fill(null),e=0;e<this.pts.size();e++)t[e]=this.pts.get(e);this.ring=this.geometryFactory.createLinearRing(t),this._isHole=oe.isCCW(this.ring.getCoordinates())},isIsolated:function(){return 1===this.label.getGeometryCount()},computePoints:function(t){this.startDe=t;var e=t,n=!0;do{if(null===e)throw new tn("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new tn("Directed Edge visited twice during ring-building at "+e.getCoordinate());this.edges.add(e);var i=e.getLabel();h.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this.startDe)},getLinearRing:function(){return this.ring},getCoordinate:function(t){return this.pts.get(t)},computeMaxNodeDegree:function(){this.maxNodeDegree=0;var t=this.startDe;do{var e=t.getNode(),n=e.getEdges().getOutgoingDegree(this);n>this.maxNodeDegree&&(this.maxNodeDegree=n),t=this.getNext(t)}while(t!==this.startDe);this.maxNodeDegree*=2},addPoints:function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var s=r;s<i.length;s++)this.pts.add(i[s])}else{var r=i.length-2;n&&(r=i.length-1);for(var s=r;s>=0;s--)this.pts.add(i[s])}},isHole:function(){return this._isHole},setInResult:function(){var t=this.startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this.startDe)},containsPoint:function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!oe.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this.holes.iterator();n.hasNext();){if(n.next().containsPoint(t))return!1}return!0},addHole:function(t){this.holes.add(t)},isShell:function(){return null===this.shell},getLabel:function(){return this.label},getEdges:function(){return this.edges},getMaxNodeDegree:function(){return this.maxNodeDegree<0&&this.computeMaxNodeDegree(),this.maxNodeDegree},getShell:function(){return this.shell},mergeLabel:function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=e.getLocation(n,an.RIGHT);if(i===S.NONE)return null;if(this.label.getLocation(n)===S.NONE)return this.label.setLocation(n,i),null}},setShell:function(t){this.shell=t,null!==t&&t.addHole(this)},toPolygon:function(t){for(var e=new Array(this.holes.size()).fill(null),n=0;n<this.holes.size();n++)e[n]=this.holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},interfaces_:function(){return[]},getClass:function(){return hn}}),ro(cn,hn),io(cn.prototype,{setEdgeRing:function(t,e){t.setMinEdgeRing(e)},getNext:function(t){return t.getNextMin()},interfaces_:function(){return[]},getClass:function(){return cn}}),ro(fn,hn),io(fn.prototype,{buildMinimalRings:function(){var t=new x,e=this.startDe;do{if(null===e.getMinEdgeRing()){var n=new cn(e,this.geometryFactory);t.add(n)}e=e.getNext()}while(e!==this.startDe);return t},setEdgeRing:function(t,e){t.setEdgeRing(e)},linkDirectedEdgesForMinimalEdgeRings:function(){var t=this.startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this.startDe)},getNext:function(t){return t.getNext()},interfaces_:function(){return[]},getClass:function(){return fn}}),io(gn.prototype,{setVisited:function(t){this._isVisited=t},setInResult:function(t){this._isInResult=t},isCovered:function(){return this._isCovered},isCoveredSet:function(){return this._isCoveredSet},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setCovered:function(t){this._isCovered=t,this._isCoveredSet=!0},updateIM:function(t){h.isTrue(this.label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},isInResult:function(){return this._isInResult},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return gn}}),ro(dn,gn),io(dn.prototype,{isIncidentEdgeInResult:function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();){if(t.next().getEdge().isInResult())return!0}return!1},isIsolated:function(){return 1===this.label.getGeometryCount()},getCoordinate:function(){return this.coord},print:function(t){t.println("node "+this.coord+" lbl: "+this.label)},computeIM:function(t){},computeMergedLocation:function(t,e){var n=S.NONE;if(n=this.label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==S.BOUNDARY&&(n=i)}return n},setLabel:function(){if(2!==arguments.length)return gn.prototype.setLabel.apply(this,arguments);var t=arguments[0],e=arguments[1];null===this.label?this.label=new ln(t,e):this.label.setLocation(t,e)},getEdges:function(){return this.edges},mergeLabel:function(){if(arguments[0]instanceof dn){var t=arguments[0];this.mergeLabel(t.label)}else if(arguments[0]instanceof ln)for(var e=arguments[0],n=0;n<2;n++){var i=this.computeMergedLocation(e,n),r=this.label.getLocation(n);r===S.NONE&&this.label.setLocation(n,i)}},add:function(t){this.edges.insert(t),t.setNode(this)},setLabelBoundary:function(t){if(null===this.label)return null;var e=S.NONE;null!==this.label&&(e=this.label.getLocation(t));var n=null;switch(e){case S.BOUNDARY:n=S.INTERIOR;break;case S.INTERIOR:default:n=S.BOUNDARY}this.label.setLocation(t,n)},interfaces_:function(){return[]},getClass:function(){return dn}}),io(pn.prototype,{find:function(t){return this.nodeMap.get(t)},addNode:function(){if(arguments[0]instanceof c){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof dn){var n=arguments[0],e=this.nodeMap.get(n.getCoordinate());return null===e?(this.nodeMap.put(n.getCoordinate(),n),n):(e.mergeLabel(n),e)}},print:function(t){for(var e=this.iterator();e.hasNext();){e.next().print(t)}},iterator:function(){return this.nodeMap.values().iterator()},values:function(){return this.nodeMap.values()},getBoundaryNodes:function(t){for(var e=new x,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===S.BOUNDARY&&e.add(i)}return e},add:function(t){var e=t.getCoordinate();this.addNode(e).add(t)},interfaces_:function(){return[]},getClass:function(){return pn}}),io(mn.prototype,{compareDirection:function(t){return this.dx===t.dx&&this.dy===t.dy?0:this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:oe.computeOrientation(t.p0,t.p1,this.p1)},getDy:function(){return this.dy},getCoordinate:function(){return this.p0},setNode:function(t){this.node=t},print:function(t){var e=Math.atan2(this.dy,this.dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+e+"   "+this.label)},compareTo:function(t){var e=t;return this.compareDirection(e)},getDirectedCoordinate:function(){return this.p1},getDx:function(){return this.dx},getLabel:function(){return this.label},getEdge:function(){return this.edge},getQuadrant:function(){return this.quadrant},getNode:function(){return this.node},toString:function(){var t=Math.atan2(this.dy,this.dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+t+"   "+this.label},computeLabel:function(t){},init:function(t,e){this.p0=t,this.p1=e,this.dx=e.x-t.x,this.dy=e.y-t.y,this.quadrant=je.quadrant(this.dx,this.dy),h.isTrue(!(0===this.dx&&0===this.dy),"EdgeEnd with identical endpoints found")},interfaces_:function(){return[r]},getClass:function(){return mn}}),ro(vn,mn),io(vn.prototype,{getNextMin:function(){return this.nextMin},getDepth:function(t){return this.depth[t]},setVisited:function(t){this._isVisited=t},computeDirectedLabel:function(){this.label=new ln(this.edge.getLabel()),this._isForward||this.label.flip()},getNext:function(){return this.next},setDepth:function(t,e){if(-999!==this.depth[t]&&this.depth[t]!==e)throw new tn("assigned depths do not match",this.getCoordinate());this.depth[t]=e},isInteriorAreaEdge:function(){for(var t=!0,e=0;e<2;e++)this.label.isArea(e)&&this.label.getLocation(e,an.LEFT)===S.INTERIOR&&this.label.getLocation(e,an.RIGHT)===S.INTERIOR||(t=!1);return t},setNextMin:function(t){this.nextMin=t},print:function(t){mn.prototype.print.call(this,t),t.print(" "+this.depth[an.LEFT]+"/"+this.depth[an.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},setMinEdgeRing:function(t){this.minEdgeRing=t},isLineEdge:function(){var t=this.label.isLine(0)||this.label.isLine(1),e=!this.label.isArea(0)||this.label.allPositionsEqual(0,S.EXTERIOR),n=!this.label.isArea(1)||this.label.allPositionsEqual(1,S.EXTERIOR);return t&&e&&n},setEdgeRing:function(t){this.edgeRing=t},getMinEdgeRing:function(){return this.minEdgeRing},getDepthDelta:function(){var t=this.edge.getDepthDelta();return this._isForward||(t=-t),t},setInResult:function(t){this._isInResult=t},getSym:function(){return this.sym},isForward:function(){return this._isForward},getEdge:function(){return this.edge},printEdge:function(t){this.print(t),t.print(" "),this._isForward?this.edge.print(t):this.edge.printReverse(t)},setSym:function(t){this.sym=t},setVisitedEdge:function(t){this.setVisited(t),this.sym.setVisited(t)},setEdgeDepths:function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===an.LEFT&&(i=-1);var r=an.opposite(t),s=n*i,o=e+s;this.setDepth(t,e),this.setDepth(r,o)},getEdgeRing:function(){return this.edgeRing},isInResult:function(){return this._isInResult},setNext:function(t){this.next=t},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return vn}}),vn.depthFactor=function(t,e){return t===S.EXTERIOR&&e===S.INTERIOR?1:t===S.INTERIOR&&e===S.EXTERIOR?-1:0},io(yn.prototype,{createNode:function(t){return new dn(t,null)},interfaces_:function(){return[]},getClass:function(){return yn}}),io(xn.prototype,{printEdges:function(t){t.println("Edges:");for(var e=0;e<this.edges.size();e++){t.println("edge "+e+":");var n=this.edges.get(e);n.print(t),n.eiList.print(t)}},find:function(t){return this.nodes.find(t)},addNode:function(){if(arguments[0]instanceof dn){var t=arguments[0];return this.nodes.addNode(t)}if(arguments[0]instanceof c){var e=arguments[0];return this.nodes.addNode(e)}},getNodeIterator:function(){return this.nodes.iterator()},linkResultDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){t.next().getEdges().linkResultDirectedEdges()}},debugPrintln:function(t){_.out.println(t)},isBoundaryNode:function(t,e){var n=this.nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===S.BOUNDARY},linkAllDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){t.next().getEdges().linkAllDirectedEdges()}},matchInSameDirection:function(t,e,n,i){return!!t.equals(n)&&(oe.computeOrientation(t,e,i)===oe.COLLINEAR&&je.quadrant(t,e)===je.quadrant(n,i))},getEdgeEnds:function(){return this.edgeEndList},debugPrint:function(t){_.out.print(t)},getEdgeIterator:function(){return this.edges.iterator()},findEdgeInSameDirection:function(t,e){for(var n=0;n<this.edges.size();n++){var i=this.edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},insertEdge:function(t){this.edges.add(t)},findEdgeEnd:function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},addEdges:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.edges.add(n);var i=new vn(n,!0),r=new vn(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},add:function(t){this.nodes.add(t),this.edgeEndList.add(t)},getNodes:function(){return this.nodes.values()},findEdge:function(t,e){for(var n=0;n<this.edges.size();n++){var i=this.edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},interfaces_:function(){return[]},getClass:function(){return xn}}),xn.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();){e.next().getEdges().linkResultDirectedEdges()}},io(En.prototype,{sortShellsAndHoles:function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},computePolygons:function(t){for(var e=new x,n=t.iterator();n.hasNext();){var i=n.next(),r=i.toPolygon(this.geometryFactory);e.add(r)}return e},placeFreeHoles:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new tn("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},buildMinimalEdgeRings:function(t,e,n){for(var i=new x,r=t.iterator();r.hasNext();){var s=r.next();if(s.getMaxNodeDegree()>2){s.linkDirectedEdgesForMinimalEdgeRings();var o=s.buildMinimalRings(),a=this.findShell(o);null!==a?(this.placePolygonHoles(a,o),e.add(a)):n.addAll(o)}else i.add(s)}return i},containsPoint:function(t){for(var e=this.shellList.iterator();e.hasNext();){if(e.next().containsPoint(t))return!0}return!1},buildMaximalEdgeRings:function(t){for(var e=new x,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new fn(i,this.geometryFactory);e.add(r),r.setInResult()}}return e},placePolygonHoles:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},getPolygons:function(){return this.computePolygons(this.shellList)},findEdgeRingContaining:function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),s=null,o=null,a=e.iterator();a.hasNext();){var u=a.next(),l=u.getLinearRing(),h=l.getEnvelopeInternal();null!==s&&(o=s.getLinearRing().getEnvelopeInternal());var c=!1;h.contains(i)&&oe.isPointInRing(r,l.getCoordinates())&&(c=!0),c&&(null===s||o.contains(h))&&(s=u)}return s},findShell:function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return h.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},add:function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];xn.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new x,s=this.buildMinimalEdgeRings(i,this.shellList,r);this.sortShellsAndHoles(s,this.shellList,r),this.placeFreeHoles(this.shellList,r)}},interfaces_:function(){return[]},getClass:function(){return En}}),io(In.prototype,{collectLines:function(t){for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this.lineEdgesList),this.collectBoundaryTouchEdge(n,t,this.lineEdgesList)}},labelIsolatedLine:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.op.getArgGeometry(e));t.getLabel().setLocation(e,n)},build:function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this.resultLineList},collectLineEdge:function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!$n.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},findCoveredLineEdges:function(){for(var t=this.op.getGraph().getNodes().iterator();t.hasNext();){t.next().getEdges().findCoveredLineEdges()}for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this.op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},labelIsolatedLines:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},buildLines:function(t){for(var e=this.lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=(n.getLabel(),this.geometryFactory.createLineString(n.getCoordinates()));this.resultLineList.add(i),n.setInResult(!0)}},collectBoundaryTouchEdge:function(t,e,n){var i=t.getLabel();return t.isLineEdge()?null:t.isVisited()?null:t.isInteriorAreaEdge()?null:t.getEdge().isInResult()?null:(h.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void($n.isResultOfOp(i,e)&&e===$n.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},interfaces_:function(){return[]},getClass:function(){return In}}),io(Nn.prototype,{filterCoveredNodeToPoint:function(t){var e=t.getCoordinate();if(!this.op.isCoveredByLA(e)){var n=this.geometryFactory.createPoint(e);this.resultPointList.add(n)}},extractNonCoveredResultNodes:function(t){for(var e=this.op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!n.isInResult()&&(!n.isIncidentEdgeInResult()&&(0===n.getEdges().getDegree()||t===$n.INTERSECTION))){var i=n.getLabel();$n.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},build:function(t){return this.extractNonCoveredResultNodes(t),this.resultPointList},interfaces_:function(){return[]},getClass:function(){return Nn}}),io(Cn.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return Cn}}),io(Sn.prototype,{locate:function(t){return Sn.locate(t,this.geom)},interfaces_:function(){return[Cn]},getClass:function(){return Sn}}),Sn.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&oe.isPointInRing(t,e.getCoordinates())},Sn.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!Sn.isPointInRing(t,n))return!1
;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(Sn.isPointInRing(t,r))return!1}return!0},Sn.containsPoint=function(t,e){if(e instanceof Lt)return Sn.containsPointInPolygon(t,e);if(e instanceof lt)for(var n=new Ce(e);n.hasNext();){var i=n.next();if(i!==e&&Sn.containsPoint(t,i))return!0}return!1},Sn.locate=function(t,e){return e.isEmpty()?S.EXTERIOR:Sn.containsPoint(t,e)?S.INTERIOR:S.EXTERIOR},io(Ln.prototype,{getNextCW:function(t){this.getEdges();var e=this.edgeList.indexOf(t),n=e-1;return 0===e&&(n=this.edgeList.size()-1),this.edgeList.get(n)},propagateSideLabels:function(t){for(var e=S.NONE,n=this.iterator();n.hasNext();){var i=n.next(),r=i.getLabel();r.isArea(t)&&r.getLocation(t,an.LEFT)!==S.NONE&&(e=r.getLocation(t,an.LEFT))}if(e===S.NONE)return null;for(var s=e,n=this.iterator();n.hasNext();){var i=n.next(),r=i.getLabel();if(r.getLocation(t,an.ON)===S.NONE&&r.setLocation(t,an.ON,s),r.isArea(t)){var o=r.getLocation(t,an.LEFT),a=r.getLocation(t,an.RIGHT);if(a!==S.NONE){if(a!==s)throw new tn("side location conflict",i.getCoordinate());o===S.NONE&&h.shouldNeverReachHere("found single null side (at "+i.getCoordinate()+")"),s=o}else h.isTrue(r.getLocation(t,an.LEFT)===S.NONE,"found single null side"),r.setLocation(t,an.RIGHT,s),r.setLocation(t,an.LEFT,s)}}},getCoordinate:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},print:function(t){_.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){e.next().print(t)}},isAreaLabelsConsistent:function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},checkAreaLabelsConsistent:function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel(),r=i.getLocation(t,an.LEFT);h.isTrue(r!==S.NONE,"Found unlabelled area edge");for(var s=r,o=this.iterator();o.hasNext();){var a=o.next(),u=a.getLabel();h.isTrue(u.isArea(t),"Found non-area edge");var l=u.getLocation(t,an.LEFT),c=u.getLocation(t,an.RIGHT);if(l===c)return!1;if(c!==s)return!1;s=l}return!0},findIndex:function(t){this.iterator();for(var e=0;e<this.edgeList.size();e++){if(this.edgeList.get(e)===t)return e}return-1},iterator:function(){return this.getEdges().iterator()},getEdges:function(){return null===this.edgeList&&(this.edgeList=new x(this.edgeMap.values())),this.edgeList},getLocation:function(t,e,n){return this.ptInAreaLocation[t]===S.NONE&&(this.ptInAreaLocation[t]=Sn.locate(e,n[t].getGeometry())),this.ptInAreaLocation[t]},toString:function(){var t=new w;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},computeEdgeEndLabels:function(t){for(var e=this.iterator();e.hasNext();){e.next().computeLabel(t)}},computeLabelling:function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next(),r=i.getLabel(),s=0;s<2;s++)r.isLine(s)&&r.getLocation(s)===S.BOUNDARY&&(e[s]=!0);for(var n=this.iterator();n.hasNext();)for(var i=n.next(),r=i.getLabel(),s=0;s<2;s++)if(r.isAnyNull(s)){var o=S.NONE;if(e[s])o=S.EXTERIOR;else{var a=i.getCoordinate();o=this.getLocation(s,a,t)}r.setAllLocationsIfNull(s,o)}},getDegree:function(){return this.edgeMap.size()},insertEdgeEnd:function(t,e){this.edgeMap.put(t,e),this.edgeList=null},interfaces_:function(){return[]},getClass:function(){return Ln}}),ro(wn,Ln),io(wn.prototype,{linkResultDirectedEdges:function(){this.getResultAreaEdges();for(var t=null,e=null,n=this.SCANNING_FOR_INCOMING,i=0;i<this.resultAreaEdgeList.size();i++){var r=this.resultAreaEdgeList.get(i),s=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this.SCANNING_FOR_INCOMING:if(!s.isInResult())continue;e=s,n=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this.SCANNING_FOR_INCOMING}}if(n===this.LINKING_TO_OUTGOING){if(null===t)throw new tn("no outgoing dirEdge found",this.getCoordinate());h.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},insert:function(t){var e=t;this.insertEdgeEnd(e,e)},getRightmostEdge:function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),s=i.getQuadrant();if(je.isNorthern(r)&&je.isNorthern(s))return n;if(!je.isNorthern(r)&&!je.isNorthern(s))return i;return 0!==n.getDy()?n:0!==i.getDy()?i:(h.shouldNeverReachHere("found two horizontal edges incident on node"),null)},print:function(t){_.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},getResultAreaEdges:function(){if(null!==this.resultAreaEdgeList)return this.resultAreaEdgeList;this.resultAreaEdgeList=new x;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this.resultAreaEdgeList.add(e)}return this.resultAreaEdgeList},updateLabelling:function(t){for(var e=this.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.setAllLocationsIfNull(0,t.getLocation(0)),i.setAllLocationsIfNull(1,t.getLocation(1))}},linkAllDirectedEdges:function(){this.getEdges();for(var t=null,e=null,n=this.edgeList.size()-1;n>=0;n--){var i=this.edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},computeDepths:function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=(t.getLabel(),t.getDepth(an.LEFT)),i=t.getDepth(an.RIGHT),r=this.computeDepths(e+1,this.edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new tn("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var s=arguments[0],o=arguments[1],a=arguments[2],u=a,l=s;l<o;l++){var h=this.edgeList.get(l);h.getLabel();h.setEdgeDepths(an.RIGHT,u),u=h.getDepth(an.LEFT)}return u}},mergeSymLabels:function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},linkMinimalDirectedEdges:function(t){for(var e=null,n=null,i=this.SCANNING_FOR_INCOMING,r=this.resultAreaEdgeList.size()-1;r>=0;r--){var s=this.resultAreaEdgeList.get(r),o=s.getSym();switch(null===e&&s.getEdgeRing()===t&&(e=s),i){case this.SCANNING_FOR_INCOMING:if(o.getEdgeRing()!==t)continue;n=o,i=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;n.setNextMin(s),i=this.SCANNING_FOR_INCOMING}}i===this.LINKING_TO_OUTGOING&&(h.isTrue(null!==e,"found null for first outgoing dirEdge"),h.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},getOutgoingDegree:function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();){var n=e.next();n.isInResult()&&t++}return t}if(1===arguments.length){for(var i=arguments[0],t=0,e=this.iterator();e.hasNext();){var n=e.next();n.getEdgeRing()===i&&t++}return t}},getLabel:function(){return this.label},findCoveredLineEdges:function(){for(var t=S.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=S.INTERIOR;break}if(i.isInResult()){t=S.EXTERIOR;break}}}if(t===S.NONE)return null;for(var r=t,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();n.isLineEdge()?n.getEdge().setCovered(r===S.INTERIOR):(n.isInResult()&&(r=S.EXTERIOR),i.isInResult()&&(r=S.INTERIOR))}},computeLabelling:function(t){Ln.prototype.computeLabelling.call(this,t),this.label=new ln(S.NONE);for(var e=this.iterator();e.hasNext();)for(var n=e.next(),i=n.getEdge(),r=i.getLabel(),s=0;s<2;s++){var o=r.getLocation(s);o!==S.INTERIOR&&o!==S.BOUNDARY||this.label.setLocation(s,S.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return wn}}),ro(Rn,yn),io(Rn.prototype,{createNode:function(t){return new dn(t,new wn)},interfaces_:function(){return[]},getClass:function(){return Rn}}),io(Tn.prototype,{computeIntersections:function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},interfaces_:function(){return[]},getClass:function(){return Tn}}),io(On.prototype,{isDelete:function(){return this.eventType===On.DELETE},setDeleteEventIndex:function(t){this.deleteEventIndex=t},getObject:function(){return this.obj},compareTo:function(t){var e=t;return this.xValue<e.xValue?-1:this.xValue>e.xValue?1:this.eventType<e.eventType?-1:this.eventType>e.eventType?1:0},getInsertEvent:function(){return this.insertEvent},isInsert:function(){return this.eventType===On.INSERT},isSameLabel:function(t){return null!==this.label&&this.label===t.label},getDeleteEventIndex:function(){return this.deleteEventIndex},interfaces_:function(){return[r]},getClass:function(){return On}}),On.INSERT=1,On.DELETE=2,io(Pn.prototype,{interfaces_:function(){return[]},getClass:function(){return Pn}}),io(bn.prototype,{isTrivialIntersection:function(t,e,n,i){if(t===n&&1===this.li.getIntersectionNum()){if(bn.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},setIsDoneIfProperInt:function(t){this.isDoneWhenProperInt=t},hasProperInteriorIntersection:function(){return this.hasProperInterior},isBoundaryPointInternal:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next(),r=i.getCoordinate();if(t.isIntersection(r))return!0}return!1},hasProperIntersection:function(){return this.hasProper},hasIntersection:function(){return this._hasIntersection},isDone:function(){return this._isDone},isBoundaryPoint:function(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))},setBoundaryNodes:function(t,e){this.bdyNodes=new Array(2).fill(null),this.bdyNodes[0]=t,this.bdyNodes[1]=e},addIntersections:function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,s,o,a),this.li.hasIntersection()&&(this.recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this.numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this.includeProper&&this.li.isProper()||(t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1)),this.li.isProper()&&(this.properIntersectionPoint=this.li.getIntersection(0).copy(),this.hasProper=!0,this.isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this.li,this.bdyNodes)||(this.hasProperInterior=!0))))},interfaces_:function(){return[]},getClass:function(){return bn}}),bn.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},ro(_n,Pn),io(_n.prototype,{prepareEvents:function(){xo.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},computeIntersections:function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof bn&&oo(arguments[0],m)&&oo(arguments[1],m)){var i=arguments[0],r=arguments[1],s=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(s)}else if("boolean"==typeof arguments[2]&&oo(arguments[0],m)&&arguments[1]instanceof bn){var o=arguments[0],a=arguments[1],u=arguments[2];u?this.addEdges(o,null):this.addEdges(o),this.computeIntersections(a)}},addEdge:function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var s=new Tn(n,r),o=new On(e,n.getMinX(r),s);this.events.add(o),this.events.add(new On(n.getMaxX(r),o))}},processOverlaps:function(t,e,n,i){for(var r=n.getObject(),s=t;s<e;s++){var o=this.events.get(s);if(o.isInsert()){var a=o.getObject();n.isSameLabel(o)||(r.computeIntersections(a,i),this.nOverlaps++)}}},addEdges:function(){if(1===arguments.length)for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.addEdge(n,n)}else if(2===arguments.length)for(var i=arguments[0],r=arguments[1],e=i.iterator();e.hasNext();){var n=e.next();this.addEdge(n,r)}},interfaces_:function(){return[]},getClass:function(){return _n}}),io(Mn.prototype,{getMin:function(){return this.min},intersects:function(t,e){return!(this.min>e||this.max<t)},getMax:function(){return this.max},toString:function(){return ee.toLineString(new c(this.min,0),new c(this.max,0))},interfaces_:function(){return[]},getClass:function(){return Mn}}),io(Dn.prototype,{compare:function(t,e){var n=t,i=e,r=(n.min+n.max)/2,s=(i.min+i.max)/2;return r<s?-1:r>s?1:0},interfaces_:function(){return[o]},getClass:function(){return Dn}}),Mn.NodeComparator=Dn,ro(An,Mn),io(An.prototype,{query:function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this.item)},interfaces_:function(){return[]},getClass:function(){return An}}),ro(Fn,Mn),io(Fn.prototype,{buildExtent:function(t,e){this.min=Math.min(t.min,e.min),this.max=Math.max(t.max,e.max)},query:function(t,e,n){if(!this.intersects(t,e))return null;null!==this.node1&&this.node1.query(t,e,n),null!==this.node2&&this.node2.query(t,e,n)},interfaces_:function(){return[]},getClass:function(){return Fn}}),io(Gn.prototype,{buildTree:function(){xo.sort(this.leaves,new IntervalRTreeNode.NodeComparator);for(var t=this.leaves,e=null,n=new x;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},insert:function(t,e,n){if(null!==this.root)throw new IllegalStateException("Index cannot be added to once it has been queried");this.leaves.add(new An(t,e,n))},query:function(t,e,n){this.init(),this.root.query(t,e,n)},buildRoot:function(){if(null!==this.root)return null;this.root=this.buildTree()},printNode:function(t){_.out.println(ee.toLineString(new c(t.min,this.level),new c(t.max,this.level)))},init:function(){if(null!==this.root)return null;this.buildRoot()},buildLevel:function(t,e){this.level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new Fn(t.get(n),t.get(n+1));e.add(r)}}},interfaces_:function(){return[]},getClass:function(){return Gn}}),io(qn.prototype,{filter:function(t){if(this.isForcedToLineString&&t instanceof Rt){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this.lines.add(e),null}t instanceof It&&this.lines.add(t)},setForceToLineString:function(t){this.isForcedToLineString=t},interfaces_:function(){return[A]},getClass:function(){return qn}}),qn.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(qn.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(qn.getLines(e,n))}},qn.getLines=function(){if(1===arguments.length){var t=arguments[0];return qn.getLines(t,!1)}if(2===arguments.length){if(oo(arguments[0],d)&&oo(arguments[1],d)){for(var e=arguments[0],n=arguments[1],i=e.iterator();i.hasNext();){var r=i.next();qn.getLines(r,n)}return n}if(arguments[0]instanceof F&&"boolean"==typeof arguments[1]){var s=arguments[0],o=arguments[1],a=new x;return s.apply(new qn(a,o)),a}if(arguments[0]instanceof F&&oo(arguments[1],d)){var u=arguments[0],l=arguments[1];return u instanceof It?l.add(u):u.apply(new qn(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&oo(arguments[0],d)&&oo(arguments[1],d)){for(var h=arguments[0],c=arguments[1],f=arguments[2],i=h.iterator();i.hasNext();){var r=i.next();qn.getLines(r,c,f)}return c}if("boolean"==typeof arguments[2]&&arguments[0]instanceof F&&oo(arguments[1],d)){var g=arguments[0],p=arguments[1],m=arguments[2];return g.apply(new qn(p,m)),p}}},io(Bn.prototype,{visitItem:function(t){this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[be]},getClass:function(){return Bn}}),io(Vn.prototype,{locate:function(t){var e=new se(t),n=new zn(e);return this.index.query(t.y,t.y,n),e.getLocation()},interfaces_:function(){return[Cn]},getClass:function(){return Vn}}),io(zn.prototype,{visitItem:function(t){var e=t;this.counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},interfaces_:function(){return[be]},getClass:function(){return zn}}),io(kn.prototype,{init:function(t){for(var e=qn.getLines(t),n=e.iterator();n.hasNext();){var i=n.next(),r=i.getCoordinates();this.addLine(r)}},addLine:function(t){for(var e=1;e<t.length;e++){var n=new ae(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this.index.insert(i,r,n)}},query:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Bn;return this.index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this.index.query(i,r,s)}},interfaces_:function(){return[]},getClass:function(){return kn}}),Vn.SegmentVisitor=zn,Vn.IntervalIndexedGeometry=kn,io(Yn.prototype,{getSegmentIndex:function(){return this.segmentIndex},getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},compareTo:function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},isEndPoint:function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},toString:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},getDistance:function(){return this.dist},compare:function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},interfaces_:function(){return[r]},getClass:function(){return Yn}}),io(Un.prototype,{print:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},addEndpoints:function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},createSplitEdge:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;var s=new Array(n).fill(null),o=0;s[o++]=new c(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)s[o++]=this.edge.pts[a];return r&&(s[o]=e.coord),new jn(s,new ln(this.edge.label))},add:function(t,e,n){var i=new Yn(t,e,n),r=this.nodeMap.get(i);return null!==r?r:(this.nodeMap.put(i,i),i)},isIntersection:function(t){for(var e=this.iterator();e.hasNext();){if(e.next().coord.equals(t))return!0}return!1},interfaces_:function(){return[]},getClass:function(){return Un}}),io(Xn.prototype,{getChainStartIndices:function(t){var e=0,n=new x;n.add(new R(e));do{var i=this.findChainEnd(t,e);n.add(new R(i)),e=i}while(e<t.length-1);return Xn.toIntArray(n)},findChainEnd:function(t,e){for(var n=je.quadrant(t[e],t[e+1]),i=e+1;i<t.length;){if(je.quadrant(t[i-1],t[i])!==n)break;i++}return i-1},interfaces_:function(){return[]},getClass:function(){return Xn}}),Xn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},io(Hn.prototype,{getCoordinates:function(){return this.pts},getMaxX:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},getMinX:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},computeIntersectsForChain:function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3],u=arguments[4],l=arguments[5],h=this.pts[r],c=this.pts[s],f=o.pts[a],g=o.pts[u];if(s-r==1&&u-a==1)return l.addIntersections(this.e,r,o.e,a),null;if(this.env1.init(h,c),this.env2.init(f,g),!this.env1.intersects(this.env2))return null;var d=Math.trunc((r+s)/2),p=Math.trunc((a+u)/2);r<d&&(a<p&&this.computeIntersectsForChain(r,d,o,a,p,l),p<u&&this.computeIntersectsForChain(r,d,o,p,u,l)),d<s&&(a<p&&this.computeIntersectsForChain(d,s,o,a,p,l),p<u&&this.computeIntersectsForChain(d,s,o,p,u,l))}},getStartIndexes:function(){return this.startIndex},computeIntersects:function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},interfaces_:function(){return[]},getClass:function(){return Hn}}),io(Wn.prototype,{getDepth:function(t,e){return this.depth[t][e]},setDepth:function(t,e,n){this.depth[t][e]=n},isNull:function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this.depth[t][e]!==Wn.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this.depth[n][1]===Wn.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this.depth[i][r]===Wn.NULL_VALUE}},normalize:function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this.depth[t][1];this.depth[t][2]<e&&(e=this.depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this.depth[t][n]>e&&(i=1),this.depth[t][n]=i}}},getDelta:function(t){return this.depth[t][an.RIGHT]-this.depth[t][an.LEFT]},getLocation:function(t,e){return this.depth[t][e]<=0?S.EXTERIOR:S.INTERIOR},toString:function(){return"A: "+this.depth[0][1]+","+this.depth[0][2]+" B: "+this.depth[1][1]+","+this.depth[1][2]},add:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var i=t.getLocation(e,n);i!==S.EXTERIOR&&i!==S.INTERIOR||(this.isNull(e,n)?this.depth[e][n]=Wn.depthAtLocation(i):this.depth[e][n]+=Wn.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];o===S.INTERIOR&&this.depth[r][s]++}},interfaces_:function(){return[]},getClass:function(){return Wn}}),Wn.depthAtLocation=function(t){return t===S.EXTERIOR?0:t===S.INTERIOR?1:Wn.NULL_VALUE},Wn.NULL_VALUE=-1,ro(jn,gn),io(jn.prototype,{getDepth:function(){return this.depth},getCollapsedEdge:function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new jn(t,ln.toLineLabel(this.label))},isIsolated:function(){return this._isIsolated},getCoordinates:function(){return this.pts},setIsolated:function(t){this._isIsolated=t},setName:function(t){this.name=t},equals:function(t){if(!(t instanceof jn))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var n=!0,i=!0,r=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(e.pts[s])||(n=!1),this.pts[s].equals2D(e.pts[--r])||(i=!1),!n&&!i)return!1;return!0},getCoordinate:function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},print:function(t){t.print("edge "+this.name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this.label+" "+this.depthDelta)},computeIM:function(t){jn.updateIM(this.label,t)},isCollapsed:function(){return!!this.label.isArea()&&(3===this.pts.length&&!!this.pts[0].equals(this.pts[2]))},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getMaximumSegmentIndex:function(){return this.pts.length-1},getDepthDelta:function(){return this.depthDelta},getNumPoints:function(){return this.pts.length},printReverse:function(t){t.print("edge "+this.name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},getMonotoneChainEdge:function(){return null===this.mce&&(this.mce=new Hn(this)),this.mce},getEnvelope:function(){if(null===this.env){this.env=new I;for(var t=0;t<this.pts.length;t++)this.env.expandToInclude(this.pts[t])}return this.env},addIntersection:function(t,e,n,i){var r=new c(t.getIntersection(i)),s=e,o=t.getEdgeDistance(n,i),a=s+1;if(a<this.pts.length){var u=this.pts[a];r.equals2D(u)&&(s=a,o=0)}this.eiList.add(r,s,o)},toString:function(){var t=new w;t.append("edge "+this.name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this.label+" "+this.depthDelta),t.toString()},isPointwiseEqual:function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},setDepthDelta:function(t){this.depthDelta=t},getEdgeIntersectionList:function(){return this.eiList},addIntersections:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},interfaces_:function(){return[]},getClass:function(){return jn}}),jn.updateIM=function(){if(2!==arguments.length)return gn.prototype.updateIM.apply(this,arguments);var t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,an.ON),t.getLocation(1,an.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,an.LEFT),t.getLocation(1,an.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,an.RIGHT),t.getLocation(1,an.RIGHT),2))},ro(Kn,xn),io(Kn.prototype,{insertBoundaryPoint:function(t,e){var n=this.nodes.addNode(e),i=n.getLabel(),r=1,s=S.NONE;(s=i.getLocation(t,an.ON))===S.BOUNDARY&&r++;var o=Kn.determineBoundary(this.boundaryNodeRule,r);i.setLocation(t,o)},computeSelfNodes:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],s=new bn(n,!0,!1);s.setIsDoneIfProperInt(r);var o=this.createEdgeSetIntersector(),a=this.parentGeom instanceof Rt||this.parentGeom instanceof Lt||this.parentGeom instanceof Tt,u=i||!a;return o.computeIntersections(this.edges,s,u),this.addSelfIntersectionNodes(this.argIndex),s}},computeSplitEdges:function(t){for(var e=this.edges.iterator();e.hasNext();){e.next().eiList.addSplitEdges(t)}},computeEdgeIntersections:function(t,e,n){var i=new bn(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this.edges,t.edges,i),i},getGeometry:function(){return this.parentGeom},getBoundaryNodeRule:function(){return this.boundaryNodeRule},hasTooFewPoints:function(){return this._hasTooFewPoints},addPoint:function(){if(arguments[0]instanceof Ct){var t=arguments[0],e=t.getCoordinate();this.insertPoint(this.argIndex,e,S.INTERIOR)}else if(arguments[0]instanceof c){var n=arguments[0];this.insertPoint(this.argIndex,n,S.INTERIOR)}},addPolygon:function(t){this.addPolygonRing(t.getExteriorRing(),S.EXTERIOR,S.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,S.INTERIOR,S.EXTERIOR)}},addEdge:function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this.argIndex,e[0],S.BOUNDARY),this.insertPoint(this.argIndex,e[e.length-1],S.BOUNDARY)},addLineString:function(t){var e=Y.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this.invalidPoint=e[0],null;var n=new jn(e,new ln(this.argIndex,S.INTERIOR));this.lineEdgeMap.put(t,n),this.insertEdge(n),h.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this.argIndex,e[0]),this.insertBoundaryPoint(this.argIndex,e[e.length-1])},getInvalidPoint:function(){return this.invalidPoint},getBoundaryPoints:function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},getBoundaryNodes:function(){return null===this.boundaryNodes&&(this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex)),this.boundaryNodes},addSelfIntersectionNode:function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===S.BOUNDARY&&this.useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},addPolygonRing:function(t,e,n){if(t.isEmpty())return null;var i=Y.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this.invalidPoint=i[0],null;var r=e,s=n;oe.isCCW(i)&&(r=n,s=e);var o=new jn(i,new ln(this.argIndex,S.BOUNDARY,r,s));this.lineEdgeMap.put(t,o),this.insertEdge(o),this.insertPoint(this.argIndex,i[0],S.BOUNDARY)},insertPoint:function(t,e,n){var i=this.nodes.addNode(e),r=i.getLabel();null===r?i.label=new ln(t,n):r.setLocation(t,n)},createEdgeSetIntersector:function(){return new _n},addSelfIntersectionNodes:function(t){for(var e=this.edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var s=r.next();this.addSelfIntersectionNode(t,s.coord,i)}},add:function(){if(1!==arguments.length)return xn.prototype.add.apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof Tt&&(this.useBoundaryDeterminationRule=!1),t instanceof Lt)this.addPolygon(t);else if(t instanceof It)this.addLineString(t);else if(t instanceof Ct)this.addPoint(t);else if(t instanceof wt)this.addCollection(t);else if(t instanceof ht)this.addCollection(t);else if(t instanceof Tt)this.addCollection(t);else{if(!(t instanceof lt))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},addCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},locate:function(t){return oo(this.parentGeom,St)&&this.parentGeom.getNumGeometries()>50?(null===this.areaPtLocator&&(this.areaPtLocator=new Vn(this.parentGeom)),this.areaPtLocator.locate(t)):this.ptLocator.locate(t,this.parentGeom)},findEdge:function(){if(1===arguments.length){var t=arguments[0];return this.lineEdgeMap.get(t)}return xn.prototype.findEdge.apply(this,arguments)},interfaces_:function(){return[]},getClass:function(){return Kn}}),Kn.determineBoundary=function(t,e){return t.isInBoundary(e)?S.BOUNDARY:S.INTERIOR},io(Zn.prototype,{getArgGeometry:function(t){return this.arg[t].getGeometry()},setComputationPrecision:function(t){this.resultPrecisionModel=t,this.li.setPrecisionModel(this.resultPrecisionModel)},interfaces_:function(){return[]},getClass:function(){return Zn}}),io(Qn.prototype,{compareTo:function(t){var e=t;return Qn.compareOriented(this.pts,this._orientation,e.pts,e._orientation)},interfaces_:function(){return[r]},getClass:function(){return Qn}}),Qn.orientation=function(t){return 1===Y.increasingDirection(t)},Qn.compareOriented=function(t,e,n,i){for(var r=e?1:-1,s=i?1:-1,o=e?t.length:-1,a=i?n.length:-1,u=e?0:t.length-1,l=i?0:n.length-1;;){var h=t[u].compareTo(n[l]);if(0!==h)return h;u+=r,l+=s;var c=u===o,f=l===a;if(c&&!f)return-1;if(!c&&f)return 1;if(c&&f)return 0}},io(Jn.prototype,{print:function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this.edges.size();e++){var n=this.edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},addAll:function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},findEdgeIndex:function(t){for(var e=0;e<this.edges.size();e++)if(this.edges.get(e).equals(t))return e;return-1},iterator:function(){return this.edges.iterator()},getEdges:function(){return this.edges},get:function(t){return this.edges.get(t)},findEqualEdge:function(t){var e=new Qn(t.getCoordinates());return this.ocaMap.get(e)},add:function(t){this.edges.add(t);var e=new Qn(t.getCoordinates());this.ocaMap.put(e,t)},interfaces_:function(){return[]},getClass:function(){return Jn}}),ro($n,Zn),io($n.prototype,{insertUniqueEdge:function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new ln(t.getLabel()),i.flip());var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this.edgeList.add(t)},getGraph:function(){return this.graph},cancelDuplicateResultEdges:function(){for(var t=this.graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},isCoveredByLA:function(t){
return!!this.isCovered(t,this.resultLineList)||!!this.isCovered(t,this.resultPolyList)},computeGeometry:function(t,e,n,i){var r=new x;return r.addAll(t),r.addAll(e),r.addAll(n),r.isEmpty()?$n.createEmptyResult(i,this.arg[0].getGeometry(),this.arg[1].getGeometry(),this.geomFact):this.geomFact.buildGeometry(r)},mergeSymLabels:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){t.next().getEdges().mergeSymLabels()}},isCovered:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this.ptLocator.locate(t,i)!==S.EXTERIOR)return!0}return!1},replaceCollapsedEdges:function(){for(var t=new x,e=this.edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this.edgeList.addAll(t)},updateNodeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},getResultGeometry:function(t){return this.computeOverlay(t),this.resultGeom},insertUniqueEdges:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},computeOverlay:function(t){this.copyPoints(0),this.copyPoints(1),this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1),this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!0);var e=new x;this.arg[0].computeSplitEdges(e),this.arg[1].computeSplitEdges(e);this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),sn.checkValid(this.edgeList.getEdges()),this.graph.addEdges(this.edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new En(this.geomFact);n.add(this.graph),this.resultPolyList=n.getPolygons();var i=new In(this,this.geomFact,this.ptLocator);this.resultLineList=i.build(t);var r=new Nn(this,this.geomFact,this.ptLocator);this.resultPointList=r.build(t),this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,t)},labelIncompleteNode:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setLocation(e,n)},copyPoints:function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next();this.graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},findResultAreaEdges:function(t){for(var e=this.graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&$n.isResultOfOp(i.getLocation(0,an.RIGHT),i.getLocation(1,an.RIGHT),t)&&n.setInResult(!0)}},computeLabelsFromDepths:function(){for(var t=this.edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(h.isTrue(!i.isNull(r,an.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,an.LEFT,i.getLocation(r,an.LEFT)),h.isTrue(!i.isNull(r,an.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,an.RIGHT,i.getLocation(r,an.RIGHT))))}}},computeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){t.next().getEdges().computeLabelling(this.arg)}this.mergeSymLabels(),this.updateNodeLabelling()},labelIncompleteNodes:function(){for(var t=0,e=this.graph.getNodes().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(t++,i.isNull(0)?this.labelIncompleteNode(n,0):this.labelIncompleteNode(n,1)),n.getEdges().updateLabelling(i)}},isCoveredByA:function(t){return!!this.isCovered(t,this.resultPolyList)},interfaces_:function(){return[]},getClass:function(){return $n}}),$n.overlayOp=function(t,e,n){return new $n(t,e).getResultGeometry(n)},$n.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return $n.createEmptyResult($n.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return on.map(t,{interfaces_:function(){return[MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ei.overlayOp(t,e,$n.INTERSECTION)},$n.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return $n.createEmptyResult($n.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ei.overlayOp(t,e,$n.SYMDIFFERENCE)},$n.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),s=-1;switch(t){case $n.INTERSECTION:s=Math.min(i,r);break;case $n.UNION:s=Math.max(i,r);break;case $n.DIFFERENCE:s=i;break;case $n.SYMDIFFERENCE:s=Math.max(i,r)}return s},$n.createEmptyResult=function(t,e,n,i){var r=null;switch($n.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},$n.difference=function(t,e){return t.isEmpty()?$n.createEmptyResult($n.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ei.overlayOp(t,e,$n.DIFFERENCE))},$n.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return $n.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];switch(r===S.BOUNDARY&&(r=S.INTERIOR),s===S.BOUNDARY&&(s=S.INTERIOR),o){case $n.INTERSECTION:return r===S.INTERIOR&&s===S.INTERIOR;case $n.UNION:return r===S.INTERIOR||s===S.INTERIOR;case $n.DIFFERENCE:return r===S.INTERIOR&&s!==S.INTERIOR;case $n.SYMDIFFERENCE:return r===S.INTERIOR&&s!==S.INTERIOR||r!==S.INTERIOR&&s===S.INTERIOR}return!1}},$n.INTERSECTION=1,$n.UNION=2,$n.DIFFERENCE=3,$n.SYMDIFFERENCE=4,io(ti.prototype,{selfSnap:function(t){return new ve(t).snapTo(t,this.snapTolerance)},removeCommonBits:function(t){this.cbr=new Ee,this.cbr.add(t[0]),this.cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this.cbr.removeCommonBits(t[0].copy()),e[1]=this.cbr.removeCommonBits(t[1].copy()),e},prepareResult:function(t){return this.cbr.addCommonBits(t),t},getResultGeometry:function(t){var e=this.snap(this.geom),n=$n.overlayOp(e[0],e[1],t);return this.prepareResult(n)},checkValid:function(t){t.isValid()||_.out.println("Snapped geometry is invalid")},computeSnapTolerance:function(){this.snapTolerance=ve.computeOverlaySnapTolerance(this.geom[0],this.geom[1])},snap:function(t){var e=this.removeCommonBits(t);return ve.snap(e[0],e[1],this.snapTolerance)},interfaces_:function(){return[]},getClass:function(){return ti}}),ti.overlayOp=function(t,e,n){return new ti(t,e).getResultGeometry(n)},ti.union=function(t,e){return ti.overlayOp(t,e,$n.UNION)},ti.intersection=function(t,e){return ti.overlayOp(t,e,$n.INTERSECTION)},ti.symDifference=function(t,e){return ti.overlayOp(t,e,$n.SYMDIFFERENCE)},ti.difference=function(t,e){return ti.overlayOp(t,e,$n.DIFFERENCE)},io(ei.prototype,{getResultGeometry:function(t){var e=null,n=!1,i=null;try{e=$n.overlayOp(this.geom[0],this.geom[1],t);n=!0}catch(t){if(!(t instanceof u))throw t;i=t}if(!n)try{e=ti.overlayOp(this.geom[0],this.geom[1],t)}catch(t){throw t instanceof u?i:t}return e},interfaces_:function(){return[]},getClass:function(){return ei}}),ei.overlayOp=function(t,e,n){return new ei(t,e).getResultGeometry(n)},ei.union=function(t,e){return ei.overlayOp(t,e,$n.UNION)},ei.intersection=function(t,e){return ei.overlayOp(t,e,$n.INTERSECTION)},ei.symDifference=function(t,e){return ei.overlayOp(t,e,$n.SYMDIFFERENCE)},ei.difference=function(t,e){return ei.overlayOp(t,e,$n.DIFFERENCE)},io(ni.prototype,{addPolygon:function(t){if(t.isEmpty())return null;var e=null,n=0,i=this.horizontalBisector(t);if(0===i.getLength())n=0,e=i.getCoordinate();else{var r=ei.overlayOp(i,t,$n.INTERSECTION),s=this.widestGeometry(r);n=s.getEnvelopeInternal().getWidth(),e=ni.centre(s.getEnvelopeInternal())}(null===this.interiorPoint||n>this.maxWidth)&&(this.interiorPoint=e,this.maxWidth=n)},getInteriorPoint:function(){return this.interiorPoint},widestGeometry:function(){if(arguments[0]instanceof lt){var t=arguments[0];if(t.isEmpty())return t;for(var e=t.getGeometryN(0),n=1;n<t.getNumGeometries();n++)t.getGeometryN(n).getEnvelopeInternal().getWidth()>e.getEnvelopeInternal().getWidth()&&(e=t.getGeometryN(n));return e}if(arguments[0]instanceof F){var i=arguments[0];return i instanceof lt?this.widestGeometry(i):i}},horizontalBisector:function(t){var e=t.getEnvelopeInternal(),n=ii.getBisectorY(t);return this.factory.createLineString([new c(e.getMinX(),n),new c(e.getMaxX(),n)])},add:function(t){if(t instanceof Lt)this.addPolygon(t);else if(t instanceof lt)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))},interfaces_:function(){return[]},getClass:function(){return ni}}),ni.centre=function(t){return new c(ni.avg(t.getMinX(),t.getMaxX()),ni.avg(t.getMinY(),t.getMaxY()))},ni.avg=function(t,e){return(t+e)/2},io(ii.prototype,{updateInterval:function(t){t<=this.centreY?t>this.loY&&(this.loY=t):t>this.centreY&&t<this.hiY&&(this.hiY=t)},getBisectorY:function(){this.process(this.poly.getExteriorRing());for(var t=0;t<this.poly.getNumInteriorRing();t++)this.process(this.poly.getInteriorRingN(t));return ni.avg(this.hiY,this.loY)},process:function(t){for(var e=t.getCoordinateSequence(),n=0;n<e.size();n++){var i=e.getY(n);this.updateInterval(i)}},interfaces_:function(){return[]},getClass:function(){return ii}}),ii.getBisectorY=function(t){return new ii(t).getBisectorY()},ni.SafeBisectorFinder=ii,io(ri.prototype,{addEndpoints:function(){if(arguments[0]instanceof F){var t=arguments[0];if(t instanceof It)this.addEndpoints(t.getCoordinates());else if(t instanceof lt)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addEndpoints(e.getGeometryN(n))}else if(arguments[0]instanceof Array){var i=arguments[0];this.add(i[0]),this.add(i[i.length-1])}},getInteriorPoint:function(){return this.interiorPoint},addInterior:function(){if(arguments[0]instanceof F){var t=arguments[0];if(t instanceof It)this.addInterior(t.getCoordinates());else if(t instanceof lt)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addInterior(e.getGeometryN(n))}else if(arguments[0]instanceof Array)for(var i=arguments[0],n=1;n<i.length-1;n++)this.add(i[n])},add:function(t){var e=t.distance(this.centroid);e<this.minDistance&&(this.interiorPoint=new c(t),this.minDistance=e)},interfaces_:function(){return[]},getClass:function(){return ri}}),io(si.prototype,{getInteriorPoint:function(){return this.interiorPoint},add:function(){if(arguments[0]instanceof F){var t=arguments[0];if(t instanceof Ct)this.add(t.getCoordinate());else if(t instanceof lt)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))}else if(arguments[0]instanceof c){var i=arguments[0],r=i.distance(this.centroid);r<this.minDistance&&(this.interiorPoint=new c(i),this.minDistance=r)}},interfaces_:function(){return[]},getClass:function(){return si}}),io(oi.prototype,{select:function(){if(1===arguments.length){arguments[0]}else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},interfaces_:function(){return[]},getClass:function(){return oi}}),io(ai.prototype,{hasChildren:function(){for(var t=0;t<2;t++)if(null!==this.subnode[t])return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var e=0;e<2;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},size:function(){for(var t=0,e=0;e<2;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,e){if(null!==t&&!this.isSearchMatch(t))return null;e.addAll(this.items),null!==this.subnode[0]&&this.subnode[0].addAllItemsFromOverlapping(t,e),null!==this.subnode[1]&&this.subnode[1].addAllItemsFromOverlapping(t,e)},hasItems:function(){return!this.items.isEmpty()},remove:function(t,e){if(!this.isSearchMatch(t))return!1;for(var n=!1,i=0;i<2;i++)if(null!==this.subnode[i]&&(n=this.subnode[i].remove(t,e))){this.subnode[i].isPrunable()&&(this.subnode[i]=null);break}return n||(n=this.items.remove(e))},getItems:function(){return this.items},depth:function(){for(var t=0,e=0;e<2;e++)if(null!==this.subnode[e]){var n=this.subnode[e].depth();n>t&&(t=n)}return t+1},nodeSize:function(){for(var t=0,e=0;e<2;e++)null!==this.subnode[e]&&(t+=this.subnode[e].nodeSize());return t+1},add:function(t){this.items.add(t)},interfaces_:function(){return[]},getClass:function(){return ai}}),ai.getSubnodeIndex=function(t,e){var n=-1;return t.min>=e&&(n=1),t.max<=e&&(n=0),n},io(ui.prototype,{expandToInclude:function(t){t.max>this.max&&(this.max=t.max),t.min<this.min&&(this.min=t.min)},getWidth:function(){return this.max-this.min},overlaps:function(){if(1===arguments.length){var t=arguments[0];return this.overlaps(t.min,t.max)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!(this.min>n||this.max<e)}},getMin:function(){return this.min},toString:function(){return"["+this.min+", "+this.max+"]"},contains:function(){if(1===arguments.length){if(arguments[0]instanceof ui){var t=arguments[0];return this.contains(t.min,t.max)}if("number"==typeof arguments[0]){var e=arguments[0];return e>=this.min&&e<=this.max}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return n>=this.min&&i<=this.max}},init:function(t,e){this.min=t,this.max=e,t>e&&(this.min=e,this.max=t)},getMax:function(){return this.max},interfaces_:function(){return[]},getClass:function(){return ui}}),li.exponent=function(t){return hi(64,t)-1023},li.powerOf2=function(t){return Math.pow(2,t)},io(ci.prototype,{getInterval:function(){return this.interval},getLevel:function(){return this.level},computeKey:function(t){for(this.level=ci.computeLevel(t),this.interval=new ui,this.computeInterval(this.level,t);!this.interval.contains(t);)this.level+=1,this.computeInterval(this.level,t)},computeInterval:function(t,e){var n=li.powerOf2(t);this.pt=Math.floor(e.getMin()/n)*n,this.interval.init(this.pt,this.pt+n)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return ci}}),ci.computeLevel=function(t){var e=t.getWidth();return li.exponent(e)+1},ro(fi,ai),io(fi.prototype,{getInterval:function(){return this.interval},find:function(t){var e=ai.getSubnodeIndex(t,this.centre);if(-1===e)return this;if(null!==this.subnode[e]){return this.subnode[e].find(t)}return this},insert:function(t){h.isTrue(null===this.interval||this.interval.contains(t.interval));var e=ai.getSubnodeIndex(t.interval,this.centre);if(t.level===this.level-1)this.subnode[e]=t;else{var n=this.createSubnode(e);n.insert(t),this.subnode[e]=n}},isSearchMatch:function(t){return t.overlaps(this.interval)},getSubnode:function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getNode:function(t){var e=ai.getSubnodeIndex(t,this.centre);if(-1!==e){return this.getSubnode(e).getNode(t)}return this},createSubnode:function(t){var e=0,n=0;switch(t){case 0:e=this.interval.getMin(),n=this.centre;break;case 1:e=this.centre,n=this.interval.getMax()}return new fi(new ui(e,n),this.level-1)},interfaces_:function(){return[]},getClass:function(){return fi}}),fi.createNode=function(t){var e=new ci(t);return new fi(e.getInterval(),e.getLevel())},fi.createExpanded=function(t,e){var n=new ui(e);null!==t&&n.expandToInclude(t.interval);var i=fi.createNode(n);return null!==t&&i.insert(t),i},io(gi.prototype,{interfaces_:function(){return[]},getClass:function(){return gi}});gi.isZeroWidth=function(t,e){var n=e-t;if(0===n)return!0;var i=Math.max(Math.abs(t),Math.abs(e)),r=n/i;return li.exponent(r)<=gi.MIN_BINARY_EXPONENT},gi.MIN_BINARY_EXPONENT=-50,ro(di,ai),io(di.prototype,{insert:function(t,e){var n=ai.getSubnodeIndex(t,di.origin);if(-1===n)return this.add(e),null;var i=this.subnode[n];if(null===i||!i.getInterval().contains(t)){var r=fi.createExpanded(i,t);this.subnode[n]=r}this.insertContained(this.subnode[n],t,e)},isSearchMatch:function(t){return!0},insertContained:function(t,e,n){h.isTrue(t.getInterval().contains(e));var i=gi.isZeroWidth(e.getMin(),e.getMax()),r=null;r=i?t.find(e):t.getNode(e),r.add(n)},interfaces_:function(){return[]},getClass:function(){return di}}),di.origin=0,io(pi.prototype,{size:function(){return null!==this.root?this.root.size():0},insert:function(t,e){this.collectStats(t);var n=pi.ensureExtent(t,this.minExtent);this.root.insert(n,e)},query:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];return this.query(new ui(t,t))}if(arguments[0]instanceof ui){var e=arguments[0],n=new x;return this.query(e,n),n}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.root.addAllItemsFromOverlapping(i,r)}},iterator:function(){var t=new x;return this.root.addAllItems(t),t.iterator()},remove:function(t,e){var n=pi.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},collectStats:function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e)},depth:function(){return null!==this.root?this.root.depth():0},nodeSize:function(){return null!==this.root?this.root.nodeSize():0},interfaces_:function(){return[]},getClass:function(){return pi}}),pi.ensureExtent=function(t,e){var n=t.getMin(),i=t.getMax();return n!==i?t:(n===i&&(n-=e/2,i=n+e/2),new ui(n,i))},io(mi.prototype,{isInside:function(t){},interfaces_:function(){return[]},getClass:function(){return mi}}),io(vi.prototype,{testLineSegment:function(t,e){var n=null,i=null,r=null,s=null,o=e.p0,a=e.p1;n=o.x-t.x,i=o.y-t.y,r=a.x-t.x,s=a.y-t.y,(i>0&&s<=0||s>0&&i<=0)&&0<re.signOfDet2x2(n,i,r,s)/(s-i)&&this.crossings++},buildIndex:function(){this.tree=new pi;for(var t=Y.removeRepeatedPoints(this.ring.getCoordinates()),e=Ke.getChains(t),n=0;n<e.size();n++){var i=e.get(n),r=i.getEnvelope();this.interval.min=r.getMinY(),this.interval.max=r.getMaxY(),this.tree.insert(this.interval,i)}},testMonotoneChain:function(t,e,n){n.select(t,e)},isInside:function(t){this.crossings=0;var e=new I(i.NEGATIVE_INFINITY,i.POSITIVE_INFINITY,t.y,t.y);this.interval.min=t.y,this.interval.max=t.y;for(var n=this.tree.query(this.interval),r=new yi(this,t),s=n.iterator();s.hasNext();){var o=s.next();this.testMonotoneChain(e,r,o)}return this.crossings%2==1},interfaces_:function(){return[mi]},getClass:function(){return vi}}),ro(yi,oi),io(yi.prototype,{select:function(){if(1!==arguments.length)return oi.prototype.select.apply(this,arguments);var t=arguments[0];this.mcp.testLineSegment(this.p,t)},interfaces_:function(){return[]},getClass:function(){return yi}}),vi.MCSelecter=yi,io(xi.prototype,{interfaces_:function(){return[]},getClass:function(){return xi}}),xi.toDegrees=function(t){return 180*t/Math.PI},xi.normalize=function(t){for(;t>Math.PI;)t-=xi.PI_TIMES_2;for(;t<=-Math.PI;)t+=xi.PI_TIMES_2;return t},xi.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},xi.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0},xi.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0},xi.interiorAngle=function(t,e,n){var i=xi.angle(e,t),r=xi.angle(e,n);return Math.abs(r-i)},xi.normalizePositive=function(t){if(t<0){for(;t<0;)t+=xi.PI_TIMES_2;t>=xi.PI_TIMES_2&&(t=0)}else{for(;t>=xi.PI_TIMES_2;)t-=xi.PI_TIMES_2;t<0&&(t=0)}return t},xi.angleBetween=function(t,e,n){var i=xi.angle(e,t),r=xi.angle(e,n);return xi.diff(i,r)},xi.diff=function(t,e){var n=null;return n=t<e?e-t:t-e,n>Math.PI&&(n=2*Math.PI-n),n},xi.toRadians=function(t){return t*Math.PI/180},xi.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?xi.COUNTERCLOCKWISE:n<0?xi.CLOCKWISE:xi.NONE},xi.angleBetweenOriented=function(t,e,n){var i=xi.angle(e,t),r=xi.angle(e,n),s=r-i;return s<=-Math.PI?s+xi.PI_TIMES_2:s>Math.PI?s-xi.PI_TIMES_2:s},xi.PI_TIMES_2=2*Math.PI,xi.PI_OVER_2=Math.PI/2,xi.PI_OVER_4=Math.PI/4,xi.COUNTERCLOCKWISE=oe.COUNTERCLOCKWISE,xi.CLOCKWISE=oe.CLOCKWISE,xi.NONE=oe.COLLINEAR,io(Ei.prototype,{area:function(){return Ei.area(this.p0,this.p1,this.p2)},signedArea:function(){return Ei.signedArea(this.p0,this.p1,this.p2)},interpolateZ:function(t){if(null===t)throw new n("Supplied point is null.");return Ei.interpolateZ(t,this.p0,this.p1,this.p2)},longestSideLength:function(){return Ei.longestSideLength(this.p0,this.p1,this.p2)},isAcute:function(){return Ei.isAcute(this.p0,this.p1,this.p2)},circumcentre:function(){return Ei.circumcentre(this.p0,this.p1,this.p2)},area3D:function(){return Ei.area3D(this.p0,this.p1,this.p2)},centroid:function(){return Ei.centroid(this.p0,this.p1,this.p2)},inCentre:function(){return Ei.inCentre(this.p0,this.p1,this.p2)},interfaces_:function(){return[]},getClass:function(){return Ei}}),Ei.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Ei.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Ei.det=function(t,e,n,i){return t*i-e*n},Ei.interpolateZ=function(t,e,n,i){var r=e.x,s=e.y,o=n.x-r,a=i.x-r,u=n.y-s,l=i.y-s,h=o*l-a*u,c=t.x-r,f=t.y-s,g=(l*c-a*f)/h,d=(-u*c+o*f)/h;return e.z+g*(n.z-e.z)+d*(i.z-e.z)},Ei.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),s=n.distance(t),o=i;return r>o&&(o=r),s>o&&(o=s),o},Ei.isAcute=function(t,e,n){return!!xi.isAcute(t,e,n)&&(!!xi.isAcute(e,n,t)&&!!xi.isAcute(n,t,e))},Ei.circumcentre=function(t,e,n){var i=n.x,r=n.y,s=t.x-i,o=t.y-r,a=e.x-i,u=e.y-r,l=2*Ei.det(s,o,a,u);return new c(i-Ei.det(o,s*s+o*o,u,a*a+u*u)/l,r+Ei.det(s,s*s+o*o,a,a*a+u*u)/l)},Ei.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y;return new M(new M(t.x+n/2,t.y+i/2,1),new M(t.x-i+n/2,t.y+n+i/2,1))},Ei.angleBisector=function(t,e,n){var i=e.distance(t),r=e.distance(n),s=i/(i+r),o=n.x-t.x,a=n.y-t.y;return new c(t.x+s*o,t.y+s*a)},Ei.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,s=e.z-t.z,o=n.x-t.x,a=n.y-t.y,u=n.z-t.z,l=r*u-s*a,h=s*o-i*u,c=i*a-r*o,f=l*l+h*h+c*c;return Math.sqrt(f)/2},Ei.centroid=function(t,e,n){return new c((t.x+e.x+n.x)/3,(t.y+e.y+n.y)/3)},Ei.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),s=t.distance(e),o=i+r+s;return new c((i*t.x+r*e.x+s*n.x)/o,(i*t.y+r*e.y+s*n.y)/o)},io(Ii.prototype,{getRadius:function(){return this.compute(),this.radius},getDiameter:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],e=this.extremalPts[1];return this.input.getFactory().createLineString([t,e])},getExtremalPoints:function(){return this.compute(),this.extremalPts},computeCirclePoints:function(){if(this.input.isEmpty())return this.extremalPts=new Array(0).fill(null),null;if(1===this.input.getNumPoints()){var t=this.input.getCoordinates();return this.extremalPts=[new c(t[0])],null}var e=this.input.convexHull(),n=e.getCoordinates(),t=n;if(n[0].equals2D(n[n.length-1])&&(t=new Array(n.length-1).fill(null),Y.copyDeep(n,0,t,0,n.length-1)),t.length<=2)return this.extremalPts=Y.copyDeep(t),null;for(var i=Ii.lowestPoint(t),r=Ii.pointWitMinAngleWithX(t,i),s=0;s<t.length;s++){var o=Ii.pointWithMinAngleWithSegment(t,i,r);if(xi.isObtuse(i,o,r))return this.extremalPts=[new c(i),new c(r)],null;if(xi.isObtuse(o,i,r))i=o;else{if(!xi.isObtuse(o,r,i))return this.extremalPts=[new c(i),new c(r),new c(o)],null;r=o}}h.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")},compute:function(){if(null!==this.extremalPts)return null;this.computeCirclePoints(),this.computeCentre(),null!==this.centre&&(this.radius=this.centre.distance(this.extremalPts[0]))},getFarthestPoints:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],e=this.extremalPts[this.extremalPts.length-1];return this.input.getFactory().createLineString([t,e])},getCircle:function(){if(this.compute(),null===this.centre)return this.input.getFactory().createPolygon();var t=this.input.getFactory().createPoint(this.centre);return 0===this.radius?t:t.buffer(this.radius)},getCentre:function(){return this.compute(),this.centre},computeCentre:function(){switch(this.extremalPts.length){case 0:this.centre=null;break;case 1:this.centre=this.extremalPts[0];break;case 2:this.centre=new c((this.extremalPts[0].x+this.extremalPts[1].x)/2,(this.extremalPts[0].y+this.extremalPts[1].y)/2);break;case 3:this.centre=Ei.circumcentre(this.extremalPts[0],this.extremalPts[1],this.extremalPts[2])}},interfaces_:function(){return[]},getClass:function(){return Ii}}),Ii.pointWitMinAngleWithX=function(t,e){for(var n=i.MAX_VALUE,r=null,s=0;s<t.length;s++){var o=t[s];if(o!==e){var a=o.x-e.x,u=o.y-e.y;u<0&&(u=-u);var l=Math.sqrt(a*a+u*u),h=u/l;h<n&&(n=h,r=o)}}return r},Ii.lowestPoint=function(t){for(var e=t[0],n=1;n<t.length;n++)t[n].y<e.y&&(e=t[n]);return e},Ii.pointWithMinAngleWithSegment=function(t,e,n){for(var r=i.MAX_VALUE,s=null,o=0;o<t.length;o++){var a=t[o];if(a!==e&&a!==n){var u=xi.angleBetween(e,a,n);u<r&&(r=u,s=a)}}return s},io(Ni.prototype,{getWidthCoordinate:function(){return this.computeMinimumDiameter(),this.minWidthPt},getSupportingSegment:function(){return this.computeMinimumDiameter(),this.inputGeom.getFactory().createLineString([this.minBaseSeg.p0,this.minBaseSeg.p1])},getDiameter:function(){if(this.computeMinimumDiameter(),null===this.minWidthPt)return this.inputGeom.getFactory().createLineString(null);var t=this.minBaseSeg.project(this.minWidthPt);return this.inputGeom.getFactory().createLineString([t,this.minWidthPt])},computeWidthConvex:function(t){this.convexHullPts=t instanceof Lt?t.getExteriorRing().getCoordinates():t.getCoordinates(),0===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=null,this.minBaseSeg=null):1===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[0]):2===this.convexHullPts.length||3===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[1]):this.computeConvexRingMinDiameter(this.convexHullPts)},computeConvexRingMinDiameter:function(t){this.minWidth=i.MAX_VALUE;for(var e=1,n=new ae,r=0;r<t.length-1;r++)n.p0=t[r],n.p1=t[r+1],e=this.findMaxPerpDistance(t,n,e)},computeMinimumDiameter:function(){if(null!==this.minWidthPt)return null;if(this.isConvex)this.computeWidthConvex(this.inputGeom);else{var t=new ge(this.inputGeom).getConvexHull();this.computeWidthConvex(t)}},getLength:function(){return this.computeMinimumDiameter(),this.minWidth},findMaxPerpDistance:function(t,e,n){for(var i=e.distancePerpendicular(t[n]),r=i,s=n,o=s;r>=i;)i=r,s=o,o=Ni.nextIndex(t,s),r=e.distancePerpendicular(t[o]);return i<this.minWidth&&(this.minPtIndex=s,this.minWidth=i,this.minWidthPt=t[this.minPtIndex],this.minBaseSeg=new ae(e)),s},getMinimumRectangle:function(){if(this.computeMinimumDiameter(),0===this.minWidth)return this.minBaseSeg.p0.equals2D(this.minBaseSeg.p1)?this.inputGeom.getFactory().createPoint(this.minBaseSeg.p0):this.minBaseSeg.toGeometry(this.inputGeom.getFactory());for(var t=this.minBaseSeg.p1.x-this.minBaseSeg.p0.x,e=this.minBaseSeg.p1.y-this.minBaseSeg.p0.y,n=i.MAX_VALUE,r=-i.MAX_VALUE,s=i.MAX_VALUE,o=-i.MAX_VALUE,a=0;a<this.convexHullPts.length;a++){var u=Ni.computeC(t,e,this.convexHullPts[a]);u>r&&(r=u),u<n&&(n=u);var l=Ni.computeC(-e,t,this.convexHullPts[a]);l>o&&(o=l),l<s&&(s=l)}var h=Ni.computeSegmentForLine(-t,-e,o),c=Ni.computeSegmentForLine(-t,-e,s),f=Ni.computeSegmentForLine(-e,t,r),g=Ni.computeSegmentForLine(-e,t,n),d=f.lineIntersection(h),p=g.lineIntersection(h),m=g.lineIntersection(c),v=f.lineIntersection(c),y=this.inputGeom.getFactory().createLinearRing([d,p,m,v,d]);return this.inputGeom.getFactory().createPolygon(y,null)},interfaces_:function(){return[]},getClass:function(){return Ni}}),Ni.nextIndex=function(t,e){return e++,e>=t.length&&(e=0),e},Ni.computeC=function(t,e,n){return t*n.y-e*n.x},Ni.getMinimumDiameter=function(t){return new Ni(t).getDiameter()},Ni.getMinimumRectangle=function(t){return new Ni(t).getMinimumRectangle()},Ni.computeSegmentForLine=function(t,e,n){var i=null,r=null;return Math.abs(e)>Math.abs(t)?(i=new c(0,n/e),r=new c(1,n/e-t/e)):(i=new c(n/t,0),r=new c(n/t-e/t,1)),new ae(i,r)};var Eo=Object.freeze({Centroid:le,CGAlgorithms:oe,ConvexHull:ge,InteriorPointArea:ni,InteriorPointLine:ri,InteriorPointPoint:si,RobustLineIntersector:ie,MCPointInRing:vi,MinimumBoundingCircle:Ii,MinimumDiameter:Ni});io(Ci.prototype,{getResultGeometry:function(){return new Si(this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(t<=0)throw new n("Tolerance must be positive");this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return Ci}}),Ci.densifyPoints=function(t,e,n){for(var i=new ae,r=new E,s=0;s<t.length-1;s++){i.p0=t[s],i.p1=t[s+1],r.add(i.p0,!1);var o=i.getLength(),a=Math.trunc(o/e)+1;if(a>1)for(var u=o/a,l=1;l<a;l++){var h=l*u/o,c=i.pointAlong(h);n.makePrecise(c),r.add(c,!1)}}return r.add(t[t.length-1],!1),r.toCoordinateArray()},Ci.densify=function(t,e){var n=new Ci(t);return n.setDistanceTolerance(e),n.getResultGeometry()},ro(Si,pe),io(Si.prototype,{transformMultiPolygon:function(t,e){var n=pe.prototype.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)},transformPolygon:function(t,e){var n=pe.prototype.transformPolygon.call(this,t,e);return e instanceof Tt?n:this.createValidArea(n)},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),i=Ci.densifyPoints(n,this.distanceTolerance,e.getPrecisionModel());return e instanceof It&&1===i.length&&(i=new Array(0).fill(null)),this.factory.getCoordinateSequenceFactory().create(i)},createValidArea:function(t){return t.buffer(0)},interfaces_:function(){return[]},getClass:function(){return Si}}),Ci.DensifyTransformer=Si;var Io=Object.freeze({Densifier:Ci});io(Li.prototype,{find:function(t){var e=this;do{if(null===e)return null;if(e.dest().equals2D(t))return e;e=e.oNext()}while(e!==this);return null},dest:function(){return this._sym._orig},oNext:function(){return this._sym._next},insert:function(t){if(this.oNext()===this)return this.insertAfter(t),null;var e=this.compareTo(t),n=this;do{var i=n.oNext();if(i.compareTo(t)!==e||i===this)return n.insertAfter(t),null;n=i}while(n!==this);h.shouldNeverReachHere()},insertAfter:function(t){h.equals(this._orig,t.orig());var e=this.oNext();this._sym.setNext(t),t.sym().setNext(e)},degree:function(){var t=0,e=this;do{t++,e=e.oNext()}while(e!==this);return t},equals:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this._orig.equals2D(t)&&this._sym._orig.equals(e)}},deltaY:function(){return this._sym._orig.y-this._orig.y},sym:function(){return this._sym},prev:function(){return this._sym.next()._sym},compareAngularDirection:function(t){var e=this.deltaX(),n=this.deltaY(),i=t.deltaX(),r=t.deltaY();if(e===i&&n===r)return 0;var s=je.quadrant(e,n),o=je.quadrant(i,r);return s>o?1:s<o?-1:oe.computeOrientation(t._orig,t.dest(),this.dest())},prevNode:function(){for(var t=this;2===t.degree();)if((t=t.prev())===this)return null;return t},compareTo:function(t){var e=t;return this.compareAngularDirection(e)},next:function(){return this._next},setSym:function(t){this._sym=t},orig:function(){return this._orig},toString:function(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"},setNext:function(t){this._next=t},init:function(t){this.setSym(t),t.setSym(this),this.setNext(t),t.setNext(this)},deltaX:function(){return this._sym._orig.x-this._orig.x},interfaces_:function(){return[]},getClass:function(){return Li}}),Li.init=function(t,e){
if(null!==t._sym||null!==e._sym||null!==t._next||null!==e._next)throw new IllegalStateException("Edges are already initialized");return t.init(e),t},Li.create=function(t,e){var n=new Li(t),i=new Li(e);return n.init(i),n},ro(wi,Li),io(wi.prototype,{mark:function(){this._isMarked=!0},setMark:function(t){this._isMarked=t},isMarked:function(){return this._isMarked},interfaces_:function(){return[]},getClass:function(){return wi}}),wi.setMarkBoth=function(t,e){t.setMark(e),t.sym().setMark(e)},wi.isMarked=function(t){return t.isMarked()},wi.setMark=function(t,e){t.setMark(e)},wi.markBoth=function(t){t.mark(),t.sym().mark()},wi.mark=function(t){t.mark()},io(Ri.prototype,{insert:function(t,e,n){var i=this.create(t,e);null!==n?n.insert(i):this.vertexMap.put(t,i);var r=this.vertexMap.get(e);return null!==r?r.insert(i.sym()):this.vertexMap.put(e,i.sym()),i},create:function(t,e){var n=this.createEdge(t),i=this.createEdge(e);return Li.init(n,i),n},createEdge:function(t){return new Li(t)},addEdge:function(t,e){if(!Ri.isValidEdge(t,e))return null;var n=this.vertexMap.get(t),i=null;return null!==n&&(i=n.find(e)),null!==i?i:this.insert(t,e,n)},getVertexEdges:function(){return this.vertexMap.values()},findEdge:function(t,e){var n=this.vertexMap.get(t);return null===n?null:n.find(e)},interfaces_:function(){return[]},getClass:function(){return Ri}}),Ri.isValidEdge=function(t,e){return 0!==e.compareTo(t)},ro(Ti,wi),io(Ti.prototype,{setStart:function(){this._isStart=!0},isStart:function(){return this._isStart},interfaces_:function(){return[]},getClass:function(){return Ti}}),ro(Oi,Ri),io(Oi.prototype,{createEdge:function(t){return new Ti(t)},interfaces_:function(){return[]},getClass:function(){return Oi}}),io(Pi.prototype,{addLine:function(t){this.lines.add(this.factory.createLineString(t.toCoordinateArray()))},updateRingStartEdge:function(t){return t.isStart()||(t=t.sym(),t.isStart())?null===this.ringStartEdge?(this.ringStartEdge=t,null):void(t.orig().compareTo(this.ringStartEdge.orig())<0&&(this.ringStartEdge=t)):null},getResult:function(){return null===this.result&&this.computeResult(),this.result},process:function(t){var e=t.prevNode();null===e&&(e=t),this.stackEdges(e),this.buildLines()},buildRing:function(t){var e=new E,n=t;for(e.add(n.orig().copy(),!1);2===n.sym().degree();){var i=n.next();if(i===t)break;e.add(i.orig().copy(),!1),n=i}e.add(n.dest().copy(),!1),this.addLine(e)},buildLine:function(t){var e=new E,n=t;for(this.ringStartEdge=null,wi.markBoth(n),e.add(n.orig().copy(),!1);2===n.sym().degree();){this.updateRingStartEdge(n);var i=n.next();if(i===t)return this.buildRing(this.ringStartEdge),null;e.add(i.orig().copy(),!1),n=i,wi.markBoth(n)}e.add(n.dest().copy(),!1),this.stackEdges(n.sym()),this.addLine(e)},stackEdges:function(t){var e=t;do{wi.isMarked(e)||this.nodeEdgeStack.add(e),e=e.oNext()}while(e!==t)},computeResult:function(){for(var t=this.graph.getVertexEdges(),e=t.iterator();e.hasNext();){var n=e.next();wi.isMarked(n)||this.process(n)}this.result=this.factory.buildGeometry(this.lines)},buildLines:function(){for(;!this.nodeEdgeStack.empty();){var t=this.nodeEdgeStack.pop();wi.isMarked(t)||this.buildLine(t)}},add:function(){if(arguments[0]instanceof F){arguments[0].apply({interfaces_:function(){return[A]},filter:function(t){t instanceof It&&this.add(t)}})}else if(oo(arguments[0],d))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.add(n)}else if(arguments[0]instanceof It){var i=arguments[0];null===this.factory&&(this.factory=i.getFactory());for(var r=i.getCoordinateSequence(),s=!1,e=1;e<r.size();e++){var o=this.graph.addEdge(r.getCoordinate(e-1),r.getCoordinate(e));null!==o&&(s||(o.setStart(),s=!0))}}},interfaces_:function(){return[]},getClass:function(){return Pi}}),Pi.dissolve=function(t){var e=new Pi;return e.add(t),e.getResult()};var No=Object.freeze({LineDissolver:Pi}),Co=Object.freeze({GeometryGraph:Kn});io(bi.prototype,{hasChildren:function(){for(var t=0;t<4;t++)if(null!==this.subnode[t])return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var e=0;e<4;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},getNodeCount:function(){for(var t=0,e=0;e<4;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+1},size:function(){for(var t=0,e=0;e<4;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,e){if(!this.isSearchMatch(t))return null;e.addAll(this.items);for(var n=0;n<4;n++)null!==this.subnode[n]&&this.subnode[n].addAllItemsFromOverlapping(t,e)},visitItems:function(t,e){for(var n=this.items.iterator();n.hasNext();)e.visitItem(n.next())},hasItems:function(){return!this.items.isEmpty()},remove:function(t,e){if(!this.isSearchMatch(t))return!1;for(var n=!1,i=0;i<4;i++)if(null!==this.subnode[i]&&(n=this.subnode[i].remove(t,e))){this.subnode[i].isPrunable()&&(this.subnode[i]=null);break}return n||(n=this.items.remove(e))},visit:function(t,e){if(!this.isSearchMatch(t))return null;this.visitItems(t,e);for(var n=0;n<4;n++)null!==this.subnode[n]&&this.subnode[n].visit(t,e)},getItems:function(){return this.items},depth:function(){for(var t=0,e=0;e<4;e++)if(null!==this.subnode[e]){var n=this.subnode[e].depth();n>t&&(t=n)}return t+1},isEmpty:function(){var t=!0;this.items.isEmpty()||(t=!1);for(var e=0;e<4;e++)null!==this.subnode[e]&&(this.subnode[e].isEmpty()||(t=!1));return t},add:function(t){this.items.add(t)},interfaces_:function(){return[a]},getClass:function(){return bi}}),bi.getSubnodeIndex=function(t,e,n){var i=-1;return t.getMinX()>=e&&(t.getMinY()>=n&&(i=3),t.getMaxY()<=n&&(i=1)),t.getMaxX()<=e&&(t.getMinY()>=n&&(i=2),t.getMaxY()<=n&&(i=0)),i},io(_i.prototype,{getLevel:function(){return this.level},computeKey:function(){if(1===arguments.length){var t=arguments[0];for(this.level=_i.computeQuadLevel(t),this.env=new I,this.computeKey(this.level,t);!this.env.contains(t);)this.level+=1,this.computeKey(this.level,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=li.powerOf2(e);this.pt.x=Math.floor(n.getMinX()/i)*i,this.pt.y=Math.floor(n.getMinY()/i)*i,this.env.init(this.pt.x,this.pt.x+i,this.pt.y,this.pt.y+i)}},getEnvelope:function(){return this.env},getCentre:function(){return new c((this.env.getMinX()+this.env.getMaxX())/2,(this.env.getMinY()+this.env.getMaxY())/2)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return _i}}),_i.computeQuadLevel=function(t){var e=t.getWidth(),n=t.getHeight(),i=e>n?e:n;return li.exponent(i)+1},ro(Mi,bi),io(Mi.prototype,{find:function(t){var e=bi.getSubnodeIndex(t,this.centrex,this.centrey);if(-1===e)return this;if(null!==this.subnode[e]){return this.subnode[e].find(t)}return this},isSearchMatch:function(t){return this.env.intersects(t)},getSubnode:function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getEnvelope:function(){return this.env},getNode:function(t){var e=bi.getSubnodeIndex(t,this.centrex,this.centrey);if(-1!==e){return this.getSubnode(e).getNode(t)}return this},createSubnode:function(t){var e=0,n=0,i=0,r=0;switch(t){case 0:e=this.env.getMinX(),n=this.centrex,i=this.env.getMinY(),r=this.centrey;break;case 1:e=this.centrex,n=this.env.getMaxX(),i=this.env.getMinY(),r=this.centrey;break;case 2:e=this.env.getMinX(),n=this.centrex,i=this.centrey,r=this.env.getMaxY();break;case 3:e=this.centrex,n=this.env.getMaxX(),i=this.centrey,r=this.env.getMaxY()}return new Mi(new I(e,n,i,r),this.level-1)},insertNode:function(t){h.isTrue(null===this.env||this.env.contains(t.env));var e=bi.getSubnodeIndex(t.env,this.centrex,this.centrey);if(t.level===this.level-1)this.subnode[e]=t;else{var n=this.createSubnode(e);n.insertNode(t),this.subnode[e]=n}},interfaces_:function(){return[]},getClass:function(){return Mi}}),Mi.createNode=function(t){var e=new _i(t);return new Mi(e.getEnvelope(),e.getLevel())},Mi.createExpanded=function(t,e){var n=new I(e);null!==t&&n.expandToInclude(t.env);var i=Mi.createNode(n);return null!==t&&i.insertNode(t),i},ro(Di,bi),io(Di.prototype,{insert:function(t,e){var n=bi.getSubnodeIndex(t,Di.origin.x,Di.origin.y);if(-1===n)return this.add(e),null;var i=this.subnode[n];if(null===i||!i.getEnvelope().contains(t)){var r=Mi.createExpanded(i,t);this.subnode[n]=r}this.insertContained(this.subnode[n],t,e)},isSearchMatch:function(t){return!0},insertContained:function(t,e,n){h.isTrue(t.getEnvelope().contains(e));var i=gi.isZeroWidth(e.getMinX(),e.getMaxX()),r=gi.isZeroWidth(e.getMinY(),e.getMaxY()),s=null;s=i||r?t.find(e):t.getNode(e),s.add(n)},interfaces_:function(){return[]},getClass:function(){return Di}}),Di.origin=new c(0,0),io(Ai.prototype,{size:function(){return null!==this.root?this.root.size():0},insert:function(t,e){this.collectStats(t);var n=Ai.ensureExtent(t,this.minExtent);this.root.insert(n,e)},query:function(){if(1===arguments.length){var t=arguments[0],e=new Bn;return this.query(t,e),e.getItems()}if(2===arguments.length){var n=arguments[0],i=arguments[1];this.root.visit(n,i)}},queryAll:function(){var t=new x;return this.root.addAllItems(t),t},remove:function(t,e){var n=Ai.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},collectStats:function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e);var n=t.getHeight();n<this.minExtent&&n>0&&(this.minExtent=n)},depth:function(){return null!==this.root?this.root.depth():0},isEmpty:function(){return null===this.root},interfaces_:function(){return[_e,a]},getClass:function(){return Ai}}),Ai.ensureExtent=function(t,e){var n=t.getMinX(),i=t.getMaxX(),r=t.getMinY(),s=t.getMaxY();return n!==i&&r!==s?t:(n===i&&(n-=e/2,i=n+e/2),r===s&&(r-=e/2,s=r+e/2),new I(n,i,r,s))},Ai.serialVersionUID=-0x678b60c967a25400;var So=Object.freeze({Quadtree:Ai}),Lo=Object.freeze({STRtree:qe}),wo=Object.freeze({quadtree:So,strtree:Lo}),Ro=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];io(Fi.prototype,{read:function(t){var e=void 0;e="string"==typeof t?JSON.parse(t):t;var n=e.type;if(!To[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==Ro.indexOf(n)?To[n].apply(this,[e.coordinates]):"GeometryCollection"===n?To[n].apply(this,[e.geometries]):To[n].apply(this,[e])},write:function(t){var e=t.getGeometryType();if(!Oo[e])throw new Error("Geometry is not supported");return Oo[e].apply(this,[t])}});var To={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!To[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=To.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new c(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new c(t[0],t[1]),new c(t[2],t[1]),new c(t[2],t[3]),new c(t[0],t[3]),new c(t[0],t[1])])},Point:function(t){var e=new c(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(To.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=To.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(To.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=To.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var s=t[r],o=To.coordinates.apply(this,[s]),a=this.geometryFactory.createLinearRing(o);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(To.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},Oo={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:Oo.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=Oo.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(Oo.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=Oo.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=Oo.LineString.apply(this,[t.shell]);e.push(n.coordinates);for(var i=0;i<t.holes.length;++i){var r=t.holes[i],s=Oo.LineString.apply(this,[r]);e.push(s.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=Oo.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=i.getGeometryType();e.push(Oo[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}};io(Gi.prototype,{read:function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Qt.FIXED&&this.reducePrecision(e),e},reducePrecision:function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])}}),io(qi.prototype,{write:function(t){return this.parser.write(t)}}),io(Bi.prototype,{read:function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Qt.FIXED&&this.reducePrecision(e),e},reducePrecision:function(t){if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(var e=0,n=t.points.coordinates.length;e<n;e++)this.precisionModel.makePrecise(t.points.coordinates[e]);else if(t.geometries)for(var i=0,r=t.geometries.length;i<r;i++)this.reducePrecision(t.geometries[i])}}),io(zi.prototype,{read:function(t){var e=this.ol;return t instanceof e.geom.Point?this.convertFromPoint(t):t instanceof e.geom.LineString?this.convertFromLineString(t):t instanceof e.geom.LinearRing?this.convertFromLinearRing(t):t instanceof e.geom.Polygon?this.convertFromPolygon(t):t instanceof e.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof e.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof e.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof e.geom.GeometryCollection?this.convertFromCollection(t):void 0},convertFromPoint:function(t){var e=t.getCoordinates();return this.geometryFactory.createPoint(new c(e[0],e[1]))},convertFromLineString:function(t){return this.geometryFactory.createLineString(t.getCoordinates().map(function(t){return new c(t[0],t[1])}))},convertFromLinearRing:function(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map(function(t){return new c(t[0],t[1])}))},convertFromPolygon:function(t){for(var e=t.getLinearRings(),n=null,i=[],r=0;r<e.length;r++){var s=this.convertFromLinearRing(e[r]);0===r?n=s:i.push(s)}return this.geometryFactory.createPolygon(n,i)},convertFromMultiPoint:function(t){var e=t.getPoints().map(function(t){return this.convertFromPoint(t)},this);return this.geometryFactory.createMultiPoint(e)},convertFromMultiLineString:function(t){var e=t.getLineStrings().map(function(t){return this.convertFromLineString(t)},this);return this.geometryFactory.createMultiLineString(e)},convertFromMultiPolygon:function(t){var e=t.getPolygons().map(function(t){return this.convertFromPolygon(t)},this);return this.geometryFactory.createMultiPolygon(e)},convertFromCollection:function(t){var e=t.getGeometries().map(function(t){return this.read(t)},this);return this.geometryFactory.createGeometryCollection(e)},write:function(t){return"Point"===t.getGeometryType()?this.convertToPoint(t.getCoordinate()):"LineString"===t.getGeometryType()?this.convertToLineString(t):"LinearRing"===t.getGeometryType()?this.convertToLinearRing(t):"Polygon"===t.getGeometryType()?this.convertToPolygon(t):"MultiPoint"===t.getGeometryType()?this.convertToMultiPoint(t):"MultiLineString"===t.getGeometryType()?this.convertToMultiLineString(t):"MultiPolygon"===t.getGeometryType()?this.convertToMultiPolygon(t):"GeometryCollection"===t.getGeometryType()?this.convertToCollection(t):void 0},convertToPoint:function(t){return new this.ol.geom.Point([t.x,t.y])},convertToLineString:function(t){var e=t.points.coordinates.map(Vi);return new this.ol.geom.LineString(e)},convertToLinearRing:function(t){var e=t.points.coordinates.map(Vi);return new this.ol.geom.LinearRing(e)},convertToPolygon:function(t){for(var e=[t.shell.points.coordinates.map(Vi)],n=0;n<t.holes.length;n++)e.push(t.holes[n].points.coordinates.map(Vi));return new this.ol.geom.Polygon(e)},convertToMultiPoint:function(t){return new this.ol.geom.MultiPoint(t.getCoordinates().map(Vi))},convertToMultiLineString:function(t){for(var e=[],n=0;n<t.geometries.length;n++)e.push(this.convertToLineString(t.geometries[n]).getCoordinates());return new this.ol.geom.MultiLineString(e)},convertToMultiPolygon:function(t){for(var e=[],n=0;n<t.geometries.length;n++)e.push(this.convertToPolygon(t.geometries[n]).getCoordinates());return new this.ol.geom.MultiPolygon(e)},convertToCollection:function(t){for(var e=[],n=0;n<t.geometries.length;n++){var i=t.geometries[n];e.push(this.write(i))}return new this.ol.geom.GeometryCollection(e)}});var Po=Object.freeze({GeoJSONReader:Gi,GeoJSONWriter:qi,OL3Parser:zi,WKTReader:Bi,WKTWriter:ee});io(ki.prototype,{rescale:function(){if(oo(arguments[0],d))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.rescale(n.getCoordinates())}else if(arguments[0]instanceof Array){var i=arguments[0];2===i.length&&(new c(i[0]),new c(i[1]));for(var e=0;e<i.length;e++)i[e].x=i[e].x/this.scaleFactor+this.offsetX,i[e].y=i[e].y/this.scaleFactor+this.offsetY;2===i.length&&i[0].equals2D(i[1])&&_.out.println(i)}},scale:function(){if(oo(arguments[0],d)){for(var t=arguments[0],e=new x,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Xe(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],s=new Array(r.length).fill(null),n=0;n<r.length;n++)s[n]=new c(Math.round((r[n].x-this.offsetX)*this.scaleFactor),Math.round((r[n].y-this.offsetY)*this.scaleFactor),r[n].z);return Y.removeRepeatedPoints(s)}},isIntegerPrecision:function(){return 1===this.scaleFactor},getNodedSubstrings:function(){var t=this.noder.getNodedSubstrings();return this.isScaled&&this.rescale(t),t},computeNodes:function(t){var e=t;this.isScaled&&(e=this.scale(t)),this.noder.computeNodes(e)},interfaces_:function(){return[Ze]},getClass:function(){return ki}});var bo=Object.freeze({MCIndexNoder:Je,ScaledNoder:ki,SegmentString:we});io(Yi.prototype,{isSimpleMultiPoint:function(t){if(t.isEmpty())return!0;for(var e=new rt,n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n),r=i.getCoordinate();if(e.contains(r))return this.nonSimpleLocation=r,!1;e.add(r)}return!0},isSimplePolygonal:function(t){for(var e=qn.getLines(t),n=e.iterator();n.hasNext();){var i=n.next();if(!this.isSimpleLinearGeometry(i))return!1}return!0},hasClosedEndpointIntersection:function(t){for(var e=new et,n=t.getEdgeIterator();n.hasNext();){var i=n.next(),r=(i.getMaximumSegmentIndex(),i.isClosed()),s=i.getCoordinate(0);this.addEndpoint(e,s,r);var o=i.getCoordinate(i.getNumPoints()-1);this.addEndpoint(e,o,r)}for(var n=e.values().iterator();n.hasNext();){var a=n.next();if(a.isClosed&&2!==a.degree)return this.nonSimpleLocation=a.getCoordinate(),!0}return!1},getNonSimpleLocation:function(){return this.nonSimpleLocation},isSimpleLinearGeometry:function(t){if(t.isEmpty())return!0;var e=new Kn(0,t),n=new ie,i=e.computeSelfNodes(n,!0);return!i.hasIntersection()||(i.hasProperIntersection()?(this.nonSimpleLocation=i.getProperIntersectionPoint(),!1):!this.hasNonEndpointIntersection(e)&&(!this.isClosedEndpointsInInterior||!this.hasClosedEndpointIntersection(e)))},hasNonEndpointIntersection:function(t){for(var e=t.getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getMaximumSegmentIndex(),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next();if(!s.isEndPoint(i))return this.nonSimpleLocation=s.getCoordinate(),!0}return!1},addEndpoint:function(t,e,n){var i=t.get(e);null===i&&(i=new Ui(e),t.put(e,i)),i.addEndpoint(n)},computeSimple:function(t){return this.nonSimpleLocation=null,!!t.isEmpty()||(t instanceof It?this.isSimpleLinearGeometry(t):t instanceof ht?this.isSimpleLinearGeometry(t):t instanceof wt?this.isSimpleMultiPoint(t):oo(t,St)?this.isSimplePolygonal(t):!(t instanceof lt)||this.isSimpleGeometryCollection(t))},isSimple:function(){return this.nonSimpleLocation=null,this.computeSimple(this.inputGeom)},isSimpleGeometryCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.computeSimple(n))return!1}return!0},interfaces_:function(){return[]},getClass:function(){return Yi}}),io(Ui.prototype,{addEndpoint:function(t){this.degree++,this.isClosed|=t},getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return Ui}}),Yi.EndpointInfo=Ui,io(Xi.prototype,{getEndCapStyle:function(){return this.endCapStyle},isSingleSided:function(){return this._isSingleSided},setQuadrantSegments:function(t){this.quadrantSegments=t,0===this.quadrantSegments&&(this.joinStyle=Xi.JOIN_BEVEL),this.quadrantSegments<0&&(this.joinStyle=Xi.JOIN_MITRE,this.mitreLimit=Math.abs(this.quadrantSegments)),t<=0&&(this.quadrantSegments=1),this.joinStyle!==Xi.JOIN_ROUND&&(this.quadrantSegments=Xi.DEFAULT_QUADRANT_SEGMENTS)},getJoinStyle:function(){return this.joinStyle},setJoinStyle:function(t){this.joinStyle=t},setSimplifyFactor:function(t){this.simplifyFactor=t<0?0:t},getSimplifyFactor:function(){return this.simplifyFactor},getQuadrantSegments:function(){return this.quadrantSegments},setEndCapStyle:function(t){this.endCapStyle=t},getMitreLimit:function(){return this.mitreLimit},setMitreLimit:function(t){this.mitreLimit=t},setSingleSided:function(t){this._isSingleSided=t},interfaces_:function(){return[]},getClass:function(){return Xi}}),Xi.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Xi.CAP_ROUND=1,Xi.CAP_FLAT=2,Xi.CAP_SQUARE=3,Xi.JOIN_ROUND=1,Xi.JOIN_MITRE=2,Xi.JOIN_BEVEL=3,Xi.DEFAULT_QUADRANT_SEGMENTS=8,Xi.DEFAULT_MITRE_LIMIT=5,Xi.DEFAULT_SIMPLIFY_FACTOR=.01,io(Hi.prototype,{getCoordinate:function(){return this.minCoord},getRightmostSide:function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this.minCoord=null,this.checkForRightmostCoordinate(t)),n},findRightmostEdgeAtVertex:function(){var t=this.minDe.getEdge().getCoordinates();h.isTrue(this.minIndex>0&&this.minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this.minIndex-1],n=t[this.minIndex+1],i=oe.computeOrientation(this.minCoord,n,e),r=!1;e.y<this.minCoord.y&&n.y<this.minCoord.y&&i===oe.COUNTERCLOCKWISE?r=!0:e.y>this.minCoord.y&&n.y>this.minCoord.y&&i===oe.CLOCKWISE&&(r=!0),r&&(this.minIndex=this.minIndex-1)},getRightmostSideOfSegment:function(t,e){var n=t.getEdge(),i=n.getCoordinates();if(e<0||e+1>=i.length)return-1;if(i[e].y===i[e+1].y)return-1;var r=an.LEFT;return i[e].y<i[e+1].y&&(r=an.RIGHT),r},getEdge:function(){return this.orientedDe},checkForRightmostCoordinate:function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this.minCoord||e[n].x>this.minCoord.x)&&(this.minDe=t,this.minIndex=n,this.minCoord=e[n])},findRightmostEdgeAtNode:function(){var t=this.minDe.getNode(),e=t.getEdges();this.minDe=e.getRightmostEdge(),this.minDe.isForward()||(this.minDe=this.minDe.getSym(),this.minIndex=this.minDe.getEdge().getCoordinates().length-1)},findEdge:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}h.isTrue(0!==this.minIndex||this.minCoord.equals(this.minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this.minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this.orientedDe=this.minDe,this.getRightmostSide(this.minDe,this.minIndex)===an.LEFT&&(this.orientedDe=this.minDe.getSym())},interfaces_:function(){return[]},getClass:function(){return Hi}}),Wi.prototype.addLast=function(t){this.array_.push(t)},Wi.prototype.removeFirst=function(){return this.array_.shift()},Wi.prototype.isEmpty=function(){return 0===this.array_.length},io(ji.prototype,{clearVisitedEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){t.next().setVisited(!1)}},getRightmostCoordinate:function(){return this.rightMostCoord},computeNodeDepth:function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new tn("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();i.setVisited(!0),this.copySymDepths(i)}},computeDepth:function(t){this.clearVisitedEdges();var e=this.finder.getEdge();e.getNode(),e.getLabel();e.setEdgeDepths(an.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},create:function(t){this.addReachable(t),this.finder.findEdge(this.dirEdgeList),this.rightMostCoord=this.finder.getCoordinate()},findResultEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(an.RIGHT)>=1&&e.getDepth(an.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},computeDepths:function(t){var e=new K,n=new Wi,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var s=r.getEdges().iterator();s.hasNext();){var o=s.next(),a=o.getSym();if(!a.isVisited()){var u=a.getNode();e.contains(u)||(n.addLast(u),e.add(u))}}}},compareTo:function(t){var e=t;return this.rightMostCoord.x<e.rightMostCoord.x?-1:this.rightMostCoord.x>e.rightMostCoord.x?1:0},getEnvelope:function(){if(null===this.env){for(var t=new I,e=this.dirEdgeList.iterator();e.hasNext();)for(var n=e.next(),i=n.getEdge().getCoordinates(),r=0;r<i.length-1;r++)t.expandToInclude(i[r]);this.env=t}return this.env},addReachable:function(t){var e=new ce;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},copySymDepths:function(t){var e=t.getSym();e.setDepth(an.LEFT,t.getDepth(an.RIGHT)),e.setDepth(an.RIGHT,t.getDepth(an.LEFT))},add:function(t,e){t.setVisited(!0),this.nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this.dirEdgeList.add(i);var r=i.getSym(),s=r.getNode();s.isVisited()||e.push(s)}},getNodes:function(){return this.nodes},getDirectedEdges:function(){return this.dirEdgeList},interfaces_:function(){return[r]},getClass:function(){return ji}}),io(Ki.prototype,{isDeletable:function(t,e,n,i){var r=this.inputLine[t],s=this.inputLine[e],o=this.inputLine[n];return!!this.isConcave(r,s,o)&&(!!this.isShallow(r,s,o,i)&&this.isShallowSampled(r,s,t,n,i))},deleteShallowConcavities:function(){for(var t=1,e=(this.inputLine.length,this.findNextNonDeletedIndex(t)),n=this.findNextNonDeletedIndex(e),i=!1;n<this.inputLine.length;){var r=!1;this.isDeletable(t,e,n,this.distanceTol)&&(this.isDeleted[e]=Ki.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},isShallowConcavity:function(t,e,n,i){return oe.computeOrientation(t,e,n)===this.angleOrientation&&oe.distancePointLine(e,t,n)<i},isShallowSampled:function(t,e,n,i,r){var s=Math.trunc((i-n)/Ki.NUM_PTS_TO_CHECK);s<=0&&(s=1);for(var o=n;o<i;o+=s)if(!this.isShallow(t,e,this.inputLine[o],r))return!1;return!0},isConcave:function(t,e,n){return oe.computeOrientation(t,e,n)===this.angleOrientation},simplify:function(t){this.distanceTol=Math.abs(t),t<0&&(this.angleOrientation=oe.CLOCKWISE),this.isDeleted=new Array(this.inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},findNextNonDeletedIndex:function(t){for(var e=t+1;e<this.inputLine.length&&this.isDeleted[e]===Ki.DELETE;)e++;return e},isShallow:function(t,e,n,i){return oe.distancePointLine(e,t,n)<i},collapseLine:function(){for(var t=new E,e=0;e<this.inputLine.length;e++)this.isDeleted[e]!==Ki.DELETE&&t.add(this.inputLine[e]);return t.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return Ki}}),Ki.simplify=function(t,e){return new Ki(t).simplify(e)},Ki.INIT=0,Ki.DELETE=1,Ki.KEEP=1,Ki.NUM_PTS_TO_CHECK=10,io(Zi.prototype,{getCoordinates:function(){return this.ptList.toArray(Zi.COORDINATE_ARRAY_TYPE)},setPrecisionModel:function(t){this.precisionModel=t},addPt:function(t){var e=new c(t);if(this.precisionModel.makePrecise(e),this.isRedundant(e))return null;this.ptList.add(e)},reverse:function(){},addPts:function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var n=t.length-1;n>=0;n--)this.addPt(t[n])},isRedundant:function(t){if(this.ptList.size()<1)return!1;var e=this.ptList.get(this.ptList.size()-1);return t.distance(e)<this.minimimVertexDistance},toString:function(){return(new $t).createLineString(this.getCoordinates()).toString()},closeRing:function(){if(this.ptList.size()<1)return null;var t=new c(this.ptList.get(0)),e=this.ptList.get(this.ptList.size()-1);if(this.ptList.size()>=2&&this.ptList.get(this.ptList.size()-2),t.equals(e))return null;this.ptList.add(t)},setMinimumVertexDistance:function(t){this.minimimVertexDistance=t},interfaces_:function(){return[]},getClass:function(){return Zi}}),Zi.COORDINATE_ARRAY_TYPE=new Array(0).fill(null),io(Qi.prototype,{addNextSegment:function(t,e){if(this.s0=this.s1,this.s1=this.s2,this.s2=t,this.seg0.setCoordinates(this.s0,this.s1),this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0),this.seg1.setCoordinates(this.s1,this.s2),this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1),this.s1.equals(this.s2))return null;var n=oe.computeOrientation(this.s0,this.s1,this.s2),i=n===oe.CLOCKWISE&&this.side===an.LEFT||n===oe.COUNTERCLOCKWISE&&this.side===an.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},addLineEndCap:function(t,e){var n=new ae(t,e),i=new ae;this.computeOffsetSegment(n,an.LEFT,this.distance,i);var r=new ae;this.computeOffsetSegment(n,an.RIGHT,this.distance,r);var s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s);switch(this.bufParams.getEndCapStyle()){case Xi.CAP_ROUND:this.segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,oe.CLOCKWISE,this.distance),this.segList.addPt(r.p1);break;case Xi.CAP_FLAT:this.segList.addPt(i.p1),this.segList.addPt(r.p1);break;case Xi.CAP_SQUARE:var u=new c;u.x=Math.abs(this.distance)*Math.cos(a),u.y=Math.abs(this.distance)*Math.sin(a);var l=new c(i.p1.x+u.x,i.p1.y+u.y),h=new c(r.p1.x+u.x,r.p1.y+u.y);this.segList.addPt(l),this.segList.addPt(h)}},getCoordinates:function(){return this.segList.getCoordinates()},addMitreJoin:function(t,e,n,i){var r=!0,s=null;try{s=M.intersection(e.p0,e.p1,n.p0,n.p1);(i<=0?1:s.distance(t)/Math.abs(i))>this.bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof C))throw t;s=new c(0,0),r=!1}r?this.segList.addPt(s):this.addLimitedMitreJoin(e,n,i,this.bufParams.getMitreLimit())},addFilletCorner:function(t,e,n,i,r){var s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s),u=n.x-t.x,l=n.y-t.y,h=Math.atan2(l,u);i===oe.CLOCKWISE?a<=h&&(a+=2*Math.PI):a>=h&&(a-=2*Math.PI),this.segList.addPt(e),this.addFilletArc(t,a,h,i,r),this.segList.addPt(n)},
addOutsideTurn:function(t,e){if(this.offset0.p1.distance(this.offset1.p0)<this.distance*Qi.OFFSET_SEGMENT_SEPARATION_FACTOR)return this.segList.addPt(this.offset0.p1),null;this.bufParams.getJoinStyle()===Xi.JOIN_MITRE?this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance):this.bufParams.getJoinStyle()===Xi.JOIN_BEVEL?this.addBevelJoin(this.offset0,this.offset1):(e&&this.segList.addPt(this.offset0.p1),this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,t,this.distance),this.segList.addPt(this.offset1.p0))},createSquare:function(t){this.segList.addPt(new c(t.x+this.distance,t.y+this.distance)),this.segList.addPt(new c(t.x+this.distance,t.y-this.distance)),this.segList.addPt(new c(t.x-this.distance,t.y-this.distance)),this.segList.addPt(new c(t.x-this.distance,t.y+this.distance)),this.segList.closeRing()},addSegments:function(t,e){this.segList.addPts(t,e)},addFirstSegment:function(){this.segList.addPt(this.offset1.p0)},addLastSegment:function(){this.segList.addPt(this.offset1.p1)},initSideSegments:function(t,e,n){this.s1=t,this.s2=e,this.side=n,this.seg1.setCoordinates(t,e),this.computeOffsetSegment(this.seg1,n,this.distance,this.offset1)},addLimitedMitreJoin:function(t,e,n,i){var r=this.seg0.p1,s=xi.angle(r,this.seg0.p0),o=(xi.angle(r,this.seg1.p1),xi.angleBetweenOriented(this.seg0.p0,r,this.seg1.p1)),a=o/2,u=xi.normalize(s+a),l=xi.normalize(u+Math.PI),h=i*n,f=h*Math.abs(Math.sin(a)),g=n-f,d=r.x+h*Math.cos(l),p=r.y+h*Math.sin(l),m=new c(d,p),v=new ae(r,m),y=v.pointAlongOffset(1,g),x=v.pointAlongOffset(1,-g);this.side===an.LEFT?(this.segList.addPt(y),this.segList.addPt(x)):(this.segList.addPt(x),this.segList.addPt(y))},computeOffsetSegment:function(t,e,n,i){var r=e===an.LEFT?1:-1,s=t.p1.x-t.p0.x,o=t.p1.y-t.p0.y,a=Math.sqrt(s*s+o*o),u=r*n*s/a,l=r*n*o/a;i.p0.x=t.p0.x-l,i.p0.y=t.p0.y+u,i.p1.x=t.p1.x-l,i.p1.y=t.p1.y+u},addFilletArc:function(t,e,n,i,r){var s=i===oe.CLOCKWISE?-1:1,o=Math.abs(e-n),a=Math.trunc(o/this.filletAngleQuantum+.5);if(a<1)return null;var u=null,l=null;u=0,l=o/a;for(var h=u,f=new c;h<o;){var g=e+s*h;f.x=t.x+r*Math.cos(g),f.y=t.y+r*Math.sin(g),this.segList.addPt(f),h+=l}},addInsideTurn:function(t,e){if(this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1),this.li.hasIntersection())this.segList.addPt(this.li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this.offset0.p1.distance(this.offset1.p0)<this.distance*Qi.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this.segList.addPt(this.offset0.p1);else{if(this.segList.addPt(this.offset0.p1),this.closingSegLengthFactor>0){var n=new c((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(n);var i=new c((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(i)}else this.segList.addPt(this.s1);this.segList.addPt(this.offset1.p0)}},createCircle:function(t){var e=new c(t.x+this.distance,t.y);this.segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this.distance),this.segList.closeRing()},addBevelJoin:function(t,e){this.segList.addPt(t.p1),this.segList.addPt(e.p0)},init:function(t){this.distance=t,this.maxCurveSegmentError=t*(1-Math.cos(this.filletAngleQuantum/2)),this.segList=new Zi,this.segList.setPrecisionModel(this.precisionModel),this.segList.setMinimumVertexDistance(t*Qi.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},addCollinear:function(t){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2),this.li.getIntersectionNum()>=2&&(this.bufParams.getJoinStyle()===Xi.JOIN_BEVEL||this.bufParams.getJoinStyle()===Xi.JOIN_MITRE?(t&&this.segList.addPt(this.offset0.p1),this.segList.addPt(this.offset1.p0)):this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,oe.CLOCKWISE,this.distance))},closeRing:function(){this.segList.closeRing()},hasNarrowConcaveAngle:function(){return this._hasNarrowConcaveAngle},interfaces_:function(){return[]},getClass:function(){return Qi}}),Qi.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Qi.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Qi.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Qi.MAX_CLOSING_SEG_LEN_FACTOR=80,io(Ji.prototype,{getOffsetCurve:function(t,e){if(this.distance=e,0===e)return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var s=r.getCoordinates();return n&&Y.reverse(s),s},computeSingleSidedBufferCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);if(e){n.addSegments(t,!0);var r=Ki.simplify(t,-i),s=r.length-1;n.initSideSegments(r[s],r[s-1],an.LEFT),n.addFirstSegment();for(var o=s-2;o>=0;o--)n.addNextSegment(r[o],!0)}else{n.addSegments(t,!1);var a=Ki.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],an.LEFT),n.addFirstSegment();for(var o=2;o<=u;o++)n.addNextSegment(a[o],!0)}n.addLastSegment(),n.closeRing()},computeRingBufferCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);e===an.RIGHT&&(i=-i);var r=Ki.simplify(t,i),s=r.length-1;n.initSideSegments(r[s-1],r[0],e);for(var o=1;o<=s;o++){var a=1!==o;n.addNextSegment(r[o],a)}n.closeRing()},computeLineBufferCurve:function(t,e){var n=this.simplifyTolerance(this.distance),i=Ki.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],an.LEFT);for(var s=2;s<=r;s++)e.addNextSegment(i[s],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var o=Ki.simplify(t,-n),a=o.length-1;e.initSideSegments(o[a],o[a-1],an.LEFT);for(var s=a-2;s>=0;s--)e.addNextSegment(o[s],!0);e.addLastSegment(),e.addLineEndCap(o[1],o[0]),e.closeRing()},computePointCurve:function(t,e){switch(this.bufParams.getEndCapStyle()){case Xi.CAP_ROUND:e.createCircle(t);break;case Xi.CAP_SQUARE:e.createSquare(t)}},getLineCurve:function(t,e){if(this.distance=e,e<0&&!this.bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this.bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},getBufferParameters:function(){return this.bufParams},simplifyTolerance:function(t){return t*this.bufParams.getSimplifyFactor()},getRingCurve:function(t,e,n){if(this.distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return Ji.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},computeOffsetCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);if(e){var r=Ki.simplify(t,-i),s=r.length-1;n.initSideSegments(r[s],r[s-1],an.LEFT),n.addFirstSegment();for(var o=s-2;o>=0;o--)n.addNextSegment(r[o],!0)}else{var a=Ki.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],an.LEFT),n.addFirstSegment();for(var o=2;o<=u;o++)n.addNextSegment(a[o],!0)}n.addLastSegment()},getSegGen:function(t){return new Qi(this.precisionModel,this.bufParams,t)},interfaces_:function(){return[]},getClass:function(){return Ji}}),Ji.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new c(t[n]);return e},io($i.prototype,{findStabbedSegments:function(){if(1===arguments.length){for(var t=arguments[0],e=new x,n=this.subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(oo(arguments[2],m)&&arguments[0]instanceof c&&arguments[1]instanceof vn)for(var s=arguments[0],o=arguments[1],a=arguments[2],u=o.getEdge().getCoordinates(),n=0;n<u.length-1;n++){this.seg.p0=u[n],this.seg.p1=u[n+1],this.seg.p0.y>this.seg.p1.y&&this.seg.reverse();var l=Math.max(this.seg.p0.x,this.seg.p1.x);if(!(l<s.x)&&!(this.seg.isHorizontal()||s.y<this.seg.p0.y||s.y>this.seg.p1.y||oe.computeOrientation(this.seg.p0,this.seg.p1,s)===oe.RIGHT)){var h=o.getDepth(an.LEFT);this.seg.p0.equals(u[n])||(h=o.getDepth(an.RIGHT));var f=new tr(this.seg,h);a.add(f)}}else if(oo(arguments[2],m)&&arguments[0]instanceof c&&oo(arguments[1],m))for(var g=arguments[0],d=arguments[1],p=arguments[2],n=d.iterator();n.hasNext();){var v=n.next();v.isForward()&&this.findStabbedSegments(g,v,p)}},getDepth:function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:xo.min(e).leftDepth},interfaces_:function(){return[]},getClass:function(){return $i}}),io(tr.prototype,{compareTo:function(t){var e=t;if(this.upwardSeg.minX()>=e.upwardSeg.maxX())return 1;if(this.upwardSeg.maxX()<=e.upwardSeg.minX())return-1;var n=this.upwardSeg.orientationIndex(e.upwardSeg);return 0!==n?n:(n=-1*e.upwardSeg.orientationIndex(this.upwardSeg),0!==n?n:this.upwardSeg.compareTo(e.upwardSeg))},compareX:function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},toString:function(){return this.upwardSeg.toString()},interfaces_:function(){return[r]},getClass:function(){return tr}}),$i.DepthSegment=tr,io(er.prototype,{addPoint:function(t){if(this.distance<=0)return null;var e=t.getCoordinates(),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,S.EXTERIOR,S.INTERIOR)},addPolygon:function(t){var e=this.distance,n=an.LEFT;this.distance<0&&(e=-this.distance,n=an.RIGHT);var i=t.getExteriorRing(),r=Y.removeRepeatedPoints(i.getCoordinates());if(this.distance<0&&this.isErodedCompletely(i,this.distance))return null;if(this.distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,S.EXTERIOR,S.INTERIOR);for(var s=0;s<t.getNumInteriorRing();s++){var o=t.getInteriorRingN(s),a=Y.removeRepeatedPoints(o.getCoordinates());this.distance>0&&this.isErodedCompletely(o,-this.distance)||this.addPolygonRing(a,e,an.opposite(n),S.INTERIOR,S.EXTERIOR)}},isTriangleErodedCompletely:function(t,e){var n=new Ei(t[0],t[1],t[2]),i=n.inCentre();return oe.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},addLineString:function(t){if(this.distance<=0&&!this.curveBuilder.getBufferParameters().isSingleSided())return null;var e=Y.removeRepeatedPoints(t.getCoordinates()),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,S.EXTERIOR,S.INTERIOR)},addCurve:function(t,e,n){if(null===t||t.length<2)return null;var i=new Xe(t,new ln(0,S.BOUNDARY,e,n));this.curveList.add(i)},getCurves:function(){return this.add(this.inputGeom),this.curveList},addPolygonRing:function(t,e,n,i,r){if(0===e&&t.length<Rt.MINIMUM_VALID_SIZE)return null;var s=i,o=r;t.length>=Rt.MINIMUM_VALID_SIZE&&oe.isCCW(t)&&(s=r,o=i,n=an.opposite(n));var a=this.curveBuilder.getRingCurve(t,n,e);this.addCurve(a,s,o)},add:function(t){if(t.isEmpty())return null;if(t instanceof Lt)this.addPolygon(t);else if(t instanceof It)this.addLineString(t);else if(t instanceof Ct)this.addPoint(t);else if(t instanceof wt)this.addCollection(t);else if(t instanceof ht)this.addCollection(t);else if(t instanceof Tt)this.addCollection(t);else{if(!(t instanceof lt))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},isErodedCompletely:function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r},addCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},interfaces_:function(){return[]},getClass:function(){return er}}),io(nr.prototype,{isTrivialIntersection:function(t,e,n,i){if(t===n&&1===this.li.getIntersectionNum()){if(nr.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},hasProperInteriorIntersection:function(){return this.hasProperInterior},getLineIntersector:function(){return this.li},hasProperIntersection:function(){return this.hasProper},processIntersections:function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,s,o,a),this.li.hasIntersection()&&(this.numIntersections++,this.li.isInteriorIntersection()&&(this.numInteriorIntersections++,this.hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1),this.li.isProper()&&(this.numProperIntersections++,this.hasProper=!0,this.hasProperInterior=!0)))},hasIntersection:function(){return this._hasIntersection},isDone:function(){return!1},hasInteriorIntersection:function(){return this.hasInterior},interfaces_:function(){return[en]},getClass:function(){return nr}}),nr.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},io(ir.prototype,{setWorkingPrecisionModel:function(t){this.workingPrecisionModel=t},insertUniqueEdge:function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new ln(t.getLabel()),i.flip()),n.merge(i);var r=ir.depthDelta(i),s=e.getDepthDelta(),o=s+r;e.setDepthDelta(o)}else this.edgeList.add(t),t.setDepthDelta(ir.depthDelta(t.getLabel()))},buildSubgraphs:function(t,e){for(var n=new x,i=t.iterator();i.hasNext();){var r=i.next(),s=r.getRightmostCoordinate(),o=new $i(n),a=o.getDepth(s);r.computeDepth(a),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},createSubgraphs:function(t){for(var e=new x,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new ji;r.create(i),e.add(r)}}return xo.sort(e,xo.reverseOrder()),e},createEmptyResultGeometry:function(){return this.geomFact.createPolygon()},getNoder:function(t){if(null!==this.workingNoder)return this.workingNoder;var e=new Je,n=new ie;return n.setPrecisionModel(t),e.setSegmentIntersector(new nr(n)),e},buffer:function(t,e){var n=this.workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this.geomFact=t.getFactory();var i=new Ji(n,this.bufParams),r=new er(t,e,i),s=r.getCurves();if(s.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(s,n),this.graph=new xn(new Rn),this.graph.addEdges(this.edgeList.getEdges());var o=this.createSubgraphs(this.graph),a=new En(this.geomFact);this.buildSubgraphs(o,a);var u=a.getPolygons();return u.size()<=0?this.createEmptyResultGeometry():this.geomFact.buildGeometry(u)},computeNodedEdges:function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings(),r=i.iterator();r.hasNext();){var s=r.next(),o=s.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var a=s.getData(),u=new jn(s.getCoordinates(),new ln(a));this.insertUniqueEdge(u)}}},setNoder:function(t){this.workingNoder=t},interfaces_:function(){return[]},getClass:function(){return ir}}),ir.depthDelta=function(t){var e=t.getLocation(0,an.LEFT),n=t.getLocation(0,an.RIGHT);return e===S.INTERIOR&&n===S.EXTERIOR?1:e===S.EXTERIOR&&n===S.INTERIOR?-1:0},ir.convertSegStrings=function(t){for(var e=new $t,n=new x;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)},io(rr.prototype,{checkEndPtVertexIntersections:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();){var e=t.next(),n=e.getCoordinates();this.checkEndPtVertexIntersections(n[0],this.segStrings),this.checkEndPtVertexIntersections(n[n.length-1],this.segStrings)}else if(2===arguments.length)for(var i=arguments[0],r=arguments[1],t=r.iterator();t.hasNext();)for(var e=t.next(),n=e.getCoordinates(),s=1;s<n.length-1;s++)if(n[s].equals(i))throw new u("found endpt/interior pt intersection at index "+s+" :pt "+i)},checkInteriorIntersections:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this.segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],s=arguments[1],o=r.getCoordinates(),a=s.getCoordinates(),l=0;l<o.length-1;l++)for(var h=0;h<a.length-1;h++)this.checkInteriorIntersections(r,l,s,h);else if(4===arguments.length){var c=arguments[0],f=arguments[1],g=arguments[2],d=arguments[3];if(c===g&&f===d)return null;var p=c.getCoordinates()[f],m=c.getCoordinates()[f+1],v=g.getCoordinates()[d],y=g.getCoordinates()[d+1];if(this.li.computeIntersection(p,m,v,y),this.li.hasIntersection()&&(this.li.isProper()||this.hasInteriorIntersection(this.li,p,m)||this.hasInteriorIntersection(this.li,v,y)))throw new u("found non-noded intersection at "+p+"-"+m+" and "+v+"-"+y)}},checkValid:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},checkCollapses:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0],i=n.getCoordinates(),t=0;t<i.length-2;t++)this.checkCollapse(i[t],i[t+1],i[t+2])},hasInteriorIntersection:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},checkCollapse:function(t,e,n){if(t.equals(n))throw new u("found non-noded collapse at "+rr.fact.createLineString([t,e,n]))},interfaces_:function(){return[]},getClass:function(){return rr}}),rr.fact=new $t,io(sr.prototype,{intersectsScaled:function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),s=Math.max(t.y,e.y),o=this.maxx<n||this.minx>i||this.maxy<r||this.miny>s;if(o)return!1;var a=this.intersectsToleranceSquare(t,e);return h.isTrue(!(o&&a),"Found bad envelope test"),a},initCorners:function(t){this.minx=t.x-.5,this.maxx=t.x+.5,this.miny=t.y-.5,this.maxy=t.y+.5,this.corner[0]=new c(this.maxx,this.maxy),this.corner[1]=new c(this.minx,this.maxy),this.corner[2]=new c(this.minx,this.miny),this.corner[3]=new c(this.maxx,this.miny)},intersects:function(t,e){return 1===this.scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this.p0Scaled),this.copyScaled(e,this.p1Scaled),this.intersectsScaled(this.p0Scaled,this.p1Scaled))},scale:function(t){return Math.round(t*this.scaleFactor)},getCoordinate:function(){return this.originalPt},copyScaled:function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},getSafeEnvelope:function(){if(null===this.safeEnv){var t=sr.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new I(this.originalPt.x-t,this.originalPt.x+t,this.originalPt.y-t,this.originalPt.y+t)}return this.safeEnv},intersectsPixelClosure:function(t,e){return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),!!this.li.hasIntersection())))},intersectsToleranceSquare:function(t,e){var n=!1,i=!1;return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!this.li.isProper()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),!!this.li.isProper()||(this.li.hasIntersection()&&(n=!0),this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),!!this.li.isProper()||(this.li.hasIntersection()&&(i=!0),this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),!!this.li.isProper()||(!(!n||!i)||(!!t.equals(this.pt)||!!e.equals(this.pt))))))},addSnappedNode:function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},interfaces_:function(){return[]},getClass:function(){return sr}}),sr.SAFE_ENV_EXPANSION_FACTOR=.75,io(or.prototype,{snap:function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),s=new ar(e,n,i);return this.index.query(r,{interfaces_:function(){return[be]},visitItem:function(t){t.select(r,s)}}),s.isNodeAdded()}},interfaces_:function(){return[]},getClass:function(){return or}}),ro(ar,oi),io(ar.prototype,{isNodeAdded:function(){return this._isNodeAdded},select:function(){if(2!==arguments.length)return oi.prototype.select.apply(this,arguments);var t=arguments[0],e=arguments[1],n=t.getContext();if(null!==this.parentEdge&&n===this.parentEdge&&e===this.hotPixelVertexIndex)return null;this._isNodeAdded=this.hotPixel.addSnappedNode(n,e)},interfaces_:function(){return[]},getClass:function(){return ar}}),or.HotPixelSnapAction=ar,io(ur.prototype,{processIntersections:function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this.li.computeIntersection(r,s,o,a),this.li.hasIntersection()&&this.li.isInteriorIntersection()){for(var u=0;u<this.li.getIntersectionNum();u++)this.interiorIntersections.add(this.li.getIntersection(u));t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1)}},isDone:function(){return!1},getInteriorIntersections:function(){return this.interiorIntersections},interfaces_:function(){return[en]},getClass:function(){return ur}}),io(lr.prototype,{checkCorrectness:function(t){var e=Xe.getNodedSubstrings(t),n=new rr(e);try{n.checkValid()}catch(t){if(!(t instanceof N))throw t;t.printStackTrace()}},getNodedSubstrings:function(){return Xe.getNodedSubstrings(this.nodedSegStrings)},snapRound:function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},findInteriorIntersections:function(t,e){var n=new ur(e);return this.noder.setSegmentIntersector(n),this.noder.computeNodes(t),n.getInteriorIntersections()},computeVertexSnaps:function(){if(oo(arguments[0],d))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.computeVertexSnaps(n)}else if(arguments[0]instanceof Xe)for(var i=arguments[0],r=i.getCoordinates(),s=0;s<r.length;s++){var o=new sr(r[s],this.scaleFactor,this.li),a=this.pointSnapper.snap(o,i,s);a&&i.addIntersection(r[s],s)}},computeNodes:function(t){this.nodedSegStrings=t,this.noder=new Je,this.pointSnapper=new or(this.noder.getIndex()),this.snapRound(t,this.li)},computeIntersectionSnaps:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new sr(n,this.scaleFactor,this.li);this.pointSnapper.snap(i)}},interfaces_:function(){return[Ze]},getClass:function(){return lr}}),io(hr.prototype,{bufferFixedPrecision:function(t){var e=new ki(new lr(new Qt(1)),t.getScale()),n=new ir(this.bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this.resultGeometry=n.buffer(this.argGeom,this.distance)},bufferReducedPrecision:function(){if(0===arguments.length){for(var t=hr.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof tn))throw t;this.saveException=t}if(null!==this.resultGeometry)return null}throw this.saveException}if(1===arguments.length){var e=arguments[0],n=hr.precisionScaleFactor(this.argGeom,this.distance,e),i=new Qt(n);this.bufferFixedPrecision(i)}},computeGeometry:function(){if(this.bufferOriginalPrecision(),null!==this.resultGeometry)return null;var t=this.argGeom.getFactory().getPrecisionModel();t.getType()===Qt.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},setQuadrantSegments:function(t){this.bufParams.setQuadrantSegments(t)},bufferOriginalPrecision:function(){try{var t=new ir(this.bufParams);this.resultGeometry=t.buffer(this.argGeom,this.distance)}catch(t){if(!(t instanceof u))throw t;this.saveException=t}},getResultGeometry:function(t){return this.distance=t,this.computeGeometry(),this.resultGeometry},setEndCapStyle:function(t){this.bufParams.setEndCapStyle(t)},interfaces_:function(){return[]},getClass:function(){return hr}}),hr.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new hr(t),i=n.getResultGeometry(e);return i}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof F&&"number"==typeof arguments[1]){var r=arguments[0],s=arguments[1],o=arguments[2],a=new hr(r);a.setQuadrantSegments(o);var i=a.getResultGeometry(s);return i}if(arguments[2]instanceof Xi&&arguments[0]instanceof F&&"number"==typeof arguments[1]){var u=arguments[0],l=arguments[1],h=arguments[2],a=new hr(u,h),i=a.getResultGeometry(l);return i}}else if(4===arguments.length){var c=arguments[0],f=arguments[1],g=arguments[2],d=arguments[3],a=new hr(c);a.setQuadrantSegments(g),a.setEndCapStyle(d);var i=a.getResultGeometry(f);return i}},hr.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=L.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY())),s=e>0?e:0,o=r+2*s,a=Math.trunc(Math.log(o)/Math.log(10)+1),u=n-a;return Math.pow(10,u)},hr.CAP_ROUND=Xi.CAP_ROUND,hr.CAP_BUTT=Xi.CAP_FLAT,hr.CAP_FLAT=Xi.CAP_FLAT,hr.CAP_SQUARE=Xi.CAP_SQUARE,hr.MAX_PRECISION_DIGITS=12;var _o=Object.freeze({BufferOp:hr,BufferParameters:Xi});io(cr.prototype,{filter:function(t){t instanceof Lt&&this.comps.add(t)},interfaces_:function(){return[at]},getClass:function(){return cr}}),cr.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return cr.getPolygons(t,new x)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Lt?n.add(e):e instanceof lt&&e.apply(new cr(n)),n}},io(fr.prototype,{isInsideArea:function(){return this.segIndex===fr.INSIDE_AREA},getCoordinate:function(){return this.pt},getGeometryComponent:function(){return this.component},getSegmentIndex:function(){return this.segIndex},interfaces_:function(){return[]},getClass:function(){return fr}}),fr.INSIDE_AREA=-1,io(gr.prototype,{filter:function(t){t instanceof Ct&&this.pts.add(t)},interfaces_:function(){return[at]},getClass:function(){return gr}}),gr.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Ct?xo.singletonList(t):gr.getPoints(t,new x)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Ct?n.add(e):e instanceof lt&&e.apply(new gr(n)),n}},io(dr.prototype,{filter:function(t){(t instanceof Ct||t instanceof It||t instanceof Lt)&&this.locations.add(new fr(t,0,t.getCoordinate()))},interfaces_:function(){return[at]},getClass:function(){return dr}}),dr.getLocations=function(t){var e=new x;return t.apply(new dr(e)),e},io(pr.prototype,{computeContainmentDistance:function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this.minDistance<=this.terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=cr.getPolygons(this.geom[e]);if(r.size()>0){var s=dr.getLocations(this.geom[i]);if(this.computeContainmentDistance(s,r,n),this.minDistance<=this.terminateDistance)return this.minDistanceLocation[i]=n[0],this.minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&oo(arguments[0],m)&&oo(arguments[1],m)){for(var o=arguments[0],a=arguments[1],u=arguments[2],l=0;l<o.size();l++)for(var h=o.get(l),c=0;c<a.size();c++)if(this.computeContainmentDistance(h,a.get(c),u),this.minDistance<=this.terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof fr&&arguments[1]instanceof Lt){var f=arguments[0],g=arguments[1],d=arguments[2],p=f.getCoordinate();if(S.EXTERIOR!==this.ptLocator.locate(p,g))return this.minDistance=0,d[0]=f,d[1]=new fr(g,p),null}},computeMinDistanceLinesPoints:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),s=0;s<e.size();s++){var o=e.get(s);if(this.computeMinDistance(r,o,n),this.minDistance<=this.terminateDistance)return null}},computeFacetDistance:function(){var t=new Array(2).fill(null),e=qn.getLines(this.geom[0]),n=qn.getLines(this.geom[1]),i=gr.getPoints(this.geom[0]),r=gr.getPoints(this.geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},nearestLocations:function(){return this.computeMinDistance(),this.minDistanceLocation},updateMinDistance:function(t,e){if(null===t[0])return null;e?(this.minDistanceLocation[0]=t[1],this.minDistanceLocation[1]=t[0]):(this.minDistanceLocation[0]=t[0],this.minDistanceLocation[1]=t[1])},nearestPoints:function(){return this.computeMinDistance(),[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()]},computeMinDistance:function(){if(0===arguments.length){if(null!==this.minDistanceLocation)return null;if(this.minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this.minDistance<=this.terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof It&&arguments[1]instanceof Ct){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this.minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),s=0;s<i.length-1;s++){var o=oe.distancePointLine(r,i[s],i[s+1]);if(o<this.minDistance){this.minDistance=o;var a=new ae(i[s],i[s+1]),u=a.closestPoint(r);n[0]=new fr(t,s,u),n[1]=new fr(e,0,r)}if(this.minDistance<=this.terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof It&&arguments[1]instanceof It){var l=arguments[0],h=arguments[1],c=arguments[2];if(l.getEnvelopeInternal().distance(h.getEnvelopeInternal())>this.minDistance)return null;for(var i=l.getCoordinates(),f=h.getCoordinates(),s=0;s<i.length-1;s++)for(var g=0;g<f.length-1;g++){var o=oe.distanceLineLine(i[s],i[s+1],f[g],f[g+1]);if(o<this.minDistance){this.minDistance=o;var d=new ae(i[s],i[s+1]),p=new ae(f[g],f[g+1]),m=d.closestPoints(p);c[0]=new fr(l,s,m[0]),c[1]=new fr(h,g,m[1])}if(this.minDistance<=this.terminateDistance)return null}}},computeMinDistancePoints:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),s=0;s<e.size();s++){var o=e.get(s),a=r.getCoordinate().distance(o.getCoordinate());if(a<this.minDistance&&(this.minDistance=a,n[0]=new fr(r,0,r.getCoordinate()),n[1]=new fr(o,0,o.getCoordinate())),this.minDistance<=this.terminateDistance)return null}},distance:function(){if(null===this.geom[0]||null===this.geom[1])throw new n("null geometries are not supported");return this.geom[0].isEmpty()||this.geom[1].isEmpty()?0:(this.computeMinDistance(),this.minDistance)},computeMinDistanceLines:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),s=0;s<e.size();s++){var o=e.get(s);if(this.computeMinDistance(r,o,n),this.minDistance<=this.terminateDistance)return null}},interfaces_:function(){return[]},getClass:function(){return pr}}),pr.distance=function(t,e){return new pr(t,e).distance()},pr.isWithinDistance=function(t,e,n){return new pr(t,e,n).distance()<=n},pr.nearestPoints=function(t,e){return new pr(t,e).nearestPoints()};var Mo=Object.freeze({DistanceOp:pr});io(mr.prototype,{getCoordinates:function(){if(null===this.coordinates){for(var t=0,e=0,n=new E,i=this.directedEdges.iterator();i.hasNext();){var r=i.next();r.getEdgeDirection()?t++:e++,n.add(r.getEdge().getLine().getCoordinates(),!1,r.getEdgeDirection())}this.coordinates=n.toCoordinateArray(),e>t&&Y.reverse(this.coordinates)}return this.coordinates},toLineString:function(){return this.factory.createLineString(this.getCoordinates())},add:function(t){this.directedEdges.add(t)},interfaces_:function(){return[]},getClass:function(){return mr}}),io(vr.prototype,{setVisited:function(t){this._isVisited=t},isMarked:function(){return this._isMarked},setData:function(t){this.data=t},getData:function(){return this.data},setMarked:function(t){this._isMarked=t},getContext:function(){return this.data},isVisited:function(){
return this._isVisited},setContext:function(t){this.data=t},interfaces_:function(){return[]},getClass:function(){return vr}}),vr.getComponentWithVisitedState=function(t,e){for(;t.hasNext();){var n=t.next();if(n.isVisited()===e)return n}return null},vr.setVisited=function(t,e){for(;t.hasNext();){t.next().setVisited(e)}},vr.setMarked=function(t,e){for(;t.hasNext();){t.next().setMarked(e)}},ro(yr,vr),io(yr.prototype,{isRemoved:function(){return null===this.parentEdge},compareDirection:function(t){return this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:oe.computeOrientation(t.p0,t.p1,this.p1)},getCoordinate:function(){return this.from.getCoordinate()},print:function(t){var e=this.getClass().getName(),n=e.lastIndexOf("."),i=e.substring(n+1);t.print("  "+i+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+this.angle)},getDirectionPt:function(){return this.p1},getAngle:function(){return this.angle},compareTo:function(t){var e=t;return this.compareDirection(e)},getFromNode:function(){return this.from},getSym:function(){return this.sym},setEdge:function(t){this.parentEdge=t},remove:function(){this.sym=null,this.parentEdge=null},getEdge:function(){return this.parentEdge},getQuadrant:function(){return this.quadrant},setSym:function(t){this.sym=t},getToNode:function(){return this.to},getEdgeDirection:function(){return this.edgeDirection},interfaces_:function(){return[r]},getClass:function(){return yr}}),yr.toEdges=function(t){for(var e=new x,n=t.iterator();n.hasNext();)e.add(n.next().parentEdge);return e},ro(xr,yr),io(xr.prototype,{getNext:function(){return 2!==this.getToNode().getDegree()?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(h.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))},interfaces_:function(){return[]},getClass:function(){return xr}}),ro(Er,vr),io(Er.prototype,{isRemoved:function(){return null===this.dirEdge},setDirectedEdges:function(t,e){this.dirEdge=[t,e],t.setEdge(this),e.setEdge(this),t.setSym(e),e.setSym(t),t.getFromNode().addOutEdge(t),e.getFromNode().addOutEdge(e)},getDirEdge:function(){if(Number.isInteger(arguments[0])){var t=arguments[0];return this.dirEdge[t]}if(arguments[0]instanceof Nr){var e=arguments[0];return this.dirEdge[0].getFromNode()===e?this.dirEdge[0]:this.dirEdge[1].getFromNode()===e?this.dirEdge[1]:null}},remove:function(){this.dirEdge=null},getOppositeNode:function(t){return this.dirEdge[0].getFromNode()===t?this.dirEdge[0].getToNode():this.dirEdge[1].getFromNode()===t?this.dirEdge[1].getToNode():null},interfaces_:function(){return[]},getClass:function(){return Er}}),io(Ir.prototype,{getNextEdge:function(t){var e=this.getIndex(t);return this.outEdges.get(this.getIndex(e+1))},getCoordinate:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},iterator:function(){return this.sortEdges(),this.outEdges.iterator()},sortEdges:function(){this.sorted||(xo.sort(this.outEdges),this.sorted=!0)},remove:function(t){this.outEdges.remove(t)},getEdges:function(){return this.sortEdges(),this.outEdges},getNextCWEdge:function(t){var e=this.getIndex(t);return this.outEdges.get(this.getIndex(e-1))},getIndex:function(){if(arguments[0]instanceof Er){var t=arguments[0];this.sortEdges();for(var e=0;e<this.outEdges.size();e++){var n=this.outEdges.get(e);if(n.getEdge()===t)return e}return-1}if(arguments[0]instanceof yr){var i=arguments[0];this.sortEdges();for(var e=0;e<this.outEdges.size();e++){var n=this.outEdges.get(e);if(n===i)return e}return-1}if(Number.isInteger(arguments[0])){var r=arguments[0],s=r%this.outEdges.size();return s<0&&(s+=this.outEdges.size()),s}},add:function(t){this.outEdges.add(t),this.sorted=!1},getDegree:function(){return this.outEdges.size()},interfaces_:function(){return[]},getClass:function(){return Ir}}),ro(Nr,vr),io(Nr.prototype,{isRemoved:function(){return null===this.pt},addOutEdge:function(t){this.deStar.add(t)},getCoordinate:function(){return this.pt},getOutEdges:function(){return this.deStar},remove:function(){if(0===arguments.length)this.pt=null;else if(1===arguments.length){var t=arguments[0];this.deStar.remove(t)}},getIndex:function(t){return this.deStar.getIndex(t)},getDegree:function(){return this.deStar.getDegree()},interfaces_:function(){return[]},getClass:function(){return Nr}}),Nr.getEdgesBetween=function(t,e){var n=yr.toEdges(t.getOutEdges().getEdges()),i=new K(n),r=yr.toEdges(e.getOutEdges().getEdges());return i.retainAll(r),i},ro(Cr,Er),io(Cr.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return Cr}}),io(Sr.prototype,{find:function(t){return this.nodeMap.get(t)},iterator:function(){return this.nodeMap.values().iterator()},remove:function(t){return this.nodeMap.remove(t)},values:function(){return this.nodeMap.values()},add:function(t){return this.nodeMap.put(t.getCoordinate(),t),t},interfaces_:function(){return[]},getClass:function(){return Sr}}),io(Lr.prototype,{findNodesOfDegree:function(t){for(var e=new x,n=this.nodeIterator();n.hasNext();){var i=n.next();i.getDegree()===t&&e.add(i)}return e},dirEdgeIterator:function(){return this.dirEdges.iterator()},edgeIterator:function(){return this.edges.iterator()},remove:function(){if(arguments[0]instanceof Er){var t=arguments[0];this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this.edges.remove(t),t.remove()}else if(arguments[0]instanceof yr){var e=arguments[0],n=e.getSym();null!==n&&n.setSym(null),e.getFromNode().remove(e),e.remove(),this.dirEdges.remove(e)}else if(arguments[0]instanceof Nr){for(var i=arguments[0],r=i.getOutEdges().getEdges(),s=r.iterator();s.hasNext();){var o=s.next(),n=o.getSym();null!==n&&this.remove(n),this.dirEdges.remove(o);var a=o.getEdge();null!==a&&this.edges.remove(a)}this.nodeMap.remove(i.getCoordinate()),i.remove()}},findNode:function(t){return this.nodeMap.find(t)},getEdges:function(){return this.edges},nodeIterator:function(){return this.nodeMap.iterator()},contains:function(){if(arguments[0]instanceof Er){var t=arguments[0];return this.edges.contains(t)}if(arguments[0]instanceof yr){var e=arguments[0];return this.dirEdges.contains(e)}},add:function(){if(arguments[0]instanceof Nr){var t=arguments[0];this.nodeMap.add(t)}else if(arguments[0]instanceof Er){var e=arguments[0];this.edges.add(e),this.add(e.getDirEdge(0)),this.add(e.getDirEdge(1))}else if(arguments[0]instanceof yr){var n=arguments[0];this.dirEdges.add(n)}},getNodes:function(){return this.nodeMap.values()},interfaces_:function(){return[]},getClass:function(){return Lr}}),ro(wr,Lr),io(wr.prototype,{addEdge:function(t){if(t.isEmpty())return null;var e=Y.removeRepeatedPoints(t.getCoordinates());if(e.length<=1)return null;var n=e[0],i=e[e.length-1],r=this.getNode(n),s=this.getNode(i),o=new xr(r,s,e[1],!0),a=new xr(s,r,e[e.length-2],!1),u=new Cr(t);u.setDirectedEdges(o,a),this.add(u)},getNode:function(t){var e=this.findNode(t);return null===e&&(e=new Nr(t),this.add(e)),e},interfaces_:function(){return[]},getClass:function(){return wr}}),io(Rr.prototype,{buildEdgeStringsForUnprocessedNodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();e.isMarked()||(h.isTrue(2===e.getDegree()),this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},buildEdgeStringsForNonDegree2Nodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();2!==e.getDegree()&&(this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},buildEdgeStringsForObviousStartNodes:function(){this.buildEdgeStringsForNonDegree2Nodes()},getMergedLineStrings:function(){return this.merge(),this.mergedLineStrings},buildEdgeStringsStartingAt:function(t){for(var e=t.getOutEdges().iterator();e.hasNext();){var n=e.next();n.getEdge().isMarked()||this.edgeStrings.add(this.buildEdgeStringStartingWith(n))}},merge:function(){if(null!==this.mergedLineStrings)return null;vr.setMarked(this.graph.nodeIterator(),!1),vr.setMarked(this.graph.edgeIterator(),!1),this.edgeStrings=new x,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this.mergedLineStrings=new x;for(var t=this.edgeStrings.iterator();t.hasNext();){var e=t.next();this.mergedLineStrings.add(e.toLineString())}},buildEdgeStringStartingWith:function(t){var e=new mr(this.factory),n=t;do{e.add(n),n.getEdge().setMarked(!0),n=n.getNext()}while(null!==n&&n!==t);return e},add:function(){if(arguments[0]instanceof F){arguments[0].apply({interfaces_:function(){return[A]},filter:function(t){t instanceof It&&this.add(t)}})}else if(oo(arguments[0],d)){var t=arguments[0];this.mergedLineStrings=null;for(var e=t.iterator();e.hasNext();){var n=e.next();this.add(n)}}else if(arguments[0]instanceof It){var i=arguments[0];null===this.factory&&(this.factory=i.getFactory()),this.graph.addEdge(i)}},buildEdgeStringsForIsolatedLoops:function(){this.buildEdgeStringsForUnprocessedNodes()},interfaces_:function(){return[]},getClass:function(){return Rr}});var Do=Object.freeze({LineMerger:Rr}),Ao=Object.freeze({OverlayOp:$n});ro(Tr,yr),io(Tr.prototype,{getNext:function(){return this.next},isInRing:function(){return null!==this.edgeRing},setRing:function(t){this.edgeRing=t},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setNext:function(t){this.next=t},getRing:function(){return this.edgeRing},interfaces_:function(){return[]},getClass:function(){return Tr}}),ro(Or,Er),io(Or.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return Or}}),io(Pr.prototype,{visitInteriorRing:function(t,e){var n=t.getCoordinates(),i=n[0],r=Pr.findDifferentPoint(n,i),s=e.findEdgeInSameDirection(i,r),o=e.findEdgeEnd(s),a=null;o.getLabel().getLocation(0,an.RIGHT)===S.INTERIOR?a=o:o.getSym().getLabel().getLocation(0,an.RIGHT)===S.INTERIOR&&(a=o.getSym()),h.isTrue(null!==a,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(a)},visitShellInteriors:function(t,e){if(t instanceof Lt){var n=t;this.visitInteriorRing(n.getExteriorRing(),e)}if(t instanceof Tt)for(var i=t,r=0;r<i.getNumGeometries();r++){var n=i.getGeometryN(r);this.visitInteriorRing(n.getExteriorRing(),e)}},getCoordinate:function(){return this.disconnectedRingcoord},setInteriorEdgesInResult:function(t){for(var e=t.getEdgeEnds().iterator();e.hasNext();){var n=e.next();n.getLabel().getLocation(0,an.RIGHT)===S.INTERIOR&&n.setInResult(!0)}},visitLinkedDirectedEdges:function(t){var e=t,n=t;do{h.isTrue(null!==n,"found null Directed Edge"),n.setVisited(!0),n=n.getNext()}while(n!==e)},buildEdgeRings:function(t){for(var e=new x,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&null===i.getEdgeRing()){var r=new fn(i,this.geometryFactory);r.linkDirectedEdgesForMinimalEdgeRings();var s=r.buildMinimalRings();e.addAll(s)}}return e},hasUnvisitedShellEdge:function(t){for(var e=0;e<t.size();e++){var n=t.get(e);if(!n.isHole()){var i=n.getEdges(),r=i.get(0);if(r.getLabel().getLocation(0,an.RIGHT)===S.INTERIOR)for(var s=0;s<i.size();s++)if(r=i.get(s),!r.isVisited())return this.disconnectedRingcoord=r.getCoordinate(),!0}}return!1},isInteriorsConnected:function(){var t=new x;this.geomGraph.computeSplitEdges(t);var e=new xn(new Rn);e.addEdges(t),this.setInteriorEdgesInResult(e),e.linkResultDirectedEdges();var n=this.buildEdgeRings(e.getEdgeEnds());return this.visitShellInteriors(this.geomGraph.getGeometry(),e),!this.hasUnvisitedShellEdge(n)},interfaces_:function(){return[]},getClass:function(){return Pr}}),Pr.findDifferentPoint=function(t,e){for(var n=0;n<t.length;n++)if(!t[n].equals(e))return t[n];return null},io(br.prototype,{createEdgeEndForNext:function(t,e,n,i){var r=n.segmentIndex+1;if(r>=t.getNumPoints()&&null===i)return null;var s=t.getCoordinate(r);null!==i&&i.segmentIndex===n.segmentIndex&&(s=i.coord);var o=new mn(t,n.coord,s,new ln(t.getLabel()));e.add(o)},createEdgeEndForPrev:function(t,e,n,i){var r=n.segmentIndex;if(0===n.dist){if(0===r)return null;r--}var s=t.getCoordinate(r);null!==i&&i.segmentIndex>=r&&(s=i.coord);var o=new ln(t.getLabel());o.flip();var a=new mn(t,n.coord,s,o);e.add(a)},computeEdgeEnds:function(){if(1===arguments.length){for(var t=arguments[0],e=new x,n=t;n.hasNext();){var i=n.next();this.computeEdgeEnds(i,e)}return e}if(2===arguments.length){var r=arguments[0],s=arguments[1],o=r.getEdgeIntersectionList();o.addEndpoints();var a=o.iterator(),u=null,l=null;if(!a.hasNext())return null;var h=a.next();do{u=l,l=h,h=null,a.hasNext()&&(h=a.next()),null!==l&&(this.createEdgeEndForPrev(r,s,l,u),this.createEdgeEndForNext(r,s,l,h))}while(null!==l)}},interfaces_:function(){return[]},getClass:function(){return br}}),ro(_r,mn),io(_r.prototype,{insert:function(t){this.edgeEnds.add(t)},print:function(t){t.println("EdgeEndBundle--\x3e Label: "+this.label);for(var e=this.iterator();e.hasNext();){e.next().print(t),t.println()}},iterator:function(){return this.edgeEnds.iterator()},getEdgeEnds:function(){return this.edgeEnds},computeLabelOn:function(t,e){for(var n=0,i=!1,r=this.iterator();r.hasNext();){var s=r.next(),o=s.getLabel().getLocation(t);o===S.BOUNDARY&&n++,o===S.INTERIOR&&(i=!0)}var o=S.NONE;i&&(o=S.INTERIOR),n>0&&(o=Kn.determineBoundary(e,n)),this.label.setLocation(t,o)},computeLabelSide:function(t,e){for(var n=this.iterator();n.hasNext();){var i=n.next();if(i.getLabel().isArea()){var r=i.getLabel().getLocation(t,e);if(r===S.INTERIOR)return this.label.setLocation(t,e,S.INTERIOR),null;r===S.EXTERIOR&&this.label.setLocation(t,e,S.EXTERIOR)}}},getLabel:function(){return this.label},computeLabelSides:function(t){this.computeLabelSide(t,an.LEFT),this.computeLabelSide(t,an.RIGHT)},updateIM:function(t){jn.updateIM(this.label,t)},computeLabel:function(t){for(var e=!1,n=this.iterator();n.hasNext();){n.next().getLabel().isArea()&&(e=!0)}this.label=e?new ln(S.NONE,S.NONE,S.NONE):new ln(S.NONE);for(var i=0;i<2;i++)this.computeLabelOn(i,t),e&&this.computeLabelSides(i)},interfaces_:function(){return[]},getClass:function(){return _r}}),ro(Mr,Ln),io(Mr.prototype,{updateIM:function(t){for(var e=this.iterator();e.hasNext();){e.next().updateIM(t)}},insert:function(t){var e=this.edgeMap.get(t);null===e?(e=new _r(t),this.insertEdgeEnd(t,e)):e.insert(t)},interfaces_:function(){return[]},getClass:function(){return Mr}}),ro(Dr,dn),io(Dr.prototype,{updateIMFromEdges:function(t){this.edges.updateIM(t)},computeIM:function(t){t.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0)},interfaces_:function(){return[]},getClass:function(){return Dr}}),ro(Ar,yn),io(Ar.prototype,{createNode:function(t){return new Dr(t,new Mr)},interfaces_:function(){return[]},getClass:function(){return Ar}}),io(Fr.prototype,{insertEdgeEnds:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},getNodeIterator:function(){return this.nodes.iterator()},copyNodesAndLabels:function(t,e){for(var n=t.getNodeIterator();n.hasNext();){var i=n.next();this.nodes.addNode(i.getCoordinate()).setLabel(e,i.getLabel().getLocation(e))}},build:function(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);var e=new br,n=e.computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(n)},computeIntersectionNodes:function(t,e){for(var n=t.getEdgeIterator();n.hasNext();)for(var i=n.next(),r=i.getLabel().getLocation(e),s=i.getEdgeIntersectionList().iterator();s.hasNext();){var o=s.next(),a=this.nodes.addNode(o.coord);r===S.BOUNDARY?a.setLabelBoundary(e):a.getLabel().isNull(e)&&a.setLabel(e,S.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return Fr}}),io(Gr.prototype,{isNodeEdgeAreaLabelsConsistent:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();){var e=t.next();if(!e.getEdges().isAreaLabelsConsistent(this.geomGraph))return this.invalidPoint=e.getCoordinate().copy(),!1}return!0},getInvalidPoint:function(){return this.invalidPoint},hasDuplicateRings:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();)for(var e=t.next(),n=e.getEdges().iterator();n.hasNext();){var i=n.next();if(i.getEdgeEnds().size()>1)return this.invalidPoint=i.getEdge().getCoordinate(0),!0}return!1},isNodeConsistentArea:function(){var t=this.geomGraph.computeSelfNodes(this.li,!0,!0);return t.hasProperIntersection()?(this.invalidPoint=t.getProperIntersectionPoint(),!1):(this.nodeGraph.build(this.geomGraph),this.isNodeEdgeAreaLabelsConsistent())},interfaces_:function(){return[]},getClass:function(){return Gr}}),io(qr.prototype,{buildIndex:function(){this.index=new qe;for(var t=0;t<this.rings.size();t++){var e=this.rings.get(t),n=e.getEnvelopeInternal();this.index.insert(n,e)}},getNestedPoint:function(){return this.nestedPt},isNonNested:function(){this.buildIndex();for(var t=0;t<this.rings.size();t++)for(var e=this.rings.get(t),n=e.getCoordinates(),i=this.index.query(e.getEnvelopeInternal()),r=0;r<i.size();r++){var s=i.get(r),o=s.getCoordinates();if(e!==s&&e.getEnvelopeInternal().intersects(s.getEnvelopeInternal())){var a=Vr.findPtNotNode(n,s,this.graph);if(null!==a){var u=oe.isPointInRing(a,o);if(u)return this.nestedPt=a,!1}}}return!0},add:function(t){this.rings.add(t),this.totalEnv.expandToInclude(t.getEnvelopeInternal())},interfaces_:function(){return[]},getClass:function(){return qr}}),io(Br.prototype,{getErrorType:function(){return this.errorType},getMessage:function(){return Br.errMsg[this.errorType]},getCoordinate:function(){return this.pt},toString:function(){var t="";return null!==this.pt&&(t=" at or near point "+this.pt),this.getMessage()+t},interfaces_:function(){return[]},getClass:function(){return Br}}),Br.ERROR=0,Br.REPEATED_POINT=1,Br.HOLE_OUTSIDE_SHELL=2,Br.NESTED_HOLES=3,Br.DISCONNECTED_INTERIOR=4,Br.SELF_INTERSECTION=5,Br.RING_SELF_INTERSECTION=6,Br.NESTED_SHELLS=7,Br.DUPLICATE_RINGS=8,Br.TOO_FEW_POINTS=9,Br.INVALID_COORDINATE=10,Br.RING_NOT_CLOSED=11,Br.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"],io(Vr.prototype,{checkInvalidCoordinates:function(){if(arguments[0]instanceof Array){for(var t=arguments[0],e=0;e<t.length;e++)if(!Vr.isValid(t[e]))return this.validErr=new Br(Br.INVALID_COORDINATE,t[e]),null}else if(arguments[0]instanceof Lt){var n=arguments[0];if(this.checkInvalidCoordinates(n.getExteriorRing().getCoordinates()),null!==this.validErr)return null;for(var e=0;e<n.getNumInteriorRing();e++)if(this.checkInvalidCoordinates(n.getInteriorRingN(e).getCoordinates()),null!==this.validErr)return null}},checkHolesNotNested:function(t,e){for(var n=new qr(e),i=0;i<t.getNumInteriorRing();i++){var r=t.getInteriorRingN(i);n.add(r)}n.isNonNested()||(this.validErr=new Br(Br.NESTED_HOLES,n.getNestedPoint()))},checkConsistentArea:function(t){var e=new Gr(t);if(!e.isNodeConsistentArea())return this.validErr=new Br(Br.SELF_INTERSECTION,e.getInvalidPoint()),null;e.hasDuplicateRings()&&(this.validErr=new Br(Br.DUPLICATE_RINGS,e.getInvalidPoint()))},isValid:function(){return this.checkValid(this.parentGeometry),null===this.validErr},checkShellInsideHole:function(t,e,n){var i=t.getCoordinates(),r=e.getCoordinates(),s=Vr.findPtNotNode(i,e,n);if(null!==s){if(!oe.isPointInRing(s,r))return s}var o=Vr.findPtNotNode(r,t,n);if(null!==o){return oe.isPointInRing(o,i)?o:null}return h.shouldNeverReachHere("points in shell and hole appear to be equal"),null},checkNoSelfIntersectingRings:function(t){for(var e=t.getEdgeIterator();e.hasNext();){var n=e.next();if(this.checkNoSelfIntersectingRing(n.getEdgeIntersectionList()),null!==this.validErr)return null}},checkConnectedInteriors:function(t){var e=new Pr(t);e.isInteriorsConnected()||(this.validErr=new Br(Br.DISCONNECTED_INTERIOR,e.getCoordinate()))},checkNoSelfIntersectingRing:function(t){for(var e=new rt,n=!0,i=t.iterator();i.hasNext();){var r=i.next();if(n)n=!1;else{if(e.contains(r.coord))return this.validErr=new Br(Br.RING_SELF_INTERSECTION,r.coord),null;e.add(r.coord)}}},checkHolesInShell:function(t,e){for(var n=t.getExteriorRing(),i=new vi(n),r=0;r<t.getNumInteriorRing();r++){var s=t.getInteriorRingN(r),o=Vr.findPtNotNode(s.getCoordinates(),n,e);if(null===o)return null;if(!i.isInside(o))return this.validErr=new Br(Br.HOLE_OUTSIDE_SHELL,o),null}},checkTooFewPoints:function(t){if(t.hasTooFewPoints())return this.validErr=new Br(Br.TOO_FEW_POINTS,t.getInvalidPoint()),null},getValidationError:function(){return this.checkValid(this.parentGeometry),this.validErr},checkValid:function(){if(arguments[0]instanceof Ct){var t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof wt){var e=arguments[0];this.checkInvalidCoordinates(e.getCoordinates())}else if(arguments[0]instanceof Rt){var n=arguments[0];if(this.checkInvalidCoordinates(n.getCoordinates()),null!==this.validErr)return null;if(this.checkClosedRing(n),null!==this.validErr)return null;var i=new Kn(0,n);if(this.checkTooFewPoints(i),null!==this.validErr)return null;var r=new ie;i.computeSelfNodes(r,!0,!0),this.checkNoSelfIntersectingRings(i)}else if(arguments[0]instanceof It){var s=arguments[0];if(this.checkInvalidCoordinates(s.getCoordinates()),null!==this.validErr)return null;var i=new Kn(0,s);this.checkTooFewPoints(i)}else if(arguments[0]instanceof Lt){var o=arguments[0];if(this.checkInvalidCoordinates(o),null!==this.validErr)return null;if(this.checkClosedRings(o),null!==this.validErr)return null;var i=new Kn(0,o);if(this.checkTooFewPoints(i),null!==this.validErr)return null;if(this.checkConsistentArea(i),null!==this.validErr)return null;if(!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(i),null!==this.validErr))return null;if(this.checkHolesInShell(o,i),null!==this.validErr)return null;if(this.checkHolesNotNested(o,i),null!==this.validErr)return null;this.checkConnectedInteriors(i)}else if(arguments[0]instanceof Tt){for(var a=arguments[0],u=0;u<a.getNumGeometries();u++){var l=a.getGeometryN(u);if(this.checkInvalidCoordinates(l),null!==this.validErr)return null;if(this.checkClosedRings(l),null!==this.validErr)return null}var i=new Kn(0,a);if(this.checkTooFewPoints(i),null!==this.validErr)return null;if(this.checkConsistentArea(i),null!==this.validErr)return null;if(!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(i),null!==this.validErr))return null;for(var u=0;u<a.getNumGeometries();u++){var l=a.getGeometryN(u);if(this.checkHolesInShell(l,i),null!==this.validErr)return null}for(var u=0;u<a.getNumGeometries();u++){var l=a.getGeometryN(u);if(this.checkHolesNotNested(l,i),null!==this.validErr)return null}if(this.checkShellsNotNested(a,i),null!==this.validErr)return null;this.checkConnectedInteriors(i)}else if(arguments[0]instanceof lt)for(var h=arguments[0],u=0;u<h.getNumGeometries();u++){var c=h.getGeometryN(u);if(this.checkValid(c),null!==this.validErr)return null}else if(arguments[0]instanceof F){var f=arguments[0];if(this.validErr=null,f.isEmpty())return null;if(f instanceof Ct)this.checkValid(f);else if(f instanceof wt)this.checkValid(f);else if(f instanceof Rt)this.checkValid(f);else if(f instanceof It)this.checkValid(f);else if(f instanceof Lt)this.checkValid(f);else if(f instanceof Tt)this.checkValid(f);else{if(!(f instanceof lt))throw new UnsupportedOperationException(f.getClass().getName());this.checkValid(f)}}},setSelfTouchingRingFormingHoleValid:function(t){this.isSelfTouchingRingFormingHoleValid=t},checkShellNotNested:function(t,e,n){var i=t.getCoordinates(),r=e.getExteriorRing(),s=r.getCoordinates(),o=Vr.findPtNotNode(i,r,n);if(null===o)return null;if(!oe.isPointInRing(o,s))return null;if(e.getNumInteriorRing()<=0)return this.validErr=new Br(Br.NESTED_SHELLS,o),null;for(var a=null,u=0;u<e.getNumInteriorRing();u++){var l=e.getInteriorRingN(u);if(null===(a=this.checkShellInsideHole(t,l,n)))return null}this.validErr=new Br(Br.NESTED_SHELLS,a)},checkClosedRings:function(t){if(this.checkClosedRing(t.getExteriorRing()),null!==this.validErr)return null;for(var e=0;e<t.getNumInteriorRing();e++)if(this.checkClosedRing(t.getInteriorRingN(e)),null!==this.validErr)return null},checkClosedRing:function(t){if(!t.isClosed()){var e=null;t.getNumPoints()>=1&&(e=t.getCoordinateN(0)),this.validErr=new Br(Br.RING_NOT_CLOSED,e)}},checkShellsNotNested:function(t,e){for(var n=0;n<t.getNumGeometries();n++)for(var i=t.getGeometryN(n),r=i.getExteriorRing(),s=0;s<t.getNumGeometries();s++)if(n!==s){var o=t.getGeometryN(s);if(this.checkShellNotNested(r,o,e),null!==this.validErr)return null}},interfaces_:function(){return[]},getClass:function(){return Vr}}),Vr.findPtNotNode=function(t,e,n){for(var i=n.findEdge(e),r=i.getEdgeIntersectionList(),s=0;s<t.length;s++){var o=t[s];if(!r.isIntersection(o))return o}return null},Vr.isValid=function(){if(arguments[0]instanceof F){return new Vr(arguments[0]).isValid()}if(arguments[0]instanceof c){var t=arguments[0];return!i.isNaN(t.x)&&(!i.isInfinite(t.x)&&(!i.isNaN(t.y)&&!i.isInfinite(t.y)))}},io(zr.prototype,{isIncluded:function(){return this._isIncluded},getCoordinates:function(){if(null===this.ringPts){for(var t=new E,e=this.deList.iterator();e.hasNext();){var n=e.next(),i=n.getEdge();zr.addEdge(i.getLine().getCoordinates(),n.getEdgeDirection(),t)}this.ringPts=t.toCoordinateArray()}return this.ringPts},isIncludedSet:function(){return this._isIncludedSet},isValid:function(){return this.getCoordinates(),!(this.ringPts.length<=3)&&(this.getRing(),Vr.isValid(this.ring))},build:function(t){var e=t;do{this.add(e),e.setRing(this),e=e.getNext(),h.isTrue(null!==e,"found null DE in ring"),h.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t)},isOuterHole:function(){return!!this._isHole&&!this.hasShell()},getPolygon:function(){var t=null;if(null!==this.holes){t=new Array(this.holes.size()).fill(null);for(var e=0;e<this.holes.size();e++)t[e]=this.holes.get(e)}return this.factory.createPolygon(this.ring,t)},isHole:function(){return this._isHole},isProcessed:function(){return this._isProcessed},addHole:function(){if(arguments[0]instanceof Rt){var t=arguments[0];null===this.holes&&(this.holes=new x),this.holes.add(t)}else if(arguments[0]instanceof zr){var e=arguments[0];e.setShell(this);var n=e.getRing();null===this.holes&&(this.holes=new x),this.holes.add(n)}},setIncluded:function(t){this._isIncluded=t,this._isIncludedSet=!0},getOuterHole:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var e=this.deList.get(t),n=e.getSym().getRing();if(n.isOuterHole())return n}return null},computeHole:function(){var t=this.getRing();this._isHole=oe.isCCW(t.getCoordinates())},hasShell:function(){return null!==this.shell},isOuterShell:function(){return null!==this.getOuterHole()},getLineString:function(){return this.getCoordinates(),this.factory.createLineString(this.ringPts)},toString:function(){return ee.toLineString(new Dt(this.getCoordinates()))},getShell:function(){return this.isHole()?this.shell:this},add:function(t){this.deList.add(t)},getRing:function(){if(null!==this.ring)return this.ring;this.getCoordinates(),this.ringPts.length<3&&_.out.println(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts)}catch(t){if(!(t instanceof N))throw t;_.out.println(this.ringPts)}return this.ring},updateIncluded:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var e=this.deList.get(t),n=e.getSym().getRing().getShell();if(null!==n&&n.isIncludedSet())return this.setIncluded(!n.isIncluded()),null}},setShell:function(t){this.shell=t},setProcessed:function(t){this._isProcessed=t},interfaces_:function(){return[]},getClass:function(){return zr}}),zr.findDirEdgesInRing=function(t){var e=t,n=new x;do{n.add(e),e=e.getNext(),h.isTrue(null!==e,"found null DE in ring"),h.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t);return n},zr.addEdge=function(t,e,n){if(e)for(var i=0;i<t.length;i++)n.add(t[i],!1);else for(var i=t.length-1;i>=0;i--)n.add(t[i],!1)},zr.findEdgeRingContaining=function(t,e){for(var n=t.getRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),s=null,o=null,a=e.iterator();a.hasNext();){var u=a.next(),l=u.getRing(),h=l.getEnvelopeInternal();if(!h.equals(i)&&h.contains(i)){r=Y.ptNotInList(n.getCoordinates(),l.getCoordinates());var c=!1;oe.isPointInRing(r,l.getCoordinates())&&(c=!0),c&&(null===s||o.contains(h))&&(s=u,o=s.getRing().getEnvelopeInternal())}}return s},io(kr.prototype,{compare:function(t,e){var n=t,i=e;return n.getRing().getEnvelope().compareTo(i.getRing().getEnvelope())},interfaces_:function(){return[o]},getClass:function(){return kr}}),zr.EnvelopeComparator=kr,ro(Yr,Lr),io(Yr.prototype,{findEdgeRing:function(t){var e=new zr(this.factory);return e.build(t),e},computeDepthParity:function(){if(0===arguments.length)for(;;){return null}else if(1===arguments.length){arguments[0]}},computeNextCWEdges:function(){for(var t=this.nodeIterator();t.hasNext();){var e=t.next();Yr.computeNextCWEdges(e)}},addEdge:function(t){if(t.isEmpty())return null;var e=Y.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return null;var n=e[0],i=e[e.length-1],r=this.getNode(n),s=this.getNode(i),o=new Tr(r,s,e[1],!0),a=new Tr(s,r,e[e.length-2],!1),u=new Or(t);u.setDirectedEdges(o,a),this.add(u)},deleteCutEdges:function(){this.computeNextCWEdges(),Yr.findLabeledEdgeRings(this.dirEdges);for(var t=new x,e=this.dirEdges.iterator();e.hasNext();){var n=e.next();if(!n.isMarked()){var i=n.getSym();if(n.getLabel()===i.getLabel()){n.setMarked(!0),i.setMarked(!0);var r=n.getEdge();t.add(r.getLine())}}}return t},getEdgeRings:function(){this.computeNextCWEdges(),Yr.label(this.dirEdges,-1);var t=Yr.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(t);for(var e=new x,n=this.dirEdges.iterator();n.hasNext();){var i=n.next();if(!i.isMarked()&&!i.isInRing()){var r=this.findEdgeRing(i);e.add(r)}}return e},getNode:function(t){var e=this.findNode(t);return null===e&&(e=new Nr(t),this.add(e)),e},convertMaximalToMinimalEdgeRings:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel(),r=Yr.findIntersectionNodes(n,i);if(null!==r)for(var s=r.iterator();s.hasNext();){var o=s.next();Yr.computeNextCCWEdges(o,i)}}},deleteDangles:function(){for(var t=this.findNodesOfDegree(1),e=new K,n=new ce,i=t.iterator();i.hasNext();)n.push(i.next());for(;!n.isEmpty();){var r=n.pop();Yr.deleteAllEdges(r);for(var s=r.getOutEdges().getEdges(),i=s.iterator();i.hasNext();){var o=i.next();o.setMarked(!0);var a=o.getSym();null!==a&&a.setMarked(!0);var u=o.getEdge();e.add(u.getLine());var l=o.getToNode();1===Yr.getDegreeNonDeleted(l)&&n.push(l)}}return e},interfaces_:function(){return[]},getClass:function(){return Yr}}),Yr.findLabeledEdgeRings=function(t){for(var e=new x,n=1,i=t.iterator();i.hasNext();){var r=i.next();if(!r.isMarked()&&!(r.getLabel()>=0)){e.add(r);var s=zr.findDirEdgesInRing(r);Yr.label(s,n),n++}}return e},Yr.getDegreeNonDeleted=function(t){for(var e=t.getOutEdges().getEdges(),n=0,i=e.iterator();i.hasNext();){i.next().isMarked()||n++}return n},Yr.deleteAllEdges=function(t){for(var e=t.getOutEdges().getEdges(),n=e.iterator();n.hasNext();){var i=n.next();i.setMarked(!0);var r=i.getSym();null!==r&&r.setMarked(!0)}},Yr.label=function(t,e){for(var n=t.iterator();n.hasNext();){n.next().setLabel(e)}},Yr.computeNextCWEdges=function(t){for(var e=t.getOutEdges(),n=null,i=null,r=e.getEdges().iterator();r.hasNext();){var s=r.next();if(!s.isMarked()){if(null===n&&(n=s),null!==i){var o=i.getSym();o.setNext(s)}i=s}}if(null!==i){var o=i.getSym();o.setNext(n)}},Yr.computeNextCCWEdges=function(t,e){for(var n=t.getOutEdges(),i=null,r=null,s=n.getEdges(),o=s.size()-1;o>=0;o--){var a=s.get(o),u=a.getSym(),l=null;a.getLabel()===e&&(l=a);var c=null;u.getLabel()===e&&(c=u),null===l&&null===c||(null!==c&&(r=c),null!==l&&(null!==r&&(r.setNext(l),r=null),null===i&&(i=l)))}null!==r&&(h.isTrue(null!==i),r.setNext(i))},Yr.getDegree=function(t,e){
for(var n=t.getOutEdges().getEdges(),i=0,r=n.iterator();r.hasNext();){r.next().getLabel()===e&&i++}return i},Yr.findIntersectionNodes=function(t,e){var n=t,i=null;do{var r=n.getFromNode();Yr.getDegree(r,e)>1&&(null===i&&(i=new x),i.add(r)),n=n.getNext(),h.isTrue(null!==n,"found null DE in ring"),h.isTrue(n===t||!n.isInRing(),"found DE already in ring")}while(n!==t);return i},io(Ur.prototype,{getGeometry:function(){return null===this.geomFactory&&(this.geomFactory=new $t),this.polygonize(),this.extractOnlyPolygonal?this.geomFactory.buildGeometry(this.polyList):this.geomFactory.createGeometryCollection($t.toGeometryArray(this.polyList))},getInvalidRingLines:function(){return this.polygonize(),this.invalidRingLines},findValidRings:function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isValid()?e.add(r):n.add(r.getLineString())}},polygonize:function(){if(null!==this.polyList)return null;if(this.polyList=new x,null===this.graph)return null;this.dangles=this.graph.deleteDangles(),this.cutEdges=this.graph.deleteCutEdges();var t=this.graph.getEdgeRings(),e=new x;this.invalidRingLines=new x,this.isCheckingRingsValid?this.findValidRings(t,e,this.invalidRingLines):e=t,this.findShellsAndHoles(e),Ur.assignHolesToShells(this.holeList,this.shellList),xo.sort(this.shellList,new zr.EnvelopeComparator);var n=!0;this.extractOnlyPolygonal&&(Ur.findDisjointShells(this.shellList),n=!1),this.polyList=Ur.extractPolygons(this.shellList,n)},getDangles:function(){return this.polygonize(),this.dangles},getCutEdges:function(){return this.polygonize(),this.cutEdges},getPolygons:function(){return this.polygonize(),this.polyList},add:function(){if(oo(arguments[0],d))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.add(n)}else if(arguments[0]instanceof It){var i=arguments[0];this.geomFactory=i.getFactory(),null===this.graph&&(this.graph=new Yr(this.geomFactory)),this.graph.addEdge(i)}else if(arguments[0]instanceof F){var r=arguments[0];r.apply(this.lineStringAdder)}},setCheckRingsValid:function(t){this.isCheckingRingsValid=t},findShellsAndHoles:function(t){this.holeList=new x,this.shellList=new x;for(var e=t.iterator();e.hasNext();){var n=e.next();n.computeHole(),n.isHole()?this.holeList.add(n):this.shellList.add(n)}},interfaces_:function(){return[]},getClass:function(){return Ur}}),Ur.findOuterShells=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getOuterHole();null===i||i.isProcessed()||(n.setIncluded(!0),i.setProcessed(!0))}},Ur.extractPolygons=function(t,e){for(var n=new x,i=t.iterator();i.hasNext();){var r=i.next();(e||r.isIncluded())&&n.add(r.getPolygon())}return n},Ur.assignHolesToShells=function(t,e){for(var n=t.iterator();n.hasNext();){var i=n.next();Ur.assignHoleToShell(i,e)}},Ur.assignHoleToShell=function(t,e){var n=zr.findEdgeRingContaining(t,e);null!==n&&n.addHole(t)},Ur.findDisjointShells=function(t){Ur.findOuterShells(t);var e=null;do{e=!1;for(var n=t.iterator();n.hasNext();){var i=n.next();i.isIncludedSet()||(i.updateIncluded(),i.isIncludedSet()||(e=!0))}}while(e)},io(Xr.prototype,{filter:function(t){t instanceof It&&this.p.add(t)},interfaces_:function(){return[A]},getClass:function(){return Xr}}),Ur.LineStringAdder=Xr;var Fo=Object.freeze({Polygonizer:Ur});io(Hr.prototype,{insertEdgeEnds:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},computeProperIntersectionIM:function(t,e){var n=this.arg[0].getGeometry().getDimension(),i=this.arg[1].getGeometry().getDimension(),r=t.hasProperIntersection(),s=t.hasProperInteriorIntersection();2===n&&2===i?r&&e.setAtLeast("212101212"):2===n&&1===i?(r&&e.setAtLeast("FFF0FFFF2"),s&&e.setAtLeast("1FFFFF1FF")):1===n&&2===i?(r&&e.setAtLeast("F0FFFFFF2"),s&&e.setAtLeast("1F1FFFFFF")):1===n&&1===i&&s&&e.setAtLeast("0FFFFFFFF")},labelIsolatedEdges:function(t,e){for(var n=this.arg[t].getEdgeIterator();n.hasNext();){var i=n.next();i.isIsolated()&&(this.labelIsolatedEdge(i,e,this.arg[e].getGeometry()),this.isolatedEdges.add(i))}},labelIsolatedEdge:function(t,e,n){if(n.getDimension()>0){var i=this.ptLocator.locate(t.getCoordinate(),n);t.getLabel().setAllLocations(e,i)}else t.getLabel().setAllLocations(e,S.EXTERIOR)},computeIM:function(){var t=new ue;if(t.set(S.EXTERIOR,S.EXTERIOR,2),!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(t),t;this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1);var e=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(e,t);var n=new br,i=n.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(i);var r=n.computeEdgeEnds(this.arg[1].getEdgeIterator());return this.insertEdgeEnds(r),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(t),t},labelNodeEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){t.next().getEdges().computeLabelling(this.arg)}},copyNodesAndLabels:function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next();this.nodes.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},labelIntersectionNodes:function(t){for(var e=this.arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next(),o=this.nodes.find(s.coord);o.getLabel().isNull(t)&&(i===S.BOUNDARY?o.setLabelBoundary(t):o.setLabel(t,S.INTERIOR))}},labelIsolatedNode:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setAllLocations(e,n)},computeIntersectionNodes:function(t){for(var e=this.arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next(),o=this.nodes.addNode(s.coord);i===S.BOUNDARY?o.setLabelBoundary(t):o.getLabel().isNull(t)&&o.setLabel(t,S.INTERIOR)}},labelIsolatedNodes:function(){for(var t=this.nodes.iterator();t.hasNext();){var e=t.next(),n=e.getLabel();h.isTrue(n.getGeometryCount()>0,"node with empty label found"),e.isIsolated()&&(n.isNull(0)?this.labelIsolatedNode(e,0):this.labelIsolatedNode(e,1))}},updateIM:function(t){for(var e=this.isolatedEdges.iterator();e.hasNext();){e.next().updateIM(t)}for(var n=this.nodes.iterator();n.hasNext();){var i=n.next();i.updateIM(t),i.updateIMFromEdges(t)}},computeDisjointIM:function(t){var e=this.arg[0].getGeometry();e.isEmpty()||(t.set(S.INTERIOR,S.EXTERIOR,e.getDimension()),t.set(S.BOUNDARY,S.EXTERIOR,e.getBoundaryDimension()));var n=this.arg[1].getGeometry();n.isEmpty()||(t.set(S.EXTERIOR,S.INTERIOR,n.getDimension()),t.set(S.EXTERIOR,S.BOUNDARY,n.getBoundaryDimension()))},interfaces_:function(){return[]},getClass:function(){return Hr}}),io(Wr.prototype,{isContainedInBoundary:function(t){if(t instanceof Lt)return!1;if(t instanceof Ct)return this.isPointContainedInBoundary(t);if(t instanceof It)return this.isLineStringContainedInBoundary(t);for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.isContainedInBoundary(n))return!1}return!0},isLineSegmentContainedInBoundary:function(t,e){if(t.equals(e))return this.isPointContainedInBoundary(t);if(t.x===e.x){if(t.x===this.rectEnv.getMinX()||t.x===this.rectEnv.getMaxX())return!0}else if(t.y===e.y&&(t.y===this.rectEnv.getMinY()||t.y===this.rectEnv.getMaxY()))return!0;return!1},isLineStringContainedInBoundary:function(t){for(var e=t.getCoordinateSequence(),n=new c,i=new c,r=0;r<e.size()-1;r++)if(e.getCoordinate(r,n),e.getCoordinate(r+1,i),!this.isLineSegmentContainedInBoundary(n,i))return!1;return!0},isPointContainedInBoundary:function(){if(arguments[0]instanceof Ct){var t=arguments[0];return this.isPointContainedInBoundary(t.getCoordinate())}if(arguments[0]instanceof c){var e=arguments[0];return e.x===this.rectEnv.getMinX()||e.x===this.rectEnv.getMaxX()||e.y===this.rectEnv.getMinY()||e.y===this.rectEnv.getMaxY()}},contains:function(t){return!!this.rectEnv.contains(t.getEnvelopeInternal())&&!this.isContainedInBoundary(t)},interfaces_:function(){return[]},getClass:function(){return Wr}}),Wr.contains=function(t,e){return new Wr(t).contains(e)},io(jr.prototype,{intersects:function(t,e){var n=new I(t,e);if(!this.rectEnv.intersects(n))return!1;if(this.rectEnv.intersects(t))return!0;if(this.rectEnv.intersects(e))return!0;if(t.compareTo(e)>0){var i=t;t=e,e=i}var r=!1;return e.y>t.y&&(r=!0),r?this.li.computeIntersection(t,e,this.diagDown0,this.diagDown1):this.li.computeIntersection(t,e,this.diagUp0,this.diagUp1),!!this.li.hasIntersection()},interfaces_:function(){return[]},getClass:function(){return jr}}),io(Kr.prototype,{applyTo:function(t){for(var e=0;e<t.getNumGeometries()&&!this._isDone;e++){var n=t.getGeometryN(e);if(n instanceof lt)this.applyTo(n);else if(this.visit(n),this.isDone())return this._isDone=!0,null}},interfaces_:function(){return[]},getClass:function(){return Kr}}),io(Zr.prototype,{intersects:function(t){if(!this.rectEnv.intersects(t.getEnvelopeInternal()))return!1;var e=new Qr(this.rectEnv);if(e.applyTo(t),e.intersects())return!0;var n=new Jr(this.rectangle);if(n.applyTo(t),n.containsPoint())return!0;var i=new $r(this.rectangle);return i.applyTo(t),!!i.intersects()},interfaces_:function(){return[]},getClass:function(){return Zr}}),Zr.intersects=function(t,e){return new Zr(t).intersects(e)},ro(Qr,Kr),io(Qr.prototype,{isDone:function(){return!0===this._intersects},visit:function(t){var e=t.getEnvelopeInternal();return this.rectEnv.intersects(e)?this.rectEnv.contains(e)?(this._intersects=!0,null):e.getMinX()>=this.rectEnv.getMinX()&&e.getMaxX()<=this.rectEnv.getMaxX()?(this._intersects=!0,null):e.getMinY()>=this.rectEnv.getMinY()&&e.getMaxY()<=this.rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null},intersects:function(){return this._intersects},interfaces_:function(){return[]},getClass:function(){return Qr}}),ro(Jr,Kr),io(Jr.prototype,{isDone:function(){return!0===this._containsPoint},visit:function(t){if(!(t instanceof Lt))return null;var e=t.getEnvelopeInternal();if(!this.rectEnv.intersects(e))return null;for(var n=new c,i=0;i<4;i++)if(this.rectSeq.getCoordinate(i,n),e.contains(n)&&Sn.containsPointInPolygon(n,t))return this._containsPoint=!0,null},containsPoint:function(){return this._containsPoint},interfaces_:function(){return[]},getClass:function(){return Jr}}),ro($r,Kr),io($r.prototype,{intersects:function(){return this.hasIntersection},isDone:function(){return!0===this.hasIntersection},visit:function(t){var e=t.getEnvelopeInternal();if(!this.rectEnv.intersects(e))return null;var n=qn.getLines(t);this.checkIntersectionWithLineStrings(n)},checkIntersectionWithLineStrings:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();if(this.checkIntersectionWithSegments(n),this.hasIntersection)return null}},checkIntersectionWithSegments:function(t){for(var e=t.getCoordinateSequence(),n=1;n<e.size();n++)if(e.getCoordinate(n-1,this.p0),e.getCoordinate(n,this.p1),this.rectIntersector.intersects(this.p0,this.p1))return this.hasIntersection=!0,null},interfaces_:function(){return[]},getClass:function(){return $r}}),ro(ts,Zn),io(ts.prototype,{getIntersectionMatrix:function(){return this._relate.computeIM()},interfaces_:function(){return[]},getClass:function(){return ts}}),ts.covers=function(t,e){return!!t.getEnvelopeInternal().covers(e.getEnvelopeInternal())&&(!!t.isRectangle()||ts.relate(t,e).isCovers())},ts.intersects=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&(t.isRectangle()?Zr.intersects(t,e):e.isRectangle()?Zr.intersects(e,t):ts.relate(t,e).isIntersects())},ts.touches=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&ts.relate(t,e).isTouches(t.getDimension(),e.getDimension())},ts.within=function(t,e){return e.contains(t)},ts.coveredBy=function(t,e){return ts.covers(e,t)},ts.relate=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new ts(t,e),i=n.getIntersectionMatrix();return i}if(3===arguments.length){if("string"==typeof arguments[2]&&arguments[0]instanceof F&&arguments[1]instanceof F){var r=arguments[0],s=arguments[1],o=arguments[2];return ts.relateWithCheck(r,s).matches(o)}if(oo(arguments[2],q)&&arguments[0]instanceof F&&arguments[1]instanceof F){var a=arguments[0],u=arguments[1],l=arguments[2],n=new ts(a,u,l),i=n.getIntersectionMatrix();return i}}},ts.overlaps=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&ts.relate(t,e).isOverlaps(t.getDimension(),e.getDimension())},ts.disjoint=function(t,e){return!t.intersects(e)},ts.relateWithCheck=function(t,e){return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ts.relate(t,e)},ts.crosses=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&ts.relate(t,e).isCrosses(t.getDimension(),e.getDimension())},ts.contains=function(t,e){return!!t.getEnvelopeInternal().contains(e.getEnvelopeInternal())&&(t.isRectangle()?Wr.contains(t,e):ts.relate(t,e).isContains())};var Go=Object.freeze({RelateOp:ts});io(es.prototype,{extractElements:function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this.skipEmpty&&i.isEmpty()||e.add(i)}},combine:function(){for(var t=new x,e=this.inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this.geomFactory?this.geomFactory.createGeometryCollection(null):null:this.geomFactory.buildGeometry(t)},interfaces_:function(){return[]},getClass:function(){return es}}),es.combine=function(){if(1===arguments.length){var t=arguments[0],e=new es(t);return e.combine()}if(2===arguments.length){var n=arguments[0],i=arguments[1],e=new es(es.createList(n,i));return e.combine()}if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],e=new es(es.createList(r,s,o));return e.combine()}},es.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},es.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new x;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],n=new x;return n.add(i),n.add(r),n.add(s),n}},io(ns.prototype,{union:function(){for(var t=new Se,e=new rt,n=0;n<this.pointGeom.getNumGeometries();n++){var i=this.pointGeom.getGeometryN(n),r=i.getCoordinate();t.locate(r,this.otherGeom)===S.EXTERIOR&&e.add(r)}if(0===e.size())return this.otherGeom;var s=null,o=Y.toCoordinateArray(e);return s=1===o.length?this.geomFact.createPoint(o[0]):this.geomFact.createMultiPointFromCoords(o),es.combine(s,this.otherGeom)},interfaces_:function(){return[]},getClass:function(){return ns}}),ns.union=function(t,e){return new ns(t,e).union()},io(is.prototype,{filter:function(t){-1!==this.sortIndex&&t.getSortIndex()!==this.sortIndex||this.comps.add(t)},interfaces_:function(){return[at]},getClass:function(){return is}}),is.extract=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return is.extract(t,e,new x)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];return n.getSortIndex()===i?r.add(n):n instanceof lt&&n.apply(new is(i,r)),r}},io(rs.prototype,{reduceToGeometries:function(t){for(var e=new x,n=t.iterator();n.hasNext();){var i=n.next(),r=null;oo(i,m)?r=this.unionTree(i):i instanceof F&&(r=i),e.add(r)}return e},extractByEnvelope:function(t,e,n){for(var i=new x,r=0;r<e.getNumGeometries();r++){var s=e.getGeometryN(r);s.getEnvelopeInternal().intersects(t)?i.add(s):n.add(s)}return this.geomFactory.buildGeometry(i)},unionOptimized:function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i)){return es.combine(t,e)}if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},union:function(){if(null===this.inputPolys)throw new IllegalStateException("union() method cannot be called twice");if(this.inputPolys.isEmpty())return null;this.geomFactory=this.inputPolys.iterator().next().getFactory();for(var t=new qe(rs.STRTREE_NODE_CAPACITY),e=this.inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this.inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},binaryUnion:function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(i-n<=1){var r=rs.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(rs.getGeometry(e,n),rs.getGeometry(e,n+1));var s=Math.trunc((i+n)/2),r=this.binaryUnion(e,n,s),o=this.binaryUnion(e,s,i);return this.unionSafe(r,o)}},repeatedUnion:function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},unionSafe:function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},unionActual:function(t,e){return rs.restrictToPolygons(t.union(e))},unionTree:function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},unionUsingEnvelopeIntersection:function(t,e,n){var i=new x,r=this.extractByEnvelope(n,t,i),s=this.extractByEnvelope(n,e,i),o=this.unionActual(r,s);return i.add(o),es.combine(i)},bufferUnion:function(){if(1===arguments.length){var t=arguments[0],e=t.get(0).getFactory(),n=e.buildGeometry(t),i=n.buffer(0);return i}if(2===arguments.length){var r=arguments[0],s=arguments[1],e=r.getFactory(),n=e.createGeometryCollection([r,s]),i=n.buffer(0);return i}},interfaces_:function(){return[]},getClass:function(){return rs}}),rs.restrictToPolygons=function(t){if(oo(t,St))return t;var e=cr.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon($t.toPolygonArray(e))},rs.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},rs.union=function(t){return new rs(t).union()},rs.STRTREE_NODE_CAPACITY=4,io(ss.prototype,{unionNoOpt:function(t){var e=this.geomFact.createPoint();return ei.overlayOp(t,e,$n.UNION)},unionWithNull:function(t,e){return null===t&&null===e?null:null===e?t:null===t?e:t.union(e)},extract:function(){if(oo(arguments[0],d))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.extract(n)}else if(arguments[0]instanceof F){var i=arguments[0];null===this.geomFact&&(this.geomFact=i.getFactory()),is.extract(i,F.SORTINDEX_POLYGON,this.polygons),is.extract(i,F.SORTINDEX_LINESTRING,this.lines),is.extract(i,F.SORTINDEX_POINT,this.points)}},union:function(){if(null===this.geomFact)return null;var t=null;if(this.points.size()>0){var e=this.geomFact.buildGeometry(this.points);t=this.unionNoOpt(e)}var n=null;if(this.lines.size()>0){var i=this.geomFact.buildGeometry(this.lines);n=this.unionNoOpt(i)}var r=null;this.polygons.size()>0&&(r=rs.union(this.polygons));var s=this.unionWithNull(n,r),o=null;return o=null===t?s:null===s?t:ns.union(t,s),null===o?this.geomFact.createGeometryCollection():o},interfaces_:function(){return[]},getClass:function(){return ss}}),ss.union=function(){if(1===arguments.length){if(oo(arguments[0],d)){var t=arguments[0],e=new ss(t);return e.union()}if(arguments[0]instanceof F){var n=arguments[0],e=new ss(n);return e.union()}}else if(2===arguments.length){var i=arguments[0],r=arguments[1],e=new ss(i,r);return e.union()}};var qo=Object.freeze({UnaryUnionOp:ss}),Bo=Object.freeze({IsValidOp:Vr,ConsistentAreaTester:Gr}),Vo=Object.freeze({BoundaryOp:ct,IsSimpleOp:Yi,buffer:_o,distance:Mo,linemerge:Do,overlay:Ao,polygonize:Fo,relate:Go,union:qo,valid:Bo});ro(os,Ot.CoordinateOperation),io(os.prototype,{editCoordinates:function(t,e){if(0===t.length)return null;for(var n=new Array(t.length).fill(null),i=0;i<t.length;i++){var r=new c(t[i]);this.targetPM.makePrecise(r),n[i]=r}var s=new E(n,!1),o=s.toCoordinateArray(),a=0;e instanceof It&&(a=2),e instanceof Rt&&(a=4);var u=n;return this.removeCollapsed&&(u=null),o.length<a?u:o},interfaces_:function(){return[]},getClass:function(){return os}}),io(as.prototype,{fixPolygonalTopology:function(t){var e=t;this.changePrecisionModel||(e=this.changePM(t,this.targetPM));var n=e.buffer(0),i=n;return this.changePrecisionModel||(i=this.changePM(n,t.getPrecisionModel())),i},reducePointwise:function(t){var e=null;if(this.changePrecisionModel){e=new Ot(this.createFactory(t.getFactory(),this.targetPM))}else e=new Ot;var n=this.removeCollapsed;return t.getDimension()>=2&&(n=!0),e.edit(t,new os(this.targetPM,n))},changePM:function(t,e){return this.createEditor(t.getFactory(),e).edit(t,new Ot.NoOpGeometryOperation)},setRemoveCollapsedComponents:function(t){this.removeCollapsed=t},createFactory:function(t,e){return new $t(e,t.getSRID(),t.getCoordinateSequenceFactory())},setChangePrecisionModel:function(t){this.changePrecisionModel=t},reduce:function(t){var e=this.reducePointwise(t);return this.isPointwise?e:oo(e,St)?e.isValid()?e:this.fixPolygonalTopology(e):e},setPointwise:function(t){this.isPointwise=t},createEditor:function(t,e){return t.getPrecisionModel()===e?new Ot:new Ot(this.createFactory(t,e))},interfaces_:function(){return[]},getClass:function(){return as}}),as.reduce=function(t,e){return new as(e).reduce(t)},as.reducePointwise=function(t,e){var n=new as(e);return n.setPointwise(!0),n.reduce(t)};var zo=Object.freeze({GeometryPrecisionReducer:as});io(us.prototype,{simplifySection:function(t,e){if(t+1===e)return null;this.seg.p0=this.pts[t],this.seg.p1=this.pts[e];for(var n=-1,i=t,r=t+1;r<e;r++){var s=this.seg.distance(this.pts[r]);s>n&&(n=s,i=r)}if(n<=this.distanceTolerance)for(var r=t+1;r<e;r++)this.usePt[r]=!1;else this.simplifySection(t,i),this.simplifySection(i,e)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(){this.usePt=new Array(this.pts.length).fill(null);for(var t=0;t<this.pts.length;t++)this.usePt[t]=!0;this.simplifySection(0,this.pts.length-1);for(var e=new E,t=0;t<this.pts.length;t++)this.usePt[t]&&e.add(new c(this.pts[t]));return e.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return us}}),us.simplify=function(t,e){var n=new us(t);return n.setDistanceTolerance(e),n.simplify()},io(ls.prototype,{setEnsureValid:function(t){this.isEnsureValidTopology=t},getResultGeometry:function(){return this.inputGeom.isEmpty()?this.inputGeom.copy():new hs(this.isEnsureValidTopology,this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(t<0)throw new n("Tolerance must be non-negative");this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return ls}}),ls.simplify=function(t,e){var n=new ls(t);return n.setDistanceTolerance(e),n.getResultGeometry()},ro(hs,pe),io(hs.prototype,{transformPolygon:function(t,e){if(t.isEmpty())return null;var n=pe.prototype.transformPolygon.call(this,t,e);return e instanceof Tt?n:this.createValidArea(n)},createValidArea:function(t){return this.isEnsureValidTopology?t.buffer(0):t},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),i=null;return i=0===n.length?new Array(0).fill(null):us.simplify(n,this.distanceTolerance),this.factory.getCoordinateSequenceFactory().create(i)},transformMultiPolygon:function(t,e){var n=pe.prototype.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)},transformLinearRing:function(t,e){var n=e instanceof Lt,i=pe.prototype.transformLinearRing.call(this,t,e);return!n||i instanceof Rt?i:null},interfaces_:function(){return[]},getClass:function(){return hs}}),ls.DPTransformer=hs,ro(cs,ae),io(cs.prototype,{getIndex:function(){return this.index},getParent:function(){return this.parent},interfaces_:function(){return[]},getClass:function(){return cs}}),io(fs.prototype,{addToResult:function(t){this.resultSegs.add(t)},asLineString:function(){return this.parentLine.getFactory().createLineString(fs.extractCoordinates(this.resultSegs))},getResultSize:function(){var t=this.resultSegs.size();return 0===t?0:t+1},getParent:function(){return this.parentLine},getSegment:function(t){return this.segs[t]},getParentCoordinates:function(){return this.parentLine.getCoordinates()},getMinimumSize:function(){return this.minimumSize},asLinearRing:function(){return this.parentLine.getFactory().createLinearRing(fs.extractCoordinates(this.resultSegs))},getSegments:function(){return this.segs},init:function(){var t=this.parentLine.getCoordinates();this.segs=new Array(t.length-1).fill(null);for(var e=0;e<t.length-1;e++){var n=new cs(t[e],t[e+1],this.parentLine,e);this.segs[e]=n}},getResultCoordinates:function(){return fs.extractCoordinates(this.resultSegs)},interfaces_:function(){return[]},getClass:function(){return fs}}),fs.extractCoordinates=function(t){for(var e=new Array(t.size()+1).fill(null),n=null,i=0;i<t.size();i++)n=t.get(i),e[i]=n.p0;return e[e.length-1]=n.p1,e},io(gs.prototype,{remove:function(t){this.index.remove(new I(t.p0,t.p1),t)},add:function(){if(arguments[0]instanceof fs)for(var t=arguments[0],e=t.getSegments(),n=0;n<e.length;n++){var i=e[n];this.add(i)}else if(arguments[0]instanceof ae){var r=arguments[0];this.index.insert(new I(r.p0,r.p1),r)}},query:function(t){var e=new I(t.p0,t.p1),n=new ds(t);return this.index.query(e,n),n.getItems()},interfaces_:function(){return[]},getClass:function(){return gs}}),io(ds.prototype,{visitItem:function(t){var e=t;I.intersects(e.p0,e.p1,this.querySeg.p0,this.querySeg.p1)&&this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[be]},getClass:function(){return ds}}),io(ps.prototype,{flatten:function(t,e){var n=this.linePts[t],i=this.linePts[e],r=new ae(n,i);return this.remove(this.line,t,e),this.outputIndex.add(r),r},hasBadIntersection:function(t,e,n){return!!this.hasBadOutputIntersection(n)||!!this.hasBadInputIntersection(t,e,n)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplifySection:function(t,e,n){n+=1;var i=new Array(2).fill(null);if(t+1===e){var r=this.line.getSegment(t);return this.line.addToResult(r),null}var s=!0;if(this.line.getResultSize()<this.line.getMinimumSize()){n+1<this.line.getMinimumSize()&&(s=!1)}var o=new Array(1).fill(null),a=this.findFurthestPoint(this.linePts,t,e,o);o[0]>this.distanceTolerance&&(s=!1);var u=new ae;if(u.p0=this.linePts[t],u.p1=this.linePts[e],i[0]=t,i[1]=e,this.hasBadIntersection(this.line,i,u)&&(s=!1),s){var r=this.flatten(t,e);return this.line.addToResult(r),null}this.simplifySection(t,a,n),this.simplifySection(a,e,n)},hasBadOutputIntersection:function(t){for(var e=this.outputIndex.query(t),n=e.iterator();n.hasNext();){var i=n.next();if(this.hasInteriorIntersection(i,t))return!0}return!1},findFurthestPoint:function(t,e,n,i){var r=new ae;r.p0=t[e],r.p1=t[n];for(var s=-1,o=e,a=e+1;a<n;a++){var u=t[a],l=r.distance(u);l>s&&(s=l,o=a)}return i[0]=s,o},simplify:function(t){this.line=t,this.linePts=t.getParentCoordinates(),this.simplifySection(0,this.linePts.length-1,0)},remove:function(t,e,n){for(var i=e;i<n;i++){var r=t.getSegment(i);this.inputIndex.remove(r)}},hasInteriorIntersection:function(t,e){return this.li.computeIntersection(t.p0,t.p1,e.p0,e.p1),this.li.isInteriorIntersection()},hasBadInputIntersection:function(t,e,n){for(var i=this.inputIndex.query(n),r=i.iterator();r.hasNext();){var s=r.next();if(this.hasInteriorIntersection(s,n)){if(ps.isInLineSection(t,e,s))continue;return!0}}return!1},interfaces_:function(){return[]},getClass:function(){return ps}}),ps.isInLineSection=function(t,e,n){if(n.getParent()!==t.getParent())return!1;var i=n.getIndex();return i>=e[0]&&i<e[1]},io(ms.prototype,{setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(t){for(var e=t.iterator();e.hasNext();)this.inputIndex.add(e.next());for(var e=t.iterator();e.hasNext();){var n=new ps(this.inputIndex,this.outputIndex);n.setDistanceTolerance(this.distanceTolerance),n.simplify(e.next())}},interfaces_:function(){return[]},getClass:function(){return ms}}),io(vs.prototype,{getResultGeometry:function(){return this.inputGeom.isEmpty()?this.inputGeom.copy():(this.linestringMap=new Zt,this.inputGeom.apply(new xs(this)),this.lineSimplifier.simplify(this.linestringMap.values()),new ys(this.linestringMap).transform(this.inputGeom))},setDistanceTolerance:function(t){if(t<0)throw new n("Tolerance must be non-negative");this.lineSimplifier.setDistanceTolerance(t)},interfaces_:function(){return[]},getClass:function(){return vs}}),vs.simplify=function(t,e){var n=new vs(t);return n.setDistanceTolerance(e),n.getResultGeometry()},ro(ys,pe),io(ys.prototype,{transformCoordinates:function(t,e){if(0===t.size())return null;if(e instanceof It){var n=this.linestringMap.get(e);return this.createCoordinateSequence(n.getResultCoordinates())}return pe.prototype.transformCoordinates.call(this,t,e)},interfaces_:function(){return[]},getClass:function(){return ys}}),io(xs.prototype,{filter:function(t){if(t instanceof It){var e=t;if(e.isEmpty())return null;var n=e.isClosed()?4:2,i=new fs(e,n);this.tps.linestringMap.put(e,i)}},interfaces_:function(){return[A]},getClass:function(){return xs}}),vs.LineStringTransformer=ys,vs.LineStringMapBuilderFilter=xs;var ko=Object.freeze({DouglasPeuckerSimplifier:ls,TopologyPreservingSimplifier:vs});io(Es.prototype,{splitAt:function(){if(1===arguments.length){var t=arguments[0],e=this.minimumLen/this.segLen;if(t.distance(this.seg.p0)<this.minimumLen)return this.splitPt=this.seg.pointAlong(e),null;if(t.distance(this.seg.p1)<this.minimumLen)return this.splitPt=Es.pointAlongReverse(this.seg,e),null;this.splitPt=t}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=this.getConstrainedLength(n),s=r/this.segLen;i.equals2D(this.seg.p0)?this.splitPt=this.seg.pointAlong(s):this.splitPt=Es.pointAlongReverse(this.seg,s)}},setMinimumLength:function(t){this.minimumLen=t},getConstrainedLength:function(t){return t<this.minimumLen?this.minimumLen:t},getSplitPoint:function(){return this.splitPt},interfaces_:function(){return[]},getClass:function(){return Es}}),Es.pointAlongReverse=function(t,e){var n=new c;return n.x=t.p1.x-e*(t.p1.x-t.p0.x),n.y=t.p1.y-e*(t.p1.y-t.p0.y),n},io(Is.prototype,{findSplitPoint:function(t,e){},interfaces_:function(){return[]},getClass:function(){return Is}}),io(Ns.prototype,{findSplitPoint:function(t,e){var n=t.getLineSegment(),i=n.getLength(),r=i/2,s=new Es(n),o=Ns.projectedSplitPoint(t,e),a=2*o.distance(e)*.8,u=a;return u>r&&(u=r),s.setMinimumLength(u),s.splitAt(o),s.getSplitPoint()},interfaces_:function(){return[Is]},getClass:function(){return Ns}}),Ns.projectedSplitPoint=function(t,e){return t.getLineSegment().project(e)},io(Cs.prototype,{interfaces_:function(){return[]},getClass:function(){return Cs}}),Cs.triArea=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},Cs.isInCircleDDNormalized=function(t,e,n,i){var r=O.valueOf(t.x).selfSubtract(i.x),s=O.valueOf(t.y).selfSubtract(i.y),o=O.valueOf(e.x).selfSubtract(i.x),a=O.valueOf(e.y).selfSubtract(i.y),u=O.valueOf(n.x).selfSubtract(i.x),l=O.valueOf(n.y).selfSubtract(i.y),h=r.multiply(a).selfSubtract(o.multiply(s)),c=o.multiply(l).selfSubtract(u.multiply(a)),f=u.multiply(s).selfSubtract(r.multiply(l)),g=r.multiply(r).selfAdd(s.multiply(s)),d=o.multiply(o).selfAdd(a.multiply(a)),p=u.multiply(u).selfAdd(l.multiply(l));return g.selfMultiply(c).selfAdd(d.selfMultiply(f)).selfAdd(p.selfMultiply(h)).doubleValue()>0},Cs.checkRobustInCircle=function(t,e,n,i){var r=Cs.isInCircleNonRobust(t,e,n,i),s=Cs.isInCircleDDSlow(t,e,n,i),o=Cs.isInCircleCC(t,e,n,i),a=Ei.circumcentre(t,e,n);_.out.println("p radius diff a = "+Math.abs(i.distance(a)-t.distance(a))/t.distance(a)),r===s&&r===o||(_.out.println("inCircle robustness failure (double result = "+r+", DD result = "+s+", CC result = "+o+")"),_.out.println(ee.toLineString(new Dt([t,e,n,i]))),_.out.println("Circumcentre = "+ee.toPoint(a)+" radius = "+t.distance(a)),_.out.println("p radius diff a = "+Math.abs(i.distance(a)/t.distance(a)-1)),
_.out.println("p radius diff b = "+Math.abs(i.distance(a)/e.distance(a)-1)),_.out.println("p radius diff c = "+Math.abs(i.distance(a)/n.distance(a)-1)),_.out.println())},Cs.isInCircleDDFast=function(t,e,n,i){var r=O.sqr(t.x).selfAdd(O.sqr(t.y)).selfMultiply(Cs.triAreaDDFast(e,n,i)),s=O.sqr(e.x).selfAdd(O.sqr(e.y)).selfMultiply(Cs.triAreaDDFast(t,n,i)),o=O.sqr(n.x).selfAdd(O.sqr(n.y)).selfMultiply(Cs.triAreaDDFast(t,e,i)),a=O.sqr(i.x).selfAdd(O.sqr(i.y)).selfMultiply(Cs.triAreaDDFast(t,e,n));return r.selfSubtract(s).selfAdd(o).selfSubtract(a).doubleValue()>0},Cs.isInCircleCC=function(t,e,n,i){var r=Ei.circumcentre(t,e,n),s=t.distance(r);return i.distance(r)-s<=0},Cs.isInCircleNormalized=function(t,e,n,i){var r=t.x-i.x,s=t.y-i.y,o=e.x-i.x,a=e.y-i.y,u=n.x-i.x,l=n.y-i.y;return(r*r+s*s)*(o*l-u*a)+(o*o+a*a)*(u*s-r*l)+(u*u+l*l)*(r*a-o*s)>0},Cs.isInCircleDDSlow=function(t,e,n,i){var r=O.valueOf(i.x),s=O.valueOf(i.y),o=O.valueOf(t.x),a=O.valueOf(t.y),u=O.valueOf(e.x),l=O.valueOf(e.y),h=O.valueOf(n.x),c=O.valueOf(n.y),f=o.multiply(o).add(a.multiply(a)).multiply(Cs.triAreaDDSlow(u,l,h,c,r,s)),g=u.multiply(u).add(l.multiply(l)).multiply(Cs.triAreaDDSlow(o,a,h,c,r,s)),d=h.multiply(h).add(c.multiply(c)).multiply(Cs.triAreaDDSlow(o,a,u,l,r,s)),p=r.multiply(r).add(s.multiply(s)).multiply(Cs.triAreaDDSlow(o,a,u,l,h,c));return f.subtract(g).add(d).subtract(p).doubleValue()>0},Cs.isInCircleNonRobust=function(t,e,n,i){return(t.x*t.x+t.y*t.y)*Cs.triArea(e,n,i)-(e.x*e.x+e.y*e.y)*Cs.triArea(t,n,i)+(n.x*n.x+n.y*n.y)*Cs.triArea(t,e,i)-(i.x*i.x+i.y*i.y)*Cs.triArea(t,e,n)>0},Cs.isInCircleRobust=function(t,e,n,i){return Cs.isInCircleNormalized(t,e,n,i)},Cs.triAreaDDSlow=function(t,e,n,i,r,s){return n.subtract(t).multiply(s.subtract(e)).subtract(i.subtract(e).multiply(r.subtract(t)))},Cs.triAreaDDFast=function(t,e,n){var i=O.valueOf(e.x).selfSubtract(t.x).selfMultiply(O.valueOf(n.y).selfSubtract(t.y)),r=O.valueOf(e.y).selfSubtract(t.y).selfMultiply(O.valueOf(n.x).selfSubtract(t.x));return i.selfSubtract(r)},io(Ss.prototype,{circleCenter:function(t,e){var n=new Ss(this.getX(),this.getY()),i=this.bisector(n,t),r=this.bisector(t,e),s=new M(i,r),o=null;try{o=new Ss(s.getX(),s.getY())}catch(i){if(!(i instanceof C))throw i;_.err.println("a: "+n+"  b: "+t+"  c: "+e),_.err.println(i)}return o},dot:function(t){return this.p.x*t.getX()+this.p.y*t.getY()},magn:function(){return Math.sqrt(this.p.x*this.p.x+this.p.y*this.p.y)},getZ:function(){return this.p.z},bisector:function(t,e){var n=e.getX()-t.getX(),i=e.getY()-t.getY();return new M(new M(t.getX()+n/2,t.getY()+i/2,1),new M(t.getX()-i+n/2,t.getY()+n+i/2,1))},equals:function(){if(1===arguments.length){var t=arguments[0];return this.p.x===t.getX()&&this.p.y===t.getY()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.p.distance(e.getCoordinate())<n}},getCoordinate:function(){return this.p},isInCircle:function(t,e,n){return Cs.isInCircleRobust(t.p,e.p,n.p,this.p)},interpolateZValue:function(t,e,n){var i=t.getX(),r=t.getY(),s=e.getX()-i,o=n.getX()-i,a=e.getY()-r,u=n.getY()-r,l=s*u-o*a,h=this.getX()-i,c=this.getY()-r,f=(u*h-o*c)/l,g=(-a*h+s*c)/l;return t.getZ()+f*(e.getZ()-t.getZ())+g*(n.getZ()-t.getZ())},midPoint:function(t){return new Ss((this.p.x+t.getX())/2,(this.p.y+t.getY())/2,(this.p.z+t.getZ())/2)},rightOf:function(t){return this.isCCW(t.dest(),t.orig())},isCCW:function(t,e){return(t.p.x-this.p.x)*(e.p.y-this.p.y)-(t.p.y-this.p.y)*(e.p.x-this.p.x)>0},getX:function(){return this.p.x},crossProduct:function(t){return this.p.x*t.getY()-this.p.y*t.getX()},setZ:function(t){this.p.z=t},times:function(t){return new Ss(t*this.p.x,t*this.p.y)},cross:function(){return new Ss(this.p.y,-this.p.x)},leftOf:function(t){return this.isCCW(t.orig(),t.dest())},toString:function(){return"POINT ("+this.p.x+" "+this.p.y+")"},sub:function(t){return new Ss(this.p.x-t.getX(),this.p.y-t.getY())},getY:function(){return this.p.y},classify:function(t,e){var n=this,i=e.sub(t),r=n.sub(t),s=i.crossProduct(r);return s>0?Ss.LEFT:s<0?Ss.RIGHT:i.getX()*r.getX()<0||i.getY()*r.getY()<0?Ss.BEHIND:i.magn()<r.magn()?Ss.BEYOND:t.equals(n)?Ss.ORIGIN:e.equals(n)?Ss.DESTINATION:Ss.BETWEEN},sum:function(t){return new Ss(this.p.x+t.getX(),this.p.y+t.getY())},distance:function(t,e){return Math.sqrt(Math.pow(e.getX()-t.getX(),2)+Math.pow(e.getY()-t.getY(),2))},circumRadiusRatio:function(t,e){var n=this.circleCenter(t,e),i=this.distance(n,t),r=this.distance(this,t),s=this.distance(t,e);return s<r&&(r=s),s=this.distance(e,this),s<r&&(r=s),i/r},interfaces_:function(){return[]},getClass:function(){return Ss}}),Ss.interpolateZ=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=e.distance(n),r=t.distance(e),s=n.z-e.z;return e.z+s*(r/i)}if(4===arguments.length){var o=arguments[0],a=arguments[1],u=arguments[2],l=arguments[3],h=a.x,c=a.y,f=u.x-h,g=l.x-h,d=u.y-c,p=l.y-c,m=f*p-g*d,v=o.x-h,y=o.y-c,x=(p*v-g*y)/m,E=(-d*v+f*y)/m;return a.z+x*(u.z-a.z)+E*(l.z-a.z)}},Ss.LEFT=0,Ss.RIGHT=1,Ss.BEYOND=2,Ss.BEHIND=3,Ss.BETWEEN=4,Ss.ORIGIN=5,Ss.DESTINATION=6,ro(Ls,Ss),io(Ls.prototype,{getConstraint:function(){return this.constraint},setOnConstraint:function(t){this._isOnConstraint=t},merge:function(t){t._isOnConstraint&&(this._isOnConstraint=!0,this.constraint=t.constraint)},isOnConstraint:function(){return this._isOnConstraint},setConstraint:function(t){this._isOnConstraint=!0,this.constraint=t},interfaces_:function(){return[]},getClass:function(){return Ls}}),io(ws.prototype,{equalsNonOriented:function(t){return!!this.equalsOriented(t)||!!this.equalsOriented(t.sym())},toLineSegment:function(){return new ae(this.vertex.getCoordinate(),this.dest().getCoordinate())},dest:function(){return this.sym().orig()},oNext:function(){return this.next},equalsOriented:function(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))},dNext:function(){return this.sym().oNext().sym()},lPrev:function(){return this.next.sym()},rPrev:function(){return this.sym().oNext()},rot:function(){return this._rot},oPrev:function(){return this._rot.next._rot},sym:function(){return this._rot._rot},setOrig:function(t){this.vertex=t},lNext:function(){return this.invRot().oNext().rot()},getLength:function(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())},invRot:function(){return this._rot.sym()},setDest:function(t){this.sym().setOrig(t)},setData:function(t){this.data=t},getData:function(){return this.data},delete:function(){this._rot=null},orig:function(){return this.vertex},rNext:function(){return this._rot.next.invRot()},toString:function(){var t=this.vertex.getCoordinate(),e=this.dest().getCoordinate();return ee.toLineString(t,e)},isLive:function(){return null!==this._rot},getPrimary:function(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()},dPrev:function(){return this.invRot().oNext().invRot()},setNext:function(t){this.next=t},interfaces_:function(){return[]},getClass:function(){return ws}}),ws.makeEdge=function(t,e){var n=new ws,i=new ws,r=new ws,s=new ws;n._rot=i,i._rot=r,r._rot=s,s._rot=n,n.setNext(n),i.setNext(s),r.setNext(r),s.setNext(i);var o=n;return o.setOrig(t),o.setDest(e),o},ws.swap=function(t){var e=t.oPrev(),n=t.sym().oPrev();ws.splice(t,e),ws.splice(t.sym(),n),ws.splice(t,e.lNext()),ws.splice(t.sym(),n.lNext()),t.setOrig(e.dest()),t.setDest(n.dest())},ws.splice=function(t,e){var n=t.oNext().rot(),i=e.oNext().rot(),r=e.oNext(),s=t.oNext(),o=i.oNext(),a=n.oNext();t.setNext(r),e.setNext(s),n.setNext(o),i.setNext(a)},ws.connect=function(t,e){var n=ws.makeEdge(t.dest(),e.orig());return ws.splice(n,t.lNext()),ws.splice(n.sym(),e),n},io(Rs.prototype,{insertSite:function(t){var e=this.subdiv.locate(t);if(this.subdiv.isVertexOfEdge(e,t))return e;this.subdiv.isOnEdge(e,t.getCoordinate())&&(e=e.oPrev(),this.subdiv.delete(e.oNext()));var n=this.subdiv.makeEdge(e.orig(),t);ws.splice(n,e);var i=n;do{n=this.subdiv.connect(e,n.sym()),e=n.oPrev()}while(e.lNext()!==i);for(;;){var r=e.oPrev();if(r.dest().rightOf(e)&&t.isInCircle(e.orig(),r.dest(),e.dest()))ws.swap(e),e=e.oPrev();else{if(e.oNext()===i)return n;e=e.oNext().lPrev()}}},insertSites:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}},interfaces_:function(){return[]},getClass:function(){return Rs}}),io(Ts.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return Ts}}),io(Os.prototype,{init:function(){this.lastEdge=this.findEdge()},locate:function(t){this.lastEdge.isLive()||this.init();var e=this.subdiv.locateFromEdge(t,this.lastEdge);return this.lastEdge=e,e},findEdge:function(){return this.subdiv.getEdges().iterator().next()},interfaces_:function(){return[Ts]},getClass:function(){return Os}}),ro(Ps,u),io(Ps.prototype,{getSegment:function(){return this.seg},interfaces_:function(){return[]},getClass:function(){return Ps}}),Ps.msgWithSpatial=function(t,e){return null!==e?t+" [ "+e+" ]":t},io(bs.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return bs}}),io(_s.prototype,{getTriangleVertices:function(t){var e=new As;return this.visitTriangles(e,t),e.getTriangleVertices()},isFrameVertex:function(t){return!!t.equals(this.frameVertex[0])||(!!t.equals(this.frameVertex[1])||!!t.equals(this.frameVertex[2]))},isVertexOfEdge:function(t,e){return!(!e.equals(t.orig(),this.tolerance)&&!e.equals(t.dest(),this.tolerance))},connect:function(t,e){var n=ws.connect(t,e);return this.quadEdges.add(n),n},getVoronoiCellPolygon:function(t,e){var n=new x,i=t;do{var r=t.rot().orig().getCoordinate();n.add(r),t=t.oPrev()}while(t!==i);var s=new E;s.addAll(n,!1),s.closeRing(),s.size()<4&&(_.out.println(s),s.add(s.get(s.size()-1),!0));var o=s.toCoordinateArray(),a=e.createPolygon(e.createLinearRing(o),null),u=i.orig();return a.setUserData(u.getCoordinate()),a},setLocator:function(t){this.locator=t},initSubdiv:function(){var t=this.makeEdge(this.frameVertex[0],this.frameVertex[1]),e=this.makeEdge(this.frameVertex[1],this.frameVertex[2]);ws.splice(t.sym(),e);var n=this.makeEdge(this.frameVertex[2],this.frameVertex[0]);return ws.splice(e.sym(),n),ws.splice(n.sym(),t),t},isFrameBorderEdge:function(t){var e=new Array(3).fill(null);_s.getTriangleEdges(t,e);var n=new Array(3).fill(null);_s.getTriangleEdges(t.sym(),n);var i=t.lNext().dest();if(this.isFrameVertex(i))return!0;var r=t.sym().lNext().dest();return!!this.isFrameVertex(r)},makeEdge:function(t,e){var n=ws.makeEdge(t,e);return this.quadEdges.add(n),n},visitTriangles:function(t,e){this.visitedKey++;var n=new ce;n.push(this.startingEdge);for(var i=new K;!n.empty();){var r=n.pop();if(!i.contains(r)){var s=this.fetchTriangleToVisit(r,n,e,i);null!==s&&t.visit(s)}}},isFrameEdge:function(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))},isOnEdge:function(t,e){return this.seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate()),this.seg.distance(e)<this.edgeCoincidenceTolerance},getEnvelope:function(){return new I(this.frameEnv)},createFrame:function(t){var e=t.getWidth(),n=t.getHeight(),i=0;i=e>n?10*e:10*n,this.frameVertex[0]=new Ss((t.getMaxX()+t.getMinX())/2,t.getMaxY()+i),this.frameVertex[1]=new Ss(t.getMinX()-i,t.getMinY()-i),this.frameVertex[2]=new Ss(t.getMaxX()+i,t.getMinY()-i),this.frameEnv=new I(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate()),this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate())},getTriangleCoordinates:function(t){var e=new Fs;return this.visitTriangles(e,t),e.getTriangles()},getVertices:function(t){for(var e=new K,n=this.quadEdges.iterator();n.hasNext();){var i=n.next(),r=i.orig();!t&&this.isFrameVertex(r)||e.add(r);var s=i.dest();!t&&this.isFrameVertex(s)||e.add(s)}return e},fetchTriangleToVisit:function(t,e,n,i){var r=t,s=0,o=!1;do{this.triEdges[s]=r,this.isFrameEdge(r)&&(o=!0);var a=r.sym();i.contains(a)||e.push(a),i.add(r),s++,r=r.lNext()}while(r!==t);return o&&!n?null:this.triEdges},getEdges:function(){if(0===arguments.length)return this.quadEdges;if(1===arguments.length){for(var t=arguments[0],e=this.getPrimaryEdges(!1),n=new Array(e.size()).fill(null),i=0,r=e.iterator();r.hasNext();){var s=r.next();n[i++]=t.createLineString([s.orig().getCoordinate(),s.dest().getCoordinate()])}return t.createMultiLineString(n)}},getVertexUniqueEdges:function(t){for(var e=new x,n=new K,i=this.quadEdges.iterator();i.hasNext();){var r=i.next(),s=r.orig();n.contains(s)||(n.add(s),!t&&this.isFrameVertex(s)||e.add(r));var o=r.sym(),a=o.orig();n.contains(a)||(n.add(a),!t&&this.isFrameVertex(a)||e.add(o))}return e},getTriangleEdges:function(t){var e=new Ds;return this.visitTriangles(e,t),e.getTriangleEdges()},getPrimaryEdges:function(t){this.visitedKey++;var e=new x,n=new ce;n.push(this.startingEdge);for(var i=new K;!n.empty();){var r=n.pop();if(!i.contains(r)){var s=r.getPrimary();!t&&this.isFrameEdge(s)||e.add(s),n.push(r.oNext()),n.push(r.sym().oNext()),i.add(r),i.add(r.sym())}}return e},delete:function(t){ws.splice(t,t.oPrev()),ws.splice(t.sym(),t.sym().oPrev());var e=t.sym(),n=t.rot(),i=t.rot().sym();this.quadEdges.remove(t),this.quadEdges.remove(e),this.quadEdges.remove(n),this.quadEdges.remove(i),t.delete(),e.delete(),n.delete(),i.delete()},locateFromEdge:function(t,e){for(var n=0,i=this.quadEdges.size(),r=e;;){if(++n>i)throw new Ps(r.toLineSegment());if(t.equals(r.orig())||t.equals(r.dest()))break;if(t.rightOf(r))r=r.sym();else if(t.rightOf(r.oNext())){if(t.rightOf(r.dPrev()))break;r=r.dPrev()}else r=r.oNext()}return r},getTolerance:function(){return this.tolerance},getVoronoiCellPolygons:function(t){this.visitTriangles(new Ms,!0);for(var e=new x,n=this.getVertexUniqueEdges(!1),i=n.iterator();i.hasNext();){var r=i.next();e.add(this.getVoronoiCellPolygon(r,t))}return e},getVoronoiDiagram:function(t){var e=this.getVoronoiCellPolygons(t);return t.createGeometryCollection($t.toGeometryArray(e))},getTriangles:function(t){for(var e=this.getTriangleCoordinates(!1),n=new Array(e.size()).fill(null),i=0,r=e.iterator();r.hasNext();){var s=r.next();n[i++]=t.createPolygon(t.createLinearRing(s),null)}return t.createGeometryCollection(n)},insertSite:function(t){var e=this.locate(t);if(t.equals(e.orig(),this.tolerance)||t.equals(e.dest(),this.tolerance))return e;var n=this.makeEdge(e.orig(),t);ws.splice(n,e);var i=n;do{n=this.connect(e,n.sym()),e=n.oPrev()}while(e.lNext()!==i);return i},locate:function(){if(1===arguments.length){if(arguments[0]instanceof Ss){var t=arguments[0];return this.locator.locate(t)}if(arguments[0]instanceof c){var e=arguments[0];return this.locator.locate(new Ss(e))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=this.locator.locate(new Ss(n));if(null===r)return null;var s=r;r.dest().getCoordinate().equals2D(n)&&(s=r.sym());var o=s;do{if(o.dest().getCoordinate().equals2D(i))return o;o=o.oNext()}while(o!==s);return null}},interfaces_:function(){return[]},getClass:function(){return _s}}),_s.getTriangleEdges=function(t,e){if(e[0]=t,e[1]=e[0].lNext(),e[2]=e[1].lNext(),e[2].lNext()!==e[0])throw new n("Edges do not form a triangle")},io(Ms.prototype,{visit:function(t){for(var e=t[0].orig().getCoordinate(),n=t[1].orig().getCoordinate(),i=t[2].orig().getCoordinate(),r=Ei.circumcentre(e,n,i),s=new Ss(r),o=0;o<3;o++)t[o].rot().setOrig(s)},interfaces_:function(){return[bs]},getClass:function(){return Ms}}),io(Ds.prototype,{getTriangleEdges:function(){return this.triList},visit:function(t){this.triList.add(t.clone())},interfaces_:function(){return[bs]},getClass:function(){return Ds}}),io(As.prototype,{visit:function(t){this.triList.add([t[0].orig(),t[1].orig(),t[2].orig()])},getTriangleVertices:function(){return this.triList},interfaces_:function(){return[bs]},getClass:function(){return As}}),io(Fs.prototype,{checkTriangleSize:function(t){t.length>=2?ee.toLineString(t[0],t[1]):t.length>=1&&ee.toPoint(t[0])},visit:function(t){this.coordList.clear();for(var e=0;e<3;e++){var n=t[e].orig();this.coordList.add(n.getCoordinate())}if(this.coordList.size()>0){this.coordList.closeRing();var i=this.coordList.toCoordinateArray();if(4!==i.length)return null;this.triCoords.add(i)}},getTriangles:function(){return this.triCoords},interfaces_:function(){return[bs]},getClass:function(){return Fs}}),_s.TriangleCircumcentreVisitor=Ms,_s.TriangleEdgesListVisitor=Ds,_s.TriangleVertexListVisitor=As,_s.TriangleCoordinatesVisitor=Fs,_s.EDGE_COINCIDENCE_TOL_FACTOR=1e3,io(Gs.prototype,{getLineSegment:function(){return this.ls},getEndZ:function(){return this.ls.getCoordinate(1).z},getStartZ:function(){return this.ls.getCoordinate(0).z},intersection:function(t){return this.ls.intersection(t.getLineSegment())},getStart:function(){return this.ls.getCoordinate(0)},getEnd:function(){return this.ls.getCoordinate(1)},getEndY:function(){return this.ls.getCoordinate(1).y},getStartX:function(){return this.ls.getCoordinate(0).x},equalsTopo:function(t){return this.ls.equalsTopo(t.getLineSegment())},getStartY:function(){return this.ls.getCoordinate(0).y},setData:function(t){this.data=t},getData:function(){return this.data},getEndX:function(){return this.ls.getCoordinate(1).x},toString:function(){return this.ls.toString()},interfaces_:function(){return[]},getClass:function(){return Gs}}),io(qs.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return qs}}),io(Bs.prototype,{isRepeated:function(){return this.count>1},getRight:function(){return this.right},getCoordinate:function(){return this.p},setLeft:function(t){this.left=t},getX:function(){return this.p.x},getData:function(){return this.data},getCount:function(){return this.count},getLeft:function(){return this.left},getY:function(){return this.p.y},increment:function(){this.count=this.count+1},setRight:function(t){this.right=t},interfaces_:function(){return[]},getClass:function(){return Bs}}),io(Vs.prototype,{insert:function(){if(1===arguments.length){var t=arguments[0];return this.insert(t,null)}if(2===arguments.length){var e=arguments[0],n=arguments[1];if(null===this.root)return this.root=new Bs(e,n),this.root;if(this.tolerance>0){var i=this.findBestMatchNode(e);if(null!==i)return i.increment(),i}return this.insertExact(e,n)}},query:function(){if(1===arguments.length){var t=arguments[0],e=new x;return this.query(t,e),e}if(2===arguments.length)if(arguments[0]instanceof I&&oo(arguments[1],m)){var n=arguments[0],i=arguments[1];this.queryNode(this.root,n,!0,{interfaces_:function(){return[qs]},visit:function(t){i.add(t)}})}else if(arguments[0]instanceof I&&oo(arguments[1],qs)){var r=arguments[0],s=arguments[1];this.queryNode(this.root,r,!0,s)}},queryNode:function(t,e,n,i){if(null===t)return null;var r=null,s=null,o=null;n?(r=e.getMinX(),s=e.getMaxX(),o=t.getX()):(r=e.getMinY(),s=e.getMaxY(),o=t.getY());var a=r<o,u=o<=s;a&&this.queryNode(t.getLeft(),e,!n,i),e.contains(t.getCoordinate())&&i.visit(t),u&&this.queryNode(t.getRight(),e,!n,i)},findBestMatchNode:function(t){var e=new zs(t,this.tolerance);return this.query(e.queryEnvelope(),e),e.getNode()},isEmpty:function(){return null===this.root},insertExact:function(t,e){for(var n=this.root,i=this.root,r=!0,s=!0;null!==n;){if(null!==n){if(t.distance(n.getCoordinate())<=this.tolerance)return n.increment(),n}s=r?t.x<n.getX():t.y<n.getY(),i=n,n=s?n.getLeft():n.getRight(),r=!r}this.numberOfNodes=this.numberOfNodes+1;var o=new Bs(t,e);return s?i.setLeft(o):i.setRight(o),o},interfaces_:function(){return[]},getClass:function(){return Vs}}),Vs.toCoordinates=function(){if(1===arguments.length){var t=arguments[0];return Vs.toCoordinates(t,!1)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new E,r=e.iterator();r.hasNext();)for(var s=r.next(),o=n?s.getCount():1,a=0;a<o;a++)i.add(s.getCoordinate(),!0);return i.toCoordinateArray()}},io(zs.prototype,{visit:function(t){var e=this.p.distance(t.getCoordinate());if(!(e<=this.tolerance))return null;var n=!1;(null===this.matchNode||e<this.matchDist||null!==this.matchNode&&e===this.matchDist&&t.getCoordinate().compareTo(this.matchNode.getCoordinate())<1)&&(n=!0),n&&(this.matchNode=t,this.matchDist=e)},queryEnvelope:function(){var t=new I(this.p);return t.expandBy(this.tolerance),t},getNode:function(){return this.matchNode},interfaces_:function(){return[qs]},getClass:function(){return zs}}),Vs.BestMatchVisitor=zs,io(ks.prototype,{getInitialVertices:function(){return this.initialVertices},getKDT:function(){return this.kdt},enforceConstraints:function(){this.addConstraintVertices();var t=0,e=0;do{e=this.enforceGabriel(this.segments),t++}while(e>0&&t<ks.MAX_SPLIT_ITER)},insertSites:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}},getVertexFactory:function(){return this.vertexFactory},getPointArray:function(){for(var t=new Array(this.initialVertices.size()+this.segVertices.size()).fill(null),e=0,n=this.initialVertices.iterator();n.hasNext();){var i=n.next();t[e++]=i.getCoordinate()}for(var r=this.segVertices.iterator();r.hasNext();){var i=r.next();t[e++]=i.getCoordinate()}return t},setConstraints:function(t,e){this.segments=t,this.segVertices=e},computeConvexHull:function(){var t=new $t,e=this.getPointArray(),n=new ge(e,t);this.convexHull=n.getConvexHull()},addConstraintVertices:function(){this.computeConvexHull(),this.insertSites(this.segVertices)},findNonGabrielPoint:function(t){var e=t.getStart(),n=t.getEnd(),r=new c((e.x+n.x)/2,(e.y+n.y)/2),s=e.distance(r),o=new I(r);o.expandBy(s);for(var a=this.kdt.query(o),u=null,l=i.MAX_VALUE,h=a.iterator();h.hasNext();){var f=h.next(),g=f.getCoordinate();if(!g.equals2D(e)&&!g.equals2D(n)){var d=r.distance(g);if(d<s){var p=d;(null===u||p<l)&&(u=g,l=p)}}}return u},getConstraintSegments:function(){return this.segments},setSplitPointFinder:function(t){this.splitFinder=t},getConvexHull:function(){return this.convexHull},getTolerance:function(){return this.tolerance},enforceGabriel:function(t){for(var e=new x,n=0,i=new x,r=t.iterator();r.hasNext();){var s=r.next(),o=this.findNonGabrielPoint(s);if(null!==o){this.splitPt=this.splitFinder.findSplitPoint(s,o);var a=this.createVertex(this.splitPt,s),u=(this.insertSite(a),new Gs(s.getStartX(),s.getStartY(),s.getStartZ(),a.getX(),a.getY(),a.getZ(),s.getData())),l=new Gs(a.getX(),a.getY(),a.getZ(),s.getEndX(),s.getEndY(),s.getEndZ(),s.getData());e.add(u),e.add(l),i.add(s),n+=1}}return t.removeAll(i),t.addAll(e),n},createVertex:function(){if(1===arguments.length){var t=arguments[0],e=null;return e=null!==this.vertexFactory?this.vertexFactory.createVertex(t,null):new Ls(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1],e=null;return e=null!==this.vertexFactory?this.vertexFactory.createVertex(n,i):new Ls(n),e.setOnConstraint(!0),e}},getSubdivision:function(){return this.subdiv},computeBoundingBox:function(){var t=ks.computeVertexEnvelope(this.initialVertices),e=ks.computeVertexEnvelope(this.segVertices),n=new I(t);n.expandToInclude(e);var i=.2*n.getWidth(),r=.2*n.getHeight(),s=Math.max(i,r);this.computeAreaEnv=new I(n),this.computeAreaEnv.expandBy(s)},setVertexFactory:function(t){this.vertexFactory=t},formInitialDelaunay:function(){this.computeBoundingBox(),this.subdiv=new _s(this.computeAreaEnv,this.tolerance),this.subdiv.setLocator(new Os(this.subdiv)),this.incDel=new Rs(this.subdiv),this.insertSites(this.initialVertices)},insertSite:function(){if(arguments[0]instanceof Ls){var t=arguments[0],e=this.kdt.insert(t.getCoordinate(),t);if(e.isRepeated()){var n=e.getData();return n.merge(t),n}return this.incDel.insertSite(t),t}if(arguments[0]instanceof c){var i=arguments[0];this.insertSite(this.createVertex(i))}},interfaces_:function(){return[]},getClass:function(){return ks}}),ks.computeVertexEnvelope=function(t){for(var e=new I,n=t.iterator();n.hasNext();){var i=n.next();e.expandToInclude(i.getCoordinate())}return e},ks.MAX_SPLIT_ITER=99,io(Ys.prototype,{create:function(){if(null!==this.subdiv)return null;var t=Ys.envelope(this.siteCoords),e=Ys.toVertices(this.siteCoords);this.subdiv=new _s(t,this.tolerance),new Rs(this.subdiv).insertSites(e)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof F){var t=arguments[0];this.siteCoords=Ys.extractUniqueCoordinates(t)}else if(oo(arguments[0],d)){var e=arguments[0];this.siteCoords=Ys.unique(Y.toCoordinateArray(e))}},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},interfaces_:function(){return[]},getClass:function(){return Ys}}),Ys.extractUniqueCoordinates=function(t){if(null===t)return new E;var e=t.getCoordinates();return Ys.unique(e)},Ys.envelope=function(t){for(var e=new I,n=t.iterator();n.hasNext();){var i=n.next();e.expandToInclude(i)}return e},Ys.unique=function(t){var e=Y.copyDeep(t);return st.sort(e),new E(e,!1)},Ys.toVertices=function(t){for(var e=new x,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Ss(i))}return e},io(Us.prototype,{createSiteVertices:function(t){for(var e=new x,n=t.iterator();n.hasNext();){var i=n.next();this.constraintVertexMap.containsKey(i)||e.add(new Ls(i))}return e},create:function(){if(null!==this.subdiv)return null;var t=Ys.envelope(this.siteCoords),e=new x;null!==this.constraintLines&&(t.expandToInclude(this.constraintLines.getEnvelopeInternal()),this.createVertices(this.constraintLines),e=Us.createConstraintSegments(this.constraintLines));var n=this.createSiteVertices(this.siteCoords),i=new ks(n,this.tolerance);i.setConstraints(e,new x(this.constraintVertexMap.values())),i.formInitialDelaunay(),i.enforceConstraints(),this.subdiv=i.getSubdivision()},setTolerance:function(t){this.tolerance=t},setConstraints:function(t){this.constraintLines=t},setSites:function(t){this.siteCoords=Ys.extractUniqueCoordinates(t)},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},createVertices:function(t){for(var e=t.getCoordinates(),n=0;n<e.length;n++){var i=new Ls(e[n]);this.constraintVertexMap.put(e[n],i)}},interfaces_:function(){return[]},getClass:function(){return Us}}),Us.createConstraintSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=qn.getLines(t),n=new x,i=e.iterator();i.hasNext();){var r=i.next();Us.createConstraintSegments(r,n)}return n}if(2===arguments.length)for(var s=arguments[0],o=arguments[1],a=s.getCoordinates(),i=1;i<a.length;i++)o.add(new Gs(a[i-1],a[i]))},io(Xs.prototype,{create:function(){if(null!==this.subdiv)return null;var t=Ys.envelope(this.siteCoords);this.diagramEnv=t;var e=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight());this.diagramEnv.expandBy(e),null!==this.clipEnv&&this.diagramEnv.expandToInclude(this.clipEnv);var n=Ys.toVertices(this.siteCoords);this.subdiv=new _s(t,this.tolerance),new Rs(this.subdiv).insertSites(n)},getDiagram:function(t){this.create();var e=this.subdiv.getVoronoiDiagram(t);return Xs.clipGeometryCollection(e,this.diagramEnv)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof F){var t=arguments[0];this.siteCoords=Ys.extractUniqueCoordinates(t)}else if(oo(arguments[0],d)){var e=arguments[0];this.siteCoords=Ys.unique(Y.toCoordinateArray(e))}},setClipEnvelope:function(t){this.clipEnv=t},getSubdivision:function(){return this.create(),this.subdiv},interfaces_:function(){return[]},getClass:function(){return Xs}}),Xs.clipGeometryCollection=function(t,e){for(var n=t.getFactory().toGeometry(e),i=new x,r=0;r<t.getNumGeometries();r++){var s=t.getGeometryN(r),o=null;e.contains(s.getEnvelopeInternal())?o=s:e.intersects(s.getEnvelopeInternal())&&(o=n.intersection(s),o.setUserData(s.getUserData())),null===o||o.isEmpty()||i.add(o)}return t.getFactory().createGeometryCollection($t.toGeometryArray(i))};var Yo=Object.freeze({Vertex:Ss}),Uo=Object.freeze({ConformingDelaunayTriangulationBuilder:Us,DelaunayTriangulationBuilder:Ys,VoronoiDiagramBuilder:Xs,quadedge:Yo});io(Hs.prototype,{getSegmentIndex:function(){return this.segmentIndex},getComponentIndex:function(){return this.componentIndex},isEndpoint:function(t){var e=t.getGeometryN(this.componentIndex),n=e.getNumPoints()-1;return this.segmentIndex>=n||this.segmentIndex===n&&this.segmentFraction>=1},isValid:function(t){if(this.componentIndex<0||this.componentIndex>=t.getNumGeometries())return!1;var e=t.getGeometryN(this.componentIndex);return!(this.segmentIndex<0||this.segmentIndex>e.getNumPoints())&&((this.segmentIndex!==e.getNumPoints()||0===this.segmentFraction)&&!(this.segmentFraction<0||this.segmentFraction>1))},normalize:function(){this.segmentFraction<0&&(this.segmentFraction=0),this.segmentFraction>1&&(this.segmentFraction=1),this.componentIndex<0&&(this.componentIndex=0,this.segmentIndex=0,this.segmentFraction=0),this.segmentIndex<0&&(this.segmentIndex=0,this.segmentFraction=0),1===this.segmentFraction&&(this.segmentFraction=0,this.segmentIndex+=1)},toLowest:function(t){var e=t.getGeometryN(this.componentIndex),n=e.getNumPoints()-1;return this.segmentIndex<n?this:new Hs(this.componentIndex,n,1,!1)},getCoordinate:function(t){var e=t.getGeometryN(this.componentIndex),n=e.getCoordinateN(this.segmentIndex);if(this.segmentIndex>=e.getNumPoints()-1)return n;var i=e.getCoordinateN(this.segmentIndex+1);return Hs.pointAlongSegmentByFraction(n,i,this.segmentFraction)},getSegmentFraction:function(){return this.segmentFraction},getSegment:function(t){var e=t.getGeometryN(this.componentIndex),n=e.getCoordinateN(this.segmentIndex);if(this.segmentIndex>=e.getNumPoints()-1){return new ae(e.getCoordinateN(e.getNumPoints()-2),n)}return new ae(n,e.getCoordinateN(this.segmentIndex+1))},clamp:function(t){if(this.componentIndex>=t.getNumGeometries())return this.setToEnd(t),null;if(this.segmentIndex>=t.getNumPoints()){var e=t.getGeometryN(this.componentIndex);this.segmentIndex=e.getNumPoints()-1,this.segmentFraction=1}},setToEnd:function(t){this.componentIndex=t.getNumGeometries()-1;var e=t.getGeometryN(this.componentIndex);this.segmentIndex=e.getNumPoints()-1,this.segmentFraction=1},compareTo:function(t){var e=t;return this.componentIndex<e.componentIndex?-1:this.componentIndex>e.componentIndex?1:this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.segmentFraction<e.segmentFraction?-1:this.segmentFraction>e.segmentFraction?1:0},clone:function(){return new Hs(this.componentIndex,this.segmentIndex,this.segmentFraction)},toString:function(){return"LinearLoc["+this.componentIndex+", "+this.segmentIndex+", "+this.segmentFraction+"]"},isOnSameSegment:function(t){return this.componentIndex===t.componentIndex&&(this.segmentIndex===t.segmentIndex||(t.segmentIndex-this.segmentIndex==1&&0===t.segmentFraction||this.segmentIndex-t.segmentIndex==1&&0===this.segmentFraction))},snapToVertex:function(t,e){if(this.segmentFraction<=0||this.segmentFraction>=1)return null;var n=this.getSegmentLength(t),i=this.segmentFraction*n,r=n-i;i<=r&&i<e?this.segmentFraction=0:r<=i&&r<e&&(this.segmentFraction=1)},compareLocationValues:function(t,e,n){return this.componentIndex<t?-1:this.componentIndex>t?1:this.segmentIndex<e?-1:this.segmentIndex>e?1:this.segmentFraction<n?-1:this.segmentFraction>n?1:0},getSegmentLength:function(t){var e=t.getGeometryN(this.componentIndex),n=this.segmentIndex;this.segmentIndex>=e.getNumPoints()-1&&(n=e.getNumPoints()-2);var i=e.getCoordinateN(n),r=e.getCoordinateN(n+1);return i.distance(r)},isVertex:function(){return this.segmentFraction<=0||this.segmentFraction>=1},interfaces_:function(){return[r]},getClass:function(){return Hs}}),Hs.getEndLocation=function(t){var e=new Hs;return e.setToEnd(t),e},Hs.pointAlongSegmentByFraction=function(t,e,n){return n<=0?t:n>=1?e:new c((e.x-t.x)*n+t.x,(e.y-t.y)*n+t.y,(e.z-t.z)*n+t.z)},Hs.compareLocationValues=function(t,e,n,i,r,s){return t<i?-1:t>i?1:e<r?-1:e>r?1:n<s?-1:n>s?1:0},io(Ws.prototype,{getComponentIndex:function(){
return this.componentIndex},getLine:function(){return this.currentLine},getVertexIndex:function(){return this.vertexIndex},getSegmentEnd:function(){return this.vertexIndex<this.getLine().getNumPoints()-1?this.currentLine.getCoordinateN(this.vertexIndex+1):null},next:function(){if(!this.hasNext())return null;++this.vertexIndex>=this.currentLine.getNumPoints()&&(this.componentIndex++,this.loadCurrentLine(),this.vertexIndex=0)},loadCurrentLine:function(){if(this.componentIndex>=this.numLines)return this.currentLine=null,null;this.currentLine=this.linearGeom.getGeometryN(this.componentIndex)},getSegmentStart:function(){return this.currentLine.getCoordinateN(this.vertexIndex)},isEndOfLine:function(){return!(this.componentIndex>=this.numLines)&&!(this.vertexIndex<this.currentLine.getNumPoints()-1)},hasNext:function(){return!(this.componentIndex>=this.numLines)&&!(this.componentIndex===this.numLines-1&&this.vertexIndex>=this.currentLine.getNumPoints())},interfaces_:function(){return[]},getClass:function(){return Ws}}),Ws.segmentEndVertexIndex=function(t){return t.getSegmentFraction()>0?t.getSegmentIndex()+1:t.getSegmentIndex()},io(js.prototype,{indexOf:function(t){return this.indexOfFromStart(t,null)},indexOfFromStart:function(t,e){for(var n=i.MAX_VALUE,r=0,s=0,o=-1,a=new ae,u=new Ws(this.linearGeom);u.hasNext();u.next())if(!u.isEndOfLine()){a.p0=u.getSegmentStart(),a.p1=u.getSegmentEnd();var l=a.distance(t),h=a.segmentFraction(t),c=u.getComponentIndex(),f=u.getVertexIndex();l<n&&(null===e||e.compareLocationValues(c,f,h)<0)&&(r=c,s=f,o=h,n=l)}return n===i.MAX_VALUE?new Hs(e):new Hs(r,s,o)},indexOfAfter:function(t,e){if(null===e)return this.indexOf(t);var n=Hs.getEndLocation(this.linearGeom);if(n.compareTo(e)<=0)return n;var i=this.indexOfFromStart(t,e);return h.isTrue(i.compareTo(e)>=0,"computed location is before specified minimum location"),i},interfaces_:function(){return[]},getClass:function(){return js}}),js.indexOf=function(t,e){return new js(t).indexOf(e)},js.indexOfAfter=function(t,e,n){return new js(t).indexOfAfter(e,n)},io(Ks.prototype,{indicesOf:function(t){var e=t.getGeometryN(0).getCoordinateN(0),n=t.getGeometryN(t.getNumGeometries()-1),i=n.getCoordinateN(n.getNumPoints()-1),r=new js(this.linearGeom),s=new Array(2).fill(null);return s[0]=r.indexOf(e),0===t.getLength()?s[1]=s[0].clone():s[1]=r.indexOfAfter(i,s[0]),s},interfaces_:function(){return[]},getClass:function(){return Ks}}),Ks.indicesOf=function(t,e){return new Ks(t).indicesOf(e)},io(Zs.prototype,{getGeometry:function(){return this.endLine(),this.geomFact.buildGeometry(this.lines)},getLastCoordinate:function(){return this.lastPt},endLine:function(){if(null===this.coordList)return null;if(this.ignoreInvalidLines&&this.coordList.size()<2)return this.coordList=null,null;var t=this.coordList.toCoordinateArray(),e=t;this.fixInvalidLines&&(e=this.validCoordinateSequence(t)),this.coordList=null;var i=null;try{i=this.geomFact.createLineString(e)}catch(t){if(!(t instanceof n))throw t;if(!this.ignoreInvalidLines)throw t}null!==i&&this.lines.add(i)},setFixInvalidLines:function(t){this.fixInvalidLines=t},add:function(){if(1===arguments.length){var t=arguments[0];this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];null===this.coordList&&(this.coordList=new E),this.coordList.add(e,n),this.lastPt=e}},setIgnoreInvalidLines:function(t){this.ignoreInvalidLines=t},validCoordinateSequence:function(t){return t.length>=2?t:[t[0],t[0]]},interfaces_:function(){return[]},getClass:function(){return Zs}}),io(Qs.prototype,{computeLinear:function(t,e){var n=new Zs(this.line.getFactory());n.setFixInvalidLines(!0),t.isVertex()||n.add(t.getCoordinate(this.line));for(var i=new Ws(this.line,t);i.hasNext()&&!(e.compareLocationValues(i.getComponentIndex(),i.getVertexIndex(),0)<0);i.next()){var r=i.getSegmentStart();n.add(r),i.isEndOfLine()&&n.endLine()}return e.isVertex()||n.add(e.getCoordinate(this.line)),n.getGeometry()},computeLine:function(t,e){var n=this.line.getCoordinates(),i=new E,r=t.getSegmentIndex();t.getSegmentFraction()>0&&(r+=1);var s=e.getSegmentIndex();1===e.getSegmentFraction()&&(s+=1),s>=n.length&&(s=n.length-1),t.isVertex()||i.add(t.getCoordinate(this.line));for(var o=r;o<=s;o++)i.add(n[o]);e.isVertex()||i.add(e.getCoordinate(this.line)),i.size()<=0&&i.add(t.getCoordinate(this.line));var a=i.toCoordinateArray();return a.length<=1&&(a=[a[0],a[0]]),this.line.getFactory().createLineString(a)},extract:function(t,e){return e.compareTo(t)<0?this.reverse(this.computeLinear(e,t)):this.computeLinear(t,e)},reverse:function(t){return t instanceof It?t.reverse():t instanceof ht?t.reverse():(h.shouldNeverReachHere("non-linear geometry encountered"),null)},interfaces_:function(){return[]},getClass:function(){return Qs}}),Qs.extract=function(t,e,n){return new Qs(t).extract(e,n)},io(Js.prototype,{clampIndex:function(t){var e=t.clone();return e.clamp(this.linearGeom),e},project:function(t){return js.indexOf(this.linearGeom,t)},checkGeometryType:function(){if(!(this.linearGeom instanceof It||this.linearGeom instanceof ht))throw new n("Input geometry must be linear")},extractPoint:function(){if(1===arguments.length){return arguments[0].getCoordinate(this.linearGeom)}if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.toLowest(this.linearGeom);return n.getSegment(this.linearGeom).pointAlongOffset(n.getSegmentFraction(),e)}},isValidIndex:function(t){return t.isValid(this.linearGeom)},getEndIndex:function(){return Hs.getEndLocation(this.linearGeom)},getStartIndex:function(){return new Hs},indexOfAfter:function(t,e){return js.indexOfAfter(this.linearGeom,t,e)},extractLine:function(t,e){return Qs.extract(this.linearGeom,t,e)},indexOf:function(t){return js.indexOf(this.linearGeom,t)},indicesOf:function(t){return Ks.indicesOf(this.linearGeom,t)},interfaces_:function(){return[]},getClass:function(){return Js}}),io($s.prototype,{indexOf:function(t){return this.indexOfFromStart(t,-1)},indexOfFromStart:function(t,e){for(var n=i.MAX_VALUE,r=e,s=0,o=new ae,a=new Ws(this.linearGeom);a.hasNext();){if(!a.isEndOfLine()){o.p0=a.getSegmentStart(),o.p1=a.getSegmentEnd();var u=o.distance(t),l=this.segmentNearestMeasure(o,t,s);u<n&&l>e&&(r=l,n=u),s+=o.getLength()}a.next()}return r},indexOfAfter:function(t,e){if(e<0)return this.indexOf(t);var n=this.linearGeom.getLength();if(n<e)return n;var i=this.indexOfFromStart(t,e);return h.isTrue(i>=e,"computed index is before specified minimum index"),i},segmentNearestMeasure:function(t,e,n){var i=t.projectionFactor(e);return i<=0?n:i<=1?n+i*t.getLength():n+t.getLength()},interfaces_:function(){return[]},getClass:function(){return $s}}),$s.indexOf=function(t,e){return new $s(t).indexOf(e)},$s.indexOfAfter=function(t,e,n){return new $s(t).indexOfAfter(e,n)},io(to.prototype,{getLength:function(t){for(var e=0,n=new Ws(this.linearGeom);n.hasNext();){if(!n.isEndOfLine()){var i=n.getSegmentStart(),r=n.getSegmentEnd(),s=r.distance(i);if(t.getComponentIndex()===n.getComponentIndex()&&t.getSegmentIndex()===n.getVertexIndex())return e+s*t.getSegmentFraction();e+=s}n.next()}return e},resolveHigher:function(t){if(!t.isEndpoint(this.linearGeom))return t;var e=t.getComponentIndex();if(e>=this.linearGeom.getNumGeometries()-1)return t;do{e++}while(e<this.linearGeom.getNumGeometries()-1&&0===this.linearGeom.getGeometryN(e).getLength());return new Hs(e,0,0)},getLocation:function(){if(1===arguments.length){var t=arguments[0];return this.getLocation(t,!0)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=e;if(e<0){i=this.linearGeom.getLength()+e}var r=this.getLocationForward(i);return n?r:this.resolveHigher(r)}},getLocationForward:function(t){if(t<=0)return new Hs;for(var e=0,n=new Ws(this.linearGeom);n.hasNext();){if(n.isEndOfLine()){if(e===t){var i=n.getComponentIndex(),r=n.getVertexIndex();return new Hs(i,r,0)}}else{var s=n.getSegmentStart(),o=n.getSegmentEnd(),a=o.distance(s);if(e+a>t){var u=(t-e)/a,i=n.getComponentIndex(),r=n.getVertexIndex();return new Hs(i,r,u)}e+=a}n.next()}return Hs.getEndLocation(this.linearGeom)},interfaces_:function(){return[]},getClass:function(){return to}}),to.getLength=function(t,e){return new to(t).getLength(e)},to.getLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new to(t);return n.getLocation(e)}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],n=new to(i);return n.getLocation(r,s)}},io(eo.prototype,{clampIndex:function(t){var e=this.positiveIndex(t),n=this.getStartIndex();if(e<n)return n;var i=this.getEndIndex();return e>i?i:e},locationOf:function(){if(1===arguments.length){var t=arguments[0];return to.getLocation(this.linearGeom,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return to.getLocation(this.linearGeom,e,n)}},project:function(t){return $s.indexOf(this.linearGeom,t)},positiveIndex:function(t){return t>=0?t:this.linearGeom.getLength()+t},extractPoint:function(){if(1===arguments.length){var t=arguments[0],e=to.getLocation(this.linearGeom,t);return e.getCoordinate(this.linearGeom)}if(2===arguments.length){var n=arguments[0],i=arguments[1],e=to.getLocation(this.linearGeom,n),r=e.toLowest(this.linearGeom);return r.getSegment(this.linearGeom).pointAlongOffset(r.getSegmentFraction(),i)}},isValidIndex:function(t){return t>=this.getStartIndex()&&t<=this.getEndIndex()},getEndIndex:function(){return this.linearGeom.getLength()},getStartIndex:function(){return 0},indexOfAfter:function(t,e){return $s.indexOfAfter(this.linearGeom,t,e)},extractLine:function(t,e){var n=(new Js(this.linearGeom),this.clampIndex(t)),i=this.clampIndex(e),r=n===i,s=this.locationOf(n,r),o=this.locationOf(i);return Qs.extract(this.linearGeom,s,o)},indexOf:function(t){return $s.indexOf(this.linearGeom,t)},indicesOf:function(t){var e=Ks.indicesOf(this.linearGeom,t);return[to.getLength(this.linearGeom,e[0]),to.getLength(this.linearGeom,e[1])]},interfaces_:function(){return[]},getClass:function(){return eo}});var Xo=Object.freeze({LengthIndexedLine:eo,LengthLocationMap:to,LinearGeometryBuilder:Zs,LinearIterator:Ws,LinearLocation:Hs,LocationIndexedLine:Js});io(no.prototype,{interfaces_:function(){return[]},getClass:function(){return no}}),no.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return $n.createEmptyResult($n.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),ei.overlayOp(t,e,$n.UNION)},io(F.prototype,{equalsTopo:function(t){return!!this.getEnvelopeInternal().equals(t.getEnvelopeInternal())&&ts.relate(this,t).isEquals(this.getDimension(),t.getDimension())},union:function(){if(0===arguments.length)return ss.union(this);if(1===arguments.length){var t=arguments[0];return no.union(this,t)}},isValid:function(){return Vr.isValid(this)},intersection:function(t){if(this.isEmpty()||t.isEmpty())return $n.createEmptyResult($n.INTERSECTION,this,t,this.factory);if(this.isGeometryCollection()){var e=t;return on.map(this,{interfaces_:function(){return[MapOp]},map:function(t){return t.intersection(e)}})}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),ei.overlayOp(this,t,$n.INTERSECTION)},covers:function(t){return ts.covers(this,t)},coveredBy:function(t){return ts.coveredBy(this,t)},touches:function(t){return ts.touches(this,t)},intersects:function(t){return ts.intersects(this,t)},within:function(t){return ts.within(this,t)},overlaps:function(t){return ts.overlaps(this,t)},disjoint:function(t){return ts.disjoint(this,t)},crosses:function(t){return ts.crosses(this,t)},buffer:function(){if(1===arguments.length){var t=arguments[0];return hr.bufferOp(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return hr.bufferOp(this,e,n)}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];return hr.bufferOp(this,i,r,s)}},convexHull:function(){return new ge(this).getConvexHull()},relate:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return ts.relate.apply(ts,[this].concat(e))},getCentroid:function(){if(this.isEmpty())return this.factory.createPoint();var t=le.getCentroid(this);return this.createPointFromInternalCoord(t,this)},getInteriorPoint:function(){if(this.isEmpty())return this.factory.createPoint();var t=null,e=this.getDimension();if(0===e){var n=new si(this);t=n.getInteriorPoint()}else if(1===e){var n=new ri(this);t=n.getInteriorPoint()}else{var n=new ni(this);t=n.getInteriorPoint()}return this.createPointFromInternalCoord(t,this)},symDifference:function(t){if(this.isEmpty()||t.isEmpty()){if(this.isEmpty()&&t.isEmpty())return $n.createEmptyResult($n.SYMDIFFERENCE,this,t,this.factory);if(this.isEmpty())return t.copy();if(t.isEmpty())return this.copy()}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),ei.overlayOp(this,t,$n.SYMDIFFERENCE)},createPointFromInternalCoord:function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},toText:function(){return(new ee).write(this)},toString:function(){this.toText()},contains:function(t){return ts.contains(this,t)},difference:function(t){return this.isEmpty()?$n.createEmptyResult($n.DIFFERENCE,this,t,this.factory):t.isEmpty()?this.copy():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),ei.overlayOp(this,t,$n.DIFFERENCE))},isSimple:function(){return new Yi(this).isSimple()},isWithinDistance:function(t,e){return!(this.getEnvelopeInternal().distance(t.getEnvelopeInternal())>e)&&pr.isWithinDistance(this,t,e)},distance:function(t){return pr.distance(this,t)},isEquivalentClass:function(t){return this.getClass()===t.getClass()}});t.version="1.4.0 (93f117d)",t.algorithm=Eo,t.densify=Io,t.dissolve=No,t.geom=yo,t.geomgraph=Co,t.index=wo,t.io=Po,t.noding=bo,t.operation=Vo,t.precision=zo,t.simplify=ko,t.triangulate=Uo,t.linearref=Xo,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=jsts.min.js.map

//! moment.js
//! version : 2.18.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.moment=b()}(this,function(){"use strict";function a(){return sd.apply(null,arguments)}function b(a){sd=a}function c(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function d(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function e(a){var b;for(b in a)return!1;return!0}function f(a){return void 0===a}function g(a){return"number"==typeof a||"[object Number]"===Object.prototype.toString.call(a)}function h(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function i(a,b){var c,d=[];for(c=0;c<a.length;++c)d.push(b(a[c],c));return d}function j(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function k(a,b){for(var c in b)j(b,c)&&(a[c]=b[c]);return j(b,"toString")&&(a.toString=b.toString),j(b,"valueOf")&&(a.valueOf=b.valueOf),a}function l(a,b,c,d){return sb(a,b,c,d,!0).utc()}function m(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function n(a){return null==a._pf&&(a._pf=m()),a._pf}function o(a){if(null==a._isValid){var b=n(a),c=ud.call(b.parsedDateParts,function(a){return null!=a}),d=!isNaN(a._d.getTime())&&b.overflow<0&&!b.empty&&!b.invalidMonth&&!b.invalidWeekday&&!b.nullInput&&!b.invalidFormat&&!b.userInvalidated&&(!b.meridiem||b.meridiem&&c);if(a._strict&&(d=d&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour),null!=Object.isFrozen&&Object.isFrozen(a))return d;a._isValid=d}return a._isValid}function p(a){var b=l(NaN);return null!=a?k(n(b),a):n(b).userInvalidated=!0,b}function q(a,b){var c,d,e;if(f(b._isAMomentObject)||(a._isAMomentObject=b._isAMomentObject),f(b._i)||(a._i=b._i),f(b._f)||(a._f=b._f),f(b._l)||(a._l=b._l),f(b._strict)||(a._strict=b._strict),f(b._tzm)||(a._tzm=b._tzm),f(b._isUTC)||(a._isUTC=b._isUTC),f(b._offset)||(a._offset=b._offset),f(b._pf)||(a._pf=n(b)),f(b._locale)||(a._locale=b._locale),vd.length>0)for(c=0;c<vd.length;c++)d=vd[c],e=b[d],f(e)||(a[d]=e);return a}function r(b){q(this,b),this._d=new Date(null!=b._d?b._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),wd===!1&&(wd=!0,a.updateOffset(this),wd=!1)}function s(a){return a instanceof r||null!=a&&null!=a._isAMomentObject}function t(a){return a<0?Math.ceil(a)||0:Math.floor(a)}function u(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=t(b)),c}function v(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;d<e;d++)(c&&a[d]!==b[d]||!c&&u(a[d])!==u(b[d]))&&g++;return g+f}function w(b){a.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+b)}function x(b,c){var d=!0;return k(function(){if(null!=a.deprecationHandler&&a.deprecationHandler(null,b),d){for(var e,f=[],g=0;g<arguments.length;g++){if(e="","object"==typeof arguments[g]){e+="\n["+g+"] ";for(var h in arguments[0])e+=h+": "+arguments[0][h]+", ";e=e.slice(0,-2)}else e=arguments[g];f.push(e)}w(b+"\nArguments: "+Array.prototype.slice.call(f).join("")+"\n"+(new Error).stack),d=!1}return c.apply(this,arguments)},c)}function y(b,c){null!=a.deprecationHandler&&a.deprecationHandler(b,c),xd[b]||(w(c),xd[b]=!0)}function z(a){return a instanceof Function||"[object Function]"===Object.prototype.toString.call(a)}function A(a){var b,c;for(c in a)b=a[c],z(b)?this[c]=b:this["_"+c]=b;this._config=a,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function B(a,b){var c,e=k({},a);for(c in b)j(b,c)&&(d(a[c])&&d(b[c])?(e[c]={},k(e[c],a[c]),k(e[c],b[c])):null!=b[c]?e[c]=b[c]:delete e[c]);for(c in a)j(a,c)&&!j(b,c)&&d(a[c])&&(e[c]=k({},e[c]));return e}function C(a){null!=a&&this.set(a)}function D(a,b,c){var d=this._calendar[a]||this._calendar.sameElse;return z(d)?d.call(b,c):d}function E(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];return b||!c?b:(this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a])}function F(){return this._invalidDate}function G(a){return this._ordinal.replace("%d",a)}function H(a,b,c,d){var e=this._relativeTime[c];return z(e)?e(a,b,c,d):e.replace(/%d/i,a)}function I(a,b){var c=this._relativeTime[a>0?"future":"past"];return z(c)?c(b):c.replace(/%s/i,b)}function J(a,b){var c=a.toLowerCase();Hd[c]=Hd[c+"s"]=Hd[b]=a}function K(a){return"string"==typeof a?Hd[a]||Hd[a.toLowerCase()]:void 0}function L(a){var b,c,d={};for(c in a)j(a,c)&&(b=K(c),b&&(d[b]=a[c]));return d}function M(a,b){Id[a]=b}function N(a){var b=[];for(var c in a)b.push({unit:c,priority:Id[c]});return b.sort(function(a,b){return a.priority-b.priority}),b}function O(b,c){return function(d){return null!=d?(Q(this,b,d),a.updateOffset(this,c),this):P(this,b)}}function P(a,b){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+b]():NaN}function Q(a,b,c){a.isValid()&&a._d["set"+(a._isUTC?"UTC":"")+b](c)}function R(a){return a=K(a),z(this[a])?this[a]():this}function S(a,b){if("object"==typeof a){a=L(a);for(var c=N(a),d=0;d<c.length;d++)this[c[d].unit](a[c[d].unit])}else if(a=K(a),z(this[a]))return this[a](b);return this}function T(a,b,c){var d=""+Math.abs(a),e=b-d.length,f=a>=0;return(f?c?"+":"":"-")+Math.pow(10,Math.max(0,e)).toString().substr(1)+d}function U(a,b,c,d){var e=d;"string"==typeof d&&(e=function(){return this[d]()}),a&&(Md[a]=e),b&&(Md[b[0]]=function(){return T(e.apply(this,arguments),b[1],b[2])}),c&&(Md[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function V(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function W(a){var b,c,d=a.match(Jd);for(b=0,c=d.length;b<c;b++)Md[d[b]]?d[b]=Md[d[b]]:d[b]=V(d[b]);return function(b){var e,f="";for(e=0;e<c;e++)f+=z(d[e])?d[e].call(b,a):d[e];return f}}function X(a,b){return a.isValid()?(b=Y(b,a.localeData()),Ld[b]=Ld[b]||W(b),Ld[b](a)):a.localeData().invalidDate()}function Y(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Kd.lastIndex=0;d>=0&&Kd.test(a);)a=a.replace(Kd,c),Kd.lastIndex=0,d-=1;return a}function Z(a,b,c){ce[a]=z(b)?b:function(a,d){return a&&c?c:b}}function $(a,b){return j(ce,a)?ce[a](b._strict,b._locale):new RegExp(_(a))}function _(a){return aa(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}))}function aa(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ba(a,b){var c,d=b;for("string"==typeof a&&(a=[a]),g(b)&&(d=function(a,c){c[b]=u(a)}),c=0;c<a.length;c++)de[a[c]]=d}function ca(a,b){ba(a,function(a,c,d,e){d._w=d._w||{},b(a,d._w,d,e)})}function da(a,b,c){null!=b&&j(de,a)&&de[a](b,c._a,c,a)}function ea(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function fa(a,b){return a?c(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||oe).test(b)?"format":"standalone"][a.month()]:c(this._months)?this._months:this._months.standalone}function ga(a,b){return a?c(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[oe.test(b)?"format":"standalone"][a.month()]:c(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ha(a,b,c){var d,e,f,g=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],d=0;d<12;++d)f=l([2e3,d]),this._shortMonthsParse[d]=this.monthsShort(f,"").toLocaleLowerCase(),this._longMonthsParse[d]=this.months(f,"").toLocaleLowerCase();return c?"MMM"===b?(e=ne.call(this._shortMonthsParse,g),e!==-1?e:null):(e=ne.call(this._longMonthsParse,g),e!==-1?e:null):"MMM"===b?(e=ne.call(this._shortMonthsParse,g),e!==-1?e:(e=ne.call(this._longMonthsParse,g),e!==-1?e:null)):(e=ne.call(this._longMonthsParse,g),e!==-1?e:(e=ne.call(this._shortMonthsParse,g),e!==-1?e:null))}function ia(a,b,c){var d,e,f;if(this._monthsParseExact)return ha.call(this,a,b,c);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),d=0;d<12;d++){if(e=l([2e3,d]),c&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(f="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(f.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a))return d;if(c&&"MMM"===b&&this._shortMonthsParse[d].test(a))return d;if(!c&&this._monthsParse[d].test(a))return d}}function ja(a,b){var c;if(!a.isValid())return a;if("string"==typeof b)if(/^\d+$/.test(b))b=u(b);else if(b=a.localeData().monthsParse(b),!g(b))return a;return c=Math.min(a.date(),ea(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a}function ka(b){return null!=b?(ja(this,b),a.updateOffset(this,!0),this):P(this,"Month")}function la(){return ea(this.year(),this.month())}function ma(a){return this._monthsParseExact?(j(this,"_monthsRegex")||oa.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex):(j(this,"_monthsShortRegex")||(this._monthsShortRegex=re),this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex)}function na(a){return this._monthsParseExact?(j(this,"_monthsRegex")||oa.call(this),a?this._monthsStrictRegex:this._monthsRegex):(j(this,"_monthsRegex")||(this._monthsRegex=se),this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex)}function oa(){function a(a,b){return b.length-a.length}var b,c,d=[],e=[],f=[];for(b=0;b<12;b++)c=l([2e3,b]),d.push(this.monthsShort(c,"")),e.push(this.months(c,"")),f.push(this.months(c,"")),f.push(this.monthsShort(c,""));for(d.sort(a),e.sort(a),f.sort(a),b=0;b<12;b++)d[b]=aa(d[b]),e[b]=aa(e[b]);for(b=0;b<24;b++)f[b]=aa(f[b]);this._monthsRegex=new RegExp("^("+f.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+e.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+d.join("|")+")","i")}function pa(a){return qa(a)?366:365}function qa(a){return a%4===0&&a%100!==0||a%400===0}function ra(){return qa(this.year())}function sa(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return a<100&&a>=0&&isFinite(h.getFullYear())&&h.setFullYear(a),h}function ta(a){var b=new Date(Date.UTC.apply(null,arguments));return a<100&&a>=0&&isFinite(b.getUTCFullYear())&&b.setUTCFullYear(a),b}function ua(a,b,c){var d=7+b-c,e=(7+ta(a,0,d).getUTCDay()-b)%7;return-e+d-1}function va(a,b,c,d,e){var f,g,h=(7+c-d)%7,i=ua(a,d,e),j=1+7*(b-1)+h+i;return j<=0?(f=a-1,g=pa(f)+j):j>pa(a)?(f=a+1,g=j-pa(a)):(f=a,g=j),{year:f,dayOfYear:g}}function wa(a,b,c){var d,e,f=ua(a.year(),b,c),g=Math.floor((a.dayOfYear()-f-1)/7)+1;return g<1?(e=a.year()-1,d=g+xa(e,b,c)):g>xa(a.year(),b,c)?(d=g-xa(a.year(),b,c),e=a.year()+1):(e=a.year(),d=g),{week:d,year:e}}function xa(a,b,c){var d=ua(a,b,c),e=ua(a+1,b,c);return(pa(a)-d+e)/7}function ya(a){return wa(a,this._week.dow,this._week.doy).week}function za(){return this._week.dow}function Aa(){return this._week.doy}function Ba(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")}function Ca(a){var b=wa(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")}function Da(a,b){return"string"!=typeof a?a:isNaN(a)?(a=b.weekdaysParse(a),"number"==typeof a?a:null):parseInt(a,10)}function Ea(a,b){return"string"==typeof a?b.weekdaysParse(a)%7||7:isNaN(a)?null:a}function Fa(a,b){return a?c(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(b)?"format":"standalone"][a.day()]:c(this._weekdays)?this._weekdays:this._weekdays.standalone}function Ga(a){return a?this._weekdaysShort[a.day()]:this._weekdaysShort}function Ha(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin}function Ia(a,b,c){var d,e,f,g=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],d=0;d<7;++d)f=l([2e3,1]).day(d),this._minWeekdaysParse[d]=this.weekdaysMin(f,"").toLocaleLowerCase(),this._shortWeekdaysParse[d]=this.weekdaysShort(f,"").toLocaleLowerCase(),this._weekdaysParse[d]=this.weekdays(f,"").toLocaleLowerCase();return c?"dddd"===b?(e=ne.call(this._weekdaysParse,g),e!==-1?e:null):"ddd"===b?(e=ne.call(this._shortWeekdaysParse,g),e!==-1?e:null):(e=ne.call(this._minWeekdaysParse,g),e!==-1?e:null):"dddd"===b?(e=ne.call(this._weekdaysParse,g),e!==-1?e:(e=ne.call(this._shortWeekdaysParse,g),e!==-1?e:(e=ne.call(this._minWeekdaysParse,g),e!==-1?e:null))):"ddd"===b?(e=ne.call(this._shortWeekdaysParse,g),e!==-1?e:(e=ne.call(this._weekdaysParse,g),e!==-1?e:(e=ne.call(this._minWeekdaysParse,g),e!==-1?e:null))):(e=ne.call(this._minWeekdaysParse,g),e!==-1?e:(e=ne.call(this._weekdaysParse,g),e!==-1?e:(e=ne.call(this._shortWeekdaysParse,g),e!==-1?e:null)))}function Ja(a,b,c){var d,e,f;if(this._weekdaysParseExact)return Ia.call(this,a,b,c);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),d=0;d<7;d++){if(e=l([2e3,1]).day(d),c&&!this._fullWeekdaysParse[d]&&(this._fullWeekdaysParse[d]=new RegExp("^"+this.weekdays(e,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[d]=new RegExp("^"+this.weekdaysShort(e,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[d]=new RegExp("^"+this.weekdaysMin(e,"").replace(".",".?")+"$","i")),this._weekdaysParse[d]||(f="^"+this.weekdays(e,"")+"|^"+this.weekdaysShort(e,"")+"|^"+this.weekdaysMin(e,""),this._weekdaysParse[d]=new RegExp(f.replace(".",""),"i")),c&&"dddd"===b&&this._fullWeekdaysParse[d].test(a))return d;if(c&&"ddd"===b&&this._shortWeekdaysParse[d].test(a))return d;if(c&&"dd"===b&&this._minWeekdaysParse[d].test(a))return d;if(!c&&this._weekdaysParse[d].test(a))return d}}function Ka(a){if(!this.isValid())return null!=a?this:NaN;var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=Da(a,this.localeData()),this.add(a-b,"d")):b}function La(a){if(!this.isValid())return null!=a?this:NaN;var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")}function Ma(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var b=Ea(a,this.localeData());return this.day(this.day()%7?b:b-7)}return this.day()||7}function Na(a){return this._weekdaysParseExact?(j(this,"_weekdaysRegex")||Qa.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex):(j(this,"_weekdaysRegex")||(this._weekdaysRegex=ye),this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex)}function Oa(a){return this._weekdaysParseExact?(j(this,"_weekdaysRegex")||Qa.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(j(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=ze),this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Pa(a){return this._weekdaysParseExact?(j(this,"_weekdaysRegex")||Qa.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(j(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ae),this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Qa(){function a(a,b){return b.length-a.length}var b,c,d,e,f,g=[],h=[],i=[],j=[];for(b=0;b<7;b++)c=l([2e3,1]).day(b),d=this.weekdaysMin(c,""),e=this.weekdaysShort(c,""),f=this.weekdays(c,""),g.push(d),h.push(e),i.push(f),j.push(d),j.push(e),j.push(f);for(g.sort(a),h.sort(a),i.sort(a),j.sort(a),b=0;b<7;b++)h[b]=aa(h[b]),i[b]=aa(i[b]),j[b]=aa(j[b]);this._weekdaysRegex=new RegExp("^("+j.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+g.join("|")+")","i")}function Ra(){return this.hours()%12||12}function Sa(){return this.hours()||24}function Ta(a,b){U(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function Ua(a,b){return b._meridiemParse}function Va(a){return"p"===(a+"").toLowerCase().charAt(0)}function Wa(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"}function Xa(a){return a?a.toLowerCase().replace("_","-"):a}function Ya(a){for(var b,c,d,e,f=0;f<a.length;){for(e=Xa(a[f]).split("-"),b=e.length,c=Xa(a[f+1]),c=c?c.split("-"):null;b>0;){if(d=Za(e.slice(0,b).join("-")))return d;if(c&&c.length>=b&&v(e,c,!0)>=b-1)break;b--}f++}return null}function Za(a){var b=null;if(!Fe[a]&&"undefined"!=typeof module&&module&&module.exports)try{b=Be._abbr,require("./locale/"+a),$a(b)}catch(a){}return Fe[a]}function $a(a,b){var c;return a&&(c=f(b)?bb(a):_a(a,b),c&&(Be=c)),Be._abbr}function _a(a,b){if(null!==b){var c=Ee;if(b.abbr=a,null!=Fe[a])y("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),c=Fe[a]._config;else if(null!=b.parentLocale){if(null==Fe[b.parentLocale])return Ge[b.parentLocale]||(Ge[b.parentLocale]=[]),Ge[b.parentLocale].push({name:a,config:b}),null;c=Fe[b.parentLocale]._config}return Fe[a]=new C(B(c,b)),Ge[a]&&Ge[a].forEach(function(a){_a(a.name,a.config)}),$a(a),Fe[a]}return delete Fe[a],null}function ab(a,b){if(null!=b){var c,d=Ee;null!=Fe[a]&&(d=Fe[a]._config),b=B(d,b),c=new C(b),c.parentLocale=Fe[a],Fe[a]=c,$a(a)}else null!=Fe[a]&&(null!=Fe[a].parentLocale?Fe[a]=Fe[a].parentLocale:null!=Fe[a]&&delete Fe[a]);return Fe[a]}function bb(a){var b;if(a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr),!a)return Be;if(!c(a)){if(b=Za(a))return b;a=[a]}return Ya(a)}function cb(){return Ad(Fe)}function db(a){var b,c=a._a;return c&&n(a).overflow===-2&&(b=c[fe]<0||c[fe]>11?fe:c[ge]<1||c[ge]>ea(c[ee],c[fe])?ge:c[he]<0||c[he]>24||24===c[he]&&(0!==c[ie]||0!==c[je]||0!==c[ke])?he:c[ie]<0||c[ie]>59?ie:c[je]<0||c[je]>59?je:c[ke]<0||c[ke]>999?ke:-1,n(a)._overflowDayOfYear&&(b<ee||b>ge)&&(b=ge),n(a)._overflowWeeks&&b===-1&&(b=le),n(a)._overflowWeekday&&b===-1&&(b=me),n(a).overflow=b),a}function eb(a){var b,c,d,e,f,g,h=a._i,i=He.exec(h)||Ie.exec(h);if(i){for(n(a).iso=!0,b=0,c=Ke.length;b<c;b++)if(Ke[b][1].exec(i[1])){e=Ke[b][0],d=Ke[b][2]!==!1;break}if(null==e)return void(a._isValid=!1);if(i[3]){for(b=0,c=Le.length;b<c;b++)if(Le[b][1].exec(i[3])){f=(i[2]||" ")+Le[b][0];break}if(null==f)return void(a._isValid=!1)}if(!d&&null!=f)return void(a._isValid=!1);if(i[4]){if(!Je.exec(i[4]))return void(a._isValid=!1);g="Z"}a._f=e+(f||"")+(g||""),lb(a)}else a._isValid=!1}function fb(a){var b,c,d,e,f,g,h,i,j={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"},k="YXWVUTSRQPONZABCDEFGHIKLM";if(b=a._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,""),c=Ne.exec(b)){if(d=c[1]?"ddd"+(5===c[1].length?", ":" "):"",e="D MMM "+(c[2].length>10?"YYYY ":"YY "),f="HH:mm"+(c[4]?":ss":""),c[1]){var l=new Date(c[2]),m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][l.getDay()];if(c[1].substr(0,3)!==m)return n(a).weekdayMismatch=!0,void(a._isValid=!1)}switch(c[5].length){case 2:0===i?h=" +0000":(i=k.indexOf(c[5][1].toUpperCase())-12,h=(i<0?" -":" +")+(""+i).replace(/^-?/,"0").match(/..$/)[0]+"00");break;case 4:h=j[c[5]];break;default:h=j[" GMT"]}c[5]=h,a._i=c.splice(1).join(""),g=" ZZ",a._f=d+e+f+g,lb(a),n(a).rfc2822=!0}else a._isValid=!1}function gb(b){var c=Me.exec(b._i);return null!==c?void(b._d=new Date(+c[1])):(eb(b),void(b._isValid===!1&&(delete b._isValid,fb(b),b._isValid===!1&&(delete b._isValid,a.createFromInputFallback(b)))))}function hb(a,b,c){return null!=a?a:null!=b?b:c}function ib(b){var c=new Date(a.now());return b._useUTC?[c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()]:[c.getFullYear(),c.getMonth(),c.getDate()]}function jb(a){var b,c,d,e,f=[];if(!a._d){for(d=ib(a),a._w&&null==a._a[ge]&&null==a._a[fe]&&kb(a),null!=a._dayOfYear&&(e=hb(a._a[ee],d[ee]),(a._dayOfYear>pa(e)||0===a._dayOfYear)&&(n(a)._overflowDayOfYear=!0),c=ta(e,0,a._dayOfYear),a._a[fe]=c.getUTCMonth(),a._a[ge]=c.getUTCDate()),b=0;b<3&&null==a._a[b];++b)a._a[b]=f[b]=d[b];for(;b<7;b++)a._a[b]=f[b]=null==a._a[b]?2===b?1:0:a._a[b];24===a._a[he]&&0===a._a[ie]&&0===a._a[je]&&0===a._a[ke]&&(a._nextDay=!0,a._a[he]=0),a._d=(a._useUTC?ta:sa).apply(null,f),null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),a._nextDay&&(a._a[he]=24)}}function kb(a){var b,c,d,e,f,g,h,i;if(b=a._w,null!=b.GG||null!=b.W||null!=b.E)f=1,g=4,c=hb(b.GG,a._a[ee],wa(tb(),1,4).year),d=hb(b.W,1),e=hb(b.E,1),(e<1||e>7)&&(i=!0);else{f=a._locale._week.dow,g=a._locale._week.doy;var j=wa(tb(),f,g);c=hb(b.gg,a._a[ee],j.year),d=hb(b.w,j.week),null!=b.d?(e=b.d,(e<0||e>6)&&(i=!0)):null!=b.e?(e=b.e+f,(b.e<0||b.e>6)&&(i=!0)):e=f}d<1||d>xa(c,f,g)?n(a)._overflowWeeks=!0:null!=i?n(a)._overflowWeekday=!0:(h=va(c,d,e,f,g),a._a[ee]=h.year,a._dayOfYear=h.dayOfYear)}function lb(b){if(b._f===a.ISO_8601)return void eb(b);if(b._f===a.RFC_2822)return void fb(b);b._a=[],n(b).empty=!0;var c,d,e,f,g,h=""+b._i,i=h.length,j=0;for(e=Y(b._f,b._locale).match(Jd)||[],c=0;c<e.length;c++)f=e[c],d=(h.match($(f,b))||[])[0],d&&(g=h.substr(0,h.indexOf(d)),g.length>0&&n(b).unusedInput.push(g),h=h.slice(h.indexOf(d)+d.length),j+=d.length),Md[f]?(d?n(b).empty=!1:n(b).unusedTokens.push(f),da(f,d,b)):b._strict&&!d&&n(b).unusedTokens.push(f);n(b).charsLeftOver=i-j,h.length>0&&n(b).unusedInput.push(h),b._a[he]<=12&&n(b).bigHour===!0&&b._a[he]>0&&(n(b).bigHour=void 0),n(b).parsedDateParts=b._a.slice(0),n(b).meridiem=b._meridiem,b._a[he]=mb(b._locale,b._a[he],b._meridiem),jb(b),db(b)}function mb(a,b,c){var d;return null==c?b:null!=a.meridiemHour?a.meridiemHour(b,c):null!=a.isPM?(d=a.isPM(c),d&&b<12&&(b+=12),d||12!==b||(b=0),b):b}function nb(a){var b,c,d,e,f;if(0===a._f.length)return n(a).invalidFormat=!0,void(a._d=new Date(NaN));for(e=0;e<a._f.length;e++)f=0,b=q({},a),null!=a._useUTC&&(b._useUTC=a._useUTC),b._f=a._f[e],lb(b),o(b)&&(f+=n(b).charsLeftOver,f+=10*n(b).unusedTokens.length,n(b).score=f,(null==d||f<d)&&(d=f,c=b));k(a,c||b)}function ob(a){if(!a._d){var b=L(a._i);a._a=i([b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],function(a){return a&&parseInt(a,10)}),jb(a)}}function pb(a){var b=new r(db(qb(a)));return b._nextDay&&(b.add(1,"d"),b._nextDay=void 0),b}function qb(a){var b=a._i,d=a._f;return a._locale=a._locale||bb(a._l),null===b||void 0===d&&""===b?p({nullInput:!0}):("string"==typeof b&&(a._i=b=a._locale.preparse(b)),s(b)?new r(db(b)):(h(b)?a._d=b:c(d)?nb(a):d?lb(a):rb(a),o(a)||(a._d=null),a))}function rb(b){var e=b._i;f(e)?b._d=new Date(a.now()):h(e)?b._d=new Date(e.valueOf()):"string"==typeof e?gb(b):c(e)?(b._a=i(e.slice(0),function(a){return parseInt(a,10)}),jb(b)):d(e)?ob(b):g(e)?b._d=new Date(e):a.createFromInputFallback(b)}function sb(a,b,f,g,h){var i={};return f!==!0&&f!==!1||(g=f,f=void 0),(d(a)&&e(a)||c(a)&&0===a.length)&&(a=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=h,i._l=f,i._i=a,i._f=b,i._strict=g,pb(i)}function tb(a,b,c,d){return sb(a,b,c,d,!1)}function ub(a,b){var d,e;if(1===b.length&&c(b[0])&&(b=b[0]),!b.length)return tb();for(d=b[0],e=1;e<b.length;++e)b[e].isValid()&&!b[e][a](d)||(d=b[e]);return d}function vb(){var a=[].slice.call(arguments,0);return ub("isBefore",a)}function wb(){var a=[].slice.call(arguments,0);return ub("isAfter",a)}function xb(a){for(var b in a)if(Re.indexOf(b)===-1||null!=a[b]&&isNaN(a[b]))return!1;for(var c=!1,d=0;d<Re.length;++d)if(a[Re[d]]){if(c)return!1;parseFloat(a[Re[d]])!==u(a[Re[d]])&&(c=!0)}return!0}function yb(){return this._isValid}function zb(){return Sb(NaN)}function Ab(a){var b=L(a),c=b.year||0,d=b.quarter||0,e=b.month||0,f=b.week||0,g=b.day||0,h=b.hour||0,i=b.minute||0,j=b.second||0,k=b.millisecond||0;this._isValid=xb(b),this._milliseconds=+k+1e3*j+6e4*i+1e3*h*60*60,this._days=+g+7*f,this._months=+e+3*d+12*c,this._data={},this._locale=bb(),this._bubble()}function Bb(a){return a instanceof Ab}function Cb(a){return a<0?Math.round(-1*a)*-1:Math.round(a)}function Db(a,b){U(a,0,0,function(){var a=this.utcOffset(),c="+";return a<0&&(a=-a,c="-"),c+T(~~(a/60),2)+b+T(~~a%60,2)})}function Eb(a,b){var c=(b||"").match(a);if(null===c)return null;var d=c[c.length-1]||[],e=(d+"").match(Se)||["-",0,0],f=+(60*e[1])+u(e[2]);return 0===f?0:"+"===e[0]?f:-f}function Fb(b,c){var d,e;return c._isUTC?(d=c.clone(),e=(s(b)||h(b)?b.valueOf():tb(b).valueOf())-d.valueOf(),d._d.setTime(d._d.valueOf()+e),a.updateOffset(d,!1),d):tb(b).local()}function Gb(a){return 15*-Math.round(a._d.getTimezoneOffset()/15)}function Hb(b,c,d){var e,f=this._offset||0;if(!this.isValid())return null!=b?this:NaN;if(null!=b){if("string"==typeof b){if(b=Eb(_d,b),null===b)return this}else Math.abs(b)<16&&!d&&(b=60*b);return!this._isUTC&&c&&(e=Gb(this)),this._offset=b,this._isUTC=!0,null!=e&&this.add(e,"m"),f!==b&&(!c||this._changeInProgress?Xb(this,Sb(b-f,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,a.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?f:Gb(this)}function Ib(a,b){return null!=a?("string"!=typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()}function Jb(a){return this.utcOffset(0,a)}function Kb(a){return this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(Gb(this),"m")),this}function Lb(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var a=Eb($d,this._i);null!=a?this.utcOffset(a):this.utcOffset(0,!0)}return this}function Mb(a){return!!this.isValid()&&(a=a?tb(a).utcOffset():0,(this.utcOffset()-a)%60===0)}function Nb(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ob(){if(!f(this._isDSTShifted))return this._isDSTShifted;var a={};if(q(a,this),a=qb(a),a._a){var b=a._isUTC?l(a._a):tb(a._a);this._isDSTShifted=this.isValid()&&v(a._a,b.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Pb(){return!!this.isValid()&&!this._isUTC}function Qb(){return!!this.isValid()&&this._isUTC}function Rb(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Sb(a,b){var c,d,e,f=a,h=null;return Bb(a)?f={ms:a._milliseconds,d:a._days,M:a._months}:g(a)?(f={},b?f[b]=a:f.milliseconds=a):(h=Te.exec(a))?(c="-"===h[1]?-1:1,f={y:0,d:u(h[ge])*c,h:u(h[he])*c,m:u(h[ie])*c,s:u(h[je])*c,ms:u(Cb(1e3*h[ke]))*c}):(h=Ue.exec(a))?(c="-"===h[1]?-1:1,f={y:Tb(h[2],c),M:Tb(h[3],c),w:Tb(h[4],c),d:Tb(h[5],c),h:Tb(h[6],c),m:Tb(h[7],c),s:Tb(h[8],c)}):null==f?f={}:"object"==typeof f&&("from"in f||"to"in f)&&(e=Vb(tb(f.from),tb(f.to)),f={},f.ms=e.milliseconds,f.M=e.months),d=new Ab(f),Bb(a)&&j(a,"_locale")&&(d._locale=a._locale),d}function Tb(a,b){var c=a&&parseFloat(a.replace(",","."));return(isNaN(c)?0:c)*b}function Ub(a,b){var c={milliseconds:0,months:0};return c.months=b.month()-a.month()+12*(b.year()-a.year()),a.clone().add(c.months,"M").isAfter(b)&&--c.months,c.milliseconds=+b-+a.clone().add(c.months,"M"),c}function Vb(a,b){var c;return a.isValid()&&b.isValid()?(b=Fb(b,a),a.isBefore(b)?c=Ub(a,b):(c=Ub(b,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c):{milliseconds:0,months:0}}function Wb(a,b){return function(c,d){var e,f;return null===d||isNaN(+d)||(y(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),f=c,c=d,d=f),c="string"==typeof c?+c:c,e=Sb(c,d),Xb(this,e,a),this}}function Xb(b,c,d,e){var f=c._milliseconds,g=Cb(c._days),h=Cb(c._months);b.isValid()&&(e=null==e||e,f&&b._d.setTime(b._d.valueOf()+f*d),g&&Q(b,"Date",P(b,"Date")+g*d),h&&ja(b,P(b,"Month")+h*d),e&&a.updateOffset(b,g||h))}function Yb(a,b){var c=a.diff(b,"days",!0);return c<-6?"sameElse":c<-1?"lastWeek":c<0?"lastDay":c<1?"sameDay":c<2?"nextDay":c<7?"nextWeek":"sameElse"}function Zb(b,c){var d=b||tb(),e=Fb(d,this).startOf("day"),f=a.calendarFormat(this,e)||"sameElse",g=c&&(z(c[f])?c[f].call(this,d):c[f]);return this.format(g||this.localeData().calendar(f,this,tb(d)))}function $b(){return new r(this)}function _b(a,b){var c=s(a)?a:tb(a);return!(!this.isValid()||!c.isValid())&&(b=K(f(b)?"millisecond":b),"millisecond"===b?this.valueOf()>c.valueOf():c.valueOf()<this.clone().startOf(b).valueOf())}function ac(a,b){var c=s(a)?a:tb(a);return!(!this.isValid()||!c.isValid())&&(b=K(f(b)?"millisecond":b),"millisecond"===b?this.valueOf()<c.valueOf():this.clone().endOf(b).valueOf()<c.valueOf())}function bc(a,b,c,d){return d=d||"()",("("===d[0]?this.isAfter(a,c):!this.isBefore(a,c))&&(")"===d[1]?this.isBefore(b,c):!this.isAfter(b,c))}function cc(a,b){var c,d=s(a)?a:tb(a);return!(!this.isValid()||!d.isValid())&&(b=K(b||"millisecond"),"millisecond"===b?this.valueOf()===d.valueOf():(c=d.valueOf(),this.clone().startOf(b).valueOf()<=c&&c<=this.clone().endOf(b).valueOf()))}function dc(a,b){return this.isSame(a,b)||this.isAfter(a,b)}function ec(a,b){return this.isSame(a,b)||this.isBefore(a,b)}function fc(a,b,c){var d,e,f,g;return this.isValid()?(d=Fb(a,this),d.isValid()?(e=6e4*(d.utcOffset()-this.utcOffset()),b=K(b),"year"===b||"month"===b||"quarter"===b?(g=gc(this,d),"quarter"===b?g/=3:"year"===b&&(g/=12)):(f=this-d,g="second"===b?f/1e3:"minute"===b?f/6e4:"hour"===b?f/36e5:"day"===b?(f-e)/864e5:"week"===b?(f-e)/6048e5:f),c?g:t(g)):NaN):NaN}function gc(a,b){var c,d,e=12*(b.year()-a.year())+(b.month()-a.month()),f=a.clone().add(e,"months");return b-f<0?(c=a.clone().add(e-1,"months"),d=(b-f)/(f-c)):(c=a.clone().add(e+1,"months"),d=(b-f)/(c-f)),-(e+d)||0}function hc(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ic(){if(!this.isValid())return null;var a=this.clone().utc();return a.year()<0||a.year()>9999?X(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):z(Date.prototype.toISOString)?this.toDate().toISOString():X(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function jc(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",b="";this.isLocal()||(a=0===this.utcOffset()?"moment.utc":"moment.parseZone",b="Z");var c="["+a+'("]',d=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",e="-MM-DD[T]HH:mm:ss.SSS",f=b+'[")]';return this.format(c+d+e+f)}function kc(b){b||(b=this.isUtc()?a.defaultFormatUtc:a.defaultFormat);var c=X(this,b);return this.localeData().postformat(c)}function lc(a,b){return this.isValid()&&(s(a)&&a.isValid()||tb(a).isValid())?Sb({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function mc(a){return this.from(tb(),a)}function nc(a,b){return this.isValid()&&(s(a)&&a.isValid()||tb(a).isValid())?Sb({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function oc(a){return this.to(tb(),a)}function pc(a){var b;return void 0===a?this._locale._abbr:(b=bb(a),null!=b&&(this._locale=b),this)}function qc(){return this._locale}function rc(a){switch(a=K(a)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a&&this.weekday(0),"isoWeek"===a&&this.isoWeekday(1),"quarter"===a&&this.month(3*Math.floor(this.month()/3)),this}function sc(a){return a=K(a),void 0===a||"millisecond"===a?this:("date"===a&&(a="day"),this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms"))}function tc(){return this._d.valueOf()-6e4*(this._offset||0)}function uc(){return Math.floor(this.valueOf()/1e3)}function vc(){return new Date(this.valueOf())}function wc(){var a=this;return[a.year(),a.month(),a.date(),a.hour(),a.minute(),a.second(),a.millisecond()]}function xc(){var a=this;return{years:a.year(),months:a.month(),date:a.date(),hours:a.hours(),minutes:a.minutes(),seconds:a.seconds(),milliseconds:a.milliseconds()}}function yc(){return this.isValid()?this.toISOString():null}function zc(){return o(this)}function Ac(){
return k({},n(this))}function Bc(){return n(this).overflow}function Cc(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Dc(a,b){U(0,[a,a.length],0,b)}function Ec(a){return Ic.call(this,a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Fc(a){return Ic.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)}function Gc(){return xa(this.year(),1,4)}function Hc(){var a=this.localeData()._week;return xa(this.year(),a.dow,a.doy)}function Ic(a,b,c,d,e){var f;return null==a?wa(this,d,e).year:(f=xa(a,d,e),b>f&&(b=f),Jc.call(this,a,b,c,d,e))}function Jc(a,b,c,d,e){var f=va(a,b,c,d,e),g=ta(f.year,0,f.dayOfYear);return this.year(g.getUTCFullYear()),this.month(g.getUTCMonth()),this.date(g.getUTCDate()),this}function Kc(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)}function Lc(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==a?b:this.add(a-b,"d")}function Mc(a,b){b[ke]=u(1e3*("0."+a))}function Nc(){return this._isUTC?"UTC":""}function Oc(){return this._isUTC?"Coordinated Universal Time":""}function Pc(a){return tb(1e3*a)}function Qc(){return tb.apply(null,arguments).parseZone()}function Rc(a){return a}function Sc(a,b,c,d){var e=bb(),f=l().set(d,b);return e[c](f,a)}function Tc(a,b,c){if(g(a)&&(b=a,a=void 0),a=a||"",null!=b)return Sc(a,b,c,"month");var d,e=[];for(d=0;d<12;d++)e[d]=Sc(a,d,c,"month");return e}function Uc(a,b,c,d){"boolean"==typeof a?(g(b)&&(c=b,b=void 0),b=b||""):(b=a,c=b,a=!1,g(b)&&(c=b,b=void 0),b=b||"");var e=bb(),f=a?e._week.dow:0;if(null!=c)return Sc(b,(c+f)%7,d,"day");var h,i=[];for(h=0;h<7;h++)i[h]=Sc(b,(h+f)%7,d,"day");return i}function Vc(a,b){return Tc(a,b,"months")}function Wc(a,b){return Tc(a,b,"monthsShort")}function Xc(a,b,c){return Uc(a,b,c,"weekdays")}function Yc(a,b,c){return Uc(a,b,c,"weekdaysShort")}function Zc(a,b,c){return Uc(a,b,c,"weekdaysMin")}function $c(){var a=this._data;return this._milliseconds=df(this._milliseconds),this._days=df(this._days),this._months=df(this._months),a.milliseconds=df(a.milliseconds),a.seconds=df(a.seconds),a.minutes=df(a.minutes),a.hours=df(a.hours),a.months=df(a.months),a.years=df(a.years),this}function _c(a,b,c,d){var e=Sb(b,c);return a._milliseconds+=d*e._milliseconds,a._days+=d*e._days,a._months+=d*e._months,a._bubble()}function ad(a,b){return _c(this,a,b,1)}function bd(a,b){return _c(this,a,b,-1)}function cd(a){return a<0?Math.floor(a):Math.ceil(a)}function dd(){var a,b,c,d,e,f=this._milliseconds,g=this._days,h=this._months,i=this._data;return f>=0&&g>=0&&h>=0||f<=0&&g<=0&&h<=0||(f+=864e5*cd(fd(h)+g),g=0,h=0),i.milliseconds=f%1e3,a=t(f/1e3),i.seconds=a%60,b=t(a/60),i.minutes=b%60,c=t(b/60),i.hours=c%24,g+=t(c/24),e=t(ed(g)),h+=e,g-=cd(fd(e)),d=t(h/12),h%=12,i.days=g,i.months=h,i.years=d,this}function ed(a){return 4800*a/146097}function fd(a){return 146097*a/4800}function gd(a){if(!this.isValid())return NaN;var b,c,d=this._milliseconds;if(a=K(a),"month"===a||"year"===a)return b=this._days+d/864e5,c=this._months+ed(b),"month"===a?c:c/12;switch(b=this._days+Math.round(fd(this._months)),a){case"week":return b/7+d/6048e5;case"day":return b+d/864e5;case"hour":return 24*b+d/36e5;case"minute":return 1440*b+d/6e4;case"second":return 86400*b+d/1e3;case"millisecond":return Math.floor(864e5*b)+d;default:throw new Error("Unknown unit "+a)}}function hd(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*u(this._months/12):NaN}function id(a){return function(){return this.as(a)}}function jd(a){return a=K(a),this.isValid()?this[a+"s"]():NaN}function kd(a){return function(){return this.isValid()?this._data[a]:NaN}}function ld(){return t(this.days()/7)}function md(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function nd(a,b,c){var d=Sb(a).abs(),e=uf(d.as("s")),f=uf(d.as("m")),g=uf(d.as("h")),h=uf(d.as("d")),i=uf(d.as("M")),j=uf(d.as("y")),k=e<=vf.ss&&["s",e]||e<vf.s&&["ss",e]||f<=1&&["m"]||f<vf.m&&["mm",f]||g<=1&&["h"]||g<vf.h&&["hh",g]||h<=1&&["d"]||h<vf.d&&["dd",h]||i<=1&&["M"]||i<vf.M&&["MM",i]||j<=1&&["y"]||["yy",j];return k[2]=b,k[3]=+a>0,k[4]=c,md.apply(null,k)}function od(a){return void 0===a?uf:"function"==typeof a&&(uf=a,!0)}function pd(a,b){return void 0!==vf[a]&&(void 0===b?vf[a]:(vf[a]=b,"s"===a&&(vf.ss=b-1),!0))}function qd(a){if(!this.isValid())return this.localeData().invalidDate();var b=this.localeData(),c=nd(this,!a,b);return a&&(c=b.pastFuture(+this,c)),b.postformat(c)}function rd(){if(!this.isValid())return this.localeData().invalidDate();var a,b,c,d=wf(this._milliseconds)/1e3,e=wf(this._days),f=wf(this._months);a=t(d/60),b=t(a/60),d%=60,a%=60,c=t(f/12),f%=12;var g=c,h=f,i=e,j=b,k=a,l=d,m=this.asSeconds();return m?(m<0?"-":"")+"P"+(g?g+"Y":"")+(h?h+"M":"")+(i?i+"D":"")+(j||k||l?"T":"")+(j?j+"H":"")+(k?k+"M":"")+(l?l+"S":""):"P0D"}var sd,td;td=Array.prototype.some?Array.prototype.some:function(a){for(var b=Object(this),c=b.length>>>0,d=0;d<c;d++)if(d in b&&a.call(this,b[d],d,b))return!0;return!1};var ud=td,vd=a.momentProperties=[],wd=!1,xd={};a.suppressDeprecationWarnings=!1,a.deprecationHandler=null;var yd;yd=Object.keys?Object.keys:function(a){var b,c=[];for(b in a)j(a,b)&&c.push(b);return c};var zd,Ad=yd,Bd={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Cd={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Dd="Invalid date",Ed="%d",Fd=/\d{1,2}/,Gd={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Hd={},Id={},Jd=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Kd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ld={},Md={},Nd=/\d/,Od=/\d\d/,Pd=/\d{3}/,Qd=/\d{4}/,Rd=/[+-]?\d{6}/,Sd=/\d\d?/,Td=/\d\d\d\d?/,Ud=/\d\d\d\d\d\d?/,Vd=/\d{1,3}/,Wd=/\d{1,4}/,Xd=/[+-]?\d{1,6}/,Yd=/\d+/,Zd=/[+-]?\d+/,$d=/Z|[+-]\d\d:?\d\d/gi,_d=/Z|[+-]\d\d(?::?\d\d)?/gi,ae=/[+-]?\d+(\.\d{1,3})?/,be=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,ce={},de={},ee=0,fe=1,ge=2,he=3,ie=4,je=5,ke=6,le=7,me=8;zd=Array.prototype.indexOf?Array.prototype.indexOf:function(a){var b;for(b=0;b<this.length;++b)if(this[b]===a)return b;return-1};var ne=zd;U("M",["MM",2],"Mo",function(){return this.month()+1}),U("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)}),U("MMMM",0,0,function(a){return this.localeData().months(this,a)}),J("month","M"),M("month",8),Z("M",Sd),Z("MM",Sd,Od),Z("MMM",function(a,b){return b.monthsShortRegex(a)}),Z("MMMM",function(a,b){return b.monthsRegex(a)}),ba(["M","MM"],function(a,b){b[fe]=u(a)-1}),ba(["MMM","MMMM"],function(a,b,c,d){var e=c._locale.monthsParse(a,d,c._strict);null!=e?b[fe]=e:n(c).invalidMonth=a});var oe=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,pe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),qe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),re=be,se=be;U("Y",0,0,function(){var a=this.year();return a<=9999?""+a:"+"+a}),U(0,["YY",2],0,function(){return this.year()%100}),U(0,["YYYY",4],0,"year"),U(0,["YYYYY",5],0,"year"),U(0,["YYYYYY",6,!0],0,"year"),J("year","y"),M("year",1),Z("Y",Zd),Z("YY",Sd,Od),Z("YYYY",Wd,Qd),Z("YYYYY",Xd,Rd),Z("YYYYYY",Xd,Rd),ba(["YYYYY","YYYYYY"],ee),ba("YYYY",function(b,c){c[ee]=2===b.length?a.parseTwoDigitYear(b):u(b)}),ba("YY",function(b,c){c[ee]=a.parseTwoDigitYear(b)}),ba("Y",function(a,b){b[ee]=parseInt(a,10)}),a.parseTwoDigitYear=function(a){return u(a)+(u(a)>68?1900:2e3)};var te=O("FullYear",!0);U("w",["ww",2],"wo","week"),U("W",["WW",2],"Wo","isoWeek"),J("week","w"),J("isoWeek","W"),M("week",5),M("isoWeek",5),Z("w",Sd),Z("ww",Sd,Od),Z("W",Sd),Z("WW",Sd,Od),ca(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=u(a)});var ue={dow:0,doy:6};U("d",0,"do","day"),U("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)}),U("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)}),U("dddd",0,0,function(a){return this.localeData().weekdays(this,a)}),U("e",0,0,"weekday"),U("E",0,0,"isoWeekday"),J("day","d"),J("weekday","e"),J("isoWeekday","E"),M("day",11),M("weekday",11),M("isoWeekday",11),Z("d",Sd),Z("e",Sd),Z("E",Sd),Z("dd",function(a,b){return b.weekdaysMinRegex(a)}),Z("ddd",function(a,b){return b.weekdaysShortRegex(a)}),Z("dddd",function(a,b){return b.weekdaysRegex(a)}),ca(["dd","ddd","dddd"],function(a,b,c,d){var e=c._locale.weekdaysParse(a,d,c._strict);null!=e?b.d=e:n(c).invalidWeekday=a}),ca(["d","e","E"],function(a,b,c,d){b[d]=u(a)});var ve="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),we="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),xe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),ye=be,ze=be,Ae=be;U("H",["HH",2],0,"hour"),U("h",["hh",2],0,Ra),U("k",["kk",2],0,Sa),U("hmm",0,0,function(){return""+Ra.apply(this)+T(this.minutes(),2)}),U("hmmss",0,0,function(){return""+Ra.apply(this)+T(this.minutes(),2)+T(this.seconds(),2)}),U("Hmm",0,0,function(){return""+this.hours()+T(this.minutes(),2)}),U("Hmmss",0,0,function(){return""+this.hours()+T(this.minutes(),2)+T(this.seconds(),2)}),Ta("a",!0),Ta("A",!1),J("hour","h"),M("hour",13),Z("a",Ua),Z("A",Ua),Z("H",Sd),Z("h",Sd),Z("k",Sd),Z("HH",Sd,Od),Z("hh",Sd,Od),Z("kk",Sd,Od),Z("hmm",Td),Z("hmmss",Ud),Z("Hmm",Td),Z("Hmmss",Ud),ba(["H","HH"],he),ba(["k","kk"],function(a,b,c){var d=u(a);b[he]=24===d?0:d}),ba(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a),c._meridiem=a}),ba(["h","hh"],function(a,b,c){b[he]=u(a),n(c).bigHour=!0}),ba("hmm",function(a,b,c){var d=a.length-2;b[he]=u(a.substr(0,d)),b[ie]=u(a.substr(d)),n(c).bigHour=!0}),ba("hmmss",function(a,b,c){var d=a.length-4,e=a.length-2;b[he]=u(a.substr(0,d)),b[ie]=u(a.substr(d,2)),b[je]=u(a.substr(e)),n(c).bigHour=!0}),ba("Hmm",function(a,b,c){var d=a.length-2;b[he]=u(a.substr(0,d)),b[ie]=u(a.substr(d))}),ba("Hmmss",function(a,b,c){var d=a.length-4,e=a.length-2;b[he]=u(a.substr(0,d)),b[ie]=u(a.substr(d,2)),b[je]=u(a.substr(e))});var Be,Ce=/[ap]\.?m?\.?/i,De=O("Hours",!0),Ee={calendar:Bd,longDateFormat:Cd,invalidDate:Dd,ordinal:Ed,dayOfMonthOrdinalParse:Fd,relativeTime:Gd,months:pe,monthsShort:qe,week:ue,weekdays:ve,weekdaysMin:xe,weekdaysShort:we,meridiemParse:Ce},Fe={},Ge={},He=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ie=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Je=/Z|[+-]\d\d(?::?\d\d)?/,Ke=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Le=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Me=/^\/?Date\((\-?\d+)/i,Ne=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;a.createFromInputFallback=x("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))}),a.ISO_8601=function(){},a.RFC_2822=function(){};var Oe=x("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=tb.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:p()}),Pe=x("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=tb.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:a:p()}),Qe=function(){return Date.now?Date.now():+new Date},Re=["year","quarter","month","week","day","hour","minute","second","millisecond"];Db("Z",":"),Db("ZZ",""),Z("Z",_d),Z("ZZ",_d),ba(["Z","ZZ"],function(a,b,c){c._useUTC=!0,c._tzm=Eb(_d,a)});var Se=/([\+\-]|\d\d)/gi;a.updateOffset=function(){};var Te=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Ue=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;Sb.fn=Ab.prototype,Sb.invalid=zb;var Ve=Wb(1,"add"),We=Wb(-1,"subtract");a.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",a.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Xe=x("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});U(0,["gg",2],0,function(){return this.weekYear()%100}),U(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Dc("gggg","weekYear"),Dc("ggggg","weekYear"),Dc("GGGG","isoWeekYear"),Dc("GGGGG","isoWeekYear"),J("weekYear","gg"),J("isoWeekYear","GG"),M("weekYear",1),M("isoWeekYear",1),Z("G",Zd),Z("g",Zd),Z("GG",Sd,Od),Z("gg",Sd,Od),Z("GGGG",Wd,Qd),Z("gggg",Wd,Qd),Z("GGGGG",Xd,Rd),Z("ggggg",Xd,Rd),ca(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=u(a)}),ca(["gg","GG"],function(b,c,d,e){c[e]=a.parseTwoDigitYear(b)}),U("Q",0,"Qo","quarter"),J("quarter","Q"),M("quarter",7),Z("Q",Nd),ba("Q",function(a,b){b[fe]=3*(u(a)-1)}),U("D",["DD",2],"Do","date"),J("date","D"),M("date",9),Z("D",Sd),Z("DD",Sd,Od),Z("Do",function(a,b){return a?b._dayOfMonthOrdinalParse||b._ordinalParse:b._dayOfMonthOrdinalParseLenient}),ba(["D","DD"],ge),ba("Do",function(a,b){b[ge]=u(a.match(Sd)[0],10)});var Ye=O("Date",!0);U("DDD",["DDDD",3],"DDDo","dayOfYear"),J("dayOfYear","DDD"),M("dayOfYear",4),Z("DDD",Vd),Z("DDDD",Pd),ba(["DDD","DDDD"],function(a,b,c){c._dayOfYear=u(a)}),U("m",["mm",2],0,"minute"),J("minute","m"),M("minute",14),Z("m",Sd),Z("mm",Sd,Od),ba(["m","mm"],ie);var Ze=O("Minutes",!1);U("s",["ss",2],0,"second"),J("second","s"),M("second",15),Z("s",Sd),Z("ss",Sd,Od),ba(["s","ss"],je);var $e=O("Seconds",!1);U("S",0,0,function(){return~~(this.millisecond()/100)}),U(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),U(0,["SSS",3],0,"millisecond"),U(0,["SSSS",4],0,function(){return 10*this.millisecond()}),U(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),U(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),U(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),U(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),U(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),J("millisecond","ms"),M("millisecond",16),Z("S",Vd,Nd),Z("SS",Vd,Od),Z("SSS",Vd,Pd);var _e;for(_e="SSSS";_e.length<=9;_e+="S")Z(_e,Yd);for(_e="S";_e.length<=9;_e+="S")ba(_e,Mc);var af=O("Milliseconds",!1);U("z",0,0,"zoneAbbr"),U("zz",0,0,"zoneName");var bf=r.prototype;bf.add=Ve,bf.calendar=Zb,bf.clone=$b,bf.diff=fc,bf.endOf=sc,bf.format=kc,bf.from=lc,bf.fromNow=mc,bf.to=nc,bf.toNow=oc,bf.get=R,bf.invalidAt=Bc,bf.isAfter=_b,bf.isBefore=ac,bf.isBetween=bc,bf.isSame=cc,bf.isSameOrAfter=dc,bf.isSameOrBefore=ec,bf.isValid=zc,bf.lang=Xe,bf.locale=pc,bf.localeData=qc,bf.max=Pe,bf.min=Oe,bf.parsingFlags=Ac,bf.set=S,bf.startOf=rc,bf.subtract=We,bf.toArray=wc,bf.toObject=xc,bf.toDate=vc,bf.toISOString=ic,bf.inspect=jc,bf.toJSON=yc,bf.toString=hc,bf.unix=uc,bf.valueOf=tc,bf.creationData=Cc,bf.year=te,bf.isLeapYear=ra,bf.weekYear=Ec,bf.isoWeekYear=Fc,bf.quarter=bf.quarters=Kc,bf.month=ka,bf.daysInMonth=la,bf.week=bf.weeks=Ba,bf.isoWeek=bf.isoWeeks=Ca,bf.weeksInYear=Hc,bf.isoWeeksInYear=Gc,bf.date=Ye,bf.day=bf.days=Ka,bf.weekday=La,bf.isoWeekday=Ma,bf.dayOfYear=Lc,bf.hour=bf.hours=De,bf.minute=bf.minutes=Ze,bf.second=bf.seconds=$e,bf.millisecond=bf.milliseconds=af,bf.utcOffset=Hb,bf.utc=Jb,bf.local=Kb,bf.parseZone=Lb,bf.hasAlignedHourOffset=Mb,bf.isDST=Nb,bf.isLocal=Pb,bf.isUtcOffset=Qb,bf.isUtc=Rb,bf.isUTC=Rb,bf.zoneAbbr=Nc,bf.zoneName=Oc,bf.dates=x("dates accessor is deprecated. Use date instead.",Ye),bf.months=x("months accessor is deprecated. Use month instead",ka),bf.years=x("years accessor is deprecated. Use year instead",te),bf.zone=x("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Ib),bf.isDSTShifted=x("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Ob);var cf=C.prototype;cf.calendar=D,cf.longDateFormat=E,cf.invalidDate=F,cf.ordinal=G,cf.preparse=Rc,cf.postformat=Rc,cf.relativeTime=H,cf.pastFuture=I,cf.set=A,cf.months=fa,cf.monthsShort=ga,cf.monthsParse=ia,cf.monthsRegex=na,cf.monthsShortRegex=ma,cf.week=ya,cf.firstDayOfYear=Aa,cf.firstDayOfWeek=za,cf.weekdays=Fa,cf.weekdaysMin=Ha,cf.weekdaysShort=Ga,cf.weekdaysParse=Ja,cf.weekdaysRegex=Na,cf.weekdaysShortRegex=Oa,cf.weekdaysMinRegex=Pa,cf.isPM=Va,cf.meridiem=Wa,$a("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10,c=1===u(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),a.lang=x("moment.lang is deprecated. Use moment.locale instead.",$a),a.langData=x("moment.langData is deprecated. Use moment.localeData instead.",bb);var df=Math.abs,ef=id("ms"),ff=id("s"),gf=id("m"),hf=id("h"),jf=id("d"),kf=id("w"),lf=id("M"),mf=id("y"),nf=kd("milliseconds"),of=kd("seconds"),pf=kd("minutes"),qf=kd("hours"),rf=kd("days"),sf=kd("months"),tf=kd("years"),uf=Math.round,vf={ss:44,s:45,m:45,h:22,d:26,M:11},wf=Math.abs,xf=Ab.prototype;return xf.isValid=yb,xf.abs=$c,xf.add=ad,xf.subtract=bd,xf.as=gd,xf.asMilliseconds=ef,xf.asSeconds=ff,xf.asMinutes=gf,xf.asHours=hf,xf.asDays=jf,xf.asWeeks=kf,xf.asMonths=lf,xf.asYears=mf,xf.valueOf=hd,xf._bubble=dd,xf.get=jd,xf.milliseconds=nf,xf.seconds=of,xf.minutes=pf,xf.hours=qf,xf.days=rf,xf.weeks=ld,xf.months=sf,xf.years=tf,xf.humanize=qd,xf.toISOString=rd,xf.toString=rd,xf.toJSON=rd,xf.locale=pc,xf.localeData=qc,xf.toIsoString=x("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",rd),xf.lang=Xe,U("X",0,0,"unix"),U("x",0,0,"valueOf"),Z("x",Zd),Z("X",ae),ba("X",function(a,b,c){c._d=new Date(1e3*parseFloat(a,10))}),ba("x",function(a,b,c){c._d=new Date(u(a))}),a.version="2.18.1",b(tb),a.fn=bf,a.min=vb,a.max=wb,a.now=Qe,a.utc=l,a.unix=Pc,a.months=Vc,a.isDate=h,a.locale=$a,a.invalid=p,a.duration=Sb,a.isMoment=s,a.weekdays=Xc,a.parseZone=Qc,a.localeData=bb,a.isDuration=Bb,a.monthsShort=Wc,a.weekdaysMin=Zc,a.defineLocale=_a,a.updateLocale=ab,a.locales=cb,a.weekdaysShort=Yc,a.normalizeUnits=K,a.relativeTimeRounding=od,a.relativeTimeThreshold=pd,a.calendarFormat=Yb,a.prototype=bf,a});

var g=typeof global!=="undefined"?global:typeof window!=="undefined"?window:typeof self!=="undefined"?self:this;(function(e){var t=function(){try{return!!Symbol.iterator}catch(e){return false}};var n=t();var r=function(e){var t={next:function(){var t=e.shift();return{done:t===void 0,value:t}}};if(n){t[Symbol.iterator]=function(){return t}}return t};var i=function(){var t=function(e){Object.defineProperty(this,"_entries",{value:{}});if(typeof e==="string"){if(e!==""){e=e.replace(/^\?/,"");var n=e.split("&");var r;for(var i=0;i<n.length;i++){r=n[i].split("=");this.append(decodeURIComponent(r[0]),r.length>1?decodeURIComponent(r[1]):"")}}}else if(e instanceof t){var o=this;e.forEach(function(e,t){o.append(e,t)})}};var i=t.prototype;i.append=function(e,t){if(e in this._entries){this._entries[e].push(t.toString())}else{this._entries[e]=[t.toString()]}};i.delete=function(e){delete this._entries[e]};i.get=function(e){return e in this._entries?this._entries[e][0]:null};i.getAll=function(e){return e in this._entries?this._entries[e].slice(0):[]};i.has=function(e){return e in this._entries};i.set=function(e,t){this._entries[e]=[t.toString()]};i.forEach=function(e,t){var n;for(var r in this._entries){if(this._entries.hasOwnProperty(r)){n=this._entries[r];for(var i=0;i<n.length;i++){e.call(t,n[i],r,this)}}}};i.keys=function(){var e=[];this.forEach(function(t,n){e.push(n)});return r(e)};i.values=function(){var e=[];this.forEach(function(t){e.push(t)});return r(e)};i.entries=function(){var e=[];this.forEach(function(t,n){e.push([n,t])});return r(e)};if(n){i[Symbol.iterator]=i.entries}i.toString=function(){var e="";this.forEach(function(t,n){if(e.length>0)e+="&";e+=encodeURIComponent(n)+"="+encodeURIComponent(t)});return e};e.URLSearchParams=t};if(!("URLSearchParams"in e)){i()}})(g);(function(e){var t=function(){try{var e=new URL("b","http://a");e.pathname="c%20d";return e.href==="http://a/c%20d"&&e.searchParams}catch(e){return false}};var n=function(){var t=e.URL;var n=function(e,t){if(typeof e!=="string")throw new TypeError("Failed to construct 'URL': Invalid URL");var n=document.implementation.createHTMLDocument("");window.doc=n;if(t){var r=n.createElement("base");r.href=t;n.head.appendChild(r)}var i=n.createElement("a");i.href=e;n.body.appendChild(i);i.href=i.href;if(i.protocol===":"||!/:/.test(i.href)){throw new TypeError("Invalid URL")}Object.defineProperty(this,"_anchorElement",{value:i})};var r=n.prototype;var i=function(e){Object.defineProperty(r,e,{get:function(){return this._anchorElement[e]},set:function(t){this._anchorElement[e]=t},enumerable:true})};["hash","host","hostname","port","protocol","search"].forEach(function(e){i(e)});Object.defineProperties(r,{toString:{get:function(){var e=this;return function(){return e.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(e){this._anchorElement.href=e},enumerable:true},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(e){this._anchorElement.pathname=e},enumerable:true},origin:{get:function(){return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(this._anchorElement.port?":"+this._anchorElement.port:"")},enumerable:true},password:{get:function(){return""},set:function(e){},enumerable:true},username:{get:function(){return""},set:function(e){},enumerable:true},searchParams:{get:function(){var e=new URLSearchParams(this.search);var t=this;["append","delete","set"].forEach(function(n){var r=e[n];e[n]=function(){r.apply(e,arguments);t.search=e.toString()}});return e},enumerable:true}});n.createObjectURL=function(e){return t.createObjectURL.apply(t,arguments)};n.revokeObjectURL=function(e){return t.revokeObjectURL.apply(t,arguments)};e.URL=n};if(!t()){n()}if(e.location!==void 0&&!("origin"in e.location)){var r=function(){return e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")};try{Object.defineProperty(e.location,"origin",{get:r,enumerable:true})}catch(t){setInterval(function(){e.location.origin=r()},100)}}})(g);

/* Copyright jQuery Foundation and other contributors; Licensed MIT */
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory(jQuery)}})(function($){$.ui=$.ui||{};$.extend($.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});$.fn.extend({scrollParent:function(includeHidden){var position=this.css("position"),excludeStaticParent=position==="absolute",overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);if(excludeStaticParent&&parent.css("position")==="static"){return false}return overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return position==="fixed"||!scrollParent.length?$(this[0].ownerDocument||document):scrollParent},uniqueId:function(){var uuid=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+ ++uuid}})}}(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){$(this).removeAttr("id")}})}});function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();if("area"===nodeName){map=element.parentNode;mapName=map.name;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false}img=$("img[usemap='#"+mapName+"']")[0];return!!img&&visible(img)}return(/^(input|select|textarea|button|object)$/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return $.css(this,"visibility")==="hidden"}).length}$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}});if(!$("<a>").outerWidth(1).jquery){$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0;if(border){size-=parseFloat($.css(elem,"border"+this+"Width"))||0}if(margin){size-=parseFloat($.css(elem,"margin"+this))||0}});return size}$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this)}return this.each(function(){$(this).css(type,reduce(this,size)+"px")})};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size)}return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px")})}})}if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}}if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){$.fn.removeData=function(removeData){return function(key){if(arguments.length){return removeData.call(this,$.camelCase(key))}else{return removeData.call(this)}}}($.fn.removeData)}$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());$.fn.extend({focus:function(orig){return function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem)}},delay)}):orig.apply(this,arguments)}}($.fn.focus),disableSelection:function(){var eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(eventType+".ui-disableSelection",function(event){event.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex)}if(this.length){var elem=$(this[0]),position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value}}elem=elem.parent()}}return 0}});$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]])}},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(!set){return}if(!allowDisconnected&&(!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11)){return}for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args)}}}};var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=function(orig){return function(elems){var events,elem,i;for(i=0;(elem=elems[i])!=null;i++){try{events=$._data(elem,"events");if(events&&events.remove){$(elem).triggerHandler("remove")}}catch(e){}}orig(elems)}}($.cleanData);$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget}$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element)}if(arguments.length){this._createWidget(options,element)}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base;basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return}proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}}()});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)});delete existingConstructor._childConstructors}else{base._childConstructors.push(constructor)}$.widget.bridge(name,constructor);return constructor};$.widget.extend=function(target){var input=widget_slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value)}else{target[key]=value}}}}return target};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=widget_slice.call(arguments,1),returnValue=this;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(options==="instance"){returnValue=instance;return false}if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'")}if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance")}methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false}})}else{if(args.length){options=$.widget.extend.apply(null,[options].concat(args))}this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{});if(instance._init){instance._init()}}else{$.data(this,fullName,new object(options,this))}})}return returnValue}};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=widget_uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy()}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options)}if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key]}curOption[key]=value}else{if(arguments.length===1){return this.options[key]===undefined?null:this.options[key]}options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key])}return this},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!value);if(value){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}}return this},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false}if(!handlers){handlers=element;element=this.element;delegateElement=this.widget()}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element)}$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return}return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++}var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy)}else{element.bind(eventName,handlerProxy)}})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.unbind(eventName).undelegate(eventName);this.bindings=$(this.bindings.not(element).get());this.focusable=$(this.focusable.not(element).get());this.hoverable=$(this.hoverable.not(element).get())},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop]}}}this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented())}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options}}var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options}}hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay)}if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options)}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback)}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0])}next()})}}});var widget=$.widget;var mouseHandled=false;$(document).mouseup(function(){mouseHandled=false});var mouse=$.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).bind("click."+this.widgetName,function(event){if(true===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(event){if(mouseHandled){return}this._mouseMoved=false;this._mouseStarted&&this._mouseUp(event);this._mouseDownEvent=event;var that=this,btnIsLeft=event.which===1,elIsCancel=typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false;if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=this._mouseStart(event)!==false;if(!this._mouseStarted){event.preventDefault();return true}}if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(event){return that._mouseMove(event)};this._mouseUpDelegate=function(event){return that._mouseUp(event)};this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){return this._mouseUp(event)}else if(!event.which){return this._mouseUp(event)}}if(event.which||event.button){this._mouseMoved=true}if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault()}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,event)!==false;this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)}return!this._mouseStarted},_mouseUp:function(event){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target===this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(event)}mouseHandled=false;return false},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}});(function(){$.ui=$.ui||{};var cachedScrollbarWidth,supportsOffsetFractions,max=Math.max,abs=Math.abs,round=Math.round,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)]}function parseCss(element,property){return parseInt($.css(element,property),10)||0}function getDimensions(elem){var raw=elem[0];if(raw.nodeType===9){return{width:elem.width(),height:elem.height(),offset:{top:0,left:0}}}if($.isWindow(raw)){return{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}}}if(raw.preventDefault){return{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}}}return{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()}}$.position={scrollbarWidth:function(){if(cachedScrollbarWidth!==undefined){return cachedScrollbarWidth}var w1,w2,div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];$("body").append(div);w1=innerDiv.offsetWidth;div.css("overflow","scroll");w2=innerDiv.offsetWidth;if(w1===w2){w2=div[0].clientWidth}div.remove();return cachedScrollbarWidth=w1-w2},getScrollInfo:function(within){var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX=overflowX==="scroll"||overflowX==="auto"&&within.width<within.element[0].scrollWidth,hasOverflowY=overflowY==="scroll"||overflowY==="auto"&&within.height<within.element[0].scrollHeight;return{width:hasOverflowY?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0}},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]),isDocument=!!withinElement[0]&&withinElement[0].nodeType===9;return{element:withinElement,isWindow:isWindow,isDocument:isDocument,offset:withinElement.offset()||{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:isWindow||isDocument?withinElement.width():withinElement.outerWidth(),height:isWindow||isDocument?withinElement.height():withinElement.outerHeight()}}};$.fn.position=function(options){if(!options||!options.of){return _position.apply(this,arguments)}options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};dimensions=getDimensions(target);if(target[0].preventDefault){options.at="left top"}targetWidth=dimensions.width;targetHeight=dimensions.height;targetOffset=dimensions.offset;basePosition=$.extend({},targetOffset);$.each(["my","at"],function(){var pos=(options[this]||"").split(" "),horizontalOffset,verticalOffset;if(pos.length===1){pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"]}pos[0]=rhorizontal.test(pos[0])?pos[0]:"center";pos[1]=rvertical.test(pos[1])?pos[1]:"center";horizontalOffset=roffset.exec(pos[0]);verticalOffset=roffset.exec(pos[1]);offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0];options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]});if(collision.length===1){collision[1]=collision[0]}if(options.at[0]==="right"){basePosition.left+=targetWidth}else if(options.at[0]==="center"){basePosition.left+=targetWidth/2}if(options.at[1]==="bottom"){basePosition.top+=targetHeight}else if(options.at[1]==="center"){basePosition.top+=targetHeight/2}atOffset=getOffsets(offsets.at,targetWidth,targetHeight);basePosition.left+=atOffset[0];basePosition.top+=atOffset[1];return this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());if(options.my[0]==="right"){position.left-=elemWidth}else if(options.my[0]==="center"){position.left-=elemWidth/2}if(options.my[1]==="bottom"){position.top-=elemHeight}else if(options.my[1]==="center"){position.top-=elemHeight/2}position.left+=myOffset[0];position.top+=myOffset[1];if(!supportsOffsetFractions){position.left=round(position.left);position.top=round(position.top)}collisionPosition={marginLeft:marginLeft,marginTop:marginTop};$.each(["left","top"],function(i,dir){if($.ui.position[collision[i]]){$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem})}});if(options.using){using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:right<0?"left":left>0?"right":"center",vertical:bottom<0?"top":top>0?"bottom":"middle"};if(targetWidth<elemWidth&&abs(left+right)<targetWidth){feedback.horizontal="center"}if(targetHeight<elemHeight&&abs(top+bottom)<targetHeight){feedback.vertical="middle"}if(max(abs(left),abs(right))>max(abs(top),abs(bottom))){feedback.important="horizontal"}else{feedback.important="vertical"}options.using.call(this,props,feedback)}}elem.offset($.extend(position,{using:using}))})};$.ui.position={fit:{left:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset,newOverRight;if(data.collisionWidth>outerWidth){if(overLeft>0&&overRight<=0){newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset;position.left+=overLeft-newOverRight}else if(overRight>0&&overLeft<=0){position.left=withinOffset}else{if(overLeft>overRight){position.left=withinOffset+outerWidth-data.collisionWidth}else{position.left=withinOffset}}}else if(overLeft>0){position.left+=overLeft}else if(overRight>0){position.left-=overRight}else{position.left=max(position.left-collisionPosLeft,position.left)}},top:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset,newOverBottom;if(data.collisionHeight>outerHeight){if(overTop>0&&overBottom<=0){newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset;position.top+=overTop-newOverBottom}else if(overBottom>0&&overTop<=0){position.top=withinOffset}else{if(overTop>overBottom){position.top=withinOffset+outerHeight-data.collisionHeight}else{position.top=withinOffset}}}else if(overTop>0){position.top+=overTop}else if(overBottom>0){position.top-=overBottom}else{position.top=max(position.top-collisionPosTop,position.top)}}},flip:{left:function(position,data){var within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset=data.my[0]==="left"?-data.elemWidth:data.my[0]==="right"?data.elemWidth:0,atOffset=data.at[0]==="left"?data.targetWidth:data.at[0]==="right"?-data.targetWidth:0,offset=-2*data.offset[0],newOverRight,newOverLeft;if(overLeft<0){newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset;if(newOverRight<0||newOverRight<abs(overLeft)){position.left+=myOffset+atOffset+offset}}else if(overRight>0){newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft;if(newOverLeft>0||abs(newOverLeft)<overRight){position.left+=myOffset+atOffset+offset}}},top:function(position,data){var within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top=data.my[1]==="top",myOffset=top?-data.elemHeight:data.my[1]==="bottom"?data.elemHeight:0,atOffset=data.at[1]==="top"?data.targetHeight:data.at[1]==="bottom"?-data.targetHeight:0,offset=-2*data.offset[1],newOverTop,newOverBottom;if(overTop<0){newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset;if(newOverBottom<0||newOverBottom<abs(overTop)){position.top+=myOffset+atOffset+offset}}else if(overBottom>0){newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop;if(newOverTop>0||abs(newOverTop)<overBottom){position.top+=myOffset+atOffset+offset}}}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments);$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments);$.ui.position.fit.top.apply(this,arguments)}}};(function(){var testElement,testElementParent,testElementStyle,offsetLeft,i,body=document.getElementsByTagName("body")[0],div=document.createElement("div");testElement=document.createElement(body?"div":"body");testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(body){$.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"})}for(i in testElementStyle){testElement.style[i]=testElementStyle[i]}testElement.appendChild(div);testElementParent=body||document.documentElement;testElementParent.insertBefore(testElement,testElementParent.firstChild);div.style.cssText="position: absolute; left: 10.7432222px;";offsetLeft=$(div).offset().left;supportsOffsetFractions=offsetLeft>10&&offsetLeft<11;testElement.innerHTML="";testElementParent.removeChild(testElement)})()})();var position=$.ui.position;$.extend($.ui,{datepicker:{version:"1.11.4"}});var datepicker_instActive;function datepicker_getZindex(elem){var position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value}}elem=elem.parent()}return 0}function Datepicker(){this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.regional.en=$.extend(true,{},this.regional[""]);this.regional["en-US"]=$.extend(true,{},this.regional.en);this.dpDiv=datepicker_bindHover($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){datepicker_extendRemove(this._defaults,settings||{});return this},_attachDatepicker:function(target,settings){var nodeName,inline,inst;nodeName=target.nodeName.toLowerCase();inline=nodeName==="div"||nodeName==="span";if(!target.id){this.uuid+=1;target.id="dp"+this.uuid}inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{});if(nodeName==="input"){this._connectDatepicker(target,inst)}else if(inline){this._inlineDatepicker(target,inst)}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");
return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:!inline?this.dpDiv:datepicker_bindHover($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return}this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp);this._autoSize(inst);$.data(target,"datepicker",inst);if(inst.settings.disabled){this._disableDatepicker(target)}},_attachments:function(input,inst){var showOn,buttonText,buttonImage,appendText=this._get(inst,"appendText"),isRTL=this._get(inst,"isRTL");if(inst.append){inst.append.remove()}if(appendText){inst.append=$("<span class='"+this._appendClass+"'>"+appendText+"</span>");input[isRTL?"before":"after"](inst.append)}input.unbind("focus",this._showDatepicker);if(inst.trigger){inst.trigger.remove()}showOn=this._get(inst,"showOn");if(showOn==="focus"||showOn==="both"){input.focus(this._showDatepicker)}if(showOn==="button"||showOn==="both"){buttonText=this._get(inst,"buttonText");buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$("<button type='button'></button>").addClass(this._triggerClass).html(!buttonImage?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput===input[0]){$.datepicker._hideDatepicker()}else if($.datepicker._datepickerShowing&&$.datepicker._lastInput!==input[0]){$.datepicker._hideDatepicker();$.datepicker._showDatepicker(input[0])}else{$.datepicker._showDatepicker(input[0])}return false})}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var findMax,max,maxI,i,date=new Date(2009,12-1,20),dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){findMax=function(names){max=0;maxI=0;for(i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i}}return maxI};date.setMonth(findMax(this._get(inst,dateFormat.match(/MM/)?"monthNames":"monthNamesShort")));date.setDate(findMax(this._get(inst,dateFormat.match(/DD/)?"dayNames":"dayNamesShort"))+20-date.getDay())}inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return}divSpan.addClass(this.markerClassName).append(inst.dpDiv);$.data(target,"datepicker",inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target)}inst.dpDiv.css("display","block")},_dialogDatepicker:function(input,date,onSelect,settings,pos){var id,browserWidth,browserHeight,scrollX,scrollY,inst=this._dialogInst;if(!inst){this.uuid+=1;id="dp"+this.uuid;this._dialogInput=$("<input type='text' id='"+id+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],"datepicker",inst)}datepicker_extendRemove(inst.settings,settings||{});date=date&&date.constructor===Date?this._formatDate(inst,date):date;this._dialogInput.val(date);this._pos=pos?pos.length?pos:[pos.pageX,pos.pageY]:null;if(!this._pos){browserWidth=document.documentElement.clientWidth;browserHeight=document.documentElement.clientHeight;scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[browserWidth/2-100+scrollX,browserHeight/2-150+scrollY]}this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv)}$.data(this._dialogInput[0],"datepicker",inst);return this},_destroyDatepicker:function(target){var nodeName,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return}nodeName=target.nodeName.toLowerCase();$.removeData(target,"datepicker");if(nodeName==="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else if(nodeName==="div"||nodeName==="span"){$target.removeClass(this.markerClassName).empty()}if(datepicker_instActive===inst){datepicker_instActive=null}},_enableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return}nodeName=target.nodeName.toLowerCase();if(nodeName==="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else if(nodeName==="div"||nodeName==="span"){inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",false)}this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value})},_disableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");if(!$target.hasClass(this.markerClassName)){return}nodeName=target.nodeName.toLowerCase();if(nodeName==="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else if(nodeName==="div"||nodeName==="span"){inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",true)}this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value});this._disabledInputs[this._disabledInputs.length]=target},_isDisabledDatepicker:function(target){if(!target){return false}for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]===target){return true}}return false},_getInst:function(target){try{return $.data(target,"datepicker")}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var settings,date,minDate,maxDate,inst=this._getInst(target);if(arguments.length===2&&typeof name==="string"){return name==="defaults"?$.extend({},$.datepicker._defaults):inst?name==="all"?$.extend({},inst.settings):this._get(inst,name):null}settings=name||{};if(typeof name==="string"){settings={};settings[name]=value}if(inst){if(this._curInst===inst){this._hideDatepicker()}date=this._getDateDatepicker(target,true);minDate=this._getMinMaxDate(inst,"min");maxDate=this._getMinMaxDate(inst,"max");datepicker_extendRemove(inst.settings,settings);if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){inst.settings.minDate=this._formatDate(inst,minDate)}if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){inst.settings.maxDate=this._formatDate(inst,maxDate)}if("disabled"in settings){if(settings.disabled){this._disableDatepicker(target)}else{this._enableDatepicker(target)}}this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst)}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst)}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst)}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst,noDefault)}return inst?this._getDate(inst):null},_doKeyDown:function(event){var onSelect,dateStr,sel,inst=$.datepicker._getInst(event.target),handled=true,isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing){switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv);if(sel[0]){$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0])}onSelect=$.datepicker._get(inst,"onSelect");if(onSelect){dateStr=$.datepicker._formatDate(inst);onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst])}else{$.datepicker._hideDatepicker()}return false;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 35:if(event.ctrlKey||event.metaKey){$.datepicker._clearDate(event.target)}handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey){$.datepicker._gotoToday(event.target)}handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,isRTL?+1:-1,"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M")}break;case 38:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,-7,"D")}handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,isRTL?-1:+1,"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M")}break;case 40:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,+7,"D")}handled=event.ctrlKey||event.metaKey;break;default:handled=false}}else if(event.keyCode===36&&event.ctrlKey){$.datepicker._showDatepicker(this)}else{handled=false}if(handled){event.preventDefault();event.stopPropagation()}},_doKeyPress:function(event){var chars,chr,inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));chr=String.fromCharCode(event.charCode==null?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1)}},_doKeyUp:function(event){var date,inst=$.datepicker._getInst(event.target);if(inst.input.val()!==inst.lastVal){try{date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),inst.input?inst.input.val():null,$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst)}}catch(err){}}return true},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!=="input"){input=$("input",input.parentNode)[0]}if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput===input){return}var inst,beforeShow,beforeShowSettings,isFixed,offset,showAnim,duration;inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!==inst){$.datepicker._curInst.dpDiv.stop(true,true);if(inst&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0])}}beforeShow=$.datepicker._get(inst,"beforeShow");beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{};if(beforeShowSettings===false){return}datepicker_extendRemove(inst.settings,beforeShowSettings);inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value=""}if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight}isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")==="fixed";return!isFixed});offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":isFixed?"fixed":"absolute",display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){showAnim=$.datepicker._get(inst,"showAnim");duration=$.datepicker._get(inst,"duration");inst.dpDiv.css("z-index",datepicker_getZindex($(input))+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects.effect[showAnim]){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration)}else{inst.dpDiv[showAnim||"show"](showAnim?duration:null)}if($.datepicker._shouldFocusInput(inst)){inst.input.focus()}$.datepicker._curInst=inst}},_updateDatepicker:function(inst){this.maxRows=4;datepicker_instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));this._attachHandlers(inst);var origyearshtml,numMonths=this._getNumberOfMonths(inst),cols=numMonths[1],width=17,activeCell=inst.dpDiv.find("."+this._dayOverClass+" a");if(activeCell.length>0){datepicker_handleMouseover.apply(activeCell.get(0))}inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1){inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",width*cols+"em")}inst.dpDiv[(numMonths[0]!==1||numMonths[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(inst)){inst.input.focus()}if(inst.yearshtml){origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml)}origyearshtml=inst.yearshtml=null},0)}},_shouldFocusInput:function(inst){return inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&!inst.input.is(":focus")},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth(),dpHeight=inst.dpDiv.outerHeight(),inputWidth=inst.input?inst.input.outerWidth():0,inputHeight=inst.input?inst.input.outerHeight():0,viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft()),viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());offset.left-=this._get(inst,"isRTL")?dpWidth-inputWidth:0;offset.left-=isFixed&&offset.left===inst.input.offset().left?$(document).scrollLeft():0;offset.top-=isFixed&&offset.top===inst.input.offset().top+inputHeight?$(document).scrollTop():0;offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight):0);return offset},_findPos:function(obj){var position,inst=this._getInst(obj),isRTL=this._get(inst,"isRTL");while(obj&&(obj.type==="hidden"||obj.nodeType!==1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"]}position=$(obj).offset();return[position.left,position.top]},_hideDatepicker:function(input){var showAnim,duration,postProcess,onClose,inst=this._curInst;if(!inst||input&&inst!==$.data(input,"datepicker")){return}if(this._datepickerShowing){showAnim=this._get(inst,"showAnim");duration=this._get(inst,"duration");postProcess=function(){$.datepicker._tidyDialog(inst)};if($.effects&&($.effects.effect[showAnim]||$.effects[showAnim])){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[showAnim==="slideDown"?"slideUp":showAnim==="fadeIn"?"fadeOut":"hide"](showAnim?duration:null,postProcess)}if(!showAnim){postProcess()}this._datepickerShowing=false;onClose=this._get(inst,"onClose");if(onClose){onClose.apply(inst.input?inst.input[0]:null,[inst.input?inst.input.val():"",inst])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if(!$.datepicker._curInst){return}var $target=$(event.target),inst=$.datepicker._getInst($target[0]);if($target[0].id!==$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length===0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)||$target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!==inst){$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id),inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return}this._adjustInstDate(inst,offset+(period==="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst)},_gotoToday:function(id){var date,target=$(id),inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear}else{date=new Date;inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear()}this._notifyChange(inst);this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id),inst=this._getInst(target[0]);inst["selected"+(period==="M"?"Month":"Year")]=inst["draw"+(period==="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target)},_selectDay:function(id,month,year,td){var inst,target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return}inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear))},_clearDate:function(id){var target=$(id);this._selectDate(target,"")},_selectDate:function(id,dateStr){var onSelect,target=$(id),inst=this._getInst(target[0]);dateStr=dateStr!=null?dateStr:this._formatDate(inst);if(inst.input){inst.input.val(dateStr)}this._updateAlternate(inst);onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst])}else if(inst.input){inst.input.trigger("change")}if(inst.inline){this._updateDatepicker(inst)}else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof inst.input[0]!=="object"){inst.input.focus()}this._lastInput=null}},_updateAlternate:function(inst){var altFormat,date,dateStr,altField=this._get(inst,"altField");if(altField){altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");date=this._getDate(inst);dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).each(function(){$(this).val(dateStr)})}},noWeekends:function(date){var day=date.getDay();return[day>0&&day<6,""]},iso8601Week:function(date){var time,checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/864e5)/7)+1},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments"}value=typeof value==="object"?value.toString():value+"";if(value===""){return null}var iFormat,dim,extra,iValue=0,shortYearCutoffTemp=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff,shortYearCutoff=typeof shortYearCutoffTemp!=="string"?shortYearCutoffTemp:(new Date).getFullYear()%100+parseInt(shortYearCutoffTemp,10),dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,year=-1,month=-1,day=-1,doy=-1,literal=false,date,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;if(matches){iFormat++}return matches},getNumber=function(match){var isDoubled=lookAhead(match),size=match==="@"?14:match==="!"?20:match==="y"&&isDoubled?4:match==="o"?3:2,minSize=match==="y"?size:1,digits=new RegExp("^\\d{"+minSize+","+size+"}"),num=value.substring(iValue).match(digits);if(!num){throw"Missing number at position "+iValue}iValue+=num[0].length;return parseInt(num[0],10)},getName=function(match,shortNames,longNames){var index=-1,names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return-(a[1].length-b[1].length)});$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()===name.toLowerCase()){index=pair[0];iValue+=name.length;return false}});if(index!==-1){return index+1}else{throw"Unknown name at position "+iValue}},checkLiteral=function(){if(value.charAt(iValue)!==format.charAt(iFormat)){throw"Unexpected literal at position "+iValue}iValue++};for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false}else{checkLiteral()}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":date=new Date((getNumber("!")-this._ticksTo1970)/1e4);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral()}else{literal=true}break;default:checkLiteral()}}}if(iValue<value.length){extra=value.substr(iValue);if(!/^\s+/.test(extra)){throw"Extra/unparsed characters found in date: "+extra}}if(year===-1){year=(new Date).getFullYear()}else if(year<100){year+=(new Date).getFullYear()-(new Date).getFullYear()%100+(year<=shortYearCutoff?0:-100)}if(doy>-1){month=1;day=doy;do{dim=this._getDaysInMonth(year,month-1);if(day<=dim){break}month++;day-=dim}while(true)}date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!==year||date.getMonth()+1!==month||date.getDate()!==day){throw"Invalid date"}return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*1e7,formatDate:function(format,date,settings){if(!date){return""}var iFormat,dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;if(matches){iFormat++}return matches},formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num}}return num},formatName=function(match,value,shortNames,longNames){return lookAhead(match)?longNames[value]:shortNames[value]},output="",literal=false;if(date){for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false}else{output+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/864e5),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100;break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*1e4+this._ticksTo1970;break;case"'":if(lookAhead("'")){output+="'"}else{literal=true}break;default:output+=format.charAt(iFormat)}}}}return output},_possibleChars:function(format){var iFormat,chars="",literal=false,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;if(matches){iFormat++}return matches};for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false}else{chars+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'"}else{literal=true}break;default:chars+=format.charAt(iFormat)}}}return chars},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()===inst.lastVal){return}var dateFormat=this._get(inst,"dateFormat"),dates=inst.lastVal=inst.input?inst.input.val():null,defaultDate=this._getDefaultDate(inst),date=defaultDate,settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){dates=noDefault?"":dates}inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=dates?date.getDate():0;inst.currentMonth=dates?date.getMonth():0;inst.currentYear=dates?date.getFullYear():0;this._adjustInstDate(inst)},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date;date.setDate(date.getDate()+offset);return date},offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date,year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),pattern=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break}matches=pattern.exec(offset)}return new Date(year,month,day)},newDate=date==null||date===""?defaultDate:typeof date==="string"?offsetString(date):typeof date==="number"?isNaN(date)?defaultDate:offsetNumeric(date):new Date(date.getTime());newDate=newDate&&newDate.toString()==="Invalid Date"?defaultDate:newDate;if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0)}return this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){if(!date){return null}date.setHours(date.getHours()>12?date.getHours()+2:0);return date},_setDate:function(inst,date,noChange){var clear=!date,origMonth=inst.selectedMonth,origYear=inst.selectedYear,newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!==inst.selectedMonth||origYear!==inst.selectedYear)&&!noChange){this._notifyChange(inst)}this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst))}},_getDate:function(inst){var startDate=!inst.currentYear||inst.input&&inst.input.val()===""?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return startDate},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths"),id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){$.datepicker._adjustDate(id,-stepMonths,"M")},next:function(){$.datepicker._adjustDate(id,+stepMonths,"M")},hide:function(){$.datepicker._hideDatepicker()},today:function(){$.datepicker._gotoToday(id)},selectDay:function(){$.datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){$.datepicker._selectMonthYear(id,this,"M");return false},selectYear:function(){$.datepicker._selectMonthYear(id,this,"Y");return false}};$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")])})},_generateHTML:function(inst){var maxDraw,prevText,prev,nextText,next,currentText,gotoDate,controls,buttonPanel,firstDay,showWeek,dayNames,dayNamesMin,monthNames,monthNamesShort,beforeShowDay,showOtherMonths,selectOtherMonths,defaultDate,html,dow,row,group,col,selectedDate,cornerClass,calender,thead,day,daysInMonth,leadDays,curRows,numRows,printDate,dRow,tbody,daySettings,otherMonth,unselectable,tempDate=new Date,today=this._daylightSavingAdjust(new Date(tempDate.getFullYear(),tempDate.getMonth(),tempDate.getDate())),isRTL=this._get(inst,"isRTL"),showButtonPanel=this._get(inst,"showButtonPanel"),hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext"),navigationAsDateFormat=this._get(inst,"navigationAsDateFormat"),numMonths=this._getNumberOfMonths(inst),showCurrentAtPos=this._get(inst,"showCurrentAtPos"),stepMonths=this._get(inst,"stepMonths"),isMultiMonth=numMonths[0]!==1||numMonths[1]!==1,currentDate=this._daylightSavingAdjust(!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay)),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),drawMonth=inst.drawMonth-showCurrentAtPos,drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--}if(maxDate){maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-numMonths[0]*numMonths[1]+1,maxDate.getDate()));maxDraw=minDate&&maxDraw<minDate?minDate:maxDraw;while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--}}}inst.drawMonth=drawMonth;inst.drawYear=drawYear;prevText=this._get(inst,"prevText");prevText=!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst));prev=this._canAdjustMonth(inst,-1,drawYear,drawMonth)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click'"+" title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>";
nextText=this._get(inst,"nextText");nextText=!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst));next=this._canAdjustMonth(inst,+1,drawYear,drawMonth)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click'"+" title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>";currentText=this._get(inst,"currentText");gotoDate=this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today;currentText=!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst));controls=!inst.inline?"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(inst,"closeText")+"</button>":"";buttonPanel=showButtonPanel?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'"+">"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=isNaN(firstDay)?0:firstDay;showWeek=this._get(inst,"showWeek");dayNames=this._get(inst,"dayNames");dayNamesMin=this._get(inst,"dayNamesMin");monthNames=this._get(inst,"monthNames");monthNamesShort=this._get(inst,"monthNamesShort");beforeShowDay=this._get(inst,"beforeShowDay");showOtherMonths=this._get(inst,"showOtherMonths");selectOtherMonths=this._get(inst,"selectOtherMonths");defaultDate=this._getDefaultDate(inst);html="";dow;for(row=0;row<numMonths[0];row++){group="";this.maxRows=4;for(col=0;col<numMonths[1];col++){selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));cornerClass=" ui-corner-all";calender="";if(isMultiMonth){calender+="<div class='ui-datepicker-group";if(numMonths[1]>1){switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break}}calender+="'>"}calender+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+cornerClass+"'>"+(/all|left/.test(cornerClass)&&row===0?isRTL?next:prev:"")+(/all|right/.test(cornerClass)&&row===0?isRTL?prev:next:"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>";thead=showWeek?"<th class='ui-datepicker-week-col'>"+this._get(inst,"weekHeader")+"</th>":"";for(dow=0;dow<7;dow++){day=(dow+firstDay)%7;thead+="<th scope='col'"+((dow+firstDay+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+dayNames[day]+"'>"+dayNamesMin[day]+"</span></th>"}calender+=thead+"</tr></thead><tbody>";daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear===inst.selectedYear&&drawMonth===inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)}leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;curRows=Math.ceil((leadDays+daysInMonth)/7);numRows=isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows;this.maxRows=numRows;printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(dRow=0;dRow<numRows;dRow++){calender+="<tr>";tbody=!showWeek?"":"<td class='ui-datepicker-week-col'>"+this._get(inst,"calculateWeek")(printDate)+"</td>";for(dow=0;dow<7;dow++){daySettings=beforeShowDay?beforeShowDay.apply(inst.input?inst.input[0]:null,[printDate]):[true,""];otherMonth=printDate.getMonth()!==drawMonth;unselectable=otherMonth&&!selectOtherMonths||!daySettings[0]||minDate&&printDate<minDate||maxDate&&printDate>maxDate;tbody+="<td class='"+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+(printDate.getTime()===selectedDate.getTime()&&drawMonth===inst.selectedMonth&&inst._keyEvent||defaultDate.getTime()===printDate.getTime()&&defaultDate.getTime()===selectedDate.getTime()?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()===currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()===today.getTime()?" ui-datepicker-today":""))+"'"+((!otherMonth||showOtherMonths)&&daySettings[2]?" title='"+daySettings[2].replace(/'/g,"&#39;")+"'":"")+(unselectable?"":" data-handler='selectDay' data-event='click' data-month='"+printDate.getMonth()+"' data-year='"+printDate.getFullYear()+"'")+">"+(otherMonth&&!showOtherMonths?"&#xa0;":unselectable?"<span class='ui-state-default'>"+printDate.getDate()+"</span>":"<a class='ui-state-default"+(printDate.getTime()===today.getTime()?" ui-state-highlight":"")+(printDate.getTime()===currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+"' href='#'>"+printDate.getDate()+"</a>")+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate)}calender+=tbody+"</tr>"}drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++}calender+="</tbody></table>"+(isMultiMonth?"</div>"+(numMonths[0]>0&&col===numMonths[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"");group+=calender}html+=group}html+=buttonPanel;inst._keyEvent=false;return html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var inMinYear,inMaxYear,month,years,thisYear,determineYear,year,endYear,changeMonth=this._get(inst,"changeMonth"),changeYear=this._get(inst,"changeYear"),showMonthAfterYear=this._get(inst,"showMonthAfterYear"),html="<div class='ui-datepicker-title'>",monthHtml="";if(secondary||!changeMonth){monthHtml+="<span class='ui-datepicker-month'>"+monthNames[drawMonth]+"</span>"}else{inMinYear=minDate&&minDate.getFullYear()===drawYear;inMaxYear=maxDate&&maxDate.getFullYear()===drawYear;monthHtml+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+="<option value='"+month+"'"+(month===drawMonth?" selected='selected'":"")+">"+monthNamesShort[month]+"</option>"}}monthHtml+="</select>"}if(!showMonthAfterYear){html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")}if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear){html+="<span class='ui-datepicker-year'>"+drawYear+"</span>"}else{years=this._get(inst,"yearRange").split(":");thisYear=(new Date).getFullYear();determineYear=function(value){var year=value.match(/c[+\-].*/)?drawYear+parseInt(value.substring(1),10):value.match(/[+\-].*/)?thisYear+parseInt(value,10):parseInt(value,10);return isNaN(year)?thisYear:year};year=determineYear(years[0]);endYear=Math.max(year,determineYear(years[1]||""));year=minDate?Math.max(year,minDate.getFullYear()):year;endYear=maxDate?Math.min(endYear,maxDate.getFullYear()):endYear;inst.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;year<=endYear;year++){inst.yearshtml+="<option value='"+year+"'"+(year===drawYear?" selected='selected'":"")+">"+year+"</option>"}inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null}}html+=this._get(inst,"yearSuffix");if(showMonthAfterYear){html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml}html+="</div>";return html},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period==="Y"?offset:0),month=inst.drawMonth+(period==="M"?offset:0),day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period==="D"?offset:0),date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period==="M"||period==="Y"){this._notifyChange(inst)}},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),newDate=minDate&&date<minDate?minDate:date;return maxDate&&newDate>maxDate?maxDate:newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply(inst.input?inst.input[0]:null,[inst.selectedYear,inst.selectedMonth+1,inst])}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return numMonths==null?[1,1]:typeof numMonths==="number"?[1,numMonths]:numMonths},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst),date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()))}return this._isInRange(inst,date)},_isInRange:function(inst,date){var yearSplit,currentYear,minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),minYear=null,maxYear=null,years=this._get(inst,"yearRange");if(years){yearSplit=years.split(":");currentYear=(new Date).getFullYear();minYear=parseInt(yearSplit[0],10);maxYear=parseInt(yearSplit[1],10);if(yearSplit[0].match(/[+\-].*/)){minYear+=currentYear}if(yearSplit[1].match(/[+\-].*/)){maxYear+=currentYear}}return(!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())&&(!minYear||date.getFullYear()>=minYear)&&(!maxYear||date.getFullYear()<=maxYear)},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=typeof shortYearCutoff!=="string"?shortYearCutoff:(new Date).getFullYear()%100+parseInt(shortYearCutoff,10);return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear}var date=day?typeof day==="object"?day:this._daylightSavingAdjust(new Date(year,month,day)):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}});function datepicker_bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.delegate(selector,"mouseout",function(){$(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).removeClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).removeClass("ui-datepicker-next-hover")}}).delegate(selector,"mouseover",datepicker_handleMouseover)}function datepicker_handleMouseover(){if(!$.datepicker._isDisabledDatepicker(datepicker_instActive.inline?datepicker_instActive.dpDiv.parent()[0]:datepicker_instActive.input[0])){$(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");$(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).addClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).addClass("ui-datepicker-next-hover")}}}function datepicker_extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null){target[name]=props[name]}}return target}$.fn.datepicker=function(options){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick);$.datepicker.initialized=true}if($("#"+$.datepicker._mainDivId).length===0){$("body").append($.datepicker.dpDiv)}var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options==="string"&&(options==="isDisabled"||options==="getDate"||options==="widget")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}if(options==="option"&&arguments.length===2&&typeof arguments[1]==="string"){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}return this.each(function(){typeof options==="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)})};$.datepicker=new Datepicker;$.datepicker.initialized=false;$.datepicker.uuid=(new Date).getTime();$.datepicker.version="1.11.4";var datepicker=$.datepicker;var slider=$.widget("ui.slider",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this._calculateNewMax();this.element.addClass("ui-slider"+" ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=false},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),handle="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",handles=[];handleCount=options.values&&options.values.length||1;if(existingHandles.length>handleCount){existingHandles.slice(handleCount).remove();existingHandles=existingHandles.slice(0,handleCount)}for(i=existingHandles.length;i<handleCount;i++){handles.push(handle)}this.handles=existingHandles.add($(handles.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(i){$(this).data("ui-slider-handle-index",i)})},_createRange:function(){var options=this.options,classes="";if(options.range){if(options.range===true){if(!options.values){options.values=[this._valueMin(),this._valueMin()]}else if(options.values.length&&options.values.length!==2){options.values=[options.values[0],options.values[0]]}else if($.isArray(options.values)){options.values=options.values.slice(0)}}if(!this.range||!this.range.length){this.range=$("<div></div>").appendTo(this.element);classes="ui-slider-range"+" ui-widget-header ui-corner-all"}else{this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""})}this.range.addClass(classes+(options.range==="min"||options.range==="max"?" ui-slider-range-"+options.range:""))}else{if(this.range){this.range.remove()}this.range=null}},_setupEvents:function(){this._off(this.handles);this._on(this.handles,this._handleEvents);this._hoverable(this.handles);this._focusable(this.handles)},_destroy:function(){this.handles.remove();if(this.range){this.range.remove()}this.element.removeClass("ui-slider"+" ui-slider-horizontal"+" ui-slider-vertical"+" ui-widget"+" ui-widget-content"+" ui-corner-all");this._mouseDestroy()},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,allowed,offset,mouseOverHandle,that=this,o=this.options;if(o.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();position={x:event.pageX,y:event.pageY};normValue=this._normValueFromMouse(position);distance=this._valueMax()-this._valueMin()+1;this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));if(distance>thisDistance||distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min)){distance=thisDistance;closestHandle=$(this);index=i}});allowed=this._start(event,index);if(allowed===false){return false}this._mouseSliding=true;this._handleIndex=index;closestHandle.addClass("ui-state-active").focus();offset=closestHandle.offset();mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-closestHandle.width()/2,top:event.pageY-offset.top-closestHandle.height()/2-(parseInt(closestHandle.css("borderTopWidth"),10)||0)-(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+(parseInt(closestHandle.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(event,index,normValue)}this._animateOff=true;return true},_mouseStart:function(){return true},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);this._slide(event,this._handleIndex,normValue);return false},_mouseStop:function(event){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(event,this._handleIndex);this._change(event,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;if(this.orientation==="horizontal"){pixelTotal=this.elementSize.width;pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{pixelTotal=this.elementSize.height;pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}percentMouse=pixelMouse/pixelTotal;if(percentMouse>1){percentMouse=1}if(percentMouse<0){percentMouse=0}if(this.orientation==="vertical"){percentMouse=1-percentMouse}valueTotal=this._valueMax()-this._valueMin();valueMouse=this._valueMin()+percentMouse*valueTotal;return this._trimAlignValue(valueMouse)},_start:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}return this._trigger("start",event,uiHash)},_slide:function(event,index,newVal){var otherVal,newValues,allowed;if(this.options.values&&this.options.values.length){otherVal=this.values(index?0:1);if(this.options.values.length===2&&this.options.range===true&&(index===0&&newVal>otherVal||index===1&&newVal<otherVal)){newVal=otherVal}if(newVal!==this.values(index)){newValues=this.values();newValues[index]=newVal;allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal,values:newValues});otherVal=this.values(index?0:1);if(allowed!==false){this.values(index,newVal)}}}else{if(newVal!==this.value()){allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal});if(allowed!==false){this.value(newVal)}}}},_stop:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}this._trigger("stop",event,uiHash)},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}this._lastChangedValue=index;this._trigger("change",event,uiHash)}},value:function(newValue){if(arguments.length){this.options.value=this._trimAlignValue(newValue);this._refreshValue();this._change(null,0);return}return this._value()},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1){this.options.values[index]=this._trimAlignValue(newValue);this._refreshValue();this._change(null,index);return}if(arguments.length){if($.isArray(arguments[0])){vals=this.options.values;newValues=arguments[0];for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(newValues[i]);this._change(null,i)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(index)}else{return this.value()}}}else{return this._values()}},_setOption:function(key,value){var i,valsLength=0;if(key==="range"&&this.options.range===true){if(value==="min"){this.options.value=this._values(0);this.options.values=null}else if(value==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null}}if($.isArray(this.options.values)){valsLength=this.options.values.length}if(key==="disabled"){this.element.toggleClass("ui-state-disabled",!!value)}this._super(key,value);switch(key){case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();this.handles.css(value==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(i=0;i<valsLength;i+=1){this._change(null,i)}this._animateOff=false;break;case"step":case"min":case"max":this._animateOff=true;this._calculateNewMax();this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break}},_value:function(){var val=this.options.value;val=this._trimAlignValue(val);return val},_values:function(index){var val,vals,i;if(arguments.length){val=this.options.values[index];val=this._trimAlignValue(val);return val}else if(this.options.values&&this.options.values.length){vals=this.options.values.slice();for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(vals[i])}return vals}else{return[]}},_trimAlignValue:function(val){if(val<=this._valueMin()){return this._valueMin()}if(val>=this._valueMax()){return this._valueMax()}var step=this.options.step>0?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;if(Math.abs(valModStep)*2>=step){alignValue+=valModStep>0?step:-step}return parseFloat(alignValue.toFixed(5))},_calculateNewMax:function(){var max=this.options.max,min=this._valueMin(),step=this.options.step,aboveMin=Math.floor(+(max-min).toFixed(this._precision())/step)*step;max=aboveMin+min;this.max=parseFloat(max.toFixed(this._precision()))},_precision:function(){var precision=this._precisionOf(this.options.step);if(this.options.min!==null){precision=Math.max(precision,this._precisionOf(this.options.min))}return precision},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return decimal===-1?0:str.length-decimal-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=!this._animateOff?o.animate:false,_set={};if(this.options.values&&this.options.values.length){this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100;_set[that.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate);if(that.options.range===true){if(that.orientation==="horizontal"){if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate)}if(i===1){that.range[animate?"animate":"css"]({width:valPercent-lastValPercent+"%"},{queue:false,duration:o.animate})}}else{if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({bottom:valPercent+"%"},o.animate)}if(i===1){that.range[animate?"animate":"css"]({height:valPercent-lastValPercent+"%"},{queue:false,duration:o.animate})}}}lastValPercent=valPercent})}else{value=this.value();valueMin=this._valueMin();valueMax=this._valueMax();valPercent=valueMax!==valueMin?(value-valueMin)/(valueMax-valueMin)*100:0;_set[this.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate);if(oRange==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate)}if(oRange==="max"&&this.orientation==="horizontal"){this.range[animate?"animate":"css"]({width:100-valPercent+"%"},{queue:false,duration:o.animate})}if(oRange==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate)}if(oRange==="max"&&this.orientation==="vertical"){this.range[animate?"animate":"css"]({height:100-valPercent+"%"},{queue:false,duration:o.animate})}}},_handleEvents:{keydown:function(event){var allowed,curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:event.preventDefault();if(!this._keySliding){this._keySliding=true;$(event.target).addClass("ui-state-active");allowed=this._start(event,index);if(allowed===false){return}}break}step=this.options.step;if(this.options.values&&this.options.values.length){curVal=newVal=this.values(index)}else{curVal=newVal=this.value()}switch(event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax()){return}newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin()){return}newVal=this._trimAlignValue(curVal-step);break}this._slide(event,index,newVal)},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(event,index);this._change(event,index);$(event.target).removeClass("ui-state-active")}}}})});(function(factory){if(typeof define==="function"&&define.amd){define(["../datepicker"],factory)}else{factory(jQuery.datepicker)}})(function(datepicker){datepicker.regional["de"]={closeText:"Schließen",prevText:"&#x3C;Zurück",nextText:"Vor&#x3E;",currentText:"Heute",monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesShort:["So","Mo","Di","Mi","Do","Fr","Sa"],dayNamesMin:["So","Mo","Di","Mi","Do","Fr","Sa"],weekHeader:"KW",dateFormat:"dd.mm.yy",firstDay:1,isRTL:false,showMonthAfterYear:false,yearSuffix:""};datepicker.setDefaults(datepicker.regional["de"]);return datepicker.regional["de"]});(function(factory){if(typeof define==="function"&&define.amd){define(["../datepicker"],factory)}else{factory(jQuery.datepicker)}})(function(datepicker){datepicker.regional["fr"]={closeText:"Fermer",prevText:"Précédent",nextText:"Suivant",currentText:"Aujourd'hui",monthNames:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],monthNamesShort:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],dayNames:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],dayNamesShort:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],dayNamesMin:["D","L","M","M","J","V","S"],weekHeader:"Sem.",dateFormat:"dd/mm/yy",firstDay:1,isRTL:false,showMonthAfterYear:false,yearSuffix:""};datepicker.setDefaults(datepicker.regional["fr"]);return datepicker.regional["fr"]});

var DateFormatter;!function(){"use strict";var e,t,a,n,r,o,i;o=864e5,i=3600,e=function(e,t){return"string"==typeof e&&"string"==typeof t&&e.toLowerCase()===t.toLowerCase()},t=function(e,a,n){var r=n||"0",o=e.toString();return o.length<a?t(r+o,a):o},a=function(e){var t,n;for(e=e||{},t=1;t<arguments.length;t++)if(n=arguments[t])for(var r in n)n.hasOwnProperty(r)&&("object"==typeof n[r]?a(e[r],n[r]):e[r]=n[r]);return e},n=function(e,t){for(var a=0;a<t.length;a++)if(t[a].toLowerCase()===e.toLowerCase())return a;return-1},r={dateSettings:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridiem:["AM","PM"],ordinal:function(e){var t=e%10,a={1:"st",2:"nd",3:"rd"};return 1!==Math.floor(e%100/10)&&a[t]?a[t]:"th"}},separators:/[ \-+\/\.T:@]/g,validParts:/[dDjlNSwzWFmMntLoYyaABgGhHisueTIOPZcrU]/g,intParts:/[djwNzmnyYhHgGis]/g,tzParts:/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,tzClip:/[^-+\dA-Z]/g},(DateFormatter=function(e){var t=this,n=a(r,e);t.dateSettings=n.dateSettings,t.separators=n.separators,t.validParts=n.validParts,t.intParts=n.intParts,t.tzParts=n.tzParts,t.tzClip=n.tzClip}).prototype={constructor:DateFormatter,getMonth:function(e){var t,a=this;return 0===(t=n(e,a.dateSettings.monthsShort)+1)&&(t=n(e,a.dateSettings.months)+1),t},parseDate:function(t,a){var n,r,o,i,s,d,u,l,f,c,h=this,m=!1,g=!1,p=h.dateSettings,y={date:null,year:null,month:null,day:null,hour:0,min:0,sec:0};if(!t)return null;if(t instanceof Date)return t;if("U"===a)return(o=parseInt(t))?new Date(1e3*o):t;switch(typeof t){case"number":return new Date(t);case"string":break;default:return null}if(!(n=a.match(h.validParts))||0===n.length)throw new Error("Invalid date format definition.");for(r=t.replace(h.separators,"\0").split("\0"),o=0;o<r.length;o++)switch(i=r[o],s=parseInt(i),n[o]){case"y":case"Y":if(!s)return null;f=i.length,y.year=2===f?parseInt((70>s?"20":"19")+i):s,m=!0;break;case"m":case"n":case"M":case"F":if(isNaN(s)){if(!((d=h.getMonth(i))>0))return null;y.month=d}else{if(!(s>=1&&12>=s))return null;y.month=s}m=!0;break;case"d":case"j":if(!(s>=1&&31>=s))return null;y.day=s,m=!0;break;case"g":case"h":if(u=n.indexOf("a")>-1?n.indexOf("a"):n.indexOf("A")>-1?n.indexOf("A"):-1,c=r[u],u>-1)l=e(c,p.meridiem[0])?0:e(c,p.meridiem[1])?12:-1,s>=1&&12>=s&&l>-1?y.hour=s+l-1:s>=0&&23>=s&&(y.hour=s);else{if(!(s>=0&&23>=s))return null;y.hour=s}g=!0;break;case"G":case"H":if(!(s>=0&&23>=s))return null;y.hour=s,g=!0;break;case"i":if(!(s>=0&&59>=s))return null;y.min=s,g=!0;break;case"s":if(!(s>=0&&59>=s))return null;y.sec=s,g=!0}if(!0===m&&y.year&&y.month&&y.day)y.date=new Date(y.year,y.month-1,y.day,y.hour,y.min,y.sec,0);else{if(!0!==g)return null;y.date=new Date(0,0,0,y.hour,y.min,y.sec,0)}return y.date},guessDate:function(e,t){if("string"!=typeof e)return e;var a,n,r,o,i,s,d=this,u=e.replace(d.separators,"\0").split("\0"),l=/^[djmn]/g,f=t.match(d.validParts),c=new Date,h=0;if(!l.test(f[0]))return e;for(r=0;r<u.length;r++){if(h=2,i=u[r],s=parseInt(i.substr(0,2)),isNaN(s))return null;switch(r){case 0:"m"===f[0]||"n"===f[0]?c.setMonth(s-1):c.setDate(s);break;case 1:"m"===f[0]||"n"===f[0]?c.setDate(s):c.setMonth(s-1);break;case 2:if(n=c.getFullYear(),a=i.length,h=4>a?a:4,!(n=parseInt(4>a?n.toString().substr(0,4-a)+i:i.substr(0,4))))return null;c.setFullYear(n);break;case 3:c.setHours(s);break;case 4:c.setMinutes(s);break;case 5:c.setSeconds(s)}(o=i.substr(h)).length>0&&u.splice(r+1,0,o)}return c},parseFormat:function(e,a){var n,r=this,s=r.dateSettings,d=/\\?(.?)/gi,u=function(e,t){return n[e]?n[e]():t};return n={d:function(){return t(n.j(),2)},D:function(){return s.daysShort[n.w()]},j:function(){return a.getDate()},l:function(){return s.days[n.w()]},N:function(){return n.w()||7},w:function(){return a.getDay()},z:function(){var e=new Date(n.Y(),n.n()-1,n.j()),t=new Date(n.Y(),0,1);return Math.round((e-t)/o)},W:function(){var e=new Date(n.Y(),n.n()-1,n.j()-n.N()+3),a=new Date(e.getFullYear(),0,4);return t(1+Math.round((e-a)/o/7),2)},F:function(){return s.months[a.getMonth()]},m:function(){return t(n.n(),2)},M:function(){return s.monthsShort[a.getMonth()]},n:function(){return a.getMonth()+1},t:function(){return new Date(n.Y(),n.n(),0).getDate()},L:function(){var e=n.Y();return e%4==0&&e%100!=0||e%400==0?1:0},o:function(){var e=n.n(),t=n.W();return n.Y()+(12===e&&9>t?1:1===e&&t>9?-1:0)},Y:function(){return a.getFullYear()},y:function(){return n.Y().toString().slice(-2)},a:function(){return n.A().toLowerCase()},A:function(){var e=n.G()<12?0:1;return s.meridiem[e]},B:function(){var e=a.getUTCHours()*i,n=60*a.getUTCMinutes(),r=a.getUTCSeconds();return t(Math.floor((e+n+r+i)/86.4)%1e3,3)},g:function(){return n.G()%12||12},G:function(){return a.getHours()},h:function(){return t(n.g(),2)},H:function(){return t(n.G(),2)},i:function(){return t(a.getMinutes(),2)},s:function(){return t(a.getSeconds(),2)},u:function(){return t(1e3*a.getMilliseconds(),6)},e:function(){return/\((.*)\)/.exec(String(a))[1]||"Coordinated Universal Time"},I:function(){return new Date(n.Y(),0)-Date.UTC(n.Y(),0)!=new Date(n.Y(),6)-Date.UTC(n.Y(),6)?1:0},O:function(){var e=a.getTimezoneOffset(),n=Math.abs(e);return(e>0?"-":"+")+t(100*Math.floor(n/60)+n%60,4)},P:function(){var e=n.O();return e.substr(0,3)+":"+e.substr(3,2)},T:function(){return(String(a).match(r.tzParts)||[""]).pop().replace(r.tzClip,"")||"UTC"},Z:function(){return 60*-a.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(d,u)},r:function(){return"D, d M Y H:i:s O".replace(d,u)},U:function(){return a.getTime()/1e3||0}},u(e,e)},formatDate:function(e,t){var a,n,r,o,i,s=this,d="";if("string"==typeof e&&!(e=s.parseDate(e,t)))return null;if(e instanceof Date){for(r=t.length,a=0;r>a;a++)"S"!==(i=t.charAt(a))&&"\\"!==i&&(a>0&&"\\"===t.charAt(a-1)?d+=i:(o=s.parseFormat(i,e),a!==r-1&&s.intParts.test(i)&&"S"===t.charAt(a+1)&&(n=parseInt(o)||0,o+=s.dateSettings.ordinal(n)),d+=o));return d}return""}}}();var datetimepickerFactory=function(e){"use strict";function t(e,t,a){this.date=e,this.desc=t,this.style=a}var a={i18n:{ar:{months:["كانون الثاني","شباط","آذار","نيسان","مايو","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],dayOfWeekShort:["ن","ث","ع","خ","ج","س","ح"],dayOfWeek:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت","الأحد"]},ro:{months:["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],dayOfWeekShort:["Du","Lu","Ma","Mi","Jo","Vi","Sâ"],dayOfWeek:["Duminică","Luni","Marţi","Miercuri","Joi","Vineri","Sâmbătă"]},id:{months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],dayOfWeekShort:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],dayOfWeek:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"]},is:{months:["Janúar","Febrúar","Mars","Apríl","Maí","Júní","Júlí","Ágúst","September","Október","Nóvember","Desember"],dayOfWeekShort:["Sun","Mán","Þrið","Mið","Fim","Fös","Lau"],dayOfWeek:["Sunnudagur","Mánudagur","Þriðjudagur","Miðvikudagur","Fimmtudagur","Föstudagur","Laugardagur"]},bg:{months:["Януари","Февруари","Март","Април","Май","Юни","Юли","Август","Септември","Октомври","Ноември","Декември"],dayOfWeekShort:["Нд","Пн","Вт","Ср","Чт","Пт","Сб"],dayOfWeek:["Неделя","Понеделник","Вторник","Сряда","Четвъртък","Петък","Събота"]},fa:{months:["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],dayOfWeekShort:["یکشنبه","دوشنبه","سه شنبه","چهارشنبه","پنجشنبه","جمعه","شنبه"],dayOfWeek:["یک‌شنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنج‌شنبه","جمعه","شنبه","یک‌شنبه"]},ru:{months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayOfWeekShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],dayOfWeek:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"]},uk:{months:["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],dayOfWeekShort:["Ндл","Пнд","Втр","Срд","Чтв","Птн","Сбт"],dayOfWeek:["Неділя","Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота"]},en:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeekShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},el:{months:["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],dayOfWeekShort:["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"],dayOfWeek:["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"]},de:{months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dayOfWeekShort:["So","Mo","Di","Mi","Do","Fr","Sa"],dayOfWeek:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},nl:{months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],dayOfWeekShort:["zo","ma","di","wo","do","vr","za"],dayOfWeek:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"]},tr:{months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],dayOfWeekShort:["Paz","Pts","Sal","Çar","Per","Cum","Cts"],dayOfWeek:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"]},fr:{months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dayOfWeekShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],dayOfWeek:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},es:{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dayOfWeekShort:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],dayOfWeek:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"]},th:{months:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],dayOfWeekShort:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],dayOfWeek:["อาทิตย์","จันทร์","อังคาร","พุธ","พฤหัส","ศุกร์","เสาร์","อาทิตย์"]},pl:{months:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],dayOfWeekShort:["nd","pn","wt","śr","cz","pt","sb"],dayOfWeek:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"]},pt:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeekShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],dayOfWeek:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"]},ch:{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeekShort:["日","一","二","三","四","五","六"]},se:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeekShort:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"]},km:{months:["មករា​","កុម្ភៈ","មិនា​","មេសា​","ឧសភា​","មិថុនា​","កក្កដា​","សីហា​","កញ្ញា​","តុលា​","វិច្ឆិកា","ធ្នូ​"],dayOfWeekShort:["អាទិ​","ច័ន្ទ​","អង្គារ​","ពុធ​","ព្រហ​​","សុក្រ​","សៅរ៍"],dayOfWeek:["អាទិត្យ​","ច័ន្ទ​","អង្គារ​","ពុធ​","ព្រហស្បតិ៍​","សុក្រ​","សៅរ៍"]},kr:{months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dayOfWeekShort:["일","월","화","수","목","금","토"],dayOfWeek:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"]},it:{months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dayOfWeekShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],dayOfWeek:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"]},da:{months:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],dayOfWeekShort:["Søn","Man","Tir","Ons","Tor","Fre","Lør"],dayOfWeek:["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"]},no:{months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],dayOfWeekShort:["Søn","Man","Tir","Ons","Tor","Fre","Lør"],dayOfWeek:["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag"]},ja:{months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeekShort:["日","月","火","水","木","金","土"],dayOfWeek:["日曜","月曜","火曜","水曜","木曜","金曜","土曜"]},vi:{months:["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],dayOfWeekShort:["CN","T2","T3","T4","T5","T6","T7"],dayOfWeek:["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy"]},sl:{months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],dayOfWeekShort:["Ned","Pon","Tor","Sre","Čet","Pet","Sob"],dayOfWeek:["Nedelja","Ponedeljek","Torek","Sreda","Četrtek","Petek","Sobota"]},cs:{months:["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"],dayOfWeekShort:["Ne","Po","Út","St","Čt","Pá","So"]},hu:{months:["Január","Február","Március","Április","Május","Június","Július","Augusztus","Szeptember","Október","November","December"],dayOfWeekShort:["Va","Hé","Ke","Sze","Cs","Pé","Szo"],dayOfWeek:["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"]},az:{months:["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avqust","Sentyabr","Oktyabr","Noyabr","Dekabr"],dayOfWeekShort:["B","Be","Ça","Ç","Ca","C","Ş"],dayOfWeek:["Bazar","Bazar ertəsi","Çərşənbə axşamı","Çərşənbə","Cümə axşamı","Cümə","Şənbə"]},bs:{months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],dayOfWeekShort:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"],dayOfWeek:["Nedjelja","Ponedjeljak","Utorak","Srijeda","Četvrtak","Petak","Subota"]},ca:{months:["Gener","Febrer","Març","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],dayOfWeekShort:["Dg","Dl","Dt","Dc","Dj","Dv","Ds"],dayOfWeek:["Diumenge","Dilluns","Dimarts","Dimecres","Dijous","Divendres","Dissabte"]},"en-GB":{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeekShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},et:{months:["Jaanuar","Veebruar","Märts","Aprill","Mai","Juuni","Juuli","August","September","Oktoober","November","Detsember"],dayOfWeekShort:["P","E","T","K","N","R","L"],dayOfWeek:["Pühapäev","Esmaspäev","Teisipäev","Kolmapäev","Neljapäev","Reede","Laupäev"]},eu:{months:["Urtarrila","Otsaila","Martxoa","Apirila","Maiatza","Ekaina","Uztaila","Abuztua","Iraila","Urria","Azaroa","Abendua"],dayOfWeekShort:["Ig.","Al.","Ar.","Az.","Og.","Or.","La."],dayOfWeek:["Igandea","Astelehena","Asteartea","Asteazkena","Osteguna","Ostirala","Larunbata"]},fi:{months:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kesäkuu","Heinäkuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],dayOfWeekShort:["Su","Ma","Ti","Ke","To","Pe","La"],dayOfWeek:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"]},gl:{months:["Xan","Feb","Maz","Abr","Mai","Xun","Xul","Ago","Set","Out","Nov","Dec"],dayOfWeekShort:["Dom","Lun","Mar","Mer","Xov","Ven","Sab"],dayOfWeek:["Domingo","Luns","Martes","Mércores","Xoves","Venres","Sábado"]},hr:{months:["Siječanj","Veljača","Ožujak","Travanj","Svibanj","Lipanj","Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac"],dayOfWeekShort:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"],dayOfWeek:["Nedjelja","Ponedjeljak","Utorak","Srijeda","Četvrtak","Petak","Subota"]},ko:{months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dayOfWeekShort:["일","월","화","수","목","금","토"],dayOfWeek:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"]},lt:{months:["Sausio","Vasario","Kovo","Balandžio","Gegužės","Birželio","Liepos","Rugpjūčio","Rugsėjo","Spalio","Lapkričio","Gruodžio"],dayOfWeekShort:["Sek","Pir","Ant","Tre","Ket","Pen","Šeš"],dayOfWeek:["Sekmadienis","Pirmadienis","Antradienis","Trečiadienis","Ketvirtadienis","Penktadienis","Šeštadienis"]},lv:{months:["Janvāris","Februāris","Marts","Aprīlis ","Maijs","Jūnijs","Jūlijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],dayOfWeekShort:["Sv","Pr","Ot","Tr","Ct","Pk","St"],dayOfWeek:["Svētdiena","Pirmdiena","Otrdiena","Trešdiena","Ceturtdiena","Piektdiena","Sestdiena"]},mk:{months:["јануари","февруари","март","април","мај","јуни","јули","август","септември","октомври","ноември","декември"],dayOfWeekShort:["нед","пон","вто","сре","чет","пет","саб"],dayOfWeek:["Недела","Понеделник","Вторник","Среда","Четврток","Петок","Сабота"]},mn:{months:["1-р сар","2-р сар","3-р сар","4-р сар","5-р сар","6-р сар","7-р сар","8-р сар","9-р сар","10-р сар","11-р сар","12-р сар"],dayOfWeekShort:["Дав","Мяг","Лха","Пүр","Бсн","Бям","Ням"],dayOfWeek:["Даваа","Мягмар","Лхагва","Пүрэв","Баасан","Бямба","Ням"]},"pt-BR":{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeekShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],dayOfWeek:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"]},sk:{months:["Január","Február","Marec","Apríl","Máj","Jún","Júl","August","September","Október","November","December"],dayOfWeekShort:["Ne","Po","Ut","St","Št","Pi","So"],dayOfWeek:["Nedeľa","Pondelok","Utorok","Streda","Štvrtok","Piatok","Sobota"]},sq:{months:["Janar","Shkurt","Mars","Prill","Maj","Qershor","Korrik","Gusht","Shtator","Tetor","Nëntor","Dhjetor"],dayOfWeekShort:["Die","Hën","Mar","Mër","Enj","Pre","Shtu"],dayOfWeek:["E Diel","E Hënë","E Martē","E Mërkurë","E Enjte","E Premte","E Shtunë"]},"sr-YU":{months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],dayOfWeekShort:["Ned","Pon","Uto","Sre","čet","Pet","Sub"],dayOfWeek:["Nedelja","Ponedeljak","Utorak","Sreda","Četvrtak","Petak","Subota"]},sr:{months:["јануар","фебруар","март","април","мај","јун","јул","август","септембар","октобар","новембар","децембар"],dayOfWeekShort:["нед","пон","уто","сре","чет","пет","суб"],dayOfWeek:["Недеља","Понедељак","Уторак","Среда","Четвртак","Петак","Субота"]},sv:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeekShort:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"],dayOfWeek:["Söndag","Måndag","Tisdag","Onsdag","Torsdag","Fredag","Lördag"]},"zh-TW":{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeekShort:["日","一","二","三","四","五","六"],dayOfWeek:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},zh:{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeekShort:["日","一","二","三","四","五","六"],dayOfWeek:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},ug:{months:["1-ئاي","2-ئاي","3-ئاي","4-ئاي","5-ئاي","6-ئاي","7-ئاي","8-ئاي","9-ئاي","10-ئاي","11-ئاي","12-ئاي"],dayOfWeek:["يەكشەنبە","دۈشەنبە","سەيشەنبە","چارشەنبە","پەيشەنبە","جۈمە","شەنبە"]},he:{months:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],dayOfWeekShort:["א'","ב'","ג'","ד'","ה'","ו'","שבת"],dayOfWeek:["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת","ראשון"]},hy:{months:["Հունվար","Փետրվար","Մարտ","Ապրիլ","Մայիս","Հունիս","Հուլիս","Օգոստոս","Սեպտեմբեր","Հոկտեմբեր","Նոյեմբեր","Դեկտեմբեր"],dayOfWeekShort:["Կի","Երկ","Երք","Չոր","Հնգ","Ուրբ","Շբթ"],dayOfWeek:["Կիրակի","Երկուշաբթի","Երեքշաբթի","Չորեքշաբթի","Հինգշաբթի","Ուրբաթ","Շաբաթ"]},kg:{months:["Үчтүн айы","Бирдин айы","Жалган Куран","Чын Куран","Бугу","Кулжа","Теке","Баш Оона","Аяк Оона","Тогуздун айы","Жетинин айы","Бештин айы"],dayOfWeekShort:["Жек","Дүй","Шей","Шар","Бей","Жум","Ише"],dayOfWeek:["Жекшемб","Дүйшөмб","Шейшемб","Шаршемб","Бейшемби","Жума","Ишенб"]},rm:{months:["Schaner","Favrer","Mars","Avrigl","Matg","Zercladur","Fanadur","Avust","Settember","October","November","December"],dayOfWeekShort:["Du","Gli","Ma","Me","Gie","Ve","So"],dayOfWeek:["Dumengia","Glindesdi","Mardi","Mesemna","Gievgia","Venderdi","Sonda"]},ka:{months:["იანვარი","თებერვალი","მარტი","აპრილი","მაისი","ივნისი","ივლისი","აგვისტო","სექტემბერი","ოქტომბერი","ნოემბერი","დეკემბერი"],dayOfWeekShort:["კვ","ორშ","სამშ","ოთხ","ხუთ","პარ","შაბ"],dayOfWeek:["კვირა","ორშაბათი","სამშაბათი","ოთხშაბათი","ხუთშაბათი","პარასკევი","შაბათი"]}},ownerDocument:document,contentWindow:window,value:"",rtl:!1,format:"Y/m/d H:i",formatTime:"H:i",formatDate:"Y/m/d",startDate:!1,step:60,monthChangeSpinner:!0,closeOnDateSelect:!1,closeOnTimeSelect:!0,closeOnWithoutClick:!0,closeOnInputClick:!0,timepicker:!0,datepicker:!0,weeks:!1,defaultTime:!1,defaultDate:!1,minDate:!1,maxDate:!1,minTime:!1,maxTime:!1,minDateTime:!1,disabledMinTime:!1,disabledMaxTime:!1,allowTimes:[],opened:!1,initTime:!0,inline:!1,theme:"",touchMovedThreshold:5,onSelectDate:function(){},onSelectTime:function(){},onChangeMonth:function(){},onGetWeekOfYear:function(){},onChangeYear:function(){},onChangeDateTime:function(){},onShow:function(){},onClose:function(){},onGenerate:function(){},withoutCopyright:!0,inverseButton:!1,hours12:!1,next:"xdsoft_next",prev:"xdsoft_prev",dayOfWeekStart:0,parentID:"body",timeHeightInTimePicker:25,timepickerScrollbar:!0,todayButton:!0,prevButton:!0,nextButton:!0,defaultSelect:!0,scrollMonth:!0,scrollTime:!0,scrollInput:!0,lazyInit:!1,mask:!1,validateOnBlur:!0,allowBlank:!0,yearStart:1950,yearEnd:2050,monthStart:0,monthEnd:11,style:"",id:"",fixed:!1,roundTime:"round",className:"",weekends:[],highlightedDates:[],highlightedPeriods:[],allowDates:[],allowDateRe:null,disabledDates:[],disabledWeekDays:[],yearOffset:0,beforeShowDay:null,enterLikeTab:!0,showApplyButton:!1},n=null,r="en",o={meridiem:["AM","PM"]},i=function(){var t=a.i18n[r],i={days:t.dayOfWeek,daysShort:t.dayOfWeekShort,months:t.months,monthsShort:e.map(t.months,function(e){return e.substring(0,3)})};"function"==typeof DateFormatter&&(n=new DateFormatter({dateSettings:e.extend({},o,i)}))};e.datetimepicker={setLocale:function(e){var t=a.i18n[e]?e:"en";r!==t&&(r=t,i())},setDateFormatter:function(e){n=e},RFC_2822:"D, d M Y H:i:s O",ATOM:"Y-m-dTH:i:sP",ISO_8601:"Y-m-dTH:i:sO",RFC_822:"D, d M y H:i:s O",RFC_850:"l, d-M-y H:i:s T",RFC_1036:"D, d M y H:i:s O",RFC_1123:"D, d M Y H:i:s O",RSS:"D, d M Y H:i:s O",W3C:"Y-m-dTH:i:sP"},i(),window.getComputedStyle||(window.getComputedStyle=function(e){return this.el=e,this.getPropertyValue=function(t){var a=/(-([a-z]))/g;return"float"===t&&(t="styleFloat"),a.test(t)&&(t=t.replace(a,function(e,t,a){return a.toUpperCase()})),e.currentStyle[t]||null},this}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var a,n;for(a=t||0,n=this.length;a<n;a+=1)if(this[a]===e)return a;return-1}),Date.prototype.countDaysInMonth=function(){return new Date(this.getFullYear(),this.getMonth()+1,0).getDate()},e.fn.xdsoftScroller=function(t,a){return this.each(function(){var n,r,o,i,s,d=e(this),u=function(e){var t,a={x:0,y:0};return"touchstart"===e.type||"touchmove"===e.type||"touchend"===e.type||"touchcancel"===e.type?(t=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],a.x=t.clientX,a.y=t.clientY):"mousedown"!==e.type&&"mouseup"!==e.type&&"mousemove"!==e.type&&"mouseover"!==e.type&&"mouseout"!==e.type&&"mouseenter"!==e.type&&"mouseleave"!==e.type||(a.x=e.clientX,a.y=e.clientY),a},l=100,f=!1,c=0,h=0,m=0,g=!1,p=0,y=function(){};"hide"!==a?(e(this).hasClass("xdsoft_scroller_box")||(n=d.children().eq(0),r=d[0].clientHeight,o=n[0].offsetHeight,i=e('<div class="xdsoft_scrollbar"></div>'),s=e('<div class="xdsoft_scroller"></div>'),i.append(s),d.addClass("xdsoft_scroller_box").append(i),y=function(e){var t=u(e).y-c+p;t<0&&(t=0),t+s[0].offsetHeight>m&&(t=m-s[0].offsetHeight),d.trigger("scroll_element.xdsoft_scroller",[l?t/l:0])},s.on("touchstart.xdsoft_scroller mousedown.xdsoft_scroller",function(n){r||d.trigger("resize_scroll.xdsoft_scroller",[a]),c=u(n).y,p=parseInt(s.css("margin-top"),10),m=i[0].offsetHeight,"mousedown"===n.type||"touchstart"===n.type?(t.ownerDocument&&e(t.ownerDocument.body).addClass("xdsoft_noselect"),e([t.ownerDocument.body,t.contentWindow]).on("touchend mouseup.xdsoft_scroller",function a(){e([t.ownerDocument.body,t.contentWindow]).off("touchend mouseup.xdsoft_scroller",a).off("mousemove.xdsoft_scroller",y).removeClass("xdsoft_noselect")}),e(t.ownerDocument.body).on("mousemove.xdsoft_scroller",y)):(g=!0,n.stopPropagation(),n.preventDefault())}).on("touchmove",function(e){g&&(e.preventDefault(),y(e))}).on("touchend touchcancel",function(){g=!1,p=0}),d.on("scroll_element.xdsoft_scroller",function(e,t){r||d.trigger("resize_scroll.xdsoft_scroller",[t,!0]),t=t>1?1:t<0||isNaN(t)?0:t,s.css("margin-top",l*t),setTimeout(function(){n.css("marginTop",-parseInt((n[0].offsetHeight-r)*t,10))},10)}).on("resize_scroll.xdsoft_scroller",function(e,t,a){var u,f;r=d[0].clientHeight,o=n[0].offsetHeight,f=(u=r/o)*i[0].offsetHeight,u>1?s.hide():(s.show(),s.css("height",parseInt(f>10?f:10,10)),l=i[0].offsetHeight-s[0].offsetHeight,!0!==a&&d.trigger("scroll_element.xdsoft_scroller",[t||Math.abs(parseInt(n.css("marginTop"),10))/(o-r)]))}),d.on("mousewheel",function(e){var t=Math.abs(parseInt(n.css("marginTop"),10));return(t-=20*e.deltaY)<0&&(t=0),d.trigger("scroll_element.xdsoft_scroller",[t/(o-r)]),e.stopPropagation(),!1}),d.on("touchstart",function(e){f=u(e),h=Math.abs(parseInt(n.css("marginTop"),10))}),d.on("touchmove",function(e){if(f){e.preventDefault();var t=u(e);d.trigger("scroll_element.xdsoft_scroller",[(h-(t.y-f.y))/(o-r)])}}),d.on("touchend touchcancel",function(){f=!1,h=0})),d.trigger("resize_scroll.xdsoft_scroller",[a])):d.find(".xdsoft_scrollbar").hide()})},e.fn.datetimepicker=function(o,i){var s,d,u=this,l=48,f=57,c=96,h=105,m=17,g=46,p=13,y=27,v=8,D=37,b=38,k=39,x=40,T=9,S=116,w=65,M=67,O=86,W=90,_=89,F=!1,C=e.isPlainObject(o)||!o?e.extend(!0,{},a,o):e.extend(!0,{},a),P=0,A=function(e){e.on("open.xdsoft focusin.xdsoft mousedown.xdsoft touchstart",function t(){e.is(":disabled")||e.data("xdsoft_datetimepicker")||(clearTimeout(P),P=setTimeout(function(){e.data("xdsoft_datetimepicker")||s(e),e.off("open.xdsoft focusin.xdsoft mousedown.xdsoft touchstart",t).trigger("open.xdsoft")},100))})};return s=function(a){function i(){var e,t=!1;return C.startDate?t=Y.strToDate(C.startDate):(t=C.value||(a&&a.val&&a.val()?a.val():""))?t=Y.strToDateTime(t):C.defaultDate&&(t=Y.strToDateTime(C.defaultDate),C.defaultTime&&(e=Y.strtotime(C.defaultTime),t.setHours(e.getHours()),t.setMinutes(e.getMinutes()))),t&&Y.isValidDate(t)?H.data("changed",!0):t="",t||0}function s(t){var n=function(e,t){var a=e.replace(/([\[\]\/\{\}\(\)\-\.\+]{1})/g,"\\$1").replace(/_/g,"{digit+}").replace(/([0-9]{1})/g,"{digit$1}").replace(/\{digit([0-9]{1})\}/g,"[0-$1_]{1}").replace(/\{digit[\+]\}/g,"[0-9_]{1}");return new RegExp(a).test(t)},r=function(e,a){if(!(e="string"==typeof e||e instanceof String?t.ownerDocument.getElementById(e):e))return!1;if(e.createTextRange){var n=e.createTextRange();return n.collapse(!0),n.moveEnd("character",a),n.moveStart("character",a),n.select(),!0}return!!e.setSelectionRange&&(e.setSelectionRange(a,a),!0)};t.mask&&a.off("keydown.xdsoft"),!0===t.mask&&("undefined"!=typeof moment?t.mask=t.format.replace(/Y{4}/g,"9999").replace(/Y{2}/g,"99").replace(/M{2}/g,"19").replace(/D{2}/g,"39").replace(/H{2}/g,"29").replace(/m{2}/g,"59").replace(/s{2}/g,"59"):t.mask=t.format.replace(/Y/g,"9999").replace(/F/g,"9999").replace(/m/g,"19").replace(/d/g,"39").replace(/H/g,"29").replace(/i/g,"59").replace(/s/g,"59")),"string"===e.type(t.mask)&&(n(t.mask,a.val())||(a.val(t.mask.replace(/[0-9]/g,"_")),r(a[0],0)),a.on("paste.xdsoft",function(o){var i=(o.clipboardData||o.originalEvent.clipboardData||window.clipboardData).getData("text"),s=this.value,d=this.selectionStart;return s=s.substr(0,d)+i+s.substr(d+i.length),d+=i.length,n(t.mask,s)?(this.value=s,r(this,d)):""===e.trim(s)?this.value=t.mask.replace(/[0-9]/g,"_"):a.trigger("error_input.xdsoft"),o.preventDefault(),!1}),a.on("keydown.xdsoft",function(o){var i,s=this.value,d=o.which,u=this.selectionStart,C=this.selectionEnd,P=u!==C;if(d>=l&&d<=f||d>=c&&d<=h||d===v||d===g){for(i=d===v||d===g?"_":String.fromCharCode(c<=d&&d<=h?d-l:d),d===v&&u&&!P&&(u-=1);;){var A=t.mask.substr(u,1),Y=u<t.mask.length,j=u>0;if(!(/[^0-9_]/.test(A)&&Y&&j))break;u+=d!==v||P?1:-1}if(P){var H=C-u,J=t.mask.replace(/[0-9]/g,"_"),z=J.substr(u,H).substr(1);s=s.substr(0,u)+(i+z)+s.substr(u+H)}else s=s.substr(0,u)+i+s.substr(u+1);if(""===e.trim(s))s=J;else if(u===t.mask.length)return o.preventDefault(),!1;for(u+=d===v?0:1;/[^0-9_]/.test(t.mask.substr(u,1))&&u<t.mask.length&&u>0;)u+=d===v?0:1;n(t.mask,s)?(this.value=s,r(this,u)):""===e.trim(s)?this.value=t.mask.replace(/[0-9]/g,"_"):a.trigger("error_input.xdsoft")}else if(-1!==[w,M,O,W,_].indexOf(d)&&F||-1!==[y,b,x,D,k,S,m,T,p].indexOf(d))return!0;return o.preventDefault(),!1}))}var d,u,P,A,Y,j,H=e('<div class="xdsoft_datetimepicker xdsoft_noselect"></div>'),J=e('<div class="xdsoft_copyright"><a target="_blank" href="http://xdsoft.net/jqplugins/datetimepicker/">xdsoft.net</a></div>'),z=e('<div class="xdsoft_datepicker active"></div>'),I=e('<div class="xdsoft_monthpicker"><button type="button" class="xdsoft_prev"></button><button type="button" class="xdsoft_today_button"></button><div class="xdsoft_label xdsoft_month"><span></span><i></i></div><div class="xdsoft_label xdsoft_year"><span></span><i></i></div><button type="button" class="xdsoft_next"></button></div>'),N=e('<div class="xdsoft_calendar"></div>'),L=e('<div class="xdsoft_timepicker active"><button type="button" class="xdsoft_prev"></button><div class="xdsoft_time_box"></div><button type="button" class="xdsoft_next"></button></div>'),E=L.find(".xdsoft_time_box").eq(0),R=e('<div class="xdsoft_time_variant"></div>'),V=e('<button type="button" class="xdsoft_save_selected blue-gradient-button">Save Selected</button>'),B=e('<div class="xdsoft_select xdsoft_monthselect"><div></div></div>'),G=e('<div class="xdsoft_select xdsoft_yearselect"><div></div></div>'),U=!1,q=0;C.id&&H.attr("id",C.id),C.style&&H.attr("style",C.style),C.weeks&&H.addClass("xdsoft_showweeks"),C.rtl&&H.addClass("xdsoft_rtl"),H.addClass("xdsoft_"+C.theme),H.addClass(C.className),I.find(".xdsoft_month span").after(B),I.find(".xdsoft_year span").after(G),I.find(".xdsoft_month,.xdsoft_year").on("touchstart mousedown.xdsoft",function(t){var a,n,r=e(this).find(".xdsoft_select").eq(0),o=0,i=0,s=r.is(":visible");for(I.find(".xdsoft_select").hide(),Y.currentTime&&(o=Y.currentTime[e(this).hasClass("xdsoft_month")?"getMonth":"getFullYear"]()),r[s?"hide":"show"](),a=r.find("div.xdsoft_option"),n=0;n<a.length&&a.eq(n).data("value")!==o;n+=1)i+=a[0].offsetHeight;return r.xdsoftScroller(C,i/(r.children()[0].offsetHeight-r[0].clientHeight)),t.stopPropagation(),!1});var X=function(e){this.touchStartPosition=this.touchStartPosition||e.originalEvent.touches[0];var t=e.originalEvent.touches[0],a=Math.abs(this.touchStartPosition.clientX-t.clientX),n=Math.abs(this.touchStartPosition.clientY-t.clientY);Math.sqrt(a*a+n*n)>C.touchMovedThreshold&&(this.touchMoved=!0)};I.find(".xdsoft_select").xdsoftScroller(C).on("touchstart mousedown.xdsoft",function(e){this.touchMoved=!1,this.touchStartPosition=e.originalEvent.touches[0],e.stopPropagation(),e.preventDefault()}).on("touchmove",".xdsoft_option",X).on("touchend mousedown.xdsoft",".xdsoft_option",function(){if(!this.touchMoved){void 0!==Y.currentTime&&null!==Y.currentTime||(Y.currentTime=Y.now());var t=Y.currentTime.getFullYear();Y&&Y.currentTime&&Y.currentTime[e(this).parent().parent().hasClass("xdsoft_monthselect")?"setMonth":"setFullYear"](e(this).data("value")),e(this).parent().parent().hide(),H.trigger("xchange.xdsoft"),C.onChangeMonth&&e.isFunction(C.onChangeMonth)&&C.onChangeMonth.call(H,Y.currentTime,H.data("input")),t!==Y.currentTime.getFullYear()&&e.isFunction(C.onChangeYear)&&C.onChangeYear.call(H,Y.currentTime,H.data("input"))}}),H.getValue=function(){return Y.getCurrentTime()},H.setOptions=function(r){var o={};C=e.extend(!0,{},C,r),r.allowTimes&&e.isArray(r.allowTimes)&&r.allowTimes.length&&(C.allowTimes=e.extend(!0,[],r.allowTimes)),r.weekends&&e.isArray(r.weekends)&&r.weekends.length&&(C.weekends=e.extend(!0,[],r.weekends)),r.allowDates&&e.isArray(r.allowDates)&&r.allowDates.length&&(C.allowDates=e.extend(!0,[],r.allowDates)),r.allowDateRe&&"[object String]"===Object.prototype.toString.call(r.allowDateRe)&&(C.allowDateRe=new RegExp(r.allowDateRe)),r.highlightedDates&&e.isArray(r.highlightedDates)&&r.highlightedDates.length&&(e.each(r.highlightedDates,function(a,r){var i,s=e.map(r.split(","),e.trim),d=new t(n.parseDate(s[0],C.formatDate),s[1],s[2]),u=n.formatDate(d.date,C.formatDate);void 0!==o[u]?(i=o[u].desc)&&i.length&&d.desc&&d.desc.length&&(o[u].desc=i+"\n"+d.desc):o[u]=d}),C.highlightedDates=e.extend(!0,[],o)),r.highlightedPeriods&&e.isArray(r.highlightedPeriods)&&r.highlightedPeriods.length&&(o=e.extend(!0,[],C.highlightedDates),e.each(r.highlightedPeriods,function(a,r){var i,s,d,u,l,f,c;if(e.isArray(r))i=r[0],s=r[1],d=r[2],c=r[3];else{var h=e.map(r.split(","),e.trim);i=n.parseDate(h[0],C.formatDate),s=n.parseDate(h[1],C.formatDate),d=h[2],c=h[3]}for(;i<=s;)u=new t(i,d,c),l=n.formatDate(i,C.formatDate),i.setDate(i.getDate()+1),void 0!==o[l]?(f=o[l].desc)&&f.length&&u.desc&&u.desc.length&&(o[l].desc=f+"\n"+u.desc):o[l]=u}),C.highlightedDates=e.extend(!0,[],o)),r.disabledDates&&e.isArray(r.disabledDates)&&r.disabledDates.length&&(C.disabledDates=e.extend(!0,[],r.disabledDates)),r.disabledWeekDays&&e.isArray(r.disabledWeekDays)&&r.disabledWeekDays.length&&(C.disabledWeekDays=e.extend(!0,[],r.disabledWeekDays)),!C.open&&!C.opened||C.inline||a.trigger("open.xdsoft"),C.inline&&(U=!0,H.addClass("xdsoft_inline"),a.after(H).hide()),C.inverseButton&&(C.next="xdsoft_prev",C.prev="xdsoft_next"),C.datepicker?z.addClass("active"):z.removeClass("active"),C.timepicker?L.addClass("active"):L.removeClass("active"),C.value&&(Y.setCurrentTime(C.value),a&&a.val&&a.val(Y.str)),isNaN(C.dayOfWeekStart)?C.dayOfWeekStart=0:C.dayOfWeekStart=parseInt(C.dayOfWeekStart,10)%7,C.timepickerScrollbar||E.xdsoftScroller(C,"hide"),C.minDate&&/^[\+\-](.*)$/.test(C.minDate)&&(C.minDate=n.formatDate(Y.strToDateTime(C.minDate),C.formatDate)),C.maxDate&&/^[\+\-](.*)$/.test(C.maxDate)&&(C.maxDate=n.formatDate(Y.strToDateTime(C.maxDate),C.formatDate)),C.minDateTime&&/^\+(.*)$/.test(C.minDateTime)&&(C.minDateTime=Y.strToDateTime(C.minDateTime).dateFormat(C.formatDate)),V.toggle(C.showApplyButton),I.find(".xdsoft_today_button").css("visibility",C.todayButton?"visible":"hidden"),I.find("."+C.prev).css("visibility",C.prevButton?"visible":"hidden"),I.find("."+C.next).css("visibility",C.nextButton?"visible":"hidden"),s(C),C.validateOnBlur&&a.off("blur.xdsoft").on("blur.xdsoft",function(){if(C.allowBlank&&(!e.trim(e(this).val()).length||"string"==typeof C.mask&&e.trim(e(this).val())===C.mask.replace(/[0-9]/g,"_")))e(this).val(null),H.data("xdsoft_datetime").empty();else{var t=n.parseDate(e(this).val(),C.format);if(t)e(this).val(n.formatDate(t,C.format));else{var a=+[e(this).val()[0],e(this).val()[1]].join(""),r=+[e(this).val()[2],e(this).val()[3]].join("");!C.datepicker&&C.timepicker&&a>=0&&a<24&&r>=0&&r<60?e(this).val([a,r].map(function(e){return e>9?e:"0"+e}).join(":")):e(this).val(n.formatDate(Y.now(),C.format))}H.data("xdsoft_datetime").setCurrentTime(e(this).val())}H.trigger("changedatetime.xdsoft"),H.trigger("close.xdsoft")}),C.dayOfWeekStartPrev=0===C.dayOfWeekStart?6:C.dayOfWeekStart-1,H.trigger("xchange.xdsoft").trigger("afterOpen.xdsoft")},H.data("options",C).on("touchstart mousedown.xdsoft",function(e){return e.stopPropagation(),e.preventDefault(),G.hide(),B.hide(),!1}),E.append(R),E.xdsoftScroller(C),H.on("afterOpen.xdsoft",function(){E.xdsoftScroller(C)}),H.append(z).append(L),!0!==C.withoutCopyright&&H.append(J),z.append(I).append(N).append(V),e(C.parentID).append(H),Y=new function(){var t=this;t.now=function(e){var a,n,r=new Date;return!e&&C.defaultDate&&(a=t.strToDateTime(C.defaultDate),r.setFullYear(a.getFullYear()),r.setMonth(a.getMonth()),r.setDate(a.getDate())),C.yearOffset&&r.setFullYear(r.getFullYear()+C.yearOffset),!e&&C.defaultTime&&(n=t.strtotime(C.defaultTime),r.setHours(n.getHours()),r.setMinutes(n.getMinutes())),r},t.isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t.setCurrentTime=function(e,a){"string"==typeof e?t.currentTime=t.strToDateTime(e):t.isValidDate(e)?t.currentTime=e:e||a||!C.allowBlank||C.inline?t.currentTime=t.now():t.currentTime=null,H.trigger("xchange.xdsoft")},t.empty=function(){t.currentTime=null},t.getCurrentTime=function(){return t.currentTime},t.nextMonth=function(){void 0!==t.currentTime&&null!==t.currentTime||(t.currentTime=t.now());var a,n=t.currentTime.getMonth()+1;return 12===n&&(t.currentTime.setFullYear(t.currentTime.getFullYear()+1),n=0),a=t.currentTime.getFullYear(),t.currentTime.setDate(Math.min(new Date(t.currentTime.getFullYear(),n+1,0).getDate(),t.currentTime.getDate())),t.currentTime.setMonth(n),C.onChangeMonth&&e.isFunction(C.onChangeMonth)&&C.onChangeMonth.call(H,Y.currentTime,H.data("input")),a!==t.currentTime.getFullYear()&&e.isFunction(C.onChangeYear)&&C.onChangeYear.call(H,Y.currentTime,H.data("input")),H.trigger("xchange.xdsoft"),n},t.prevMonth=function(){void 0!==t.currentTime&&null!==t.currentTime||(t.currentTime=t.now());var a=t.currentTime.getMonth()-1;return-1===a&&(t.currentTime.setFullYear(t.currentTime.getFullYear()-1),a=11),t.currentTime.setDate(Math.min(new Date(t.currentTime.getFullYear(),a+1,0).getDate(),t.currentTime.getDate())),t.currentTime.setMonth(a),C.onChangeMonth&&e.isFunction(C.onChangeMonth)&&C.onChangeMonth.call(H,Y.currentTime,H.data("input")),H.trigger("xchange.xdsoft"),a},t.getWeekOfYear=function(t){if(C.onGetWeekOfYear&&e.isFunction(C.onGetWeekOfYear)){var a=C.onGetWeekOfYear.call(H,t);if(void 0!==a)return a}var n=new Date(t.getFullYear(),0,1);return 4!==n.getDay()&&n.setMonth(0,1+(4-n.getDay()+7)%7),Math.ceil(((t-n)/864e5+n.getDay()+1)/7)},t.strToDateTime=function(e){var a,r,o=[];return e&&e instanceof Date&&t.isValidDate(e)?e:((o=/^([+-]{1})(.*)$/.exec(e))&&(o[2]=n.parseDate(o[2],C.formatDate)),o&&o[2]?(a=o[2].getTime()-6e4*o[2].getTimezoneOffset(),r=new Date(t.now(!0).getTime()+parseInt(o[1]+"1",10)*a)):r=e?n.parseDate(e,C.format):t.now(),t.isValidDate(r)||(r=t.now()),r)},t.strToDate=function(e){if(e&&e instanceof Date&&t.isValidDate(e))return e;var a=e?n.parseDate(e,C.formatDate):t.now(!0);return t.isValidDate(a)||(a=t.now(!0)),a},t.strtotime=function(e){if(e&&e instanceof Date&&t.isValidDate(e))return e;var a=e?n.parseDate(e,C.formatTime):t.now(!0);return t.isValidDate(a)||(a=t.now(!0)),a},t.str=function(){return n.formatDate(t.currentTime,C.format)},t.currentTime=this.now()},V.on("touchend click",function(e){e.preventDefault(),H.data("changed",!0),Y.setCurrentTime(i()),a.val(Y.str()),H.trigger("close.xdsoft")}),I.find(".xdsoft_today_button").on("touchend mousedown.xdsoft",function(){H.data("changed",!0),Y.setCurrentTime(0,!0),H.trigger("afterOpen.xdsoft")}).on("dblclick.xdsoft",function(){var e,t,n=Y.getCurrentTime();n=new Date(n.getFullYear(),n.getMonth(),n.getDate()),e=Y.strToDate(C.minDate),n<(e=new Date(e.getFullYear(),e.getMonth(),e.getDate()))||(t=Y.strToDate(C.maxDate),n>(t=new Date(t.getFullYear(),t.getMonth(),t.getDate()))||(a.val(Y.str()),a.trigger("change"),H.trigger("close.xdsoft")))}),I.find(".xdsoft_prev,.xdsoft_next").on("touchend mousedown.xdsoft",function(){var t=e(this),a=0,n=!1;!function e(r){t.hasClass(C.next)?Y.nextMonth():t.hasClass(C.prev)&&Y.prevMonth(),C.monthChangeSpinner&&(n||(a=setTimeout(e,r||100)))}(500),e([C.ownerDocument.body,C.contentWindow]).on("touchend mouseup.xdsoft",function t(){clearTimeout(a),n=!0,e([C.ownerDocument.body,C.contentWindow]).off("touchend mouseup.xdsoft",t)})}),L.find(".xdsoft_prev,.xdsoft_next").on("touchend mousedown.xdsoft",function(){var t=e(this),a=0,n=!1,r=110;!function e(o){var i=E[0].clientHeight,s=R[0].offsetHeight,d=Math.abs(parseInt(R.css("marginTop"),10));t.hasClass(C.next)&&s-i-C.timeHeightInTimePicker>=d?R.css("marginTop","-"+(d+C.timeHeightInTimePicker)+"px"):t.hasClass(C.prev)&&d-C.timeHeightInTimePicker>=0&&R.css("marginTop","-"+(d-C.timeHeightInTimePicker)+"px"),E.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt(R[0].style.marginTop,10)/(s-i))]),r=r>10?10:r-10,n||(a=setTimeout(e,o||r))}(500),e([C.ownerDocument.body,C.contentWindow]).on("touchend mouseup.xdsoft",function t(){clearTimeout(a),n=!0,e([C.ownerDocument.body,C.contentWindow]).off("touchend mouseup.xdsoft",t)})}),d=0,H.on("xchange.xdsoft",function(t){clearTimeout(d),d=setTimeout(function(){void 0!==Y.currentTime&&null!==Y.currentTime||(Y.currentTime=Y.now());for(var t,i,s,d,u,l,f,c,h,m,g="",p=new Date(Y.currentTime.getFullYear(),Y.currentTime.getMonth(),1,12,0,0),y=0,v=Y.now(),D=!1,b=!1,k=!1,x=[],T=!0,S="";p.getDay()!==C.dayOfWeekStart;)p.setDate(p.getDate()-1);for(g+="<table><thead><tr>",C.weeks&&(g+="<th></th>"),t=0;t<7;t+=1)g+="<th>"+C.i18n[r].dayOfWeekShort[(t+C.dayOfWeekStart)%7]+"</th>";for(g+="</tr></thead>",g+="<tbody>",!1!==C.maxDate&&(D=Y.strToDate(C.maxDate),D=new Date(D.getFullYear(),D.getMonth(),D.getDate(),23,59,59,999)),!1!==C.minDate&&(b=Y.strToDate(C.minDate),b=new Date(b.getFullYear(),b.getMonth(),b.getDate())),!1!==C.minDateTime&&(k=Y.strToDate(C.minDateTime),k=new Date(k.getFullYear(),k.getMonth(),k.getDate(),k.getHours(),k.getMinutes(),k.getSeconds()));y<Y.currentTime.countDaysInMonth()||p.getDay()!==C.dayOfWeekStart||Y.currentTime.getMonth()===p.getMonth();)x=[],y+=1,s=p.getDay(),d=p.getDate(),u=p.getFullYear(),l=p.getMonth(),f=Y.getWeekOfYear(p),m="",x.push("xdsoft_date"),c=C.beforeShowDay&&e.isFunction(C.beforeShowDay.call)?C.beforeShowDay.call(H,p):null,C.allowDateRe&&"[object RegExp]"===Object.prototype.toString.call(C.allowDateRe)&&(C.allowDateRe.test(n.formatDate(p,C.formatDate))||x.push("xdsoft_disabled")),C.allowDates&&C.allowDates.length>0&&-1===C.allowDates.indexOf(n.formatDate(p,C.formatDate))&&x.push("xdsoft_disabled"),(!1!==D&&p>D||!1!==k&&p<k||!1!==b&&p<b||c&&!1===c[0])&&x.push("xdsoft_disabled"),-1!==C.disabledDates.indexOf(n.formatDate(p,C.formatDate))&&x.push("xdsoft_disabled"),-1!==C.disabledWeekDays.indexOf(s)&&x.push("xdsoft_disabled"),a.is("[disabled]")&&x.push("xdsoft_disabled"),c&&""!==c[1]&&x.push(c[1]),Y.currentTime.getMonth()!==l&&x.push("xdsoft_other_month"),(C.defaultSelect||H.data("changed"))&&n.formatDate(Y.currentTime,C.formatDate)===n.formatDate(p,C.formatDate)&&x.push("xdsoft_current"),n.formatDate(v,C.formatDate)===n.formatDate(p,C.formatDate)&&x.push("xdsoft_today"),0!==p.getDay()&&6!==p.getDay()&&-1===C.weekends.indexOf(n.formatDate(p,C.formatDate))||x.push("xdsoft_weekend"),void 0!==C.highlightedDates[n.formatDate(p,C.formatDate)]&&(i=C.highlightedDates[n.formatDate(p,C.formatDate)],x.push(void 0===i.style?"xdsoft_highlighted_default":i.style),m=void 0===i.desc?"":i.desc),C.beforeShowDay&&e.isFunction(C.beforeShowDay)&&x.push(C.beforeShowDay(p)),T&&(g+="<tr>",T=!1,C.weeks&&(g+="<th>"+f+"</th>")),g+='<td data-date="'+d+'" data-month="'+l+'" data-year="'+u+'" class="xdsoft_date xdsoft_day_of_week'+p.getDay()+" "+x.join(" ")+'" title="'+m+'"><div>'+d+"</div></td>",p.getDay()===C.dayOfWeekStartPrev&&(g+="</tr>",T=!0),p.setDate(d+1);if(g+="</tbody></table>",N.html(g),I.find(".xdsoft_label span").eq(0).text(C.i18n[r].months[Y.currentTime.getMonth()]),I.find(".xdsoft_label span").eq(1).text(Y.currentTime.getFullYear()),S="","",l="",h=function(t,r){var o,i,s=Y.now(),d=C.allowTimes&&e.isArray(C.allowTimes)&&C.allowTimes.length;s.setHours(t),t=parseInt(s.getHours(),10),s.setMinutes(r),r=parseInt(s.getMinutes(),10),(o=new Date(Y.currentTime)).setHours(t),o.setMinutes(r),x=[],!1!==C.minDateTime&&C.minDateTime>o||!1!==C.maxTime&&Y.strtotime(C.maxTime).getTime()<s.getTime()||!1!==C.minTime&&Y.strtotime(C.minTime).getTime()>s.getTime()?x.push("xdsoft_disabled"):!1!==C.minDateTime&&C.minDateTime>o||!1!==C.disabledMinTime&&s.getTime()>Y.strtotime(C.disabledMinTime).getTime()&&!1!==C.disabledMaxTime&&s.getTime()<Y.strtotime(C.disabledMaxTime).getTime()?x.push("xdsoft_disabled"):a.is("[disabled]")&&x.push("xdsoft_disabled"),(i=new Date(Y.currentTime)).setHours(parseInt(Y.currentTime.getHours(),10)),d||i.setMinutes(Math[C.roundTime](Y.currentTime.getMinutes()/C.step)*C.step),(C.initTime||C.defaultSelect||H.data("changed"))&&i.getHours()===parseInt(t,10)&&(!d&&C.step>59||i.getMinutes()===parseInt(r,10))&&(C.defaultSelect||H.data("changed")?x.push("xdsoft_current"):C.initTime&&x.push("xdsoft_init_time")),parseInt(v.getHours(),10)===parseInt(t,10)&&parseInt(v.getMinutes(),10)===parseInt(r,10)&&x.push("xdsoft_today"),S+='<div class="xdsoft_time '+x.join(" ")+'" data-hour="'+t+'" data-minute="'+r+'">'+n.formatDate(s,C.formatTime)+"</div>"},C.allowTimes&&e.isArray(C.allowTimes)&&C.allowTimes.length)for(y=0;y<C.allowTimes.length;y+=1)h(Y.strtotime(C.allowTimes[y]).getHours(),l=Y.strtotime(C.allowTimes[y]).getMinutes());else for(y=0,t=0;y<(C.hours12?12:24);y+=1)for(t=0;t<60;t+=C.step)h((y<10?"0":"")+y,l=(t<10?"0":"")+t);for(R.html(S),o="",y=parseInt(C.yearStart,10)+C.yearOffset;y<=parseInt(C.yearEnd,10)+C.yearOffset;y+=1)o+='<div class="xdsoft_option '+(Y.currentTime.getFullYear()===y?"xdsoft_current":"")+'" data-value="'+y+'">'+y+"</div>";for(G.children().eq(0).html(o),y=parseInt(C.monthStart,10),o="";y<=parseInt(C.monthEnd,10);y+=1)o+='<div class="xdsoft_option '+(Y.currentTime.getMonth()===y?"xdsoft_current":"")+'" data-value="'+y+'">'+C.i18n[r].months[y]+"</div>";B.children().eq(0).html(o),e(H).trigger("generate.xdsoft")},10),t.stopPropagation()}).on("afterOpen.xdsoft",function(){if(C.timepicker){var e,t,a,n;R.find(".xdsoft_current").length?e=".xdsoft_current":R.find(".xdsoft_init_time").length&&(e=".xdsoft_init_time"),e?(t=E[0].clientHeight,(a=R[0].offsetHeight)-t<(n=R.find(e).index()*C.timeHeightInTimePicker+1)&&(n=a-t),E.trigger("scroll_element.xdsoft_scroller",[parseInt(n,10)/(a-t)])):E.trigger("scroll_element.xdsoft_scroller",[0])}}),u=0,N.on("touchend click.xdsoft","td",function(t){t.stopPropagation(),u+=1;var n=e(this),r=Y.currentTime;if(void 0!==r&&null!==r||(Y.currentTime=Y.now(),r=Y.currentTime),n.hasClass("xdsoft_disabled"))return!1;r.setDate(1),r.setFullYear(n.data("year")),r.setMonth(n.data("month")),r.setDate(n.data("date")),H.trigger("select.xdsoft",[r]),a.val(Y.str()),C.onSelectDate&&e.isFunction(C.onSelectDate)&&C.onSelectDate.call(H,Y.currentTime,H.data("input"),t),H.data("changed",!0),H.trigger("xchange.xdsoft"),H.trigger("changedatetime.xdsoft"),(u>1||!0===C.closeOnDateSelect||!1===C.closeOnDateSelect&&!C.timepicker)&&!C.inline&&H.trigger("close.xdsoft"),setTimeout(function(){u=0},200)}),R.on("touchstart","div",function(e){this.touchMoved=!1}).on("touchmove","div",X).on("touchend click.xdsoft","div",function(t){if(!this.touchMoved){t.stopPropagation();var a=e(this),n=Y.currentTime;if(void 0!==n&&null!==n||(Y.currentTime=Y.now(),n=Y.currentTime),a.hasClass("xdsoft_disabled"))return!1;n.setHours(a.data("hour")),n.setMinutes(a.data("minute")),H.trigger("select.xdsoft",[n]),H.data("input").val(Y.str()),C.onSelectTime&&e.isFunction(C.onSelectTime)&&C.onSelectTime.call(H,Y.currentTime,H.data("input"),t),H.data("changed",!0),H.trigger("xchange.xdsoft"),H.trigger("changedatetime.xdsoft"),!0!==C.inline&&!0===C.closeOnTimeSelect&&H.trigger("close.xdsoft")}}),z.on("mousewheel.xdsoft",function(e){return!C.scrollMonth||(e.deltaY<0?Y.nextMonth():Y.prevMonth(),!1)}),a.on("mousewheel.xdsoft",function(e){return!C.scrollInput||(!C.datepicker&&C.timepicker?((P=R.find(".xdsoft_current").length?R.find(".xdsoft_current").eq(0).index():0)+e.deltaY>=0&&P+e.deltaY<R.children().length&&(P+=e.deltaY),R.children().eq(P).length&&R.children().eq(P).trigger("mousedown"),!1):C.datepicker&&!C.timepicker?(z.trigger(e,[e.deltaY,e.deltaX,e.deltaY]),a.val&&a.val(Y.str()),H.trigger("changedatetime.xdsoft"),!1):void 0)}),H.on("changedatetime.xdsoft",function(t){if(C.onChangeDateTime&&e.isFunction(C.onChangeDateTime)){var a=H.data("input");C.onChangeDateTime.call(H,Y.currentTime,a,t),delete C.value,a.trigger("change")}}).on("generate.xdsoft",function(){C.onGenerate&&e.isFunction(C.onGenerate)&&C.onGenerate.call(H,Y.currentTime,H.data("input")),U&&(H.trigger("afterOpen.xdsoft"),U=!1)}).on("click.xdsoft",function(e){e.stopPropagation()}),P=0,j=function(e,t){do{if(!(e=e.parentNode)||!1===t(e))break}while("HTML"!==e.nodeName)},A=function(){var t,a,n,r,o,i,s,d,u,l,f,c,h;if(d=H.data("input"),t=d.offset(),a=d[0],l="top",n=t.top+a.offsetHeight-1,r=t.left,o="absolute",u=e(C.contentWindow).width(),c=e(C.contentWindow).height(),h=e(C.contentWindow).scrollTop(),C.ownerDocument.documentElement.clientWidth-t.left<z.parent().outerWidth(!0)){var m=z.parent().outerWidth(!0)-a.offsetWidth;r-=m}"rtl"===d.parent().css("direction")&&(r-=H.outerWidth()-d.outerWidth()),C.fixed?(n-=h,r-=e(C.contentWindow).scrollLeft(),o="fixed"):(s=!1,j(a,function(e){return null!==e&&("fixed"===C.contentWindow.getComputedStyle(e).getPropertyValue("position")?(s=!0,!1):void 0)}),s?(o="fixed",n+H.outerHeight()>c+h?(l="bottom",n=c+h-t.top):n-=h):n+H[0].offsetHeight>c+h&&(n=t.top-H[0].offsetHeight+1),n<0&&(n=0),r+a.offsetWidth>u&&(r=u-a.offsetWidth)),i=H[0],j(i,function(e){if("relative"===C.contentWindow.getComputedStyle(e).getPropertyValue("position")&&u>=e.offsetWidth)return r-=(u-e.offsetWidth)/2,!1}),(f={position:o,left:r,top:"",bottom:""})[l]=n,H.css(f)},H.on("open.xdsoft",function(t){var a=!0;C.onShow&&e.isFunction(C.onShow)&&(a=C.onShow.call(H,Y.currentTime,H.data("input"),t)),!1!==a&&(H.show(),A(),e(C.contentWindow).off("resize.xdsoft",A).on("resize.xdsoft",A),C.closeOnWithoutClick&&e([C.ownerDocument.body,C.contentWindow]).on("touchstart mousedown.xdsoft",function t(){H.trigger("close.xdsoft"),e([C.ownerDocument.body,C.contentWindow]).off("touchstart mousedown.xdsoft",t)}))}).on("close.xdsoft",function(t){var a=!0;I.find(".xdsoft_month,.xdsoft_year").find(".xdsoft_select").hide(),C.onClose&&e.isFunction(C.onClose)&&(a=C.onClose.call(H,Y.currentTime,H.data("input"),t)),!1===a||C.opened||C.inline||H.hide(),t.stopPropagation()}).on("toggle.xdsoft",function(){H.is(":visible")?H.trigger("close.xdsoft"):H.trigger("open.xdsoft")}).data("input",a),q=0,H.data("xdsoft_datetime",Y),H.setOptions(C),Y.setCurrentTime(i()),a.data("xdsoft_datetimepicker",H).on("open.xdsoft focusin.xdsoft mousedown.xdsoft touchstart",function(){a.is(":disabled")||a.data("xdsoft_datetimepicker").is(":visible")&&C.closeOnInputClick||(clearTimeout(q),q=setTimeout(function(){a.is(":disabled")||(U=!0,Y.setCurrentTime(i(),!0),C.mask&&s(C),H.trigger("open.xdsoft"))},100))}).on("keydown.xdsoft",function(t){var a,n=t.which;return-1!==[p].indexOf(n)&&C.enterLikeTab?(a=e("input:visible,textarea:visible,button:visible,a:visible"),H.trigger("close.xdsoft"),a.eq(a.index(this)+1).focus(),!1):-1!==[T].indexOf(n)?(H.trigger("close.xdsoft"),!0):void 0}).on("blur.xdsoft",function(){H.trigger("close.xdsoft")})},d=function(t){var a=t.data("xdsoft_datetimepicker");a&&(a.data("xdsoft_datetime",null),a.remove(),t.data("xdsoft_datetimepicker",null).off(".xdsoft"),e(C.contentWindow).off("resize.xdsoft"),e([C.contentWindow,C.ownerDocument.body]).off("mousedown.xdsoft touchstart"),t.unmousewheel&&t.unmousewheel())},e(C.ownerDocument).off("keydown.xdsoftctrl keyup.xdsoftctrl").on("keydown.xdsoftctrl",function(e){e.keyCode===m&&(F=!0)}).on("keyup.xdsoftctrl",function(e){e.keyCode===m&&(F=!1)}),this.each(function(){var t=e(this).data("xdsoft_datetimepicker");if(t){if("string"===e.type(o))switch(o){case"show":e(this).select().focus(),t.trigger("open.xdsoft");break;case"hide":t.trigger("close.xdsoft");break;case"toggle":t.trigger("toggle.xdsoft");break;case"destroy":d(e(this));break;case"reset":this.value=this.defaultValue,this.value&&t.data("xdsoft_datetime").isValidDate(n.parseDate(this.value,C.format))||t.data("changed",!1),t.data("xdsoft_datetime").setCurrentTime(this.value);break;case"validate":t.data("input").trigger("blur.xdsoft");break;default:t[o]&&e.isFunction(t[o])&&(u=t[o](i))}else t.setOptions(o);return 0}"string"!==e.type(o)&&(!C.lazyInit||C.open||C.inline?s(e(this)):A(e(this)))}),u},e.fn.datetimepicker.defaults=a};!function(e){"function"==typeof define&&define.amd?define(["jquery","jquery-mousewheel"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(datetimepickerFactory),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var i=t||window.event,s=d.call(arguments,1),u=0,f=0,c=0,h=0,m=0,g=0;if(t=e.event.fix(i),t.type="mousewheel","detail"in i&&(c=-1*i.detail),"wheelDelta"in i&&(c=i.wheelDelta),"wheelDeltaY"in i&&(c=i.wheelDeltaY),"wheelDeltaX"in i&&(f=-1*i.wheelDeltaX),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(f=-1*c,c=0),u=0===c?f:c,"deltaY"in i&&(u=c=-1*i.deltaY),"deltaX"in i&&(f=i.deltaX,0===c&&(u=-1*f)),0!==c||0!==f){if(1===i.deltaMode){var p=e.data(this,"mousewheel-line-height");u*=p,c*=p,f*=p}else if(2===i.deltaMode){var y=e.data(this,"mousewheel-page-height");u*=y,c*=y,f*=y}if(h=Math.max(Math.abs(c),Math.abs(f)),(!o||h<o)&&(o=h,n(i,h)&&(o/=40)),n(i,h)&&(u/=40,f/=40,c/=40),u=Math[u>=1?"floor":"ceil"](u/o),f=Math[f>=1?"floor":"ceil"](f/o),c=Math[c>=1?"floor":"ceil"](c/o),l.settings.normalizeOffset&&this.getBoundingClientRect){var v=this.getBoundingClientRect();m=t.clientX-v.left,g=t.clientY-v.top}return t.deltaX=f,t.deltaY=c,t.deltaFactor=o,t.offsetX=m,t.offsetY=g,t.deltaMode=0,s.unshift(t,u,f,c),r&&clearTimeout(r),r=setTimeout(a,200),(e.event.dispatch||e.event.handle).apply(this,s)}}function a(){o=null}function n(e,t){return l.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}var r,o,i=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],d=Array.prototype.slice;if(e.event.fixHooks)for(var u=i.length;u;)e.event.fixHooks[i[--u]]=e.event.mouseHooks;var l=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var a=s.length;a;)this.addEventListener(s[--a],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",l.getLineHeight(this)),e.data(this,"mousewheel-page-height",l.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var a=s.length;a;)this.removeEventListener(s[--a],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var a=e(t),n=a["offsetParent"in e.fn?"offsetParent":"parent"]();return n.length||(n=e("body")),parseInt(n.css("fontSize"),10)||parseInt(a.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})});

(function(){'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};
$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Math.cosh",function(a){if(a)return a;var b=Math.exp;return function(a){a=Number(a);return(b(a)+b(-a))/2}},"es6","es3");$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6","es3");
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).i}},"es6","es3");
$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length;for(c=c||0;c<e;c++)if(b[c]==a||Object.is(b[c],a))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
$jscomp.polyfill("Number.EPSILON",function(a){return Math.pow(2,-52)},"es6","es3");$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=b.length,f=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var g=0;g<f&&c<e;)if(b[c++]!=a[g++])return!1;return g>=f}},"es6","es3");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill("Object.assign",function(a){return a?a:function(a,c){for(var b=1;b<arguments.length;b++){var e=arguments[b];if(e)for(var f in e)$jscomp.owns(e,f)&&(a[f]=e[f])}return a}},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};b.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_=
function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(u){f(u)}}:b}var d,f,g=new e(function(a,
b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(function(){f.asyncExecute(c)})};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,
d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,c(d.value).callWhenSettled_(f(g.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");
$jscomp.polyfill("Number.isFinite",function(a){return a?a:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}},"es6","es3");$jscomp.polyfill("Number.isInteger",function(a){return a?a:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}},"es6","es3");var COMPILED=!0,goog=goog||{};goog.global=this;goog.isDef=function(a){return void 0!==a};goog.isString=function(a){return"string"==typeof a};goog.isBoolean=function(a){return"boolean"==typeof a};
goog.isNumber=function(a){return"number"==typeof a};goog.exportPath_=function(a,b,c){a=a.split(".");c=c||goog.global;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)!a.length&&goog.isDef(b)?c[d]=b:c=c[d]&&c[d]!==Object.prototype[d]?c[d]:c[d]={}};
goog.define=function(a,b){COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&void 0===goog.global.CLOSURE_UNCOMPILED_DEFINES.nodeType&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,a)?b=goog.global.CLOSURE_UNCOMPILED_DEFINES[a]:goog.global.CLOSURE_DEFINES&&void 0===goog.global.CLOSURE_DEFINES.nodeType&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,a)&&(b=goog.global.CLOSURE_DEFINES[a]));goog.exportPath_(a,b)};goog.DEBUG=!0;goog.LOCALE="en";
goog.TRUSTED_SITE=!0;goog.STRICT_MODE_COMPATIBLE=!1;goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG;goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1;goog.provide=function(a){if(goog.isInModuleLoader_())throw Error("goog.provide can not be used within a goog.module.");if(!COMPILED&&goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');goog.constructNamespace_(a)};
goog.constructNamespace_=function(a,b){if(!COMPILED){delete goog.implicitNamespaces_[a];for(var c=a;(c=c.substring(0,c.lastIndexOf(".")))&&!goog.getObjectByName(c);)goog.implicitNamespaces_[c]=!0}goog.exportPath_(a,b)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;
goog.module=function(a){if(!goog.isString(a)||!a||-1==a.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+a+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");
goog.moduleLoaderState_.moduleName=a;if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a]}};goog.module.get=function(a){return goog.module.getInternal_(a)};goog.module.getInternal_=function(a){if(!COMPILED){if(a in goog.loadedModules_)return goog.loadedModules_[a];if(!goog.implicitNamespaces_[a])return a=goog.getObjectByName(a),null!=a?a:null}return null};goog.moduleLoaderState_=null;
goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_};goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0};
goog.setTestOnly=function(a){if(goog.DISALLOW_TEST_ONLY_CODE)throw a=a||"",Error("Importing test-only code into non-debug environment"+(a?": "+a:"."));};goog.forwardDeclare=function(a){};COMPILED||(goog.isProvided_=function(a){return a in goog.loadedModules_||!goog.implicitNamespaces_[a]&&goog.isDefAndNotNull(goog.getObjectByName(a))},goog.implicitNamespaces_={"goog.module":!0});
goog.getObjectByName=function(a,b){a=a.split(".");b=b||goog.global;for(var c;c=a.shift();)if(goog.isDefAndNotNull(b[c]))b=b[c];else return null;return b};goog.globalize=function(a,b){b=b||goog.global;for(var c in a)b[c]=a[c]};
goog.addDependency=function(a,b,c,d){if(goog.DEPENDENCIES_ENABLED){var e;a=a.replace(/\\/g,"/");var f=goog.dependencies_;d&&"boolean"!==typeof d||(d=d?{module:"goog"}:{});for(var g=0;e=b[g];g++)f.nameToPath[e]=a,f.loadFlags[a]=d;for(d=0;b=c[d];d++)a in f.requires||(f.requires[a]={}),f.requires[a][b]=!0}};goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(a){goog.global.console&&goog.global.console.error(a)};
goog.require=function(a){if(!COMPILED){goog.ENABLE_DEBUG_LOADER&&goog.IS_OLD_IE_&&goog.maybeProcessDeferredDep_(a);if(goog.isProvided_(a)){if(goog.isInModuleLoader_())return goog.module.getInternal_(a)}else if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b)goog.writeScripts_(b);else throw a="goog.require could not find: "+a,goog.logToConsole_(a),Error(a);}return null}};goog.basePath="";goog.nullFunction=function(){};
goog.abstractMethod=function(){throw Error("unimplemented abstract method");};goog.addSingletonGetter=function(a){a.instance_=void 0;a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;goog.TRANSPILE="detect";
goog.TRANSPILER="transpile.js";
goog.DEPENDENCIES_ENABLED&&(goog.dependencies_={loadFlags:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return null!=a&&"write"in a},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH)&&goog.isString(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_()){var a=goog.global.document;var b=a.currentScript;a=b?[b]:a.getElementsByTagName("SCRIPT");for(b=
a.length-1;0<=b;--b){var c=a[b].src,d=c.lastIndexOf("?");d=-1==d?c.length:d;if("base.js"==c.substr(d-7,7)){goog.basePath=c.substr(0,d-7);break}}}},goog.importScript_=function(a,b){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_)(a,b)&&(goog.dependencies_.written[a]=!0)},goog.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.oldIeWaiting_=!1,goog.importProcessedScript_=function(a,b,c){goog.importScript_("",'goog.retrieveAndExec_("'+a+'", '+b+", "+c+");")},
goog.queuedModules_=[],goog.wrapModule_=function(a,b){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(b+"\n//# sourceURL="+a+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+b+"\n;return exports});\n//# sourceURL="+a+"\n"},goog.loadQueuedModules_=function(){var a=goog.queuedModules_.length;if(0<a){var b=goog.queuedModules_;goog.queuedModules_=[];for(var c=0;c<a;c++)goog.maybeProcessDeferredPath_(b[c])}goog.oldIeWaiting_=!1},
goog.maybeProcessDeferredDep_=function(a){goog.isDeferredModule_(a)&&goog.allDepsAreAvailable_(a)&&(a=goog.getPathFromDeps_(a),goog.maybeProcessDeferredPath_(goog.basePath+a))},goog.isDeferredModule_=function(a){var b=(a=goog.getPathFromDeps_(a))&&goog.dependencies_.loadFlags[a]||{},c=b.lang||"es3";return a&&("goog"==b.module||goog.needsTranspile_(c))?goog.basePath+a in goog.dependencies_.deferred:!1},goog.allDepsAreAvailable_=function(a){if((a=goog.getPathFromDeps_(a))&&a in goog.dependencies_.requires)for(var b in goog.dependencies_.requires[a])if(!goog.isProvided_(b)&&
!goog.isDeferredModule_(b))return!1;return!0},goog.maybeProcessDeferredPath_=function(a){if(a in goog.dependencies_.deferred){var b=goog.dependencies_.deferred[a];delete goog.dependencies_.deferred[a];goog.globalEval(b)}},goog.loadModuleFromUrl=function(a){goog.retrieveAndExec_(a,!0,!1)},goog.writeScriptSrcNode_=function(a){goog.global.document.write('<script type="text/javascript" src="'+a+'">\x3c/script>')},goog.appendScriptSrcNode_=function(a){var b=goog.global.document,c=b.createElement("script");
c.type="text/javascript";c.src=a;c.defer=!1;c.async=!1;b.head.appendChild(c)},goog.writeScriptTag_=function(a,b){if(goog.inHtmlDocument_()){var c=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==c.readyState){if(/\bdeps.js$/.test(a))return!1;throw Error('Cannot write "'+a+'" after document load');}void 0===b?goog.IS_OLD_IE_?(goog.oldIeWaiting_=!0,b=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ",c.write('<script type="text/javascript" src="'+
a+'"'+b+">\x3c/script>")):goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?goog.appendScriptSrcNode_(a):goog.writeScriptSrcNode_(a):c.write('<script type="text/javascript">'+goog.protectScriptTag_(b)+"\x3c/script>");return!0}return!1},goog.protectScriptTag_=function(a){return a.replace(/<\/(SCRIPT)/ig,"\\x3c/$1")},goog.needsTranspile_=function(a){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;goog.requiresTranspilation_||(goog.requiresTranspilation_=goog.createRequiresTranspilation_());
if(a in goog.requiresTranspilation_)return goog.requiresTranspilation_[a];throw Error("Unknown language mode: "+a);},goog.requiresTranspilation_=null,goog.lastNonModuleScriptIndex_=0,goog.onScriptLoad_=function(a,b){"complete"==a.readyState&&goog.lastNonModuleScriptIndex_==b&&goog.loadQueuedModules_();return!0},goog.writeScripts_=function(a){function b(a){if(!(a in e.written||a in e.visited)){e.visited[a]=!0;if(a in e.requires)for(var f in e.requires[a])if(!goog.isProvided_(f))if(f in e.nameToPath)b(e.nameToPath[f]);
else throw Error("Undefined nameToPath for "+f);a in d||(d[a]=!0,c.push(a))}}var c=[],d={},e=goog.dependencies_;b(a);for(var f=0;f<c.length;f++)a=c[f],goog.dependencies_.written[a]=!0;var g=goog.moduleLoaderState_;goog.moduleLoaderState_=null;for(f=0;f<c.length;f++)if(a=c[f]){var h=e.loadFlags[a]||{},k=goog.needsTranspile_(h.lang||"es3");"goog"==h.module||k?goog.importProcessedScript_(goog.basePath+a,"goog"==h.module,k):goog.importScript_(goog.basePath+a)}else throw goog.moduleLoaderState_=g,Error("Undefined script input");
goog.moduleLoaderState_=g},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));goog.hasBadLetScoping=null;goog.useSafari10Workaround=function(){if(null==goog.hasBadLetScoping){try{var a=!eval('"use strict";let x = 1; function f() { return typeof x; };f() == "number";')}catch(b){a=!1}goog.hasBadLetScoping=a}return goog.hasBadLetScoping};
goog.workaroundSafari10EvalBug=function(a){return"(function(){"+a+"\n;})();\n"};
goog.loadModule=function(a){var b=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0,declareLegacyNamespace:!1};if(goog.isFunction(a))var c=a.call(void 0,{});else if(goog.isString(a))goog.useSafari10Workaround()&&(a=goog.workaroundSafari10EvalBug(a)),c=goog.loadModuleFromSource_.call(void 0,a);else throw Error("Invalid module definition");var d=goog.moduleLoaderState_.moduleName;if(!goog.isString(d)||!d)throw Error('Invalid module name "'+d+'"');goog.moduleLoaderState_.declareLegacyNamespace?
goog.constructNamespace_(d,c):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof c&&null!=c&&Object.seal(c);goog.loadedModules_[d]=c}finally{goog.moduleLoaderState_=b}};goog.loadModuleFromSource_=function(a){eval(a);return{}};goog.normalizePath_=function(a){a=a.split("/");for(var b=0;b<a.length;)"."==a[b]?a.splice(b,1):b&&".."==a[b]&&a[b-1]&&".."!=a[b-1]?a.splice(--b,2):b++;return a.join("/")};
goog.loadFileSync_=function(a){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(a);try{var b=new goog.global.XMLHttpRequest;b.open("get",a,!1);b.send();return 0==b.status||200==b.status?b.responseText:null}catch(c){return null}};
goog.retrieveAndExec_=function(a,b,c){if(!COMPILED){var d=a;a=goog.normalizePath_(a);var e=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_,f=goog.loadFileSync_(a);if(null==f)throw Error('Load of "'+a+'" failed');c&&(f=goog.transpile_.call(goog.global,f,a));f=b?goog.wrapModule_(a,f):f+("\n//# sourceURL="+a);goog.IS_OLD_IE_&&goog.oldIeWaiting_?(goog.dependencies_.deferred[d]=f,goog.queuedModules_.push(d)):e(a,f)}};
goog.transpile_=function(a,b){var c=goog.global.$jscomp;c||(goog.global.$jscomp=c={});var d=c.transpile;if(!d){var e=goog.basePath+goog.TRANSPILER,f=goog.loadFileSync_(e);if(f){eval(f+"\n//# sourceURL="+e);if(goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile;
c=goog.global.$jscomp;d=c.transpile}}d||(d=c.transpile=function(a,b){goog.logToConsole_(b+" requires transpilation but no transpiler was found.");return a});return d(a,b)};
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isFunction=function(a){return"function"==goog.typeOf(a)};
goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(a){return!!a[goog.UID_PROPERTY_]};goog.removeUid=function(a){null!==a&&"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;
goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();b="array"==b?[]:{};for(var c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval){if(null==goog.evalWorksForGlobals_)if(goog.global.eval("var _evalTest_ = 1;"),"undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(d){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1;if(goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,c=b.createElement("SCRIPT");c.type="text/javascript";c.defer=!1;c.appendChild(b.createTextNode(a));
b.body.appendChild(c);b.body.removeChild(c)}}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;
goog.getCssName=function(a,b){if("."==String(a).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+a);var c=function(a){return goog.cssNameMapping_[a]||a},d=function(a){a=a.split("-");for(var b=[],d=0;d<a.length;d++)b.push(c(a[d]));return b.join("-")};d=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:d:function(a){return a};a=b?a+"-"+d(b):d(a);return goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(a):a};
goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){b&&(a=a.replace(/\{\$([^}]+)}/g,function(a,d){return null!=b&&d in b?b[d]:a}));return a};goog.getMsgWithFallback=function(a,b){return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)};goog.exportProperty=function(a,b,c){a[b]=c};
goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.base=function(a,c,f){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return b.prototype[c].apply(a,d)}};
goog.base=function(a,b,c){var d=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!d)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(d.superClass_){for(var e=Array(arguments.length-1),f=1;f<arguments.length;f++)e[f-1]=arguments[f];return d.superClass_.constructor.apply(a,e)}e=Array(arguments.length-2);for(f=2;f<arguments.length;f++)e[f-2]=arguments[f];f=!1;for(var g=a.constructor;g;g=
g.superClass_&&g.superClass_.constructor)if(g.prototype[b]===d)f=!0;else if(f)return g.prototype[b].apply(a,e);if(a[b]===d)return a.constructor.prototype[b].apply(a,e);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(a){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a goog.module.");a.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);
goog.defineClass=function(a,b){var c=b.constructor,d=b.statics;c&&c!=Object.prototype.constructor||(c=function(){throw Error("cannot instantiate an interface (no constructor defined).");});c=goog.defineClass.createSealingConstructor_(c,a);a&&goog.inherits(c,a);delete b.constructor;delete b.statics;goog.defineClass.applyProperties_(c.prototype,b);null!=d&&(d instanceof Function?d(c):goog.defineClass.applyProperties_(c,d));return c};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;
goog.defineClass.createSealingConstructor_=function(a,b){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return a;var c=!goog.defineClass.isUnsealable_(b),d=function(){var b=a.apply(this,arguments)||this;b[goog.UID_PROPERTY_]=b[goog.UID_PROPERTY_];this.constructor===d&&c&&Object.seal instanceof Function&&Object.seal(b);return b};return d};goog.defineClass.isUnsealable_=function(a){return a&&a.prototype&&a.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.defineClass.applyProperties_=function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);for(var d=0;d<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;d++)c=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[d],Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};goog.tagUnsealableClass=function(a){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(a.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";
goog.createRequiresTranspilation_=function(){function a(a,b){d?c[a]=!0:b()?c[a]=!1:d=c[a]=!0}function b(a){try{return!!eval(a)}catch(g){return!1}}var c={es3:!1},d=!1,e=goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"";a("es5",function(){return b("[1,].length==1")});a("es6",function(){var a=e.match(/Edge\/(\d+)(\.\d)*/i);return a&&15>Number(a[1])?!1:b('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')});
a("es6-impl",function(){return!0});a("es7",function(){return b("2 ** 2 == 4")});a("es8",function(){return b("async () => 1, true")});return c};var ol={ASSUME_TOUCH:!1,DEFAULT_MAX_ZOOM:42,DEFAULT_MIN_ZOOM:0,DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD:.5,DEFAULT_TILE_SIZE:256,DEFAULT_WMS_VERSION:"1.3.0",ENABLE_CANVAS:!0,ENABLE_PROJ4JS:!0,ENABLE_RASTER_REPROJECTION:!0,ENABLE_WEBGL:!1,DEBUG_WEBGL:!0,INITIAL_ATLAS_SIZE:256,MAX_ATLAS_SIZE:-1,MOUSEWHEELZOOM_MAXDELTA:1,OVERVIEWMAP_MAX_RATIO:.75,OVERVIEWMAP_MIN_RATIO:.1,RASTER_REPROJECTION_MAX_SOURCE_TILES:100,RASTER_REPROJECTION_MAX_SUBDIVISION:10,RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH:.25,SIMPLIFY_TOLERANCE:.5,
WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK:1024,VERSION:"",inherits:function(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a},nullFunction:function(){},getUid:function(a){return a.ol_uid||(a.ol_uid=++ol.uidCounter_)},uidCounter_:0};ol.AssertionError=function(a){this.message="Assertion failed. See https://openlayers.org/en/"+(ol.VERSION?ol.VERSION.split("-")[0]:"latest")+"/doc/errors/#"+a+" for details.";this.code=a;this.name="AssertionError"};ol.inherits(ol.AssertionError,Error);ol.asserts={};ol.asserts.assert=function(a,b){if(!a)throw new ol.AssertionError(b);};ol.obj={};ol.obj.assign="function"===typeof Object.assign?Object.assign:function(a,b){if(void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(a),d=1,e=arguments.length;d<e;++d){var f=arguments[d];if(void 0!==f&&null!==f)for(var g in f)f.hasOwnProperty(g)&&(c[g]=f[g])}return c};ol.obj.clear=function(a){for(var b in a)delete a[b]};ol.obj.getValues=function(a){var b=[],c;for(c in a)b.push(a[c]);return b};
ol.obj.isEmpty=function(a){for(var b in a)return!1;return!b};ol.events={};ol.events.bindListener_=function(a){var b=function(b){var c=a.listener,e=a.bindTo||a.target;a.callOnce&&ol.events.unlistenByKey(a);return c.call(e,b)};return a.boundListener=b};ol.events.findListener_=function(a,b,c,d){for(var e,f=0,g=a.length;f<g;++f)if(e=a[f],e.listener===b&&e.bindTo===c)return d&&(e.deleteIndex=f),e};ol.events.getListeners=function(a,b){return(a=a.ol_lm)?a[b]:void 0};ol.events.getListenerMap_=function(a){var b=a.ol_lm;b||(b=a.ol_lm={});return b};
ol.events.removeListeners_=function(a,b){var c=ol.events.getListeners(a,b);if(c){for(var d=0,e=c.length;d<e;++d)a.removeEventListener(b,c[d].boundListener),ol.obj.clear(c[d]);c.length=0;if(c=a.ol_lm)delete c[b],0===Object.keys(c).length&&delete a.ol_lm}};
ol.events.listen=function(a,b,c,d,e){var f=ol.events.getListenerMap_(a),g=f[b];g||(g=f[b]=[]);(f=ol.events.findListener_(g,c,d,!1))?e||(f.callOnce=!1):(f={bindTo:d,callOnce:!!e,listener:c,target:a,type:b},a.addEventListener(b,ol.events.bindListener_(f)),g.push(f));return f};ol.events.listenOnce=function(a,b,c,d){return ol.events.listen(a,b,c,d,!0)};ol.events.unlisten=function(a,b,c,d){(a=ol.events.getListeners(a,b))&&(c=ol.events.findListener_(a,c,d,!0))&&ol.events.unlistenByKey(c)};
ol.events.unlistenByKey=function(a){if(a&&a.target){a.target.removeEventListener(a.type,a.boundListener);var b=ol.events.getListeners(a.target,a.type);if(b){var c="deleteIndex"in a?a.deleteIndex:b.indexOf(a);-1!==c&&b.splice(c,1);0===b.length&&ol.events.removeListeners_(a.target,a.type)}ol.obj.clear(a)}};ol.events.unlistenAll=function(a){var b=ol.events.getListenerMap_(a),c;for(c in b)ol.events.removeListeners_(a,c)};ol.events.EventType={CHANGE:"change",CLEAR:"clear",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"};ol.ObjectEventType={PROPERTYCHANGE:"propertychange"};ol.Disposable=function(){};ol.Disposable.prototype.disposed_=!1;ol.Disposable.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())};ol.Disposable.prototype.disposeInternal=ol.nullFunction;ol.events.Event=function(a){this.type=a;this.target=null};ol.events.Event.prototype.preventDefault=ol.events.Event.prototype.stopPropagation=function(){this.propagationStopped=!0};ol.events.Event.stopPropagation=function(a){a.stopPropagation()};ol.events.Event.preventDefault=function(a){a.preventDefault()};ol.events.EventTarget=function(){ol.Disposable.call(this);this.pendingRemovals_={};this.dispatching_={};this.listeners_={}};ol.inherits(ol.events.EventTarget,ol.Disposable);ol.events.EventTarget.prototype.addEventListener=function(a,b){var c=this.listeners_[a];c||(c=this.listeners_[a]=[]);-1===c.indexOf(b)&&c.push(b)};
ol.events.EventTarget.prototype.dispatchEvent=function(a){var b="string"===typeof a?new ol.events.Event(a):a;a=b.type;b.target=this;var c=this.listeners_[a];if(c){a in this.dispatching_||(this.dispatching_[a]=0,this.pendingRemovals_[a]=0);++this.dispatching_[a];for(var d=0,e=c.length;d<e;++d)if(!1===c[d].call(this,b)||b.propagationStopped){var f=!1;break}--this.dispatching_[a];if(0===this.dispatching_[a]){b=this.pendingRemovals_[a];for(delete this.pendingRemovals_[a];b--;)this.removeEventListener(a,
ol.nullFunction);delete this.dispatching_[a]}return f}};ol.events.EventTarget.prototype.disposeInternal=function(){ol.events.unlistenAll(this)};ol.events.EventTarget.prototype.getListeners=function(a){return this.listeners_[a]};ol.events.EventTarget.prototype.hasListener=function(a){return a?a in this.listeners_:0<Object.keys(this.listeners_).length};
ol.events.EventTarget.prototype.removeEventListener=function(a,b){var c=this.listeners_[a];c&&(b=c.indexOf(b),a in this.pendingRemovals_?(c[b]=ol.nullFunction,++this.pendingRemovals_[a]):(c.splice(b,1),0===c.length&&delete this.listeners_[a]))};ol.Observable=function(){ol.events.EventTarget.call(this);this.revision_=0};ol.inherits(ol.Observable,ol.events.EventTarget);ol.Observable.unByKey=function(a){if(Array.isArray(a))for(var b=0,c=a.length;b<c;++b)ol.events.unlistenByKey(a[b]);else ol.events.unlistenByKey(a)};ol.Observable.prototype.changed=function(){++this.revision_;this.dispatchEvent(ol.events.EventType.CHANGE)};ol.Observable.prototype.getRevision=function(){return this.revision_};
ol.Observable.prototype.on=function(a,b,c){if(Array.isArray(a)){for(var d=a.length,e=Array(d),f=0;f<d;++f)e[f]=ol.events.listen(this,a[f],b,c);return e}return ol.events.listen(this,a,b,c)};ol.Observable.prototype.once=function(a,b,c){if(Array.isArray(a)){for(var d=a.length,e=Array(d),f=0;f<d;++f)e[f]=ol.events.listenOnce(this,a[f],b,c);return e}return ol.events.listenOnce(this,a,b,c)};
ol.Observable.prototype.un=function(a,b,c){if(Array.isArray(a))for(var d=0,e=a.length;d<e;++d)ol.events.unlisten(this,a[d],b,c);else ol.events.unlisten(this,a,b,c)};ol.Object=function(a){ol.Observable.call(this);ol.getUid(this);this.values_={};void 0!==a&&this.setProperties(a)};ol.inherits(ol.Object,ol.Observable);ol.Object.changeEventTypeCache_={};ol.Object.getChangeEventType=function(a){return ol.Object.changeEventTypeCache_.hasOwnProperty(a)?ol.Object.changeEventTypeCache_[a]:ol.Object.changeEventTypeCache_[a]="change:"+a};ol.Object.prototype.get=function(a){var b;this.values_.hasOwnProperty(a)&&(b=this.values_[a]);return b};ol.Object.prototype.getKeys=function(){return Object.keys(this.values_)};
ol.Object.prototype.getProperties=function(){return ol.obj.assign({},this.values_)};ol.Object.prototype.notify=function(a,b){var c=ol.Object.getChangeEventType(a);this.dispatchEvent(new ol.Object.Event(c,a,b));c=ol.ObjectEventType.PROPERTYCHANGE;this.dispatchEvent(new ol.Object.Event(c,a,b))};ol.Object.prototype.set=function(a,b,c){c?this.values_[a]=b:(c=this.values_[a],this.values_[a]=b,c!==b&&this.notify(a,c))};ol.Object.prototype.setProperties=function(a,b){for(var c in a)this.set(c,a[c],b)};
ol.Object.prototype.unset=function(a,b){if(a in this.values_){var c=this.values_[a];delete this.values_[a];b||this.notify(a,c)}};ol.Object.Event=function(a,b,c){ol.events.Event.call(this,a);this.key=b;this.oldValue=c};ol.inherits(ol.Object.Event,ol.events.Event);ol.extent={};ol.extent.Corner={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};ol.extent.Relationship={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};ol.extent.boundingExtent=function(a){for(var b=ol.extent.createEmpty(),c=0,d=a.length;c<d;++c)ol.extent.extendCoordinate(b,a[c]);return b};ol.extent.boundingExtentXYs_=function(a,b,c){var d=Math.min.apply(null,a),e=Math.min.apply(null,b);a=Math.max.apply(null,a);b=Math.max.apply(null,b);return ol.extent.createOrUpdate(d,e,a,b,c)};ol.extent.buffer=function(a,b,c){return c?(c[0]=a[0]-b,c[1]=a[1]-b,c[2]=a[2]+b,c[3]=a[3]+b,c):[a[0]-b,a[1]-b,a[2]+b,a[3]+b]};
ol.extent.clone=function(a,b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):a.slice()};ol.extent.closestSquaredDistanceXY=function(a,b,c){b=b<a[0]?a[0]-b:a[2]<b?b-a[2]:0;a=c<a[1]?a[1]-c:a[3]<c?c-a[3]:0;return b*b+a*a};ol.extent.containsCoordinate=function(a,b){return ol.extent.containsXY(a,b[0],b[1])};ol.extent.containsExtent=function(a,b){return a[0]<=b[0]&&b[2]<=a[2]&&a[1]<=b[1]&&b[3]<=a[3]};ol.extent.containsXY=function(a,b,c){return a[0]<=b&&b<=a[2]&&a[1]<=c&&c<=a[3]};
ol.extent.coordinateRelationship=function(a,b){var c=a[1],d=a[2],e=a[3],f=b[0];b=b[1];var g=ol.extent.Relationship.UNKNOWN;f<a[0]?g|=ol.extent.Relationship.LEFT:f>d&&(g|=ol.extent.Relationship.RIGHT);b<c?g|=ol.extent.Relationship.BELOW:b>e&&(g|=ol.extent.Relationship.ABOVE);g===ol.extent.Relationship.UNKNOWN&&(g=ol.extent.Relationship.INTERSECTING);return g};ol.extent.createEmpty=function(){return[Infinity,Infinity,-Infinity,-Infinity]};
ol.extent.createOrUpdate=function(a,b,c,d,e){return e?(e[0]=a,e[1]=b,e[2]=c,e[3]=d,e):[a,b,c,d]};ol.extent.createOrUpdateEmpty=function(a){return ol.extent.createOrUpdate(Infinity,Infinity,-Infinity,-Infinity,a)};ol.extent.createOrUpdateFromCoordinate=function(a,b){var c=a[0];a=a[1];return ol.extent.createOrUpdate(c,a,c,a,b)};ol.extent.createOrUpdateFromCoordinates=function(a,b){b=ol.extent.createOrUpdateEmpty(b);return ol.extent.extendCoordinates(b,a)};
ol.extent.createOrUpdateFromFlatCoordinates=function(a,b,c,d,e){e=ol.extent.createOrUpdateEmpty(e);return ol.extent.extendFlatCoordinates(e,a,b,c,d)};ol.extent.createOrUpdateFromRings=function(a,b){b=ol.extent.createOrUpdateEmpty(b);return ol.extent.extendRings(b,a)};ol.extent.equals=function(a,b){return a[0]==b[0]&&a[2]==b[2]&&a[1]==b[1]&&a[3]==b[3]};ol.extent.extend=function(a,b){b[0]<a[0]&&(a[0]=b[0]);b[2]>a[2]&&(a[2]=b[2]);b[1]<a[1]&&(a[1]=b[1]);b[3]>a[3]&&(a[3]=b[3]);return a};
ol.extent.extendCoordinate=function(a,b){b[0]<a[0]&&(a[0]=b[0]);b[0]>a[2]&&(a[2]=b[0]);b[1]<a[1]&&(a[1]=b[1]);b[1]>a[3]&&(a[3]=b[1])};ol.extent.extendCoordinates=function(a,b){var c;var d=0;for(c=b.length;d<c;++d)ol.extent.extendCoordinate(a,b[d]);return a};ol.extent.extendFlatCoordinates=function(a,b,c,d,e){for(;c<d;c+=e)ol.extent.extendXY(a,b[c],b[c+1]);return a};ol.extent.extendRings=function(a,b){var c;var d=0;for(c=b.length;d<c;++d)ol.extent.extendCoordinates(a,b[d]);return a};
ol.extent.extendXY=function(a,b,c){a[0]=Math.min(a[0],b);a[1]=Math.min(a[1],c);a[2]=Math.max(a[2],b);a[3]=Math.max(a[3],c)};ol.extent.forEachCorner=function(a,b,c){var d;return(d=b.call(c,ol.extent.getBottomLeft(a)))||(d=b.call(c,ol.extent.getBottomRight(a)))||(d=b.call(c,ol.extent.getTopRight(a)))?d:(d=b.call(c,ol.extent.getTopLeft(a)))?d:!1};ol.extent.getArea=function(a){var b=0;ol.extent.isEmpty(a)||(b=ol.extent.getWidth(a)*ol.extent.getHeight(a));return b};
ol.extent.getBottomLeft=function(a){return[a[0],a[1]]};ol.extent.getBottomRight=function(a){return[a[2],a[1]]};ol.extent.getCenter=function(a){return[(a[0]+a[2])/2,(a[1]+a[3])/2]};ol.extent.getCorner=function(a,b){var c;b===ol.extent.Corner.BOTTOM_LEFT?c=ol.extent.getBottomLeft(a):b===ol.extent.Corner.BOTTOM_RIGHT?c=ol.extent.getBottomRight(a):b===ol.extent.Corner.TOP_LEFT?c=ol.extent.getTopLeft(a):b===ol.extent.Corner.TOP_RIGHT?c=ol.extent.getTopRight(a):ol.asserts.assert(!1,13);return c};
ol.extent.getEnlargedArea=function(a,b){return(Math.max(a[2],b[2])-Math.min(a[0],b[0]))*(Math.max(a[3],b[3])-Math.min(a[1],b[1]))};ol.extent.getForViewAndSize=function(a,b,c,d,e){var f=b*d[0]/2;d=b*d[1]/2;b=Math.cos(c);var g=Math.sin(c);c=f*b;f*=g;b*=d;var h=d*g,k=a[0],l=a[1];a=k-c+h;d=k-c-h;g=k+c-h;c=k+c+h;h=l-f-b;k=l-f+b;var m=l+f+b;f=l+f-b;return ol.extent.createOrUpdate(Math.min(a,d,g,c),Math.min(h,k,m,f),Math.max(a,d,g,c),Math.max(h,k,m,f),e)};ol.extent.getHeight=function(a){return a[3]-a[1]};
ol.extent.getIntersectionArea=function(a,b){a=ol.extent.getIntersection(a,b);return ol.extent.getArea(a)};ol.extent.getIntersection=function(a,b,c){c=c?c:ol.extent.createEmpty();ol.extent.intersects(a,b)&&(c[0]=a[0]>b[0]?a[0]:b[0],c[1]=a[1]>b[1]?a[1]:b[1],c[2]=a[2]<b[2]?a[2]:b[2],c[3]=a[3]<b[3]?a[3]:b[3]);return c};ol.extent.getMargin=function(a){return ol.extent.getWidth(a)+ol.extent.getHeight(a)};ol.extent.getSize=function(a){return[a[2]-a[0],a[3]-a[1]]};
ol.extent.getTopLeft=function(a){return[a[0],a[3]]};ol.extent.getTopRight=function(a){return[a[2],a[3]]};ol.extent.getWidth=function(a){return a[2]-a[0]};ol.extent.intersects=function(a,b){return a[0]<=b[2]&&a[2]>=b[0]&&a[1]<=b[3]&&a[3]>=b[1]};ol.extent.isEmpty=function(a){return a[2]<a[0]||a[3]<a[1]};ol.extent.returnOrUpdate=function(a,b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):a};
ol.extent.scaleFromCenter=function(a,b){var c=(a[2]-a[0])/2*(b-1);b=(a[3]-a[1])/2*(b-1);a[0]-=c;a[2]+=c;a[1]-=b;a[3]+=b};
ol.extent.intersectsSegment=function(a,b,c){var d=!1,e=ol.extent.coordinateRelationship(a,b),f=ol.extent.coordinateRelationship(a,c);if(e===ol.extent.Relationship.INTERSECTING||f===ol.extent.Relationship.INTERSECTING)d=!0;else{var g=a[0],h=a[1],k=a[2];a=a[3];var l=c[0];c=c[1];b=(c-b[1])/(l-b[0]);f&ol.extent.Relationship.ABOVE&&!(e&ol.extent.Relationship.ABOVE)&&(d=l-(c-a)/b,d=d>=g&&d<=k);d||!(f&ol.extent.Relationship.RIGHT)||e&ol.extent.Relationship.RIGHT||(d=c-(l-k)*b,d=d>=h&&d<=a);d||!(f&ol.extent.Relationship.BELOW)||
e&ol.extent.Relationship.BELOW||(d=l-(c-h)/b,d=d>=g&&d<=k);d||!(f&ol.extent.Relationship.LEFT)||e&ol.extent.Relationship.LEFT||(d=c-(l-g)*b,d=d>=h&&d<=a)}return d};ol.extent.applyTransform=function(a,b,c){a=[a[0],a[1],a[0],a[3],a[2],a[1],a[2],a[3]];b(a,a,2);return ol.extent.boundingExtentXYs_([a[0],a[2],a[4],a[6]],[a[1],a[3],a[5],a[7]],c)};ol.functions={};ol.functions.TRUE=function(){return!0};ol.functions.FALSE=function(){return!1};ol.geom={};ol.geom.flat={};ol.geom.flat.transform={};ol.geom.flat.transform.transform2D=function(a,b,c,d,e,f){for(var g=f?f:[],h=0;b<c;b+=d){var k=a[b],l=a[b+1];g[h++]=e[0]*k+e[2]*l+e[4];g[h++]=e[1]*k+e[3]*l+e[5]}f&&g.length!=h&&(g.length=h);return g};
ol.geom.flat.transform.rotate=function(a,b,c,d,e,f,g){var h=g?g:[],k=Math.cos(e);e=Math.sin(e);var l=f[0];f=f[1];for(var m=0;b<c;b+=d){var n=a[b]-l,p=a[b+1]-f;h[m++]=l+n*k-p*e;h[m++]=f+n*e+p*k;for(n=b+2;n<b+d;++n)h[m++]=a[n]}g&&h.length!=m&&(h.length=m);return h};ol.geom.flat.transform.scale=function(a,b,c,d,e,f,g,h){var k=h?h:[],l=g[0];g=g[1];for(var m=0;b<c;b+=d){var n=a[b]-l,p=a[b+1]-g;k[m++]=l+e*n;k[m++]=g+f*p;for(n=b+2;n<b+d;++n)k[m++]=a[n]}h&&k.length!=m&&(k.length=m);return k};
ol.geom.flat.transform.translate=function(a,b,c,d,e,f,g){for(var h=g?g:[],k=0,l;b<c;b+=d)for(h[k++]=a[b]+e,h[k++]=a[b+1]+f,l=b+2;l<b+d;++l)h[k++]=a[l];g&&h.length!=k&&(h.length=k);return h};ol.math={};ol.math.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};ol.math.cosh=function(){return"cosh"in Math?Math.cosh:function(a){a=Math.exp(a);return(a+1/a)/2}}();ol.math.roundUpToPowerOfTwo=function(a){ol.asserts.assert(0<a,29);return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))};ol.math.squaredSegmentDistance=function(a,b,c,d,e,f){var g=e-c,h=f-d;if(0!==g||0!==h){var k=((a-c)*g+(b-d)*h)/(g*g+h*h);1<k?(c=e,d=f):0<k&&(c+=g*k,d+=h*k)}return ol.math.squaredDistance(a,b,c,d)};
ol.math.squaredDistance=function(a,b,c,d){a=c-a;b=d-b;return a*a+b*b};ol.math.solveLinearSystem=function(a){for(var b=a.length,c=0;c<b;c++){for(var d=c,e=Math.abs(a[c][c]),f=c+1;f<b;f++){var g=Math.abs(a[f][c]);g>e&&(e=g,d=f)}if(0===e)return null;e=a[d];a[d]=a[c];a[c]=e;for(d=c+1;d<b;d++)for(e=-a[d][c]/a[c][c],f=c;f<b+1;f++)a[d][f]=c==f?0:a[d][f]+e*a[c][f]}c=Array(b);for(d=b-1;0<=d;d--)for(c[d]=a[d][b]/a[d][d],e=d-1;0<=e;e--)a[e][b]-=a[e][d]*c[d];return c};
ol.math.toDegrees=function(a){return 180*a/Math.PI};ol.math.toRadians=function(a){return a*Math.PI/180};ol.math.modulo=function(a,b){a%=b;return 0>a*b?a+b:a};ol.math.lerp=function(a,b,c){return a+c*(b-a)};ol.geom.GeometryType={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};/*

 Latitude/longitude spherical geodesy formulae taken from
 http://www.movable-type.co.uk/scripts/latlong.html
 Licensed under CC-BY-3.0.
*/
ol.Sphere=function(a){this.radius=a};ol.Sphere.prototype.geodesicArea=function(a){return ol.Sphere.getArea_(a,this.radius)};ol.Sphere.prototype.haversineDistance=function(a,b){return ol.Sphere.getDistance_(a,b,this.radius)};
ol.Sphere.prototype.offset=function(a,b,c){var d=ol.math.toRadians(a[1]);a=ol.math.toRadians(a[0]);b/=this.radius;var e=Math.asin(Math.sin(d)*Math.cos(b)+Math.cos(d)*Math.sin(b)*Math.cos(c));return[ol.math.toDegrees(a+Math.atan2(Math.sin(c)*Math.sin(b)*Math.cos(d),Math.cos(b)-Math.sin(d)*Math.sin(e))),ol.math.toDegrees(e)]};ol.Sphere.DEFAULT_RADIUS=6371008.8;
ol.Sphere.getLength=function(a,b){var c=b||{},d=c.radius||ol.Sphere.DEFAULT_RADIUS;c=c.projection||"EPSG:3857";a=a.clone().transform(c,"EPSG:4326");var e=a.getType();c=0;var f;switch(e){case ol.geom.GeometryType.POINT:case ol.geom.GeometryType.MULTI_POINT:break;case ol.geom.GeometryType.LINE_STRING:case ol.geom.GeometryType.LINEAR_RING:b=a.getCoordinates();c=ol.Sphere.getLength_(b,d);break;case ol.geom.GeometryType.MULTI_LINE_STRING:case ol.geom.GeometryType.POLYGON:b=a.getCoordinates();a=0;for(e=
b.length;a<e;++a)c+=ol.Sphere.getLength_(b[a],d);break;case ol.geom.GeometryType.MULTI_POLYGON:b=a.getCoordinates();a=0;for(e=b.length;a<e;++a){var g=b[a];var h=0;for(f=g.length;h<f;++h)c+=ol.Sphere.getLength_(g[h],d)}break;case ol.geom.GeometryType.GEOMETRY_COLLECTION:d=a.getGeometries();a=0;for(e=d.length;a<e;++a)c+=ol.Sphere.getLength(d[a],b);break;default:throw Error("Unsupported geometry type: "+e);}return c};
ol.Sphere.getLength_=function(a,b){for(var c=0,d=0,e=a.length;d<e-1;++d)c+=ol.Sphere.getDistance_(a[d],a[d+1],b);return c};ol.Sphere.getDistance_=function(a,b,c){var d=ol.math.toRadians(a[1]),e=ol.math.toRadians(b[1]),f=(e-d)/2;a=ol.math.toRadians(b[0]-a[0])/2;d=Math.sin(f)*Math.sin(f)+Math.sin(a)*Math.sin(a)*Math.cos(d)*Math.cos(e);return 2*c*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))};
ol.Sphere.getArea=function(a,b){var c=b||{},d=c.radius||ol.Sphere.DEFAULT_RADIUS;c=c.projection||"EPSG:3857";a=a.clone().transform(c,"EPSG:4326");var e=a.getType();c=0;var f;switch(e){case ol.geom.GeometryType.POINT:case ol.geom.GeometryType.MULTI_POINT:case ol.geom.GeometryType.LINE_STRING:case ol.geom.GeometryType.MULTI_LINE_STRING:case ol.geom.GeometryType.LINEAR_RING:break;case ol.geom.GeometryType.POLYGON:b=a.getCoordinates();c=Math.abs(ol.Sphere.getArea_(b[0],d));a=1;for(e=b.length;a<e;++a)c-=
Math.abs(ol.Sphere.getArea_(b[a],d));break;case ol.geom.GeometryType.MULTI_POLYGON:b=a.getCoordinates();a=0;for(e=b.length;a<e;++a){var g=b[a];c+=Math.abs(ol.Sphere.getArea_(g[0],d));var h=1;for(f=g.length;h<f;++h)c-=Math.abs(ol.Sphere.getArea_(g[h],d))}break;case ol.geom.GeometryType.GEOMETRY_COLLECTION:d=a.getGeometries();a=0;for(e=d.length;a<e;++a)c+=ol.Sphere.getArea(d[a],b);break;default:throw Error("Unsupported geometry type: "+e);}return c};
ol.Sphere.getArea_=function(a,b){for(var c=0,d=a.length,e=a[d-1][0],f=a[d-1][1],g=0;g<d;g++){var h=a[g][0],k=a[g][1];c+=ol.math.toRadians(h-e)*(2+Math.sin(ol.math.toRadians(f))+Math.sin(ol.math.toRadians(k)));e=h;f=k}return c*b*b/2};ol.proj={};ol.proj.Units={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"};ol.proj.Units.METERS_PER_UNIT={};ol.proj.Units.METERS_PER_UNIT[ol.proj.Units.DEGREES]=12741994*Math.PI/360;ol.proj.Units.METERS_PER_UNIT[ol.proj.Units.FEET]=.3048;ol.proj.Units.METERS_PER_UNIT[ol.proj.Units.METERS]=1;ol.proj.Units.METERS_PER_UNIT[ol.proj.Units.USFEET]=1200/3937;ol.proj.proj4={};ol.proj.proj4.cache_=null;ol.proj.proj4.set=function(a){ol.proj.proj4.cache_=a};ol.proj.proj4.get=function(){return ol.proj.proj4.cache_||window.proj4};ol.proj.Projection=function(a){this.code_=a.code;this.units_=a.units;this.extent_=void 0!==a.extent?a.extent:null;this.worldExtent_=void 0!==a.worldExtent?a.worldExtent:null;this.axisOrientation_=void 0!==a.axisOrientation?a.axisOrientation:"enu";this.global_=void 0!==a.global?a.global:!1;this.canWrapX_=!(!this.global_||!this.extent_);this.getPointResolutionFunc_=a.getPointResolution;this.defaultTileGrid_=null;this.metersPerUnit_=a.metersPerUnit;var b=a.code;if(ol.ENABLE_PROJ4JS){var c=ol.proj.proj4.get();
"function"==typeof c&&(b=c.defs(b),void 0!==b&&(void 0!==b.axis&&void 0===a.axisOrientation&&(this.axisOrientation_=b.axis),void 0===a.metersPerUnit&&(this.metersPerUnit_=b.to_meter),void 0===a.units&&(this.units_=b.units)))}};ol.proj.Projection.prototype.canWrapX=function(){return this.canWrapX_};ol.proj.Projection.prototype.getCode=function(){return this.code_};ol.proj.Projection.prototype.getExtent=function(){return this.extent_};ol.proj.Projection.prototype.getUnits=function(){return this.units_};
ol.proj.Projection.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||ol.proj.Units.METERS_PER_UNIT[this.units_]};ol.proj.Projection.prototype.getWorldExtent=function(){return this.worldExtent_};ol.proj.Projection.prototype.getAxisOrientation=function(){return this.axisOrientation_};ol.proj.Projection.prototype.isGlobal=function(){return this.global_};ol.proj.Projection.prototype.setGlobal=function(a){this.global_=a;this.canWrapX_=!(!a||!this.extent_)};
ol.proj.Projection.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_};ol.proj.Projection.prototype.setDefaultTileGrid=function(a){this.defaultTileGrid_=a};ol.proj.Projection.prototype.setExtent=function(a){this.extent_=a;this.canWrapX_=!(!this.global_||!a)};ol.proj.Projection.prototype.setWorldExtent=function(a){this.worldExtent_=a};ol.proj.Projection.prototype.setGetPointResolution=function(a){this.getPointResolutionFunc_=a};
ol.proj.Projection.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};ol.proj.EPSG3857={};ol.proj.EPSG3857.Projection_=function(a){ol.proj.Projection.call(this,{code:a,units:ol.proj.Units.METERS,extent:ol.proj.EPSG3857.EXTENT,global:!0,worldExtent:ol.proj.EPSG3857.WORLD_EXTENT,getPointResolution:function(a,c){return a/ol.math.cosh(c[1]/ol.proj.EPSG3857.RADIUS)}})};ol.inherits(ol.proj.EPSG3857.Projection_,ol.proj.Projection);ol.proj.EPSG3857.RADIUS=6378137;ol.proj.EPSG3857.HALF_SIZE=Math.PI*ol.proj.EPSG3857.RADIUS;
ol.proj.EPSG3857.EXTENT=[-ol.proj.EPSG3857.HALF_SIZE,-ol.proj.EPSG3857.HALF_SIZE,ol.proj.EPSG3857.HALF_SIZE,ol.proj.EPSG3857.HALF_SIZE];ol.proj.EPSG3857.WORLD_EXTENT=[-180,-85,180,85];
ol.proj.EPSG3857.PROJECTIONS=[new ol.proj.EPSG3857.Projection_("EPSG:3857"),new ol.proj.EPSG3857.Projection_("EPSG:102100"),new ol.proj.EPSG3857.Projection_("EPSG:102113"),new ol.proj.EPSG3857.Projection_("EPSG:900913"),new ol.proj.EPSG3857.Projection_("urn:ogc:def:crs:EPSG:6.18:3:3857"),new ol.proj.EPSG3857.Projection_("urn:ogc:def:crs:EPSG::3857"),new ol.proj.EPSG3857.Projection_("http://www.opengis.net/gml/srs/epsg.xml#3857")];
ol.proj.EPSG3857.fromEPSG4326=function(a,b,c){var d=a.length;c=1<c?c:2;void 0===b&&(b=2<c?a.slice():Array(d));for(var e=ol.proj.EPSG3857.HALF_SIZE,f=0;f<d;f+=c){b[f]=e*a[f]/180;var g=ol.proj.EPSG3857.RADIUS*Math.log(Math.tan(Math.PI*(a[f+1]+90)/360));g>e?g=e:g<-e&&(g=-e);b[f+1]=g}return b};
ol.proj.EPSG3857.toEPSG4326=function(a,b,c){var d=a.length;c=1<c?c:2;void 0===b&&(b=2<c?a.slice():Array(d));for(var e=0;e<d;e+=c)b[e]=180*a[e]/ol.proj.EPSG3857.HALF_SIZE,b[e+1]=360*Math.atan(Math.exp(a[e+1]/ol.proj.EPSG3857.RADIUS))/Math.PI-90;return b};ol.proj.EPSG4326={};ol.proj.EPSG4326.Projection_=function(a,b){ol.proj.Projection.call(this,{code:a,units:ol.proj.Units.DEGREES,extent:ol.proj.EPSG4326.EXTENT,axisOrientation:b,global:!0,metersPerUnit:ol.proj.EPSG4326.METERS_PER_UNIT,worldExtent:ol.proj.EPSG4326.EXTENT})};ol.inherits(ol.proj.EPSG4326.Projection_,ol.proj.Projection);ol.proj.EPSG4326.RADIUS=6378137;ol.proj.EPSG4326.EXTENT=[-180,-90,180,90];ol.proj.EPSG4326.METERS_PER_UNIT=Math.PI*ol.proj.EPSG4326.RADIUS/180;
ol.proj.EPSG4326.PROJECTIONS=[new ol.proj.EPSG4326.Projection_("CRS:84"),new ol.proj.EPSG4326.Projection_("EPSG:4326","neu"),new ol.proj.EPSG4326.Projection_("urn:ogc:def:crs:EPSG::4326","neu"),new ol.proj.EPSG4326.Projection_("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new ol.proj.EPSG4326.Projection_("urn:ogc:def:crs:OGC:1.3:CRS84"),new ol.proj.EPSG4326.Projection_("urn:ogc:def:crs:OGC:2:84"),new ol.proj.EPSG4326.Projection_("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ol.proj.EPSG4326.Projection_("urn:x-ogc:def:crs:EPSG:4326",
"neu")];ol.proj.projections={};ol.proj.projections.cache_={};ol.proj.projections.clear=function(){ol.proj.projections.cache_={}};ol.proj.projections.get=function(a){return ol.proj.projections.cache_[a]||null};ol.proj.projections.add=function(a,b){ol.proj.projections.cache_[a]=b};ol.proj.transforms={};ol.proj.transforms.cache_={};ol.proj.transforms.clear=function(){ol.proj.transforms.cache_={}};ol.proj.transforms.add=function(a,b,c){a=a.getCode();b=b.getCode();var d=ol.proj.transforms.cache_;a in d||(d[a]={});d[a][b]=c};ol.proj.transforms.remove=function(a,b){a=a.getCode();b=b.getCode();var c=ol.proj.transforms.cache_,d=c[a][b];delete c[a][b];ol.obj.isEmpty(c[a])&&delete c[a];return d};
ol.proj.transforms.get=function(a,b){var c,d=ol.proj.transforms.cache_;a in d&&b in d[a]&&(c=d[a][b]);return c};ol.proj.METERS_PER_UNIT=ol.proj.Units.METERS_PER_UNIT;ol.proj.SPHERE_=new ol.Sphere(ol.Sphere.DEFAULT_RADIUS);ol.ENABLE_PROJ4JS&&(ol.proj.setProj4=function(a){ol.proj.proj4.set(a)});
ol.proj.getPointResolution=function(a,b,c,d){a=ol.proj.get(a);var e=a.getPointResolutionFunc();e?b=e(b,c):a.getUnits()==ol.proj.Units.DEGREES&&!d||d==ol.proj.Units.DEGREES||(e=ol.proj.getTransformFromProjections(a,ol.proj.get("EPSG:4326")),b=[c[0]-b/2,c[1],c[0]+b/2,c[1],c[0],c[1]-b/2,c[0],c[1]+b/2],b=e(b,b,2),c=ol.proj.SPHERE_.haversineDistance(b.slice(0,2),b.slice(2,4)),b=ol.proj.SPHERE_.haversineDistance(b.slice(4,6),b.slice(6,8)),b=(c+b)/2,a=d?ol.proj.Units.METERS_PER_UNIT[d]:a.getMetersPerUnit(),
void 0!==a&&(b/=a));return b};ol.proj.addEquivalentProjections=function(a){ol.proj.addProjections(a);a.forEach(function(b){a.forEach(function(a){b!==a&&ol.proj.transforms.add(b,a,ol.proj.cloneTransform)})})};ol.proj.addEquivalentTransforms=function(a,b,c,d){a.forEach(function(a){b.forEach(function(b){ol.proj.transforms.add(a,b,c);ol.proj.transforms.add(b,a,d)})})};ol.proj.addProjection=function(a){ol.proj.projections.add(a.getCode(),a);ol.proj.transforms.add(a,a,ol.proj.cloneTransform)};
ol.proj.addProjections=function(a){a.forEach(ol.proj.addProjection)};ol.proj.clearAllProjections=function(){ol.proj.projections.clear();ol.proj.transforms.clear()};ol.proj.createProjection=function(a,b){return a?"string"===typeof a?ol.proj.get(a):a:ol.proj.get(b)};ol.proj.addCoordinateTransforms=function(a,b,c,d){a=ol.proj.get(a);b=ol.proj.get(b);ol.proj.transforms.add(a,b,ol.proj.createTransformFromCoordinateTransform(c));ol.proj.transforms.add(b,a,ol.proj.createTransformFromCoordinateTransform(d))};
ol.proj.createTransformFromCoordinateTransform=function(a){return function(b,c,d){var e=b.length;d=void 0!==d?d:2;c=void 0!==c?c:Array(e);var f;for(f=0;f<e;f+=d){var g=a([b[f],b[f+1]]);c[f]=g[0];c[f+1]=g[1];for(g=d-1;2<=g;--g)c[f+g]=b[f+g]}return c}};ol.proj.fromLonLat=function(a,b){return ol.proj.transform(a,"EPSG:4326",void 0!==b?b:"EPSG:3857")};ol.proj.toLonLat=function(a,b){a=ol.proj.transform(a,void 0!==b?b:"EPSG:3857","EPSG:4326");b=a[0];if(-180>b||180<b)a[0]=ol.math.modulo(b+180,360)-180;return a};
ol.proj.get=function(a){var b=null;if(a instanceof ol.proj.Projection)b=a;else if("string"===typeof a&&(b=ol.proj.projections.get(a),ol.ENABLE_PROJ4JS&&!b)){var c=ol.proj.proj4.get();"function"==typeof c&&void 0!==c.defs(a)&&(b=new ol.proj.Projection({code:a}),ol.proj.addProjection(b))}return b};ol.proj.equivalent=function(a,b){if(a===b)return!0;var c=a.getUnits()===b.getUnits();return a.getCode()===b.getCode()?c:ol.proj.getTransformFromProjections(a,b)===ol.proj.cloneTransform&&c};
ol.proj.getTransform=function(a,b){a=ol.proj.get(a);b=ol.proj.get(b);return ol.proj.getTransformFromProjections(a,b)};
ol.proj.getTransformFromProjections=function(a,b){var c=a.getCode(),d=b.getCode(),e=ol.proj.transforms.get(c,d);if(ol.ENABLE_PROJ4JS&&!e){var f=ol.proj.proj4.get();if("function"==typeof f){var g=f.defs(c),h=f.defs(d);void 0!==g&&void 0!==h&&(g===h?ol.proj.addEquivalentProjections([b,a]):(e=f(d,c),ol.proj.addCoordinateTransforms(b,a,e.forward,e.inverse)),e=ol.proj.transforms.get(c,d))}}e||(e=ol.proj.identityTransform);return e};
ol.proj.identityTransform=function(a,b,c){if(void 0!==b&&a!==b){c=0;for(var d=a.length;c<d;++c)b[c]=a[c];a=b}return a};ol.proj.cloneTransform=function(a,b,c){if(void 0!==b){c=0;for(var d=a.length;c<d;++c)b[c]=a[c];a=b}else a=a.slice();return a};ol.proj.transform=function(a,b,c){return ol.proj.getTransform(b,c)(a,void 0,a.length)};ol.proj.transformExtent=function(a,b,c){b=ol.proj.getTransform(b,c);return ol.extent.applyTransform(a,b)};
ol.proj.transformWithProjections=function(a,b,c){return ol.proj.getTransformFromProjections(b,c)(a)};ol.proj.addCommon=function(){ol.proj.addEquivalentProjections(ol.proj.EPSG3857.PROJECTIONS);ol.proj.addEquivalentProjections(ol.proj.EPSG4326.PROJECTIONS);ol.proj.addEquivalentTransforms(ol.proj.EPSG4326.PROJECTIONS,ol.proj.EPSG3857.PROJECTIONS,ol.proj.EPSG3857.fromEPSG4326,ol.proj.EPSG3857.toEPSG4326)};ol.proj.addCommon();ol.transform={};ol.transform.tmp_=Array(6);ol.transform.create=function(){return[1,0,0,1,0,0]};ol.transform.reset=function(a){return ol.transform.set(a,1,0,0,1,0,0)};ol.transform.multiply=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=b[0],l=b[1],m=b[2],n=b[3],p=b[4];b=b[5];a[0]=c*k+e*l;a[1]=d*k+f*l;a[2]=c*m+e*n;a[3]=d*m+f*n;a[4]=c*p+e*b+g;a[5]=d*p+f*b+h;return a};ol.transform.set=function(a,b,c,d,e,f,g){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;return a};
ol.transform.setFromArray=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a};ol.transform.apply=function(a,b){var c=b[0],d=b[1];b[0]=a[0]*c+a[2]*d+a[4];b[1]=a[1]*c+a[3]*d+a[5];return b};ol.transform.rotate=function(a,b){var c=Math.cos(b);b=Math.sin(b);return ol.transform.multiply(a,ol.transform.set(ol.transform.tmp_,c,b,-b,c,0,0))};ol.transform.scale=function(a,b,c){return ol.transform.multiply(a,ol.transform.set(ol.transform.tmp_,b,0,0,c,0,0))};
ol.transform.translate=function(a,b,c){return ol.transform.multiply(a,ol.transform.set(ol.transform.tmp_,1,0,0,1,b,c))};ol.transform.compose=function(a,b,c,d,e,f,g,h){var k=Math.sin(f);f=Math.cos(f);a[0]=d*f;a[1]=e*k;a[2]=-d*k;a[3]=e*f;a[4]=g*d*f-h*d*k+b;a[5]=g*e*k+h*e*f+c;return a};ol.transform.invert=function(a){var b=ol.transform.determinant(a);ol.asserts.assert(0!==b,32);var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5];a[0]=f/b;a[1]=-d/b;a[2]=-e/b;a[3]=c/b;a[4]=(e*h-f*g)/b;a[5]=-(c*h-d*g)/b;return a};
ol.transform.determinant=function(a){return a[0]*a[3]-a[1]*a[2]};ol.geom.Geometry=function(){ol.Object.call(this);this.extent_=ol.extent.createEmpty();this.extentRevision_=-1;this.simplifiedGeometryCache={};this.simplifiedGeometryRevision=this.simplifiedGeometryMaxMinSquaredTolerance=0;this.tmpTransform_=ol.transform.create()};ol.inherits(ol.geom.Geometry,ol.Object);ol.geom.Geometry.prototype.clone=function(){};ol.geom.Geometry.prototype.closestPointXY=function(a,b,c,d){};
ol.geom.Geometry.prototype.getClosestPoint=function(a,b){b=b?b:[NaN,NaN];this.closestPointXY(a[0],a[1],b,Infinity);return b};ol.geom.Geometry.prototype.intersectsCoordinate=function(a){return this.containsXY(a[0],a[1])};ol.geom.Geometry.prototype.computeExtent=function(a){};ol.geom.Geometry.prototype.containsXY=ol.functions.FALSE;
ol.geom.Geometry.prototype.getExtent=function(a){this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision());return ol.extent.returnOrUpdate(this.extent_,a)};ol.geom.Geometry.prototype.rotate=function(a,b){};ol.geom.Geometry.prototype.scale=function(a,b,c){};ol.geom.Geometry.prototype.simplify=function(a){return this.getSimplifiedGeometry(a*a)};ol.geom.Geometry.prototype.getSimplifiedGeometry=function(a){};
ol.geom.Geometry.prototype.getType=function(){};ol.geom.Geometry.prototype.applyTransform=function(a){};ol.geom.Geometry.prototype.intersectsExtent=function(a){};ol.geom.Geometry.prototype.translate=function(a,b){};
ol.geom.Geometry.prototype.transform=function(a,b){var c=this.tmpTransform_;a=ol.proj.get(a);var d=a.getUnits()==ol.proj.Units.TILE_PIXELS?function(d,f,g){var e=a.getExtent(),k=a.getWorldExtent();e=ol.extent.getHeight(k)/ol.extent.getHeight(e);ol.transform.compose(c,k[0],k[3],e,-e,0,0,0);ol.geom.flat.transform.transform2D(d,0,d.length,g,c,f);return ol.proj.getTransform(a,b)(d,f,g)}:ol.proj.getTransform(a,b);this.applyTransform(d);return this};ol.color={};ol.color.HEX_COLOR_RE_=/^#(?:[0-9a-f]{3,4}){1,2}$/i;ol.color.NAMED_COLOR_RE_=/^([a-z]*)$/i;ol.color.asArray=function(a){return Array.isArray(a)?a:ol.color.fromString(a)};ol.color.asString=function(a){return"string"===typeof a?a:ol.color.toString(a)};ol.color.fromNamed=function(a){var b=document.createElement("div");b.style.color=a;document.body.appendChild(b);a=getComputedStyle(b).color;document.body.removeChild(b);return a};
ol.color.fromString=function(){var a={},b=0;return function(c){if(a.hasOwnProperty(c))var d=a[c];else{if(1024<=b){d=0;for(var e in a)0===(d++&3)&&(delete a[e],--b)}d=ol.color.fromStringInternal_(c);a[c]=d;++b}return d}}();
ol.color.fromStringInternal_=function(a){ol.color.NAMED_COLOR_RE_.exec(a)&&(a=ol.color.fromNamed(a));if(ol.color.HEX_COLOR_RE_.exec(a)){var b=a.length-1;var c=4>=b?1:2;var d=4===b||8===b;b=parseInt(a.substr(1+0*c,c),16);var e=parseInt(a.substr(1+1*c,c),16);var f=parseInt(a.substr(1+2*c,c),16);a=d?parseInt(a.substr(1+3*c,c),16):255;1==c&&(b=(b<<4)+b,e=(e<<4)+e,f=(f<<4)+f,d&&(a=(a<<4)+a));c=[b,e,f,a/255]}else 0==a.indexOf("rgba(")?(a=a.slice(5,-1).split(",").map(Number),c=ol.color.normalize(a)):0==
a.indexOf("rgb(")?(a=a.slice(4,-1).split(",").map(Number),a.push(1),c=ol.color.normalize(a)):ol.asserts.assert(!1,14);return c};ol.color.normalize=function(a,b){b=b||[];b[0]=ol.math.clamp(a[0]+.5|0,0,255);b[1]=ol.math.clamp(a[1]+.5|0,0,255);b[2]=ol.math.clamp(a[2]+.5|0,0,255);b[3]=ol.math.clamp(a[3],0,1);return b};ol.color.toString=function(a){var b=a[0];b!=(b|0)&&(b=b+.5|0);var c=a[1];c!=(c|0)&&(c=c+.5|0);var d=a[2];d!=(d|0)&&(d=d+.5|0);return"rgba("+b+","+c+","+d+","+(void 0===a[3]?1:a[3])+")"};ol.colorlike={};ol.colorlike.asColorLike=function(a){return ol.colorlike.isColorLike(a)?a:ol.color.asString(a)};ol.colorlike.isColorLike=function(a){return"string"===typeof a||a instanceof CanvasPattern||a instanceof CanvasGradient};ol.dom={};ol.dom.createCanvasContext2D=function(a,b){var c=document.createElement("CANVAS");a&&(c.width=a);b&&(c.height=b);return c.getContext("2d")};ol.dom.outerWidth=function(a){var b=a.offsetWidth;a=getComputedStyle(a);return b+=parseInt(a.marginLeft,10)+parseInt(a.marginRight,10)};ol.dom.outerHeight=function(a){var b=a.offsetHeight;a=getComputedStyle(a);return b+=parseInt(a.marginTop,10)+parseInt(a.marginBottom,10)};ol.dom.replaceNode=function(a,b){var c=b.parentNode;c&&c.replaceChild(a,b)};
ol.dom.removeNode=function(a){return a&&a.parentNode?a.parentNode.removeChild(a):null};ol.dom.removeChildren=function(a){for(;a.lastChild;)a.removeChild(a.lastChild)};ol.webgl={};ol.webgl.ONE=1;ol.webgl.SRC_ALPHA=770;ol.webgl.COLOR_ATTACHMENT0=36064;ol.webgl.COLOR_BUFFER_BIT=16384;ol.webgl.TRIANGLES=4;ol.webgl.TRIANGLE_STRIP=5;ol.webgl.ONE_MINUS_SRC_ALPHA=771;ol.webgl.ARRAY_BUFFER=34962;ol.webgl.ELEMENT_ARRAY_BUFFER=34963;ol.webgl.STREAM_DRAW=35040;ol.webgl.STATIC_DRAW=35044;ol.webgl.DYNAMIC_DRAW=35048;ol.webgl.CULL_FACE=2884;ol.webgl.BLEND=3042;ol.webgl.STENCIL_TEST=2960;ol.webgl.DEPTH_TEST=2929;ol.webgl.SCISSOR_TEST=3089;ol.webgl.UNSIGNED_BYTE=5121;
ol.webgl.UNSIGNED_SHORT=5123;ol.webgl.UNSIGNED_INT=5125;ol.webgl.FLOAT=5126;ol.webgl.RGBA=6408;ol.webgl.FRAGMENT_SHADER=35632;ol.webgl.VERTEX_SHADER=35633;ol.webgl.LINK_STATUS=35714;ol.webgl.LINEAR=9729;ol.webgl.TEXTURE_MAG_FILTER=10240;ol.webgl.TEXTURE_MIN_FILTER=10241;ol.webgl.TEXTURE_WRAP_S=10242;ol.webgl.TEXTURE_WRAP_T=10243;ol.webgl.TEXTURE_2D=3553;ol.webgl.TEXTURE0=33984;ol.webgl.CLAMP_TO_EDGE=33071;ol.webgl.COMPILE_STATUS=35713;ol.webgl.FRAMEBUFFER=36160;
ol.webgl.CONTEXT_IDS_=["experimental-webgl","webgl","webkit-3d","moz-webgl"];ol.webgl.getContext=function(a,b){var c,d,e=ol.webgl.CONTEXT_IDS_.length;for(d=0;d<e;++d)try{if(c=a.getContext(ol.webgl.CONTEXT_IDS_[d],b))return c}catch(f){}return null};ol.has={};var ua="undefined"!==typeof navigator?navigator.userAgent.toLowerCase():"";ol.has.FIREFOX=-1!==ua.indexOf("firefox");ol.has.SAFARI=-1!==ua.indexOf("safari")&&-1==ua.indexOf("chrom");ol.has.WEBKIT=-1!==ua.indexOf("webkit")&&-1==ua.indexOf("edge");ol.has.MAC=-1!==ua.indexOf("macintosh");ol.has.DEVICE_PIXEL_RATIO=window.devicePixelRatio||1;ol.has.CANVAS_LINE_DASH=!1;
ol.has.CANVAS=ol.ENABLE_CANVAS&&function(){if(!("HTMLCanvasElement"in window))return!1;try{var a=document.createElement("CANVAS").getContext("2d");return a?(void 0!==a.setLineDash&&(ol.has.CANVAS_LINE_DASH=!0),!0):!1}catch(b){return!1}}();ol.has.DEVICE_ORIENTATION="DeviceOrientationEvent"in window;ol.has.GEOLOCATION="geolocation"in navigator;ol.has.TOUCH=ol.ASSUME_TOUCH||"ontouchstart"in window;ol.has.POINTER="PointerEvent"in window;ol.has.MSPOINTER=!!navigator.msPointerEnabled;
(function(){if(ol.ENABLE_WEBGL){var a=!1,b=[];if("WebGLRenderingContext"in window)try{var c=document.createElement("CANVAS"),d=ol.webgl.getContext(c,{failIfMajorPerformanceCaveat:!0});if(d){a=!0;var e=d.getParameter(d.MAX_TEXTURE_SIZE);b=d.getSupportedExtensions()}}catch(f){}ol.has.WEBGL=a;ol.WEBGL_EXTENSIONS=b;ol.WEBGL_MAX_TEXTURE_SIZE=e}})();ol.ImageState={IDLE:0,LOADING:1,LOADED:2,ERROR:3};ol.css={};ol.css.CLASS_HIDDEN="ol-hidden";ol.css.CLASS_SELECTABLE="ol-selectable";ol.css.CLASS_UNSELECTABLE="ol-unselectable";ol.css.CLASS_UNSUPPORTED="ol-unsupported";ol.css.CLASS_CONTROL="ol-control";ol.css.getFontFamilies=function(){var a,b={};return function(c){a||(a=document.createElement("div").style);if(!(c in b)){a.font=c;var d=a.fontFamily;a.font="";if(!d)return null;b[c]=d.split(/,\s?/)}return b[c]}}();ol.structs={};ol.structs.LRUCache=function(a){ol.events.EventTarget.call(this);this.highWaterMark=void 0!==a?a:2048;this.count_=0;this.entries_={};this.newest_=this.oldest_=null};ol.inherits(ol.structs.LRUCache,ol.events.EventTarget);ol.structs.LRUCache.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark};ol.structs.LRUCache.prototype.clear=function(){this.count_=0;this.entries_={};this.newest_=this.oldest_=null;this.dispatchEvent(ol.events.EventType.CLEAR)};
ol.structs.LRUCache.prototype.containsKey=function(a){return this.entries_.hasOwnProperty(a)};ol.structs.LRUCache.prototype.forEach=function(a,b){for(var c=this.oldest_;c;)a.call(b,c.value_,c.key_,this),c=c.newer};
ol.structs.LRUCache.prototype.get=function(a){a=this.entries_[a];ol.asserts.assert(void 0!==a,15);if(a===this.newest_)return a.value_;a===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(a.newer.older=a.older,a.older.newer=a.newer);a.newer=null;a.older=this.newest_;this.newest_=this.newest_.newer=a;return a.value_};
ol.structs.LRUCache.prototype.remove=function(a){var b=this.entries_[a];ol.asserts.assert(void 0!==b,15);if(b===this.newest_){if(this.newest_=b.older)this.newest_.newer=null}else if(b===this.oldest_){if(this.oldest_=b.newer)this.oldest_.older=null}else b.newer.older=b.older,b.older.newer=b.newer;delete this.entries_[a];--this.count_;return b.value_};ol.structs.LRUCache.prototype.getCount=function(){return this.count_};
ol.structs.LRUCache.prototype.getKeys=function(){var a=Array(this.count_),b=0,c;for(c=this.newest_;c;c=c.older)a[b++]=c.key_;return a};ol.structs.LRUCache.prototype.getValues=function(){var a=Array(this.count_),b=0,c;for(c=this.newest_;c;c=c.older)a[b++]=c.value_;return a};ol.structs.LRUCache.prototype.peekLast=function(){return this.oldest_.value_};ol.structs.LRUCache.prototype.peekLastKey=function(){return this.oldest_.key_};ol.structs.LRUCache.prototype.peekFirstKey=function(){return this.newest_.key_};
ol.structs.LRUCache.prototype.pop=function(){var a=this.oldest_;delete this.entries_[a.key_];a.newer&&(a.newer.older=null);this.oldest_=a.newer;this.oldest_||(this.newest_=null);--this.count_;return a.value_};ol.structs.LRUCache.prototype.replace=function(a,b){this.get(a);this.entries_[a].value_=b};
ol.structs.LRUCache.prototype.set=function(a,b){ol.asserts.assert(!(a in this.entries_),16);b={key_:a,newer:null,older:this.newest_,value_:b};this.newest_?this.newest_.newer=b:this.oldest_=b;this.newest_=b;this.entries_[a]=b;++this.count_};ol.structs.LRUCache.prototype.pruneAndSet=function(a,b){for(;this.canExpireCache();)this.pop();this.set(a,b)};ol.render={};ol.render.canvas={};ol.render.canvas.defaultFont="10px sans-serif";ol.render.canvas.defaultFillStyle=[0,0,0,1];ol.render.canvas.defaultLineCap="round";ol.render.canvas.defaultLineDash=[];ol.render.canvas.defaultLineDashOffset=0;ol.render.canvas.defaultLineJoin="round";ol.render.canvas.defaultMiterLimit=10;ol.render.canvas.defaultStrokeStyle=[0,0,0,1];ol.render.canvas.defaultTextAlign="center";ol.render.canvas.defaultTextBaseline="middle";ol.render.canvas.defaultLineWidth=1;
ol.render.canvas.labelCache=new ol.structs.LRUCache;ol.render.canvas.checkedFonts_={};
ol.render.canvas.checkFont=function(){function a(a){e||(e=ol.dom.createCanvasContext2D(1,1),e.font="32px monospace",g=e.measureText("wmytzilWMYTZIL@#/&?$%10").width);var b=!0;"monospace"!=a&&(e.font="32px "+a+",monospace",b=e.measureText("wmytzilWMYTZIL@#/&?$%10").width!=g,e.font="32px monospace");return b}function b(){var b=!0,e;for(e in c)60>c[e]&&(a(e)?(c[e]=60,d.clear()):(++c[e],b=!1));b&&(window.clearInterval(f),f=void 0)}var c=ol.render.canvas.checkedFonts_,d=ol.render.canvas.labelCache,e,f,
g;return function(d){if(d=ol.css.getFontFamilies(d))for(var e=0,g=d.length;e<g;++e){var h=d[e];h in c||(c[h]=60,a(h)||(c[h]=0,void 0===f&&(f=window.setInterval(b,32))))}}}();ol.render.canvas.rotateAtOffset=function(a,b,c,d){0!==b&&(a.translate(c,d),a.rotate(b),a.translate(-c,-d))};ol.render.canvas.resetTransform_=ol.transform.create();
ol.render.canvas.drawImage=function(a,b,c,d,e,f,g,h,k,l,m){if(1!=c){var n=a.globalAlpha;a.globalAlpha=n*c}b&&a.setTransform.apply(a,b);a.drawImage(d,e,f,g,h,k,l,g*m,h*m);n&&(a.globalAlpha=n);b&&a.setTransform.apply(a,ol.render.canvas.resetTransform_)};ol.style={};ol.style.Image=function(a){this.opacity_=a.opacity;this.rotateWithView_=a.rotateWithView;this.rotation_=a.rotation;this.scale_=a.scale;this.snapToPixel_=a.snapToPixel};ol.style.Image.prototype.getOpacity=function(){return this.opacity_};ol.style.Image.prototype.getRotateWithView=function(){return this.rotateWithView_};ol.style.Image.prototype.getRotation=function(){return this.rotation_};ol.style.Image.prototype.getScale=function(){return this.scale_};
ol.style.Image.prototype.getSnapToPixel=function(){return this.snapToPixel_};ol.style.Image.prototype.getAnchor=function(){};ol.style.Image.prototype.getImage=function(a){};ol.style.Image.prototype.getHitDetectionImage=function(a){};ol.style.Image.prototype.getImageState=function(){};ol.style.Image.prototype.getImageSize=function(){};ol.style.Image.prototype.getHitDetectionImageSize=function(){};ol.style.Image.prototype.getOrigin=function(){};ol.style.Image.prototype.getSize=function(){};
ol.style.Image.prototype.setOpacity=function(a){this.opacity_=a};ol.style.Image.prototype.setRotateWithView=function(a){this.rotateWithView_=a};ol.style.Image.prototype.setRotation=function(a){this.rotation_=a};ol.style.Image.prototype.setScale=function(a){this.scale_=a};ol.style.Image.prototype.setSnapToPixel=function(a){this.snapToPixel_=a};ol.style.Image.prototype.listenImageChange=function(a,b){};ol.style.Image.prototype.load=function(){};
ol.style.Image.prototype.unlistenImageChange=function(a,b){};ol.style.RegularShape=function(a){this.hitDetectionCanvas_=this.canvas_=this.checksums_=null;this.fill_=void 0!==a.fill?a.fill:null;this.origin_=[0,0];this.points_=a.points;this.radius_=void 0!==a.radius?a.radius:a.radius1;this.radius2_=a.radius2;this.angle_=void 0!==a.angle?a.angle:0;this.stroke_=void 0!==a.stroke?a.stroke:null;this.hitDetectionImageSize_=this.imageSize_=this.size_=this.anchor_=null;this.atlasManager_=a.atlasManager;this.render_(this.atlasManager_);ol.style.Image.call(this,{opacity:1,
rotateWithView:void 0!==a.rotateWithView?a.rotateWithView:!1,rotation:void 0!==a.rotation?a.rotation:0,scale:1,snapToPixel:void 0!==a.snapToPixel?a.snapToPixel:!0})};ol.inherits(ol.style.RegularShape,ol.style.Image);
ol.style.RegularShape.prototype.clone=function(){var a=new ol.style.RegularShape({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),snapToPixel:this.getSnapToPixel(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});a.setOpacity(this.getOpacity());a.setScale(this.getScale());return a};
ol.style.RegularShape.prototype.getAnchor=function(){return this.anchor_};ol.style.RegularShape.prototype.getAngle=function(){return this.angle_};ol.style.RegularShape.prototype.getFill=function(){return this.fill_};ol.style.RegularShape.prototype.getHitDetectionImage=function(a){return this.hitDetectionCanvas_};ol.style.RegularShape.prototype.getImage=function(a){return this.canvas_};ol.style.RegularShape.prototype.getImageSize=function(){return this.imageSize_};
ol.style.RegularShape.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_};ol.style.RegularShape.prototype.getImageState=function(){return ol.ImageState.LOADED};ol.style.RegularShape.prototype.getOrigin=function(){return this.origin_};ol.style.RegularShape.prototype.getPoints=function(){return this.points_};ol.style.RegularShape.prototype.getRadius=function(){return this.radius_};ol.style.RegularShape.prototype.getRadius2=function(){return this.radius2_};
ol.style.RegularShape.prototype.getSize=function(){return this.size_};ol.style.RegularShape.prototype.getStroke=function(){return this.stroke_};ol.style.RegularShape.prototype.listenImageChange=function(a,b){};ol.style.RegularShape.prototype.load=function(){};ol.style.RegularShape.prototype.unlistenImageChange=function(a,b){};
ol.style.RegularShape.prototype.render_=function(a){var b="",c="",d=0,e=null,f=0,g=0;if(this.stroke_){var h=this.stroke_.getColor();null===h&&(h=ol.render.canvas.defaultStrokeStyle);h=ol.colorlike.asColorLike(h);g=this.stroke_.getWidth();void 0===g&&(g=ol.render.canvas.defaultLineWidth);e=this.stroke_.getLineDash();f=this.stroke_.getLineDashOffset();ol.has.CANVAS_LINE_DASH||(e=null,f=0);c=this.stroke_.getLineJoin();void 0===c&&(c=ol.render.canvas.defaultLineJoin);b=this.stroke_.getLineCap();void 0===
b&&(b=ol.render.canvas.defaultLineCap);d=this.stroke_.getMiterLimit();void 0===d&&(d=ol.render.canvas.defaultMiterLimit)}var k=2*(this.radius_+g)+1;b={strokeStyle:h,strokeWidth:g,size:k,lineCap:b,lineDash:e,lineDashOffset:f,lineJoin:c,miterLimit:d};if(void 0===a){var l=ol.dom.createCanvasContext2D(k,k);this.canvas_=l.canvas;a=k=this.canvas_.width;this.draw_(b,l,0,0);this.createHitDetectionCanvas_(b)}else k=Math.round(k),(c=!this.fill_)&&(l=this.drawHitDetectionCanvas_.bind(this,b)),d=this.getChecksum(),
l=a.add(d,k,k,this.draw_.bind(this,b),l),this.canvas_=l.image,this.origin_=[l.offsetX,l.offsetY],a=l.image.width,c?(this.hitDetectionCanvas_=l.hitImage,this.hitDetectionImageSize_=[l.hitImage.width,l.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[a,a]);this.anchor_=[k/2,k/2];this.size_=[k,k];this.imageSize_=[a,a]};
ol.style.RegularShape.prototype.draw_=function(a,b,c,d){b.setTransform(1,0,0,1,0,0);b.translate(c,d);b.beginPath();var e=this.points_;if(Infinity===e)b.arc(a.size/2,a.size/2,this.radius_,0,2*Math.PI,!0);else{var f=void 0!==this.radius2_?this.radius2_:this.radius_;f!==this.radius_&&(e*=2);for(c=0;c<=e;c++){d=2*c*Math.PI/e-Math.PI/2+this.angle_;var g=0===c%2?this.radius_:f;b.lineTo(a.size/2+g*Math.cos(d),a.size/2+g*Math.sin(d))}}this.fill_&&(c=this.fill_.getColor(),null===c&&(c=ol.render.canvas.defaultFillStyle),
b.fillStyle=ol.colorlike.asColorLike(c),b.fill());this.stroke_&&(b.strokeStyle=a.strokeStyle,b.lineWidth=a.strokeWidth,a.lineDash&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.lineCap=a.lineCap,b.lineJoin=a.lineJoin,b.miterLimit=a.miterLimit,b.stroke());b.closePath()};
ol.style.RegularShape.prototype.createHitDetectionCanvas_=function(a){this.hitDetectionImageSize_=[a.size,a.size];if(this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var b=ol.dom.createCanvasContext2D(a.size,a.size);this.hitDetectionCanvas_=b.canvas;this.drawHitDetectionCanvas_(a,b,0,0)}};
ol.style.RegularShape.prototype.drawHitDetectionCanvas_=function(a,b,c,d){b.setTransform(1,0,0,1,0,0);b.translate(c,d);b.beginPath();c=this.points_;if(Infinity===c)b.arc(a.size/2,a.size/2,this.radius_,0,2*Math.PI,!0);else{d=void 0!==this.radius2_?this.radius2_:this.radius_;d!==this.radius_&&(c*=2);var e;for(e=0;e<=c;e++){var f=2*e*Math.PI/c-Math.PI/2+this.angle_;var g=0===e%2?this.radius_:d;b.lineTo(a.size/2+g*Math.cos(f),a.size/2+g*Math.sin(f))}}b.fillStyle=ol.render.canvas.defaultFillStyle;b.fill();
this.stroke_&&(b.strokeStyle=a.strokeStyle,b.lineWidth=a.strokeWidth,a.lineDash&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.stroke());b.closePath()};
ol.style.RegularShape.prototype.getChecksum=function(){var a=this.stroke_?this.stroke_.getChecksum():"-",b=this.fill_?this.fill_.getChecksum():"-";this.checksums_&&a==this.checksums_[1]&&b==this.checksums_[2]&&this.radius_==this.checksums_[3]&&this.radius2_==this.checksums_[4]&&this.angle_==this.checksums_[5]&&this.points_==this.checksums_[6]||(this.checksums_=["r"+a+b+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():
"-")+(void 0!==this.points_?this.points_.toString():"-"),a,b,this.radius_,this.radius2_,this.angle_,this.points_]);return this.checksums_[0]};ol.style.Circle=function(a){a=a||{};ol.style.RegularShape.call(this,{points:Infinity,fill:a.fill,radius:a.radius,snapToPixel:a.snapToPixel,stroke:a.stroke,atlasManager:a.atlasManager})};ol.inherits(ol.style.Circle,ol.style.RegularShape);
ol.style.Circle.prototype.clone=function(){var a=new ol.style.Circle({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),snapToPixel:this.getSnapToPixel(),atlasManager:this.atlasManager_});a.setOpacity(this.getOpacity());a.setScale(this.getScale());return a};ol.style.Circle.prototype.setRadius=function(a){this.radius_=a;this.render_(this.atlasManager_)};ol.style.Fill=function(a){a=a||{};this.color_=void 0!==a.color?a.color:null;this.checksum_=void 0};ol.style.Fill.prototype.clone=function(){var a=this.getColor();return new ol.style.Fill({color:a&&a.slice?a.slice():a||void 0})};ol.style.Fill.prototype.getColor=function(){return this.color_};ol.style.Fill.prototype.setColor=function(a){this.color_=a;this.checksum_=void 0};
ol.style.Fill.prototype.getChecksum=function(){void 0===this.checksum_&&(this.checksum_=this.color_ instanceof CanvasPattern||this.color_ instanceof CanvasGradient?ol.getUid(this.color_).toString():"f"+(this.color_?ol.color.asString(this.color_):"-"));return this.checksum_};ol.style.Stroke=function(a){a=a||{};this.color_=void 0!==a.color?a.color:null;this.lineCap_=a.lineCap;this.lineDash_=void 0!==a.lineDash?a.lineDash:null;this.lineDashOffset_=a.lineDashOffset;this.lineJoin_=a.lineJoin;this.miterLimit_=a.miterLimit;this.width_=a.width;this.checksum_=void 0};
ol.style.Stroke.prototype.clone=function(){var a=this.getColor();return new ol.style.Stroke({color:a&&a.slice?a.slice():a||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})};ol.style.Stroke.prototype.getColor=function(){return this.color_};ol.style.Stroke.prototype.getLineCap=function(){return this.lineCap_};
ol.style.Stroke.prototype.getLineDash=function(){return this.lineDash_};ol.style.Stroke.prototype.getLineDashOffset=function(){return this.lineDashOffset_};ol.style.Stroke.prototype.getLineJoin=function(){return this.lineJoin_};ol.style.Stroke.prototype.getMiterLimit=function(){return this.miterLimit_};ol.style.Stroke.prototype.getWidth=function(){return this.width_};ol.style.Stroke.prototype.setColor=function(a){this.color_=a;this.checksum_=void 0};
ol.style.Stroke.prototype.setLineCap=function(a){this.lineCap_=a;this.checksum_=void 0};ol.style.Stroke.prototype.setLineDash=function(a){this.lineDash_=a;this.checksum_=void 0};ol.style.Stroke.prototype.setLineDashOffset=function(a){this.lineDashOffset_=a;this.checksum_=void 0};ol.style.Stroke.prototype.setLineJoin=function(a){this.lineJoin_=a;this.checksum_=void 0};ol.style.Stroke.prototype.setMiterLimit=function(a){this.miterLimit_=a;this.checksum_=void 0};
ol.style.Stroke.prototype.setWidth=function(a){this.width_=a;this.checksum_=void 0};
ol.style.Stroke.prototype.getChecksum=function(){void 0===this.checksum_&&(this.checksum_="s",this.checksum_=this.color_?"string"===typeof this.color_?this.checksum_+this.color_:this.checksum_+ol.getUid(this.color_).toString():this.checksum_+"-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?
this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-"));return this.checksum_};ol.style.Style=function(a){a=a||{};this.geometry_=null;this.geometryFunction_=ol.style.Style.defaultGeometryFunction;void 0!==a.geometry&&this.setGeometry(a.geometry);this.fill_=void 0!==a.fill?a.fill:null;this.image_=void 0!==a.image?a.image:null;this.renderer_=void 0!==a.renderer?a.renderer:null;this.stroke_=void 0!==a.stroke?a.stroke:null;this.text_=void 0!==a.text?a.text:null;this.zIndex_=a.zIndex};
ol.style.Style.prototype.clone=function(){var a=this.getGeometry();a&&a.clone&&(a=a.clone());return new ol.style.Style({geometry:a,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})};ol.style.Style.prototype.getRenderer=function(){return this.renderer_};
ol.style.Style.prototype.setRenderer=function(a){this.renderer_=a};ol.style.Style.prototype.getGeometry=function(){return this.geometry_};ol.style.Style.prototype.getGeometryFunction=function(){return this.geometryFunction_};ol.style.Style.prototype.getFill=function(){return this.fill_};ol.style.Style.prototype.setFill=function(a){this.fill_=a};ol.style.Style.prototype.getImage=function(){return this.image_};ol.style.Style.prototype.setImage=function(a){this.image_=a};
ol.style.Style.prototype.getStroke=function(){return this.stroke_};ol.style.Style.prototype.setStroke=function(a){this.stroke_=a};ol.style.Style.prototype.getText=function(){return this.text_};ol.style.Style.prototype.setText=function(a){this.text_=a};ol.style.Style.prototype.getZIndex=function(){return this.zIndex_};
ol.style.Style.prototype.setGeometry=function(a){"function"===typeof a?this.geometryFunction_=a:"string"===typeof a?this.geometryFunction_=function(b){return b.get(a)}:a?void 0!==a&&(this.geometryFunction_=function(){return a}):this.geometryFunction_=ol.style.Style.defaultGeometryFunction;this.geometry_=a};ol.style.Style.prototype.setZIndex=function(a){this.zIndex_=a};
ol.style.Style.createFunction=function(a){if("function"!==typeof a){if(Array.isArray(a))var b=a;else ol.asserts.assert(a instanceof ol.style.Style,41),b=[a];a=function(){return b}}return a};ol.style.Style.default_=null;
ol.style.Style.defaultFunction=function(a,b){ol.style.Style.default_||(a=new ol.style.Fill({color:"rgba(255,255,255,0.4)"}),b=new ol.style.Stroke({color:"#3399CC",width:1.25}),ol.style.Style.default_=[new ol.style.Style({image:new ol.style.Circle({fill:a,stroke:b,radius:5}),fill:a,stroke:b})]);return ol.style.Style.default_};
ol.style.Style.createDefaultEditing=function(){var a={},b=[255,255,255,1],c=[0,153,255,1];a[ol.geom.GeometryType.POLYGON]=[new ol.style.Style({fill:new ol.style.Fill({color:[255,255,255,.5]})})];a[ol.geom.GeometryType.MULTI_POLYGON]=a[ol.geom.GeometryType.POLYGON];a[ol.geom.GeometryType.LINE_STRING]=[new ol.style.Style({stroke:new ol.style.Stroke({color:b,width:5})}),new ol.style.Style({stroke:new ol.style.Stroke({color:c,width:3})})];a[ol.geom.GeometryType.MULTI_LINE_STRING]=a[ol.geom.GeometryType.LINE_STRING];
a[ol.geom.GeometryType.CIRCLE]=a[ol.geom.GeometryType.POLYGON].concat(a[ol.geom.GeometryType.LINE_STRING]);a[ol.geom.GeometryType.POINT]=[new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:c}),stroke:new ol.style.Stroke({color:b,width:1.5})}),zIndex:Infinity})];a[ol.geom.GeometryType.MULTI_POINT]=a[ol.geom.GeometryType.POINT];a[ol.geom.GeometryType.GEOMETRY_COLLECTION]=a[ol.geom.GeometryType.POLYGON].concat(a[ol.geom.GeometryType.LINE_STRING],a[ol.geom.GeometryType.POINT]);
return a};ol.style.Style.defaultGeometryFunction=function(a){return a.getGeometry()};ol.Feature=function(a){ol.Object.call(this);this.id_=void 0;this.geometryName_="geometry";this.style_=null;this.styleFunction_=void 0;this.geometryChangeKey_=null;ol.events.listen(this,ol.Object.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this);void 0!==a&&(a instanceof ol.geom.Geometry||!a?this.setGeometry(a):this.setProperties(a))};ol.inherits(ol.Feature,ol.Object);
ol.Feature.prototype.clone=function(){var a=new ol.Feature(this.getProperties());a.setGeometryName(this.getGeometryName());var b=this.getGeometry();b&&a.setGeometry(b.clone());(b=this.getStyle())&&a.setStyle(b);return a};ol.Feature.prototype.getGeometry=function(){return this.get(this.geometryName_)};ol.Feature.prototype.getId=function(){return this.id_};ol.Feature.prototype.getGeometryName=function(){return this.geometryName_};ol.Feature.prototype.getStyle=function(){return this.style_};
ol.Feature.prototype.getStyleFunction=function(){return this.styleFunction_};ol.Feature.prototype.handleGeometryChange_=function(){this.changed()};ol.Feature.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(ol.events.unlistenByKey(this.geometryChangeKey_),this.geometryChangeKey_=null);var a=this.getGeometry();a&&(this.geometryChangeKey_=ol.events.listen(a,ol.events.EventType.CHANGE,this.handleGeometryChange_,this));this.changed()};
ol.Feature.prototype.setGeometry=function(a){this.set(this.geometryName_,a)};ol.Feature.prototype.setStyle=function(a){this.styleFunction_=(this.style_=a)?ol.Feature.createStyleFunction(a):void 0;this.changed()};ol.Feature.prototype.setId=function(a){this.id_=a;this.changed()};
ol.Feature.prototype.setGeometryName=function(a){ol.events.unlisten(this,ol.Object.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this);this.geometryName_=a;ol.events.listen(this,ol.Object.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this);this.handleGeometryChanged_()};
ol.Feature.createStyleFunction=function(a){if("function"===typeof a)var b=2==a.length?function(b){return a(this,b)}:a;else{if(Array.isArray(a))var c=a;else ol.asserts.assert(a instanceof ol.style.Style,41),c=[a];b=function(){return c}}return b};ol.format={};ol.format.Feature=function(){this.defaultFeatureProjection=this.defaultDataProjection=null};ol.format.Feature.prototype.getReadOptions=function(a,b){var c;b&&(c={dataProjection:b.dataProjection?b.dataProjection:this.readProjection(a),featureProjection:b.featureProjection});return this.adaptOptions(c)};ol.format.Feature.prototype.adaptOptions=function(a){return ol.obj.assign({dataProjection:this.defaultDataProjection,featureProjection:this.defaultFeatureProjection},a)};
ol.format.Feature.prototype.getLastExtent=function(){return null};ol.format.Feature.prototype.getType=function(){};ol.format.Feature.prototype.readFeature=function(a,b){};ol.format.Feature.prototype.readFeatures=function(a,b){};ol.format.Feature.prototype.readGeometry=function(a,b){};ol.format.Feature.prototype.readProjection=function(a){};ol.format.Feature.prototype.writeFeature=function(a,b){};ol.format.Feature.prototype.writeFeatures=function(a,b){};
ol.format.Feature.prototype.writeGeometry=function(a,b){};ol.format.Feature.transformWithOptions=function(a,b,c){var d=c?ol.proj.get(c.featureProjection):null,e=c?ol.proj.get(c.dataProjection):null;d=d&&e&&!ol.proj.equivalent(d,e)?a instanceof ol.geom.Geometry?(b?a.clone():a).transform(b?d:e,b?e:d):ol.proj.transformExtent(a,e,d):a;if(b&&c&&void 0!==c.decimals){var f=Math.pow(10,c.decimals);d===a&&(d=d.clone());d.applyTransform(function(a){for(var b=0,c=a.length;b<c;++b)a[b]=Math.round(a[b]*f)/f;return a})}return d};ol.format.IGCZ={BAROMETRIC:"barometric",GPS:"gps",NONE:"none"};ol.format.FormatType={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};ol.format.TextFeature=function(){ol.format.Feature.call(this)};ol.inherits(ol.format.TextFeature,ol.format.Feature);ol.format.TextFeature.prototype.getText_=function(a){return"string"===typeof a?a:""};ol.format.TextFeature.prototype.getType=function(){return ol.format.FormatType.TEXT};ol.format.TextFeature.prototype.readFeature=function(a,b){return this.readFeatureFromText(this.getText_(a),this.adaptOptions(b))};ol.format.TextFeature.prototype.readFeatureFromText=function(a,b){};
ol.format.TextFeature.prototype.readFeatures=function(a,b){return this.readFeaturesFromText(this.getText_(a),this.adaptOptions(b))};ol.format.TextFeature.prototype.readFeaturesFromText=function(a,b){};ol.format.TextFeature.prototype.readGeometry=function(a,b){return this.readGeometryFromText(this.getText_(a),this.adaptOptions(b))};ol.format.TextFeature.prototype.readGeometryFromText=function(a,b){};ol.format.TextFeature.prototype.readProjection=function(a){return this.readProjectionFromText(this.getText_(a))};
ol.format.TextFeature.prototype.readProjectionFromText=function(a){return this.defaultDataProjection};ol.format.TextFeature.prototype.writeFeature=function(a,b){return this.writeFeatureText(a,this.adaptOptions(b))};ol.format.TextFeature.prototype.writeFeatureText=function(a,b){};ol.format.TextFeature.prototype.writeFeatures=function(a,b){return this.writeFeaturesText(a,this.adaptOptions(b))};ol.format.TextFeature.prototype.writeFeaturesText=function(a,b){};
ol.format.TextFeature.prototype.writeGeometry=function(a,b){return this.writeGeometryText(a,this.adaptOptions(b))};ol.format.TextFeature.prototype.writeGeometryText=function(a,b){};ol.geom.GeometryLayout={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};ol.array={};ol.array.binarySearch=function(a,b,c){for(var d,e=c||ol.array.numberSafeCompareFunction,f=0,g=a.length,h=!1;f<g;)c=f+(g-f>>1),d=+e(a[c],b),0>d?f=c+1:(g=c,h=!d);return h?f:~f};ol.array.numberSafeCompareFunction=function(a,b){return a>b?1:a<b?-1:0};ol.array.includes=function(a,b){return 0<=a.indexOf(b)};
ol.array.linearFindNearest=function(a,b,c){var d=a.length;if(a[0]<=b)return 0;if(!(b<=a[d-1]))if(0<c)for(c=1;c<d;++c){if(a[c]<b)return c-1}else if(0>c)for(c=1;c<d;++c){if(a[c]<=b)return c}else for(c=1;c<d;++c){if(a[c]==b)return c;if(a[c]<b)return a[c-1]-b<b-a[c]?c-1:c}return d-1};ol.array.reverseSubArray=function(a,b,c){for(;b<c;){var d=a[b];a[b]=a[c];a[c]=d;++b;--c}};ol.array.extend=function(a,b){var c=Array.isArray(b)?b:[b],d=c.length;for(b=0;b<d;b++)a[a.length]=c[b]};
ol.array.remove=function(a,b){b=a.indexOf(b);var c=-1<b;c&&a.splice(b,1);return c};ol.array.find=function(a,b){for(var c=a.length>>>0,d,e=0;e<c;e++)if(d=a[e],b(d,e,a))return d;return null};ol.array.equals=function(a,b){var c=a.length;if(c!==b.length)return!1;for(var d=0;d<c;d++)if(a[d]!==b[d])return!1;return!0};
ol.array.stableSort=function(a,b){var c=a.length,d=Array(a.length),e;for(e=0;e<c;e++)d[e]={index:e,value:a[e]};d.sort(function(a,c){return b(a.value,c.value)||a.index-c.index});for(e=0;e<a.length;e++)a[e]=d[e].value};ol.array.findIndex=function(a,b){var c;return a.every(function(d,e){c=e;return!b(d,e,a)})?-1:c};ol.array.isSorted=function(a,b,c){var d=b||ol.array.numberSafeCompareFunction;return a.every(function(b,f){if(0===f)return!0;b=d(a[f-1],b);return!(0<b||c&&0===b)})};ol.geom.SimpleGeometry=function(){ol.geom.Geometry.call(this);this.layout=ol.geom.GeometryLayout.XY;this.stride=2;this.flatCoordinates=null};ol.inherits(ol.geom.SimpleGeometry,ol.geom.Geometry);ol.geom.SimpleGeometry.getLayoutForStride_=function(a){if(2==a)var b=ol.geom.GeometryLayout.XY;else 3==a?b=ol.geom.GeometryLayout.XYZ:4==a&&(b=ol.geom.GeometryLayout.XYZM);return b};
ol.geom.SimpleGeometry.getStrideForLayout=function(a){var b;a==ol.geom.GeometryLayout.XY?b=2:a==ol.geom.GeometryLayout.XYZ||a==ol.geom.GeometryLayout.XYM?b=3:a==ol.geom.GeometryLayout.XYZM&&(b=4);return b};ol.geom.SimpleGeometry.prototype.containsXY=ol.functions.FALSE;ol.geom.SimpleGeometry.prototype.computeExtent=function(a){return ol.extent.createOrUpdateFromFlatCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a)};ol.geom.SimpleGeometry.prototype.getCoordinates=function(){};
ol.geom.SimpleGeometry.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)};ol.geom.SimpleGeometry.prototype.getFlatCoordinates=function(){return this.flatCoordinates};ol.geom.SimpleGeometry.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)};ol.geom.SimpleGeometry.prototype.getLayout=function(){return this.layout};
ol.geom.SimpleGeometry.prototype.getSimplifiedGeometry=function(a){this.simplifiedGeometryRevision!=this.getRevision()&&(ol.obj.clear(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision());if(0>a||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&a<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var b=a.toString();if(this.simplifiedGeometryCache.hasOwnProperty(b))return this.simplifiedGeometryCache[b];var c=this.getSimplifiedGeometryInternal(a);
if(c.getFlatCoordinates().length<this.flatCoordinates.length)return this.simplifiedGeometryCache[b]=c;this.simplifiedGeometryMaxMinSquaredTolerance=a;return this};ol.geom.SimpleGeometry.prototype.getSimplifiedGeometryInternal=function(a){return this};ol.geom.SimpleGeometry.prototype.getStride=function(){return this.stride};ol.geom.SimpleGeometry.prototype.setFlatCoordinatesInternal=function(a,b){this.stride=ol.geom.SimpleGeometry.getStrideForLayout(a);this.layout=a;this.flatCoordinates=b};
ol.geom.SimpleGeometry.prototype.setCoordinates=function(a,b){};ol.geom.SimpleGeometry.prototype.setLayout=function(a,b,c){if(a)b=ol.geom.SimpleGeometry.getStrideForLayout(a);else{for(a=0;a<c;++a){if(0===b.length){this.layout=ol.geom.GeometryLayout.XY;this.stride=2;return}b=b[0]}b=b.length;a=ol.geom.SimpleGeometry.getLayoutForStride_(b)}this.layout=a;this.stride=b};
ol.geom.SimpleGeometry.prototype.applyTransform=function(a){this.flatCoordinates&&(a(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())};ol.geom.SimpleGeometry.prototype.rotate=function(a,b){var c=this.getFlatCoordinates();if(c){var d=this.getStride();ol.geom.flat.transform.rotate(c,0,c.length,d,a,b,c);this.changed()}};
ol.geom.SimpleGeometry.prototype.scale=function(a,b,c){void 0===b&&(b=a);c||(c=ol.extent.getCenter(this.getExtent()));var d=this.getFlatCoordinates();if(d){var e=this.getStride();ol.geom.flat.transform.scale(d,0,d.length,e,a,b,c,d);this.changed()}};ol.geom.SimpleGeometry.prototype.translate=function(a,b){var c=this.getFlatCoordinates();if(c){var d=this.getStride();ol.geom.flat.transform.translate(c,0,c.length,d,a,b,c);this.changed()}};
ol.geom.SimpleGeometry.transform2D=function(a,b,c){var d=a.getFlatCoordinates();return d?(a=a.getStride(),ol.geom.flat.transform.transform2D(d,0,d.length,a,b,c)):null};ol.geom.flat.closest={};ol.geom.flat.closest.point=function(a,b,c,d,e,f,g){var h=a[b],k=a[b+1],l=a[c]-h,m=a[c+1]-k;if(0!==l||0!==m)if(f=((e-h)*l+(f-k)*m)/(l*l+m*m),1<f)b=c;else if(0<f){for(e=0;e<d;++e)g[e]=ol.math.lerp(a[b+e],a[c+e],f);g.length=d;return}for(e=0;e<d;++e)g[e]=a[b+e];g.length=d};ol.geom.flat.closest.getMaxSquaredDelta=function(a,b,c,d,e){var f=a[b],g=a[b+1];for(b+=d;b<c;b+=d){var h=a[b],k=a[b+1];f=ol.math.squaredDistance(f,g,h,k);f>e&&(e=f);f=h;g=k}return e};
ol.geom.flat.closest.getsMaxSquaredDelta=function(a,b,c,d,e){var f;var g=0;for(f=c.length;g<f;++g){var h=c[g];e=ol.geom.flat.closest.getMaxSquaredDelta(a,b,h,d,e);b=h}return e};ol.geom.flat.closest.getssMaxSquaredDelta=function(a,b,c,d,e){var f;var g=0;for(f=c.length;g<f;++g){var h=c[g];e=ol.geom.flat.closest.getsMaxSquaredDelta(a,b,h,d,e);b=h[h.length-1]}return e};
ol.geom.flat.closest.getClosestPoint=function(a,b,c,d,e,f,g,h,k,l,m){if(b==c)return l;if(0===e){var n=ol.math.squaredDistance(g,h,a[b],a[b+1]);if(n<l){for(m=0;m<d;++m)k[m]=a[b+m];k.length=d;return n}return l}for(var p=m?m:[NaN,NaN],q=b+d;q<c;)if(ol.geom.flat.closest.point(a,q-d,q,d,g,h,p),n=ol.math.squaredDistance(g,h,p[0],p[1]),n<l){l=n;for(m=0;m<d;++m)k[m]=p[m];k.length=d;q+=d}else q+=d*Math.max((Math.sqrt(n)-Math.sqrt(l))/e|0,1);if(f&&(ol.geom.flat.closest.point(a,c-d,b,d,g,h,p),n=ol.math.squaredDistance(g,
h,p[0],p[1]),n<l)){l=n;for(m=0;m<d;++m)k[m]=p[m];k.length=d}return l};ol.geom.flat.closest.getsClosestPoint=function(a,b,c,d,e,f,g,h,k,l,m){m=m?m:[NaN,NaN];var n;var p=0;for(n=c.length;p<n;++p){var q=c[p];l=ol.geom.flat.closest.getClosestPoint(a,b,q,d,e,f,g,h,k,l,m);b=q}return l};ol.geom.flat.closest.getssClosestPoint=function(a,b,c,d,e,f,g,h,k,l,m){m=m?m:[NaN,NaN];var n;var p=0;for(n=c.length;p<n;++p){var q=c[p];l=ol.geom.flat.closest.getsClosestPoint(a,b,q,d,e,f,g,h,k,l,m);b=q[q.length-1]}return l};ol.geom.flat.deflate={};ol.geom.flat.deflate.coordinate=function(a,b,c,d){var e;d=0;for(e=c.length;d<e;++d)a[b++]=c[d];return b};ol.geom.flat.deflate.coordinates=function(a,b,c,d){var e;var f=0;for(e=c.length;f<e;++f){var g=c[f],h;for(h=0;h<d;++h)a[b++]=g[h]}return b};ol.geom.flat.deflate.coordinatess=function(a,b,c,d,e){e=e?e:[];var f=0,g;var h=0;for(g=c.length;h<g;++h)b=ol.geom.flat.deflate.coordinates(a,b,c[h],d),e[f++]=b;e.length=f;return e};
ol.geom.flat.deflate.coordinatesss=function(a,b,c,d,e){e=e?e:[];var f=0,g;var h=0;for(g=c.length;h<g;++h)b=ol.geom.flat.deflate.coordinatess(a,b,c[h],d,e[f]),e[f++]=b,b=b[b.length-1];e.length=f;return e};ol.geom.flat.inflate={};ol.geom.flat.inflate.coordinates=function(a,b,c,d,e){e=void 0!==e?e:[];for(var f=0;b<c;b+=d)e[f++]=a.slice(b,b+d);e.length=f;return e};ol.geom.flat.inflate.coordinatess=function(a,b,c,d,e){e=void 0!==e?e:[];var f=0,g;var h=0;for(g=c.length;h<g;++h){var k=c[h];e[f++]=ol.geom.flat.inflate.coordinates(a,b,k,d,e[f]);b=k}e.length=f;return e};
ol.geom.flat.inflate.coordinatesss=function(a,b,c,d,e){e=void 0!==e?e:[];var f=0,g;var h=0;for(g=c.length;h<g;++h){var k=c[h];e[f++]=ol.geom.flat.inflate.coordinatess(a,b,k,d,e[f]);b=k[k.length-1]}e.length=f;return e};ol.geom.flat.interpolate={};
ol.geom.flat.interpolate.lineString=function(a,b,c,d,e,f){var g=NaN,h=NaN,k=(c-b)/d;if(1===k)g=a[b],h=a[b+1];else if(2==k)g=(1-e)*a[b]+e*a[b+d],h=(1-e)*a[b+1]+e*a[b+d+1];else if(0!==k){h=a[b];k=a[b+1];var l=0;g=[0];var m;for(m=b+d;m<c;m+=d){var n=a[m],p=a[m+1];l+=Math.sqrt((n-h)*(n-h)+(p-k)*(p-k));g.push(l);h=n;k=p}e*=l;c=ol.array.binarySearch(g,e);0>c?(e=(e-g[-c-2])/(g[-c-1]-g[-c-2]),b+=(-c-2)*d,g=ol.math.lerp(a[b],a[b+d],e),h=ol.math.lerp(a[b+1],a[b+d+1],e)):(g=a[b+c*d],h=a[b+c*d+1])}return f?(f[0]=
g,f[1]=h,f):[g,h]};ol.geom.flat.interpolate.lineStringCoordinateAtM=function(a,b,c,d,e,f){if(c==b)return null;if(e<a[b+d-1])return f?(c=a.slice(b,b+d),c[d-1]=e,c):null;if(a[c-1]<e)return f?(c=a.slice(c-d,c),c[d-1]=e,c):null;if(e==a[b+d-1])return a.slice(b,b+d);b/=d;for(c/=d;b<c;)f=b+c>>1,e<a[(f+1)*d-1]?c=f:b=f+1;c=a[b*d-1];if(e==c)return a.slice((b-1)*d,(b-1)*d+d);f=(e-c)/(a[(b+1)*d-1]-c);c=[];var g;for(g=0;g<d-1;++g)c.push(ol.math.lerp(a[(b-1)*d+g],a[b*d+g],f));c.push(e);return c};
ol.geom.flat.interpolate.lineStringsCoordinateAtM=function(a,b,c,d,e,f,g){if(g)return ol.geom.flat.interpolate.lineStringCoordinateAtM(a,b,c[c.length-1],d,e,f);if(e<a[d-1])return f?(a=a.slice(0,d),a[d-1]=e,a):null;if(a[a.length-1]<e)return f?(a=a.slice(a.length-d),a[d-1]=e,a):null;f=0;for(g=c.length;f<g;++f){var h=c[f];if(b!=h){if(e<a[b+d-1])break;else if(e<=a[h-1])return ol.geom.flat.interpolate.lineStringCoordinateAtM(a,b,h,d,e,!1);b=h}}return null};ol.geom.flat.contains={};ol.geom.flat.contains.linearRingContainsExtent=function(a,b,c,d,e){return!ol.extent.forEachCorner(e,function(e){return!ol.geom.flat.contains.linearRingContainsXY(a,b,c,d,e[0],e[1])})};ol.geom.flat.contains.linearRingContainsXY=function(a,b,c,d,e,f){for(var g=0,h=a[c-d],k=a[c-d+1];b<c;b+=d){var l=a[b],m=a[b+1];k<=f?m>f&&0<(l-h)*(f-k)-(e-h)*(m-k)&&g++:m<=f&&0>(l-h)*(f-k)-(e-h)*(m-k)&&g--;h=l;k=m}return 0!==g};
ol.geom.flat.contains.linearRingsContainsXY=function(a,b,c,d,e,f){if(0===c.length||!ol.geom.flat.contains.linearRingContainsXY(a,b,c[0],d,e,f))return!1;var g;b=1;for(g=c.length;b<g;++b)if(ol.geom.flat.contains.linearRingContainsXY(a,c[b-1],c[b],d,e,f))return!1;return!0};ol.geom.flat.contains.linearRingssContainsXY=function(a,b,c,d,e,f){if(0===c.length)return!1;var g;var h=0;for(g=c.length;h<g;++h){var k=c[h];if(ol.geom.flat.contains.linearRingsContainsXY(a,b,k,d,e,f))return!0;b=k[k.length-1]}return!1};ol.geom.flat.segments={};ol.geom.flat.segments.forEach=function(a,b,c,d,e,f){for(var g=[a[b],a[b+1]],h=[],k;b+d<c;b+=d){h[0]=a[b+d];h[1]=a[b+d+1];if(k=e.call(f,g,h))return k;g[0]=h[0];g[1]=h[1]}return!1};ol.geom.flat.intersectsextent={};ol.geom.flat.intersectsextent.lineString=function(a,b,c,d,e){var f=ol.extent.extendFlatCoordinates(ol.extent.createEmpty(),a,b,c,d);return ol.extent.intersects(e,f)?ol.extent.containsExtent(e,f)||f[0]>=e[0]&&f[2]<=e[2]||f[1]>=e[1]&&f[3]<=e[3]?!0:ol.geom.flat.segments.forEach(a,b,c,d,function(a,b){return ol.extent.intersectsSegment(e,a,b)}):!1};
ol.geom.flat.intersectsextent.lineStrings=function(a,b,c,d,e){var f;var g=0;for(f=c.length;g<f;++g){if(ol.geom.flat.intersectsextent.lineString(a,b,c[g],d,e))return!0;b=c[g]}return!1};
ol.geom.flat.intersectsextent.linearRing=function(a,b,c,d,e){return ol.geom.flat.intersectsextent.lineString(a,b,c,d,e)||ol.geom.flat.contains.linearRingContainsXY(a,b,c,d,e[0],e[1])||ol.geom.flat.contains.linearRingContainsXY(a,b,c,d,e[0],e[3])||ol.geom.flat.contains.linearRingContainsXY(a,b,c,d,e[2],e[1])||ol.geom.flat.contains.linearRingContainsXY(a,b,c,d,e[2],e[3])?!0:!1};
ol.geom.flat.intersectsextent.linearRings=function(a,b,c,d,e){if(!ol.geom.flat.intersectsextent.linearRing(a,b,c[0],d,e))return!1;if(1===c.length)return!0;var f;b=1;for(f=c.length;b<f;++b)if(ol.geom.flat.contains.linearRingContainsExtent(a,c[b-1],c[b],d,e))return!1;return!0};ol.geom.flat.intersectsextent.linearRingss=function(a,b,c,d,e){var f;var g=0;for(f=c.length;g<f;++g){var h=c[g];if(ol.geom.flat.intersectsextent.linearRings(a,b,h,d,e))return!0;b=h[h.length-1]}return!1};ol.geom.flat.length={};ol.geom.flat.length.lineString=function(a,b,c,d){var e=a[b],f=a[b+1],g=0;for(b+=d;b<c;b+=d){var h=a[b],k=a[b+1];g+=Math.sqrt((h-e)*(h-e)+(k-f)*(k-f));e=h;f=k}return g};ol.geom.flat.length.linearRing=function(a,b,c,d){var e=ol.geom.flat.length.lineString(a,b,c,d),f=a[c-d]-a[b];a=a[c-d+1]-a[b+1];return e+=Math.sqrt(f*f+a*a)};ol.geom.flat.simplify={};ol.geom.flat.simplify.lineString=function(a,b,c,d,e,f,g){g=void 0!==g?g:[];f||(c=ol.geom.flat.simplify.radialDistance(a,b,c,d,e,g,0),a=g,b=0,d=2);g.length=ol.geom.flat.simplify.douglasPeucker(a,b,c,d,e,g,0);return g};
ol.geom.flat.simplify.douglasPeucker=function(a,b,c,d,e,f,g){var h=(c-b)/d;if(3>h){for(;b<c;b+=d)f[g++]=a[b],f[g++]=a[b+1];return g}var k=Array(h);k[0]=1;k[h-1]=1;c=[b,c-d];for(var l=0,m;0<c.length;){var n=c.pop(),p=c.pop(),q=0,r=a[p],u=a[p+1],v=a[n],t=a[n+1];for(m=p+d;m<n;m+=d){var w=ol.math.squaredSegmentDistance(a[m],a[m+1],r,u,v,t);w>q&&(l=m,q=w)}q>e&&(k[(l-b)/d]=1,p+d<l&&c.push(p,l),l+d<n&&c.push(l,n))}for(m=0;m<h;++m)k[m]&&(f[g++]=a[b+m*d],f[g++]=a[b+m*d+1]);return g};
ol.geom.flat.simplify.douglasPeuckers=function(a,b,c,d,e,f,g,h){var k;var l=0;for(k=c.length;l<k;++l){var m=c[l];g=ol.geom.flat.simplify.douglasPeucker(a,b,m,d,e,f,g);h.push(g);b=m}return g};ol.geom.flat.simplify.douglasPeuckerss=function(a,b,c,d,e,f,g,h){var k;var l=0;for(k=c.length;l<k;++l){var m=c[l],n=[];g=ol.geom.flat.simplify.douglasPeuckers(a,b,m,d,e,f,g,n);h.push(n);b=m[m.length-1]}return g};
ol.geom.flat.simplify.radialDistance=function(a,b,c,d,e,f,g){if(c<=b+d){for(;b<c;b+=d)f[g++]=a[b],f[g++]=a[b+1];return g}var h=a[b],k=a[b+1];f[g++]=h;f[g++]=k;var l=h,m=k;for(b+=d;b<c;b+=d)l=a[b],m=a[b+1],ol.math.squaredDistance(h,k,l,m)>e&&(f[g++]=l,f[g++]=m,h=l,k=m);if(l!=h||m!=k)f[g++]=l,f[g++]=m;return g};ol.geom.flat.simplify.snap=function(a,b){return b*Math.round(a/b)};
ol.geom.flat.simplify.quantize=function(a,b,c,d,e,f,g){if(b==c)return g;var h=ol.geom.flat.simplify.snap(a[b],e),k=ol.geom.flat.simplify.snap(a[b+1],e);b+=d;f[g++]=h;f[g++]=k;do{var l=ol.geom.flat.simplify.snap(a[b],e);var m=ol.geom.flat.simplify.snap(a[b+1],e);b+=d;if(b==c)return f[g++]=l,f[g++]=m,g}while(l==h&&m==k);for(;b<c;){var n=ol.geom.flat.simplify.snap(a[b],e);var p=ol.geom.flat.simplify.snap(a[b+1],e);b+=d;if(n!=l||p!=m){var q=l-h,r=m-k,u=n-h,v=p-k;q*v==r*u&&(0>q&&u<q||q==u||0<q&&u>q)&&
(0>r&&v<r||r==v||0<r&&v>r)||(f[g++]=l,f[g++]=m,h=l,k=m);l=n;m=p}}f[g++]=l;f[g++]=m;return g};ol.geom.flat.simplify.quantizes=function(a,b,c,d,e,f,g,h){var k;var l=0;for(k=c.length;l<k;++l){var m=c[l];g=ol.geom.flat.simplify.quantize(a,b,m,d,e,f,g);h.push(g);b=m}return g};ol.geom.flat.simplify.quantizess=function(a,b,c,d,e,f,g,h){var k;var l=0;for(k=c.length;l<k;++l){var m=c[l],n=[];g=ol.geom.flat.simplify.quantizes(a,b,m,d,e,f,g,n);h.push(n);b=m[m.length-1]}return g};ol.geom.LineString=function(a,b){ol.geom.SimpleGeometry.call(this);this.flatMidpoint_=null;this.maxDeltaRevision_=this.maxDelta_=this.flatMidpointRevision_=-1;this.setCoordinates(a,b)};ol.inherits(ol.geom.LineString,ol.geom.SimpleGeometry);ol.geom.LineString.prototype.appendCoordinate=function(a){this.flatCoordinates?ol.array.extend(this.flatCoordinates,a):this.flatCoordinates=a.slice();this.changed()};
ol.geom.LineString.prototype.clone=function(){var a=new ol.geom.LineString(null);a.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return a};
ol.geom.LineString.prototype.closestPointXY=function(a,b,c,d){if(d<ol.extent.closestSquaredDistanceXY(this.getExtent(),a,b))return d;this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ol.geom.flat.closest.getMaxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision());return ol.geom.flat.closest.getClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,a,b,c,d)};
ol.geom.LineString.prototype.forEachSegment=function(a,b){return ol.geom.flat.segments.forEach(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,b)};ol.geom.LineString.prototype.getCoordinateAtM=function(a,b){return this.layout!=ol.geom.GeometryLayout.XYM&&this.layout!=ol.geom.GeometryLayout.XYZM?null:ol.geom.flat.interpolate.lineStringCoordinateAtM(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,void 0!==b?b:!1)};
ol.geom.LineString.prototype.getCoordinates=function(){return ol.geom.flat.inflate.coordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};ol.geom.LineString.prototype.getCoordinateAt=function(a,b){return ol.geom.flat.interpolate.lineString(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,b)};ol.geom.LineString.prototype.getLength=function(){return ol.geom.flat.length.lineString(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};
ol.geom.LineString.prototype.getFlatMidpoint=function(){this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision());return this.flatMidpoint_};
ol.geom.LineString.prototype.getSimplifiedGeometryInternal=function(a){var b=[];b.length=ol.geom.flat.simplify.douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,b,0);a=new ol.geom.LineString(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,b);return a};ol.geom.LineString.prototype.getType=function(){return ol.geom.GeometryType.LINE_STRING};
ol.geom.LineString.prototype.intersectsExtent=function(a){return ol.geom.flat.intersectsextent.lineString(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a)};ol.geom.LineString.prototype.setCoordinates=function(a,b){a?(this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ol.geom.flat.deflate.coordinates(this.flatCoordinates,0,a,this.stride),this.changed()):this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null)};
ol.geom.LineString.prototype.setFlatCoordinates=function(a,b){this.setFlatCoordinatesInternal(a,b);this.changed()};ol.format.IGC=function(a){a=a?a:{};ol.format.TextFeature.call(this);this.defaultDataProjection=ol.proj.get("EPSG:4326");this.altitudeMode_=a.altitudeMode?a.altitudeMode:ol.format.IGCZ.NONE};ol.inherits(ol.format.IGC,ol.format.TextFeature);ol.format.IGC.B_RECORD_RE_=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/;ol.format.IGC.H_RECORD_RE_=/^H.([A-Z]{3}).*?:(.*)/;ol.format.IGC.HFDTE_RECORD_RE_=/^HFDTE(\d{2})(\d{2})(\d{2})/;ol.format.IGC.NEWLINE_RE_=/\r\n|\r|\n/;
ol.format.IGC.prototype.readFeatureFromText=function(a,b){var c=this.altitudeMode_,d=a.split(ol.format.IGC.NEWLINE_RE_);a={};var e=[],f=2E3,g=0,h=1,k=-1,l;var m=0;for(l=d.length;m<l;++m){var n=d[m],p;if("B"==n.charAt(0)){if(p=ol.format.IGC.B_RECORD_RE_.exec(n)){n=parseInt(p[1],10);var q=parseInt(p[2],10),r=parseInt(p[3],10),u=parseInt(p[4],10)+parseInt(p[5],10)/6E4;"S"==p[6]&&(u=-u);var v=parseInt(p[7],10)+parseInt(p[8],10)/6E4;"W"==p[9]&&(v=-v);e.push(v,u);c!=ol.format.IGCZ.NONE&&(p=c==ol.format.IGCZ.GPS?
parseInt(p[11],10):c==ol.format.IGCZ.BAROMETRIC?parseInt(p[12],10):0,e.push(p));p=Date.UTC(f,g,h,n,q,r);p<k&&(p=Date.UTC(f,g,h+1,n,q,r));e.push(p/1E3);k=p}}else"H"==n.charAt(0)&&((p=ol.format.IGC.HFDTE_RECORD_RE_.exec(n))?(h=parseInt(p[1],10),g=parseInt(p[2],10)-1,f=2E3+parseInt(p[3],10)):(p=ol.format.IGC.H_RECORD_RE_.exec(n))&&(a[p[1]]=p[2].trim()))}if(0===e.length)return null;d=new ol.geom.LineString(null);d.setFlatCoordinates(c==ol.format.IGCZ.NONE?ol.geom.GeometryLayout.XYM:ol.geom.GeometryLayout.XYZM,
e);b=new ol.Feature(ol.format.Feature.transformWithOptions(d,!1,b));b.setProperties(a);return b};ol.format.IGC.prototype.readFeaturesFromText=function(a,b){return(a=this.readFeatureFromText(a,b))?[a]:[]};ol.format.IGC.prototype.writeFeatureText=function(a,b){};ol.format.IGC.prototype.writeFeaturesText=function(a,b){};ol.format.IGC.prototype.writeGeometryText=function(a,b){};ol.format.IGC.prototype.readGeometryFromText=function(a,b){};ol.ImageBase=function(a,b,c,d){ol.events.EventTarget.call(this);this.extent=a;this.pixelRatio_=c;this.resolution=b;this.state=d};ol.inherits(ol.ImageBase,ol.events.EventTarget);ol.ImageBase.prototype.changed=function(){this.dispatchEvent(ol.events.EventType.CHANGE)};ol.ImageBase.prototype.getExtent=function(){return this.extent};ol.ImageBase.prototype.getImage=function(){};ol.ImageBase.prototype.getPixelRatio=function(){return this.pixelRatio_};ol.ImageBase.prototype.getResolution=function(){return this.resolution};
ol.ImageBase.prototype.getState=function(){return this.state};ol.ImageBase.prototype.load=function(){};ol.ImageCanvas=function(a,b,c,d,e){this.loader_=void 0!==e?e:null;ol.ImageBase.call(this,a,b,c,void 0!==e?ol.ImageState.IDLE:ol.ImageState.LOADED);this.canvas_=d;this.error_=null};ol.inherits(ol.ImageCanvas,ol.ImageBase);ol.ImageCanvas.prototype.getError=function(){return this.error_};ol.ImageCanvas.prototype.handleLoad_=function(a){a?(this.error_=a,this.state=ol.ImageState.ERROR):this.state=ol.ImageState.LOADED;this.changed()};
ol.ImageCanvas.prototype.load=function(){this.state==ol.ImageState.IDLE&&(this.state=ol.ImageState.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))};ol.ImageCanvas.prototype.getImage=function(){return this.canvas_};ol.TileState={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5};ol.structs.PriorityQueue=function(a,b){this.priorityFunction_=a;this.keyFunction_=b;this.elements_=[];this.priorities_=[];this.queuedElements_={}};ol.structs.PriorityQueue.DROP=Infinity;ol.structs.PriorityQueue.prototype.clear=function(){this.elements_.length=0;this.priorities_.length=0;ol.obj.clear(this.queuedElements_)};
ol.structs.PriorityQueue.prototype.dequeue=function(){var a=this.elements_,b=this.priorities_,c=a[0];1==a.length?(a.length=0,b.length=0):(a[0]=a.pop(),b[0]=b.pop(),this.siftUp_(0));a=this.keyFunction_(c);delete this.queuedElements_[a];return c};
ol.structs.PriorityQueue.prototype.enqueue=function(a){ol.asserts.assert(!(this.keyFunction_(a)in this.queuedElements_),31);var b=this.priorityFunction_(a);return b!=ol.structs.PriorityQueue.DROP?(this.elements_.push(a),this.priorities_.push(b),this.queuedElements_[this.keyFunction_(a)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1};ol.structs.PriorityQueue.prototype.getCount=function(){return this.elements_.length};
ol.structs.PriorityQueue.prototype.getLeftChildIndex_=function(a){return 2*a+1};ol.structs.PriorityQueue.prototype.getRightChildIndex_=function(a){return 2*a+2};ol.structs.PriorityQueue.prototype.getParentIndex_=function(a){return a-1>>1};ol.structs.PriorityQueue.prototype.heapify_=function(){var a;for(a=(this.elements_.length>>1)-1;0<=a;a--)this.siftUp_(a)};ol.structs.PriorityQueue.prototype.isEmpty=function(){return 0===this.elements_.length};
ol.structs.PriorityQueue.prototype.isKeyQueued=function(a){return a in this.queuedElements_};ol.structs.PriorityQueue.prototype.isQueued=function(a){return this.isKeyQueued(this.keyFunction_(a))};ol.structs.PriorityQueue.prototype.siftUp_=function(a){for(var b=this.elements_,c=this.priorities_,d=b.length,e=b[a],f=c[a],g=a;a<d>>1;){var h=this.getLeftChildIndex_(a),k=this.getRightChildIndex_(a);h=k<d&&c[k]<c[h]?k:h;b[a]=b[h];c[a]=c[h];a=h}b[a]=e;c[a]=f;this.siftDown_(g,a)};
ol.structs.PriorityQueue.prototype.siftDown_=function(a,b){for(var c=this.elements_,d=this.priorities_,e=c[b],f=d[b];b>a;){var g=this.getParentIndex_(b);if(d[g]>f)c[b]=c[g],d[b]=d[g],b=g;else break}c[b]=e;d[b]=f};
ol.structs.PriorityQueue.prototype.reprioritize=function(){var a=this.priorityFunction_,b=this.elements_,c=this.priorities_,d=0,e=b.length,f;for(f=0;f<e;++f){var g=b[f];var h=a(g);h==ol.structs.PriorityQueue.DROP?delete this.queuedElements_[this.keyFunction_(g)]:(c[d]=h,b[d++]=g)}b.length=d;c.length=d;this.heapify_()};ol.TileQueue=function(a,b){ol.structs.PriorityQueue.call(this,function(b){return a.apply(null,b)},function(a){return a[0].getKey()});this.tileChangeCallback_=b;this.tilesLoading_=0;this.tilesLoadingKeys_={}};ol.inherits(ol.TileQueue,ol.structs.PriorityQueue);ol.TileQueue.prototype.enqueue=function(a){var b=ol.structs.PriorityQueue.prototype.enqueue.call(this,a);b&&ol.events.listen(a[0],ol.events.EventType.CHANGE,this.handleTileChange,this);return b};ol.TileQueue.prototype.getTilesLoading=function(){return this.tilesLoading_};
ol.TileQueue.prototype.handleTileChange=function(a){a=a.target;var b=a.getState();if(b===ol.TileState.LOADED||b===ol.TileState.ERROR||b===ol.TileState.EMPTY||b===ol.TileState.ABORT)ol.events.unlisten(a,ol.events.EventType.CHANGE,this.handleTileChange,this),a=a.getKey(),a in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[a],--this.tilesLoading_),this.tileChangeCallback_()};
ol.TileQueue.prototype.loadMoreTiles=function(a,b){for(var c=0,d=!1,e,f,g;this.tilesLoading_<a&&c<b&&0<this.getCount();)f=this.dequeue()[0],g=f.getKey(),e=f.getState(),e===ol.TileState.ABORT?d=!0:e!==ol.TileState.IDLE||g in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[g]=!0,++this.tilesLoading_,++c,f.load());0===c&&d&&this.tileChangeCallback_()};ol.ext={};ol.ext.pixelworks={};ol.ext.pixelworks.Processor=function(){};
(function(){(function(a){function b(a){var b=!0;try{new ImageData(10,10)}catch(m){b=!1}return function(c){var d=c.buffers,e=c.meta,f=c.width,g=c.height,h=d.length,k=d[0].byteLength;if(c.imageOps){k=Array(h);for(c=0;c<h;++c){var l=c;var m=new Uint8ClampedArray(d[c]);var x=f,z=g;m=b?new ImageData(m,x,z):{data:m,width:x,height:z};k[l]=m}f=a(k,e).data}else{f=new Uint8ClampedArray(k);g=Array(h);l=Array(h);for(c=0;c<h;++c)g[c]=new Uint8ClampedArray(d[c]),l[c]=[0,0,0,0];for(d=0;d<k;d+=4){for(c=0;c<h;++c)m=
g[c],l[c][0]=m[d],l[c][1]=m[d+1],l[c][2]=m[d+2],l[c][3]=m[d+3];c=a(l,e);f[d]=c[0];f[d+1]=c[1];f[d+2]=c[2];f[d+3]=c[3]}}return f.buffer}}function c(a,c){var d=Object.keys(a.lib||{}).map(function(b){return"var "+b+" = "+a.lib[b].toString()+";"}).concat(["var __minion__ = ("+b.toString()+")(",a.operation.toString(),");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]);d=new Blob(d,
{type:"text/javascript"});d=URL.createObjectURL(d);d=new Worker(d);d.addEventListener("message",c);return d}function d(a,c){var d=b(a.operation);return{postMessage:function(a){setTimeout(function(){c({data:{buffer:d(a),meta:a.meta}})},0)}}}function e(a){this._imageOps=!!a.imageOps;var b=0===a.threads?0:this._imageOps?1:a.threads||1;var e=[];if(b)for(var f=0;f<b;++f)e[f]=c(a,this._onWorkerMessage.bind(this,f));else e[0]=d(a,this._onWorkerMessage.bind(this,0));this._workers=e;this._queue=[];this._maxQueueLength=
a.queue||Infinity;this._running=0;this._dataLookup={};this._job=null}var f=!0;try{new ImageData(10,10)}catch(k){f=!1}var g=document.createElement("canvas").getContext("2d"),h=function(a,b,c){if(f)return new ImageData(a,b,c);b=g.createImageData(b,c);b.data.set(a);return b};e.prototype.process=function(a,b,c){this._enqueue({inputs:a,meta:b,callback:c});this._dispatch()};e.prototype.destroy=function(){for(var a in this)this[a]=null;this._destroyed=!0};e.prototype._enqueue=function(a){for(this._queue.push(a);this._queue.length>
this._maxQueueLength;)this._queue.shift().callback(null,null)};e.prototype._dispatch=function(){if(0===this._running&&0<this._queue.length){var a=this._job=this._queue.shift(),b=a.inputs[0].width,c=a.inputs[0].height,d=a.inputs.map(function(a){return a.data.buffer}),e=this._workers.length;this._running=e;if(1===e)this._workers[0].postMessage({buffers:d,meta:a.meta,imageOps:this._imageOps,width:b,height:c},d);else for(var f=4*Math.ceil(a.inputs[0].data.length/4/e),g=0;g<e;++g){for(var h=g*f,v=[],t=
0,w=d.length;t<w;++t)v.push(d[g].slice(h,h+f));this._workers[g].postMessage({buffers:v,meta:a.meta,imageOps:this._imageOps,width:b,height:c},v)}}};e.prototype._onWorkerMessage=function(a,b){this._destroyed||(this._dataLookup[a]=b.data,--this._running,0===this._running&&this._resolveJob())};e.prototype._resolveJob=function(){var a=this._job,b=this._workers.length;if(1===b){var c=new Uint8ClampedArray(this._dataLookup[0].buffer);var d=this._dataLookup[0].meta}else{var e=a.inputs[0].data.length;c=new Uint8ClampedArray(e);
d=Array(e);e=4*Math.ceil(e/4/b);for(var f=0;f<b;++f){var g=f*e;c.set(new Uint8ClampedArray(this._dataLookup[f].buffer),g);d[f]=this._dataLookup[f].meta}}this._job=null;this._dataLookup={};a.callback(null,h(c,a.inputs[0].width,a.inputs[0].height),d);this._dispatch()};a["default"]={Processor:e};a.Processor=e})(this.pixelworks=this.pixelworks||{})}).call(ol.ext);ol.LayerType={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"};ol.layer={};ol.layer.Property={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"};ol.layer.Base=function(a){ol.Object.call(this);var b=ol.obj.assign({},a);b[ol.layer.Property.OPACITY]=void 0!==a.opacity?a.opacity:1;b[ol.layer.Property.VISIBLE]=void 0!==a.visible?a.visible:!0;b[ol.layer.Property.Z_INDEX]=void 0!==a.zIndex?a.zIndex:0;b[ol.layer.Property.MAX_RESOLUTION]=void 0!==a.maxResolution?a.maxResolution:Infinity;b[ol.layer.Property.MIN_RESOLUTION]=void 0!==a.minResolution?a.minResolution:0;this.setProperties(b);this.state_={layer:this,managed:!0}};
ol.inherits(ol.layer.Base,ol.Object);ol.layer.Base.prototype.getType=function(){return this.type};ol.layer.Base.prototype.getLayerState=function(){this.state_.opacity=ol.math.clamp(this.getOpacity(),0,1);this.state_.sourceState=this.getSourceState();this.state_.visible=this.getVisible();this.state_.extent=this.getExtent();this.state_.zIndex=this.getZIndex();this.state_.maxResolution=this.getMaxResolution();this.state_.minResolution=Math.max(this.getMinResolution(),0);return this.state_};
ol.layer.Base.prototype.getLayersArray=function(a){};ol.layer.Base.prototype.getLayerStatesArray=function(a){};ol.layer.Base.prototype.getExtent=function(){return this.get(ol.layer.Property.EXTENT)};ol.layer.Base.prototype.getMaxResolution=function(){return this.get(ol.layer.Property.MAX_RESOLUTION)};ol.layer.Base.prototype.getMinResolution=function(){return this.get(ol.layer.Property.MIN_RESOLUTION)};ol.layer.Base.prototype.getOpacity=function(){return this.get(ol.layer.Property.OPACITY)};
ol.layer.Base.prototype.getSourceState=function(){};ol.layer.Base.prototype.getVisible=function(){return this.get(ol.layer.Property.VISIBLE)};ol.layer.Base.prototype.getZIndex=function(){return this.get(ol.layer.Property.Z_INDEX)};ol.layer.Base.prototype.setExtent=function(a){this.set(ol.layer.Property.EXTENT,a)};ol.layer.Base.prototype.setMaxResolution=function(a){this.set(ol.layer.Property.MAX_RESOLUTION,a)};
ol.layer.Base.prototype.setMinResolution=function(a){this.set(ol.layer.Property.MIN_RESOLUTION,a)};ol.layer.Base.prototype.setOpacity=function(a){this.set(ol.layer.Property.OPACITY,a)};ol.layer.Base.prototype.setVisible=function(a){this.set(ol.layer.Property.VISIBLE,a)};ol.layer.Base.prototype.setZIndex=function(a){this.set(ol.layer.Property.Z_INDEX,a)};ol.render.EventType={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render"};ol.source={};ol.source.State={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};ol.layer.Layer=function(a){var b=ol.obj.assign({},a);delete b.source;ol.layer.Base.call(this,b);this.sourceChangeKey_=this.mapRenderKey_=this.mapPrecomposeKey_=null;a.map&&this.setMap(a.map);ol.events.listen(this,ol.Object.getChangeEventType(ol.layer.Property.SOURCE),this.handleSourcePropertyChange_,this);this.setSource(a.source?a.source:null)};ol.inherits(ol.layer.Layer,ol.layer.Base);ol.layer.Layer.visibleAtResolution=function(a,b){return a.visible&&b>=a.minResolution&&b<a.maxResolution};
ol.layer.Layer.prototype.getLayersArray=function(a){a=a?a:[];a.push(this);return a};ol.layer.Layer.prototype.getLayerStatesArray=function(a){a=a?a:[];a.push(this.getLayerState());return a};ol.layer.Layer.prototype.getSource=function(){return this.get(ol.layer.Property.SOURCE)||null};ol.layer.Layer.prototype.getSourceState=function(){var a=this.getSource();return a?a.getState():ol.source.State.UNDEFINED};ol.layer.Layer.prototype.handleSourceChange_=function(){this.changed()};
ol.layer.Layer.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(ol.events.unlistenByKey(this.sourceChangeKey_),this.sourceChangeKey_=null);var a=this.getSource();a&&(this.sourceChangeKey_=ol.events.listen(a,ol.events.EventType.CHANGE,this.handleSourceChange_,this));this.changed()};
ol.layer.Layer.prototype.setMap=function(a){this.mapPrecomposeKey_&&(ol.events.unlistenByKey(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null);a||this.changed();this.mapRenderKey_&&(ol.events.unlistenByKey(this.mapRenderKey_),this.mapRenderKey_=null);a&&(this.mapPrecomposeKey_=ol.events.listen(a,ol.render.EventType.PRECOMPOSE,function(a){var b=this.getLayerState();b.managed=!1;b.zIndex=Infinity;a.frameState.layerStatesArray.push(b);a.frameState.layerStates[ol.getUid(this)]=b},this),this.mapRenderKey_=
ol.events.listen(this,ol.events.EventType.CHANGE,a.render,a),this.changed())};ol.layer.Layer.prototype.setSource=function(a){this.set(ol.layer.Property.SOURCE,a)};ol.layer.Image=function(a){ol.layer.Layer.call(this,a?a:{});this.type=ol.LayerType.IMAGE};ol.inherits(ol.layer.Image,ol.layer.Layer);ol.layer.TileProperty={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};ol.layer.Tile=function(a){a=a?a:{};var b=ol.obj.assign({},a);delete b.preload;delete b.useInterimTilesOnError;ol.layer.Layer.call(this,b);this.setPreload(void 0!==a.preload?a.preload:0);this.setUseInterimTilesOnError(void 0!==a.useInterimTilesOnError?a.useInterimTilesOnError:!0);this.type=ol.LayerType.TILE};ol.inherits(ol.layer.Tile,ol.layer.Layer);ol.layer.Tile.prototype.getPreload=function(){return this.get(ol.layer.TileProperty.PRELOAD)};
ol.layer.Tile.prototype.setPreload=function(a){this.set(ol.layer.TileProperty.PRELOAD,a)};ol.layer.Tile.prototype.getUseInterimTilesOnError=function(){return this.get(ol.layer.TileProperty.USE_INTERIM_TILES_ON_ERROR)};ol.layer.Tile.prototype.setUseInterimTilesOnError=function(a){this.set(ol.layer.TileProperty.USE_INTERIM_TILES_ON_ERROR,a)};ol.ViewHint={ANIMATING:0,INTERACTING:1};ol.renderer={};ol.renderer.Type={CANVAS:"canvas",WEBGL:"webgl"};ol.string={};ol.string.padNumber=function(a,b,c){a=void 0!==c?a.toFixed(c):""+a;c=a.indexOf(".");c=-1===c?a.length:c;return c>b?a:Array(1+b-c).join("0")+a};ol.string.compareVersions=function(a,b){a=(""+a).split(".");b=(""+b).split(".");for(var c=0;c<Math.max(a.length,b.length);c++){var d=parseInt(a[c]||"0",10),e=parseInt(b[c]||"0",10);if(d>e)return 1;if(e>d)return-1}return 0};ol.coordinate={};ol.coordinate.add=function(a,b){a[0]+=b[0];a[1]+=b[1];return a};ol.coordinate.closestOnCircle=function(a,b){var c=b.getRadius(),d=b.getCenter();b=d[0];d=d[1];var e=a[0]-b;a=a[1]-d;0===e&&0===a&&(e=1);var f=Math.sqrt(e*e+a*a);return[b+c*e/f,d+c*a/f]};
ol.coordinate.closestOnSegment=function(a,b){var c=a[0];a=a[1];var d=b[0],e=b[1];b=d[0];d=d[1];var f=e[0];e=e[1];var g=f-b,h=e-d;c=0===g&&0===h?0:(g*(c-b)+h*(a-d))/(g*g+h*h||0);0>=c?(a=b,c=d):1<=c?(a=f,c=e):(a=b+c*g,c=d+c*h);return[a,c]};ol.coordinate.createStringXY=function(a){return function(b){return ol.coordinate.toStringXY(b,a)}};
ol.coordinate.degreesToStringHDMS=function(a,b,c){b=ol.math.modulo(b+180,360)-180;var d=Math.abs(3600*b);c=c||0;var e=Math.pow(10,c),f=Math.floor(d/3600),g=Math.floor((d-3600*f)/60);d=Math.ceil((d-3600*f-60*g)*e)/e;60<=d&&(d=0,g+=1);60<=g&&(g=0,f+=1);return f+"\u00b0 "+ol.string.padNumber(g,2)+"\u2032 "+ol.string.padNumber(d,2,c)+"\u2033"+(0==b?"":" "+a.charAt(0>b?1:0))};ol.coordinate.format=function(a,b,c){return a?b.replace("{x}",a[0].toFixed(c)).replace("{y}",a[1].toFixed(c)):""};
ol.coordinate.equals=function(a,b){for(var c=!0,d=a.length-1;0<=d;--d)if(a[d]!=b[d]){c=!1;break}return c};ol.coordinate.rotate=function(a,b){var c=Math.cos(b);b=Math.sin(b);var d=a[1]*c+a[0]*b;a[0]=a[0]*c-a[1]*b;a[1]=d;return a};ol.coordinate.scale=function(a,b){a[0]*=b;a[1]*=b;return a};ol.coordinate.sub=function(a,b){a[0]-=b[0];a[1]-=b[1];return a};ol.coordinate.squaredDistance=function(a,b){var c=a[0]-b[0];a=a[1]-b[1];return c*c+a*a};
ol.coordinate.distance=function(a,b){return Math.sqrt(ol.coordinate.squaredDistance(a,b))};ol.coordinate.squaredDistanceToSegment=function(a,b){return ol.coordinate.squaredDistance(a,ol.coordinate.closestOnSegment(a,b))};ol.coordinate.toStringHDMS=function(a,b){return a?ol.coordinate.degreesToStringHDMS("NS",a[1],b)+" "+ol.coordinate.degreesToStringHDMS("EW",a[0],b):""};ol.coordinate.toStringXY=function(a,b){return ol.coordinate.format(a,"{x}, {y}",b)};ol.render.Event=function(a,b,c,d,e){ol.events.Event.call(this,a);this.vectorContext=b;this.frameState=c;this.context=d;this.glContext=e};ol.inherits(ol.render.Event,ol.events.Event);ol.render.VectorContext=function(){};ol.render.VectorContext.prototype.drawCustom=function(a,b,c){};ol.render.VectorContext.prototype.drawGeometry=function(a){};ol.render.VectorContext.prototype.setStyle=function(a){};ol.render.VectorContext.prototype.drawCircle=function(a,b){};ol.render.VectorContext.prototype.drawFeature=function(a,b){};ol.render.VectorContext.prototype.drawGeometryCollection=function(a,b){};ol.render.VectorContext.prototype.drawLineString=function(a,b){};
ol.render.VectorContext.prototype.drawMultiLineString=function(a,b){};ol.render.VectorContext.prototype.drawMultiPoint=function(a,b){};ol.render.VectorContext.prototype.drawMultiPolygon=function(a,b){};ol.render.VectorContext.prototype.drawPoint=function(a,b){};ol.render.VectorContext.prototype.drawPolygon=function(a,b){};ol.render.VectorContext.prototype.drawText=function(a,b){};ol.render.VectorContext.prototype.setFillStrokeStyle=function(a,b){};
ol.render.VectorContext.prototype.setImageStyle=function(a,b){};ol.render.VectorContext.prototype.setTextStyle=function(a,b){};ol.render.canvas.Immediate=function(a,b,c,d,e){ol.render.VectorContext.call(this);this.context_=a;this.pixelRatio_=b;this.extent_=c;this.transform_=d;this.viewRotation_=e;this.image_=this.strokeState_=this.fillState_=this.contextTextState_=this.contextStrokeState_=this.contextFillState_=null;this.imageOriginY_=this.imageOriginX_=this.imageOpacity_=this.imageHeight_=this.imageAnchorY_=this.imageAnchorX_=0;this.imageRotateWithView_=!1;this.imageScale_=this.imageRotation_=0;this.imageSnapToPixel_=!1;
this.imageWidth_=0;this.text_="";this.textOffsetY_=this.textOffsetX_=0;this.textRotateWithView_=!1;this.textScale_=this.textRotation_=0;this.textState_=this.textStrokeState_=this.textFillState_=null;this.pixelCoordinates_=[];this.tmpLocalTransform_=ol.transform.create()};ol.inherits(ol.render.canvas.Immediate,ol.render.VectorContext);
ol.render.canvas.Immediate.prototype.drawImages_=function(a,b,c,d){if(this.image_){a=ol.geom.flat.transform.transform2D(a,b,c,2,this.transform_,this.pixelCoordinates_);b=this.context_;c=this.tmpLocalTransform_;d=b.globalAlpha;1!=this.imageOpacity_&&(b.globalAlpha=d*this.imageOpacity_);var e=this.imageRotation_;this.imageRotateWithView_&&(e+=this.viewRotation_);var f;var g=0;for(f=a.length;g<f;g+=2){var h=a[g]-this.imageAnchorX_,k=a[g+1]-this.imageAnchorY_;this.imageSnapToPixel_&&(h=Math.round(h),
k=Math.round(k));if(0!==e||1!=this.imageScale_){var l=h+this.imageAnchorX_,m=k+this.imageAnchorY_;ol.transform.compose(c,l,m,this.imageScale_,this.imageScale_,e,-l,-m);b.setTransform.apply(b,c)}b.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,h,k,this.imageWidth_,this.imageHeight_)}0===e&&1==this.imageScale_||b.setTransform(1,0,0,1,0,0);1!=this.imageOpacity_&&(b.globalAlpha=d)}};
ol.render.canvas.Immediate.prototype.drawText_=function(a,b,c,d){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_);this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_);this.setContextTextState_(this.textState_);a=ol.geom.flat.transform.transform2D(a,b,c,d,this.transform_,this.pixelCoordinates_);var e=this.context_,f=this.textRotation_;for(this.textRotateWithView_&&(f+=this.viewRotation_);b<c;b+=d){var g=a[b]+this.textOffsetX_,
h=a[b+1]+this.textOffsetY_;if(0!==f||1!=this.textScale_){var k=ol.transform.compose(this.tmpLocalTransform_,g,h,this.textScale_,this.textScale_,f,-g,-h);e.setTransform.apply(e,k)}this.textStrokeState_&&e.strokeText(this.text_,g,h);this.textFillState_&&e.fillText(this.text_,g,h)}0===f&&1==this.textScale_||e.setTransform(1,0,0,1,0,0)}};
ol.render.canvas.Immediate.prototype.moveToLineTo_=function(a,b,c,d,e){var f=this.context_;a=ol.geom.flat.transform.transform2D(a,b,c,d,this.transform_,this.pixelCoordinates_);f.moveTo(a[0],a[1]);b=a.length;e&&(b-=2);for(d=2;d<b;d+=2)f.lineTo(a[d],a[d+1]);e&&f.closePath();return c};ol.render.canvas.Immediate.prototype.drawRings_=function(a,b,c,d){var e;var f=0;for(e=c.length;f<e;++f)b=this.moveToLineTo_(a,b,c[f],d,!0);return b};
ol.render.canvas.Immediate.prototype.drawCircle=function(a){if(ol.extent.intersects(this.extent_,a.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_);this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var b=ol.geom.SimpleGeometry.transform2D(a,this.transform_,this.pixelCoordinates_),c=b[2]-b[0],d=b[3]-b[1];c=Math.sqrt(c*c+d*d);d=this.context_;d.beginPath();d.arc(b[0],b[1],c,0,2*Math.PI);this.fillState_&&d.fill();this.strokeState_&&
d.stroke()}""!==this.text_&&this.drawText_(a.getCenter(),0,2,2)}};ol.render.canvas.Immediate.prototype.setStyle=function(a){this.setFillStrokeStyle(a.getFill(),a.getStroke());this.setImageStyle(a.getImage());this.setTextStyle(a.getText())};
ol.render.canvas.Immediate.prototype.drawGeometry=function(a){switch(a.getType()){case ol.geom.GeometryType.POINT:this.drawPoint(a);break;case ol.geom.GeometryType.LINE_STRING:this.drawLineString(a);break;case ol.geom.GeometryType.POLYGON:this.drawPolygon(a);break;case ol.geom.GeometryType.MULTI_POINT:this.drawMultiPoint(a);break;case ol.geom.GeometryType.MULTI_LINE_STRING:this.drawMultiLineString(a);break;case ol.geom.GeometryType.MULTI_POLYGON:this.drawMultiPolygon(a);break;case ol.geom.GeometryType.GEOMETRY_COLLECTION:this.drawGeometryCollection(a);
break;case ol.geom.GeometryType.CIRCLE:this.drawCircle(a)}};ol.render.canvas.Immediate.prototype.drawFeature=function(a,b){(a=b.getGeometryFunction()(a))&&ol.extent.intersects(this.extent_,a.getExtent())&&(this.setStyle(b),this.drawGeometry(a))};ol.render.canvas.Immediate.prototype.drawGeometryCollection=function(a){a=a.getGeometriesArray();var b;var c=0;for(b=a.length;c<b;++c)this.drawGeometry(a[c])};
ol.render.canvas.Immediate.prototype.drawPoint=function(a){var b=a.getFlatCoordinates();a=a.getStride();this.image_&&this.drawImages_(b,0,b.length,a);""!==this.text_&&this.drawText_(b,0,b.length,a)};ol.render.canvas.Immediate.prototype.drawMultiPoint=function(a){var b=a.getFlatCoordinates();a=a.getStride();this.image_&&this.drawImages_(b,0,b.length,a);""!==this.text_&&this.drawText_(b,0,b.length,a)};
ol.render.canvas.Immediate.prototype.drawLineString=function(a){if(ol.extent.intersects(this.extent_,a.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var b=this.context_,c=a.getFlatCoordinates();b.beginPath();this.moveToLineTo_(c,0,c.length,a.getStride(),!1);b.stroke()}""!==this.text_&&(a=a.getFlatMidpoint(),this.drawText_(a,0,2,2))}};
ol.render.canvas.Immediate.prototype.drawMultiLineString=function(a){var b=a.getExtent();if(ol.extent.intersects(this.extent_,b)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);b=this.context_;var c=a.getFlatCoordinates(),d=0,e=a.getEnds(),f=a.getStride();b.beginPath();var g;var h=0;for(g=e.length;h<g;++h)d=this.moveToLineTo_(c,d,e[h],f,!1);b.stroke()}""!==this.text_&&(a=a.getFlatMidpoints(),this.drawText_(a,0,a.length,2))}};
ol.render.canvas.Immediate.prototype.drawPolygon=function(a){if(ol.extent.intersects(this.extent_,a.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_);this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var b=this.context_;b.beginPath();this.drawRings_(a.getOrientedFlatCoordinates(),0,a.getEnds(),a.getStride());this.fillState_&&b.fill();this.strokeState_&&b.stroke()}""!==this.text_&&(a=a.getFlatInteriorPoint(),this.drawText_(a,
0,2,2))}};
ol.render.canvas.Immediate.prototype.drawMultiPolygon=function(a){if(ol.extent.intersects(this.extent_,a.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_);this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var b=this.context_,c=a.getOrientedFlatCoordinates(),d=0,e=a.getEndss(),f=a.getStride(),g;b.beginPath();var h=0;for(g=e.length;h<g;++h)d=this.drawRings_(c,d,e[h],f);this.fillState_&&b.fill();this.strokeState_&&b.stroke()}""!==
this.text_&&(a=a.getFlatInteriorPoints(),this.drawText_(a,0,a.length,2))}};ol.render.canvas.Immediate.prototype.setContextFillState_=function(a){var b=this.context_,c=this.contextFillState_;c?c.fillStyle!=a.fillStyle&&(c.fillStyle=b.fillStyle=a.fillStyle):(b.fillStyle=a.fillStyle,this.contextFillState_={fillStyle:a.fillStyle})};
ol.render.canvas.Immediate.prototype.setContextStrokeState_=function(a){var b=this.context_,c=this.contextStrokeState_;c?(c.lineCap!=a.lineCap&&(c.lineCap=b.lineCap=a.lineCap),ol.has.CANVAS_LINE_DASH&&(ol.array.equals(c.lineDash,a.lineDash)||b.setLineDash(c.lineDash=a.lineDash),c.lineDashOffset!=a.lineDashOffset&&(c.lineDashOffset=b.lineDashOffset=a.lineDashOffset)),c.lineJoin!=a.lineJoin&&(c.lineJoin=b.lineJoin=a.lineJoin),c.lineWidth!=a.lineWidth&&(c.lineWidth=b.lineWidth=a.lineWidth),c.miterLimit!=
a.miterLimit&&(c.miterLimit=b.miterLimit=a.miterLimit),c.strokeStyle!=a.strokeStyle&&(c.strokeStyle=b.strokeStyle=a.strokeStyle)):(b.lineCap=a.lineCap,ol.has.CANVAS_LINE_DASH&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.lineJoin=a.lineJoin,b.lineWidth=a.lineWidth,b.miterLimit=a.miterLimit,b.strokeStyle=a.strokeStyle,this.contextStrokeState_={lineCap:a.lineCap,lineDash:a.lineDash,lineDashOffset:a.lineDashOffset,lineJoin:a.lineJoin,lineWidth:a.lineWidth,miterLimit:a.miterLimit,strokeStyle:a.strokeStyle})};
ol.render.canvas.Immediate.prototype.setContextTextState_=function(a){var b=this.context_,c=this.contextTextState_,d=a.textAlign?a.textAlign:ol.render.canvas.defaultTextAlign;c?(c.font!=a.font&&(c.font=b.font=a.font),c.textAlign!=d&&(c.textAlign=d),c.textBaseline!=a.textBaseline&&(c.textBaseline=b.textBaseline=a.textBaseline)):(b.font=a.font,b.textAlign=d,b.textBaseline=a.textBaseline,this.contextTextState_={font:a.font,textAlign:d,textBaseline:a.textBaseline})};
ol.render.canvas.Immediate.prototype.setFillStrokeStyle=function(a,b){a?(a=a.getColor(),this.fillState_={fillStyle:ol.colorlike.asColorLike(a?a:ol.render.canvas.defaultFillStyle)}):this.fillState_=null;if(b){a=b.getColor();var c=b.getLineCap(),d=b.getLineDash(),e=b.getLineDashOffset(),f=b.getLineJoin(),g=b.getWidth();b=b.getMiterLimit();this.strokeState_={lineCap:void 0!==c?c:ol.render.canvas.defaultLineCap,lineDash:d?d:ol.render.canvas.defaultLineDash,lineDashOffset:e?e:ol.render.canvas.defaultLineDashOffset,
lineJoin:void 0!==f?f:ol.render.canvas.defaultLineJoin,lineWidth:this.pixelRatio_*(void 0!==g?g:ol.render.canvas.defaultLineWidth),miterLimit:void 0!==b?b:ol.render.canvas.defaultMiterLimit,strokeStyle:ol.colorlike.asColorLike(a?a:ol.render.canvas.defaultStrokeStyle)}}else this.strokeState_=null};
ol.render.canvas.Immediate.prototype.setImageStyle=function(a){if(a){var b=a.getAnchor(),c=a.getImage(1),d=a.getOrigin(),e=a.getSize();this.imageAnchorX_=b[0];this.imageAnchorY_=b[1];this.imageHeight_=e[1];this.image_=c;this.imageOpacity_=a.getOpacity();this.imageOriginX_=d[0];this.imageOriginY_=d[1];this.imageRotateWithView_=a.getRotateWithView();this.imageRotation_=a.getRotation();this.imageScale_=a.getScale()*this.pixelRatio_;this.imageSnapToPixel_=a.getSnapToPixel();this.imageWidth_=e[0]}else this.image_=
null};
ol.render.canvas.Immediate.prototype.setTextStyle=function(a){if(a){var b=a.getFill();b?(b=b.getColor(),this.textFillState_={fillStyle:ol.colorlike.asColorLike(b?b:ol.render.canvas.defaultFillStyle)}):this.textFillState_=null;var c=a.getStroke();if(c){b=c.getColor();var d=c.getLineCap(),e=c.getLineDash(),f=c.getLineDashOffset(),g=c.getLineJoin(),h=c.getWidth();c=c.getMiterLimit();this.textStrokeState_={lineCap:void 0!==d?d:ol.render.canvas.defaultLineCap,lineDash:e?e:ol.render.canvas.defaultLineDash,lineDashOffset:f?
f:ol.render.canvas.defaultLineDashOffset,lineJoin:void 0!==g?g:ol.render.canvas.defaultLineJoin,lineWidth:void 0!==h?h:ol.render.canvas.defaultLineWidth,miterLimit:void 0!==c?c:ol.render.canvas.defaultMiterLimit,strokeStyle:ol.colorlike.asColorLike(b?b:ol.render.canvas.defaultStrokeStyle)}}else this.textStrokeState_=null;b=a.getFont();d=a.getOffsetX();e=a.getOffsetY();f=a.getRotateWithView();g=a.getRotation();h=a.getScale();c=a.getText();var k=a.getTextAlign();a=a.getTextBaseline();this.textState_=
{font:void 0!==b?b:ol.render.canvas.defaultFont,textAlign:void 0!==k?k:ol.render.canvas.defaultTextAlign,textBaseline:void 0!==a?a:ol.render.canvas.defaultTextBaseline};this.text_=void 0!==c?c:"";this.textOffsetX_=void 0!==d?this.pixelRatio_*d:0;this.textOffsetY_=void 0!==e?this.pixelRatio_*e:0;this.textRotateWithView_=void 0!==f?f:!1;this.textRotation_=void 0!==g?g:0;this.textScale_=this.pixelRatio_*(void 0!==h?h:1)}else this.text_=""};ol.renderer.Layer=function(a){ol.Observable.call(this);this.layer_=a};ol.inherits(ol.renderer.Layer,ol.Observable);ol.renderer.Layer.prototype.forEachFeatureAtCoordinate=ol.nullFunction;ol.renderer.Layer.prototype.hasFeatureAtCoordinate=ol.functions.FALSE;ol.renderer.Layer.prototype.createLoadedTileFinder=function(a,b,c){return function(d,e){return a.forEachLoadedTile(b,d,e,function(a){c[d]||(c[d]={});c[d][a.tileCoord.toString()]=a})}};ol.renderer.Layer.prototype.getLayer=function(){return this.layer_};
ol.renderer.Layer.prototype.handleImageChange_=function(a){a.target.getState()===ol.ImageState.LOADED&&this.renderIfReadyAndVisible()};ol.renderer.Layer.prototype.loadImage=function(a){var b=a.getState();b!=ol.ImageState.LOADED&&b!=ol.ImageState.ERROR&&ol.events.listen(a,ol.events.EventType.CHANGE,this.handleImageChange_,this);b==ol.ImageState.IDLE&&(a.load(),b=a.getState());return b==ol.ImageState.LOADED};
ol.renderer.Layer.prototype.renderIfReadyAndVisible=function(){var a=this.getLayer();a.getVisible()&&a.getSourceState()==ol.source.State.READY&&this.changed()};ol.renderer.Layer.prototype.scheduleExpireCache=function(a,b){b.canExpireCache()&&(b=function(a,b,e){b=ol.getUid(a).toString();b in e.usedTiles&&a.expireCache(e.viewState.projection,e.usedTiles[b])}.bind(null,b),a.postRenderFunctions.push(b))};
ol.renderer.Layer.prototype.updateLogos=function(a,b){b=b.getLogo();void 0!==b&&("string"===typeof b?a.logos[b]="":b&&(ol.asserts.assert("string"==typeof b.href,44),ol.asserts.assert("string"==typeof b.src,45),a.logos[b.src]=b.href))};ol.renderer.Layer.prototype.updateUsedTiles=function(a,b,c,d){b=ol.getUid(b).toString();c=c.toString();b in a?c in a[b]?a[b][c].extend(d):a[b][c]=d:(a[b]={},a[b][c]=d)};
ol.renderer.Layer.prototype.manageTilePyramid=function(a,b,c,d,e,f,g,h,k,l){var m=ol.getUid(b).toString();m in a.wantedTiles||(a.wantedTiles[m]={});var n=a.wantedTiles[m];a=a.tileQueue;var p,q,r;for(r=c.getMinZoom();r<=g;++r){var u=c.getTileRangeForExtentAndZ(f,r,u);var v=c.getResolution(r);for(p=u.minX;p<=u.maxX;++p)for(q=u.minY;q<=u.maxY;++q)if(g-r<=h){var t=b.getTile(r,p,q,d,e);t.getState()==ol.TileState.IDLE&&(n[t.getKey()]=!0,a.isKeyQueued(t.getKey())||a.enqueue([t,m,c.getTileCoordCenter(t.tileCoord),
v]));void 0!==k&&k.call(l,t)}else b.useTile(r,p,q,e)}};ol.renderer.canvas={};ol.renderer.canvas.Layer=function(a){ol.renderer.Layer.call(this,a);this.transform_=ol.transform.create()};ol.inherits(ol.renderer.canvas.Layer,ol.renderer.Layer);
ol.renderer.canvas.Layer.prototype.clip=function(a,b,c){var d=b.pixelRatio,e=b.size[0]*d,f=b.size[1]*d,g=b.viewState.rotation,h=ol.extent.getTopLeft(c),k=ol.extent.getTopRight(c),l=ol.extent.getBottomRight(c);c=ol.extent.getBottomLeft(c);ol.transform.apply(b.coordinateToPixelTransform,h);ol.transform.apply(b.coordinateToPixelTransform,k);ol.transform.apply(b.coordinateToPixelTransform,l);ol.transform.apply(b.coordinateToPixelTransform,c);a.save();ol.render.canvas.rotateAtOffset(a,-g,e/2,f/2);a.beginPath();
a.moveTo(h[0]*d,h[1]*d);a.lineTo(k[0]*d,k[1]*d);a.lineTo(l[0]*d,l[1]*d);a.lineTo(c[0]*d,c[1]*d);a.clip();ol.render.canvas.rotateAtOffset(a,g,e/2,f/2)};
ol.renderer.canvas.Layer.prototype.dispatchComposeEvent_=function(a,b,c,d){var e=this.getLayer();if(e.hasListener(a)){var f=c.size[0]*c.pixelRatio,g=c.size[1]*c.pixelRatio,h=c.viewState.rotation;ol.render.canvas.rotateAtOffset(b,-h,f/2,g/2);d=void 0!==d?d:this.getTransform(c,0);d=new ol.render.canvas.Immediate(b,c.pixelRatio,c.extent,d,c.viewState.rotation);a=new ol.render.Event(a,d,c,b,null);e.dispatchEvent(a);ol.render.canvas.rotateAtOffset(b,h,f/2,g/2)}};
ol.renderer.canvas.Layer.prototype.forEachLayerAtCoordinate=function(a,b,c,d){if(this.forEachFeatureAtCoordinate(a,b,0,ol.functions.TRUE,this))return c.call(d,this.getLayer(),null)};ol.renderer.canvas.Layer.prototype.postCompose=function(a,b,c,d){this.dispatchComposeEvent_(ol.render.EventType.POSTCOMPOSE,a,b,d)};ol.renderer.canvas.Layer.prototype.preCompose=function(a,b,c){this.dispatchComposeEvent_(ol.render.EventType.PRECOMPOSE,a,b,c)};
ol.renderer.canvas.Layer.prototype.dispatchRenderEvent=function(a,b,c){this.dispatchComposeEvent_(ol.render.EventType.RENDER,a,b,c)};ol.renderer.canvas.Layer.prototype.getTransform=function(a,b){var c=a.viewState,d=a.pixelRatio,e=d/c.resolution;return ol.transform.compose(this.transform_,d*a.size[0]/2,d*a.size[1]/2,e,-e,-c.rotation,-c.center[0]+b,-c.center[1])};ol.renderer.canvas.Layer.prototype.composeFrame=function(a,b,c){};ol.renderer.canvas.Layer.prototype.prepareFrame=function(a,b){};ol.renderer.canvas.IntermediateCanvas=function(a){ol.renderer.canvas.Layer.call(this,a);this.coordinateToCanvasPixelTransform=ol.transform.create();this.hitCanvasContext_=null};ol.inherits(ol.renderer.canvas.IntermediateCanvas,ol.renderer.canvas.Layer);
ol.renderer.canvas.IntermediateCanvas.prototype.composeFrame=function(a,b,c){this.preCompose(c,a);var d=this.getImage();if(d){var e=b.extent,f=void 0!==e&&!ol.extent.containsExtent(e,a.extent)&&ol.extent.intersects(e,a.extent);f&&this.clip(c,a,e);e=this.getImageTransform();var g=c.globalAlpha;c.globalAlpha=b.opacity;c.drawImage(d,0,0,+d.width,+d.height,Math.round(e[4]),Math.round(e[5]),Math.round(d.width*e[0]),Math.round(d.height*e[3]));c.globalAlpha=g;f&&c.restore()}this.postCompose(c,a,b)};
ol.renderer.canvas.IntermediateCanvas.prototype.getImage=function(){};ol.renderer.canvas.IntermediateCanvas.prototype.getImageTransform=function(){};ol.renderer.canvas.IntermediateCanvas.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){var f=this.getLayer();return f.getSource().forEachFeatureAtCoordinate(a,b.viewState.resolution,b.viewState.rotation,c,b.skippedFeatureUids,function(a){return d.call(e,a,f)})};
ol.renderer.canvas.IntermediateCanvas.prototype.forEachLayerAtCoordinate=function(a,b,c,d){if(this.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==ol.nullFunction)return ol.renderer.canvas.Layer.prototype.forEachLayerAtCoordinate.apply(this,arguments);var e=ol.transform.apply(this.coordinateToCanvasPixelTransform,a.slice());ol.coordinate.scale(e,b.viewState.resolution/this.renderedResolution);this.hitCanvasContext_||(this.hitCanvasContext_=ol.dom.createCanvasContext2D(1,1));
this.hitCanvasContext_.clearRect(0,0,1,1);this.hitCanvasContext_.drawImage(this.getImage(),e[0],e[1],1,1,0,0,1,1);e=this.hitCanvasContext_.getImageData(0,0,1,1).data;if(0<e[3])return c.call(d,this.getLayer(),e)}};ol.renderer.canvas.ImageLayer=function(a){ol.renderer.canvas.IntermediateCanvas.call(this,a);this.image_=null;this.imageTransform_=ol.transform.create()};ol.inherits(ol.renderer.canvas.ImageLayer,ol.renderer.canvas.IntermediateCanvas);ol.renderer.canvas.ImageLayer.handles=function(a,b){return a===ol.renderer.Type.CANVAS&&b.getType()===ol.LayerType.IMAGE};ol.renderer.canvas.ImageLayer.create=function(a,b){return new ol.renderer.canvas.ImageLayer(b)};
ol.renderer.canvas.ImageLayer.prototype.getImage=function(){return this.image_?this.image_.getImage():null};ol.renderer.canvas.ImageLayer.prototype.getImageTransform=function(){return this.imageTransform_};
ol.renderer.canvas.ImageLayer.prototype.prepareFrame=function(a,b){var c=a.pixelRatio,d=a.size,e=a.viewState,f=e.center,g=e.resolution,h=this.getLayer().getSource(),k=a.viewHints,l=a.extent;void 0!==b.extent&&(l=ol.extent.getIntersection(l,b.extent));k[ol.ViewHint.ANIMATING]||k[ol.ViewHint.INTERACTING]||ol.extent.isEmpty(l)||(b=e.projection,ol.ENABLE_RASTER_REPROJECTION||(e=h.getProjection())&&(b=e),(e=h.getImage(l,g,c,b))&&this.loadImage(e)&&(this.image_=e));this.image_&&(e=this.image_,b=e.getExtent(),
l=e.getResolution(),e=e.getPixelRatio(),k=c*l/(g*e),b=ol.transform.compose(this.imageTransform_,c*d[0]/2,c*d[1]/2,k,k,0,e*(b[0]-f[0])/l,e*(f[1]-b[3])/l),ol.transform.compose(this.coordinateToCanvasPixelTransform,c*d[0]/2-b[4],c*d[1]/2-b[5],c/g,-c/g,0,-f[0],-f[1]),this.updateLogos(a,h),this.renderedResolution=l*c/e);return!!this.image_};ol.TileRange=function(a,b,c,d){this.minX=a;this.maxX=b;this.minY=c;this.maxY=d};ol.TileRange.createOrUpdate=function(a,b,c,d,e){return void 0!==e?(e.minX=a,e.maxX=b,e.minY=c,e.maxY=d,e):new ol.TileRange(a,b,c,d)};ol.TileRange.prototype.contains=function(a){return this.containsXY(a[1],a[2])};ol.TileRange.prototype.containsTileRange=function(a){return this.minX<=a.minX&&a.maxX<=this.maxX&&this.minY<=a.minY&&a.maxY<=this.maxY};
ol.TileRange.prototype.containsXY=function(a,b){return this.minX<=a&&a<=this.maxX&&this.minY<=b&&b<=this.maxY};ol.TileRange.prototype.equals=function(a){return this.minX==a.minX&&this.minY==a.minY&&this.maxX==a.maxX&&this.maxY==a.maxY};ol.TileRange.prototype.extend=function(a){a.minX<this.minX&&(this.minX=a.minX);a.maxX>this.maxX&&(this.maxX=a.maxX);a.minY<this.minY&&(this.minY=a.minY);a.maxY>this.maxY&&(this.maxY=a.maxY)};ol.TileRange.prototype.getHeight=function(){return this.maxY-this.minY+1};
ol.TileRange.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]};ol.TileRange.prototype.getWidth=function(){return this.maxX-this.minX+1};ol.TileRange.prototype.intersects=function(a){return this.minX<=a.maxX&&this.maxX>=a.minX&&this.minY<=a.maxY&&this.maxY>=a.minY};ol.renderer.canvas.TileLayer=function(a){ol.renderer.canvas.IntermediateCanvas.call(this,a);this.context=null===this.context?null:ol.dom.createCanvasContext2D();this.renderedExtent_=null;this.renderedTiles=[];this.tmpExtent=ol.extent.createEmpty();this.tmpTileRange_=new ol.TileRange(0,0,0,0);this.imageTransform_=ol.transform.create();this.zDirection=0};ol.inherits(ol.renderer.canvas.TileLayer,ol.renderer.canvas.IntermediateCanvas);
ol.renderer.canvas.TileLayer.handles=function(a,b){return a===ol.renderer.Type.CANVAS&&b.getType()===ol.LayerType.TILE};ol.renderer.canvas.TileLayer.create=function(a,b){return new ol.renderer.canvas.TileLayer(b)};ol.renderer.canvas.TileLayer.prototype.isDrawableTile_=function(a){a=a.getState();var b=this.getLayer().getUseInterimTilesOnError();return a==ol.TileState.LOADED||a==ol.TileState.EMPTY||a==ol.TileState.ERROR&&!b};
ol.renderer.canvas.TileLayer.prototype.prepareFrame=function(a,b){var c=a.pixelRatio,d=a.size,e=a.viewState,f=e.projection,g=e.resolution;e=e.center;var h=this.getLayer(),k=h.getSource(),l=k.getRevision(),m=k.getTileGridForProjection(f),n=m.getZForResolution(g,this.zDirection),p=m.getResolution(n),q=Math.round(g/p)||1,r=a.extent;void 0!==b.extent&&(r=ol.extent.getIntersection(r,b.extent));if(ol.extent.isEmpty(r))return!1;var u=m.getTileRangeForExtentAndZ(r,n),v=m.getTileRangeExtent(n,u),t=k.getTilePixelRatio(c),
w={};w[n]={};var x=this.createLoadedTileFinder(k,f,w),z=this.tmpExtent,y=this.tmpTileRange_,A=!1,C,B;for(C=u.minX;C<=u.maxX;++C)for(B=u.minY;B<=u.maxY;++B){var D=k.getTile(n,C,B,c,f);D.getState()==ol.TileState.ERROR&&(h.getUseInterimTilesOnError()?0<h.getPreload()&&(A=!0):D.setState(ol.TileState.LOADED));this.isDrawableTile_(D)||(D=D.getInterimTile());if(this.isDrawableTile_(D)){var E=ol.getUid(this);if(D.getState()==ol.TileState.LOADED){w[n][D.tileCoord.toString()]=D;var G=D.inTransition(E);A||!G&&
-1!==this.renderedTiles.indexOf(D)||(A=!0)}if(1===D.getAlpha(E,a.time))continue}E=m.getTileCoordChildTileRange(D.tileCoord,y,z);G=!1;E&&(G=x(n+1,E));G||m.forEachTileCoordParentTileRange(D.tileCoord,x,null,y,z)}D=p*c/t*q;C=a.viewHints;C=C[ol.ViewHint.ANIMATING]||C[ol.ViewHint.INTERACTING];if(!(this.renderedResolution&&16<Date.now()-a.time&&C||!A&&this.renderedExtent_&&ol.extent.containsExtent(this.renderedExtent_,r)&&this.renderedRevision==l&&q==this.oversampling_&&(C||D==this.renderedResolution))){if(D=
this.context)B=k.getTilePixelSize(n,c,f),C=Math.round(u.getWidth()*B[0]/q),B=Math.round(u.getHeight()*B[1]/q),A=D.canvas,A.width!=C||A.height!=B?(this.oversampling_=q,A.width=C,A.height=B):(this.renderedExtent_&&!ol.extent.equals(v,this.renderedExtent_)&&D.clearRect(0,0,C,B),q=this.oversampling_);this.renderedTiles.length=0;A=Object.keys(w).map(Number);A.sort(function(a,b){return a===n?1:b===n?-1:a>b?1:a<b?-1:0});E=0;for(G=A.length;E<G;++E){y=A[E];x=k.getTilePixelSize(y,c,f);D=m.getResolution(y);
var F=D/p;var H=t*k.getGutter(f);var I=w[y];for(var K in I){D=I[K];B=m.getTileCoordExtent(D.getTileCoord(),z);C=(B[0]-v[0])/p*t/q;B=(v[3]-B[3])/p*t/q;var J=x[0]*F/q;var L=x[1]*F/q;this.drawTileImage(D,a,b,C,B,J,L,H,n===y);this.renderedTiles.push(D)}}this.renderedRevision=l;this.renderedResolution=p*c/t*q;this.renderedExtent_=v}b=this.renderedResolution/g;b=ol.transform.compose(this.imageTransform_,c*d[0]/2,c*d[1]/2,b,b,0,(this.renderedExtent_[0]-e[0])/this.renderedResolution*c,(e[1]-this.renderedExtent_[3])/
this.renderedResolution*c);ol.transform.compose(this.coordinateToCanvasPixelTransform,c*d[0]/2-b[4],c*d[1]/2-b[5],c/g,-c/g,0,-e[0],-e[1]);this.updateUsedTiles(a.usedTiles,k,n,u);this.manageTilePyramid(a,k,m,c,f,r,n,h.getPreload());this.scheduleExpireCache(a,k);this.updateLogos(a,k);return 0<this.renderedTiles.length};
ol.renderer.canvas.TileLayer.prototype.drawTileImage=function(a,b,c,d,e,f,g,h,k){if(c=a.getImage(this.getLayer())){var l=ol.getUid(this),m=k?a.getAlpha(l,b.time):1;1!==m||this.getLayer().getSource().getOpaque(b.viewState.projection)||this.context.clearRect(d,e,f,g);var n=m!==this.context.globalAlpha;n&&(this.context.save(),this.context.globalAlpha=m);this.context.drawImage(c,h,h,c.width-2*h,c.height-2*h,d,e,f,g);n&&this.context.restore();1!==m?b.animate=!0:k&&a.endTransition(l)}};
ol.renderer.canvas.TileLayer.prototype.getImage=function(){var a=this.context;return a?a.canvas:null};ol.renderer.canvas.TileLayer.prototype.getImageTransform=function(){return this.imageTransform_};ol.reproj={};ol.reproj.calculateSourceResolution=function(a,b,c,d){var e=ol.proj.transform(c,b,a);c=ol.proj.getPointResolution(b,d,c);b=b.getMetersPerUnit();void 0!==b&&(c*=b);b=a.getMetersPerUnit();void 0!==b&&(c/=b);b=a.getExtent();if(!b||ol.extent.containsCoordinate(b,e))a=ol.proj.getPointResolution(a,c,e)/c,isFinite(a)&&0<a&&(c/=a);return c};ol.reproj.enlargeClipPoint_=function(a,b,c,d){a=c-a;b=d-b;var e=Math.sqrt(a*a+b*b);return[Math.round(c+a/e),Math.round(d+b/e)]};
ol.reproj.render=function(a,b,c,d,e,f,g,h,k,l,m){var n=ol.dom.createCanvasContext2D(Math.round(c*a),Math.round(c*b));if(0===k.length)return n.canvas;n.scale(c,c);var p=ol.extent.createEmpty();k.forEach(function(a,b,c){ol.extent.extend(p,a.extent)});a=ol.extent.getWidth(p);b=ol.extent.getHeight(p);var q=ol.dom.createCanvasContext2D(Math.round(c*a/d),Math.round(c*b/d)),r=c/d;k.forEach(function(a,b,c){b=a.extent[0]-p[0];c=-(a.extent[3]-p[3]);var d=ol.extent.getWidth(a.extent),e=ol.extent.getHeight(a.extent);
q.drawImage(a.image,l,l,a.image.width-2*l,a.image.height-2*l,b*r,c*r,d*r,e*r)});var u=ol.extent.getTopLeft(g);h.getTriangles().forEach(function(a,b,e){var g=a.source,h=a.target,k=g[1][0],l=g[1][1],m=g[2][0],t=g[2][1];a=(h[0][0]-u[0])/f;b=-(h[0][1]-u[1])/f;var v=(h[1][0]-u[0])/f,r=-(h[1][1]-u[1])/f;e=(h[2][0]-u[0])/f;var w=-(h[2][1]-u[1])/f;h=g[0][0];g=g[0][1];k-=h;l-=g;m-=h;t-=g;if(k=ol.math.solveLinearSystem([[k,l,0,0,v-a],[m,t,0,0,e-a],[0,0,k,l,r-b],[0,0,m,t,w-b]]))n.save(),n.beginPath(),m=(a+v+
e)/3,t=(b+r+w)/3,l=ol.reproj.enlargeClipPoint_(m,t,a,b),v=ol.reproj.enlargeClipPoint_(m,t,v,r),e=ol.reproj.enlargeClipPoint_(m,t,e,w),n.moveTo(v[0],v[1]),n.lineTo(l[0],l[1]),n.lineTo(e[0],e[1]),n.clip(),n.transform(k[0],k[2],k[1],k[3],a,b),n.translate(p[0]-h,p[3]-g),n.scale(d/c,-d/c),n.drawImage(q.canvas,0,0),n.restore()});m&&(n.save(),n.strokeStyle="black",n.lineWidth=1,h.getTriangles().forEach(function(a,b,c){var d=a.target;a=(d[0][0]-u[0])/f;b=-(d[0][1]-u[1])/f;c=(d[1][0]-u[0])/f;var e=-(d[1][1]-
u[1])/f,g=(d[2][0]-u[0])/f;d=-(d[2][1]-u[1])/f;n.beginPath();n.moveTo(c,e);n.lineTo(a,b);n.lineTo(g,d);n.closePath();n.stroke()}),n.restore());return n.canvas};ol.reproj.Triangulation=function(a,b,c,d,e){this.sourceProj_=a;this.targetProj_=b;var f={},g=ol.proj.getTransform(this.targetProj_,this.sourceProj_);this.transformInv_=function(a){var b=a[0]+"/"+a[1];f[b]||(f[b]=g(a));return f[b]};this.maxSourceExtent_=d;this.errorThresholdSquared_=e*e;this.triangles_=[];this.wrapsXInSource_=!1;this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!d&&!!this.sourceProj_.getExtent()&&ol.extent.getWidth(d)==ol.extent.getWidth(this.sourceProj_.getExtent());this.sourceWorldWidth_=
this.sourceProj_.getExtent()?ol.extent.getWidth(this.sourceProj_.getExtent()):null;this.targetWorldWidth_=this.targetProj_.getExtent()?ol.extent.getWidth(this.targetProj_.getExtent()):null;a=ol.extent.getTopLeft(c);b=ol.extent.getTopRight(c);d=ol.extent.getBottomRight(c);c=ol.extent.getBottomLeft(c);e=this.transformInv_(a);var h=this.transformInv_(b),k=this.transformInv_(d),l=this.transformInv_(c);this.addQuad_(a,b,d,c,e,h,k,l,ol.RASTER_REPROJECTION_MAX_SUBDIVISION);if(this.wrapsXInSource_){var m=
Infinity;this.triangles_.forEach(function(a,b,c){m=Math.min(m,a.source[0][0],a.source[1][0],a.source[2][0])});this.triangles_.forEach(function(a){if(Math.max(a.source[0][0],a.source[1][0],a.source[2][0])-m>this.sourceWorldWidth_/2){var b=[[a.source[0][0],a.source[0][1]],[a.source[1][0],a.source[1][1]],[a.source[2][0],a.source[2][1]]];b[0][0]-m>this.sourceWorldWidth_/2&&(b[0][0]-=this.sourceWorldWidth_);b[1][0]-m>this.sourceWorldWidth_/2&&(b[1][0]-=this.sourceWorldWidth_);b[2][0]-m>this.sourceWorldWidth_/
2&&(b[2][0]-=this.sourceWorldWidth_);Math.max(b[0][0],b[1][0],b[2][0])-Math.min(b[0][0],b[1][0],b[2][0])<this.sourceWorldWidth_/2&&(a.source=b)}},this)}f={}};ol.reproj.Triangulation.prototype.addTriangle_=function(a,b,c,d,e,f){this.triangles_.push({source:[d,e,f],target:[a,b,c]})};
ol.reproj.Triangulation.prototype.addQuad_=function(a,b,c,d,e,f,g,h,k){var l=ol.extent.boundingExtent([e,f,g,h]),m=this.sourceWorldWidth_?ol.extent.getWidth(l)/this.sourceWorldWidth_:null,n=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&.5<m&&1>m,q=!1;if(0<k){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var r=ol.extent.boundingExtent([a,b,c,d]);r=ol.extent.getWidth(r)/this.targetWorldWidth_;q|=r>ol.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH}!p&&this.sourceProj_.isGlobal()&&m&&(q|=m>
ol.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH)}if(q||!this.maxSourceExtent_||ol.extent.intersects(l,this.maxSourceExtent_)){if(!(q||isFinite(e[0])&&isFinite(e[1])&&isFinite(f[0])&&isFinite(f[1])&&isFinite(g[0])&&isFinite(g[1])&&isFinite(h[0])&&isFinite(h[1])))if(0<k)q=!0;else return;if(0<k&&(q||(l=this.transformInv_([(a[0]+c[0])/2,(a[1]+c[1])/2]),n=p?(ol.math.modulo(e[0],n)+ol.math.modulo(g[0],n))/2-ol.math.modulo(l[0],n):(e[0]+g[0])/2-l[0],l=(e[1]+g[1])/2-l[1],q=n*n+l*l>this.errorThresholdSquared_),
q)){Math.abs(a[0]-c[0])<=Math.abs(a[1]-c[1])?(p=[(b[0]+c[0])/2,(b[1]+c[1])/2],n=this.transformInv_(p),l=[(d[0]+a[0])/2,(d[1]+a[1])/2],m=this.transformInv_(l),this.addQuad_(a,b,p,l,e,f,n,m,k-1),this.addQuad_(l,p,c,d,m,n,g,h,k-1)):(p=[(a[0]+b[0])/2,(a[1]+b[1])/2],n=this.transformInv_(p),l=[(c[0]+d[0])/2,(c[1]+d[1])/2],m=this.transformInv_(l),this.addQuad_(a,p,l,d,e,n,m,h,k-1),this.addQuad_(p,b,c,l,n,f,g,m,k-1));return}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(a,
c,d,e,g,h);this.addTriangle_(a,b,c,e,f,g)}};ol.reproj.Triangulation.prototype.calculateSourceExtent=function(){var a=ol.extent.createEmpty();this.triangles_.forEach(function(b,c,d){b=b.source;ol.extent.extendCoordinate(a,b[0]);ol.extent.extendCoordinate(a,b[1]);ol.extent.extendCoordinate(a,b[2])});return a};ol.reproj.Triangulation.prototype.getTriangles=function(){return this.triangles_};ol.reproj.Image=function(a,b,c,d,e,f){this.targetProj_=b;this.maxSourceExtent_=a.getExtent();var g=b.getExtent();g=g?ol.extent.getIntersection(c,g):c;var h=ol.extent.getCenter(g);h=ol.reproj.calculateSourceResolution(a,b,h,d);this.triangulation_=new ol.reproj.Triangulation(a,b,g,this.maxSourceExtent_,h*ol.DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD);this.targetResolution_=d;this.targetExtent_=c;a=this.triangulation_.calculateSourceExtent();this.sourcePixelRatio_=(this.sourceImage_=f(a,h,e))?this.sourceImage_.getPixelRatio():
1;this.sourceListenerKey_=this.canvas_=null;e=ol.ImageState.LOADED;this.sourceImage_&&(e=ol.ImageState.IDLE);ol.ImageBase.call(this,c,d,this.sourcePixelRatio_,e)};ol.inherits(ol.reproj.Image,ol.ImageBase);ol.reproj.Image.prototype.disposeInternal=function(){this.state==ol.ImageState.LOADING&&this.unlistenSource_();ol.ImageBase.prototype.disposeInternal.call(this)};ol.reproj.Image.prototype.getImage=function(){return this.canvas_};ol.reproj.Image.prototype.getProjection=function(){return this.targetProj_};
ol.reproj.Image.prototype.reproject_=function(){var a=this.sourceImage_.getState();if(a==ol.ImageState.LOADED){var b=ol.extent.getWidth(this.targetExtent_)/this.targetResolution_,c=ol.extent.getHeight(this.targetExtent_)/this.targetResolution_;this.canvas_=ol.reproj.render(b,c,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=
a;this.changed()};ol.reproj.Image.prototype.load=function(){if(this.state==ol.ImageState.IDLE){this.state=ol.ImageState.LOADING;this.changed();var a=this.sourceImage_.getState();a==ol.ImageState.LOADED||a==ol.ImageState.ERROR?this.reproject_():(this.sourceListenerKey_=ol.events.listen(this.sourceImage_,ol.events.EventType.CHANGE,function(a){a=this.sourceImage_.getState();if(a==ol.ImageState.LOADED||a==ol.ImageState.ERROR)this.unlistenSource_(),this.reproject_()},this),this.sourceImage_.load())}};
ol.reproj.Image.prototype.unlistenSource_=function(){ol.events.unlistenByKey(this.sourceListenerKey_);this.sourceListenerKey_=null};ol.size={};ol.size.buffer=function(a,b,c){void 0===c&&(c=[0,0]);c[0]=a[0]+2*b;c[1]=a[1]+2*b;return c};ol.size.hasArea=function(a){return 0<a[0]&&0<a[1]};ol.size.scale=function(a,b,c){void 0===c&&(c=[0,0]);c[0]=a[0]*b+.5|0;c[1]=a[1]*b+.5|0;return c};ol.size.toSize=function(a,b){if(Array.isArray(a))return a;void 0===b?b=[a,a]:b[0]=b[1]=a;return b};ol.tilecoord={};ol.tilecoord.createOrUpdate=function(a,b,c,d){return void 0!==d?(d[0]=a,d[1]=b,d[2]=c,d):[a,b,c]};ol.tilecoord.getKeyZXY=function(a,b,c){return a+"/"+b+"/"+c};ol.tilecoord.getKey=function(a){return ol.tilecoord.getKeyZXY(a[0],a[1],a[2])};ol.tilecoord.fromKey=function(a){return a.split("/").map(Number)};ol.tilecoord.hash=function(a){return(a[1]<<a[0])+a[2]};
ol.tilecoord.quadKey=function(a){var b=a[0],c=Array(b),d=1<<b-1,e;for(e=0;e<b;++e){var f=48;a[1]&d&&(f+=1);a[2]&d&&(f+=2);c[e]=String.fromCharCode(f);d>>=1}return c.join("")};ol.tilecoord.withinExtentAndZ=function(a,b){var c=a[0],d=a[1];a=a[2];if(b.getMinZoom()>c||c>b.getMaxZoom())return!1;var e=b.getExtent();return(b=e?b.getTileRangeForExtentAndZ(e,c):b.getFullTileRange(c))?b.containsXY(d,a):!0};ol.tilegrid={};
ol.tilegrid.TileGrid=function(a){this.minZoom=void 0!==a.minZoom?a.minZoom:0;this.resolutions_=a.resolutions;ol.asserts.assert(ol.array.isSorted(this.resolutions_,function(a,b){return b-a},!0),17);if(!a.origins)for(var b=0,c=this.resolutions_.length-1;b<c;++b)if(!d)var d=this.resolutions_[b]/this.resolutions_[b+1];else if(this.resolutions_[b]/this.resolutions_[b+1]!==d){d=void 0;break}this.zoomFactor_=d;this.maxZoom=this.resolutions_.length-1;this.origin_=void 0!==a.origin?a.origin:null;this.origins_=
null;void 0!==a.origins&&(this.origins_=a.origins,ol.asserts.assert(this.origins_.length==this.resolutions_.length,20));d=a.extent;void 0===d||this.origin_||this.origins_||(this.origin_=ol.extent.getTopLeft(d));ol.asserts.assert(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18);this.tileSizes_=null;void 0!==a.tileSizes&&(this.tileSizes_=a.tileSizes,ol.asserts.assert(this.tileSizes_.length==this.resolutions_.length,19));this.tileSize_=void 0!==a.tileSize?a.tileSize:this.tileSizes_?null:
ol.DEFAULT_TILE_SIZE;ol.asserts.assert(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22);this.extent_=void 0!==d?d:null;this.fullTileRanges_=null;this.tmpSize_=[0,0];void 0!==a.sizes?this.fullTileRanges_=a.sizes.map(function(a,b){return new ol.TileRange(Math.min(0,a[0]),Math.max(a[0]-1,-1),Math.min(0,a[1]),Math.max(a[1]-1,-1))},this):d&&this.calculateTileRanges_(d)};ol.tilegrid.TileGrid.tmpTileCoord_=[0,0,0];
ol.tilegrid.TileGrid.prototype.forEachTileCoord=function(a,b,c){a=this.getTileRangeForExtentAndZ(a,b);for(var d=a.minX,e=a.maxX;d<=e;++d)for(var f=a.minY,g=a.maxY;f<=g;++f)c([b,d,f])};
ol.tilegrid.TileGrid.prototype.forEachTileCoordParentTileRange=function(a,b,c,d,e){var f=null,g=a[0]-1;if(2===this.zoomFactor_){var h=a[1];var k=a[2]}else f=this.getTileCoordExtent(a,e);for(;g>=this.minZoom;){2===this.zoomFactor_?(h=Math.floor(h/2),k=Math.floor(k/2),a=ol.TileRange.createOrUpdate(h,h,k,k,d)):a=this.getTileRangeForExtentAndZ(f,g,d);if(b.call(c,g,a))return!0;--g}return!1};ol.tilegrid.TileGrid.prototype.getExtent=function(){return this.extent_};
ol.tilegrid.TileGrid.prototype.getMaxZoom=function(){return this.maxZoom};ol.tilegrid.TileGrid.prototype.getMinZoom=function(){return this.minZoom};ol.tilegrid.TileGrid.prototype.getOrigin=function(a){return this.origin_?this.origin_:this.origins_[a]};ol.tilegrid.TileGrid.prototype.getResolution=function(a){return this.resolutions_[a]};ol.tilegrid.TileGrid.prototype.getResolutions=function(){return this.resolutions_};
ol.tilegrid.TileGrid.prototype.getTileCoordChildTileRange=function(a,b,c){if(a[0]<this.maxZoom){if(2===this.zoomFactor_)return c=2*a[1],a=2*a[2],ol.TileRange.createOrUpdate(c,c+1,a,a+1,b);c=this.getTileCoordExtent(a,c);return this.getTileRangeForExtentAndZ(c,a[0]+1,b)}return null};
ol.tilegrid.TileGrid.prototype.getTileRangeExtent=function(a,b,c){var d=this.getOrigin(a),e=this.getResolution(a);a=ol.size.toSize(this.getTileSize(a),this.tmpSize_);return ol.extent.createOrUpdate(d[0]+b.minX*a[0]*e,d[1]+b.minY*a[1]*e,d[0]+(b.maxX+1)*a[0]*e,d[1]+(b.maxY+1)*a[1]*e,c)};
ol.tilegrid.TileGrid.prototype.getTileRangeForExtentAndZ=function(a,b,c){var d=ol.tilegrid.TileGrid.tmpTileCoord_;this.getTileCoordForXYAndZ_(a[0],a[1],b,!1,d);var e=d[1],f=d[2];this.getTileCoordForXYAndZ_(a[2],a[3],b,!0,d);return ol.TileRange.createOrUpdate(e,d[1],f,d[2],c)};ol.tilegrid.TileGrid.prototype.getTileCoordCenter=function(a){var b=this.getOrigin(a[0]),c=this.getResolution(a[0]),d=ol.size.toSize(this.getTileSize(a[0]),this.tmpSize_);return[b[0]+(a[1]+.5)*d[0]*c,b[1]+(a[2]+.5)*d[1]*c]};
ol.tilegrid.TileGrid.prototype.getTileCoordExtent=function(a,b){var c=this.getOrigin(a[0]),d=this.getResolution(a[0]),e=ol.size.toSize(this.getTileSize(a[0]),this.tmpSize_),f=c[0]+a[1]*e[0]*d;a=c[1]+a[2]*e[1]*d;return ol.extent.createOrUpdate(f,a,f+e[0]*d,a+e[1]*d,b)};ol.tilegrid.TileGrid.prototype.getTileCoordForCoordAndResolution=function(a,b,c){return this.getTileCoordForXYAndResolution_(a[0],a[1],b,!1,c)};
ol.tilegrid.TileGrid.prototype.getTileCoordForXYAndResolution_=function(a,b,c,d,e){var f=this.getZForResolution(c),g=c/this.getResolution(f),h=this.getOrigin(f),k=ol.size.toSize(this.getTileSize(f),this.tmpSize_);a=g*Math.floor((a-h[0])/c+(d?.5:0))/k[0];b=g*Math.floor((b-h[1])/c+(d?0:.5))/k[1];d?(a=Math.ceil(a)-1,b=Math.ceil(b)-1):(a=Math.floor(a),b=Math.floor(b));return ol.tilecoord.createOrUpdate(f,a,b,e)};
ol.tilegrid.TileGrid.prototype.getTileCoordForXYAndZ_=function(a,b,c,d,e){var f=this.getOrigin(c),g=this.getResolution(c),h=ol.size.toSize(this.getTileSize(c),this.tmpSize_);a=Math.floor((a-f[0])/g+(d?.5:0))/h[0];b=Math.floor((b-f[1])/g+(d?0:.5))/h[1];d?(a=Math.ceil(a)-1,b=Math.ceil(b)-1):(a=Math.floor(a),b=Math.floor(b));return ol.tilecoord.createOrUpdate(c,a,b,e)};ol.tilegrid.TileGrid.prototype.getTileCoordForCoordAndZ=function(a,b,c){return this.getTileCoordForXYAndZ_(a[0],a[1],b,!1,c)};
ol.tilegrid.TileGrid.prototype.getTileCoordResolution=function(a){return this.resolutions_[a[0]]};ol.tilegrid.TileGrid.prototype.getTileSize=function(a){return this.tileSize_?this.tileSize_:this.tileSizes_[a]};ol.tilegrid.TileGrid.prototype.getFullTileRange=function(a){return this.fullTileRanges_?this.fullTileRanges_[a]:null};ol.tilegrid.TileGrid.prototype.getZForResolution=function(a,b){a=ol.array.linearFindNearest(this.resolutions_,a,b||0);return ol.math.clamp(a,this.minZoom,this.maxZoom)};
ol.tilegrid.TileGrid.prototype.calculateTileRanges_=function(a){for(var b=this.resolutions_.length,c=Array(b),d=this.minZoom;d<b;++d)c[d]=this.getTileRangeForExtentAndZ(a,d);this.fullTileRanges_=c};ol.tilegrid.getForProjection=function(a){var b=a.getDefaultTileGrid();b||(b=ol.tilegrid.createForProjection(a),a.setDefaultTileGrid(b));return b};ol.tilegrid.wrapX=function(a,b,c){var d=b[0],e=a.getTileCoordCenter(b);c=ol.tilegrid.extentFromProjection(c);if(ol.extent.containsCoordinate(c,e))return b;b=ol.extent.getWidth(c);e[0]+=b*Math.ceil((c[0]-e[0])/b);return a.getTileCoordForCoordAndZ(e,d)};
ol.tilegrid.createForExtent=function(a,b,c,d){d=void 0!==d?d:ol.extent.Corner.TOP_LEFT;b=ol.tilegrid.resolutionsFromExtent(a,b,c);return new ol.tilegrid.TileGrid({extent:a,origin:ol.extent.getCorner(a,d),resolutions:b,tileSize:c})};ol.tilegrid.createXYZ=function(a){var b={};ol.obj.assign(b,void 0!==a?a:{});void 0===b.extent&&(b.extent=ol.proj.get("EPSG:3857").getExtent());b.resolutions=ol.tilegrid.resolutionsFromExtent(b.extent,b.maxZoom,b.tileSize);delete b.maxZoom;return new ol.tilegrid.TileGrid(b)};
ol.tilegrid.resolutionsFromExtent=function(a,b,c){b=void 0!==b?b:ol.DEFAULT_MAX_ZOOM;var d=ol.extent.getHeight(a);a=ol.extent.getWidth(a);c=ol.size.toSize(void 0!==c?c:ol.DEFAULT_TILE_SIZE);c=Math.max(a/c[0],d/c[1]);b+=1;d=Array(b);for(a=0;a<b;++a)d[a]=c/Math.pow(2,a);return d};ol.tilegrid.createForProjection=function(a,b,c,d){a=ol.tilegrid.extentFromProjection(a);return ol.tilegrid.createForExtent(a,b,c,d)};
ol.tilegrid.extentFromProjection=function(a){a=ol.proj.get(a);var b=a.getExtent();b||(a=180*ol.proj.METERS_PER_UNIT[ol.proj.Units.DEGREES]/a.getMetersPerUnit(),b=ol.extent.createOrUpdate(-a,-a,a,a));return b};ol.Attribution=function(a){this.html_=a.html;this.tileRanges_=a.tileRanges?a.tileRanges:null};ol.Attribution.prototype.getHTML=function(){return this.html_};
ol.Attribution.prototype.intersectsAnyTileRange=function(a,b,c){if(!this.tileRanges_)return!0;var d,e;for(e in a)if(e in this.tileRanges_){var f=a[e];var g=0;for(d=this.tileRanges_[e].length;g<d;++g){var h=this.tileRanges_[e][g];if(h.intersects(f))return!0;var k=b.getTileRangeForExtentAndZ(ol.tilegrid.extentFromProjection(c),parseInt(e,10)),l=k.getWidth();if(f.minX<k.minX||f.maxX>k.maxX)if(h.intersects(new ol.TileRange(ol.math.modulo(f.minX,l),ol.math.modulo(f.maxX,l),f.minY,f.maxY))||f.getWidth()>
l&&h.intersects(k))return!0}}return!1};ol.source.Source=function(a){ol.Object.call(this);this.projection_=ol.proj.get(a.projection);this.attributions_=null;this.attributions2_=this.adaptAttributions_(a.attributions);this.logo_=a.logo;this.state_=void 0!==a.state?a.state:ol.source.State.READY;this.wrapX_=void 0!==a.wrapX?a.wrapX:!1};ol.inherits(ol.source.Source,ol.Object);
ol.source.Source.prototype.adaptAttributions_=function(a){if(!a)return null;if(a instanceof ol.Attribution)return this.attributions_=[a],function(b){return[a.getHTML()]};if(Array.isArray(a)){if(a[0]instanceof ol.Attribution){this.attributions_=a;var b=a.map(function(a){return a.getHTML()});return function(a){return b}}this.attributions_=a.map(function(a){return new ol.Attribution({html:a})});return function(b){return a}}if("function"===typeof a)return a;this.attributions_=[new ol.Attribution({html:a})];
return function(b){return[a]}};ol.source.Source.prototype.forEachFeatureAtCoordinate=ol.nullFunction;ol.source.Source.prototype.getAttributions=function(){return this.attributions_};ol.source.Source.prototype.getAttributions2=function(){return this.attributions2_};ol.source.Source.prototype.getLogo=function(){return this.logo_};ol.source.Source.prototype.getProjection=function(){return this.projection_};ol.source.Source.prototype.getResolutions=function(){};ol.source.Source.prototype.getState=function(){return this.state_};
ol.source.Source.prototype.getWrapX=function(){return this.wrapX_};ol.source.Source.prototype.refresh=function(){this.changed()};ol.source.Source.prototype.setAttributions=function(a){this.attributions2_=this.adaptAttributions_(a);this.changed()};ol.source.Source.prototype.setLogo=function(a){this.logo_=a};ol.source.Source.prototype.setState=function(a){this.state_=a;this.changed()};ol.source.Image=function(a){ol.source.Source.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,projection:a.projection,state:a.state});this.resolutions_=void 0!==a.resolutions?a.resolutions:null;this.reprojectedImage_=null;this.reprojectedRevision_=0};ol.inherits(ol.source.Image,ol.source.Source);ol.source.Image.prototype.getResolutions=function(){return this.resolutions_};
ol.source.Image.prototype.findNearestResolution=function(a){this.resolutions_&&(a=ol.array.linearFindNearest(this.resolutions_,a,0),a=this.resolutions_[a]);return a};
ol.source.Image.prototype.getImage=function(a,b,c,d){var e=this.getProjection();if(ol.ENABLE_RASTER_REPROJECTION&&e&&d&&!ol.proj.equivalent(e,d)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&ol.proj.equivalent(this.reprojectedImage_.getProjection(),d)&&this.reprojectedImage_.getResolution()==b&&ol.extent.equals(this.reprojectedImage_.getExtent(),a))return this.reprojectedImage_;this.reprojectedImage_.dispose();this.reprojectedImage_=null}this.reprojectedImage_=new ol.reproj.Image(e,
d,a,b,c,function(a,b,c){return this.getImageInternal(a,b,c,e)}.bind(this));this.reprojectedRevision_=this.getRevision();return this.reprojectedImage_}e&&(d=e);return this.getImageInternal(a,b,c,d)};ol.source.Image.prototype.getImageInternal=function(a,b,c,d){};
ol.source.Image.prototype.handleImageChange=function(a){a=a.target;switch(a.getState()){case ol.ImageState.LOADING:this.dispatchEvent(new ol.source.Image.Event(ol.source.Image.EventType_.IMAGELOADSTART,a));break;case ol.ImageState.LOADED:this.dispatchEvent(new ol.source.Image.Event(ol.source.Image.EventType_.IMAGELOADEND,a));break;case ol.ImageState.ERROR:this.dispatchEvent(new ol.source.Image.Event(ol.source.Image.EventType_.IMAGELOADERROR,a))}};
ol.source.Image.defaultImageLoadFunction=function(a,b){a.getImage().src=b};ol.source.Image.Event=function(a,b){ol.events.Event.call(this,a);this.image=b};ol.inherits(ol.source.Image.Event,ol.events.Event);ol.source.Image.EventType_={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};ol.source.RasterOperationType={PIXEL:"pixel",IMAGE:"image"};ol.TileCache=function(a){ol.structs.LRUCache.call(this,a)};ol.inherits(ol.TileCache,ol.structs.LRUCache);ol.TileCache.prototype.expireCache=function(a){for(var b,c;this.canExpireCache()&&!(b=this.peekLast(),c=b.tileCoord[0].toString(),c in a&&a[c].contains(b.tileCoord));)this.pop().dispose()};
ol.TileCache.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var a=this.peekFirstKey(),b=ol.tilecoord.fromKey(a)[0];this.forEach(function(a){a.tileCoord[0]!==b&&(this.remove(ol.tilecoord.getKey(a.tileCoord)),a.dispose())},this)}};ol.source.Tile=function(a){ol.source.Source.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,projection:a.projection,state:a.state,wrapX:a.wrapX});this.opaque_=void 0!==a.opaque?a.opaque:!1;this.tilePixelRatio_=void 0!==a.tilePixelRatio?a.tilePixelRatio:1;this.tileGrid=void 0!==a.tileGrid?a.tileGrid:null;this.tileCache=new ol.TileCache(a.cacheSize);this.tmpSize=[0,0];this.key_="";this.tileOptions={transition:a.transition}};ol.inherits(ol.source.Tile,ol.source.Source);
ol.source.Tile.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()};ol.source.Tile.prototype.expireCache=function(a,b){(a=this.getTileCacheForProjection(a))&&a.expireCache(b)};
ol.source.Tile.prototype.forEachLoadedTile=function(a,b,c,d){a=this.getTileCacheForProjection(a);if(!a)return!1;for(var e=!0,f,g,h=c.minX;h<=c.maxX;++h)for(var k=c.minY;k<=c.maxY;++k)f=ol.tilecoord.getKeyZXY(b,h,k),g=!1,a.containsKey(f)&&(f=a.get(f),(g=f.getState()===ol.TileState.LOADED)&&(g=!1!==d(f))),g||(e=!1);return e};ol.source.Tile.prototype.getGutter=function(a){return 0};ol.source.Tile.prototype.getKey=function(){return this.key_};
ol.source.Tile.prototype.setKey=function(a){this.key_!==a&&(this.key_=a,this.changed())};ol.source.Tile.prototype.getOpaque=function(a){return this.opaque_};ol.source.Tile.prototype.getResolutions=function(){return this.tileGrid.getResolutions()};ol.source.Tile.prototype.getTile=function(a,b,c,d,e){};ol.source.Tile.prototype.getTileGrid=function(){return this.tileGrid};ol.source.Tile.prototype.getTileGridForProjection=function(a){return this.tileGrid?this.tileGrid:ol.tilegrid.getForProjection(a)};
ol.source.Tile.prototype.getTileCacheForProjection=function(a){var b=this.getProjection();return b&&!ol.proj.equivalent(b,a)?null:this.tileCache};ol.source.Tile.prototype.getTilePixelRatio=function(a){return this.tilePixelRatio_};ol.source.Tile.prototype.getTilePixelSize=function(a,b,c){c=this.getTileGridForProjection(c);b=this.getTilePixelRatio(b);a=ol.size.toSize(c.getTileSize(a),this.tmpSize);return 1==b?a:ol.size.scale(a,b,this.tmpSize)};
ol.source.Tile.prototype.getTileCoordForTileUrlFunction=function(a,b){b=void 0!==b?b:this.getProjection();var c=this.getTileGridForProjection(b);this.getWrapX()&&b.isGlobal()&&(a=ol.tilegrid.wrapX(c,a,b));return ol.tilecoord.withinExtentAndZ(a,c)?a:null};ol.source.Tile.prototype.refresh=function(){this.tileCache.clear();this.changed()};ol.source.Tile.prototype.useTile=ol.nullFunction;ol.source.Tile.Event=function(a,b){ol.events.Event.call(this,a);this.tile=b};ol.inherits(ol.source.Tile.Event,ol.events.Event);ol.source.Raster=function(a){this.worker_=null;this.operationType_=void 0!==a.operationType?a.operationType:ol.source.RasterOperationType.PIXEL;this.threads_=void 0!==a.threads?a.threads:1;this.renderers_=ol.source.Raster.createRenderers_(a.sources);for(var b=0,c=this.renderers_.length;b<c;++b)ol.events.listen(this.renderers_[b],ol.events.EventType.CHANGE,this.changed,this);this.tileQueue_=new ol.TileQueue(function(){return 1},this.changed.bind(this));b=ol.source.Raster.getLayerStatesArray_(this.renderers_);
c={};for(var d=0,e=b.length;d<e;++d)c[ol.getUid(b[d].layer)]=b[d];this.renderedImageCanvas_=null;this.frameState_={animate:!1,attributions:{},coordinateToPixelTransform:ol.transform.create(),extent:null,focus:null,index:0,layerStates:c,layerStatesArray:b,logos:{},pixelRatio:1,pixelToCoordinateTransform:ol.transform.create(),postRenderFunctions:[],size:[0,0],skippedFeatureUids:{},tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{}};ol.source.Image.call(this,
{});void 0!==a.operation&&this.setOperation(a.operation,a.lib)};ol.inherits(ol.source.Raster,ol.source.Image);ol.source.Raster.prototype.setOperation=function(a,b){this.worker_=new ol.ext.pixelworks.Processor({operation:a,imageOps:this.operationType_===ol.source.RasterOperationType.IMAGE,queue:1,lib:b,threads:this.threads_});this.changed()};
ol.source.Raster.prototype.updateFrameState_=function(a,b,c){var d=ol.obj.assign({},this.frameState_);d.viewState=ol.obj.assign({},d.viewState);var e=ol.extent.getCenter(a);d.extent=a.slice();d.focus=e;d.size[0]=Math.round(ol.extent.getWidth(a)/b);d.size[1]=Math.round(ol.extent.getHeight(a)/b);d.time=Date.now();d.animate=!1;a=d.viewState;a.center=e;a.projection=c;a.resolution=b;return d};
ol.source.Raster.prototype.allSourcesReady_=function(){for(var a=!0,b,c=0,d=this.renderers_.length;c<d;++c)if(b=this.renderers_[c].getLayer().getSource(),b.getState()!==ol.source.State.READY){a=!1;break}return a};
ol.source.Raster.prototype.getImage=function(a,b,c,d){if(!this.allSourcesReady_())return null;this.requestedFrameState_=c=this.updateFrameState_(a,b,d);if(this.renderedImageCanvas_){d=this.renderedImageCanvas_.getResolution();var e=this.renderedImageCanvas_.getExtent();b===d&&ol.extent.equals(a,e)||(this.renderedImageCanvas_=null)}this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_();c.tileQueue.loadMoreTiles(16,16);c.animate&&requestAnimationFrame(this.changed.bind(this));
return this.renderedImageCanvas_};ol.source.Raster.prototype.processSources_=function(){for(var a=this.requestedFrameState_,b=this.renderers_.length,c=Array(b),d=0;d<b;++d){var e=ol.source.Raster.getImageData_(this.renderers_[d],a,a.layerStatesArray[d]);if(e)c[d]=e;else return}b={};this.dispatchEvent(new ol.source.Raster.Event(ol.source.Raster.EventType_.BEFOREOPERATIONS,a,b));this.worker_.process(c,b,this.onWorkerComplete_.bind(this,a))};
ol.source.Raster.prototype.onWorkerComplete_=function(a,b,c,d){if(!b&&c){b=a.extent;var e=a.viewState.resolution;if(e===this.requestedFrameState_.viewState.resolution&&ol.extent.equals(b,this.requestedFrameState_.extent)){if(this.renderedImageCanvas_)var f=this.renderedImageCanvas_.getImage().getContext("2d");else{f=Math.round(ol.extent.getWidth(b)/e);var g=Math.round(ol.extent.getHeight(b)/e);f=ol.dom.createCanvasContext2D(f,g);this.renderedImageCanvas_=new ol.ImageCanvas(b,e,1,f.canvas)}f.putImageData(c,
0,0);this.changed();this.renderedRevision_=this.getRevision();this.dispatchEvent(new ol.source.Raster.Event(ol.source.Raster.EventType_.AFTEROPERATIONS,a,d))}}};
ol.source.Raster.getImageData_=function(a,b,c){if(!a.prepareFrame(b,c))return null;var d=b.size[0],e=b.size[1];if(ol.source.Raster.context_){var f=ol.source.Raster.context_.canvas;f.width!==d||f.height!==e?ol.source.Raster.context_=ol.dom.createCanvasContext2D(d,e):ol.source.Raster.context_.clearRect(0,0,d,e)}else ol.source.Raster.context_=ol.dom.createCanvasContext2D(d,e);a.composeFrame(b,c,ol.source.Raster.context_);return ol.source.Raster.context_.getImageData(0,0,d,e)};
ol.source.Raster.context_=null;ol.source.Raster.getLayerStatesArray_=function(a){return a.map(function(a){return a.getLayer().getLayerState()})};ol.source.Raster.createRenderers_=function(a){for(var b=a.length,c=Array(b),d=0;d<b;++d)c[d]=ol.source.Raster.createRenderer_(a[d]);return c};ol.source.Raster.createRenderer_=function(a){var b=null;a instanceof ol.source.Tile?b=ol.source.Raster.createTileRenderer_(a):a instanceof ol.source.Image&&(b=ol.source.Raster.createImageRenderer_(a));return b};
ol.source.Raster.createImageRenderer_=function(a){a=new ol.layer.Image({source:a});return new ol.renderer.canvas.ImageLayer(a)};ol.source.Raster.createTileRenderer_=function(a){a=new ol.layer.Tile({source:a});return new ol.renderer.canvas.TileLayer(a)};ol.source.Raster.Event=function(a,b,c){ol.events.Event.call(this,a);this.extent=b.extent;this.resolution=b.viewState.resolution/b.pixelRatio;this.data=c};ol.inherits(ol.source.Raster.Event,ol.events.Event);
ol.source.Raster.prototype.getImageInternal=function(){return null};ol.source.Raster.EventType_={BEFOREOPERATIONS:"beforeoperations",AFTEROPERATIONS:"afteroperations"};ol.easing={};ol.easing.easeIn=function(a){return Math.pow(a,3)};ol.easing.easeOut=function(a){return 1-ol.easing.easeIn(1-a)};ol.easing.inAndOut=function(a){return 3*a*a-2*a*a*a};ol.easing.linear=function(a){return a};ol.easing.upAndDown=function(a){return.5>a?ol.easing.inAndOut(2*a):1-ol.easing.inAndOut(2*(a-.5))};ol.Tile=function(a,b,c){ol.events.EventTarget.call(this);c=c?c:{};this.tileCoord=a;this.state=b;this.interimTile=null;this.key="";this.transition_=void 0===c.transition?250:c.transition;this.transitionStarts_={}};ol.inherits(ol.Tile,ol.events.EventTarget);ol.Tile.prototype.changed=function(){this.dispatchEvent(ol.events.EventType.CHANGE)};ol.Tile.prototype.getKey=function(){return this.key+"/"+this.tileCoord};
ol.Tile.prototype.getInterimTile=function(){if(!this.interimTile)return this;var a=this.interimTile;do{if(a.getState()==ol.TileState.LOADED)return a;a=a.interimTile}while(a);return this};ol.Tile.prototype.refreshInterimChain=function(){if(this.interimTile){var a=this.interimTile,b=this;do{if(a.getState()==ol.TileState.LOADED){a.interimTile=null;break}else a.getState()==ol.TileState.LOADING?b=a:a.getState()==ol.TileState.IDLE?b.interimTile=a.interimTile:b=a;a=b.interimTile}while(a)}};
ol.Tile.prototype.getTileCoord=function(){return this.tileCoord};ol.Tile.prototype.getState=function(){return this.state};ol.Tile.prototype.setState=function(a){this.state=a;this.changed()};ol.Tile.prototype.load=function(){};ol.Tile.prototype.getAlpha=function(a,b){if(!this.transition_)return 1;var c=this.transitionStarts_[a];if(!c)c=b,this.transitionStarts_[a]=c;else if(-1===c)return 1;a=b-c+1E3/60;return a>=this.transition_?1:ol.easing.easeIn(a/this.transition_)};
ol.Tile.prototype.inTransition=function(a){return this.transition_?-1!==this.transitionStarts_[a]:!1};ol.Tile.prototype.endTransition=function(a){this.transition_&&(this.transitionStarts_[a]=-1)};ol.VectorTile=function(a,b,c,d,e,f){ol.Tile.call(this,a,b,f);this.consumers=0;this.extent_=null;this.format_=d;this.features_=null;this.replayGroups_={};this.tileLoadFunction_=e;this.url_=c};ol.inherits(ol.VectorTile,ol.Tile);ol.VectorTile.prototype.disposeInternal=function(){this.features_=null;this.replayGroups_={};this.state=ol.TileState.ABORT;this.changed();ol.Tile.prototype.disposeInternal.call(this)};ol.VectorTile.prototype.getExtent=function(){return this.extent_||ol.VectorTile.DEFAULT_EXTENT};
ol.VectorTile.prototype.getFormat=function(){return this.format_};ol.VectorTile.prototype.getFeatures=function(){return this.features_};ol.VectorTile.prototype.getKey=function(){return this.url_};ol.VectorTile.prototype.getProjection=function(){return this.projection_};ol.VectorTile.prototype.getReplayGroup=function(a,b){return this.replayGroups_[ol.getUid(a)+","+b]};
ol.VectorTile.prototype.load=function(){this.state==ol.TileState.IDLE&&(this.setState(ol.TileState.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_(null,NaN,null))};ol.VectorTile.prototype.onLoad=function(a,b,c){this.setProjection(b);this.setFeatures(a);this.setExtent(c)};ol.VectorTile.prototype.onError=function(){this.setState(ol.TileState.ERROR)};ol.VectorTile.prototype.setExtent=function(a){this.extent_=a};ol.VectorTile.prototype.setFeatures=function(a){this.features_=a;this.setState(ol.TileState.LOADED)};
ol.VectorTile.prototype.setProjection=function(a){this.projection_=a};ol.VectorTile.prototype.setReplayGroup=function(a,b,c){this.replayGroups_[ol.getUid(a)+","+b]=c};ol.VectorTile.prototype.setLoader=function(a){this.loader_=a};ol.VectorTile.DEFAULT_EXTENT=[0,0,4096,4096];ol.MapEventType={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"};ol.OverlayPositioning={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"};ol.Overlay=function(a){ol.Object.call(this);this.options=a;this.id=a.id;this.insertFirst=void 0!==a.insertFirst?a.insertFirst:!0;this.stopEvent=void 0!==a.stopEvent?a.stopEvent:!0;this.element=document.createElement("DIV");this.element.className=void 0!==a.className?a.className:"ol-overlay-container "+ol.css.CLASS_SELECTABLE;this.element.style.position="absolute";this.autoPan=void 0!==a.autoPan?a.autoPan:!1;this.autoPanAnimation=a.autoPanAnimation||{};this.autoPanMargin=void 0!==a.autoPanMargin?a.autoPanMargin:
20;this.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0};this.mapPostrenderListenerKey=null;ol.events.listen(this,ol.Object.getChangeEventType(ol.Overlay.Property.ELEMENT),this.handleElementChanged,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.Overlay.Property.MAP),this.handleMapChanged,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.Overlay.Property.OFFSET),this.handleOffsetChanged,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.Overlay.Property.POSITION),
this.handlePositionChanged,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.Overlay.Property.POSITIONING),this.handlePositioningChanged,this);void 0!==a.element&&this.setElement(a.element);this.setOffset(void 0!==a.offset?a.offset:[0,0]);this.setPositioning(void 0!==a.positioning?a.positioning:ol.OverlayPositioning.TOP_LEFT);void 0!==a.position&&this.setPosition(a.position)};ol.inherits(ol.Overlay,ol.Object);ol.Overlay.prototype.getElement=function(){return this.get(ol.Overlay.Property.ELEMENT)};
ol.Overlay.prototype.getId=function(){return this.id};ol.Overlay.prototype.getMap=function(){return this.get(ol.Overlay.Property.MAP)};ol.Overlay.prototype.getOffset=function(){return this.get(ol.Overlay.Property.OFFSET)};ol.Overlay.prototype.getPosition=function(){return this.get(ol.Overlay.Property.POSITION)};ol.Overlay.prototype.getPositioning=function(){return this.get(ol.Overlay.Property.POSITIONING)};
ol.Overlay.prototype.handleElementChanged=function(){ol.dom.removeChildren(this.element);var a=this.getElement();a&&this.element.appendChild(a)};
ol.Overlay.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(ol.dom.removeNode(this.element),ol.events.unlistenByKey(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var a=this.getMap();a&&(this.mapPostrenderListenerKey=ol.events.listen(a,ol.MapEventType.POSTRENDER,this.render,this),this.updatePixelPosition(),a=this.stopEvent?a.getOverlayContainerStopEvent():a.getOverlayContainer(),this.insertFirst?a.insertBefore(this.element,a.childNodes[0]||null):a.appendChild(this.element))};
ol.Overlay.prototype.render=function(){this.updatePixelPosition()};ol.Overlay.prototype.handleOffsetChanged=function(){this.updatePixelPosition()};ol.Overlay.prototype.handlePositionChanged=function(){this.updatePixelPosition();this.get(ol.Overlay.Property.POSITION)&&this.autoPan&&this.panIntoView()};ol.Overlay.prototype.handlePositioningChanged=function(){this.updatePixelPosition()};ol.Overlay.prototype.setElement=function(a){this.set(ol.Overlay.Property.ELEMENT,a)};
ol.Overlay.prototype.setMap=function(a){this.set(ol.Overlay.Property.MAP,a)};ol.Overlay.prototype.setOffset=function(a){this.set(ol.Overlay.Property.OFFSET,a)};ol.Overlay.prototype.setPosition=function(a){this.set(ol.Overlay.Property.POSITION,a)};
ol.Overlay.prototype.panIntoView=function(){var a=this.getMap();if(a&&a.getTargetElement()){var b=this.getRect(a.getTargetElement(),a.getSize()),c=this.getElement(),d=this.getRect(c,[ol.dom.outerWidth(c),ol.dom.outerHeight(c)]);c=this.autoPanMargin;if(!ol.extent.containsExtent(b,d)){var e=d[0]-b[0],f=b[2]-d[2],g=d[1]-b[1];d=b[3]-d[3];b=[0,0];0>e?b[0]=e-c:0>f&&(b[0]=Math.abs(f)+c);0>g?b[1]=g-c:0>d&&(b[1]=Math.abs(d)+c);if(0!==b[0]||0!==b[1])c=a.getView().getCenter(),c=a.getPixelFromCoordinate(c),c=
[c[0]+b[0],c[1]+b[1]],a.getView().animate({center:a.getCoordinateFromPixel(c),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}};ol.Overlay.prototype.getRect=function(a,b){var c=a.getBoundingClientRect();a=c.left+window.pageXOffset;c=c.top+window.pageYOffset;return[a,c,a+b[0],c+b[1]]};ol.Overlay.prototype.setPositioning=function(a){this.set(ol.Overlay.Property.POSITIONING,a)};
ol.Overlay.prototype.setVisible=function(a){this.rendered.visible!==a&&(this.element.style.display=a?"":"none",this.rendered.visible=a)};ol.Overlay.prototype.updatePixelPosition=function(){var a=this.getMap(),b=this.getPosition();a&&a.isRendered()&&b?(b=a.getPixelFromCoordinate(b),a=a.getSize(),this.updateRenderedPosition(b,a)):this.setVisible(!1)};
ol.Overlay.prototype.updateRenderedPosition=function(a,b){var c=this.element.style,d=this.getOffset(),e=this.getPositioning();this.setVisible(!0);var f=d[0];d=d[1];if(e==ol.OverlayPositioning.BOTTOM_RIGHT||e==ol.OverlayPositioning.CENTER_RIGHT||e==ol.OverlayPositioning.TOP_RIGHT)""!==this.rendered.left_&&(this.rendered.left_=c.left=""),f=Math.round(b[0]-a[0]-f)+"px",this.rendered.right_!=f&&(this.rendered.right_=c.right=f);else{""!==this.rendered.right_&&(this.rendered.right_=c.right="");if(e==ol.OverlayPositioning.BOTTOM_CENTER||
e==ol.OverlayPositioning.CENTER_CENTER||e==ol.OverlayPositioning.TOP_CENTER)f-=this.element.offsetWidth/2;f=Math.round(a[0]+f)+"px";this.rendered.left_!=f&&(this.rendered.left_=c.left=f)}if(e==ol.OverlayPositioning.BOTTOM_LEFT||e==ol.OverlayPositioning.BOTTOM_CENTER||e==ol.OverlayPositioning.BOTTOM_RIGHT)""!==this.rendered.top_&&(this.rendered.top_=c.top=""),a=Math.round(b[1]-a[1]-d)+"px",this.rendered.bottom_!=a&&(this.rendered.bottom_=c.bottom=a);else{""!==this.rendered.bottom_&&(this.rendered.bottom_=
c.bottom="");if(e==ol.OverlayPositioning.CENTER_LEFT||e==ol.OverlayPositioning.CENTER_CENTER||e==ol.OverlayPositioning.CENTER_RIGHT)d-=this.element.offsetHeight/2;a=Math.round(a[1]+d)+"px";this.rendered.top_!=a&&(this.rendered.top_=c.top=a)}};ol.Overlay.prototype.getOptions=function(){return this.options};ol.Overlay.Property={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};ol.control={};ol.control.Control=function(a){ol.Object.call(this);this.element=a.element?a.element:null;this.map_=this.target_=null;this.listenerKeys=[];this.render=a.render?a.render:ol.nullFunction;a.target&&this.setTarget(a.target)};ol.inherits(ol.control.Control,ol.Object);ol.control.Control.prototype.disposeInternal=function(){ol.dom.removeNode(this.element);ol.Object.prototype.disposeInternal.call(this)};ol.control.Control.prototype.getMap=function(){return this.map_};
ol.control.Control.prototype.setMap=function(a){this.map_&&ol.dom.removeNode(this.element);for(var b=0,c=this.listenerKeys.length;b<c;++b)ol.events.unlistenByKey(this.listenerKeys[b]);this.listenerKeys.length=0;if(this.map_=a)(this.target_?this.target_:a.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==ol.nullFunction&&this.listenerKeys.push(ol.events.listen(a,ol.MapEventType.POSTRENDER,this.render,this)),a.render()};
ol.control.Control.prototype.setTarget=function(a){this.target_="string"===typeof a?document.getElementById(a):a};ol.control.ScaleLineUnits={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"};ol.control.ScaleLine=function(a){a=a?a:{};var b=void 0!==a.className?a.className:"ol-scale-line";this.innerElement_=document.createElement("DIV");this.innerElement_.className=b+"-inner";this.element_=document.createElement("DIV");this.element_.className=b+" "+ol.css.CLASS_UNSELECTABLE;this.element_.appendChild(this.innerElement_);this.viewState_=null;this.minWidth_=void 0!==a.minWidth?a.minWidth:64;this.renderedVisible_=!1;this.renderedWidth_=void 0;this.renderedHTML_="";ol.control.Control.call(this,
{element:this.element_,render:a.render?a.render:ol.control.ScaleLine.render,target:a.target});ol.events.listen(this,ol.Object.getChangeEventType(ol.control.ScaleLine.Property_.UNITS),this.handleUnitsChanged_,this);this.setUnits(a.units||ol.control.ScaleLineUnits.METRIC)};ol.inherits(ol.control.ScaleLine,ol.control.Control);ol.control.ScaleLine.LEADING_DIGITS=[1,2,5];ol.control.ScaleLine.prototype.getUnits=function(){return this.get(ol.control.ScaleLine.Property_.UNITS)};
ol.control.ScaleLine.render=function(a){this.viewState_=(a=a.frameState)?a.viewState:null;this.updateElement_()};ol.control.ScaleLine.prototype.handleUnitsChanged_=function(){this.updateElement_()};ol.control.ScaleLine.prototype.setUnits=function(a){this.set(ol.control.ScaleLine.Property_.UNITS,a)};
ol.control.ScaleLine.prototype.updateElement_=function(){var a=this.viewState_;if(a){var b=a.center,c=a.projection,d=this.getUnits();a=ol.proj.getPointResolution(c,a.resolution,b,d==ol.control.ScaleLineUnits.DEGREES?ol.proj.Units.DEGREES:ol.proj.Units.METERS);var e=this.minWidth_*a;b="";d==ol.control.ScaleLineUnits.DEGREES?(b=ol.proj.METERS_PER_UNIT[ol.proj.Units.DEGREES],c.getUnits()==ol.proj.Units.DEGREES?e*=b:a/=b,e<b/60?(b="\u2033",a*=3600):e<b?(b="\u2032",a*=60):b="\u00b0"):d==ol.control.ScaleLineUnits.IMPERIAL?
.9144>e?(b="in",a/=.0254):1609.344>e?(b="ft",a/=.3048):(b="mi",a/=1609.344):d==ol.control.ScaleLineUnits.NAUTICAL?(a/=1852,b="nm"):d==ol.control.ScaleLineUnits.METRIC?.001>e?(b="\u03bcm",a*=1E6):1>e?(b="mm",a*=1E3):1E3>e?b="m":(b="km",a/=1E3):d==ol.control.ScaleLineUnits.US?.9144>e?(b="in",a*=39.37):1609.344>e?(b="ft",a/=.30480061):(b="mi",a/=1609.3472):ol.asserts.assert(!1,33);for(d=3*Math.floor(Math.log(this.minWidth_*a)/Math.log(10));;){e=ol.control.ScaleLine.LEADING_DIGITS[(d%3+3)%3]*Math.pow(10,
Math.floor(d/3));c=Math.round(e/a);if(isNaN(c)){this.element_.style.display="none";this.renderedVisible_=!1;return}if(c>=this.minWidth_)break;++d}a=e+" "+b;this.renderedHTML_!=a&&(this.renderedHTML_=this.innerElement_.innerHTML=a);this.renderedWidth_!=c&&(this.innerElement_.style.width=c+"px",this.renderedWidth_=c);this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)};
ol.control.ScaleLine.Property_={UNITS:"units"};ol.TileUrlFunction={};ol.TileUrlFunction.createFromTemplate=function(a,b){var c=/\{z\}/g,d=/\{x\}/g,e=/\{y\}/g,f=/\{-y\}/g;return function(g,h,k){if(g)return a.replace(c,g[0].toString()).replace(d,g[1].toString()).replace(e,function(){return(-g[2]-1).toString()}).replace(f,function(){var a=b.getFullTileRange(g[0]);ol.asserts.assert(a,55);return(a.getHeight()+g[2]).toString()})}};
ol.TileUrlFunction.createFromTemplates=function(a,b){for(var c=a.length,d=Array(c),e=0;e<c;++e)d[e]=ol.TileUrlFunction.createFromTemplate(a[e],b);return ol.TileUrlFunction.createFromTileUrlFunctions(d)};ol.TileUrlFunction.createFromTileUrlFunctions=function(a){return 1===a.length?a[0]:function(b,c,d){if(b){var e=ol.tilecoord.hash(b);e=ol.math.modulo(e,a.length);return a[e](b,c,d)}}};ol.TileUrlFunction.nullTileUrlFunction=function(a,b,c){};
ol.TileUrlFunction.expandUrl=function(a){var b=[],c=/\{([a-z])-([a-z])\}/.exec(a);if(c){for(var d=c[1].charCodeAt(0),e=c[2].charCodeAt(0);d<=e;++d)b.push(a.replace(c[0],String.fromCharCode(d)));return b}if(c=c=/\{(\d+)-(\d+)\}/.exec(a)){e=parseInt(c[2],10);for(d=parseInt(c[1],10);d<=e;d++)b.push(a.replace(c[0],d.toString()));return b}b.push(a);return b};ol.ImageTile=function(a,b,c,d,e,f){ol.Tile.call(this,a,b,f);this.src_=c;this.image_=new Image;null!==d&&(this.image_.crossOrigin=d);this.imageListenerKeys_=null;this.tileLoadFunction_=e};ol.inherits(ol.ImageTile,ol.Tile);ol.ImageTile.prototype.disposeInternal=function(){this.state==ol.TileState.LOADING&&(this.unlistenImage_(),this.image_=ol.ImageTile.getBlankImage());this.interimTile&&this.interimTile.dispose();this.state=ol.TileState.ABORT;this.changed();ol.Tile.prototype.disposeInternal.call(this)};
ol.ImageTile.prototype.getImage=function(){return this.image_};ol.ImageTile.prototype.getKey=function(){return this.src_};ol.ImageTile.prototype.handleImageError_=function(){this.state=ol.TileState.ERROR;this.unlistenImage_();this.image_=ol.ImageTile.getBlankImage();this.changed()};ol.ImageTile.prototype.handleImageLoad_=function(){this.state=this.image_.naturalWidth&&this.image_.naturalHeight?ol.TileState.LOADED:ol.TileState.EMPTY;this.unlistenImage_();this.changed()};
ol.ImageTile.prototype.load=function(){if(this.state==ol.TileState.IDLE||this.state==ol.TileState.ERROR)this.state=ol.TileState.LOADING,this.changed(),this.imageListenerKeys_=[ol.events.listenOnce(this.image_,ol.events.EventType.ERROR,this.handleImageError_,this),ol.events.listenOnce(this.image_,ol.events.EventType.LOAD,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_)};
ol.ImageTile.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(ol.events.unlistenByKey);this.imageListenerKeys_=null};ol.ImageTile.getBlankImage=function(){var a=ol.dom.createCanvasContext2D(1,1);a.fillStyle="rgba(0,0,0,0)";a.fillRect(0,0,1,1);return a.canvas};ol.reproj.Tile=function(a,b,c,d,e,f,g,h,k,l,m){ol.Tile.call(this,e,ol.TileState.IDLE);this.renderEdges_=void 0!==m?m:!1;this.pixelRatio_=g;this.gutter_=h;this.canvas_=null;this.sourceTileGrid_=b;this.targetTileGrid_=d;this.wrappedTileCoord_=f?f:e;this.sourceTiles_=[];this.sourcesListenerKeys_=null;this.sourceZ_=0;f=d.getTileCoordExtent(this.wrappedTileCoord_);h=this.targetTileGrid_.getExtent();e=this.sourceTileGrid_.getExtent();f=h?ol.extent.getIntersection(f,h):f;if(0===ol.extent.getArea(f))this.state=
ol.TileState.EMPTY;else if((h=a.getExtent())&&(e=e?ol.extent.getIntersection(e,h):h),d=d.getResolution(this.wrappedTileCoord_[0]),h=ol.extent.getCenter(f),d=ol.reproj.calculateSourceResolution(a,c,h,d),!isFinite(d)||0>=d)this.state=ol.TileState.EMPTY;else if(this.triangulation_=new ol.reproj.Triangulation(a,c,f,e,d*(void 0!==l?l:ol.DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD)),0===this.triangulation_.getTriangles().length)this.state=ol.TileState.EMPTY;else if(this.sourceZ_=b.getZForResolution(d),
c=this.triangulation_.calculateSourceExtent(),e&&(a.canWrapX()?(c[1]=ol.math.clamp(c[1],e[1],e[3]),c[3]=ol.math.clamp(c[3],e[1],e[3])):c=ol.extent.getIntersection(c,e)),ol.extent.getArea(c)){a=b.getTileRangeForExtentAndZ(c,this.sourceZ_);for(b=a.minX;b<=a.maxX;b++)for(c=a.minY;c<=a.maxY;c++)(l=k(this.sourceZ_,b,c,g))&&this.sourceTiles_.push(l);0===this.sourceTiles_.length&&(this.state=ol.TileState.EMPTY)}else this.state=ol.TileState.EMPTY};ol.inherits(ol.reproj.Tile,ol.Tile);
ol.reproj.Tile.prototype.disposeInternal=function(){this.state==ol.TileState.LOADING&&this.unlistenSources_();ol.Tile.prototype.disposeInternal.call(this)};ol.reproj.Tile.prototype.getImage=function(){return this.canvas_};
ol.reproj.Tile.prototype.reproject_=function(){var a=[];this.sourceTiles_.forEach(function(b,c,d){b&&b.getState()==ol.TileState.LOADED&&a.push({extent:this.sourceTileGrid_.getTileCoordExtent(b.tileCoord),image:b.getImage()})},this);this.sourceTiles_.length=0;if(0===a.length)this.state=ol.TileState.ERROR;else{var b=this.wrappedTileCoord_[0],c=this.targetTileGrid_.getTileSize(b),d="number"===typeof c?c:c[0];c="number"===typeof c?c:c[1];b=this.targetTileGrid_.getResolution(b);var e=this.sourceTileGrid_.getResolution(this.sourceZ_),
f=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=ol.reproj.render(d,c,this.pixelRatio_,e,this.sourceTileGrid_.getExtent(),b,f,this.triangulation_,a,this.gutter_,this.renderEdges_);this.state=ol.TileState.LOADED}this.changed()};
ol.reproj.Tile.prototype.load=function(){if(this.state==ol.TileState.IDLE){this.state=ol.TileState.LOADING;this.changed();var a=0;this.sourcesListenerKeys_=[];this.sourceTiles_.forEach(function(b,c,d){c=b.getState();if(c==ol.TileState.IDLE||c==ol.TileState.LOADING){a++;var e=ol.events.listen(b,ol.events.EventType.CHANGE,function(c){c=b.getState();if(c==ol.TileState.LOADED||c==ol.TileState.ERROR||c==ol.TileState.EMPTY)ol.events.unlistenByKey(e),a--,0===a&&(this.unlistenSources_(),this.reproject_())},
this);this.sourcesListenerKeys_.push(e)}},this);this.sourceTiles_.forEach(function(a,c,d){a.getState()==ol.TileState.IDLE&&a.load()});0===a&&setTimeout(this.reproject_.bind(this),0)}};ol.reproj.Tile.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(ol.events.unlistenByKey);this.sourcesListenerKeys_=null};ol.source.TileEventType={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};ol.source.UrlTile=function(a){ol.source.Tile.call(this,{attributions:a.attributions,cacheSize:a.cacheSize,extent:a.extent,logo:a.logo,opaque:a.opaque,projection:a.projection,state:a.state,tileGrid:a.tileGrid,tilePixelRatio:a.tilePixelRatio,wrapX:a.wrapX,transition:a.transition});this.tileLoadFunction=a.tileLoadFunction;this.tileUrlFunction=this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):ol.TileUrlFunction.nullTileUrlFunction;this.urls=null;a.urls?this.setUrls(a.urls):a.url&&this.setUrl(a.url);
a.tileUrlFunction&&this.setTileUrlFunction(a.tileUrlFunction);this.tileLoadingKeys_={}};ol.inherits(ol.source.UrlTile,ol.source.Tile);ol.source.UrlTile.prototype.getTileLoadFunction=function(){return this.tileLoadFunction};ol.source.UrlTile.prototype.getTileUrlFunction=function(){return this.tileUrlFunction};ol.source.UrlTile.prototype.getUrls=function(){return this.urls};
ol.source.UrlTile.prototype.handleTileChange=function(a){a=a.target;var b=ol.getUid(a),c=a.getState();if(c==ol.TileState.LOADING){this.tileLoadingKeys_[b]=!0;var d=ol.source.TileEventType.TILELOADSTART}else b in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[b],d=c==ol.TileState.ERROR?ol.source.TileEventType.TILELOADERROR:c==ol.TileState.LOADED||c==ol.TileState.ABORT?ol.source.TileEventType.TILELOADEND:void 0);void 0!=d&&this.dispatchEvent(new ol.source.Tile.Event(d,a))};
ol.source.UrlTile.prototype.setTileLoadFunction=function(a){this.tileCache.clear();this.tileLoadFunction=a;this.changed()};ol.source.UrlTile.prototype.setTileUrlFunction=function(a,b){this.tileUrlFunction=a;this.tileCache.pruneExceptNewestZ();"undefined"!==typeof b?this.setKey(b):this.changed()};
ol.source.UrlTile.prototype.setUrl=function(a){var b=this.urls=ol.TileUrlFunction.expandUrl(a);this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):ol.TileUrlFunction.createFromTemplates(b,this.tileGrid),a)};ol.source.UrlTile.prototype.setUrls=function(a){this.urls=a;var b=a.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):ol.TileUrlFunction.createFromTemplates(a,this.tileGrid),b)};
ol.source.UrlTile.prototype.useTile=function(a,b,c){a=ol.tilecoord.getKeyZXY(a,b,c);this.tileCache.containsKey(a)&&this.tileCache.get(a)};ol.source.TileImage=function(a){ol.source.UrlTile.call(this,{attributions:a.attributions,cacheSize:a.cacheSize,extent:a.extent,logo:a.logo,opaque:a.opaque,projection:a.projection,state:a.state,tileGrid:a.tileGrid,tileLoadFunction:a.tileLoadFunction?a.tileLoadFunction:ol.source.TileImage.defaultTileLoadFunction,tilePixelRatio:a.tilePixelRatio,tileUrlFunction:a.tileUrlFunction,url:a.url,urls:a.urls,wrapX:a.wrapX,transition:a.transition});this.crossOrigin=void 0!==a.crossOrigin?a.crossOrigin:null;this.tileClass=
void 0!==a.tileClass?a.tileClass:ol.ImageTile;this.tileCacheForProjection={};this.tileGridForProjection={};this.reprojectionErrorThreshold_=a.reprojectionErrorThreshold;this.renderReprojectionEdges_=!1};ol.inherits(ol.source.TileImage,ol.source.UrlTile);
ol.source.TileImage.prototype.canExpireCache=function(){if(!ol.ENABLE_RASTER_REPROJECTION)return ol.source.UrlTile.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var a in this.tileCacheForProjection)if(this.tileCacheForProjection[a].canExpireCache())return!0;return!1};
ol.source.TileImage.prototype.expireCache=function(a,b){if(ol.ENABLE_RASTER_REPROJECTION){a=this.getTileCacheForProjection(a);this.tileCache.expireCache(this.tileCache==a?b:{});for(var c in this.tileCacheForProjection){var d=this.tileCacheForProjection[c];d.expireCache(d==a?b:{})}}else ol.source.UrlTile.prototype.expireCache.call(this,a,b)};
ol.source.TileImage.prototype.getGutter=function(a){return ol.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&a&&!ol.proj.equivalent(this.getProjection(),a)?0:this.getGutterInternal()};ol.source.TileImage.prototype.getGutterInternal=function(){return 0};ol.source.TileImage.prototype.getOpaque=function(a){return ol.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&a&&!ol.proj.equivalent(this.getProjection(),a)?!1:ol.source.UrlTile.prototype.getOpaque.call(this,a)};
ol.source.TileImage.prototype.getTileGridForProjection=function(a){if(!ol.ENABLE_RASTER_REPROJECTION)return ol.source.UrlTile.prototype.getTileGridForProjection.call(this,a);var b=this.getProjection();return!this.tileGrid||b&&!ol.proj.equivalent(b,a)?(b=ol.getUid(a).toString(),b in this.tileGridForProjection||(this.tileGridForProjection[b]=ol.tilegrid.getForProjection(a)),this.tileGridForProjection[b]):this.tileGrid};
ol.source.TileImage.prototype.getTileCacheForProjection=function(a){if(!ol.ENABLE_RASTER_REPROJECTION)return ol.source.UrlTile.prototype.getTileCacheForProjection.call(this,a);var b=this.getProjection();if(!b||ol.proj.equivalent(b,a))return this.tileCache;a=ol.getUid(a).toString();a in this.tileCacheForProjection||(this.tileCacheForProjection[a]=new ol.TileCache(this.tileCache.highWaterMark));return this.tileCacheForProjection[a]};
ol.source.TileImage.prototype.createTile_=function(a,b,c,d,e,f){a=[a,b,c];d=(b=this.getTileCoordForTileUrlFunction(a,e))?this.tileUrlFunction(b,d,e):void 0;d=new this.tileClass(a,void 0!==d?ol.TileState.IDLE:ol.TileState.EMPTY,void 0!==d?d:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);d.key=f;ol.events.listen(d,ol.events.EventType.CHANGE,this.handleTileChange,this);return d};
ol.source.TileImage.prototype.getTile=function(a,b,c,d,e){var f=this.getProjection();if(ol.ENABLE_RASTER_REPROJECTION&&f&&e&&!ol.proj.equivalent(f,e)){var g=this.getTileCacheForProjection(e);c=[a,b,c];var h;a=ol.tilecoord.getKey(c);g.containsKey(a)&&(h=g.get(a));b=this.getKey();if(h&&h.key==b)return h;var k=this.getTileGridForProjection(f),l=this.getTileGridForProjection(e),m=this.getTileCoordForTileUrlFunction(c,e);d=new ol.reproj.Tile(f,k,e,l,c,m,this.getTilePixelRatio(d),this.getGutterInternal(),
function(a,b,c,d){return this.getTileInternal(a,b,c,d,f)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);d.key=b;h?(d.interimTile=h,d.refreshInterimChain(),g.replace(a,d)):g.set(a,d);return d}return this.getTileInternal(a,b,c,d,f||e)};
ol.source.TileImage.prototype.getTileInternal=function(a,b,c,d,e){var f=ol.tilecoord.getKeyZXY(a,b,c),g=this.getKey();if(this.tileCache.containsKey(f)){var h=this.tileCache.get(f);if(h.key!=g){var k=h;h=this.createTile_(a,b,c,d,e,g);k.getState()==ol.TileState.IDLE?h.interimTile=k.interimTile:h.interimTile=k;h.refreshInterimChain();this.tileCache.replace(f,h)}}else h=this.createTile_(a,b,c,d,e,g),this.tileCache.set(f,h);return h};
ol.source.TileImage.prototype.setRenderReprojectionEdges=function(a){if(ol.ENABLE_RASTER_REPROJECTION&&this.renderReprojectionEdges_!=a){this.renderReprojectionEdges_=a;for(var b in this.tileCacheForProjection)this.tileCacheForProjection[b].clear();this.changed()}};ol.source.TileImage.prototype.setTileGridForProjection=function(a,b){ol.ENABLE_RASTER_REPROJECTION&&(a=ol.proj.get(a))&&(a=ol.getUid(a).toString(),a in this.tileGridForProjection||(this.tileGridForProjection[a]=b))};
ol.source.TileImage.defaultTileLoadFunction=function(a,b){a.getImage().src=b};ol.source.WMTSRequestEncoding={KVP:"KVP",REST:"REST"};ol.tilegrid.WMTS=function(a){this.matrixIds_=a.matrixIds;ol.tilegrid.TileGrid.call(this,{extent:a.extent,origin:a.origin,origins:a.origins,resolutions:a.resolutions,tileSize:a.tileSize,tileSizes:a.tileSizes,sizes:a.sizes})};ol.inherits(ol.tilegrid.WMTS,ol.tilegrid.TileGrid);ol.tilegrid.WMTS.prototype.getMatrixId=function(a){return this.matrixIds_[a]};ol.tilegrid.WMTS.prototype.getMatrixIds=function(){return this.matrixIds_};
ol.tilegrid.WMTS.createFromCapabilitiesMatrixSet=function(a,b,c){var d=[],e=[],f=[],g=[],h=[],k=void 0!==c?c:[];c=ol.proj.get(a.SupportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"));var l=c.getMetersPerUnit(),m="ne"==c.getAxisOrientation().substr(0,2);a.TileMatrix.sort(function(a,b){return b.ScaleDenominator-a.ScaleDenominator});a.TileMatrix.forEach(function(a,b,c){if(0<k.length?ol.array.find(k,function(b,c,d){return a.Identifier==b.TileMatrix}):1){e.push(a.Identifier);b=2.8E-4*a.ScaleDenominator/
l;c=a.TileWidth;var n=a.TileHeight;m?f.push([a.TopLeftCorner[1],a.TopLeftCorner[0]]):f.push(a.TopLeftCorner);d.push(b);g.push(c==n?c:[c,n]);h.push([a.MatrixWidth,-a.MatrixHeight])}});return new ol.tilegrid.WMTS({extent:b,origins:f,resolutions:d,matrixIds:e,tileSizes:g,sizes:h})};ol.uri={};ol.uri.appendParams=function(a,b){var c=[];Object.keys(b).forEach(function(a){null!==b[a]&&void 0!==b[a]&&c.push(a+"="+encodeURIComponent(b[a]))});var d=c.join("&");a=a.replace(/[?&]$/,"");a=-1===a.indexOf("?")?a+"?":a+"&";return a+d};ol.source.WMTS=function(a){function b(a){a=d==ol.source.WMTSRequestEncoding.KVP?ol.uri.appendParams(a,f):a.replace(/\{(\w+?)\}/g,function(a,b){return b.toLowerCase()in f?f[b.toLowerCase()]:a});return function(b,c,f){if(b){var h={TileMatrix:e.getMatrixId(b[0]),TileCol:b[1],TileRow:-b[2]-1};ol.obj.assign(h,g);b=a;return b=d==ol.source.WMTSRequestEncoding.KVP?ol.uri.appendParams(b,h):b.replace(/\{(\w+?)\}/g,function(a,b){return h[b]})}}}this.version_=void 0!==a.version?a.version:"1.0.0";this.format_=
void 0!==a.format?a.format:"image/jpeg";this.dimensions_=void 0!==a.dimensions?a.dimensions:{};this.layer_=a.layer;this.matrixSet_=a.matrixSet;this.style_=a.style;var c=a.urls;void 0===c&&void 0!==a.url&&(c=ol.TileUrlFunction.expandUrl(a.url));var d=this.requestEncoding_=void 0!==a.requestEncoding?a.requestEncoding:ol.source.WMTSRequestEncoding.KVP,e=a.tileGrid,f={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};d==ol.source.WMTSRequestEncoding.KVP&&ol.obj.assign(f,{Service:"WMTS",
Request:"GetTile",Version:this.version_,Format:this.format_});var g=this.dimensions_,h=c&&0<c.length?ol.TileUrlFunction.createFromTileUrlFunctions(c.map(b)):ol.TileUrlFunction.nullTileUrlFunction;ol.source.TileImage.call(this,{attributions:a.attributions,cacheSize:a.cacheSize,crossOrigin:a.crossOrigin,logo:a.logo,projection:a.projection,reprojectionErrorThreshold:a.reprojectionErrorThreshold,tileClass:a.tileClass,tileGrid:e,tileLoadFunction:a.tileLoadFunction,tilePixelRatio:a.tilePixelRatio,tileUrlFunction:h,
urls:c,wrapX:void 0!==a.wrapX?a.wrapX:!1,transition:a.transition});this.setKey(this.getKeyForDimensions_())};ol.inherits(ol.source.WMTS,ol.source.TileImage);ol.source.WMTS.prototype.getDimensions=function(){return this.dimensions_};ol.source.WMTS.prototype.getFormat=function(){return this.format_};ol.source.WMTS.prototype.getLayer=function(){return this.layer_};ol.source.WMTS.prototype.getMatrixSet=function(){return this.matrixSet_};ol.source.WMTS.prototype.getRequestEncoding=function(){return this.requestEncoding_};
ol.source.WMTS.prototype.getStyle=function(){return this.style_};ol.source.WMTS.prototype.getVersion=function(){return this.version_};ol.source.WMTS.prototype.getKeyForDimensions_=function(){var a=0,b=[],c;for(c in this.dimensions_)b[a++]=c+"-"+this.dimensions_[c];return b.join("/")};ol.source.WMTS.prototype.updateDimensions=function(a){ol.obj.assign(this.dimensions_,a);this.setKey(this.getKeyForDimensions_())};
ol.source.WMTS.optionsFromCapabilities=function(a,b){var c=ol.array.find(a.Contents.Layer,function(a,c,d){return a.Identifier==b.layer});if(null===c)return null;var d=a.Contents.TileMatrixSet;var e=1<c.TileMatrixSetLink.length?"projection"in b?ol.array.findIndex(c.TileMatrixSetLink,function(a,c,e){c=ol.array.find(d,function(b){return b.Identifier==a.TileMatrixSet}).SupportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3");e=ol.proj.get(c);var f=ol.proj.get(b.projection);return e&&f?ol.proj.equivalent(e,
f):c==b.projection}):ol.array.findIndex(c.TileMatrixSetLink,function(a,c,d){return a.TileMatrixSet==b.matrixSet}):0;0>e&&(e=0);var f=c.TileMatrixSetLink[e].TileMatrixSet;var g=c.TileMatrixSetLink[e].TileMatrixSetLimits;var h=c.Format[0];"format"in b&&(h=b.format);e=ol.array.findIndex(c.Style,function(a,c,d){return"style"in b?a.Title==b.style:a.isDefault});0>e&&(e=0);e=c.Style[e].Identifier;var k={};"Dimension"in c&&c.Dimension.forEach(function(a,b,c){b=a.Identifier;c=a.Default;void 0===c&&(c=a.Value[0]);
k[b]=c});var l=ol.array.find(a.Contents.TileMatrixSet,function(a,b,c){return a.Identifier==f});var m="projection"in b?ol.proj.get(b.projection):ol.proj.get(l.SupportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"));var n=c.WGS84BoundingBox;if(void 0!==n){var p=ol.proj.get("EPSG:4326").getExtent();p=n[0]==p[0]&&n[2]==p[2];var q=ol.proj.transformExtent(n,"EPSG:4326",m);(n=m.getExtent())&&(ol.extent.containsExtent(n,q)||(q=void 0))}g=ol.tilegrid.WMTS.createFromCapabilitiesMatrixSet(l,q,g);
var r=[];l=b.requestEncoding;l=void 0!==l?l:"";if("OperationsMetadata"in a&&"GetTile"in a.OperationsMetadata)for(a=a.OperationsMetadata.GetTile.DCP.HTTP.Get,q=0,n=a.length;q<n;++q){var u=ol.array.find(a[q].Constraint,function(a){return"GetEncoding"==a.name}).AllowedValues.Value;""===l&&(l=u[0]);if(l===ol.source.WMTSRequestEncoding.KVP)ol.array.includes(u,ol.source.WMTSRequestEncoding.KVP)&&r.push(a[q].href);else break}0===r.length&&(l=ol.source.WMTSRequestEncoding.REST,c.ResourceURL.forEach(function(a){"tile"===
a.resourceType&&(h=a.format,r.push(a.template))}));return{urls:r,layer:b.layer,matrixSet:f,format:h,projection:m,requestEncoding:l,tileGrid:g,style:e,dimensions:k,wrapX:p,crossOrigin:b.crossOrigin}};ol.style.IconAnchorUnits={FRACTION:"fraction",PIXELS:"pixels"};ol.style.IconImageCache=function(){this.cache_={};this.cacheSize_=0;this.maxCacheSize_=32};ol.style.IconImageCache.getKey=function(a,b,c){c=c?ol.color.asString(c):"null";return b+":"+a+":"+c};ol.style.IconImageCache.prototype.clear=function(){this.cache_={};this.cacheSize_=0};ol.style.IconImageCache.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var a=0,b;for(b in this.cache_){var c=this.cache_[b];0!==(a++&3)||c.hasListener()||(delete this.cache_[b],--this.cacheSize_)}}};
ol.style.IconImageCache.prototype.get=function(a,b,c){a=ol.style.IconImageCache.getKey(a,b,c);return a in this.cache_?this.cache_[a]:null};ol.style.IconImageCache.prototype.set=function(a,b,c,d){a=ol.style.IconImageCache.getKey(a,b,c);this.cache_[a]=d;++this.cacheSize_};ol.style.iconImageCache=new ol.style.IconImageCache;ol.style.IconImage=function(a,b,c,d,e,f){ol.events.EventTarget.call(this);this.hitDetectionImage_=null;this.image_=a?a:new Image;null!==d&&(this.image_.crossOrigin=d);this.canvas_=f?document.createElement("CANVAS"):null;this.color_=f;this.imageListenerKeys_=null;this.imageState_=e;this.size_=c;this.src_=b;this.tainting_=!1;this.imageState_==ol.ImageState.LOADED&&this.determineTainting_()};ol.inherits(ol.style.IconImage,ol.events.EventTarget);
ol.style.IconImage.get=function(a,b,c,d,e,f){var g=ol.style.iconImageCache,h=g.get(b,d,f);h||(h=new ol.style.IconImage(a,b,c,d,e,f),g.set(b,d,f,h));return h};ol.style.IconImage.prototype.determineTainting_=function(){var a=ol.dom.createCanvasContext2D(1,1);try{a.drawImage(this.image_,0,0),a.getImageData(0,0,1,1)}catch(b){this.tainting_=!0}};ol.style.IconImage.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(ol.events.EventType.CHANGE)};
ol.style.IconImage.prototype.handleImageError_=function(){this.imageState_=ol.ImageState.ERROR;this.unlistenImage_();this.dispatchChangeEvent_()};ol.style.IconImage.prototype.handleImageLoad_=function(){this.imageState_=ol.ImageState.LOADED;this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]);this.size_=[this.image_.width,this.image_.height];this.unlistenImage_();this.determineTainting_();this.replaceColor_();this.dispatchChangeEvent_()};
ol.style.IconImage.prototype.getImage=function(a){return this.canvas_?this.canvas_:this.image_};ol.style.IconImage.prototype.getImageState=function(){return this.imageState_};ol.style.IconImage.prototype.getHitDetectionImage=function(a){if(!this.hitDetectionImage_)if(this.tainting_){a=this.size_[0];var b=this.size_[1],c=ol.dom.createCanvasContext2D(a,b);c.fillRect(0,0,a,b);this.hitDetectionImage_=c.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_};
ol.style.IconImage.prototype.getSize=function(){return this.size_};ol.style.IconImage.prototype.getSrc=function(){return this.src_};ol.style.IconImage.prototype.load=function(){if(this.imageState_==ol.ImageState.IDLE){this.imageState_=ol.ImageState.LOADING;this.imageListenerKeys_=[ol.events.listenOnce(this.image_,ol.events.EventType.ERROR,this.handleImageError_,this),ol.events.listenOnce(this.image_,ol.events.EventType.LOAD,this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(a){this.handleImageError_()}}};
ol.style.IconImage.prototype.replaceColor_=function(){if(!this.tainting_&&null!==this.color_){this.canvas_.width=this.image_.width;this.canvas_.height=this.image_.height;var a=this.canvas_.getContext("2d");a.drawImage(this.image_,0,0);for(var b=a.getImageData(0,0,this.image_.width,this.image_.height),c=b.data,d=this.color_[0]/255,e=this.color_[1]/255,f=this.color_[2]/255,g=0,h=c.length;g<h;g+=4)c[g]*=d,c[g+1]*=e,c[g+2]*=f;a.putImageData(b,0,0)}};
ol.style.IconImage.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(ol.events.unlistenByKey);this.imageListenerKeys_=null};ol.style.IconOrigin={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};ol.style.Icon=function(a){a=a||{};this.anchor_=void 0!==a.anchor?a.anchor:[.5,.5];this.normalizedAnchor_=null;this.anchorOrigin_=void 0!==a.anchorOrigin?a.anchorOrigin:ol.style.IconOrigin.TOP_LEFT;this.anchorXUnits_=void 0!==a.anchorXUnits?a.anchorXUnits:ol.style.IconAnchorUnits.FRACTION;this.anchorYUnits_=void 0!==a.anchorYUnits?a.anchorYUnits:ol.style.IconAnchorUnits.FRACTION;this.crossOrigin_=void 0!==a.crossOrigin?a.crossOrigin:null;var b=void 0!==a.img?a.img:null,c=void 0!==a.imgSize?a.imgSize:
null,d=a.src;ol.asserts.assert(!(void 0!==d&&b),4);ol.asserts.assert(!b||b&&c,5);void 0!==d&&0!==d.length||!b||(d=b.src||ol.getUid(b).toString());ol.asserts.assert(void 0!==d&&0<d.length,6);var e=void 0!==a.src?ol.ImageState.IDLE:ol.ImageState.LOADED;this.color_=void 0!==a.color?ol.color.asArray(a.color):null;this.iconImage_=ol.style.IconImage.get(b,d,c,this.crossOrigin_,e,this.color_);this.offset_=void 0!==a.offset?a.offset:[0,0];this.offsetOrigin_=void 0!==a.offsetOrigin?a.offsetOrigin:ol.style.IconOrigin.TOP_LEFT;
this.origin_=null;this.size_=void 0!==a.size?a.size:null;ol.style.Image.call(this,{opacity:void 0!==a.opacity?a.opacity:1,rotation:void 0!==a.rotation?a.rotation:0,scale:void 0!==a.scale?a.scale:1,snapToPixel:void 0!==a.snapToPixel?a.snapToPixel:!0,rotateWithView:void 0!==a.rotateWithView?a.rotateWithView:!1})};ol.inherits(ol.style.Icon,ol.style.Image);
ol.style.Icon.prototype.clone=function(){return new ol.style.Icon({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),snapToPixel:this.getSnapToPixel(),
rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})};
ol.style.Icon.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var a=this.anchor_,b=this.getSize();if(this.anchorXUnits_==ol.style.IconAnchorUnits.FRACTION||this.anchorYUnits_==ol.style.IconAnchorUnits.FRACTION){if(!b)return null;a=this.anchor_.slice();this.anchorXUnits_==ol.style.IconAnchorUnits.FRACTION&&(a[0]*=b[0]);this.anchorYUnits_==ol.style.IconAnchorUnits.FRACTION&&(a[1]*=b[1])}if(this.anchorOrigin_!=ol.style.IconOrigin.TOP_LEFT){if(!b)return null;a===
this.anchor_&&(a=this.anchor_.slice());if(this.anchorOrigin_==ol.style.IconOrigin.TOP_RIGHT||this.anchorOrigin_==ol.style.IconOrigin.BOTTOM_RIGHT)a[0]=-a[0]+b[0];if(this.anchorOrigin_==ol.style.IconOrigin.BOTTOM_LEFT||this.anchorOrigin_==ol.style.IconOrigin.BOTTOM_RIGHT)a[1]=-a[1]+b[1]}return this.normalizedAnchor_=a};ol.style.Icon.prototype.getColor=function(){return this.color_};ol.style.Icon.prototype.getImage=function(a){return this.iconImage_.getImage(a)};
ol.style.Icon.prototype.getImageSize=function(){return this.iconImage_.getSize()};ol.style.Icon.prototype.getHitDetectionImageSize=function(){return this.getImageSize()};ol.style.Icon.prototype.getImageState=function(){return this.iconImage_.getImageState()};ol.style.Icon.prototype.getHitDetectionImage=function(a){return this.iconImage_.getHitDetectionImage(a)};
ol.style.Icon.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var a=this.offset_;if(this.offsetOrigin_!=ol.style.IconOrigin.TOP_LEFT){var b=this.getSize(),c=this.iconImage_.getSize();if(!b||!c)return null;a=a.slice();if(this.offsetOrigin_==ol.style.IconOrigin.TOP_RIGHT||this.offsetOrigin_==ol.style.IconOrigin.BOTTOM_RIGHT)a[0]=c[0]-b[0]-a[0];if(this.offsetOrigin_==ol.style.IconOrigin.BOTTOM_LEFT||this.offsetOrigin_==ol.style.IconOrigin.BOTTOM_RIGHT)a[1]=c[1]-b[1]-a[1]}return this.origin_=
a};ol.style.Icon.prototype.getSrc=function(){return this.iconImage_.getSrc()};ol.style.Icon.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()};ol.style.Icon.prototype.listenImageChange=function(a,b){return ol.events.listen(this.iconImage_,ol.events.EventType.CHANGE,a,b)};ol.style.Icon.prototype.load=function(){this.iconImage_.load()};ol.style.Icon.prototype.unlistenImageChange=function(a,b){ol.events.unlisten(this.iconImage_,ol.events.EventType.CHANGE,a,b)};ol.layer.Vector=function(a){a=a?a:{};var b=ol.obj.assign({},a);delete b.style;delete b.renderBuffer;delete b.updateWhileAnimating;delete b.updateWhileInteracting;ol.layer.Layer.call(this,b);this.declutter_=void 0!==a.declutter?a.declutter:!1;this.renderBuffer_=void 0!==a.renderBuffer?a.renderBuffer:100;this.style_=null;this.styleFunction_=void 0;this.setStyle(a.style);this.updateWhileAnimating_=void 0!==a.updateWhileAnimating?a.updateWhileAnimating:!1;this.updateWhileInteracting_=void 0!==a.updateWhileInteracting?
a.updateWhileInteracting:!1;this.type=ol.LayerType.VECTOR};ol.inherits(ol.layer.Vector,ol.layer.Layer);ol.layer.Vector.prototype.getDeclutter=function(){return this.declutter_};ol.layer.Vector.prototype.setDeclutter=function(a){this.declutter_=a};ol.layer.Vector.prototype.getRenderBuffer=function(){return this.renderBuffer_};ol.layer.Vector.prototype.getRenderOrder=function(){return this.get(ol.layer.Vector.Property_.RENDER_ORDER)};ol.layer.Vector.prototype.getStyle=function(){return this.style_};
ol.layer.Vector.prototype.getStyleFunction=function(){return this.styleFunction_};ol.layer.Vector.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_};ol.layer.Vector.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_};ol.layer.Vector.prototype.setRenderOrder=function(a){this.set(ol.layer.Vector.Property_.RENDER_ORDER,a)};
ol.layer.Vector.prototype.setStyle=function(a){this.style_=void 0!==a?a:ol.style.Style.defaultFunction;this.styleFunction_=null===a?void 0:ol.style.Style.createFunction(this.style_);this.changed()};ol.layer.Vector.Property_={RENDER_ORDER:"renderOrder"};ol.layer.VectorTileRenderType={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"};ol.layer.VectorTile=function(a){a=a?a:{};var b=ol.obj.assign({},a);delete b.preload;delete b.useInterimTilesOnError;ol.layer.Vector.call(this,b);this.setPreload(a.preload?a.preload:0);this.setUseInterimTilesOnError(a.useInterimTilesOnError?a.useInterimTilesOnError:!0);b=a.renderMode;ol.asserts.assert(void 0==b||b==ol.layer.VectorTileRenderType.IMAGE||b==ol.layer.VectorTileRenderType.HYBRID||b==ol.layer.VectorTileRenderType.VECTOR,28);a.declutter&&b==ol.layer.VectorTileRenderType.IMAGE&&(b=ol.layer.VectorTileRenderType.HYBRID);
this.renderMode_=b||ol.layer.VectorTileRenderType.HYBRID;this.type=ol.LayerType.VECTOR_TILE};ol.inherits(ol.layer.VectorTile,ol.layer.Vector);ol.layer.VectorTile.prototype.getPreload=function(){return this.get(ol.layer.TileProperty.PRELOAD)};ol.layer.VectorTile.prototype.getRenderMode=function(){return this.renderMode_};ol.layer.VectorTile.prototype.getUseInterimTilesOnError=function(){return this.get(ol.layer.TileProperty.USE_INTERIM_TILES_ON_ERROR)};
ol.layer.VectorTile.prototype.setPreload=function(a){this.set(ol.layer.TileProperty.PRELOAD,a)};ol.layer.VectorTile.prototype.setUseInterimTilesOnError=function(a){this.set(ol.layer.TileProperty.USE_INTERIM_TILES_ON_ERROR,a)};ol.CollectionEventType={ADD:"add",REMOVE:"remove"};ol.Collection=function(a,b){ol.Object.call(this);this.unique_=!!(b||{}).unique;this.array_=a?a:[];if(this.unique_)for(a=0,b=this.array_.length;a<b;++a)this.assertUnique_(this.array_[a],a);this.updateLength_()};ol.inherits(ol.Collection,ol.Object);ol.Collection.prototype.clear=function(){for(;0<this.getLength();)this.pop()};ol.Collection.prototype.extend=function(a){var b;var c=0;for(b=a.length;c<b;++c)this.push(a[c]);return this};
ol.Collection.prototype.forEach=function(a,b){a=b?a.bind(b):a;b=this.array_;for(var c=0,d=b.length;c<d;++c)a(b[c],c,b)};ol.Collection.prototype.getArray=function(){return this.array_};ol.Collection.prototype.item=function(a){return this.array_[a]};ol.Collection.prototype.getLength=function(){return this.get(ol.Collection.Property_.LENGTH)};
ol.Collection.prototype.insertAt=function(a,b){this.unique_&&this.assertUnique_(b);this.array_.splice(a,0,b);this.updateLength_();this.dispatchEvent(new ol.Collection.Event(ol.CollectionEventType.ADD,b))};ol.Collection.prototype.pop=function(){return this.removeAt(this.getLength()-1)};ol.Collection.prototype.push=function(a){this.unique_&&this.assertUnique_(a);var b=this.getLength();this.insertAt(b,a);return this.getLength()};
ol.Collection.prototype.remove=function(a){var b=this.array_,c;var d=0;for(c=b.length;d<c;++d)if(b[d]===a)return this.removeAt(d)};ol.Collection.prototype.removeAt=function(a){var b=this.array_[a];this.array_.splice(a,1);this.updateLength_();this.dispatchEvent(new ol.Collection.Event(ol.CollectionEventType.REMOVE,b));return b};
ol.Collection.prototype.setAt=function(a,b){var c=this.getLength();if(a<c)this.unique_&&this.assertUnique_(b,a),c=this.array_[a],this.array_[a]=b,this.dispatchEvent(new ol.Collection.Event(ol.CollectionEventType.REMOVE,c)),this.dispatchEvent(new ol.Collection.Event(ol.CollectionEventType.ADD,b));else{for(;c<a;++c)this.insertAt(c,void 0);this.insertAt(a,b)}};ol.Collection.prototype.updateLength_=function(){this.set(ol.Collection.Property_.LENGTH,this.array_.length)};
ol.Collection.prototype.assertUnique_=function(a,b){for(var c=0,d=this.array_.length;c<d;++c)if(this.array_[c]===a&&c!==b)throw new ol.AssertionError(58);};ol.Collection.Property_={LENGTH:"length"};ol.Collection.Event=function(a,b){ol.events.Event.call(this,a);this.element=b};ol.inherits(ol.Collection.Event,ol.events.Event);ol.MapEvent=function(a,b,c){ol.events.Event.call(this,a);this.map=b;this.frameState=void 0!==c?c:null};ol.inherits(ol.MapEvent,ol.events.Event);ol.MapBrowserEvent=function(a,b,c,d,e){ol.MapEvent.call(this,a,b,e);this.originalEvent=c;this.pixel=b.getEventPixel(c);this.coordinate=b.getCoordinateFromPixel(this.pixel);this.dragging=void 0!==d?d:!1};ol.inherits(ol.MapBrowserEvent,ol.MapEvent);ol.MapBrowserEvent.prototype.preventDefault=function(){ol.MapEvent.prototype.preventDefault.call(this);this.originalEvent.preventDefault()};ol.MapBrowserEvent.prototype.stopPropagation=function(){ol.MapEvent.prototype.stopPropagation.call(this);this.originalEvent.stopPropagation()};ol.MapBrowserEventType={SINGLECLICK:"singleclick",CLICK:ol.events.EventType.CLICK,DBLCLICK:ol.events.EventType.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};ol.MapBrowserPointerEvent=function(a,b,c,d,e){ol.MapBrowserEvent.call(this,a,b,c.originalEvent,d,e);this.pointerEvent=c};ol.inherits(ol.MapBrowserPointerEvent,ol.MapBrowserEvent);ol.pointer={};ol.pointer.EventType={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};ol.pointer.EventSource=function(a,b){this.dispatcher=a;this.mapping_=b};ol.pointer.EventSource.prototype.getEvents=function(){return Object.keys(this.mapping_)};ol.pointer.EventSource.prototype.getHandlerForEvent=function(a){return this.mapping_[a]};ol.pointer.MouseSource=function(a){ol.pointer.EventSource.call(this,a,{mousedown:this.mousedown,mousemove:this.mousemove,mouseup:this.mouseup,mouseover:this.mouseover,mouseout:this.mouseout});this.pointerMap=a.pointerMap;this.lastTouches=[]};ol.inherits(ol.pointer.MouseSource,ol.pointer.EventSource);ol.pointer.MouseSource.POINTER_ID=1;ol.pointer.MouseSource.POINTER_TYPE="mouse";ol.pointer.MouseSource.DEDUP_DIST=25;
ol.pointer.MouseSource.prototype.isEventSimulatedFromTouch_=function(a){var b=this.lastTouches,c=a.clientX;a=a.clientY;for(var d=0,e=b.length,f;d<e&&(f=b[d]);d++){var g=Math.abs(a-f[1]);if(Math.abs(c-f[0])<=ol.pointer.MouseSource.DEDUP_DIST&&g<=ol.pointer.MouseSource.DEDUP_DIST)return!0}return!1};
ol.pointer.MouseSource.prepareEvent=function(a,b){b=b.cloneEvent(a,a);var c=b.preventDefault;b.preventDefault=function(){a.preventDefault();c()};b.pointerId=ol.pointer.MouseSource.POINTER_ID;b.isPrimary=!0;b.pointerType=ol.pointer.MouseSource.POINTER_TYPE;return b};
ol.pointer.MouseSource.prototype.mousedown=function(a){if(!this.isEventSimulatedFromTouch_(a)){ol.pointer.MouseSource.POINTER_ID.toString()in this.pointerMap&&this.cancel(a);var b=ol.pointer.MouseSource.prepareEvent(a,this.dispatcher);this.pointerMap[ol.pointer.MouseSource.POINTER_ID.toString()]=a;this.dispatcher.down(b,a)}};
ol.pointer.MouseSource.prototype.mousemove=function(a){if(!this.isEventSimulatedFromTouch_(a)){var b=ol.pointer.MouseSource.prepareEvent(a,this.dispatcher);this.dispatcher.move(b,a)}};ol.pointer.MouseSource.prototype.mouseup=function(a){if(!this.isEventSimulatedFromTouch_(a)){var b=this.pointerMap[ol.pointer.MouseSource.POINTER_ID.toString()];b&&b.button===a.button&&(b=ol.pointer.MouseSource.prepareEvent(a,this.dispatcher),this.dispatcher.up(b,a),this.cleanupMouse())}};
ol.pointer.MouseSource.prototype.mouseover=function(a){if(!this.isEventSimulatedFromTouch_(a)){var b=ol.pointer.MouseSource.prepareEvent(a,this.dispatcher);this.dispatcher.enterOver(b,a)}};ol.pointer.MouseSource.prototype.mouseout=function(a){if(!this.isEventSimulatedFromTouch_(a)){var b=ol.pointer.MouseSource.prepareEvent(a,this.dispatcher);this.dispatcher.leaveOut(b,a)}};
ol.pointer.MouseSource.prototype.cancel=function(a){var b=ol.pointer.MouseSource.prepareEvent(a,this.dispatcher);this.dispatcher.cancel(b,a);this.cleanupMouse()};ol.pointer.MouseSource.prototype.cleanupMouse=function(){delete this.pointerMap[ol.pointer.MouseSource.POINTER_ID.toString()]};ol.pointer.MsSource=function(a){ol.pointer.EventSource.call(this,a,{MSPointerDown:this.msPointerDown,MSPointerMove:this.msPointerMove,MSPointerUp:this.msPointerUp,MSPointerOut:this.msPointerOut,MSPointerOver:this.msPointerOver,MSPointerCancel:this.msPointerCancel,MSGotPointerCapture:this.msGotPointerCapture,MSLostPointerCapture:this.msLostPointerCapture});this.pointerMap=a.pointerMap;this.POINTER_TYPES=["","unavailable","touch","pen","mouse"]};ol.inherits(ol.pointer.MsSource,ol.pointer.EventSource);
ol.pointer.MsSource.prototype.prepareEvent_=function(a){var b=a;"number"===typeof a.pointerType&&(b=this.dispatcher.cloneEvent(a,a),b.pointerType=this.POINTER_TYPES[a.pointerType]);return b};ol.pointer.MsSource.prototype.cleanup=function(a){delete this.pointerMap[a.toString()]};ol.pointer.MsSource.prototype.msPointerDown=function(a){this.pointerMap[a.pointerId.toString()]=a;var b=this.prepareEvent_(a);this.dispatcher.down(b,a)};
ol.pointer.MsSource.prototype.msPointerMove=function(a){var b=this.prepareEvent_(a);this.dispatcher.move(b,a)};ol.pointer.MsSource.prototype.msPointerUp=function(a){var b=this.prepareEvent_(a);this.dispatcher.up(b,a);this.cleanup(a.pointerId)};ol.pointer.MsSource.prototype.msPointerOut=function(a){var b=this.prepareEvent_(a);this.dispatcher.leaveOut(b,a)};ol.pointer.MsSource.prototype.msPointerOver=function(a){var b=this.prepareEvent_(a);this.dispatcher.enterOver(b,a)};
ol.pointer.MsSource.prototype.msPointerCancel=function(a){var b=this.prepareEvent_(a);this.dispatcher.cancel(b,a);this.cleanup(a.pointerId)};ol.pointer.MsSource.prototype.msLostPointerCapture=function(a){a=this.dispatcher.makeEvent("lostpointercapture",a,a);this.dispatcher.dispatchEvent(a)};ol.pointer.MsSource.prototype.msGotPointerCapture=function(a){a=this.dispatcher.makeEvent("gotpointercapture",a,a);this.dispatcher.dispatchEvent(a)};ol.pointer.NativeSource=function(a){ol.pointer.EventSource.call(this,a,{pointerdown:this.pointerDown,pointermove:this.pointerMove,pointerup:this.pointerUp,pointerout:this.pointerOut,pointerover:this.pointerOver,pointercancel:this.pointerCancel,gotpointercapture:this.gotPointerCapture,lostpointercapture:this.lostPointerCapture})};ol.inherits(ol.pointer.NativeSource,ol.pointer.EventSource);ol.pointer.NativeSource.prototype.pointerDown=function(a){this.dispatcher.fireNativeEvent(a)};
ol.pointer.NativeSource.prototype.pointerMove=function(a){this.dispatcher.fireNativeEvent(a)};ol.pointer.NativeSource.prototype.pointerUp=function(a){this.dispatcher.fireNativeEvent(a)};ol.pointer.NativeSource.prototype.pointerOut=function(a){this.dispatcher.fireNativeEvent(a)};ol.pointer.NativeSource.prototype.pointerOver=function(a){this.dispatcher.fireNativeEvent(a)};ol.pointer.NativeSource.prototype.pointerCancel=function(a){this.dispatcher.fireNativeEvent(a)};
ol.pointer.NativeSource.prototype.lostPointerCapture=function(a){this.dispatcher.fireNativeEvent(a)};ol.pointer.NativeSource.prototype.gotPointerCapture=function(a){this.dispatcher.fireNativeEvent(a)};ol.pointer.PointerEvent=function(a,b,c){ol.events.Event.call(this,a);this.originalEvent=b;a=c?c:{};this.buttons=this.getButtons_(a);this.pressure=this.getPressure_(a,this.buttons);this.bubbles="bubbles"in a?a.bubbles:!1;this.cancelable="cancelable"in a?a.cancelable:!1;this.view="view"in a?a.view:null;this.detail="detail"in a?a.detail:null;this.screenX="screenX"in a?a.screenX:0;this.screenY="screenY"in a?a.screenY:0;this.clientX="clientX"in a?a.clientX:0;this.clientY="clientY"in a?a.clientY:0;this.ctrlKey=
"ctrlKey"in a?a.ctrlKey:!1;this.altKey="altKey"in a?a.altKey:!1;this.shiftKey="shiftKey"in a?a.shiftKey:!1;this.metaKey="metaKey"in a?a.metaKey:!1;this.button="button"in a?a.button:0;this.relatedTarget="relatedTarget"in a?a.relatedTarget:null;this.pointerId="pointerId"in a?a.pointerId:0;this.width="width"in a?a.width:0;this.height="height"in a?a.height:0;this.tiltX="tiltX"in a?a.tiltX:0;this.tiltY="tiltY"in a?a.tiltY:0;this.pointerType="pointerType"in a?a.pointerType:"";this.hwTimestamp="hwTimestamp"in
a?a.hwTimestamp:0;this.isPrimary="isPrimary"in a?a.isPrimary:!1;b.preventDefault&&(this.preventDefault=function(){b.preventDefault()})};ol.inherits(ol.pointer.PointerEvent,ol.events.Event);ol.pointer.PointerEvent.prototype.getButtons_=function(a){if(a.buttons||ol.pointer.PointerEvent.HAS_BUTTONS)a=a.buttons;else switch(a.which){case 1:a=1;break;case 2:a=4;break;case 3:a=2;break;default:a=0}return a};ol.pointer.PointerEvent.prototype.getPressure_=function(a,b){return a.pressure?a.pressure:b?.5:0};
ol.pointer.PointerEvent.HAS_BUTTONS=!1;(function(){try{var a=new MouseEvent("click",{buttons:1});ol.pointer.PointerEvent.HAS_BUTTONS=1===a.buttons}catch(b){}})();ol.pointer.TouchSource=function(a,b){ol.pointer.EventSource.call(this,a,{touchstart:this.touchstart,touchmove:this.touchmove,touchend:this.touchend,touchcancel:this.touchcancel});this.pointerMap=a.pointerMap;this.mouseSource=b;this.firstTouchId_=void 0;this.clickCount_=0;this.resetId_=void 0};ol.inherits(ol.pointer.TouchSource,ol.pointer.EventSource);ol.pointer.TouchSource.DEDUP_TIMEOUT=2500;ol.pointer.TouchSource.CLICK_COUNT_TIMEOUT=200;ol.pointer.TouchSource.POINTER_TYPE="touch";
ol.pointer.TouchSource.prototype.isPrimaryTouch_=function(a){return this.firstTouchId_===a.identifier};ol.pointer.TouchSource.prototype.setPrimaryTouch_=function(a){var b=Object.keys(this.pointerMap).length;if(0===b||1===b&&ol.pointer.MouseSource.POINTER_ID.toString()in this.pointerMap)this.firstTouchId_=a.identifier,this.cancelResetClickCount_()};ol.pointer.TouchSource.prototype.removePrimaryPointer_=function(a){a.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())};
ol.pointer.TouchSource.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),ol.pointer.TouchSource.CLICK_COUNT_TIMEOUT)};ol.pointer.TouchSource.prototype.resetClickCountHandler_=function(){this.clickCount_=0;this.resetId_=void 0};ol.pointer.TouchSource.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)};
ol.pointer.TouchSource.prototype.touchToPointer_=function(a,b){a=this.dispatcher.cloneEvent(a,b);a.pointerId=b.identifier+2;a.bubbles=!0;a.cancelable=!0;a.detail=this.clickCount_;a.button=0;a.buttons=1;a.width=b.webkitRadiusX||b.radiusX||0;a.height=b.webkitRadiusY||b.radiusY||0;a.pressure=b.webkitForce||b.force||.5;a.isPrimary=this.isPrimaryTouch_(b);a.pointerType=ol.pointer.TouchSource.POINTER_TYPE;a.clientX=b.clientX;a.clientY=b.clientY;a.screenX=b.screenX;a.screenY=b.screenY;return a};
ol.pointer.TouchSource.prototype.processTouches_=function(a,b){function c(){a.preventDefault()}var d=Array.prototype.slice.call(a.changedTouches),e=d.length,f;for(f=0;f<e;++f){var g=this.touchToPointer_(a,d[f]);g.preventDefault=c;b.call(this,a,g)}};ol.pointer.TouchSource.prototype.findTouch_=function(a,b){for(var c=a.length,d,e=0;e<c;e++)if(d=a[e],d.identifier===b)return!0;return!1};
ol.pointer.TouchSource.prototype.vacuumTouches_=function(a){var b=a.touches,c=Object.keys(this.pointerMap),d=c.length;if(d>=b.length){var e=[],f;for(f=0;f<d;++f){var g=c[f];var h=this.pointerMap[g];g==ol.pointer.MouseSource.POINTER_ID||this.findTouch_(b,g-2)||e.push(h.out)}for(f=0;f<e.length;++f)this.cancelOut_(a,e[f])}};
ol.pointer.TouchSource.prototype.touchstart=function(a){this.vacuumTouches_(a);this.setPrimaryTouch_(a.changedTouches[0]);this.dedupSynthMouse_(a);this.clickCount_++;this.processTouches_(a,this.overDown_)};ol.pointer.TouchSource.prototype.overDown_=function(a,b){this.pointerMap[b.pointerId]={target:b.target,out:b,outTarget:b.target};this.dispatcher.over(b,a);this.dispatcher.enter(b,a);this.dispatcher.down(b,a)};
ol.pointer.TouchSource.prototype.touchmove=function(a){a.preventDefault();this.processTouches_(a,this.moveOverOut_)};ol.pointer.TouchSource.prototype.moveOverOut_=function(a,b){var c=this.pointerMap[b.pointerId];if(c){var d=c.out,e=c.outTarget;this.dispatcher.move(b,a);d&&e!==b.target&&(d.relatedTarget=b.target,b.relatedTarget=e,d.target=e,b.target?(this.dispatcher.leaveOut(d,a),this.dispatcher.enterOver(b,a)):(b.target=e,b.relatedTarget=null,this.cancelOut_(a,b)));c.out=b;c.outTarget=b.target}};
ol.pointer.TouchSource.prototype.touchend=function(a){this.dedupSynthMouse_(a);this.processTouches_(a,this.upOut_)};ol.pointer.TouchSource.prototype.upOut_=function(a,b){this.dispatcher.up(b,a);this.dispatcher.out(b,a);this.dispatcher.leave(b,a);this.cleanUpPointer_(b)};ol.pointer.TouchSource.prototype.touchcancel=function(a){this.processTouches_(a,this.cancelOut_)};
ol.pointer.TouchSource.prototype.cancelOut_=function(a,b){this.dispatcher.cancel(b,a);this.dispatcher.out(b,a);this.dispatcher.leave(b,a);this.cleanUpPointer_(b)};ol.pointer.TouchSource.prototype.cleanUpPointer_=function(a){delete this.pointerMap[a.pointerId];this.removePrimaryPointer_(a)};
ol.pointer.TouchSource.prototype.dedupSynthMouse_=function(a){var b=this.mouseSource.lastTouches;a=a.changedTouches[0];if(this.isPrimaryTouch_(a)){var c=[a.clientX,a.clientY];b.push(c);setTimeout(function(){ol.array.remove(b,c)},ol.pointer.TouchSource.DEDUP_TIMEOUT)}};ol.pointer.PointerEventHandler=function(a){ol.events.EventTarget.call(this);this.element_=a;this.pointerMap={};this.eventMap_={};this.eventSourceList_=[];this.registerSources()};ol.inherits(ol.pointer.PointerEventHandler,ol.events.EventTarget);
ol.pointer.PointerEventHandler.prototype.registerSources=function(){if(ol.has.POINTER)this.registerSource("native",new ol.pointer.NativeSource(this));else if(ol.has.MSPOINTER)this.registerSource("ms",new ol.pointer.MsSource(this));else{var a=new ol.pointer.MouseSource(this);this.registerSource("mouse",a);ol.has.TOUCH&&this.registerSource("touch",new ol.pointer.TouchSource(this,a))}this.register_()};
ol.pointer.PointerEventHandler.prototype.registerSource=function(a,b){if(a=b.getEvents())a.forEach(function(a){var c=b.getHandlerForEvent(a);c&&(this.eventMap_[a]=c.bind(b))},this),this.eventSourceList_.push(b)};ol.pointer.PointerEventHandler.prototype.register_=function(){for(var a=this.eventSourceList_.length,b,c=0;c<a;c++)b=this.eventSourceList_[c],this.addEvents_(b.getEvents())};
ol.pointer.PointerEventHandler.prototype.unregister_=function(){for(var a=this.eventSourceList_.length,b,c=0;c<a;c++)b=this.eventSourceList_[c],this.removeEvents_(b.getEvents())};ol.pointer.PointerEventHandler.prototype.eventHandler_=function(a){var b=this.eventMap_[a.type];b&&b(a)};ol.pointer.PointerEventHandler.prototype.addEvents_=function(a){a.forEach(function(a){ol.events.listen(this.element_,a,this.eventHandler_,this)},this)};
ol.pointer.PointerEventHandler.prototype.removeEvents_=function(a){a.forEach(function(a){ol.events.unlisten(this.element_,a,this.eventHandler_,this)},this)};ol.pointer.PointerEventHandler.prototype.cloneEvent=function(a,b){for(var c={},d,e=0,f=ol.pointer.PointerEventHandler.CLONE_PROPS.length;e<f;e++)d=ol.pointer.PointerEventHandler.CLONE_PROPS[e][0],c[d]=a[d]||b[d]||ol.pointer.PointerEventHandler.CLONE_PROPS[e][1];return c};
ol.pointer.PointerEventHandler.prototype.down=function(a,b){this.fireEvent(ol.pointer.EventType.POINTERDOWN,a,b)};ol.pointer.PointerEventHandler.prototype.move=function(a,b){this.fireEvent(ol.pointer.EventType.POINTERMOVE,a,b)};ol.pointer.PointerEventHandler.prototype.up=function(a,b){this.fireEvent(ol.pointer.EventType.POINTERUP,a,b)};ol.pointer.PointerEventHandler.prototype.enter=function(a,b){a.bubbles=!1;this.fireEvent(ol.pointer.EventType.POINTERENTER,a,b)};
ol.pointer.PointerEventHandler.prototype.leave=function(a,b){a.bubbles=!1;this.fireEvent(ol.pointer.EventType.POINTERLEAVE,a,b)};ol.pointer.PointerEventHandler.prototype.over=function(a,b){a.bubbles=!0;this.fireEvent(ol.pointer.EventType.POINTEROVER,a,b)};ol.pointer.PointerEventHandler.prototype.out=function(a,b){a.bubbles=!0;this.fireEvent(ol.pointer.EventType.POINTEROUT,a,b)};ol.pointer.PointerEventHandler.prototype.cancel=function(a,b){this.fireEvent(ol.pointer.EventType.POINTERCANCEL,a,b)};
ol.pointer.PointerEventHandler.prototype.leaveOut=function(a,b){this.out(a,b);this.contains_(a.target,a.relatedTarget)||this.leave(a,b)};ol.pointer.PointerEventHandler.prototype.enterOver=function(a,b){this.over(a,b);this.contains_(a.target,a.relatedTarget)||this.enter(a,b)};ol.pointer.PointerEventHandler.prototype.contains_=function(a,b){return a&&b?a.contains(b):!1};ol.pointer.PointerEventHandler.prototype.makeEvent=function(a,b,c){return new ol.pointer.PointerEvent(a,c,b)};
ol.pointer.PointerEventHandler.prototype.fireEvent=function(a,b,c){a=this.makeEvent(a,b,c);this.dispatchEvent(a)};ol.pointer.PointerEventHandler.prototype.fireNativeEvent=function(a){a=this.makeEvent(a.type,a,a);this.dispatchEvent(a)};ol.pointer.PointerEventHandler.prototype.wrapMouseEvent=function(a,b){return this.makeEvent(a,ol.pointer.MouseSource.prepareEvent(b,this),b)};ol.pointer.PointerEventHandler.prototype.disposeInternal=function(){this.unregister_();ol.events.EventTarget.prototype.disposeInternal.call(this)};
ol.pointer.PointerEventHandler.CLONE_PROPS=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]];ol.MapBrowserEventHandler=function(a,b){ol.events.EventTarget.call(this);this.map_=a;this.clickTimeoutId_=0;this.dragging_=!1;this.dragListenerKeys_=[];this.moveTolerance_=b?b*ol.has.DEVICE_PIXEL_RATIO:ol.has.DEVICE_PIXEL_RATIO;this.down_=null;a=this.map_.getViewport();this.activePointers_=0;this.trackedTouches_={};this.pointerEventHandler_=new ol.pointer.PointerEventHandler(a);this.documentPointerEventHandler_=null;this.pointerdownListenerKey_=ol.events.listen(this.pointerEventHandler_,ol.pointer.EventType.POINTERDOWN,
this.handlePointerDown_,this);this.relayedListenerKey_=ol.events.listen(this.pointerEventHandler_,ol.pointer.EventType.POINTERMOVE,this.relayEvent_,this)};ol.inherits(ol.MapBrowserEventHandler,ol.events.EventTarget);
ol.MapBrowserEventHandler.prototype.emulateClick_=function(a){var b=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.CLICK,this.map_,a);this.dispatchEvent(b);0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0,b=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.DBLCLICK,this.map_,a),this.dispatchEvent(b)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;var b=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.SINGLECLICK,this.map_,a);this.dispatchEvent(b)}.bind(this),
250)};ol.MapBrowserEventHandler.prototype.updateActivePointers_=function(a){a.type==ol.MapBrowserEventType.POINTERUP||a.type==ol.MapBrowserEventType.POINTERCANCEL?delete this.trackedTouches_[a.pointerId]:a.type==ol.MapBrowserEventType.POINTERDOWN&&(this.trackedTouches_[a.pointerId]=!0);this.activePointers_=Object.keys(this.trackedTouches_).length};
ol.MapBrowserEventHandler.prototype.handlePointerUp_=function(a){this.updateActivePointers_(a);var b=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.POINTERUP,this.map_,a);this.dispatchEvent(b);!this.dragging_&&this.isMouseActionButton_(a)&&this.emulateClick_(this.down_);0===this.activePointers_&&(this.dragListenerKeys_.forEach(ol.events.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=
null)};ol.MapBrowserEventHandler.prototype.isMouseActionButton_=function(a){return 0===a.button};
ol.MapBrowserEventHandler.prototype.handlePointerDown_=function(a){this.updateActivePointers_(a);var b=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.POINTERDOWN,this.map_,a);this.dispatchEvent(b);this.down_=a;0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new ol.pointer.PointerEventHandler(document),this.dragListenerKeys_.push(ol.events.listen(this.documentPointerEventHandler_,ol.MapBrowserEventType.POINTERMOVE,this.handlePointerMove_,this),ol.events.listen(this.documentPointerEventHandler_,
ol.MapBrowserEventType.POINTERUP,this.handlePointerUp_,this),ol.events.listen(this.pointerEventHandler_,ol.MapBrowserEventType.POINTERCANCEL,this.handlePointerUp_,this)))};ol.MapBrowserEventHandler.prototype.handlePointerMove_=function(a){if(this.isMoving_(a)){this.dragging_=!0;var b=new ol.MapBrowserPointerEvent(ol.MapBrowserEventType.POINTERDRAG,this.map_,a,this.dragging_);this.dispatchEvent(b)}a.preventDefault()};
ol.MapBrowserEventHandler.prototype.relayEvent_=function(a){var b=!(!this.down_||!this.isMoving_(a));this.dispatchEvent(new ol.MapBrowserPointerEvent(a.type,this.map_,a,b))};ol.MapBrowserEventHandler.prototype.isMoving_=function(a){return Math.abs(a.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(a.clientY-this.down_.clientY)>this.moveTolerance_};
ol.MapBrowserEventHandler.prototype.disposeInternal=function(){this.relayedListenerKey_&&(ol.events.unlistenByKey(this.relayedListenerKey_),this.relayedListenerKey_=null);this.pointerdownListenerKey_&&(ol.events.unlistenByKey(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null);this.dragListenerKeys_.forEach(ol.events.unlistenByKey);this.dragListenerKeys_.length=0;this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null);this.pointerEventHandler_&&
(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null);ol.events.EventTarget.prototype.disposeInternal.call(this)};ol.MapProperty={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};ol.CenterConstraint={};ol.CenterConstraint.createExtent=function(a){return function(b){if(b)return[ol.math.clamp(b[0],a[0],a[2]),ol.math.clamp(b[1],a[1],a[3])]}};ol.CenterConstraint.none=function(a){return a};ol.ResolutionConstraint={};ol.ResolutionConstraint.createSnapToResolutions=function(a){return function(b,c,d){if(void 0!==b)return b=ol.array.linearFindNearest(a,b,d),b=ol.math.clamp(b+c,0,a.length-1),c=Math.floor(b),b!=c&&c<a.length-1?a[c]/Math.pow(a[c]/a[c+1],b-c):a[c]}};ol.ResolutionConstraint.createSnapToPower=function(a,b,c){return function(d,e,f){if(void 0!==d)return d=Math.max(Math.floor(Math.log(b/d)/Math.log(a)+(-f/2+.5))+e,0),void 0!==c&&(d=Math.min(d,c)),b/Math.pow(a,d)}};ol.RotationConstraint={};ol.RotationConstraint.disable=function(a,b){if(void 0!==a)return 0};ol.RotationConstraint.none=function(a,b){if(void 0!==a)return a+b};ol.RotationConstraint.createSnapToN=function(a){var b=2*Math.PI/a;return function(a,d){if(void 0!==a)return a=Math.floor((a+d)/b+.5)*b}};ol.RotationConstraint.createSnapToZero=function(a){var b=a||ol.math.toRadians(5);return function(a,d){if(void 0!==a)return Math.abs(a+d)<=b?0:a+d}};ol.ViewProperty={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};ol.geom.flat.area={};ol.geom.flat.area.linearRing=function(a,b,c,d){for(var e=0,f=a[c-d],g=a[c-d+1];b<c;b+=d){var h=a[b],k=a[b+1];e+=g*h-f*k;f=h;g=k}return e/2};ol.geom.flat.area.linearRings=function(a,b,c,d){var e=0,f;var g=0;for(f=c.length;g<f;++g){var h=c[g];e+=ol.geom.flat.area.linearRing(a,b,h,d);b=h}return e};ol.geom.flat.area.linearRingss=function(a,b,c,d){var e=0,f;var g=0;for(f=c.length;g<f;++g){var h=c[g];e+=ol.geom.flat.area.linearRings(a,b,h,d);b=h[h.length-1]}return e};ol.geom.LinearRing=function(a,b){ol.geom.SimpleGeometry.call(this);this.maxDeltaRevision_=this.maxDelta_=-1;this.setCoordinates(a,b)};ol.inherits(ol.geom.LinearRing,ol.geom.SimpleGeometry);ol.geom.LinearRing.prototype.clone=function(){var a=new ol.geom.LinearRing(null);a.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return a};
ol.geom.LinearRing.prototype.closestPointXY=function(a,b,c,d){if(d<ol.extent.closestSquaredDistanceXY(this.getExtent(),a,b))return d;this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ol.geom.flat.closest.getMaxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision());return ol.geom.flat.closest.getClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,a,b,c,d)};
ol.geom.LinearRing.prototype.getArea=function(){return ol.geom.flat.area.linearRing(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};ol.geom.LinearRing.prototype.getCoordinates=function(){return ol.geom.flat.inflate.coordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};
ol.geom.LinearRing.prototype.getSimplifiedGeometryInternal=function(a){var b=[];b.length=ol.geom.flat.simplify.douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,b,0);a=new ol.geom.LinearRing(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,b);return a};ol.geom.LinearRing.prototype.getType=function(){return ol.geom.GeometryType.LINEAR_RING};ol.geom.LinearRing.prototype.intersectsExtent=function(a){};
ol.geom.LinearRing.prototype.setCoordinates=function(a,b){a?(this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ol.geom.flat.deflate.coordinates(this.flatCoordinates,0,a,this.stride),this.changed()):this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null)};ol.geom.LinearRing.prototype.setFlatCoordinates=function(a,b){this.setFlatCoordinatesInternal(a,b);this.changed()};ol.geom.Point=function(a,b){ol.geom.SimpleGeometry.call(this);this.setCoordinates(a,b)};ol.inherits(ol.geom.Point,ol.geom.SimpleGeometry);ol.geom.Point.prototype.clone=function(){var a=new ol.geom.Point(null);a.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return a};ol.geom.Point.prototype.closestPointXY=function(a,b,c,d){var e=this.flatCoordinates;a=ol.math.squaredDistance(a,b,e[0],e[1]);if(a<d){d=this.stride;for(b=0;b<d;++b)c[b]=e[b];c.length=d;return a}return d};
ol.geom.Point.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]};ol.geom.Point.prototype.computeExtent=function(a){return ol.extent.createOrUpdateFromCoordinate(this.flatCoordinates,a)};ol.geom.Point.prototype.getType=function(){return ol.geom.GeometryType.POINT};ol.geom.Point.prototype.intersectsExtent=function(a){return ol.extent.containsXY(a,this.flatCoordinates[0],this.flatCoordinates[1])};
ol.geom.Point.prototype.setCoordinates=function(a,b){a?(this.setLayout(b,a,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ol.geom.flat.deflate.coordinate(this.flatCoordinates,0,a,this.stride),this.changed()):this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null)};ol.geom.Point.prototype.setFlatCoordinates=function(a,b){this.setFlatCoordinatesInternal(a,b);this.changed()};ol.geom.flat.interiorpoint={};
ol.geom.flat.interiorpoint.linearRings=function(a,b,c,d,e,f,g){var h,k=e[f+1],l=[],m=c[0];var n=a[m-d];var p=a[m-d+1];for(h=b;h<m;h+=d){var q=a[h];var r=a[h+1];if(k<=p&&r<=k||p<=k&&k<=r)n=(k-p)/(r-p)*(q-n)+n,l.push(n);n=q;p=r}m=NaN;p=-Infinity;l.sort(ol.array.numberSafeCompareFunction);n=l[0];h=1;for(r=l.length;h<r;++h){q=l[h];var u=Math.abs(q-n);u>p&&(n=(n+q)/2,ol.geom.flat.contains.linearRingsContainsXY(a,b,c,d,n,k)&&(m=n,p=u));n=q}isNaN(m)&&(m=e[f]);return g?(g.push(m,k,p),g):[m,k,p]};
ol.geom.flat.interiorpoint.linearRingss=function(a,b,c,d,e){var f=[],g;var h=0;for(g=c.length;h<g;++h){var k=c[h];f=ol.geom.flat.interiorpoint.linearRings(a,b,k,d,e,2*h,f);b=k[k.length-1]}return f};ol.geom.flat.reverse={};ol.geom.flat.reverse.coordinates=function(a,b,c,d){for(;b<c-d;){var e;for(e=0;e<d;++e){var f=a[b+e];a[b+e]=a[c-d+e];a[c-d+e]=f}b+=d;c-=d}};ol.geom.flat.orient={};ol.geom.flat.orient.linearRingIsClockwise=function(a,b,c,d){for(var e=0,f=a[c-d],g=a[c-d+1];b<c;b+=d){var h=a[b],k=a[b+1];e+=(h-f)*(k+g);f=h;g=k}return 0<e};ol.geom.flat.orient.linearRingsAreOriented=function(a,b,c,d,e){e=void 0!==e?e:!1;var f;var g=0;for(f=c.length;g<f;++g){var h=c[g];b=ol.geom.flat.orient.linearRingIsClockwise(a,b,h,d);if(0===g){if(e&&b||!e&&!b)return!1}else if(e&&!b||!e&&b)return!1;b=h}return!0};
ol.geom.flat.orient.linearRingssAreOriented=function(a,b,c,d,e){var f;var g=0;for(f=c.length;g<f;++g)if(!ol.geom.flat.orient.linearRingsAreOriented(a,b,c[g],d,e))return!1;return!0};ol.geom.flat.orient.orientLinearRings=function(a,b,c,d,e){e=void 0!==e?e:!1;var f;var g=0;for(f=c.length;g<f;++g){var h=c[g],k=ol.geom.flat.orient.linearRingIsClockwise(a,b,h,d);(0===g?e&&k||!e&&!k:e&&!k||!e&&k)&&ol.geom.flat.reverse.coordinates(a,b,h,d);b=h}return b};
ol.geom.flat.orient.orientLinearRingss=function(a,b,c,d,e){var f;var g=0;for(f=c.length;g<f;++g)b=ol.geom.flat.orient.orientLinearRings(a,b,c[g],d,e);return b};ol.geom.Polygon=function(a,b){ol.geom.SimpleGeometry.call(this);this.ends_=[];this.flatInteriorPointRevision_=-1;this.flatInteriorPoint_=null;this.orientedRevision_=this.maxDeltaRevision_=this.maxDelta_=-1;this.orientedFlatCoordinates_=null;this.setCoordinates(a,b)};ol.inherits(ol.geom.Polygon,ol.geom.SimpleGeometry);
ol.geom.Polygon.prototype.appendLinearRing=function(a){this.flatCoordinates?ol.array.extend(this.flatCoordinates,a.getFlatCoordinates()):this.flatCoordinates=a.getFlatCoordinates().slice();this.ends_.push(this.flatCoordinates.length);this.changed()};ol.geom.Polygon.prototype.clone=function(){var a=new ol.geom.Polygon(null);a.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice());return a};
ol.geom.Polygon.prototype.closestPointXY=function(a,b,c,d){if(d<ol.extent.closestSquaredDistanceXY(this.getExtent(),a,b))return d;this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ol.geom.flat.closest.getsMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision());return ol.geom.flat.closest.getsClosestPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,a,b,c,d)};
ol.geom.Polygon.prototype.containsXY=function(a,b){return ol.geom.flat.contains.linearRingsContainsXY(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a,b)};ol.geom.Polygon.prototype.getArea=function(){return ol.geom.flat.area.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)};
ol.geom.Polygon.prototype.getCoordinates=function(a){if(void 0!==a){var b=this.getOrientedFlatCoordinates().slice();ol.geom.flat.orient.orientLinearRings(b,0,this.ends_,this.stride,a)}else b=this.flatCoordinates;return ol.geom.flat.inflate.coordinatess(b,0,this.ends_,this.stride)};ol.geom.Polygon.prototype.getEnds=function(){return this.ends_};
ol.geom.Polygon.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var a=ol.extent.getCenter(this.getExtent());this.flatInteriorPoint_=ol.geom.flat.interiorpoint.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a,0);this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_};ol.geom.Polygon.prototype.getInteriorPoint=function(){return new ol.geom.Point(this.getFlatInteriorPoint(),ol.geom.GeometryLayout.XYM)};
ol.geom.Polygon.prototype.getLinearRingCount=function(){return this.ends_.length};ol.geom.Polygon.prototype.getLinearRing=function(a){if(0>a||this.ends_.length<=a)return null;var b=new ol.geom.LinearRing(null);b.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===a?0:this.ends_[a-1],this.ends_[a]));return b};
ol.geom.Polygon.prototype.getLinearRings=function(){var a=this.layout,b=this.flatCoordinates,c=this.ends_,d=[],e=0,f;var g=0;for(f=c.length;g<f;++g){var h=c[g],k=new ol.geom.LinearRing(null);k.setFlatCoordinates(a,b.slice(e,h));d.push(k);e=h}return d};
ol.geom.Polygon.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var a=this.flatCoordinates;ol.geom.flat.orient.linearRingsAreOriented(a,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=a:(this.orientedFlatCoordinates_=a.slice(),this.orientedFlatCoordinates_.length=ol.geom.flat.orient.orientLinearRings(this.orientedFlatCoordinates_,0,this.ends_,this.stride));this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_};
ol.geom.Polygon.prototype.getSimplifiedGeometryInternal=function(a){var b=[],c=[];b.length=ol.geom.flat.simplify.quantizes(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(a),b,0,c);a=new ol.geom.Polygon(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,b,c);return a};ol.geom.Polygon.prototype.getType=function(){return ol.geom.GeometryType.POLYGON};
ol.geom.Polygon.prototype.intersectsExtent=function(a){return ol.geom.flat.intersectsextent.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a)};
ol.geom.Polygon.prototype.setCoordinates=function(a,b){a?(this.setLayout(b,a,2),this.flatCoordinates||(this.flatCoordinates=[]),a=ol.geom.flat.deflate.coordinatess(this.flatCoordinates,0,a,this.stride,this.ends_),this.flatCoordinates.length=0===a.length?0:a[a.length-1],this.changed()):this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null,this.ends_)};ol.geom.Polygon.prototype.setFlatCoordinates=function(a,b,c){this.setFlatCoordinatesInternal(a,b);this.ends_=c;this.changed()};
ol.geom.Polygon.circular=function(a,b,c,d){var e=d?d:32;d=[];var f;for(f=0;f<e;++f)ol.array.extend(d,a.offset(b,c,2*Math.PI*f/e));d.push(d[0],d[1]);a=new ol.geom.Polygon(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,d,[d.length]);return a};ol.geom.Polygon.fromExtent=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];b=[b,c,b,a,d,a,d,c,b,c];c=new ol.geom.Polygon(null);c.setFlatCoordinates(ol.geom.GeometryLayout.XY,b,[b.length]);return c};
ol.geom.Polygon.fromCircle=function(a,b,c){var d=b?b:32,e=a.getStride();b=a.getLayout();var f=new ol.geom.Polygon(null,b);d=e*(d+1);e=Array(d);for(var g=0;g<d;g++)e[g]=0;f.setFlatCoordinates(b,e,[e.length]);ol.geom.Polygon.makeRegular(f,a.getCenter(),a.getRadius(),c);return f};
ol.geom.Polygon.makeRegular=function(a,b,c,d){var e=a.getFlatCoordinates(),f=a.getLayout(),g=a.getStride(),h=a.getEnds(),k=e.length/g-1;d=d?d:0;for(var l,m,n=0;n<=k;++n)m=n*g,l=d+2*ol.math.modulo(n,k)*Math.PI/k,e[m]=b[0]+c*Math.cos(l),e[m+1]=b[1]+c*Math.sin(l);a.setFlatCoordinates(f,e,h)};ol.View=function(a){ol.Object.call(this);a=ol.obj.assign({},a);this.hints_=[0,0];this.animations_=[];this.updateAnimations_=this.updateAnimations_.bind(this);this.projection_=ol.proj.createProjection(a.projection,"EPSG:3857");this.applyOptions_(a)};ol.inherits(ol.View,ol.Object);
ol.View.prototype.applyOptions_=function(a){var b={};b[ol.ViewProperty.CENTER]=void 0!==a.center?a.center:null;var c=ol.View.createResolutionConstraint_(a);this.maxResolution_=c.maxResolution;this.minResolution_=c.minResolution;this.zoomFactor_=c.zoomFactor;this.resolutions_=a.resolutions;this.minZoom_=c.minZoom;var d=ol.View.createCenterConstraint_(a);c=c.constraint;var e=ol.View.createRotationConstraint_(a);this.constraints_={center:d,resolution:c,rotation:e};void 0!==a.resolution?b[ol.ViewProperty.RESOLUTION]=
a.resolution:void 0!==a.zoom&&(b[ol.ViewProperty.RESOLUTION]=this.constrainResolution(this.maxResolution_,a.zoom-this.minZoom_));b[ol.ViewProperty.ROTATION]=void 0!==a.rotation?a.rotation:0;this.setProperties(b);this.options_=a};ol.View.prototype.getUpdatedOptions_=function(a){var b=ol.obj.assign({},this.options_);void 0!==b.resolution?b.resolution=this.getResolution():b.zoom=this.getZoom();b.center=this.getCenter();b.rotation=this.getRotation();return ol.obj.assign({},b,a)};
ol.View.prototype.animate=function(a){var b=arguments.length;if(1<b&&"function"===typeof arguments[b-1]){var c=arguments[b-1];--b}if(this.isDef()){for(var d=Date.now(),e=this.getCenter().slice(),f=this.getResolution(),g=this.getRotation(),h=[],k=0;k<b;++k){var l=arguments[k],m={start:d,complete:!1,anchor:l.anchor,duration:void 0!==l.duration?l.duration:1E3,easing:l.easing||ol.easing.inAndOut};l.center&&(m.sourceCenter=e,m.targetCenter=l.center,e=m.targetCenter);void 0!==l.zoom?(m.sourceResolution=
f,m.targetResolution=this.constrainResolution(this.maxResolution_,l.zoom-this.minZoom_,0),f=m.targetResolution):l.resolution&&(m.sourceResolution=f,m.targetResolution=l.resolution,f=m.targetResolution);void 0!==l.rotation&&(m.sourceRotation=g,l=ol.math.modulo(l.rotation-g+Math.PI,2*Math.PI)-Math.PI,m.targetRotation=g+l,g=m.targetRotation);m.callback=c;ol.View.isNoopAnimation(m)?m.complete=!0:d+=m.duration;h.push(m)}this.animations_.push(h);this.setHint(ol.ViewHint.ANIMATING,1);this.updateAnimations_()}else b=
arguments[b-1],b.center&&this.setCenter(b.center),void 0!==b.zoom&&this.setZoom(b.zoom),void 0!==b.rotation&&this.setRotation(b.rotation),c&&c(!0)};ol.View.prototype.getAnimating=function(){return 0<this.hints_[ol.ViewHint.ANIMATING]};ol.View.prototype.getInteracting=function(){return 0<this.hints_[ol.ViewHint.INTERACTING]};
ol.View.prototype.cancelAnimations=function(){this.setHint(ol.ViewHint.ANIMATING,-this.hints_[ol.ViewHint.ANIMATING]);for(var a=0,b=this.animations_.length;a<b;++a){var c=this.animations_[a];c[0].callback&&c[0].callback(!1)}this.animations_.length=0};
ol.View.prototype.updateAnimations_=function(){void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0);if(this.getAnimating()){for(var a=Date.now(),b=!1,c=this.animations_.length-1;0<=c;--c){for(var d=this.animations_[c],e=!0,f=0,g=d.length;f<g;++f){var h=d[f];if(!h.complete){b=a-h.start;b=0<h.duration?b/h.duration:1;1<=b?(h.complete=!0,b=1):e=!1;b=h.easing(b);if(h.sourceCenter){var k=h.sourceCenter[0],l=h.sourceCenter[1];this.set(ol.ViewProperty.CENTER,
[k+b*(h.targetCenter[0]-k),l+b*(h.targetCenter[1]-l)])}h.sourceResolution&&h.targetResolution&&(k=1===b?h.targetResolution:h.sourceResolution+b*(h.targetResolution-h.sourceResolution),h.anchor&&this.set(ol.ViewProperty.CENTER,this.calculateCenterZoom(k,h.anchor)),this.set(ol.ViewProperty.RESOLUTION,k));void 0!==h.sourceRotation&&void 0!==h.targetRotation&&(b=1===b?ol.math.modulo(h.targetRotation+Math.PI,2*Math.PI)-Math.PI:h.sourceRotation+b*(h.targetRotation-h.sourceRotation),h.anchor&&this.set(ol.ViewProperty.CENTER,
this.calculateCenterRotate(b,h.anchor)),this.set(ol.ViewProperty.ROTATION,b));b=!0;if(!h.complete)break}}e&&(this.animations_[c]=null,this.setHint(ol.ViewHint.ANIMATING,-1),(d=d[0].callback)&&d(!0))}this.animations_=this.animations_.filter(Boolean);b&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}};
ol.View.prototype.calculateCenterRotate=function(a,b){var c=this.getCenter();if(void 0!==c){var d=[c[0]-b[0],c[1]-b[1]];ol.coordinate.rotate(d,a-this.getRotation());ol.coordinate.add(d,b)}return d};ol.View.prototype.calculateCenterZoom=function(a,b){var c,d=this.getCenter(),e=this.getResolution();void 0!==d&&void 0!==e&&(c=[b[0]-a*(b[0]-d[0])/e,b[1]-a*(b[1]-d[1])/e]);return c};
ol.View.prototype.getSizeFromViewport_=function(){var a=[100,100],b='.ol-viewport[data-view="'+ol.getUid(this)+'"]';if(b=document.querySelector(b))b=getComputedStyle(b),a[0]=parseInt(b.width,10),a[1]=parseInt(b.height,10);return a};ol.View.prototype.constrainCenter=function(a){return this.constraints_.center(a)};ol.View.prototype.constrainResolution=function(a,b,c){return this.constraints_.resolution(a,b||0,c||0)};
ol.View.prototype.constrainRotation=function(a,b){return this.constraints_.rotation(a,b||0)};ol.View.prototype.getCenter=function(){return this.get(ol.ViewProperty.CENTER)};ol.View.prototype.getConstraints=function(){return this.constraints_};ol.View.prototype.getHints=function(a){return void 0!==a?(a[0]=this.hints_[0],a[1]=this.hints_[1],a):this.hints_.slice()};
ol.View.prototype.calculateExtent=function(a){a=a||this.getSizeFromViewport_();var b=this.getCenter();ol.asserts.assert(b,1);var c=this.getResolution();ol.asserts.assert(void 0!==c,2);var d=this.getRotation();ol.asserts.assert(void 0!==d,3);return ol.extent.getForViewAndSize(b,c,d,a)};ol.View.prototype.getMaxResolution=function(){return this.maxResolution_};ol.View.prototype.getMinResolution=function(){return this.minResolution_};ol.View.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)};
ol.View.prototype.setMaxZoom=function(a){this.applyOptions_(this.getUpdatedOptions_({maxZoom:a}))};ol.View.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)};ol.View.prototype.setMinZoom=function(a){this.applyOptions_(this.getUpdatedOptions_({minZoom:a}))};ol.View.prototype.getProjection=function(){return this.projection_};ol.View.prototype.getResolution=function(){return this.get(ol.ViewProperty.RESOLUTION)};ol.View.prototype.getResolutions=function(){return this.resolutions_};
ol.View.prototype.getResolutionForExtent=function(a,b){var c=b||this.getSizeFromViewport_();b=ol.extent.getWidth(a)/c[0];a=ol.extent.getHeight(a)/c[1];return Math.max(b,a)};ol.View.prototype.getResolutionForValueFunction=function(a){var b=a||2,c=this.maxResolution_,d=Math.log(c/this.minResolution_)/Math.log(b);return function(a){return c/Math.pow(b,a*d)}};ol.View.prototype.getRotation=function(){return this.get(ol.ViewProperty.ROTATION)};
ol.View.prototype.getValueForResolutionFunction=function(a){var b=a||2,c=this.maxResolution_,d=Math.log(c/this.minResolution_)/Math.log(b);return function(a){return Math.log(c/a)/Math.log(b)/d}};ol.View.prototype.getState=function(){var a=this.getCenter(),b=this.getProjection(),c=this.getResolution(),d=this.getRotation();return{center:a.slice(),projection:void 0!==b?b:null,resolution:c,rotation:d,zoom:this.getZoom()}};
ol.View.prototype.getZoom=function(){var a,b=this.getResolution();void 0!==b&&(a=this.getZoomForResolution(b));return a};ol.View.prototype.getZoomForResolution=function(a){var b=this.minZoom_||0;if(this.resolutions_){var c=ol.array.linearFindNearest(this.resolutions_,a,1);b+=c;var d=this.resolutions_[c];c=c==this.resolutions_.length-1?2:d/this.resolutions_[c+1]}else d=this.maxResolution_,c=this.zoomFactor_;return b+Math.log(d/a)/Math.log(c)};
ol.View.prototype.getResolutionForZoom=function(a){return this.constrainResolution(this.maxResolution_,a-this.minZoom_,0)};
ol.View.prototype.fit=function(a,b){b=b||{};var c=b.size;c||(c=this.getSizeFromViewport_());if(a instanceof ol.geom.SimpleGeometry)if(a.getType()===ol.geom.GeometryType.CIRCLE){a=a.getExtent();var d=ol.geom.Polygon.fromExtent(a);d.rotate(this.getRotation(),ol.extent.getCenter(a))}else d=a;else ol.asserts.assert(Array.isArray(a),24),ol.asserts.assert(!ol.extent.isEmpty(a),25),d=ol.geom.Polygon.fromExtent(a);var e=void 0!==b.padding?b.padding:[0,0,0,0],f=void 0!==b.constrainResolution?b.constrainResolution:
!0,g=void 0!==b.nearest?b.nearest:!1;var h=void 0!==b.minResolution?b.minResolution:void 0!==b.maxZoom?this.constrainResolution(this.maxResolution_,b.maxZoom-this.minZoom_,0):0;var k=d.getFlatCoordinates(),l=this.getRotation();a=Math.cos(-l);l=Math.sin(-l);var m=Infinity,n=Infinity,p=-Infinity,q=-Infinity;d=d.getStride();for(var r=0,u=k.length;r<u;r+=d){var v=k[r]*a-k[r+1]*l,t=k[r]*l+k[r+1]*a;m=Math.min(m,v);n=Math.min(n,t);p=Math.max(p,v);q=Math.max(q,t)}c=this.getResolutionForExtent([m,n,p,q],[c[0]-
e[1]-e[3],c[1]-e[0]-e[2]]);c=isNaN(c)?h:Math.max(c,h);f&&(f=this.constrainResolution(c,0,0),!g&&f<c&&(f=this.constrainResolution(f,-1,0)),c=f);l=-l;g=(m+p)/2+(e[1]-e[3])/2*c;e=(n+q)/2+(e[0]-e[2])/2*c;a=[g*a-e*l,e*a+g*l];e=b.callback?b.callback:ol.nullFunction;void 0!==b.duration?this.animate({resolution:c,center:a,duration:b.duration,easing:b.easing},e):(this.setResolution(c),this.setCenter(a),setTimeout(e.bind(void 0,!0),0))};
ol.View.prototype.centerOn=function(a,b,c){var d=this.getRotation(),e=Math.cos(-d);d=Math.sin(-d);var f=a[0]*e-a[1]*d;a=a[1]*e+a[0]*d;var g=this.getResolution();f+=(b[0]/2-c[0])*g;a+=(c[1]-b[1]/2)*g;d=-d;this.setCenter([f*e-a*d,a*e+f*d])};ol.View.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()};ol.View.prototype.rotate=function(a,b){void 0!==b&&(b=this.calculateCenterRotate(a,b),this.setCenter(b));this.setRotation(a)};
ol.View.prototype.setCenter=function(a){this.set(ol.ViewProperty.CENTER,a);this.getAnimating()&&this.cancelAnimations()};ol.View.prototype.setHint=function(a,b){this.hints_[a]+=b;this.changed();return this.hints_[a]};ol.View.prototype.setResolution=function(a){this.set(ol.ViewProperty.RESOLUTION,a);this.getAnimating()&&this.cancelAnimations()};ol.View.prototype.setRotation=function(a){this.set(ol.ViewProperty.ROTATION,a);this.getAnimating()&&this.cancelAnimations()};ol.View.prototype.setZoom=function(a){this.setResolution(this.getResolutionForZoom(a))};
ol.View.createCenterConstraint_=function(a){return void 0!==a.extent?ol.CenterConstraint.createExtent(a.extent):ol.CenterConstraint.none};
ol.View.createResolutionConstraint_=function(a){var b=void 0!==a.minZoom?a.minZoom:ol.DEFAULT_MIN_ZOOM,c=void 0!==a.maxZoom?a.maxZoom:28,d=void 0!==a.zoomFactor?a.zoomFactor:2;if(void 0!==a.resolutions){a=a.resolutions;var e=a[0];var f=a[a.length-1];a=ol.ResolutionConstraint.createSnapToResolutions(a)}else{e=ol.proj.createProjection(a.projection,"EPSG:3857");f=e.getExtent();var g=(f?Math.max(ol.extent.getWidth(f),ol.extent.getHeight(f)):360*ol.proj.METERS_PER_UNIT[ol.proj.Units.DEGREES]/e.getMetersPerUnit())/
ol.DEFAULT_TILE_SIZE/Math.pow(2,ol.DEFAULT_MIN_ZOOM),h=g/Math.pow(2,28-ol.DEFAULT_MIN_ZOOM);e=a.maxResolution;void 0!==e?b=0:e=g/Math.pow(d,b);f=a.minResolution;void 0===f&&(f=void 0!==a.maxZoom?void 0!==a.maxResolution?e/Math.pow(d,c):g/Math.pow(d,c):h);c=b+Math.floor(Math.log(e/f)/Math.log(d));f=e/Math.pow(d,c-b);a=ol.ResolutionConstraint.createSnapToPower(d,e,c-b)}return{constraint:a,maxResolution:e,minResolution:f,minZoom:b,zoomFactor:d}};
ol.View.createRotationConstraint_=function(a){return(void 0!==a.enableRotation?a.enableRotation:1)?(a=a.constrainRotation,void 0===a||!0===a?ol.RotationConstraint.createSnapToZero():!1===a?ol.RotationConstraint.none:"number"===typeof a?ol.RotationConstraint.createSnapToN(a):ol.RotationConstraint.none):ol.RotationConstraint.disable};
ol.View.isNoopAnimation=function(a){return a.sourceCenter&&a.targetCenter&&!ol.coordinate.equals(a.sourceCenter,a.targetCenter)||a.sourceResolution!==a.targetResolution||a.sourceRotation!==a.targetRotation?!1:!0};ol.layer.Group=function(a){var b=a||{};a=ol.obj.assign({},b);delete a.layers;b=b.layers;ol.layer.Base.call(this,a);this.layersListenerKeys_=[];this.listenerKeys_={};ol.events.listen(this,ol.Object.getChangeEventType(ol.layer.Group.Property_.LAYERS),this.handleLayersChanged_,this);b?Array.isArray(b)?b=new ol.Collection(b.slice(),{unique:!0}):ol.asserts.assert(b instanceof ol.Collection,43):b=new ol.Collection(void 0,{unique:!0});this.setLayers(b)};ol.inherits(ol.layer.Group,ol.layer.Base);
ol.layer.Group.prototype.handleLayerChange_=function(){this.changed()};
ol.layer.Group.prototype.handleLayersChanged_=function(a){this.layersListenerKeys_.forEach(ol.events.unlistenByKey);this.layersListenerKeys_.length=0;a=this.getLayers();this.layersListenerKeys_.push(ol.events.listen(a,ol.CollectionEventType.ADD,this.handleLayersAdd_,this),ol.events.listen(a,ol.CollectionEventType.REMOVE,this.handleLayersRemove_,this));for(var b in this.listenerKeys_)this.listenerKeys_[b].forEach(ol.events.unlistenByKey);ol.obj.clear(this.listenerKeys_);b=a.getArray();var c;a=0;for(c=
b.length;a<c;a++){var d=b[a];this.listenerKeys_[ol.getUid(d).toString()]=[ol.events.listen(d,ol.ObjectEventType.PROPERTYCHANGE,this.handleLayerChange_,this),ol.events.listen(d,ol.events.EventType.CHANGE,this.handleLayerChange_,this)]}this.changed()};
ol.layer.Group.prototype.handleLayersAdd_=function(a){a=a.element;var b=ol.getUid(a).toString();this.listenerKeys_[b]=[ol.events.listen(a,ol.ObjectEventType.PROPERTYCHANGE,this.handleLayerChange_,this),ol.events.listen(a,ol.events.EventType.CHANGE,this.handleLayerChange_,this)];this.changed()};ol.layer.Group.prototype.handleLayersRemove_=function(a){a=ol.getUid(a.element).toString();this.listenerKeys_[a].forEach(ol.events.unlistenByKey);delete this.listenerKeys_[a];this.changed()};
ol.layer.Group.prototype.getLayers=function(){return this.get(ol.layer.Group.Property_.LAYERS)};ol.layer.Group.prototype.setLayers=function(a){this.set(ol.layer.Group.Property_.LAYERS,a)};ol.layer.Group.prototype.getLayersArray=function(a){var b=void 0!==a?a:[];this.getLayers().forEach(function(a){a.getLayersArray(b)});return b};
ol.layer.Group.prototype.getLayerStatesArray=function(a){var b=void 0!==a?a:[],c=b.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(b)});a=this.getLayerState();var d;for(d=b.length;c<d;c++){var e=b[c];e.opacity*=a.opacity;e.visible=e.visible&&a.visible;e.maxResolution=Math.min(e.maxResolution,a.maxResolution);e.minResolution=Math.max(e.minResolution,a.minResolution);void 0!==a.extent&&(e.extent=void 0!==e.extent?ol.extent.getIntersection(e.extent,a.extent):a.extent)}return b};
ol.layer.Group.prototype.getSourceState=function(){return ol.source.State.READY};ol.layer.Group.Property_={LAYERS:"layers"};ol.PluginType={MAP_RENDERER:"MAP_RENDERER",LAYER_RENDERER:"LAYER_RENDERER"};ol.plugins={};ol.plugins.mapRendererPlugins_=[];ol.plugins.getMapRendererPlugins=function(){return ol.plugins.mapRendererPlugins_};ol.plugins.layerRendererPlugins_=[];ol.plugins.getLayerRendererPlugins=function(){return ol.plugins.layerRendererPlugins_};
ol.plugins.register=function(a,b){switch(a){case ol.PluginType.MAP_RENDERER:a=ol.plugins.mapRendererPlugins_;a.push(b);break;case ol.PluginType.LAYER_RENDERER:a=ol.plugins.layerRendererPlugins_;a.push(b);break;default:throw Error("Unsupported plugin type: "+a);}};ol.plugins.registerMultiple=function(a,b){for(var c=0,d=b.length;c<d;++c)ol.plugins.register(a,b[c])};ol.PluggableMap=function(a){ol.Object.call(this);var b=ol.PluggableMap.createOptionsInternal(a);this.loadTilesWhileAnimating_=void 0!==a.loadTilesWhileAnimating?a.loadTilesWhileAnimating:!1;this.loadTilesWhileInteracting_=void 0!==a.loadTilesWhileInteracting?a.loadTilesWhileInteracting:!1;this.pixelRatio_=void 0!==a.pixelRatio?a.pixelRatio:ol.has.DEVICE_PIXEL_RATIO;this.logos_=b.logos;this.animationDelay_=function(){this.animationDelayKey_=void 0;this.renderFrame_.call(this,Date.now())}.bind(this);
this.coordinateToPixelTransform_=ol.transform.create();this.pixelToCoordinateTransform_=ol.transform.create();this.frameIndex_=0;this.layerGroupPropertyListenerKeys_=this.viewChangeListenerKey_=this.viewPropertyListenerKey_=this.previousExtent_=this.frameState_=null;this.viewport_=document.createElement("DIV");this.viewport_.className="ol-viewport"+(ol.has.TOUCH?" ol-touch":"");this.viewport_.style.position="relative";this.viewport_.style.overflow="hidden";this.viewport_.style.width="100%";this.viewport_.style.height=
"100%";this.viewport_.style.msTouchAction="none";this.viewport_.style.touchAction="none";this.overlayContainer_=document.createElement("DIV");this.overlayContainer_.className="ol-overlaycontainer";this.viewport_.appendChild(this.overlayContainer_);this.overlayContainerStopEvent_=document.createElement("DIV");this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var c=[ol.events.EventType.CLICK,ol.events.EventType.DBLCLICK,ol.events.EventType.MOUSEDOWN,ol.events.EventType.TOUCHSTART,
ol.events.EventType.MSPOINTERDOWN,ol.MapBrowserEventType.POINTERDOWN,ol.events.EventType.MOUSEWHEEL,ol.events.EventType.WHEEL],d=0,e=c.length;d<e;++d)ol.events.listen(this.overlayContainerStopEvent_,c[d],ol.events.Event.stopPropagation);this.viewport_.appendChild(this.overlayContainerStopEvent_);this.mapBrowserEventHandler_=new ol.MapBrowserEventHandler(this,a.moveTolerance);for(var f in ol.MapBrowserEventType)ol.events.listen(this.mapBrowserEventHandler_,ol.MapBrowserEventType[f],this.handleMapBrowserEvent,
this);this.keyboardEventTarget_=b.keyboardEventTarget;this.keyHandlerKeys_=null;ol.events.listen(this.viewport_,ol.events.EventType.WHEEL,this.handleBrowserEvent,this);ol.events.listen(this.viewport_,ol.events.EventType.MOUSEWHEEL,this.handleBrowserEvent,this);this.controls=b.controls||new ol.Collection;this.interactions=b.interactions||new ol.Collection;this.overlays_=b.overlays;this.overlayIdIndex_={};this.renderer_=b.mapRendererPlugin.create(this.viewport_,this);this.focus_=null;this.postRenderFunctions_=
[];this.tileQueue_=new ol.TileQueue(this.getTilePriority.bind(this),this.handleTileChange_.bind(this));this.skippedFeatureUids_={};ol.events.listen(this,ol.Object.getChangeEventType(ol.MapProperty.LAYERGROUP),this.handleLayerGroupChanged_,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.MapProperty.VIEW),this.handleViewChanged_,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.MapProperty.SIZE),this.handleSizeChanged_,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.MapProperty.TARGET),
this.handleTargetChanged_,this);this.setProperties(b.values);this.controls.forEach(function(a){a.setMap(this)},this);ol.events.listen(this.controls,ol.CollectionEventType.ADD,function(a){a.element.setMap(this)},this);ol.events.listen(this.controls,ol.CollectionEventType.REMOVE,function(a){a.element.setMap(null)},this);this.interactions.forEach(function(a){a.setMap(this)},this);ol.events.listen(this.interactions,ol.CollectionEventType.ADD,function(a){a.element.setMap(this)},this);ol.events.listen(this.interactions,
ol.CollectionEventType.REMOVE,function(a){a.element.setMap(null)},this);this.overlays_.forEach(this.addOverlayInternal_,this);ol.events.listen(this.overlays_,ol.CollectionEventType.ADD,function(a){this.addOverlayInternal_(a.element)},this);ol.events.listen(this.overlays_,ol.CollectionEventType.REMOVE,function(a){var b=a.element.getId();void 0!==b&&delete this.overlayIdIndex_[b.toString()];a.element.setMap(null)},this)};ol.inherits(ol.PluggableMap,ol.Object);ol.PluggableMap.prototype.addControl=function(a){this.getControls().push(a)};
ol.PluggableMap.prototype.addInteraction=function(a){this.getInteractions().push(a)};ol.PluggableMap.prototype.addLayer=function(a){this.getLayerGroup().getLayers().push(a)};ol.PluggableMap.prototype.addOverlay=function(a){this.getOverlays().push(a)};ol.PluggableMap.prototype.addOverlayInternal_=function(a){var b=a.getId();void 0!==b&&(this.overlayIdIndex_[b.toString()]=a);a.setMap(this)};
ol.PluggableMap.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose();this.renderer_.dispose();ol.events.unlisten(this.viewport_,ol.events.EventType.WHEEL,this.handleBrowserEvent,this);ol.events.unlisten(this.viewport_,ol.events.EventType.MOUSEWHEEL,this.handleBrowserEvent,this);void 0!==this.handleResize_&&(window.removeEventListener(ol.events.EventType.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),
this.animationDelayKey_=void 0);this.setTarget(null);ol.Object.prototype.disposeInternal.call(this)};ol.PluggableMap.prototype.forEachFeatureAtPixel=function(a,b,c){if(this.frameState_)return a=this.getCoordinateFromPixel(a),c=void 0!==c?c:{},this.renderer_.forEachFeatureAtCoordinate(a,this.frameState_,void 0!==c.hitTolerance?c.hitTolerance*this.frameState_.pixelRatio:0,b,null,void 0!==c.layerFilter?c.layerFilter:ol.functions.TRUE,null)};
ol.PluggableMap.prototype.getFeaturesAtPixel=function(a,b){var c=null;this.forEachFeatureAtPixel(a,function(a){c||(c=[]);c.push(a)},b);return c};ol.PluggableMap.prototype.forEachLayerAtPixel=function(a,b,c,d,e){if(this.frameState_)return this.renderer_.forEachLayerAtPixel(a,this.frameState_,b,void 0!==c?c:null,void 0!==d?d:ol.functions.TRUE,void 0!==e?e:null)};
ol.PluggableMap.prototype.hasFeatureAtPixel=function(a,b){if(!this.frameState_)return!1;a=this.getCoordinateFromPixel(a);b=void 0!==b?b:{};return this.renderer_.hasFeatureAtCoordinate(a,this.frameState_,void 0!==b.hitTolerance?b.hitTolerance*this.frameState_.pixelRatio:0,void 0!==b.layerFilter?b.layerFilter:ol.functions.TRUE,null)};ol.PluggableMap.prototype.getEventCoordinate=function(a){return this.getCoordinateFromPixel(this.getEventPixel(a))};
ol.PluggableMap.prototype.getEventPixel=function(a){var b=this.viewport_.getBoundingClientRect();a=a.changedTouches?a.changedTouches[0]:a;return[a.clientX-b.left,a.clientY-b.top]};ol.PluggableMap.prototype.getTarget=function(){return this.get(ol.MapProperty.TARGET)};ol.PluggableMap.prototype.getTargetElement=function(){var a=this.getTarget();return void 0!==a?"string"===typeof a?document.getElementById(a):a:null};
ol.PluggableMap.prototype.getCoordinateFromPixel=function(a){var b=this.frameState_;return b?ol.transform.apply(b.pixelToCoordinateTransform,a.slice()):null};ol.PluggableMap.prototype.getControls=function(){return this.controls};ol.PluggableMap.prototype.getOverlays=function(){return this.overlays_};ol.PluggableMap.prototype.getOverlayById=function(a){a=this.overlayIdIndex_[a.toString()];return void 0!==a?a:null};ol.PluggableMap.prototype.getInteractions=function(){return this.interactions};
ol.PluggableMap.prototype.getLayerGroup=function(){return this.get(ol.MapProperty.LAYERGROUP)};ol.PluggableMap.prototype.getLayers=function(){return this.getLayerGroup().getLayers()};ol.PluggableMap.prototype.getPixelFromCoordinate=function(a){var b=this.frameState_;return b?ol.transform.apply(b.coordinateToPixelTransform,a.slice(0,2)):null};ol.PluggableMap.prototype.getRenderer=function(){return this.renderer_};ol.PluggableMap.prototype.getSize=function(){return this.get(ol.MapProperty.SIZE)};
ol.PluggableMap.prototype.getView=function(){return this.get(ol.MapProperty.VIEW)};ol.PluggableMap.prototype.getViewport=function(){return this.viewport_};ol.PluggableMap.prototype.getOverlayContainer=function(){return this.overlayContainer_};ol.PluggableMap.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_};
ol.PluggableMap.prototype.getTilePriority=function(a,b,c,d){var e=this.frameState_;if(!(e&&b in e.wantedTiles&&e.wantedTiles[b][a.getKey()]))return ol.structs.PriorityQueue.DROP;a=c[0]-e.focus[0];c=c[1]-e.focus[1];return 65536*Math.log(d)+Math.sqrt(a*a+c*c)/d};ol.PluggableMap.prototype.handleBrowserEvent=function(a,b){a=new ol.MapBrowserEvent(b||a.type,this,a);this.handleMapBrowserEvent(a)};
ol.PluggableMap.prototype.handleMapBrowserEvent=function(a){if(this.frameState_){this.focus_=a.coordinate;a.frameState=this.frameState_;var b=this.getInteractions().getArray(),c;if(!1!==this.dispatchEvent(a))for(c=b.length-1;0<=c;c--){var d=b[c];if(d.getActive()&&!d.handleEvent(a))break}}};
ol.PluggableMap.prototype.handlePostRender=function(){var a=this.frameState_,b=this.tileQueue_;if(!b.isEmpty()){var c=16,d=c;if(a){var e=a.viewHints;e[ol.ViewHint.ANIMATING]&&(c=this.loadTilesWhileAnimating_?8:0,d=2);e[ol.ViewHint.INTERACTING]&&(c=this.loadTilesWhileInteracting_?8:0,d=2)}b.getTilesLoading()<c&&(b.reprioritize(),b.loadMoreTiles(c,d))}b=this.postRenderFunctions_;c=0;for(d=b.length;c<d;++c)b[c](this,a);b.length=0};ol.PluggableMap.prototype.handleSizeChanged_=function(){this.render()};
ol.PluggableMap.prototype.handleTargetChanged_=function(){var a;this.getTarget()&&(a=this.getTargetElement());if(this.keyHandlerKeys_){for(var b=0,c=this.keyHandlerKeys_.length;b<c;++b)ol.events.unlistenByKey(this.keyHandlerKeys_[b]);this.keyHandlerKeys_=null}a?(a.appendChild(this.viewport_),a=this.keyboardEventTarget_?this.keyboardEventTarget_:a,this.keyHandlerKeys_=[ol.events.listen(a,ol.events.EventType.KEYDOWN,this.handleBrowserEvent,this),ol.events.listen(a,ol.events.EventType.KEYPRESS,this.handleBrowserEvent,
this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(ol.events.EventType.RESIZE,this.handleResize_,!1))):(ol.dom.removeNode(this.viewport_),void 0!==this.handleResize_&&(window.removeEventListener(ol.events.EventType.RESIZE,this.handleResize_,!1),this.handleResize_=void 0));this.updateSize()};ol.PluggableMap.prototype.handleTileChange_=function(){this.render()};ol.PluggableMap.prototype.handleViewPropertyChanged_=function(){this.render()};
ol.PluggableMap.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(ol.events.unlistenByKey(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null);this.viewChangeListenerKey_&&(ol.events.unlistenByKey(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var a=this.getView();a&&(this.viewport_.setAttribute("data-view",ol.getUid(a)),this.viewPropertyListenerKey_=ol.events.listen(a,ol.ObjectEventType.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=
ol.events.listen(a,ol.events.EventType.CHANGE,this.handleViewPropertyChanged_,this));this.render()};
ol.PluggableMap.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(ol.events.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);var a=this.getLayerGroup();a&&(this.layerGroupPropertyListenerKeys_=[ol.events.listen(a,ol.ObjectEventType.PROPERTYCHANGE,this.render,this),ol.events.listen(a,ol.events.EventType.CHANGE,this.render,this)]);this.render()};ol.PluggableMap.prototype.isRendered=function(){return!!this.frameState_};
ol.PluggableMap.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_);this.animationDelay_()};ol.PluggableMap.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))};ol.PluggableMap.prototype.removeControl=function(a){return this.getControls().remove(a)};ol.PluggableMap.prototype.removeInteraction=function(a){return this.getInteractions().remove(a)};
ol.PluggableMap.prototype.removeLayer=function(a){return this.getLayerGroup().getLayers().remove(a)};ol.PluggableMap.prototype.removeOverlay=function(a){return this.getOverlays().remove(a)};
ol.PluggableMap.prototype.renderFrame_=function(a){var b,c=this.getSize(),d=this.getView(),e=ol.extent.createEmpty(),f=this.frameState_,g=null;if(void 0!==c&&ol.size.hasArea(c)&&d&&d.isDef()){g=d.getHints(this.frameState_?this.frameState_.viewHints:void 0);var h=this.getLayerGroup().getLayerStatesArray(),k={};var l=0;for(b=h.length;l<b;++l)k[ol.getUid(h[l].layer)]=h[l];l=d.getState();g={animate:!1,attributions:{},coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:e,focus:this.focus_?
this.focus_:l.center,index:this.frameIndex_++,layerStates:k,layerStatesArray:h,logos:ol.obj.assign({},this.logos_),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:c,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:a,usedTiles:{},viewState:l,viewHints:g,wantedTiles:{}}}g&&(g.extent=ol.extent.getForViewAndSize(l.center,l.resolution,l.rotation,g.size,e));this.frameState_=g;this.renderer_.renderFrame(g);g&&(g.animate&&
this.render(),Array.prototype.push.apply(this.postRenderFunctions_,g.postRenderFunctions),!f||this.previousExtent_&&(ol.extent.isEmpty(this.previousExtent_)||ol.extent.equals(g.extent,this.previousExtent_))||(this.dispatchEvent(new ol.MapEvent(ol.MapEventType.MOVESTART,this,f)),this.previousExtent_=ol.extent.createOrUpdateEmpty(this.previousExtent_)),!this.previousExtent_||g.viewHints[ol.ViewHint.ANIMATING]||g.viewHints[ol.ViewHint.INTERACTING]||ol.extent.equals(g.extent,this.previousExtent_)||(this.dispatchEvent(new ol.MapEvent(ol.MapEventType.MOVEEND,
this,g)),ol.extent.clone(g.extent,this.previousExtent_)));this.dispatchEvent(new ol.MapEvent(ol.MapEventType.POSTRENDER,this,g));setTimeout(this.handlePostRender.bind(this),0)};ol.PluggableMap.prototype.setLayerGroup=function(a){this.set(ol.MapProperty.LAYERGROUP,a)};ol.PluggableMap.prototype.setSize=function(a){this.set(ol.MapProperty.SIZE,a)};ol.PluggableMap.prototype.setTarget=function(a){this.set(ol.MapProperty.TARGET,a)};
ol.PluggableMap.prototype.setView=function(a){this.set(ol.MapProperty.VIEW,a)};ol.PluggableMap.prototype.skipFeature=function(a){a=ol.getUid(a).toString();this.skippedFeatureUids_[a]=!0;this.render()};
ol.PluggableMap.prototype.updateSize=function(){var a=this.getTargetElement();if(a){var b=getComputedStyle(a);this.setSize([a.offsetWidth-parseFloat(b.borderLeftWidth)-parseFloat(b.paddingLeft)-parseFloat(b.paddingRight)-parseFloat(b.borderRightWidth),a.offsetHeight-parseFloat(b.borderTopWidth)-parseFloat(b.paddingTop)-parseFloat(b.paddingBottom)-parseFloat(b.borderBottomWidth)])}else this.setSize(void 0)};
ol.PluggableMap.prototype.unskipFeature=function(a){a=ol.getUid(a).toString();delete this.skippedFeatureUids_[a];this.render()};ol.PluggableMap.DEFAULT_RENDERER_TYPES=[ol.renderer.Type.CANVAS,ol.renderer.Type.WEBGL];ol.PluggableMap.LOGO_URL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAHGAAABxgEXwfpGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAhNQTFRF////AP//AICAgP//AFVVQECA////K1VVSbbbYL/fJ05idsTYJFtbbcjbJllmZszWWMTOIFhoHlNiZszTa9DdUcHNHlNlV8XRIVdiasrUHlZjIVZjaMnVH1RlIFRkH1RkH1ZlasvYasvXVsPQH1VkacnVa8vWIVZjIFRjVMPQa8rXIVVkXsXRsNveIFVkIFZlIVVj3eDeh6GmbMvXH1ZkIFRka8rWbMvXIFVkIFVjIFVkbMvWH1VjbMvWIFVlbcvWIFVla8vVIFVkbMvWbMvVH1VkbMvWIFVlbcvWIFVkbcvVbMvWjNPbIFVkU8LPwMzNIFVkbczWIFVkbsvWbMvXIFVkRnB8bcvW2+TkW8XRIFVkIlZlJVloJlpoKlxrLl9tMmJwOWd0Omh1RXF8TneCT3iDUHiDU8LPVMLPVcLPVcPQVsPPVsPQV8PQWMTQWsTQW8TQXMXSXsXRX4SNX8bSYMfTYcfTYsfTY8jUZcfSZsnUaIqTacrVasrVa8jTa8rWbI2VbMvWbcvWdJObdcvUdszUd8vVeJaee87Yfc3WgJyjhqGnitDYjaarldPZnrK2oNbborW5o9bbo9fbpLa6q9ndrL3ArtndscDDutzfu8fJwN7gwt7gxc/QyuHhy+HizeHi0NfX0+Pj19zb1+Tj2uXk29/e3uLg3+Lh3+bl4uXj4ufl4+fl5Ofl5ufl5ujm5+jmySDnBAAAAFp0Uk5TAAECAgMEBAYHCA0NDg4UGRogIiMmKSssLzU7PkJJT1JTVFliY2hrdHZ3foSFhYeJjY2QkpugqbG1tre5w8zQ09XY3uXn6+zx8vT09vf4+Pj5+fr6/P39/f3+gz7SsAAAAVVJREFUOMtjYKA7EBDnwCPLrObS1BRiLoJLnte6CQy8FLHLCzs2QUG4FjZ5GbcmBDDjxJBXDWxCBrb8aM4zbkIDzpLYnAcE9VXlJSWlZRU13koIeW57mGx5XjoMZEUqwxWYQaQbSzLSkYGfKFSe0QMsX5WbjgY0YS4MBplemI4BdGBW+DQ11eZiymfqQuXZIjqwyadPNoSZ4L+0FVM6e+oGI6g8a9iKNT3o8kVzNkzRg5lgl7p4wyRUL9Yt2jAxVh6mQCogae6GmflI8p0r13VFWTHBQ0rWPW7ahgWVcPm+9cuLoyy4kCJDzCm6d8PSFoh0zvQNC5OjDJhQopPPJqph1doJBUD5tnkbZiUEqaCnB3bTqLTFG1bPn71kw4b+GFdpLElKIzRxxgYgWNYc5SCENVHKeUaltHdXx0dZ8uBI1hJ2UUDgq82CM2MwKeibqAvSO7MCABq0wXEPiqWEAAAAAElFTkSuQmCC";
ol.PluggableMap.createOptionsInternal=function(a){var b=null;void 0!==a.keyboardEventTarget&&(b="string"===typeof a.keyboardEventTarget?document.getElementById(a.keyboardEventTarget):a.keyboardEventTarget);var c={},d={};if(void 0===a.logo||"boolean"===typeof a.logo&&a.logo)d[ol.PluggableMap.LOGO_URL]="https://openlayers.org/";else{var e=a.logo;"string"===typeof e?d[e]="":e instanceof HTMLElement?d[ol.getUid(e).toString()]=e:e&&(ol.asserts.assert("string"==typeof e.href,44),ol.asserts.assert("string"==
typeof e.src,45),d[e.src]=e.href)}e=a.layers instanceof ol.layer.Group?a.layers:new ol.layer.Group({layers:a.layers});c[ol.MapProperty.LAYERGROUP]=e;c[ol.MapProperty.TARGET]=a.target;c[ol.MapProperty.VIEW]=void 0!==a.view?a.view:new ol.View;var f;void 0!==a.renderer?(Array.isArray(a.renderer)?f=a.renderer:"string"===typeof a.renderer?f=[a.renderer]:ol.asserts.assert(!1,46),0<=f.indexOf("dom")&&(f=f.concat(ol.PluggableMap.DEFAULT_RENDERER_TYPES))):f=ol.PluggableMap.DEFAULT_RENDERER_TYPES;e=ol.plugins.getMapRendererPlugins();
var g=0,h=f.length;a:for(;g<h;++g)for(var k=f[g],l=0,m=e.length;l<m;++l){var n=e[l];if(n.handles(k)){var p=n;break a}}if(!p)throw Error("Unable to create a map renderer for types: "+f.join(", "));if(void 0!==a.controls)if(Array.isArray(a.controls))var q=new ol.Collection(a.controls.slice());else ol.asserts.assert(a.controls instanceof ol.Collection,47),q=a.controls;if(void 0!==a.interactions)if(Array.isArray(a.interactions))var r=new ol.Collection(a.interactions.slice());else ol.asserts.assert(a.interactions instanceof
ol.Collection,48),r=a.interactions;void 0!==a.overlays?Array.isArray(a.overlays)?a=new ol.Collection(a.overlays.slice()):(ol.asserts.assert(a.overlays instanceof ol.Collection,49),a=a.overlays):a=new ol.Collection;return{controls:q,interactions:r,keyboardEventTarget:b,logos:d,overlays:a,mapRendererPlugin:p,values:c}};ol.control.Attribution=function(a){a=a?a:{};this.ulElement_=document.createElement("UL");this.logoLi_=document.createElement("LI");this.ulElement_.appendChild(this.logoLi_);this.logoLi_.style.display="none";this.collapsed_=void 0!==a.collapsed?a.collapsed:!0;this.collapsible_=void 0!==a.collapsible?a.collapsible:!0;this.collapsible_||(this.collapsed_=!1);var b=void 0!==a.className?a.className:"ol-attribution",c=void 0!==a.tipLabel?a.tipLabel:"Attributions",d=void 0!==a.collapseLabel?a.collapseLabel:
"\u00bb";"string"===typeof d?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=d):this.collapseLabel_=d;d=void 0!==a.label?a.label:"i";"string"===typeof d?(this.label_=document.createElement("span"),this.label_.textContent=d):this.label_=d;var e=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;d=document.createElement("button");d.setAttribute("type","button");d.title=c;d.appendChild(e);ol.events.listen(d,ol.events.EventType.CLICK,this.handleClick_,
this);b=b+" "+ol.css.CLASS_UNSELECTABLE+" "+ol.css.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" ol-collapsed":"")+(this.collapsible_?"":" ol-uncollapsible");c=document.createElement("div");c.className=b;c.appendChild(this.ulElement_);c.appendChild(d);ol.control.Control.call(this,{element:c,render:a.render?a.render:ol.control.Attribution.render,target:a.target});this.renderedAttributions_=[];this.renderedVisible_=!0;this.logoElements_={}};ol.inherits(ol.control.Attribution,ol.control.Control);
ol.control.Attribution.prototype.getSourceAttributions_=function(a){for(var b={},c=[],d=a.layerStatesArray,e=a.viewState.resolution,f=0,g=d.length;f<g;++f){var h=d[f];if(ol.layer.Layer.visibleAtResolution(h,e)&&(h=h.layer.getSource())&&(h=h.getAttributions2())&&(h=h(a)))if(Array.isArray(h))for(var k=0,l=h.length;k<l;++k)h[k]in b||(c.push(h[k]),b[h[k]]=!0);else h in b||(c.push(h),b[h]=!0)}return c};ol.control.Attribution.render=function(a){this.updateElement_(a.frameState)};
ol.control.Attribution.prototype.updateElement_=function(a){if(a){var b=this.getSourceAttributions_(a);if(!ol.array.equals(b,this.renderedAttributions_)){for(;this.ulElement_.lastChild!==this.logoLi_;)this.ulElement_.removeChild(this.ulElement_.lastChild);for(var c=0,d=b.length;c<d;++c){var e=document.createElement("LI");e.innerHTML=b[c];this.ulElement_.appendChild(e)}0===b.length&&0<this.renderedAttributions_.length?this.element.classList.add("ol-logo-only"):0===this.renderedAttributions_.length&&
0<b.length&&this.element.classList.remove("ol-logo-only");c=0<b.length||!ol.obj.isEmpty(a.logos);this.renderedVisible_!=c&&(this.element.style.display=c?"":"none",this.renderedVisible_=c);this.renderedAttributions_=b;this.insertLogos_(a)}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)};
ol.control.Attribution.prototype.insertLogos_=function(a){a=a.logos;var b=this.logoElements_;for(e in b)e in a||(ol.dom.removeNode(b[e]),delete b[e]);var c;for(c in a){var d=a[c];d instanceof HTMLElement&&(this.logoLi_.appendChild(d),b[c]=d);if(!(c in b)){var e=new Image;e.src=c;if(""===d)var f=e;else f=document.createElement("a"),f.href=d,f.appendChild(e);this.logoLi_.appendChild(f);b[c]=f}}this.logoLi_.style.display=ol.obj.isEmpty(a)?"none":""};
ol.control.Attribution.prototype.handleClick_=function(a){a.preventDefault();this.handleToggle_()};ol.control.Attribution.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed");this.collapsed_?ol.dom.replaceNode(this.collapseLabel_,this.label_):ol.dom.replaceNode(this.label_,this.collapseLabel_);this.collapsed_=!this.collapsed_};ol.control.Attribution.prototype.getCollapsible=function(){return this.collapsible_};
ol.control.Attribution.prototype.setCollapsible=function(a){this.collapsible_!==a&&(this.collapsible_=a,this.element.classList.toggle("ol-uncollapsible"),!a&&this.collapsed_&&this.handleToggle_())};ol.control.Attribution.prototype.setCollapsed=function(a){this.collapsible_&&this.collapsed_!==a&&this.handleToggle_()};ol.control.Attribution.prototype.getCollapsed=function(){return this.collapsed_};ol.control.Rotate=function(a){a=a?a:{};var b=void 0!==a.className?a.className:"ol-rotate",c=void 0!==a.label?a.label:"\u21e7";this.label_=null;"string"===typeof c?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=c):(this.label_=c,this.label_.classList.add("ol-compass"));var d=a.tipLabel?a.tipLabel:"Reset rotation";c=document.createElement("button");c.className=b+"-reset";c.setAttribute("type","button");c.title=d;c.appendChild(this.label_);ol.events.listen(c,
ol.events.EventType.CLICK,ol.control.Rotate.prototype.handleClick_,this);d=b+" "+ol.css.CLASS_UNSELECTABLE+" "+ol.css.CLASS_CONTROL;b=document.createElement("div");b.className=d;b.appendChild(c);c=a.render?a.render:ol.control.Rotate.render;this.callResetNorth_=a.resetNorth?a.resetNorth:void 0;ol.control.Control.call(this,{element:b,render:c,target:a.target});this.duration_=void 0!==a.duration?a.duration:250;this.autoHide_=void 0!==a.autoHide?a.autoHide:!0;this.rotation_=void 0;this.autoHide_&&this.element.classList.add(ol.css.CLASS_HIDDEN)};
ol.inherits(ol.control.Rotate,ol.control.Control);ol.control.Rotate.prototype.handleClick_=function(a){a.preventDefault();void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()};ol.control.Rotate.prototype.resetNorth_=function(){var a=this.getMap().getView();a&&void 0!==a.getRotation()&&(0<this.duration_?a.animate({rotation:0,duration:this.duration_,easing:ol.easing.easeOut}):a.setRotation(0))};
ol.control.Rotate.render=function(a){if(a=a.frameState){a=a.viewState.rotation;if(a!=this.rotation_){var b="rotate("+a+"rad)";if(this.autoHide_){var c=this.element.classList.contains(ol.css.CLASS_HIDDEN);c||0!==a?c&&0!==a&&this.element.classList.remove(ol.css.CLASS_HIDDEN):this.element.classList.add(ol.css.CLASS_HIDDEN)}this.label_.style.msTransform=b;this.label_.style.webkitTransform=b;this.label_.style.transform=b}this.rotation_=a}};ol.control.Zoom=function(a){a=a?a:{};var b=void 0!==a.className?a.className:"ol-zoom",c=void 0!==a.delta?a.delta:1,d=void 0!==a.zoomInLabel?a.zoomInLabel:"+",e=void 0!==a.zoomOutLabel?a.zoomOutLabel:"\u2212",f=void 0!==a.zoomInTipLabel?a.zoomInTipLabel:"Zoom in",g=void 0!==a.zoomOutTipLabel?a.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=b+"-in";h.setAttribute("type","button");h.title=f;h.appendChild("string"===typeof d?document.createTextNode(d):d);ol.events.listen(h,
ol.events.EventType.CLICK,ol.control.Zoom.prototype.handleClick_.bind(this,c));d=document.createElement("button");d.className=b+"-out";d.setAttribute("type","button");d.title=g;d.appendChild("string"===typeof e?document.createTextNode(e):e);ol.events.listen(d,ol.events.EventType.CLICK,ol.control.Zoom.prototype.handleClick_.bind(this,-c));b=b+" "+ol.css.CLASS_UNSELECTABLE+" "+ol.css.CLASS_CONTROL;c=document.createElement("div");c.className=b;c.appendChild(h);c.appendChild(d);ol.control.Control.call(this,
{element:c,target:a.target});this.duration_=void 0!==a.duration?a.duration:250};ol.inherits(ol.control.Zoom,ol.control.Control);ol.control.Zoom.prototype.handleClick_=function(a,b){b.preventDefault();this.zoomByDelta_(a)};ol.control.Zoom.prototype.zoomByDelta_=function(a){var b=this.getMap().getView();if(b){var c=b.getResolution();c&&(a=b.constrainResolution(c,a),0<this.duration_?(b.getAnimating()&&b.cancelAnimations(),b.animate({resolution:a,duration:this.duration_,easing:ol.easing.easeOut})):b.setResolution(a))}};ol.control.defaults=function(a){a=a?a:{};var b=new ol.Collection;(void 0!==a.zoom?a.zoom:1)&&b.push(new ol.control.Zoom(a.zoomOptions));(void 0!==a.rotate?a.rotate:1)&&b.push(new ol.control.Rotate(a.rotateOptions));(void 0!==a.attribution?a.attribution:1)&&b.push(new ol.control.Attribution(a.attributionOptions));return b};ol.Kinetic=function(a,b,c){this.decay_=a;this.minVelocity_=b;this.delay_=c;this.points_=[];this.initialVelocity_=this.angle_=0};ol.Kinetic.prototype.begin=function(){this.initialVelocity_=this.angle_=this.points_.length=0};ol.Kinetic.prototype.update=function(a,b){this.points_.push(a,b,Date.now())};
ol.Kinetic.prototype.end=function(){if(6>this.points_.length)return!1;var a=Date.now()-this.delay_,b=this.points_.length-3;if(this.points_[b+2]<a)return!1;for(var c=b-3;0<c&&this.points_[c+2]>a;)c-=3;a=this.points_[b+2]-this.points_[c+2];if(a<1E3/60)return!1;var d=this.points_[b]-this.points_[c];b=this.points_[b+1]-this.points_[c+1];this.angle_=Math.atan2(b,d);this.initialVelocity_=Math.sqrt(d*d+b*b)/a;return this.initialVelocity_>this.minVelocity_};
ol.Kinetic.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_};ol.Kinetic.prototype.getAngle=function(){return this.angle_};ol.interaction={};ol.interaction.Property={ACTIVE:"active"};ol.interaction.Interaction=function(a){ol.Object.call(this);this.map_=null;this.setActive(!0);this.handleEvent=a.handleEvent};ol.inherits(ol.interaction.Interaction,ol.Object);ol.interaction.Interaction.prototype.getActive=function(){return this.get(ol.interaction.Property.ACTIVE)};ol.interaction.Interaction.prototype.getMap=function(){return this.map_};ol.interaction.Interaction.prototype.setActive=function(a){this.set(ol.interaction.Property.ACTIVE,a)};
ol.interaction.Interaction.prototype.setMap=function(a){this.map_=a};ol.interaction.Interaction.pan=function(a,b,c){var d=a.getCenter();d&&(b=a.constrainCenter([d[0]+b[0],d[1]+b[1]]),c?a.animate({duration:c,easing:ol.easing.linear,center:b}):a.setCenter(b))};ol.interaction.Interaction.rotate=function(a,b,c,d){b=a.constrainRotation(b,0);ol.interaction.Interaction.rotateWithoutConstraints(a,b,c,d)};
ol.interaction.Interaction.rotateWithoutConstraints=function(a,b,c,d){if(void 0!==b){var e=a.getRotation(),f=a.getCenter();void 0!==e&&f&&0<d?a.animate({rotation:b,anchor:c,duration:d,easing:ol.easing.easeOut}):a.rotate(b,c)}};ol.interaction.Interaction.zoom=function(a,b,c,d,e){b=a.constrainResolution(b,0,e);ol.interaction.Interaction.zoomWithoutConstraints(a,b,c,d)};
ol.interaction.Interaction.zoomByDelta=function(a,b,c,d){var e=a.getResolution();b=a.constrainResolution(e,b,0);if(c&&void 0!==b&&b!==e){var f=a.getCenter();c=a.calculateCenterZoom(b,c);c=a.constrainCenter(c);c=[(b*f[0]-e*c[0])/(b-e),(b*f[1]-e*c[1])/(b-e)]}ol.interaction.Interaction.zoomWithoutConstraints(a,b,c,d)};
ol.interaction.Interaction.zoomWithoutConstraints=function(a,b,c,d){if(b){var e=a.getResolution(),f=a.getCenter();void 0!==e&&f&&b!==e&&d?a.animate({resolution:b,anchor:c,duration:d,easing:ol.easing.easeOut}):(c&&(c=a.calculateCenterZoom(b,c),a.setCenter(c)),a.setResolution(b))}};ol.interaction.DoubleClickZoom=function(a){a=a?a:{};this.delta_=a.delta?a.delta:1;ol.interaction.Interaction.call(this,{handleEvent:ol.interaction.DoubleClickZoom.handleEvent});this.duration_=void 0!==a.duration?a.duration:250};ol.inherits(ol.interaction.DoubleClickZoom,ol.interaction.Interaction);
ol.interaction.DoubleClickZoom.handleEvent=function(a){var b=!1,c=a.originalEvent;if(a.type==ol.MapBrowserEventType.DBLCLICK){b=a.coordinate;c=c.shiftKey?-this.delta_:this.delta_;var d=a.map.getView();ol.interaction.Interaction.zoomByDelta(d,c,b,this.duration_);a.preventDefault();b=!0}return!b};ol.events.condition={};ol.events.condition.altKeyOnly=function(a){a=a.originalEvent;return a.altKey&&!(a.metaKey||a.ctrlKey)&&!a.shiftKey};ol.events.condition.altShiftKeysOnly=function(a){a=a.originalEvent;return a.altKey&&!(a.metaKey||a.ctrlKey)&&a.shiftKey};ol.events.condition.always=ol.functions.TRUE;ol.events.condition.click=function(a){return a.type==ol.MapBrowserEventType.CLICK};
ol.events.condition.mouseActionButton=function(a){a=a.originalEvent;return 0==a.button&&!(ol.has.WEBKIT&&ol.has.MAC&&a.ctrlKey)};ol.events.condition.never=ol.functions.FALSE;ol.events.condition.pointerMove=function(a){return"pointermove"==a.type};ol.events.condition.singleClick=function(a){return a.type==ol.MapBrowserEventType.SINGLECLICK};ol.events.condition.doubleClick=function(a){return a.type==ol.MapBrowserEventType.DBLCLICK};
ol.events.condition.noModifierKeys=function(a){a=a.originalEvent;return!a.altKey&&!(a.metaKey||a.ctrlKey)&&!a.shiftKey};ol.events.condition.platformModifierKeyOnly=function(a){a=a.originalEvent;return!a.altKey&&(ol.has.MAC?a.metaKey:a.ctrlKey)&&!a.shiftKey};ol.events.condition.shiftKeyOnly=function(a){a=a.originalEvent;return!a.altKey&&!(a.metaKey||a.ctrlKey)&&a.shiftKey};
ol.events.condition.targetNotEditable=function(a){a=a.originalEvent.target.tagName;return"INPUT"!==a&&"SELECT"!==a&&"TEXTAREA"!==a};ol.events.condition.mouseOnly=function(a){ol.asserts.assert(a.pointerEvent,56);return"mouse"==a.pointerEvent.pointerType};ol.events.condition.primaryAction=function(a){a=a.pointerEvent;return a.isPrimary&&0===a.button};ol.interaction.Pointer=function(a){a=a?a:{};ol.interaction.Interaction.call(this,{handleEvent:a.handleEvent?a.handleEvent:ol.interaction.Pointer.handleEvent});this.handleDownEvent_=a.handleDownEvent?a.handleDownEvent:ol.interaction.Pointer.handleDownEvent;this.handleDragEvent_=a.handleDragEvent?a.handleDragEvent:ol.interaction.Pointer.handleDragEvent;this.handleMoveEvent_=a.handleMoveEvent?a.handleMoveEvent:ol.interaction.Pointer.handleMoveEvent;this.handleUpEvent_=a.handleUpEvent?a.handleUpEvent:
ol.interaction.Pointer.handleUpEvent;this.handlingDownUpSequence=!1;this.trackedPointers_={};this.targetPointers=[]};ol.inherits(ol.interaction.Pointer,ol.interaction.Interaction);ol.interaction.Pointer.centroid=function(a){for(var b=a.length,c=0,d=0,e=0;e<b;e++)c+=a[e].clientX,d+=a[e].clientY;return[c/b,d/b]};ol.interaction.Pointer.prototype.isPointerDraggingEvent_=function(a){a=a.type;return a===ol.MapBrowserEventType.POINTERDOWN||a===ol.MapBrowserEventType.POINTERDRAG||a===ol.MapBrowserEventType.POINTERUP};
ol.interaction.Pointer.prototype.updateTrackedPointers_=function(a){if(this.isPointerDraggingEvent_(a)){var b=a.pointerEvent,c=b.pointerId.toString();a.type==ol.MapBrowserEventType.POINTERUP?delete this.trackedPointers_[c]:a.type==ol.MapBrowserEventType.POINTERDOWN?this.trackedPointers_[c]=b:c in this.trackedPointers_&&(this.trackedPointers_[c]=b);this.targetPointers=ol.obj.getValues(this.trackedPointers_)}};ol.interaction.Pointer.handleDragEvent=ol.nullFunction;
ol.interaction.Pointer.handleUpEvent=ol.functions.FALSE;ol.interaction.Pointer.handleDownEvent=ol.functions.FALSE;ol.interaction.Pointer.handleMoveEvent=ol.nullFunction;
ol.interaction.Pointer.handleEvent=function(a){if(!(a instanceof ol.MapBrowserPointerEvent))return!0;var b=!1;this.updateTrackedPointers_(a);this.handlingDownUpSequence?a.type==ol.MapBrowserEventType.POINTERDRAG?this.handleDragEvent_(a):a.type==ol.MapBrowserEventType.POINTERUP&&(this.handlingDownUpSequence=this.handleUpEvent_(a)&&0<this.targetPointers.length):a.type==ol.MapBrowserEventType.POINTERDOWN?(this.handlingDownUpSequence=a=this.handleDownEvent_(a),b=this.shouldStopEvent(a)):a.type==ol.MapBrowserEventType.POINTERMOVE&&
this.handleMoveEvent_(a);return!b};ol.interaction.Pointer.prototype.shouldStopEvent=function(a){return a};ol.interaction.DragPan=function(a){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.DragPan.handleDownEvent_,handleDragEvent:ol.interaction.DragPan.handleDragEvent_,handleUpEvent:ol.interaction.DragPan.handleUpEvent_});a=a?a:{};this.kinetic_=a.kinetic;this.lastCentroid=null;this.condition_=a.condition?a.condition:ol.events.condition.noModifierKeys;this.noKinetic_=!1};ol.inherits(ol.interaction.DragPan,ol.interaction.Pointer);
ol.interaction.DragPan.handleDragEvent_=function(a){var b=this.targetPointers,c=ol.interaction.Pointer.centroid(b);if(b.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(c[0],c[1]),this.lastCentroid){var d=this.lastCentroid[0]-c[0],e=c[1]-this.lastCentroid[1];a=a.map.getView();var f=a.getState();d=[d,e];ol.coordinate.scale(d,f.resolution);ol.coordinate.rotate(d,f.rotation);ol.coordinate.add(d,f.center);d=a.constrainCenter(d);a.setCenter(d)}}else this.kinetic_&&this.kinetic_.begin();
this.lastCentroid=c;this.lastPointersCount_=b.length};
ol.interaction.DragPan.handleUpEvent_=function(a){var b=a.map;a=b.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var c=this.kinetic_.getDistance(),d=this.kinetic_.getAngle(),e=a.getCenter();e=b.getPixelFromCoordinate(e);b=b.getCoordinateFromPixel([e[0]-c*Math.cos(d),e[1]-c*Math.sin(d)]);a.animate({center:a.constrainCenter(b),duration:500,easing:ol.easing.easeOut})}a.setHint(ol.ViewHint.INTERACTING,-1);return!1}this.kinetic_&&this.kinetic_.begin();
this.lastCentroid=null;return!0};ol.interaction.DragPan.handleDownEvent_=function(a){if(0<this.targetPointers.length&&this.condition_(a)){var b=a.map.getView();this.lastCentroid=null;this.handlingDownUpSequence||b.setHint(ol.ViewHint.INTERACTING,1);b.getAnimating()&&b.setCenter(a.frameState.viewState.center);this.kinetic_&&this.kinetic_.begin();this.noKinetic_=1<this.targetPointers.length;return!0}return!1};ol.interaction.DragPan.prototype.shouldStopEvent=ol.functions.FALSE;ol.interaction.DragRotate=function(a){a=a?a:{};ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.DragRotate.handleDownEvent_,handleDragEvent:ol.interaction.DragRotate.handleDragEvent_,handleUpEvent:ol.interaction.DragRotate.handleUpEvent_});this.condition_=a.condition?a.condition:ol.events.condition.altShiftKeysOnly;this.lastAngle_=void 0;this.duration_=void 0!==a.duration?a.duration:250};ol.inherits(ol.interaction.DragRotate,ol.interaction.Pointer);
ol.interaction.DragRotate.handleDragEvent_=function(a){if(ol.events.condition.mouseOnly(a)){var b=a.map,c=b.getView();if(c.getConstraints().rotation!==ol.RotationConstraint.disable){b=b.getSize();a=a.pixel;a=Math.atan2(b[1]/2-a[1],a[0]-b[0]/2);if(void 0!==this.lastAngle_){b=a-this.lastAngle_;var d=c.getRotation();ol.interaction.Interaction.rotateWithoutConstraints(c,d-b)}this.lastAngle_=a}}};
ol.interaction.DragRotate.handleUpEvent_=function(a){if(!ol.events.condition.mouseOnly(a))return!0;a=a.map.getView();a.setHint(ol.ViewHint.INTERACTING,-1);var b=a.getRotation();ol.interaction.Interaction.rotate(a,b,void 0,this.duration_);return!1};ol.interaction.DragRotate.handleDownEvent_=function(a){return ol.events.condition.mouseOnly(a)&&ol.events.condition.mouseActionButton(a)&&this.condition_(a)?(a.map.getView().setHint(ol.ViewHint.INTERACTING,1),this.lastAngle_=void 0,!0):!1};
ol.interaction.DragRotate.prototype.shouldStopEvent=ol.functions.FALSE;ol.render.Box=function(a){this.geometry_=null;this.element_=document.createElement("div");this.element_.style.position="absolute";this.element_.className="ol-box "+a;this.endPixel_=this.startPixel_=this.map_=null};ol.inherits(ol.render.Box,ol.Disposable);ol.render.Box.prototype.disposeInternal=function(){this.setMap(null)};
ol.render.Box.prototype.render_=function(){var a=this.startPixel_,b=this.endPixel_,c=this.element_.style;c.left=Math.min(a[0],b[0])+"px";c.top=Math.min(a[1],b[1])+"px";c.width=Math.abs(b[0]-a[0])+"px";c.height=Math.abs(b[1]-a[1])+"px"};ol.render.Box.prototype.setMap=function(a){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var b=this.element_.style;b.left=b.top=b.width=b.height="inherit"}(this.map_=a)&&this.map_.getOverlayContainer().appendChild(this.element_)};
ol.render.Box.prototype.setPixels=function(a,b){this.startPixel_=a;this.endPixel_=b;this.createOrUpdateGeometry();this.render_()};ol.render.Box.prototype.createOrUpdateGeometry=function(){var a=this.startPixel_,b=this.endPixel_;a=[a,[a[0],b[1]],b,[b[0],a[1]]].map(this.map_.getCoordinateFromPixel,this.map_);a[4]=a[0].slice();this.geometry_?this.geometry_.setCoordinates([a]):this.geometry_=new ol.geom.Polygon([a])};ol.render.Box.prototype.getGeometry=function(){return this.geometry_};ol.interaction.DragBox=function(a){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.DragBox.handleDownEvent_,handleDragEvent:ol.interaction.DragBox.handleDragEvent_,handleUpEvent:ol.interaction.DragBox.handleUpEvent_});a=a?a:{};this.box_=new ol.render.Box(a.className||"ol-dragbox");this.minArea_=void 0!==a.minArea?a.minArea:64;this.startPixel_=null;this.condition_=a.condition?a.condition:ol.events.condition.always;this.boxEndCondition_=a.boxEndCondition?a.boxEndCondition:ol.interaction.DragBox.defaultBoxEndCondition};
ol.inherits(ol.interaction.DragBox,ol.interaction.Pointer);ol.interaction.DragBox.defaultBoxEndCondition=function(a,b,c){a=c[0]-b[0];b=c[1]-b[1];return a*a+b*b>=this.minArea_};ol.interaction.DragBox.handleDragEvent_=function(a){ol.events.condition.mouseOnly(a)&&(this.box_.setPixels(this.startPixel_,a.pixel),this.dispatchEvent(new ol.interaction.DragBox.Event(ol.interaction.DragBox.EventType_.BOXDRAG,a.coordinate,a)))};ol.interaction.DragBox.prototype.getGeometry=function(){return this.box_.getGeometry()};
ol.interaction.DragBox.prototype.onBoxEnd=ol.nullFunction;ol.interaction.DragBox.handleUpEvent_=function(a){if(!ol.events.condition.mouseOnly(a))return!0;this.box_.setMap(null);this.boxEndCondition_(a,this.startPixel_,a.pixel)&&(this.onBoxEnd(a),this.dispatchEvent(new ol.interaction.DragBox.Event(ol.interaction.DragBox.EventType_.BOXEND,a.coordinate,a)));return!1};
ol.interaction.DragBox.handleDownEvent_=function(a){return ol.events.condition.mouseOnly(a)&&ol.events.condition.mouseActionButton(a)&&this.condition_(a)?(this.startPixel_=a.pixel,this.box_.setMap(a.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ol.interaction.DragBox.Event(ol.interaction.DragBox.EventType_.BOXSTART,a.coordinate,a)),!0):!1};ol.interaction.DragBox.EventType_={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"};
ol.interaction.DragBox.Event=function(a,b,c){ol.events.Event.call(this,a);this.coordinate=b;this.mapBrowserEvent=c};ol.inherits(ol.interaction.DragBox.Event,ol.events.Event);ol.interaction.DragZoom=function(a){a=a?a:{};var b=a.condition?a.condition:ol.events.condition.shiftKeyOnly;this.duration_=void 0!==a.duration?a.duration:200;this.out_=void 0!==a.out?a.out:!1;ol.interaction.DragBox.call(this,{condition:b,className:a.className||"ol-dragzoom"})};ol.inherits(ol.interaction.DragZoom,ol.interaction.DragBox);
ol.interaction.DragZoom.prototype.onBoxEnd=function(){var a=this.getMap(),b=a.getView(),c=a.getSize(),d=this.getGeometry().getExtent();if(this.out_){var e=b.calculateExtent(c);d=ol.extent.createOrUpdateFromCoordinates([a.getPixelFromCoordinate(ol.extent.getBottomLeft(d)),a.getPixelFromCoordinate(ol.extent.getTopRight(d))]);d=b.getResolutionForExtent(d,c);ol.extent.scaleFromCenter(e,1/d);d=e}c=b.constrainResolution(b.getResolutionForExtent(d,c));e=ol.extent.getCenter(d);e=b.constrainCenter(e);b.animate({resolution:c,
center:e,duration:this.duration_,easing:ol.easing.easeOut})};ol.events.KeyCode={LEFT:37,UP:38,RIGHT:39,DOWN:40};ol.interaction.KeyboardPan=function(a){ol.interaction.Interaction.call(this,{handleEvent:ol.interaction.KeyboardPan.handleEvent});a=a||{};this.defaultCondition_=function(a){return ol.events.condition.noModifierKeys(a)&&ol.events.condition.targetNotEditable(a)};this.condition_=void 0!==a.condition?a.condition:this.defaultCondition_;this.duration_=void 0!==a.duration?a.duration:100;this.pixelDelta_=void 0!==a.pixelDelta?a.pixelDelta:128};ol.inherits(ol.interaction.KeyboardPan,ol.interaction.Interaction);
ol.interaction.KeyboardPan.handleEvent=function(a){var b=!1;if(a.type==ol.events.EventType.KEYDOWN){var c=a.originalEvent.keyCode;if(this.condition_(a)&&(c==ol.events.KeyCode.DOWN||c==ol.events.KeyCode.LEFT||c==ol.events.KeyCode.RIGHT||c==ol.events.KeyCode.UP)){b=a.map.getView();var d=b.getResolution()*this.pixelDelta_,e=0,f=0;c==ol.events.KeyCode.DOWN?f=-d:c==ol.events.KeyCode.LEFT?e=-d:c==ol.events.KeyCode.RIGHT?e=d:f=d;c=[e,f];ol.coordinate.rotate(c,b.getRotation());ol.interaction.Interaction.pan(b,
c,this.duration_);a.preventDefault();b=!0}}return!b};ol.interaction.KeyboardZoom=function(a){ol.interaction.Interaction.call(this,{handleEvent:ol.interaction.KeyboardZoom.handleEvent});a=a?a:{};this.condition_=a.condition?a.condition:ol.events.condition.targetNotEditable;this.delta_=a.delta?a.delta:1;this.duration_=void 0!==a.duration?a.duration:100};ol.inherits(ol.interaction.KeyboardZoom,ol.interaction.Interaction);
ol.interaction.KeyboardZoom.handleEvent=function(a){var b=!1;if(a.type==ol.events.EventType.KEYDOWN||a.type==ol.events.EventType.KEYPRESS){var c=a.originalEvent.charCode;!this.condition_(a)||43!=c&&45!=c||(b=43==c?this.delta_:-this.delta_,c=a.map.getView(),ol.interaction.Interaction.zoomByDelta(c,b,void 0,this.duration_),a.preventDefault(),b=!0)}return!b};ol.interaction.MouseWheelZoom=function(a){ol.interaction.Interaction.call(this,{handleEvent:ol.interaction.MouseWheelZoom.handleEvent});a=a||{};this.delta_=0;this.duration_=void 0!==a.duration?a.duration:250;this.timeout_=void 0!==a.timeout?a.timeout:80;this.useAnchor_=void 0!==a.useAnchor?a.useAnchor:!0;this.constrainResolution_=a.constrainResolution||!1;this.lastAnchor_=null;this.mode_=this.timeoutId_=this.startTime_=void 0;this.trackpadEventGap_=400;this.trackpadTimeoutId_=void 0;this.trackpadDeltaPerZoom_=
300;this.trackpadZoomBuffer_=1.5};ol.inherits(ol.interaction.MouseWheelZoom,ol.interaction.Interaction);
ol.interaction.MouseWheelZoom.handleEvent=function(a){var b=a.type;if(b!==ol.events.EventType.WHEEL&&b!==ol.events.EventType.MOUSEWHEEL)return!0;a.preventDefault();b=a.map;var c=a.originalEvent;this.useAnchor_&&(this.lastAnchor_=a.coordinate);if(a.type==ol.events.EventType.WHEEL){var d=c.deltaY;ol.has.FIREFOX&&c.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(d/=ol.has.DEVICE_PIXEL_RATIO);c.deltaMode===WheelEvent.DOM_DELTA_LINE&&(d*=40)}else a.type==ol.events.EventType.MOUSEWHEEL&&(d=-c.wheelDeltaY,ol.has.SAFARI&&
(d/=3));if(0===d)return!1;a=Date.now();void 0===this.startTime_&&(this.startTime_=a);if(!this.mode_||a-this.startTime_>this.trackpadEventGap_)this.mode_=4>Math.abs(d)?ol.interaction.MouseWheelZoom.Mode_.TRACKPAD:ol.interaction.MouseWheelZoom.Mode_.WHEEL;if(this.mode_===ol.interaction.MouseWheelZoom.Mode_.TRACKPAD){b=b.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):b.setHint(ol.ViewHint.INTERACTING,1);this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),
this.trackpadEventGap_);c=b.getResolution()*Math.pow(2,d/this.trackpadDeltaPerZoom_);var e=b.getMinResolution(),f=b.getMaxResolution(),g=0;c<e?(c=Math.max(c,e/this.trackpadZoomBuffer_),g=1):c>f&&(c=Math.min(c,f*this.trackpadZoomBuffer_),g=-1);if(this.lastAnchor_){var h=b.calculateCenterZoom(c,this.lastAnchor_);b.setCenter(b.constrainCenter(h))}b.setResolution(c);0===g&&this.constrainResolution_&&b.animate({resolution:b.constrainResolution(c,0<d?-1:1),easing:ol.easing.easeOut,anchor:this.lastAnchor_,
duration:this.duration_});0<g?b.animate({resolution:e,easing:ol.easing.easeOut,anchor:this.lastAnchor_,duration:500}):0>g&&b.animate({resolution:f,easing:ol.easing.easeOut,anchor:this.lastAnchor_,duration:500});this.startTime_=a;return!1}this.delta_+=d;d=Math.max(this.timeout_-(a-this.startTime_),0);clearTimeout(this.timeoutId_);this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,b),d);return!1};
ol.interaction.MouseWheelZoom.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0;this.getMap().getView().setHint(ol.ViewHint.INTERACTING,-1)};
ol.interaction.MouseWheelZoom.prototype.handleWheelZoom_=function(a){a=a.getView();a.getAnimating()&&a.cancelAnimations();var b=ol.MOUSEWHEELZOOM_MAXDELTA;b=ol.math.clamp(this.delta_,-b,b);ol.interaction.Interaction.zoomByDelta(a,-b,this.lastAnchor_,this.duration_);this.mode_=void 0;this.delta_=0;this.lastAnchor_=null;this.timeoutId_=this.startTime_=void 0};ol.interaction.MouseWheelZoom.prototype.setMouseAnchor=function(a){this.useAnchor_=a;a||(this.lastAnchor_=null)};
ol.interaction.MouseWheelZoom.Mode_={TRACKPAD:"trackpad",WHEEL:"wheel"};ol.interaction.PinchRotate=function(a){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.PinchRotate.handleDownEvent_,handleDragEvent:ol.interaction.PinchRotate.handleDragEvent_,handleUpEvent:ol.interaction.PinchRotate.handleUpEvent_});a=a||{};this.anchor_=null;this.lastAngle_=void 0;this.rotating_=!1;this.rotationDelta_=0;this.threshold_=void 0!==a.threshold?a.threshold:.3;this.duration_=void 0!==a.duration?a.duration:250};ol.inherits(ol.interaction.PinchRotate,ol.interaction.Pointer);
ol.interaction.PinchRotate.handleDragEvent_=function(a){var b=0,c=this.targetPointers[0],d=this.targetPointers[1];c=Math.atan2(d.clientY-c.clientY,d.clientX-c.clientX);void 0!==this.lastAngle_&&(b=c-this.lastAngle_,this.rotationDelta_+=b,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0));this.lastAngle_=c;a=a.map;c=a.getView();if(c.getConstraints().rotation!==ol.RotationConstraint.disable){d=a.getViewport().getBoundingClientRect();var e=ol.interaction.Pointer.centroid(this.targetPointers);
e[0]-=d.left;e[1]-=d.top;this.anchor_=a.getCoordinateFromPixel(e);this.rotating_&&(d=c.getRotation(),a.render(),ol.interaction.Interaction.rotateWithoutConstraints(c,d+b,this.anchor_))}};ol.interaction.PinchRotate.handleUpEvent_=function(a){if(2>this.targetPointers.length){a=a.map.getView();a.setHint(ol.ViewHint.INTERACTING,-1);if(this.rotating_){var b=a.getRotation();ol.interaction.Interaction.rotate(a,b,this.anchor_,this.duration_)}return!1}return!0};
ol.interaction.PinchRotate.handleDownEvent_=function(a){return 2<=this.targetPointers.length?(a=a.map,this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||a.getView().setHint(ol.ViewHint.INTERACTING,1),!0):!1};ol.interaction.PinchRotate.prototype.shouldStopEvent=ol.functions.FALSE;ol.interaction.PinchZoom=function(a){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.PinchZoom.handleDownEvent_,handleDragEvent:ol.interaction.PinchZoom.handleDragEvent_,handleUpEvent:ol.interaction.PinchZoom.handleUpEvent_});a=a?a:{};this.constrainResolution_=a.constrainResolution||!1;this.anchor_=null;this.duration_=void 0!==a.duration?a.duration:400;this.lastDistance_=void 0;this.lastScaleDelta_=1};ol.inherits(ol.interaction.PinchZoom,ol.interaction.Pointer);
ol.interaction.PinchZoom.handleDragEvent_=function(a){var b=1,c=this.targetPointers[0],d=this.targetPointers[1],e=c.clientX-d.clientX;c=c.clientY-d.clientY;e=Math.sqrt(e*e+c*c);void 0!==this.lastDistance_&&(b=this.lastDistance_/e);this.lastDistance_=e;a=a.map;e=a.getView();d=e.getResolution();var f=e.getMaxResolution(),g=e.getMinResolution();c=d*b;c>f?(b=f/d,c=f):c<g&&(b=g/d,c=g);1!=b&&(this.lastScaleDelta_=b);b=a.getViewport().getBoundingClientRect();d=ol.interaction.Pointer.centroid(this.targetPointers);
d[0]-=b.left;d[1]-=b.top;this.anchor_=a.getCoordinateFromPixel(d);a.render();ol.interaction.Interaction.zoomWithoutConstraints(e,c,this.anchor_)};ol.interaction.PinchZoom.handleUpEvent_=function(a){if(2>this.targetPointers.length){a=a.map.getView();a.setHint(ol.ViewHint.INTERACTING,-1);var b=a.getResolution();(this.constrainResolution_||b<a.getMinResolution()||b>a.getMaxResolution())&&ol.interaction.Interaction.zoom(a,b,this.anchor_,this.duration_,this.lastScaleDelta_-1);return!1}return!0};
ol.interaction.PinchZoom.handleDownEvent_=function(a){return 2<=this.targetPointers.length?(a=a.map,this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||a.getView().setHint(ol.ViewHint.INTERACTING,1),!0):!1};ol.interaction.PinchZoom.prototype.shouldStopEvent=ol.functions.FALSE;ol.interaction.defaults=function(a){a=a?a:{};var b=new ol.Collection,c=new ol.Kinetic(-.005,.05,100);(void 0!==a.altShiftDragRotate?a.altShiftDragRotate:1)&&b.push(new ol.interaction.DragRotate);(void 0!==a.doubleClickZoom?a.doubleClickZoom:1)&&b.push(new ol.interaction.DoubleClickZoom({delta:a.zoomDelta,duration:a.zoomDuration}));(void 0!==a.dragPan?a.dragPan:1)&&b.push(new ol.interaction.DragPan({kinetic:c}));(void 0!==a.pinchRotate?a.pinchRotate:1)&&b.push(new ol.interaction.PinchRotate);(void 0!==
a.pinchZoom?a.pinchZoom:1)&&b.push(new ol.interaction.PinchZoom({constrainResolution:a.constrainResolution,duration:a.zoomDuration}));if(void 0!==a.keyboard?a.keyboard:1)b.push(new ol.interaction.KeyboardPan),b.push(new ol.interaction.KeyboardZoom({delta:a.zoomDelta,duration:a.zoomDuration}));(void 0!==a.mouseWheelZoom?a.mouseWheelZoom:1)&&b.push(new ol.interaction.MouseWheelZoom({constrainResolution:a.constrainResolution,duration:a.zoomDuration}));(void 0!==a.shiftDragZoom?a.shiftDragZoom:1)&&b.push(new ol.interaction.DragZoom({duration:a.zoomDuration}));
return b};ol.renderer.Map=function(a,b){ol.Disposable.call(this);this.map_=b;this.layerRenderers_={};this.layerRendererListeners_={}};ol.inherits(ol.renderer.Map,ol.Disposable);ol.renderer.Map.prototype.calculateMatrices2D=function(a){var b=a.viewState,c=a.coordinateToPixelTransform,d=a.pixelToCoordinateTransform;ol.transform.compose(c,a.size[0]/2,a.size[1]/2,1/b.resolution,-1/b.resolution,-b.rotation,-b.center[0],-b.center[1]);ol.transform.invert(ol.transform.setFromArray(d,c))};
ol.renderer.Map.prototype.disposeInternal=function(){for(var a in this.layerRenderers_)this.layerRenderers_[a].dispose()};ol.renderer.Map.expireIconCache_=function(a,b){ol.style.iconImageCache.expire()};
ol.renderer.Map.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,f,g){function h(a,c){var f=ol.getUid(a).toString(),g=b.layerStates[ol.getUid(c)].managed;if(!(f in b.skippedFeatureUids)||g)return d.call(e,a,g?c:null)}var k,l=b.viewState,m=l.resolution,n=l.projection;l=a;if(n.canWrapX()){n=n.getExtent();var p=ol.extent.getWidth(n),q=a[0];if(q<n[0]||q>n[2])l=[q+p*Math.ceil((n[0]-q)/p),a[1]]}n=b.layerStatesArray;for(p=n.length-1;0<=p;--p){var r=n[p];q=r.layer;if(ol.layer.Layer.visibleAtResolution(r,
m)&&f.call(g,q)&&(r=this.getLayerRenderer(q),q.getSource()&&(k=r.forEachFeatureAtCoordinate(q.getSource().getWrapX()?l:a,b,c,h,e)),k))return k}};ol.renderer.Map.prototype.forEachLayerAtPixel=function(a,b,c,d,e,f){};ol.renderer.Map.prototype.hasFeatureAtCoordinate=function(a,b,c,d,e){return void 0!==this.forEachFeatureAtCoordinate(a,b,c,ol.functions.TRUE,this,d,e)};
ol.renderer.Map.prototype.getLayerRenderer=function(a){var b=ol.getUid(a).toString();if(b in this.layerRenderers_)return this.layerRenderers_[b];for(var c=ol.plugins.getLayerRendererPlugins(),d,e=this.getType(),f=0,g=c.length;f<g;++f){var h=c[f];if(h.handles(e,a)){d=h.create(this,a);break}}if(d)this.layerRenderers_[b]=d,this.layerRendererListeners_[b]=ol.events.listen(d,ol.events.EventType.CHANGE,this.handleLayerRendererChange_,this);else throw Error("Unable to create renderer for layer: "+a.getType());
return d};ol.renderer.Map.prototype.getLayerRendererByKey=function(a){return this.layerRenderers_[a]};ol.renderer.Map.prototype.getLayerRenderers=function(){return this.layerRenderers_};ol.renderer.Map.prototype.getMap=function(){return this.map_};ol.renderer.Map.prototype.getType=function(){};ol.renderer.Map.prototype.handleLayerRendererChange_=function(){this.map_.render()};
ol.renderer.Map.prototype.removeLayerRendererByKey_=function(a){var b=this.layerRenderers_[a];delete this.layerRenderers_[a];ol.events.unlistenByKey(this.layerRendererListeners_[a]);delete this.layerRendererListeners_[a];return b};ol.renderer.Map.prototype.renderFrame=ol.nullFunction;ol.renderer.Map.prototype.removeUnusedLayerRenderers_=function(a,b){for(var c in this.layerRenderers_)b&&c in b.layerStates||this.removeLayerRendererByKey_(c).dispose()};
ol.renderer.Map.prototype.scheduleExpireIconCache=function(a){a.postRenderFunctions.push(ol.renderer.Map.expireIconCache_)};ol.renderer.Map.prototype.scheduleRemoveUnusedLayerRenderers=function(a){for(var b in this.layerRenderers_)if(!(b in a.layerStates)){a.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this));break}};ol.renderer.Map.sortByZIndex=function(a,b){return a.zIndex-b.zIndex};ol.renderer.canvas.Map=function(a,b){ol.renderer.Map.call(this,a,b);this.context_=ol.dom.createCanvasContext2D();this.canvas_=this.context_.canvas;this.canvas_.style.width="100%";this.canvas_.style.height="100%";this.canvas_.style.display="block";this.canvas_.className=ol.css.CLASS_UNSELECTABLE;a.insertBefore(this.canvas_,a.childNodes[0]||null);this.renderedVisible_=!0;this.transform_=ol.transform.create()};ol.inherits(ol.renderer.canvas.Map,ol.renderer.Map);
ol.renderer.canvas.Map.handles=function(a){return a===ol.renderer.Type.CANVAS};ol.renderer.canvas.Map.create=function(a,b){return new ol.renderer.canvas.Map(a,b)};ol.renderer.canvas.Map.prototype.dispatchComposeEvent_=function(a,b){var c=this.getMap(),d=this.context_;if(c.hasListener(a)){var e=b.extent,f=b.pixelRatio,g=b.viewState.rotation,h=this.getTransform(b);e=new ol.render.canvas.Immediate(d,f,e,h,g);a=new ol.render.Event(a,e,b,d,null);c.dispatchEvent(a)}};
ol.renderer.canvas.Map.prototype.getTransform=function(a){var b=a.viewState;a=a.pixelRatio/b.resolution;return ol.transform.compose(this.transform_,this.canvas_.width/2,this.canvas_.height/2,a,-a,-b.rotation,-b.center[0],-b.center[1])};ol.renderer.canvas.Map.prototype.getType=function(){return ol.renderer.Type.CANVAS};
ol.renderer.canvas.Map.prototype.renderFrame=function(a){if(a){var b=this.context_,c=a.pixelRatio,d=Math.round(a.size[0]*c),e=Math.round(a.size[1]*c);this.canvas_.width!=d||this.canvas_.height!=e?(this.canvas_.width=d,this.canvas_.height=e):b.clearRect(0,0,d,e);c=a.viewState.rotation;this.calculateMatrices2D(a);this.dispatchComposeEvent_(ol.render.EventType.PRECOMPOSE,a);var f=a.layerStatesArray;ol.array.stableSort(f,ol.renderer.Map.sortByZIndex);c&&(b.save(),ol.render.canvas.rotateAtOffset(b,c,d/
2,e/2));d=a.viewState.resolution;var g;e=0;for(g=f.length;e<g;++e){var h=f[e];var k=h.layer;k=this.getLayerRenderer(k);ol.layer.Layer.visibleAtResolution(h,d)&&h.sourceState==ol.source.State.READY&&k.prepareFrame(a,h)&&k.composeFrame(a,h,b)}c&&b.restore();this.dispatchComposeEvent_(ol.render.EventType.POSTCOMPOSE,a);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0);this.scheduleRemoveUnusedLayerRenderers(a);this.scheduleExpireIconCache(a)}else this.renderedVisible_&&
(this.canvas_.style.display="none",this.renderedVisible_=!1)};ol.renderer.canvas.Map.prototype.forEachLayerAtPixel=function(a,b,c,d,e,f){var g=b.viewState.resolution,h=b.layerStatesArray,k=h.length;a=ol.transform.apply(b.pixelToCoordinateTransform,a.slice());for(--k;0<=k;--k){var l=h[k];var m=l.layer;if(ol.layer.Layer.visibleAtResolution(l,g)&&e.call(f,m)&&(l=this.getLayerRenderer(m).forEachLayerAtCoordinate(a,b,c,d)))return l}};ol.ext.rbush=function(){};
(function(){(function(a){function b(a,c){if(!(this instanceof b))return new b(a,c);this._maxEntries=Math.max(4,a||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&this._initFormat(c);this.clear()}function c(a,b){d(a,0,a.children.length,b,a)}function d(a,b,c,d,f){f||(f=n(null));f.minX=Infinity;f.minY=Infinity;f.maxX=-Infinity;f.maxY=-Infinity;for(var g;b<c;b++)g=a.children[b],e(f,a.leaf?d(g):g);return f}function e(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=Math.min(a.minY,b.minY);
a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function f(a,b){return a.minX-b.minX}function g(a,b){return a.minY-b.minY}function h(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function k(a){return a.maxX-a.minX+(a.maxY-a.minY)}function l(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function m(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function n(a){return{children:a,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,
maxY:-Infinity}}function p(a,b,c,d,e){for(var f=[b,c],g;f.length;)c=f.pop(),b=f.pop(),c-b<=d||(g=b+Math.ceil((c-b)/d/2)*d,r(a,g,b,c,e),f.push(b,g,g,c))}var q="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},r=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a,b){(function(b,c){a.exports=c()})(q,function(){function a(c,d,e,f,g){for(;f>e;){if(600<f-e){var h=f-e+1,k=d-e+1,l=Math.log(h),m=.5*Math.exp(2*l/3);l=.5*Math.sqrt(l*
m*(h-m)/h)*(0>k-h/2?-1:1);a(c,d,Math.max(e,Math.floor(d-k*m/h+l)),Math.min(f,Math.floor(d+(h-k)*m/h+l)),g)}h=c[d];k=e;m=f;b(c,e,d);for(0<g(c[f],h)&&b(c,e,f);k<m;){b(c,k,m);k++;for(m--;0>g(c[k],h);)k++;for(;0<g(c[m],h);)m--}0===g(c[e],h)?b(c,e,m):(m++,b(c,m,f));m<=d&&(e=m+1);d<=m&&(f=m-1)}}function b(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}function c(a,b){return a<b?-1:a>b?1:0}return function(b,d,e,f,g){a(b,d,e||0,f||b.length-1,g||c)}})});b.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=
this.data,c=[],d=this.toBBox;if(!m(a,b))return c;for(var e=[],f,g,h,k;b;){f=0;for(g=b.children.length;f<g;f++)h=b.children[f],k=b.leaf?d(h):h,m(a,k)&&(b.leaf?c.push(h):l(a,k)?this._all(h,c):e.push(h));b=e.pop()}return c},collides:function(a){var b=this.data,c=this.toBBox;if(!m(a,b))return!1;for(var d=[],e,f,g,h;b;){e=0;for(f=b.children.length;e<f;e++)if(g=b.children[e],h=b.leaf?c(g):g,m(a,h)){if(b.leaf||l(a,h))return!0;d.push(g)}b=d.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<
this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=n([]);return this},remove:function(a,b){if(!a)return this;for(var c=this.data,
d=this.toBBox(a),e=[],f=[],g,h,k,m;c||e.length;){c||(c=e.pop(),h=e[e.length-1],g=f.pop(),m=!0);if(c.leaf){a:{k=a;var n=c.children,p=b;if(p){for(var q=0;q<n.length;q++)if(p(k,n[q])){k=q;break a}k=-1}else k=n.indexOf(k)}if(-1!==k){c.children.splice(k,1);e.push(c);this._condense(e);break}}m||c.leaf||!l(c,d)?h?(g++,c=h.children[g],m=!1):c=null:(e.push(c),f.push(g),g=0,h=c,c=c.children[0])}return this},toBBox:function(a){return a},compareMinX:f,compareMinY:g,toJSON:function(){return this.data},fromJSON:function(a){this.data=
a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,d,e){var f=d-b+1,g=this._maxEntries;if(f<=g){var h=n(a.slice(b,d+1));c(h,this.toBBox);return h}e||(e=Math.ceil(Math.log(f)/Math.log(g)),g=Math.ceil(f/Math.pow(g,e-1)));h=n([]);h.leaf=!1;h.height=e;f=Math.ceil(f/g);g=f*Math.ceil(Math.sqrt(g));var k;for(p(a,b,d,g,this.compareMinX);b<=d;b+=g){var l=Math.min(b+g-1,d);p(a,b,l,f,this.compareMinY);for(k=b;k<=
l;k+=f){var m=Math.min(k+f-1,l);h.children.push(this._build(a,k,m,e-1))}}c(h,this.toBBox);return h},_chooseSubtree:function(a,b,c,d){for(var e,f,g,k,l,m,n,p;;){d.push(b);if(b.leaf||d.length-1===c)break;n=p=Infinity;e=0;for(f=b.children.length;e<f;e++)g=b.children[e],l=h(g),m=(Math.max(g.maxX,a.maxX)-Math.min(g.minX,a.minX))*(Math.max(g.maxY,a.maxY)-Math.min(g.minY,a.minY))-l,m<p?(p=m,n=l<n?l:n,k=g):m===p&&l<n&&(n=l,k=g);b=k||b.children[0]}return b},_insert:function(a,b,c){var d=this.toBBox;c=c?a:
d(a);d=[];var f=this._chooseSubtree(c,this.data,b,d);f.children.push(a);for(e(f,c);0<=b;)if(d[b].children.length>this._maxEntries)this._split(d,b),b--;else break;this._adjustParentBBoxes(c,d,b)},_split:function(a,b){var d=a[b],e=d.children.length,f=this._minEntries;this._chooseSplitAxis(d,f,e);e=this._chooseSplitIndex(d,f,e);e=n(d.children.splice(e,d.children.length-e));e.height=d.height;e.leaf=d.leaf;c(d,this.toBBox);c(e,this.toBBox);b?a[b-1].children.push(e):this._splitRoot(d,e)},_splitRoot:function(a,
b){this.data=n([a,b]);this.data.height=a.height+1;this.data.leaf=!1;c(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var e,f;var g=f=Infinity;for(e=b;e<=c-b;e++){var k=d(a,0,e,this.toBBox);var l=d(a,e,c,this.toBBox);var m=Math.max(0,Math.min(k.maxX,l.maxX)-Math.max(k.minX,l.minX))*Math.max(0,Math.min(k.maxY,l.maxY)-Math.max(k.minY,l.minY));k=h(k)+h(l);if(m<g){g=m;var n=e;f=k<f?k:f}else m===g&&k<f&&(f=k,n=e)}return n},_chooseSplitAxis:function(a,b,c){var d=a.leaf?this.compareMinX:f,e=a.leaf?
this.compareMinY:g,h=this._allDistMargin(a,b,c,d);b=this._allDistMargin(a,b,c,e);h<b&&a.children.sort(d)},_allDistMargin:function(a,b,c,f){a.children.sort(f);f=this.toBBox;var g=d(a,0,b,f),h=d(a,c-b,c,f),l=k(g)+k(h),m;for(m=b;m<c-b;m++){var n=a.children[m];e(g,a.leaf?f(n):n);l+=k(g)}for(m=c-b-1;m>=b;m--)n=a.children[m],e(h,a.leaf?f(n):n),l+=k(h);return l},_adjustParentBBoxes:function(a,b,c){for(;0<=c;c--)e(b[c],a)},_condense:function(a){for(var b=a.length-1,d;0<=b;b--)0===a[b].children.length?0<b?
(d=a[b-1].children,d.splice(d.indexOf(a[b]),1)):this.clear():c(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};a["default"]=b})(this.rbush=this.rbush||{})}).call(ol.ext);ol.ext.rbush=ol.ext.rbush.default;ol.render.ReplayGroup=function(){};ol.render.ReplayGroup.prototype.getReplay=function(a,b){};ol.render.ReplayGroup.prototype.isEmpty=function(){};ol.render.ReplayType={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};ol.geom.flat.textpath={};
ol.geom.flat.textpath.lineString=function(a,b,c,d,e,f,g,h){var k=[],l=a[b]>a[c-d],m=e.length,n=a[b],p=a[b+1];b+=d;for(var q=a[b],r=a[b+1],u=0,v=Math.sqrt(Math.pow(q-n,2)+Math.pow(r-p,2)),t="",w=0,x,z,y,A=0;A<m;++A){z=l?m-A-1:A;z=e.charAt(z);t=l?z+t:t+z;var C=f(t)-w;w+=C;for(var B=g+C/2;b<c-d&&u+v<B;)n=q,p=r,b+=d,q=a[b],r=a[b+1],u+=v,v=Math.sqrt(Math.pow(q-n,2)+Math.pow(r-p,2));var D=B-u;B=Math.atan2(r-p,q-n);l&&(B+=0<B?-Math.PI:Math.PI);if(void 0!==y){var E=B-y;E+=E>Math.PI?-2*Math.PI:E<-Math.PI?
2*Math.PI:0;if(Math.abs(E)>h)return null}E=D/v;D=ol.math.lerp(n,q,E);E=ol.math.lerp(p,r,E);y==B?(l&&(x[0]=D,x[1]=E,x[2]=C/2),x[4]=t):(t=z,w=C,x=[D,E,C/2,B,t],l?k.unshift(x):k.push(x),y=B);g+=C}return k};ol.render.canvas.Instruction={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12};ol.render.canvas.Replay=function(a,b,c,d,e,f){ol.render.VectorContext.call(this);this.declutterTree=f;this.tmpExtent_=ol.extent.createEmpty();this.tolerance=a;this.maxExtent=b;this.overlaps=e;this.pixelRatio=d;this.maxLineWidth=0;this.resolution=c;this.bufferedMaxExtent_=this.beginGeometryInstruction2_=this.beginGeometryInstruction1_=null;this.instructions=[];this.coordinates=[];this.coordinateCache_={};this.renderedTransform_=ol.transform.create();this.hitDetectionInstructions=[];this.pixelCoordinates_=
null;this.state={};this.tmpLocalTransform_=ol.transform.create();this.resetTransform_=ol.transform.create()};ol.inherits(ol.render.canvas.Replay,ol.render.VectorContext);
ol.render.canvas.Replay.prototype.replayImage_=function(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r){var u=this.tmpLocalTransform_;e*=p;f*=p;b-=e;c-=f;q&&(b=Math.round(b),c=Math.round(c));q=r+l>d.width?d.width-l:r;h=h+m>d.height?d.height-m:h;r=this.tmpExtent_;var v=null;0!==n?(e=b+e,f=c+f,v=ol.transform.compose(u,e,f,1,1,n,-e,-f),ol.extent.createOrUpdateEmpty(r),ol.extent.extendCoordinate(r,ol.transform.apply(u,[b,c])),ol.extent.extendCoordinate(r,ol.transform.apply(u,[b+q,c])),ol.extent.extendCoordinate(r,ol.transform.apply(u,
[b+q,c+h])),ol.extent.extendCoordinate(r,ol.transform.apply(u,[b,c+q]))):ol.extent.createOrUpdate(b,c,b+q*p,c+h*p,r);n=a.canvas;n=r[0]<=n.width&&0<=r[2]&&r[1]<=n.height&&0<=r[3];if(g){if(n||1!=g[4])ol.extent.extend(g,r),g.push(n?[a,v?v.slice(0):null,k,d,l,m,q,h,b,c,p]:null)}else n&&ol.render.canvas.drawImage(a,v,k,d,l,m,q,h,b,c,p)};ol.render.canvas.Replay.prototype.applyPixelRatio=function(a){var b=this.pixelRatio;return 1==b?a:a.map(function(a){return a*b})};
ol.render.canvas.Replay.prototype.appendFlatCoordinates=function(a,b,c,d,e,f){var g=this.coordinates.length,h=this.getBufferedMaxExtent();f&&(b+=d);f=[a[b],a[b+1]];var k=[NaN,NaN],l=!0,m;for(m=b+d;m<c;m+=d){k[0]=a[m];k[1]=a[m+1];var n=ol.extent.coordinateRelationship(h,k);n!==p?(l&&(this.coordinates[g++]=f[0],this.coordinates[g++]=f[1]),this.coordinates[g++]=k[0],this.coordinates[g++]=k[1],l=!1):n===ol.extent.Relationship.INTERSECTING?(this.coordinates[g++]=k[0],this.coordinates[g++]=k[1],l=!1):l=
!0;f[0]=k[0];f[1]=k[1];var p=n}if(e&&l||m===b+d)this.coordinates[g++]=f[0],this.coordinates[g++]=f[1];return g};ol.render.canvas.Replay.prototype.drawCustomCoordinates_=function(a,b,c,d,e){for(var f=0,g=c.length;f<g;++f){var h=c[f];b=this.appendFlatCoordinates(a,b,h,d,!1,!1);e.push(b);b=h}return b};
ol.render.canvas.Replay.prototype.drawCustom=function(a,b,c){this.beginGeometry(a,b);var d=a.getType(),e=a.getStride(),f=this.coordinates.length,g;if(d==ol.geom.GeometryType.MULTI_POLYGON){d=a.getOrientedFlatCoordinates();var h=[];for(var k=a.getEndss(),l=g=0,m=k.length;l<m;++l){var n=[];g=this.drawCustomCoordinates_(d,g,k[l],e,n);h.push(n)}this.instructions.push([ol.render.canvas.Instruction.CUSTOM,f,h,a,c,ol.geom.flat.inflate.coordinatesss])}else d==ol.geom.GeometryType.POLYGON||d==ol.geom.GeometryType.MULTI_LINE_STRING?
(h=[],d=d==ol.geom.GeometryType.POLYGON?a.getOrientedFlatCoordinates():a.getFlatCoordinates(),this.drawCustomCoordinates_(d,0,a.getEnds(),e,h),this.instructions.push([ol.render.canvas.Instruction.CUSTOM,f,h,a,c,ol.geom.flat.inflate.coordinatess])):d==ol.geom.GeometryType.LINE_STRING||d==ol.geom.GeometryType.MULTI_POINT?(d=a.getFlatCoordinates(),e=this.appendFlatCoordinates(d,0,d.length,e,!1,!1),this.instructions.push([ol.render.canvas.Instruction.CUSTOM,f,e,a,c,ol.geom.flat.inflate.coordinates])):
d==ol.geom.GeometryType.POINT&&(d=a.getFlatCoordinates(),this.coordinates.push(d[0],d[1]),e=this.coordinates.length,this.instructions.push([ol.render.canvas.Instruction.CUSTOM,f,e,a,c]));this.endGeometry(a,b)};ol.render.canvas.Replay.prototype.beginGeometry=function(a,b){this.beginGeometryInstruction1_=[ol.render.canvas.Instruction.BEGIN_GEOMETRY,b,0];this.instructions.push(this.beginGeometryInstruction1_);this.beginGeometryInstruction2_=[ol.render.canvas.Instruction.BEGIN_GEOMETRY,b,0];this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)};
ol.render.canvas.Replay.prototype.fill_=function(a,b){if(this.fillOrigin_){var c=ol.transform.apply(this.renderedTransform_,this.fillOrigin_.slice());a.translate(c[0],c[1]);a.rotate(b)}a.fill();this.fillOrigin_&&a.setTransform.apply(a,ol.render.canvas.resetTransform_)};
ol.render.canvas.Replay.prototype.renderDeclutter_=function(a){if(a&&5<a.length){var b=a[4];if(1==b||b==a.length-5){b={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]};if(!this.declutterTree.collides(b)){this.declutterTree.insert(b);b=ol.render.canvas.drawImage;for(var c=5,d=a.length;c<d;++c)a[c]&&b.apply(void 0,a[c])}a.length=5;ol.extent.createOrUpdateEmpty(a)}}};
ol.render.canvas.Replay.prototype.replay_=function(a,b,c,d,e,f,g){if(this.pixelCoordinates_&&ol.array.equals(b,this.renderedTransform_))var h=this.pixelCoordinates_;else this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=ol.geom.flat.transform.transform2D(this.coordinates,0,this.coordinates.length,2,b,this.pixelCoordinates_),ol.transform.setFromArray(this.renderedTransform_,b);b=!ol.obj.isEmpty(d);for(var k=0,l=e.length,m,n,p,q,r,u,v,t,w=0,x=0,z=this.coordinateCache_,y={context:a,pixelRatio:this.pixelRatio,
resolution:this.resolution,rotation:c},A=this.instructions!=e||this.overlaps?0:200;k<l;)switch(t=e[k],t[0]){case ol.render.canvas.Instruction.BEGIN_GEOMETRY:var C=t[1];b&&d[ol.getUid(C).toString()]||!C.getGeometry()?k=t[2]:void 0===g||ol.extent.intersects(g,C.getGeometry().getExtent())?++k:k=t[2]+1;break;case ol.render.canvas.Instruction.BEGIN_PATH:w>A&&(this.fill_(a,c),w=0);x>A&&(a.stroke(),x=0);w||x||(a.beginPath(),r=u=NaN);++k;break;case ol.render.canvas.Instruction.CIRCLE:m=t[1];v=h[m];t=h[m+
1];p=h[m+2]-v;m=h[m+3]-t;m=Math.sqrt(p*p+m*m);a.moveTo(v+m,t);a.arc(v,t,m,0,2*Math.PI,!0);++k;break;case ol.render.canvas.Instruction.CLOSE_PATH:a.closePath();++k;break;case ol.render.canvas.Instruction.CUSTOM:m=t[1];n=t[2];v=t[4];p=6==t.length?t[5]:void 0;y.geometry=t[3];y.feature=C;k in z||(z[k]=[]);t=z[k];p?p(h,m,n,2,t):(t[0]=h[m],t[1]=h[m+1],t.length=2);v(t,y);++k;break;case ol.render.canvas.Instruction.DRAW_IMAGE:m=t[1];n=t[2];var B=t[3];p=t[4];q=t[5];v=t[6];var D=t[7],E=t[8],G=t[9],F=t[10],
H=t[12],I=t[13],K=t[14],J=t[15];for(t[11]&&(H+=c);m<n;m+=2)this.replayImage_(a,h[m],h[m+1],B,p,q,v,D,E,G,F,H,I,K,J);this.renderDeclutter_(v);++k;break;case ol.render.canvas.Instruction.DRAW_CHARS:q=t[1];E=t[2];m=t[3];v=t[4];G=t[5];n=t[6];F=t[7];H=t[8];B=t[9];p=t[10];D=t[11];I=t[12];K=t[13];t=t[14];J=ol.geom.flat.length.lineString(h,q,E,2);var L=H(I);if(G||L<=J)if(E=ol.geom.flat.textpath.lineString(h,q,E,2,I,H,(J-L)*K,F)){if(p)for(G=0,F=E.length;G<F;++G)H=E[G],p=H[4],I=this.getImage(p,!1,!0),p=H[2]+
D,q=m*I.height+2*(.5-m)*D-B,this.replayImage_(a,H[0],H[1],I,p,q,v,I.height,1,0,0,H[3],t,!1,I.width);if(n)for(G=0,F=E.length;G<F;++G)H=E[G],p=H[4],I=this.getImage(p,!0,!1),p=H[2],q=m*I.height-B,this.replayImage_(a,H[0],H[1],I,p,q,v,I.height,1,0,0,H[3],t,!1,I.width)}this.renderDeclutter_(v);++k;break;case ol.render.canvas.Instruction.END_GEOMETRY:if(void 0!==f&&(C=t[1],v=f(C)))return v;++k;break;case ol.render.canvas.Instruction.FILL:A?w++:this.fill_(a,c);++k;break;case ol.render.canvas.Instruction.MOVE_TO_LINE_TO:m=
t[1];n=t[2];p=h[m];q=h[m+1];v=p+.5|0;t=q+.5|0;if(v!==r||t!==u)a.moveTo(p,q),r=v,u=t;for(m+=2;m<n;m+=2)if(p=h[m],q=h[m+1],v=p+.5|0,t=q+.5|0,m==n-2||v!==r||t!==u)a.lineTo(p,q),r=v,u=t;++k;break;case ol.render.canvas.Instruction.SET_FILL_STYLE:this.fillOrigin_=t[2];w&&(this.fill_(a,c),w=0,x&&(a.stroke(),x=0));a.fillStyle=t[1];++k;break;case ol.render.canvas.Instruction.SET_STROKE_STYLE:x&&(a.stroke(),x=0);a.strokeStyle=t[1];a.lineWidth=t[2];a.lineCap=t[3];a.lineJoin=t[4];a.miterLimit=t[5];ol.has.CANVAS_LINE_DASH&&
(a.lineDashOffset=t[7],a.setLineDash(t[6]));++k;break;case ol.render.canvas.Instruction.STROKE:A?x++:a.stroke();++k;break;default:++k}w&&this.fill_(a,c);x&&a.stroke()};ol.render.canvas.Replay.prototype.replay=function(a,b,c,d){this.replay_(a,b,c,d,this.instructions,void 0,void 0)};ol.render.canvas.Replay.prototype.replayHitDetection=function(a,b,c,d,e,f){return this.replay_(a,b,c,d,this.hitDetectionInstructions,e,f)};
ol.render.canvas.Replay.prototype.reverseHitDetectionInstructions=function(){var a=this.hitDetectionInstructions;a.reverse();var b,c=a.length,d=-1;for(b=0;b<c;++b){var e=a[b];var f=e[0];f==ol.render.canvas.Instruction.END_GEOMETRY?d=b:f==ol.render.canvas.Instruction.BEGIN_GEOMETRY&&(e[2]=b,ol.array.reverseSubArray(this.hitDetectionInstructions,d,b),d=-1)}};
ol.render.canvas.Replay.prototype.setFillStrokeStyle=function(a,b){var c=this.state;a?(a=a.getColor(),c.fillStyle=ol.colorlike.asColorLike(a?a:ol.render.canvas.defaultFillStyle)):c.fillStyle=void 0;b?(a=b.getColor(),c.strokeStyle=ol.colorlike.asColorLike(a?a:ol.render.canvas.defaultStrokeStyle),a=b.getLineCap(),c.lineCap=void 0!==a?a:ol.render.canvas.defaultLineCap,a=b.getLineDash(),c.lineDash=a?a.slice():ol.render.canvas.defaultLineDash,a=b.getLineDashOffset(),c.lineDashOffset=a?a:ol.render.canvas.defaultLineDashOffset,
a=b.getLineJoin(),c.lineJoin=void 0!==a?a:ol.render.canvas.defaultLineJoin,a=b.getWidth(),c.lineWidth=void 0!==a?a:ol.render.canvas.defaultLineWidth,b=b.getMiterLimit(),c.miterLimit=void 0!==b?b:ol.render.canvas.defaultMiterLimit,c.lineWidth>this.maxLineWidth&&(this.maxLineWidth=c.lineWidth,this.bufferedMaxExtent_=null)):(c.strokeStyle=void 0,c.lineCap=void 0,c.lineDash=null,c.lineDashOffset=void 0,c.lineJoin=void 0,c.lineWidth=void 0,c.miterLimit=void 0)};
ol.render.canvas.Replay.prototype.updateStrokeStyle=function(a,b){var c=a.strokeStyle,d=a.lineCap,e=a.lineDash,f=a.lineDashOffset,g=a.lineJoin,h=a.lineWidth,k=a.miterLimit;a.currentStrokeStyle==c&&a.currentLineCap==d&&ol.array.equals(a.currentLineDash,e)&&a.currentLineDashOffset==f&&a.currentLineJoin==g&&a.currentLineWidth==h&&a.currentMiterLimit==k||(b&&(void 0!=a.lastStroke&&a.lastStroke!=this.coordinates.length&&(this.instructions.push([ol.render.canvas.Instruction.STROKE]),a.lastStroke=this.coordinates.length),
a.lastStroke=0),this.instructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,c,h*this.pixelRatio,d,g,k,this.applyPixelRatio(e),f*this.pixelRatio]),b&&this.instructions.push([ol.render.canvas.Instruction.BEGIN_PATH]),a.currentStrokeStyle=c,a.currentLineCap=d,a.currentLineDash=e,a.currentLineDashOffset=f,a.currentLineJoin=g,a.currentLineWidth=h,a.currentMiterLimit=k)};
ol.render.canvas.Replay.prototype.endGeometry=function(a,b){this.beginGeometryInstruction1_[2]=this.instructions.length;this.beginGeometryInstruction1_=null;this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length;this.beginGeometryInstruction2_=null;a=[ol.render.canvas.Instruction.END_GEOMETRY,b];this.instructions.push(a);this.hitDetectionInstructions.push(a)};ol.render.canvas.Replay.prototype.finish=ol.nullFunction;
ol.render.canvas.Replay.prototype.getBufferedMaxExtent=function(){this.bufferedMaxExtent_||(this.bufferedMaxExtent_=ol.extent.clone(this.maxExtent),0<this.maxLineWidth&&ol.extent.buffer(this.bufferedMaxExtent_,this.resolution*(this.maxLineWidth+1)/2,this.bufferedMaxExtent_));return this.bufferedMaxExtent_};ol.render.canvas.ImageReplay=function(a,b,c,d,e,f){ol.render.canvas.Replay.call(this,a,b,c,d,e,f);this.image_=this.hitDetectionImage_=this.declutterGroup_=null;this.width_=this.snapToPixel_=this.scale_=this.rotation_=this.rotateWithView_=this.originY_=this.originX_=this.opacity_=this.height_=this.anchorY_=this.anchorX_=void 0};ol.inherits(ol.render.canvas.ImageReplay,ol.render.canvas.Replay);
ol.render.canvas.ImageReplay.prototype.drawCoordinates_=function(a,b,c,d){return this.appendFlatCoordinates(a,b,c,d,!1,!1)};
ol.render.canvas.ImageReplay.prototype.drawPoint=function(a,b){if(this.image_){this.beginGeometry(a,b);var c=a.getFlatCoordinates(),d=a.getStride(),e=this.coordinates.length;c=this.drawCoordinates_(c,0,c.length,d);this.instructions.push([ol.render.canvas.Instruction.DRAW_IMAGE,e,c,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.DRAW_IMAGE,
e,c,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]);this.endGeometry(a,b)}};
ol.render.canvas.ImageReplay.prototype.drawMultiPoint=function(a,b){if(this.image_){this.beginGeometry(a,b);var c=a.getFlatCoordinates(),d=a.getStride(),e=this.coordinates.length;c=this.drawCoordinates_(c,0,c.length,d);this.instructions.push([ol.render.canvas.Instruction.DRAW_IMAGE,e,c,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.DRAW_IMAGE,
e,c,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]);this.endGeometry(a,b)}};
ol.render.canvas.ImageReplay.prototype.finish=function(){this.reverseHitDetectionInstructions();this.anchorY_=this.anchorX_=void 0;this.image_=this.hitDetectionImage_=null;this.width_=this.snapToPixel_=this.rotation_=this.rotateWithView_=this.originY_=this.originX_=this.opacity_=this.scale_=this.height_=void 0};
ol.render.canvas.ImageReplay.prototype.setImageStyle=function(a,b){var c=a.getAnchor(),d=a.getSize(),e=a.getHitDetectionImage(1),f=a.getImage(1),g=a.getOrigin();this.anchorX_=c[0];this.anchorY_=c[1];this.declutterGroup_=b;this.hitDetectionImage_=e;this.image_=f;this.height_=d[1];this.opacity_=a.getOpacity();this.originX_=g[0];this.originY_=g[1];this.rotateWithView_=a.getRotateWithView();this.rotation_=a.getRotation();this.scale_=a.getScale();this.snapToPixel_=a.getSnapToPixel();this.width_=d[0]};ol.render.canvas.LineStringReplay=function(a,b,c,d,e,f){ol.render.canvas.Replay.call(this,a,b,c,d,e,f)};ol.inherits(ol.render.canvas.LineStringReplay,ol.render.canvas.Replay);ol.render.canvas.LineStringReplay.prototype.drawFlatCoordinates_=function(a,b,c,d){var e=this.coordinates.length;a=this.appendFlatCoordinates(a,b,c,d,!1,!1);e=[ol.render.canvas.Instruction.MOVE_TO_LINE_TO,e,a];this.instructions.push(e);this.hitDetectionInstructions.push(e);return c};
ol.render.canvas.LineStringReplay.prototype.drawLineString=function(a,b){var c=this.state,d=c.lineWidth;void 0!==c.strokeStyle&&void 0!==d&&(this.updateStrokeStyle(c,!0),this.beginGeometry(a,b),this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash,c.lineDashOffset],[ol.render.canvas.Instruction.BEGIN_PATH]),c=a.getFlatCoordinates(),d=a.getStride(),this.drawFlatCoordinates_(c,0,c.length,d),this.hitDetectionInstructions.push([ol.render.canvas.Instruction.STROKE]),
this.endGeometry(a,b))};
ol.render.canvas.LineStringReplay.prototype.drawMultiLineString=function(a,b){var c=this.state,d=c.lineWidth;if(void 0!==c.strokeStyle&&void 0!==d){this.updateStrokeStyle(c,!0);this.beginGeometry(a,b);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash,c.lineDashOffset],[ol.render.canvas.Instruction.BEGIN_PATH]);c=a.getEnds();d=a.getFlatCoordinates();var e=a.getStride(),f=0,g;var h=0;for(g=c.length;h<
g;++h)f=this.drawFlatCoordinates_(d,f,c[h],e);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.STROKE]);this.endGeometry(a,b)}};ol.render.canvas.LineStringReplay.prototype.finish=function(){var a=this.state;void 0!=a.lastStroke&&a.lastStroke!=this.coordinates.length&&this.instructions.push([ol.render.canvas.Instruction.STROKE]);this.reverseHitDetectionInstructions();this.state=null};ol.render.canvas.PolygonReplay=function(a,b,c,d,e,f){ol.render.canvas.Replay.call(this,a,b,c,d,e,f)};ol.inherits(ol.render.canvas.PolygonReplay,ol.render.canvas.Replay);
ol.render.canvas.PolygonReplay.prototype.drawFlatCoordinatess_=function(a,b,c,d){var e=this.state,f=void 0!==e.fillStyle;e=void 0!=e.strokeStyle;var g=c.length,h=[ol.render.canvas.Instruction.BEGIN_PATH];this.instructions.push(h);this.hitDetectionInstructions.push(h);for(h=0;h<g;++h){var k=c[h],l=this.coordinates.length;b=this.appendFlatCoordinates(a,b,k,d,!0,!e);b=[ol.render.canvas.Instruction.MOVE_TO_LINE_TO,l,b];this.instructions.push(b);this.hitDetectionInstructions.push(b);e&&(b=[ol.render.canvas.Instruction.CLOSE_PATH],
this.instructions.push(b),this.hitDetectionInstructions.push(b));b=k}a=[ol.render.canvas.Instruction.FILL];this.hitDetectionInstructions.push(a);f&&this.instructions.push(a);e&&(f=[ol.render.canvas.Instruction.STROKE],this.instructions.push(f),this.hitDetectionInstructions.push(f));return b};
ol.render.canvas.PolygonReplay.prototype.drawCircle=function(a,b){var c=this.state,d=c.strokeStyle;if(void 0!==c.fillStyle||void 0!==d){this.setFillStrokeStyles_(a);this.beginGeometry(a,b);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_FILL_STYLE,ol.color.asString(ol.render.canvas.defaultFillStyle)]);void 0!==c.strokeStyle&&this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash,
c.lineDashOffset]);var e=a.getFlatCoordinates(),f=a.getStride();d=this.coordinates.length;this.appendFlatCoordinates(e,0,e.length,f,!1,!1);e=[ol.render.canvas.Instruction.BEGIN_PATH];d=[ol.render.canvas.Instruction.CIRCLE,d];this.instructions.push(e,d);this.hitDetectionInstructions.push(e,d);d=[ol.render.canvas.Instruction.FILL];this.hitDetectionInstructions.push(d);void 0!==c.fillStyle&&this.instructions.push(d);void 0!==c.strokeStyle&&(c=[ol.render.canvas.Instruction.STROKE],this.instructions.push(c),
this.hitDetectionInstructions.push(c));this.endGeometry(a,b)}};
ol.render.canvas.PolygonReplay.prototype.drawPolygon=function(a,b){var c=this.state;this.setFillStrokeStyles_(a);this.beginGeometry(a,b);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_FILL_STYLE,ol.color.asString(ol.render.canvas.defaultFillStyle)]);void 0!==c.strokeStyle&&this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash,c.lineDashOffset]);c=a.getEnds();var d=a.getOrientedFlatCoordinates(),
e=a.getStride();this.drawFlatCoordinatess_(d,0,c,e);this.endGeometry(a,b)};
ol.render.canvas.PolygonReplay.prototype.drawMultiPolygon=function(a,b){var c=this.state,d=c.strokeStyle;if(void 0!==c.fillStyle||void 0!==d){this.setFillStrokeStyles_(a);this.beginGeometry(a,b);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_FILL_STYLE,ol.color.asString(ol.render.canvas.defaultFillStyle)]);void 0!==c.strokeStyle&&this.hitDetectionInstructions.push([ol.render.canvas.Instruction.SET_STROKE_STYLE,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash,
c.lineDashOffset]);c=a.getEndss();d=a.getOrientedFlatCoordinates();var e=a.getStride(),f=0,g;var h=0;for(g=c.length;h<g;++h)f=this.drawFlatCoordinatess_(d,f,c[h],e);this.endGeometry(a,b)}};ol.render.canvas.PolygonReplay.prototype.finish=function(){this.reverseHitDetectionInstructions();this.state=null;var a=this.tolerance;if(0!==a){var b=this.coordinates,c;var d=0;for(c=b.length;d<c;++d)b[d]=ol.geom.flat.simplify.snap(b[d],a)}};
ol.render.canvas.PolygonReplay.prototype.setFillStrokeStyles_=function(a){var b=this.state,c=b.fillStyle;if(void 0!==c&&("string"!==typeof c||b.currentFillStyle!=c)){var d=[ol.render.canvas.Instruction.SET_FILL_STYLE,c];"string"!==typeof c&&(a=a.getExtent(),d.push([a[0],a[3]]));this.instructions.push(d);b.currentFillStyle=b.fillStyle}void 0!==b.strokeStyle&&this.updateStrokeStyle(b,!1)};ol.geom.flat.straightchunk={};ol.geom.flat.straightchunk.lineString=function(a,b,c,d,e){for(var f=c,g=c,h=0,k=0,l=c,m,n,p,q,r,u;c<d;c+=e){var v=b[c],t=b[c+1];void 0!==p&&(p=v-p,q=t-q,n=Math.sqrt(p*p+q*q),void 0!==r&&(k+=m,m=Math.acos((r*p+u*q)/(m*n)),m>a&&(k>h&&(h=k,f=l,g=c),k=0,l=c-e)),m=n,r=p,u=q);p=v;q=t}return k+n>h?[l,c]:[f,g]};ol.render.replay={};ol.render.replay.ORDER=[ol.render.ReplayType.POLYGON,ol.render.ReplayType.CIRCLE,ol.render.ReplayType.LINE_STRING,ol.render.ReplayType.IMAGE,ol.render.ReplayType.TEXT,ol.render.ReplayType.DEFAULT];ol.render.replay.TEXT_ALIGN={};ol.render.replay.TEXT_ALIGN.left=0;ol.render.replay.TEXT_ALIGN.end=0;ol.render.replay.TEXT_ALIGN.center=.5;ol.render.replay.TEXT_ALIGN.right=1;ol.render.replay.TEXT_ALIGN.start=1;ol.render.replay.TEXT_ALIGN.top=0;ol.render.replay.TEXT_ALIGN.middle=.5;
ol.render.replay.TEXT_ALIGN.hanging=.2;ol.render.replay.TEXT_ALIGN.alphabetic=.8;ol.render.replay.TEXT_ALIGN.ideographic=.8;ol.render.replay.TEXT_ALIGN.bottom=1;ol.style.TextPlacement={POINT:"point",LINE:"line"};ol.render.canvas.TextReplay=function(a,b,c,d,e,f){ol.render.canvas.Replay.call(this,a,b,c,d,e,f);this.labels_=null;this.text_="";this.textOffsetY_=this.textOffsetX_=0;this.textRotateWithView_=void 0;this.textRotation_=0;this.textStrokeState_=this.textFillState_=null;this.textState_={};this.strokeKey_=this.fillKey_=this.textKey_="";this.widths_={}};ol.inherits(ol.render.canvas.TextReplay,ol.render.canvas.Replay);
ol.render.canvas.TextReplay.measureTextHeight=function(){var a,b={};return function(c){var d=b[c];void 0==d&&(a||(a=document.createElement("span"),a.textContent="M",a.style.margin=a.style.padding="0 !important",a.style.position="absolute !important",a.style.left="-99999px !important"),a.style.font=c,document.body.appendChild(a),d=b[c]=a.offsetHeight,document.body.removeChild(a));return d}}();
ol.render.canvas.TextReplay.measureTextWidth=function(){var a,b;return function(c,d){a||(a=ol.dom.createCanvasContext2D(1,1));c!=b&&(b=a.font=c);return a.measureText(d).width}}();ol.render.canvas.TextReplay.measureTextWidths=function(a,b,c){var d=b.length,e=0,f;for(f=0;f<d;++f){var g=ol.render.canvas.TextReplay.measureTextWidth(a,b[f]);e=Math.max(e,g);c.push(g)}return e};
ol.render.canvas.TextReplay.prototype.drawText=function(a,b){var c=this.textFillState_,d=this.textStrokeState_,e=this.textState_;if(""!==this.text_&&e&&(c||d)){c=this.coordinates.length;var f=a.getType();d=null;var g=2,h=2;if(e.placement===ol.style.TextPlacement.LINE){if(!ol.extent.intersects(this.getBufferedMaxExtent(),a.getExtent()))return;d=a.getFlatCoordinates();h=a.getStride();if(f==ol.geom.GeometryType.LINE_STRING)var k=[d.length];else if(f==ol.geom.GeometryType.MULTI_LINE_STRING)k=a.getEnds();
else if(f==ol.geom.GeometryType.POLYGON)k=a.getEnds().slice(0,1);else if(f==ol.geom.GeometryType.MULTI_POLYGON){var l=a.getEndss();k=[];g=0;for(f=l.length;g<f;++g)k.push(l[g][0])}this.beginGeometry(a,b);f=e.textAlign;var m=0;l=0;for(var n=k.length;l<n;++l){if(void 0==f){g=ol.geom.flat.straightchunk.lineString(e.maxAngle,d,m,k[l],h);m=g[0];var p=g[1]}else p=k[l];for(g=m;g<p;g+=h)this.coordinates.push(d[g],d[g+1]);g=this.coordinates.length;m=k[l];this.drawChars_(c,g,this.declutterGroup_);c=g}}else{k=
this.getImage(this.text_,!!this.textFillState_,!!this.textStrokeState_);l=k.width/this.pixelRatio;switch(f){case ol.geom.GeometryType.POINT:case ol.geom.GeometryType.MULTI_POINT:d=a.getFlatCoordinates();g=d.length;break;case ol.geom.GeometryType.LINE_STRING:d=a.getFlatMidpoint();break;case ol.geom.GeometryType.CIRCLE:d=a.getCenter();break;case ol.geom.GeometryType.MULTI_LINE_STRING:d=a.getFlatMidpoints();g=d.length;break;case ol.geom.GeometryType.POLYGON:d=a.getFlatInteriorPoint();if(!e.exceedLength&&
d[2]/this.resolution<l)return;h=3;break;case ol.geom.GeometryType.MULTI_POLYGON:n=a.getFlatInteriorPoints();d=[];g=0;for(f=n.length;g<f;g+=3)(e.exceedLength||n[g+2]/this.resolution>=l)&&d.push(n[g],n[g+1]);g=d.length;if(0==g)return}g=this.appendFlatCoordinates(d,0,g,h,!1,!1);this.beginGeometry(a,b);this.drawTextImage_(k,c,g)}this.endGeometry(a,b)}};
ol.render.canvas.TextReplay.prototype.getImage=function(a,b,c){var d=(c?this.strokeKey_:"")+this.textKey_+a+(b?this.fillKey_:""),e=ol.render.canvas.labelCache;if(!e.containsKey(d)){var f=this.textStrokeState_,g=this.textFillState_,h=this.textState_,k=h.scale*this.pixelRatio,l=ol.render.replay.TEXT_ALIGN[h.textAlign||ol.render.canvas.defaultTextAlign],m=c&&f.lineWidth?f.lineWidth:0;a=a.split("\n");var n=a.length,p=[],q=ol.render.canvas.TextReplay.measureTextWidths(h.font,a,p),r=ol.render.canvas.TextReplay.measureTextHeight(h.font);
q=ol.dom.createCanvasContext2D(Math.ceil((q+m)*k),Math.ceil((r*n+m)*k));var u=q.canvas;e.pruneAndSet(d,u);1!=k&&q.scale(k,k);q.font=h.font;c&&(q.strokeStyle=f.strokeStyle,q.lineWidth=m*(ol.has.SAFARI?k:1),q.lineCap=f.lineCap,q.lineJoin=f.lineJoin,q.miterLimit=f.miterLimit,ol.has.CANVAS_LINE_DASH&&f.lineDash.length&&(q.setLineDash(f.lineDash),q.lineDashOffset=f.lineDashOffset));b&&(q.fillStyle=g.fillStyle);q.textBaseline="top";q.textAlign="center";f=.5-l;k=l*u.width/k+f*m;if(c)for(c=0;c<n;++c)q.strokeText(a[c],
k+f*p[c],.5*m+c*r);if(b)for(c=0;c<n;++c)q.fillText(a[c],k+f*p[c],.5*m+c*r)}return e.get(d)};
ol.render.canvas.TextReplay.prototype.drawTextImage_=function(a,b,c){var d=this.textState_,e=this.textStrokeState_,f=this.pixelRatio,g=ol.render.replay.TEXT_ALIGN[d.textAlign||ol.render.canvas.defaultTextAlign];d=ol.render.replay.TEXT_ALIGN[d.textBaseline];e=e&&e.lineWidth?e.lineWidth:0;g=g*a.width/f+2*(.5-g)*e;d=d*a.height/f+2*(.5-d)*e;this.instructions.push([ol.render.canvas.Instruction.DRAW_IMAGE,b,c,a,(g-this.textOffsetX_)*f,(d-this.textOffsetY_)*f,this.declutterGroup_,a.height,1,0,0,this.textRotateWithView_,
this.textRotation_,1,!0,a.width]);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.DRAW_IMAGE,b,c,a,(g-this.textOffsetX_)*f,(d-this.textOffsetY_)*f,this.declutterGroup_,a.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/f,!0,a.width])};
ol.render.canvas.TextReplay.prototype.drawChars_=function(a,b,c){var d=this.pixelRatio,e=this.textStrokeState_,f=!!this.textFillState_,g=!!e,h=this.textState_,k=ol.render.replay.TEXT_ALIGN[h.textBaseline],l=this.textOffsetY_*d,m=ol.render.replay.TEXT_ALIGN[h.textAlign||ol.render.canvas.defaultTextAlign],n=this.text_,p=h.font,q=h.scale;e=e?e.lineWidth*q/2:0;var r=this.widths_;this.instructions.push([ol.render.canvas.Instruction.DRAW_CHARS,a,b,k,c,h.exceedLength,f,h.maxAngle,function(a){var b=r[a];
b||(b=r[a]=ol.render.canvas.TextReplay.measureTextWidth(p,a));return b*q*d},l,g,e*d,n,m,1]);this.hitDetectionInstructions.push([ol.render.canvas.Instruction.DRAW_CHARS,a,b,k,c,h.exceedLength,f,h.maxAngle,function(a){var b=r[a];b||(b=r[a]=ol.render.canvas.TextReplay.measureTextWidth(p,a));return b*q},l,g,e,n,m,1/d])};
ol.render.canvas.TextReplay.prototype.setTextStyle=function(a,b){var c,d;if(a){this.declutterGroup_=b;(d=a.getFill())?(b=this.textFillState_,b||(b=this.textFillState_={}),b.fillStyle=ol.colorlike.asColorLike(d.getColor()||ol.render.canvas.defaultFillStyle)):b=this.textFillState_=null;if(c=a.getStroke()){d=this.textStrokeState_;d||(d=this.textStrokeState_={});var e=c.getLineDash(),f=c.getLineDashOffset(),g=c.getWidth(),h=c.getMiterLimit();d.lineCap=c.getLineCap()||ol.render.canvas.defaultLineCap;d.lineDash=
e?e.slice():ol.render.canvas.defaultLineDash;d.lineDashOffset=void 0===f?ol.render.canvas.defaultLineDashOffset:f;d.lineJoin=c.getLineJoin()||ol.render.canvas.defaultLineJoin;d.lineWidth=void 0===g?ol.render.canvas.defaultLineWidth:g;d.miterLimit=void 0===h?ol.render.canvas.defaultMiterLimit:h;d.strokeStyle=ol.colorlike.asColorLike(c.getColor()||ol.render.canvas.defaultStrokeStyle)}else d=this.textStrokeState_=null;c=this.textState_;e=a.getFont()||ol.render.canvas.defaultFont;ol.render.canvas.checkFont(e);
f=a.getScale();c.exceedLength=a.getExceedLength();c.font=e;c.maxAngle=a.getMaxAngle();c.placement=a.getPlacement();c.textAlign=a.getTextAlign();c.textBaseline=a.getTextBaseline()||ol.render.canvas.defaultTextBaseline;c.scale=void 0===f?1:f;e=a.getOffsetX();f=a.getOffsetY();g=a.getRotateWithView();h=a.getRotation();this.text_=a.getText()||"";this.textOffsetX_=void 0===e?0:e;this.textOffsetY_=void 0===f?0:f;this.textRotateWithView_=void 0===g?!1:g;this.textRotation_=void 0===h?0:h;this.strokeKey_=d?
("string"==typeof d.strokeStyle?d.strokeStyle:ol.getUid(d.strokeStyle))+d.lineCap+d.lineDashOffset+"|"+d.lineWidth+d.lineJoin+d.miterLimit+"["+d.lineDash.join()+"]":"";this.textKey_=c.font+(c.textAlign||"?")+c.scale;this.fillKey_=b?"string"==typeof b.fillStyle?b.fillStyle:"|"+ol.getUid(b.fillStyle):""}else this.text_=""};ol.render.canvas.ReplayGroup=function(a,b,c,d,e,f,g){ol.render.ReplayGroup.call(this);this.declutterTree_=f;this.declutterGroup_=null;this.tolerance_=a;this.maxExtent_=b;this.overlaps_=e;this.pixelRatio_=d;this.resolution_=c;this.renderBuffer_=g;this.replaysByZIndex_={};this.hitDetectionContext_=ol.dom.createCanvasContext2D(1,1);this.hitDetectionTransform_=ol.transform.create()};ol.inherits(ol.render.canvas.ReplayGroup,ol.render.ReplayGroup);ol.render.canvas.ReplayGroup.circleArrayCache_={0:[[!0]]};
ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_=function(a,b,c){var d,e=Math.floor(a.length/2);if(b>=e)for(d=e;d<b;d++)a[d][c]=!0;else if(b<e)for(d=b+1;d<e;d++)a[d][c]=!0};
ol.render.canvas.ReplayGroup.getCircleArray_=function(a){if(void 0!==ol.render.canvas.ReplayGroup.circleArrayCache_[a])return ol.render.canvas.ReplayGroup.circleArrayCache_[a];for(var b=2*a+1,c=Array(b),d=0;d<b;d++)c[d]=Array(b);b=a;for(var e=d=0;b>=d;)ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(c,a+b,a+d),ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(c,a+d,a+b),ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(c,a-d,a+b),ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(c,
a-b,a+d),ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(c,a-b,a-d),ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(c,a-d,a-b),ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(c,a+d,a-b),ol.render.canvas.ReplayGroup.fillCircleArrayRowToMiddle_(c,a+b,a-d),d++,e+=1+2*d,0<2*(e-b)+1&&(--b,e+=1-2*b);return ol.render.canvas.ReplayGroup.circleArrayCache_[a]=c};
ol.render.canvas.ReplayGroup.replayDeclutter=function(a,b,c){for(var d=Object.keys(a).map(Number).sort(ol.array.numberSafeCompareFunction),e=0,f=d.length;e<f;++e)for(var g=a[d[e].toString()],h=0,k=g.length;h<k;){var l=g[h++],m=g[h++];l.replay(b,m,c,{})}};
ol.render.canvas.ReplayGroup.replayDeclutterHitDetection=function(a,b,c,d,e){for(var f=Object.keys(a).map(Number).sort(ol.array.numberSafeCompareFunction),g=0,h=f.length;g<h;++g)for(var k=a[f[g].toString()],l=k.length-1;0<=l;){var m=k[l--];if(m=k[l--].replayHitDetection(b,m,c,{},d,e))return m}};ol.render.canvas.ReplayGroup.prototype.addDeclutter=function(a){var b=null;this.declutterTree_&&(a?(b=this.declutterGroup_,b[4]++):(b=this.declutterGroup_=ol.extent.createEmpty(),b.push(1)));return b};
ol.render.canvas.ReplayGroup.prototype.clip=function(a,b){b=this.getClipCoords(b);a.beginPath();a.moveTo(b[0],b[1]);a.lineTo(b[2],b[3]);a.lineTo(b[4],b[5]);a.lineTo(b[6],b[7]);a.clip()};ol.render.canvas.ReplayGroup.prototype.hasReplays=function(a){for(var b in this.replaysByZIndex_)for(var c=this.replaysByZIndex_[b],d=0,e=a.length;d<e;++d)if(a[d]in c)return!0;return!1};ol.render.canvas.ReplayGroup.prototype.finish=function(){for(var a in this.replaysByZIndex_){var b=this.replaysByZIndex_[a],c;for(c in b)b[c].finish()}};
ol.render.canvas.ReplayGroup.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,f,g){function h(a){for(var b=m.getImageData(0,0,k,k).data,c=0;c<k;c++)for(var d=0;d<k;d++)if(p[c][d]&&0<b[4*(d*k+c)+3]){if(a=f(a))return a;m.clearRect(0,0,k,k);return}}d=Math.round(d);var k=2*d+1,l=ol.transform.compose(this.hitDetectionTransform_,d+.5,d+.5,1/b,-1/b,-c,-a[0],-a[1]),m=this.hitDetectionContext_;m.canvas.width!==k||m.canvas.height!==k?(m.canvas.width=k,m.canvas.height=k):m.clearRect(0,0,k,k);if(void 0!==
this.renderBuffer_){var n=ol.extent.createEmpty();ol.extent.extendCoordinate(n,a);ol.extent.buffer(n,b*(this.renderBuffer_+d),n)}var p=ol.render.canvas.ReplayGroup.getCircleArray_(d);a=this.replayHitDetection_(m,l,c,e,h,n,g);!a&&g&&(a=ol.render.canvas.ReplayGroup.replayDeclutterHitDetection(g,m,c,h,n));return a};ol.render.canvas.ReplayGroup.prototype.getClipCoords=function(a){var b=this.maxExtent_,c=b[0],d=b[1],e=b[2];b=b[3];c=[c,d,c,b,e,b,e,d];ol.geom.flat.transform.transform2D(c,0,8,2,a,c);return c};
ol.render.canvas.ReplayGroup.prototype.getReplay=function(a,b){var c=void 0!==a?a.toString():"0";a=this.replaysByZIndex_[c];void 0===a&&(a={},this.replaysByZIndex_[c]=a);c=a[b];void 0===c&&(c=new ol.render.canvas.ReplayGroup.BATCH_CONSTRUCTORS_[b](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),a[b]=c);return c};ol.render.canvas.ReplayGroup.prototype.getReplays=function(){return this.replaysByZIndex_};
ol.render.canvas.ReplayGroup.prototype.isEmpty=function(){return ol.obj.isEmpty(this.replaysByZIndex_)};
ol.render.canvas.ReplayGroup.prototype.replay=function(a,b,c,d,e,f){var g=Object.keys(this.replaysByZIndex_).map(Number);g.sort(ol.array.numberSafeCompareFunction);a.save();this.clip(a,b);e=e?e:ol.render.replay.ORDER;var h,k;var l=0;for(h=g.length;l<h;++l){var m=g[l].toString();var n=this.replaysByZIndex_[m];var p=0;for(k=e.length;p<k;++p){var q=e[p];var r=n[q];void 0!==r&&(!f||q!=ol.render.ReplayType.IMAGE&&q!=ol.render.ReplayType.TEXT?r.replay(a,b,c,d):(q=f[m])?q.push(r,b.slice(0)):f[m]=[r,b.slice(0)])}}a.restore()};
ol.render.canvas.ReplayGroup.prototype.replayHitDetection_=function(a,b,c,d,e,f,g){var h=Object.keys(this.replaysByZIndex_).map(Number);h.sort(ol.array.numberSafeCompareFunction);var k,l;for(k=h.length-1;0<=k;--k){var m=h[k].toString();var n=this.replaysByZIndex_[m];for(l=ol.render.replay.ORDER.length-1;0<=l;--l){var p=ol.render.replay.ORDER[l];var q=n[p];if(void 0!==q)if(!g||p!=ol.render.ReplayType.IMAGE&&p!=ol.render.ReplayType.TEXT){if(q=q.replayHitDetection(a,b,c,d,e,f))return q}else(p=g[m])?
p.push(q,b.slice(0)):g[m]=[q,b.slice(0)]}}};ol.render.canvas.ReplayGroup.BATCH_CONSTRUCTORS_={Circle:ol.render.canvas.PolygonReplay,Default:ol.render.canvas.Replay,Image:ol.render.canvas.ImageReplay,LineString:ol.render.canvas.LineStringReplay,Polygon:ol.render.canvas.PolygonReplay,Text:ol.render.canvas.TextReplay};ol.renderer.vector={};ol.renderer.vector.defaultOrder=function(a,b){return ol.getUid(a)-ol.getUid(b)};ol.renderer.vector.getSquaredTolerance=function(a,b){a=ol.renderer.vector.getTolerance(a,b);return a*a};ol.renderer.vector.getTolerance=function(a,b){return ol.SIMPLIFY_TOLERANCE*a/b};
ol.renderer.vector.renderCircleGeometry_=function(a,b,c,d){var e=c.getFill(),f=c.getStroke();if(e||f){var g=a.getReplay(c.getZIndex(),ol.render.ReplayType.CIRCLE);g.setFillStrokeStyle(e,f);g.drawCircle(b,d)}if(e=c.getText())c=a.getReplay(c.getZIndex(),ol.render.ReplayType.TEXT),c.setTextStyle(e,a.addDeclutter(!1)),c.drawText(b,d)};
ol.renderer.vector.renderFeature=function(a,b,c,d,e,f){var g=!1,h;if(h=c.getImage()){var k=h.getImageState();k==ol.ImageState.LOADED||k==ol.ImageState.ERROR?h.unlistenImageChange(e,f):(k==ol.ImageState.IDLE&&h.load(),h.getImageState(),h.listenImageChange(e,f),g=!0)}ol.renderer.vector.renderFeature_(a,b,c,d);return g};
ol.renderer.vector.renderFeature_=function(a,b,c,d){var e=c.getGeometryFunction()(b);if(e)if(d=e.getSimplifiedGeometry(d),c.getRenderer())ol.renderer.vector.renderGeometry_(a,d,c,b);else(0,ol.renderer.vector.GEOMETRY_RENDERERS_[d.getType()])(a,d,c,b)};
ol.renderer.vector.renderGeometry_=function(a,b,c,d){if(b.getType()==ol.geom.GeometryType.GEOMETRY_COLLECTION){b=b.getGeometries();for(var e=0,f=b.length;e<f;++e)ol.renderer.vector.renderGeometry_(a,b[e],c,d)}else a.getReplay(c.getZIndex(),ol.render.ReplayType.DEFAULT).drawCustom(b,d,c.getRenderer())};
ol.renderer.vector.renderGeometryCollectionGeometry_=function(a,b,c,d){b=b.getGeometriesArray();var e;var f=0;for(e=b.length;f<e;++f)(0,ol.renderer.vector.GEOMETRY_RENDERERS_[b[f].getType()])(a,b[f],c,d)};
ol.renderer.vector.renderLineStringGeometry_=function(a,b,c,d){var e=c.getStroke();if(e){var f=a.getReplay(c.getZIndex(),ol.render.ReplayType.LINE_STRING);f.setFillStrokeStyle(null,e);f.drawLineString(b,d)}if(e=c.getText())c=a.getReplay(c.getZIndex(),ol.render.ReplayType.TEXT),c.setTextStyle(e,a.addDeclutter(!1)),c.drawText(b,d)};
ol.renderer.vector.renderMultiLineStringGeometry_=function(a,b,c,d){var e=c.getStroke();if(e){var f=a.getReplay(c.getZIndex(),ol.render.ReplayType.LINE_STRING);f.setFillStrokeStyle(null,e);f.drawMultiLineString(b,d)}if(e=c.getText())c=a.getReplay(c.getZIndex(),ol.render.ReplayType.TEXT),c.setTextStyle(e,a.addDeclutter(!1)),c.drawText(b,d)};
ol.renderer.vector.renderMultiPolygonGeometry_=function(a,b,c,d){var e=c.getFill(),f=c.getStroke();if(f||e){var g=a.getReplay(c.getZIndex(),ol.render.ReplayType.POLYGON);g.setFillStrokeStyle(e,f);g.drawMultiPolygon(b,d)}if(e=c.getText())c=a.getReplay(c.getZIndex(),ol.render.ReplayType.TEXT),c.setTextStyle(e,a.addDeclutter(!1)),c.drawText(b,d)};
ol.renderer.vector.renderPointGeometry_=function(a,b,c,d){var e=c.getImage();if(e){if(e.getImageState()!=ol.ImageState.LOADED)return;var f=a.getReplay(c.getZIndex(),ol.render.ReplayType.IMAGE);f.setImageStyle(e,a.addDeclutter(!1));f.drawPoint(b,d)}if(f=c.getText())c=a.getReplay(c.getZIndex(),ol.render.ReplayType.TEXT),c.setTextStyle(f,a.addDeclutter(!!e)),c.drawText(b,d)};
ol.renderer.vector.renderMultiPointGeometry_=function(a,b,c,d){var e=c.getImage();if(e){if(e.getImageState()!=ol.ImageState.LOADED)return;var f=a.getReplay(c.getZIndex(),ol.render.ReplayType.IMAGE);f.setImageStyle(e,a.addDeclutter(!1));f.drawMultiPoint(b,d)}if(f=c.getText())c=a.getReplay(c.getZIndex(),ol.render.ReplayType.TEXT),c.setTextStyle(f,a.addDeclutter(!!e)),c.drawText(b,d)};
ol.renderer.vector.renderPolygonGeometry_=function(a,b,c,d){var e=c.getFill(),f=c.getStroke();if(e||f){var g=a.getReplay(c.getZIndex(),ol.render.ReplayType.POLYGON);g.setFillStrokeStyle(e,f);g.drawPolygon(b,d)}if(e=c.getText())c=a.getReplay(c.getZIndex(),ol.render.ReplayType.TEXT),c.setTextStyle(e,a.addDeclutter(!1)),c.drawText(b,d)};
ol.renderer.vector.GEOMETRY_RENDERERS_={Point:ol.renderer.vector.renderPointGeometry_,LineString:ol.renderer.vector.renderLineStringGeometry_,Polygon:ol.renderer.vector.renderPolygonGeometry_,MultiPoint:ol.renderer.vector.renderMultiPointGeometry_,MultiLineString:ol.renderer.vector.renderMultiLineStringGeometry_,MultiPolygon:ol.renderer.vector.renderMultiPolygonGeometry_,GeometryCollection:ol.renderer.vector.renderGeometryCollectionGeometry_,Circle:ol.renderer.vector.renderCircleGeometry_};ol.renderer.canvas.VectorLayer=function(a){ol.renderer.canvas.Layer.call(this,a);this.declutterTree_=a.getDeclutter()?ol.ext.rbush(9):null;this.dirty_=!1;this.renderedRevision_=-1;this.renderedResolution_=NaN;this.renderedExtent_=ol.extent.createEmpty();this.replayGroup_=this.renderedRenderOrder_=null;this.context_=ol.dom.createCanvasContext2D();ol.events.listen(ol.render.canvas.labelCache,ol.events.EventType.CLEAR,this.handleFontsChanged_,this)};ol.inherits(ol.renderer.canvas.VectorLayer,ol.renderer.canvas.Layer);
ol.renderer.canvas.VectorLayer.handles=function(a,b){return a===ol.renderer.Type.CANVAS&&b.getType()===ol.LayerType.VECTOR};ol.renderer.canvas.VectorLayer.create=function(a,b){return new ol.renderer.canvas.VectorLayer(b)};ol.renderer.canvas.VectorLayer.prototype.disposeInternal=function(){ol.events.unlisten(ol.render.canvas.labelCache,ol.events.EventType.CLEAR,this.handleFontsChanged_,this);ol.renderer.canvas.Layer.prototype.disposeInternal.call(this)};
ol.renderer.canvas.VectorLayer.prototype.composeFrame=function(a,b,c){var d=a.extent,e=a.pixelRatio,f=b.managed?a.skippedFeatureUids:{},g=a.viewState,h=g.projection,k=g.rotation,l=h.getExtent(),m=this.getLayer().getSource(),n=this.getTransform(a,0);this.preCompose(c,a,n);var p=b.extent;(g=void 0!==p)&&this.clip(c,a,p);var q=this.replayGroup_;if(q&&!q.isEmpty()){var r=this.getLayer(),u=p=0,v=1!==b.opacity;r=r.hasListener(ol.render.EventType.RENDER);if(v||r){var t=c.canvas.width;var w=c.canvas.height;
if(k){var x=Math.round(Math.sqrt(t*t+w*w));p=(x-t)/2;u=(x-w)/2;t=w=x}this.context_.canvas.width=t;this.context_.canvas.height=w;t=this.context_}else t=c;w=t.globalAlpha;v||(t.globalAlpha=b.opacity);t!=c&&t.translate(p,u);x=a.size[0]*e;e*=a.size[1];ol.render.canvas.rotateAtOffset(t,-k,x/2,e/2);q.replay(t,n,k,f);if(m.getWrapX()&&h.canWrapX()&&!ol.extent.containsExtent(l,d)){h=d[0];m=ol.extent.getWidth(l);for(var z=0;h<l[0];)--z,n=m*z,n=this.getTransform(a,n),q.replay(t,n,k,f),h+=m;z=0;for(h=d[2];h>
l[2];)++z,n=m*z,n=this.getTransform(a,n),q.replay(t,n,k,f),h-=m;n=this.getTransform(a,0)}ol.render.canvas.rotateAtOffset(t,k,x/2,e/2);t!=c&&(r&&this.dispatchRenderEvent(t,a,n),v?(d=c.globalAlpha,c.globalAlpha=b.opacity,c.drawImage(t.canvas,-p,-u),c.globalAlpha=d):c.drawImage(t.canvas,-p,-u),t.translate(-p,-u));v||(t.globalAlpha=w)}g&&c.restore();this.declutterTree_&&this.declutterTree_.clear();this.postCompose(c,a,b,n)};
ol.renderer.canvas.VectorLayer.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){if(this.replayGroup_){var f=b.viewState.resolution;b=b.viewState.rotation;var g=this.getLayer(),h={},k=g.getDeclutter()?{}:null;a=this.replayGroup_.forEachFeatureAtCoordinate(a,f,b,c,{},function(a){var b=ol.getUid(a).toString();if(!(b in h))return h[b]=!0,d.call(e,a,g)},k);this.declutterTree_&&this.declutterTree_.clear();return a}};
ol.renderer.canvas.VectorLayer.prototype.handleFontsChanged_=function(a){a=this.getLayer();a.getVisible()&&this.replayGroup_&&a.changed()};ol.renderer.canvas.VectorLayer.prototype.handleStyleImageChange_=function(a){this.renderIfReadyAndVisible()};
ol.renderer.canvas.VectorLayer.prototype.prepareFrame=function(a,b){var c=this.getLayer();b=c.getSource();this.updateLogos(a,b);var d=a.viewHints[ol.ViewHint.ANIMATING],e=a.viewHints[ol.ViewHint.INTERACTING],f=c.getUpdateWhileAnimating(),g=c.getUpdateWhileInteracting();if(!this.dirty_&&!f&&d||!g&&e)return!0;f=a.extent;var h=a.viewState;g=h.projection;var k=h.resolution,l=a.pixelRatio;d=c.getRevision();var m=c.getRenderBuffer();e=c.getRenderOrder();void 0===e&&(e=ol.renderer.vector.defaultOrder);f=
ol.extent.buffer(f,m*k);m=h.projection.getExtent();b.getWrapX()&&h.projection.canWrapX()&&!ol.extent.containsExtent(m,a.extent)&&(a=ol.extent.getWidth(m),a=Math.max(ol.extent.getWidth(f)/2,a),f[0]=m[0]-a,f[2]=m[2]+a);if(!this.dirty_&&this.renderedResolution_==k&&this.renderedRevision_==d&&this.renderedRenderOrder_==e&&ol.extent.containsExtent(this.renderedExtent_,f))return!0;this.replayGroup_=null;this.dirty_=!1;var n=new ol.render.canvas.ReplayGroup(ol.renderer.vector.getTolerance(k,l),f,k,l,b.getOverlaps(),
this.declutterTree_,c.getRenderBuffer());b.loadFeatures(f,k,g);a=function(a){var b=a.getStyleFunction();if(b)var d=b.call(a,k);else(b=c.getStyleFunction())&&(d=b(a,k));d&&(a=this.renderFeature(a,k,l,d,n),this.dirty_=this.dirty_||a)}.bind(this);if(e){var p=[];b.forEachFeatureInExtent(f,function(a){p.push(a)},this);p.sort(e);b=0;for(g=p.length;b<g;++b)a(p[b])}else b.forEachFeatureInExtent(f,a,this);n.finish();this.renderedResolution_=k;this.renderedRevision_=d;this.renderedRenderOrder_=e;this.renderedExtent_=
f;this.replayGroup_=n;return!0};ol.renderer.canvas.VectorLayer.prototype.renderFeature=function(a,b,c,d,e){if(!d)return!1;var f=!1;if(Array.isArray(d))for(var g=0,h=d.length;g<h;++g)f=ol.renderer.vector.renderFeature(e,a,d[g],ol.renderer.vector.getSquaredTolerance(b,c),this.handleStyleImageChange_,this)||f;else f=ol.renderer.vector.renderFeature(e,a,d,ol.renderer.vector.getSquaredTolerance(b,c),this.handleStyleImageChange_,this);return f};ol.renderer.canvas.VectorTileLayer=function(a){this.context=null;ol.renderer.canvas.TileLayer.call(this,a);this.declutterTree_=a.getDeclutter()?ol.ext.rbush(9):null;this.dirty_=!1;this.tmpTransform_=ol.transform.create();this.zDirection=a.getRenderMode()==ol.layer.VectorTileRenderType.VECTOR?1:0;ol.events.listen(ol.render.canvas.labelCache,ol.events.EventType.CLEAR,this.handleFontsChanged_,this)};ol.inherits(ol.renderer.canvas.VectorTileLayer,ol.renderer.canvas.TileLayer);
ol.renderer.canvas.VectorTileLayer.handles=function(a,b){return a===ol.renderer.Type.CANVAS&&b.getType()===ol.LayerType.VECTOR_TILE};ol.renderer.canvas.VectorTileLayer.create=function(a,b){return new ol.renderer.canvas.VectorTileLayer(b)};ol.renderer.canvas.VectorTileLayer.IMAGE_REPLAYS={image:[ol.render.ReplayType.POLYGON,ol.render.ReplayType.CIRCLE,ol.render.ReplayType.LINE_STRING,ol.render.ReplayType.IMAGE,ol.render.ReplayType.TEXT],hybrid:[ol.render.ReplayType.POLYGON,ol.render.ReplayType.LINE_STRING]};
ol.renderer.canvas.VectorTileLayer.VECTOR_REPLAYS={image:[ol.render.ReplayType.DEFAULT],hybrid:[ol.render.ReplayType.IMAGE,ol.render.ReplayType.TEXT,ol.render.ReplayType.DEFAULT],vector:ol.render.replay.ORDER};ol.renderer.canvas.VectorTileLayer.prototype.disposeInternal=function(){ol.events.unlisten(ol.render.canvas.labelCache,ol.events.EventType.CLEAR,this.handleFontsChanged_,this);ol.renderer.canvas.TileLayer.prototype.disposeInternal.call(this)};
ol.renderer.canvas.VectorTileLayer.prototype.prepareFrame=function(a,b){var c=this.getLayer(),d=c.getRevision();this.renderedLayerRevision_!=d&&(this.renderedTiles.length=0,c=c.getRenderMode(),this.context||c==ol.layer.VectorTileRenderType.VECTOR||(this.context=ol.dom.createCanvasContext2D()),this.context&&c==ol.layer.VectorTileRenderType.VECTOR&&(this.context=null));this.renderedLayerRevision_=d;return ol.renderer.canvas.TileLayer.prototype.prepareFrame.apply(this,arguments)};
ol.renderer.canvas.VectorTileLayer.prototype.createReplayGroup_=function(a,b){var c=this.getLayer(),d=b.pixelRatio;b=b.viewState.projection;var e=c.getRevision(),f=c.getRenderOrder()||null,g=a.getReplayState(c);if(g.dirty||g.renderedRevision!=e||g.renderedRenderOrder!=f){var h=c.getSource(),k=h.getTileGrid(),l=h.getTileGridForProjection(b),m=l.getResolution(a.tileCoord[0]);l=l.getTileCoordExtent(a.wrappedTileCoord);for(var n=0,p=a.tileKeys.length;n<p;++n){var q=a.getTile(a.tileKeys[n]);if(q.getState()!=
ol.TileState.ERROR){var r=k.getTileCoordExtent(q.tileCoord),u=ol.extent.getIntersection(l,r),v=ol.extent.equals(r,u)?null:ol.extent.buffer(u,c.getRenderBuffer()*m),t=q.getProjection(),w=!1;ol.proj.equivalent(b,t)||(w=!0,q.setProjection(b));g.dirty=!1;u=new ol.render.canvas.ReplayGroup(0,u,m,d,h.getOverlaps(),this.declutterTree_,c.getRenderBuffer());var x=ol.renderer.vector.getSquaredTolerance(m,d),z=q.getFeatures();f&&f!==g.renderedRenderOrder&&z.sort(f);for(var y,A=0,C=z.length;A<C;++A)if(y=z[A],
w&&(t.getUnits()==ol.proj.Units.TILE_PIXELS&&(t.setWorldExtent(r),t.setExtent(q.getExtent())),y.getGeometry().transform(t,b)),!v||ol.extent.intersects(v,y.getExtent())){var B=void 0,D=y.getStyleFunction();D?B=D.call(y,m):(D=c.getStyleFunction())&&(B=D(y,m));B&&(B=this.renderFeature(y,x,B,u),this.dirty_=this.dirty_||B,g.dirty=g.dirty||B)}u.finish();for(var E in u.getReplays());q.setReplayGroup(c,a.tileCoord.toString(),u)}}g.renderedRevision=e;g.renderedRenderOrder=f}};
ol.renderer.canvas.VectorTileLayer.prototype.drawTileImage=function(a,b,c,d,e,f,g,h,k){var l=a;this.createReplayGroup_(l,b);this.context&&(this.renderTileImage_(l,b,c),ol.renderer.canvas.TileLayer.prototype.drawTileImage.apply(this,arguments))};
ol.renderer.canvas.VectorTileLayer.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){var f=b.viewState.resolution,g=b.viewState.rotation;c=void 0==c?0:c;var h=this.getLayer(),k=h.getDeclutter()?{}:null,l={},m=this.renderedTiles;b=h.getSource().getTileGridForProjection(b.viewState.projection);var n;var p=0;for(n=m.length;p<n;++p){var q=m[p];var r=q.wrappedTileCoord;r=b.getTileCoordExtent(r,this.tmpExtent);var u=ol.extent.buffer(r,c*f,u);if(ol.extent.containsCoordinate(u,a)){r=0;for(var v=q.tileKeys.length;r<
v;++r){var t=q.getTile(q.tileKeys[r]);if(t.getState()!=ol.TileState.ERROR){t=t.getReplayGroup(h,q.tileCoord.toString());var w=w||t.forEachFeatureAtCoordinate(a,f,g,c,{},function(a){var b=ol.getUid(a).toString();if(!(b in l))return l[b]=!0,d.call(e,a,h)},k)}}}}this.declutterTree_&&this.declutterTree_.clear();return w};
ol.renderer.canvas.VectorTileLayer.prototype.getReplayTransform_=function(a,b){var c=this.getLayer().getSource().getTileGrid(),d=a.tileCoord;a=c.getResolution(d[0]);var e=b.viewState,f=b.pixelRatio,g=e.resolution/f;d=c.getTileCoordExtent(d,this.tmpExtent);c=e.center;d=ol.extent.getTopLeft(d);b=b.size;return ol.transform.compose(this.tmpTransform_,Math.round(f*b[0]/2),Math.round(f*b[1]/2),a/g,a/g,e.rotation,(d[0]-c[0])/a,(c[1]-d[1])/a)};
ol.renderer.canvas.VectorTileLayer.prototype.handleFontsChanged_=function(a){a=this.getLayer();a.getVisible()&&void 0!==this.renderedLayerRevision_&&a.changed()};ol.renderer.canvas.VectorTileLayer.prototype.handleStyleImageChange_=function(a){this.renderIfReadyAndVisible()};
ol.renderer.canvas.VectorTileLayer.prototype.postCompose=function(a,b,c){var d=this.getLayer(),e=d.getDeclutter()?{}:null,f=d.getSource(),g=d.getRenderMode(),h=ol.renderer.canvas.VectorTileLayer.VECTOR_REPLAYS[g],k=b.pixelRatio,l=b.viewState.rotation,m=b.size;ol.render.canvas.rotateAtOffset(a,-l,Math.round(k*m[0]/2),Math.round(k*m[1]/2));k=this.renderedTiles;f=f.getTileGridForProjection(b.viewState.projection);m=[];for(var n=[],p=k.length-1;0<=p;--p){var q=k[p];if(q.getState()!=ol.TileState.ABORT)for(var r=
q.tileCoord,u=f.getTileCoordExtent(r)[0]-f.getTileCoordExtent(q.wrappedTileCoord)[0],v=void 0,t=0,w=q.tileKeys.length;t<w;++t){var x=q.getTile(q.tileKeys[t]);if(x.getState()!=ol.TileState.ERROR){var z=x.getReplayGroup(d,r.toString());if(g==ol.layer.VectorTileRenderType.VECTOR||z.hasReplays(h)){v||(v=this.getTransform(b,u));x=x.tileCoord[0];var y=z.getClipCoords(v);a.save();a.globalAlpha=c.opacity;for(var A=0,C=m.length;A<C;++A){var B=m[A];x<n[A]&&(a.beginPath(),a.moveTo(y[0],y[1]),a.lineTo(y[2],y[3]),
a.lineTo(y[4],y[5]),a.lineTo(y[6],y[7]),a.moveTo(B[6],B[7]),a.lineTo(B[4],B[5]),a.lineTo(B[2],B[3]),a.lineTo(B[0],B[1]),a.clip())}z.replay(a,v,l,{},h,e);a.restore();m.push(y);n.push(x)}}}}e&&(ol.render.canvas.ReplayGroup.replayDeclutter(e,a,l),this.declutterTree_.clear());ol.renderer.canvas.TileLayer.prototype.postCompose.apply(this,arguments)};
ol.renderer.canvas.VectorTileLayer.prototype.renderFeature=function(a,b,c,d){if(!c)return!1;var e=!1;if(Array.isArray(c))for(var f=0,g=c.length;f<g;++f)e=ol.renderer.vector.renderFeature(d,a,c[f],b,this.handleStyleImageChange_,this)||e;else e=ol.renderer.vector.renderFeature(d,a,c,b,this.handleStyleImageChange_,this);return e};
ol.renderer.canvas.VectorTileLayer.prototype.renderTileImage_=function(a,b,c){c=this.getLayer();var d=a.getReplayState(c),e=c.getRevision(),f=ol.renderer.canvas.VectorTileLayer.IMAGE_REPLAYS[c.getRenderMode()];if(f&&d.renderedTileRevision!==e){d.renderedTileRevision=e;var g=a.wrappedTileCoord,h=g[0];d=b.pixelRatio;var k=c.getSource(),l=k.getTileGridForProjection(b.viewState.projection);e=l.getResolution(h);var m=a.getContext(c);b=k.getTilePixelSize(h,d,b.viewState.projection);m.canvas.width=b[0];
m.canvas.height=b[1];b=l.getTileCoordExtent(g);g=0;for(l=a.tileKeys.length;g<l;++g)if(h=a.getTile(a.tileKeys[g]),h.getState()!=ol.TileState.ERROR){k=d/e;var n=ol.transform.reset(this.tmpTransform_);ol.transform.scale(n,k,-k);ol.transform.translate(n,-b[0],-b[3]);h.getReplayGroup(c,a.tileCoord.toString()).replay(m,n,0,{},f)}}};ol.webgl.Shader=function(a){this.source_=a};ol.webgl.Shader.prototype.getType=function(){};ol.webgl.Shader.prototype.getSource=function(){return this.source_};ol.webgl.Shader.prototype.isAnimated=ol.functions.FALSE;ol.webgl.Fragment=function(a){ol.webgl.Shader.call(this,a)};ol.inherits(ol.webgl.Fragment,ol.webgl.Shader);ol.webgl.Fragment.prototype.getType=function(){return ol.webgl.FRAGMENT_SHADER};ol.webgl.Vertex=function(a){ol.webgl.Shader.call(this,a)};ol.inherits(ol.webgl.Vertex,ol.webgl.Shader);ol.webgl.Vertex.prototype.getType=function(){return ol.webgl.VERTEX_SHADER};ol.render.webgl={};ol.render.webgl.circlereplay={};ol.render.webgl.circlereplay.defaultshader={};
ol.render.webgl.circlereplay.defaultshader.fragment=new ol.webgl.Fragment(ol.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n":"precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}");
ol.render.webgl.circlereplay.defaultshader.vertex=new ol.webgl.Vertex(ol.DEBUG_WEBGL?"varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n":
"varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;//Until we get gl_VertexID in WebGL,we store an instruction.if(f==0.0){//Offsetting the edges of the triangle by lineWidth/2 is necessary,however//we should also leave some space for the antialiasing,thus we offset by lineWidth.offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}");ol.render.webgl.circlereplay.defaultshader.Locations=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_projectionMatrix":"h");this.u_offsetScaleMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_offsetScaleMatrix":"i");this.u_offsetRotateMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_offsetRotateMatrix":"j");this.u_lineWidth=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_lineWidth":"k");this.u_pixelRatio=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_pixelRatio":"l");this.u_opacity=
a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_opacity":"m");this.u_fillColor=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_fillColor":"n");this.u_strokeColor=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_strokeColor":"o");this.u_size=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_size":"p");this.a_position=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_position":"e");this.a_instruction=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_instruction":"f");this.a_radius=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_radius":"g")};ol.vec={};ol.vec.Mat4={};ol.vec.Mat4.create=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};ol.vec.Mat4.fromTransform=function(a,b){a[0]=b[0];a[1]=b[1];a[4]=b[2];a[5]=b[3];a[12]=b[4];a[13]=b[5];return a};ol.render.webgl.Replay=function(a,b){ol.render.VectorContext.call(this);this.tolerance=a;this.maxExtent=b;this.origin=ol.extent.getCenter(b);this.projectionMatrix_=ol.transform.create();this.offsetRotateMatrix_=ol.transform.create();this.offsetScaleMatrix_=ol.transform.create();this.tmpMat4_=ol.vec.Mat4.create();this.indices=[];this.indicesBuffer=null;this.startIndices=[];this.startIndicesFeature=[];this.vertices=[];this.verticesBuffer=null;this.lineStringReplay=void 0};
ol.inherits(ol.render.webgl.Replay,ol.render.VectorContext);ol.render.webgl.Replay.prototype.getDeleteResourcesFunction=function(a){};ol.render.webgl.Replay.prototype.finish=function(a){};ol.render.webgl.Replay.prototype.setUpProgram=function(a,b,c,d){};ol.render.webgl.Replay.prototype.shutDownProgram=function(a,b){};ol.render.webgl.Replay.prototype.drawReplay=function(a,b,c,d){};ol.render.webgl.Replay.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,e){};
ol.render.webgl.Replay.prototype.drawHitDetectionReplay=function(a,b,c,d,e,f){return e?this.drawHitDetectionReplayOneByOne(a,b,c,d,f):this.drawHitDetectionReplayAll(a,b,c,d)};ol.render.webgl.Replay.prototype.drawHitDetectionReplayAll=function(a,b,c,d){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);this.drawReplay(a,b,c,!0);if(a=d(null))return a};
ol.render.webgl.Replay.prototype.replay=function(a,b,c,d,e,f,g,h,k,l,m){var n=a.getGL();if(this.lineStringReplay){var p=n.isEnabled(n.STENCIL_TEST);var q=n.getParameter(n.STENCIL_FUNC);var r=n.getParameter(n.STENCIL_VALUE_MASK);var u=n.getParameter(n.STENCIL_REF);var v=n.getParameter(n.STENCIL_WRITEMASK);var t=n.getParameter(n.STENCIL_FAIL);var w=n.getParameter(n.STENCIL_PASS_DEPTH_PASS);var x=n.getParameter(n.STENCIL_PASS_DEPTH_FAIL);n.enable(n.STENCIL_TEST);n.clear(n.STENCIL_BUFFER_BIT);n.stencilMask(255);
n.stencilFunc(n.ALWAYS,1,255);n.stencilOp(n.KEEP,n.KEEP,n.REPLACE);this.lineStringReplay.replay(a,b,c,d,e,f,g,h,k,l,m);n.stencilMask(0);n.stencilFunc(n.NOTEQUAL,1,255)}a.bindBuffer(ol.webgl.ARRAY_BUFFER,this.verticesBuffer);a.bindBuffer(ol.webgl.ELEMENT_ARRAY_BUFFER,this.indicesBuffer);f=this.setUpProgram(n,a,e,f);var z=ol.transform.reset(this.projectionMatrix_);ol.transform.scale(z,2/(c*e[0]),2/(c*e[1]));ol.transform.rotate(z,-d);ol.transform.translate(z,-(b[0]-this.origin[0]),-(b[1]-this.origin[1]));
b=ol.transform.reset(this.offsetScaleMatrix_);ol.transform.scale(b,2/e[0],2/e[1]);e=ol.transform.reset(this.offsetRotateMatrix_);0!==d&&ol.transform.rotate(e,-d);n.uniformMatrix4fv(f.u_projectionMatrix,!1,ol.vec.Mat4.fromTransform(this.tmpMat4_,z));n.uniformMatrix4fv(f.u_offsetScaleMatrix,!1,ol.vec.Mat4.fromTransform(this.tmpMat4_,b));n.uniformMatrix4fv(f.u_offsetRotateMatrix,!1,ol.vec.Mat4.fromTransform(this.tmpMat4_,e));n.uniform1f(f.u_opacity,g);var y;void 0===k?this.drawReplay(n,a,h,!1):y=this.drawHitDetectionReplay(n,
a,h,k,l,m);this.shutDownProgram(n,f);this.lineStringReplay&&(p||n.disable(n.STENCIL_TEST),n.clear(n.STENCIL_BUFFER_BIT),n.stencilFunc(q,u,r),n.stencilMask(v),n.stencilOp(t,x,w));return y};ol.render.webgl.Replay.prototype.drawElements=function(a,b,c,d){a.drawElements(ol.webgl.TRIANGLES,d-c,b.hasOESElementIndexUint?ol.webgl.UNSIGNED_INT:ol.webgl.UNSIGNED_SHORT,c*(b.hasOESElementIndexUint?4:2))};ol.render.webgl.defaultFont="10px sans-serif";ol.render.webgl.defaultFillStyle=[0,0,0,1];ol.render.webgl.defaultLineCap="round";ol.render.webgl.defaultLineDash=[];ol.render.webgl.defaultLineDashOffset=0;ol.render.webgl.defaultLineJoin="round";ol.render.webgl.defaultMiterLimit=10;ol.render.webgl.defaultStrokeStyle=[0,0,0,1];ol.render.webgl.defaultTextAlign=.5;ol.render.webgl.defaultTextBaseline=.5;ol.render.webgl.defaultLineWidth=1;
ol.render.webgl.triangleIsCounterClockwise=function(a,b,c,d,e,f){a=(c-a)*(f-b)-(e-a)*(d-b);return a<=ol.render.webgl.EPSILON&&a>=-ol.render.webgl.EPSILON?void 0:0<a};ol.render.webgl.EPSILON=Number.EPSILON||2.220446049250313E-16;ol.webgl.Buffer=function(a,b){this.arr_=void 0!==a?a:[];this.usage_=void 0!==b?b:ol.webgl.Buffer.Usage_.STATIC_DRAW};ol.webgl.Buffer.prototype.getArray=function(){return this.arr_};ol.webgl.Buffer.prototype.getUsage=function(){return this.usage_};ol.webgl.Buffer.Usage_={STATIC_DRAW:ol.webgl.STATIC_DRAW,STREAM_DRAW:ol.webgl.STREAM_DRAW,DYNAMIC_DRAW:ol.webgl.DYNAMIC_DRAW};ol.render.webgl.CircleReplay=function(a,b){ol.render.webgl.Replay.call(this,a,b);this.defaultLocations_=null;this.styles_=[];this.styleIndices_=[];this.radius_=0;this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}};ol.inherits(ol.render.webgl.CircleReplay,ol.render.webgl.Replay);
ol.render.webgl.CircleReplay.prototype.drawCoordinates_=function(a,b,c,d){for(var e=this.vertices.length,f=this.indices.length,g=e/4;b<c;b+=d)this.vertices[e++]=a[b],this.vertices[e++]=a[b+1],this.vertices[e++]=0,this.vertices[e++]=this.radius_,this.vertices[e++]=a[b],this.vertices[e++]=a[b+1],this.vertices[e++]=1,this.vertices[e++]=this.radius_,this.vertices[e++]=a[b],this.vertices[e++]=a[b+1],this.vertices[e++]=2,this.vertices[e++]=this.radius_,this.vertices[e++]=a[b],this.vertices[e++]=a[b+1],
this.vertices[e++]=3,this.vertices[e++]=this.radius_,this.indices[f++]=g,this.indices[f++]=g+1,this.indices[f++]=g+2,this.indices[f++]=g+2,this.indices[f++]=g+3,this.indices[f++]=g,g+=4};
ol.render.webgl.CircleReplay.prototype.drawCircle=function(a,b){var c=a.getRadius(),d=a.getStride();c?(this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.radius_=c,a=a.getFlatCoordinates(),a=ol.geom.flat.transform.translate(a,0,2,d,-this.origin[0],-this.origin[1]),this.drawCoordinates_(a,0,2,d)):this.state_.changed&&(this.styles_.pop(),this.styles_.length&&(d=this.styles_[this.styles_.length-
1],this.state_.fillColor=d[0],this.state_.strokeColor=d[1],this.state_.lineWidth=d[2],this.state_.changed=!1))};ol.render.webgl.CircleReplay.prototype.finish=function(a){this.verticesBuffer=new ol.webgl.Buffer(this.vertices);this.indicesBuffer=new ol.webgl.Buffer(this.indices);this.startIndices.push(this.indices.length);0===this.styleIndices_.length&&0<this.styles_.length&&(this.styles_=[]);this.indices=this.vertices=null};
ol.render.webgl.CircleReplay.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer;return function(){a.deleteBuffer(b);a.deleteBuffer(c)}};
ol.render.webgl.CircleReplay.prototype.setUpProgram=function(a,b,c,d){var e=b.getProgram(ol.render.webgl.circlereplay.defaultshader.fragment,ol.render.webgl.circlereplay.defaultshader.vertex);if(this.defaultLocations_)var f=this.defaultLocations_;else this.defaultLocations_=f=new ol.render.webgl.circlereplay.defaultshader.Locations(a,e);b.useProgram(e);a.enableVertexAttribArray(f.a_position);a.vertexAttribPointer(f.a_position,2,ol.webgl.FLOAT,!1,16,0);a.enableVertexAttribArray(f.a_instruction);a.vertexAttribPointer(f.a_instruction,
1,ol.webgl.FLOAT,!1,16,8);a.enableVertexAttribArray(f.a_radius);a.vertexAttribPointer(f.a_radius,1,ol.webgl.FLOAT,!1,16,12);a.uniform2fv(f.u_size,c);a.uniform1f(f.u_pixelRatio,d);return f};ol.render.webgl.CircleReplay.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position);a.disableVertexAttribArray(b.a_instruction);a.disableVertexAttribArray(b.a_radius)};
ol.render.webgl.CircleReplay.prototype.drawReplay=function(a,b,c,d){if(ol.obj.isEmpty(c)){var e=this.startIndices[this.startIndices.length-1];for(c=this.styleIndices_.length-1;0<=c;--c){d=this.styleIndices_[c];var f=this.styles_[c];this.setFillStyle_(a,f[0]);this.setStrokeStyle_(a,f[1],f[2]);this.drawElements(a,b,d,e);e=d}}else this.drawReplaySkipping_(a,b,c)};
ol.render.webgl.CircleReplay.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,e){var f,g;var h=this.startIndices.length-2;var k=this.startIndices[h+1];for(f=this.styleIndices_.length-1;0<=f;--f){var l=this.styles_[f];this.setFillStyle_(a,l[0]);this.setStrokeStyle_(a,l[1],l[2]);for(g=this.styleIndices_[f];0<=h&&this.startIndices[h]>=g;){l=this.startIndices[h];var m=this.startIndicesFeature[h];var n=ol.getUid(m).toString();if(void 0===c[n]&&m.getGeometry()&&(void 0===e||ol.extent.intersects(e,
m.getGeometry().getExtent()))&&(a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this.drawElements(a,b,l,k),k=d(m)))return k;h--;k=l}}};
ol.render.webgl.CircleReplay.prototype.drawReplaySkipping_=function(a,b,c){var d,e;var f=this.startIndices.length-2;var g=e=this.startIndices[f+1];for(d=this.styleIndices_.length-1;0<=d;--d){var h=this.styles_[d];this.setFillStyle_(a,h[0]);this.setStrokeStyle_(a,h[1],h[2]);for(h=this.styleIndices_[d];0<=f&&this.startIndices[f]>=h;){var k=this.startIndices[f];var l=this.startIndicesFeature[f];l=ol.getUid(l).toString();c[l]&&(e!==g&&this.drawElements(a,b,e,g),g=k);f--;e=k}e!==g&&this.drawElements(a,
b,e,g);e=g=h}};ol.render.webgl.CircleReplay.prototype.setFillStyle_=function(a,b){a.uniform4fv(this.defaultLocations_.u_fillColor,b)};ol.render.webgl.CircleReplay.prototype.setStrokeStyle_=function(a,b,c){a.uniform4fv(this.defaultLocations_.u_strokeColor,b);a.uniform1f(this.defaultLocations_.u_lineWidth,c)};
ol.render.webgl.CircleReplay.prototype.setFillStrokeStyle=function(a,b){if(b){var c=b.getLineDash();this.state_.lineDash=c?c:ol.render.webgl.defaultLineDash;c=b.getLineDashOffset();this.state_.lineDashOffset=c?c:ol.render.webgl.defaultLineDashOffset;c=b.getColor();c=c instanceof CanvasGradient||c instanceof CanvasPattern?ol.render.webgl.defaultStrokeStyle:ol.color.asArray(c).map(function(a,b){return 3!=b?a/255:a})||ol.render.webgl.defaultStrokeStyle;b=b.getWidth();b=void 0!==b?b:ol.render.webgl.defaultLineWidth}else c=
[0,0,0,0],b=0;a=a?a.getColor():[0,0,0,0];a=a instanceof CanvasGradient||a instanceof CanvasPattern?ol.render.webgl.defaultFillStyle:ol.color.asArray(a).map(function(a,b){return 3!=b?a/255:a})||ol.render.webgl.defaultFillStyle;this.state_.strokeColor&&ol.array.equals(this.state_.strokeColor,c)&&this.state_.fillColor&&ol.array.equals(this.state_.fillColor,a)&&this.state_.lineWidth===b||(this.state_.changed=!0,this.state_.fillColor=a,this.state_.strokeColor=c,this.state_.lineWidth=b,this.styles_.push([a,
c,b]))};ol.render.webgl.texturereplay={};ol.render.webgl.texturereplay.defaultshader={};
ol.render.webgl.texturereplay.defaultshader.fragment=new ol.webgl.Fragment(ol.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");
ol.render.webgl.texturereplay.defaultshader.vertex=new ol.webgl.Vertex(ol.DEBUG_WEBGL?"varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n":
"varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}");ol.render.webgl.texturereplay.defaultshader.Locations=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_projectionMatrix":"h");this.u_offsetScaleMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_offsetScaleMatrix":"i");this.u_offsetRotateMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_offsetRotateMatrix":"j");this.u_opacity=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_opacity":"k");this.u_image=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_image":"l");this.a_position=a.getAttribLocation(b,
ol.DEBUG_WEBGL?"a_position":"c");this.a_texCoord=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_texCoord":"d");this.a_offsets=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_offsets":"e");this.a_opacity=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_opacity":"f");this.a_rotateWithView=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_rotateWithView":"g")};ol.webgl.ContextEventType={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};ol.webgl.Context=function(a,b){this.canvas_=a;this.gl_=b;this.bufferCache_={};this.shaderCache_={};this.programCache_={};this.hitDetectionRenderbuffer_=this.hitDetectionTexture_=this.hitDetectionFramebuffer_=this.currentProgram_=null;(this.hasOESElementIndexUint=ol.array.includes(ol.WEBGL_EXTENSIONS,"OES_element_index_uint"))&&b.getExtension("OES_element_index_uint");ol.events.listen(this.canvas_,ol.webgl.ContextEventType.LOST,this.handleWebGLContextLost,this);ol.events.listen(this.canvas_,ol.webgl.ContextEventType.RESTORED,
this.handleWebGLContextRestored,this)};ol.inherits(ol.webgl.Context,ol.Disposable);
ol.webgl.Context.prototype.bindBuffer=function(a,b){var c=this.getGL(),d=b.getArray(),e=String(ol.getUid(b));if(e in this.bufferCache_)c.bindBuffer(a,this.bufferCache_[e].buffer);else{var f=c.createBuffer();c.bindBuffer(a,f);var g;a==ol.webgl.ARRAY_BUFFER?g=new Float32Array(d):a==ol.webgl.ELEMENT_ARRAY_BUFFER&&(g=this.hasOESElementIndexUint?new Uint32Array(d):new Uint16Array(d));c.bufferData(a,g,b.getUsage());this.bufferCache_[e]={buf:b,buffer:f}}};
ol.webgl.Context.prototype.deleteBuffer=function(a){var b=this.getGL();a=String(ol.getUid(a));var c=this.bufferCache_[a];b.isContextLost()||b.deleteBuffer(c.buffer);delete this.bufferCache_[a]};
ol.webgl.Context.prototype.disposeInternal=function(){ol.events.unlistenAll(this.canvas_);var a=this.getGL();if(!a.isContextLost()){for(var b in this.bufferCache_)a.deleteBuffer(this.bufferCache_[b].buffer);for(b in this.programCache_)a.deleteProgram(this.programCache_[b]);for(b in this.shaderCache_)a.deleteShader(this.shaderCache_[b]);a.deleteFramebuffer(this.hitDetectionFramebuffer_);a.deleteRenderbuffer(this.hitDetectionRenderbuffer_);a.deleteTexture(this.hitDetectionTexture_)}};
ol.webgl.Context.prototype.getCanvas=function(){return this.canvas_};ol.webgl.Context.prototype.getGL=function(){return this.gl_};ol.webgl.Context.prototype.getHitDetectionFramebuffer=function(){this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_();return this.hitDetectionFramebuffer_};
ol.webgl.Context.prototype.getShader=function(a){var b=String(ol.getUid(a));if(b in this.shaderCache_)return this.shaderCache_[b];var c=this.getGL(),d=c.createShader(a.getType());c.shaderSource(d,a.getSource());c.compileShader(d);return this.shaderCache_[b]=d};
ol.webgl.Context.prototype.getProgram=function(a,b){var c=ol.getUid(a)+"/"+ol.getUid(b);if(c in this.programCache_)return this.programCache_[c];var d=this.getGL(),e=d.createProgram();d.attachShader(e,this.getShader(a));d.attachShader(e,this.getShader(b));d.linkProgram(e);return this.programCache_[c]=e};
ol.webgl.Context.prototype.handleWebGLContextLost=function(){ol.obj.clear(this.bufferCache_);ol.obj.clear(this.shaderCache_);ol.obj.clear(this.programCache_);this.hitDetectionRenderbuffer_=this.hitDetectionTexture_=this.hitDetectionFramebuffer_=this.currentProgram_=null};ol.webgl.Context.prototype.handleWebGLContextRestored=function(){};
ol.webgl.Context.prototype.initHitDetectionFramebuffer_=function(){var a=this.gl_,b=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,b);var c=ol.webgl.Context.createEmptyTexture(a,1,1),d=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,d);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,1,1);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,c,0);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,d);a.bindTexture(a.TEXTURE_2D,null);a.bindRenderbuffer(a.RENDERBUFFER,
null);a.bindFramebuffer(a.FRAMEBUFFER,null);this.hitDetectionFramebuffer_=b;this.hitDetectionTexture_=c;this.hitDetectionRenderbuffer_=d};ol.webgl.Context.prototype.useProgram=function(a){if(a==this.currentProgram_)return!1;this.getGL().useProgram(a);this.currentProgram_=a;return!0};
ol.webgl.Context.createTexture_=function(a,b,c){var d=a.createTexture();a.bindTexture(a.TEXTURE_2D,d);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);void 0!==b&&a.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_WRAP_S,b);void 0!==c&&a.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_WRAP_T,c);return d};
ol.webgl.Context.createEmptyTexture=function(a,b,c,d,e){d=ol.webgl.Context.createTexture_(a,d,e);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,b,c,0,a.RGBA,a.UNSIGNED_BYTE,null);return d};ol.webgl.Context.createTexture=function(a,b,c,d){c=ol.webgl.Context.createTexture_(a,c,d);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b);return c};ol.render.webgl.TextureReplay=function(a,b){ol.render.webgl.Replay.call(this,a,b);this.anchorY=this.anchorX=void 0;this.groupIndices=[];this.hitDetectionGroupIndices=[];this.imageWidth=this.imageHeight=this.height=void 0;this.defaultLocations=null;this.width=this.scale=this.rotation=this.rotateWithView=this.originY=this.originX=this.opacity=void 0};ol.inherits(ol.render.webgl.TextureReplay,ol.render.webgl.Replay);
ol.render.webgl.TextureReplay.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer,d=this.getTextures(!0),e=a.getGL();return function(){if(!e.isContextLost()){var f;var g=0;for(f=d.length;g<f;++g)e.deleteTexture(d[g])}a.deleteBuffer(b);a.deleteBuffer(c)}};
ol.render.webgl.TextureReplay.prototype.drawCoordinates=function(a,b,c,d){var e=this.anchorX,f=this.anchorY,g=this.height,h=this.imageHeight,k=this.imageWidth,l=this.opacity,m=this.originX,n=this.originY,p=this.rotateWithView?1:0,q=-this.rotation,r=this.scale,u=this.width,v=Math.cos(q);q=Math.sin(q);for(var t=this.indices.length,w=this.vertices.length,x,z,y,A,C;b<c;b+=d)A=a[b]-this.origin[0],C=a[b+1]-this.origin[1],x=w/8,z=-r*e,y=-r*(g-f),this.vertices[w++]=A,this.vertices[w++]=C,this.vertices[w++]=
z*v-y*q,this.vertices[w++]=z*q+y*v,this.vertices[w++]=m/k,this.vertices[w++]=(n+g)/h,this.vertices[w++]=l,this.vertices[w++]=p,z=r*(u-e),y=-r*(g-f),this.vertices[w++]=A,this.vertices[w++]=C,this.vertices[w++]=z*v-y*q,this.vertices[w++]=z*q+y*v,this.vertices[w++]=(m+u)/k,this.vertices[w++]=(n+g)/h,this.vertices[w++]=l,this.vertices[w++]=p,z=r*(u-e),y=r*f,this.vertices[w++]=A,this.vertices[w++]=C,this.vertices[w++]=z*v-y*q,this.vertices[w++]=z*q+y*v,this.vertices[w++]=(m+u)/k,this.vertices[w++]=n/h,
this.vertices[w++]=l,this.vertices[w++]=p,z=-r*e,y=r*f,this.vertices[w++]=A,this.vertices[w++]=C,this.vertices[w++]=z*v-y*q,this.vertices[w++]=z*q+y*v,this.vertices[w++]=m/k,this.vertices[w++]=n/h,this.vertices[w++]=l,this.vertices[w++]=p,this.indices[t++]=x,this.indices[t++]=x+1,this.indices[t++]=x+2,this.indices[t++]=x,this.indices[t++]=x+2,this.indices[t++]=x+3;return w};
ol.render.webgl.TextureReplay.prototype.createTextures=function(a,b,c,d){var e,f=b.length;for(e=0;e<f;++e){var g=b[e];var h=ol.getUid(g).toString();h in c?g=c[h]:(g=ol.webgl.Context.createTexture(d,g,ol.webgl.CLAMP_TO_EDGE,ol.webgl.CLAMP_TO_EDGE),c[h]=g);a[e]=g}};
ol.render.webgl.TextureReplay.prototype.setUpProgram=function(a,b,c,d){c=b.getProgram(ol.render.webgl.texturereplay.defaultshader.fragment,ol.render.webgl.texturereplay.defaultshader.vertex);this.defaultLocations?d=this.defaultLocations:this.defaultLocations=d=new ol.render.webgl.texturereplay.defaultshader.Locations(a,c);b.useProgram(c);a.enableVertexAttribArray(d.a_position);a.vertexAttribPointer(d.a_position,2,ol.webgl.FLOAT,!1,32,0);a.enableVertexAttribArray(d.a_offsets);a.vertexAttribPointer(d.a_offsets,
2,ol.webgl.FLOAT,!1,32,8);a.enableVertexAttribArray(d.a_texCoord);a.vertexAttribPointer(d.a_texCoord,2,ol.webgl.FLOAT,!1,32,16);a.enableVertexAttribArray(d.a_opacity);a.vertexAttribPointer(d.a_opacity,1,ol.webgl.FLOAT,!1,32,24);a.enableVertexAttribArray(d.a_rotateWithView);a.vertexAttribPointer(d.a_rotateWithView,1,ol.webgl.FLOAT,!1,32,28);return d};
ol.render.webgl.TextureReplay.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position);a.disableVertexAttribArray(b.a_offsets);a.disableVertexAttribArray(b.a_texCoord);a.disableVertexAttribArray(b.a_opacity);a.disableVertexAttribArray(b.a_rotateWithView)};
ol.render.webgl.TextureReplay.prototype.drawReplay=function(a,b,c,d){var e=d?this.getHitDetectionTextures():this.getTextures();d=d?this.hitDetectionGroupIndices:this.groupIndices;if(ol.obj.isEmpty(c)){var f;c=0;var g=e.length;for(f=0;c<g;++c){a.bindTexture(ol.webgl.TEXTURE_2D,e[c]);var h=d[c];this.drawElements(a,b,f,h);f=h}}else this.drawReplaySkipping(a,b,c,e,d)};
ol.render.webgl.TextureReplay.prototype.drawReplaySkipping=function(a,b,c,d,e){var f=0,g;var h=0;for(g=d.length;h<g;++h){a.bindTexture(ol.webgl.TEXTURE_2D,d[h]);for(var k=0<h?e[h-1]:0,l=e[h],m=k;f<this.startIndices.length&&this.startIndices[f]<=l;){var n=ol.getUid(this.startIndicesFeature[f]).toString();void 0!==c[n]?(m!==k&&this.drawElements(a,b,m,k),k=m=f===this.startIndices.length-1?l:this.startIndices[f+1]):k=f===this.startIndices.length-1?l:this.startIndices[f+1];f++}m!==k&&this.drawElements(a,
b,m,k)}};
ol.render.webgl.TextureReplay.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,e){var f,g,h=this.startIndices.length-1,k=this.getHitDetectionTextures();for(f=k.length-1;0<=f;--f){a.bindTexture(ol.webgl.TEXTURE_2D,k[f]);var l=0<f?this.hitDetectionGroupIndices[f-1]:0;for(g=this.hitDetectionGroupIndices[f];0<=h&&this.startIndices[h]>=l;){var m=this.startIndices[h];var n=this.startIndicesFeature[h];var p=ol.getUid(n).toString();if(void 0===c[p]&&n.getGeometry()&&(void 0===e||ol.extent.intersects(e,n.getGeometry().getExtent()))&&
(a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this.drawElements(a,b,m,g),g=d(n)))return g;g=m;h--}}};ol.render.webgl.TextureReplay.prototype.finish=function(a){this.imageWidth=this.imageHeight=this.height=this.anchorY=this.anchorX=void 0;this.indices=null;this.scale=this.rotation=this.rotateWithView=this.originY=this.originX=this.opacity=void 0;this.vertices=null;this.width=void 0};ol.render.webgl.TextureReplay.prototype.getTextures=function(a){};
ol.render.webgl.TextureReplay.prototype.getHitDetectionTextures=function(){};ol.render.webgl.ImageReplay=function(a,b){ol.render.webgl.TextureReplay.call(this,a,b);this.images_=[];this.hitDetectionImages_=[];this.textures_=[];this.hitDetectionTextures_=[]};ol.inherits(ol.render.webgl.ImageReplay,ol.render.webgl.TextureReplay);ol.render.webgl.ImageReplay.prototype.drawMultiPoint=function(a,b){this.startIndices.push(this.indices.length);this.startIndicesFeature.push(b);b=a.getFlatCoordinates();a=a.getStride();this.drawCoordinates(b,0,b.length,a)};
ol.render.webgl.ImageReplay.prototype.drawPoint=function(a,b){this.startIndices.push(this.indices.length);this.startIndicesFeature.push(b);b=a.getFlatCoordinates();a=a.getStride();this.drawCoordinates(b,0,b.length,a)};
ol.render.webgl.ImageReplay.prototype.finish=function(a){var b=a.getGL();this.groupIndices.push(this.indices.length);this.hitDetectionGroupIndices.push(this.indices.length);this.verticesBuffer=new ol.webgl.Buffer(this.vertices);this.indicesBuffer=new ol.webgl.Buffer(this.indices);var c={};this.createTextures(this.textures_,this.images_,c,b);this.createTextures(this.hitDetectionTextures_,this.hitDetectionImages_,c,b);this.hitDetectionImages_=this.images_=null;ol.render.webgl.TextureReplay.prototype.finish.call(this,
a)};
ol.render.webgl.ImageReplay.prototype.setImageStyle=function(a){var b=a.getAnchor(),c=a.getImage(1),d=a.getImageSize(),e=a.getHitDetectionImage(1),f=a.getOpacity(),g=a.getOrigin(),h=a.getRotateWithView(),k=a.getRotation(),l=a.getSize();a=a.getScale();if(0===this.images_.length)this.images_.push(c);else{var m=this.images_[this.images_.length-1];ol.getUid(m)!=ol.getUid(c)&&(this.groupIndices.push(this.indices.length),this.images_.push(c))}0===this.hitDetectionImages_.length?this.hitDetectionImages_.push(e):(m=
this.hitDetectionImages_[this.hitDetectionImages_.length-1],ol.getUid(m)!=ol.getUid(e)&&(this.hitDetectionGroupIndices.push(this.indices.length),this.hitDetectionImages_.push(e)));this.anchorX=b[0];this.anchorY=b[1];this.height=l[1];this.imageHeight=d[1];this.imageWidth=d[0];this.opacity=f;this.originX=g[0];this.originY=g[1];this.rotation=k;this.rotateWithView=h;this.scale=a;this.width=l[0]};
ol.render.webgl.ImageReplay.prototype.getTextures=function(a){return a?this.textures_.concat(this.hitDetectionTextures_):this.textures_};ol.render.webgl.ImageReplay.prototype.getHitDetectionTextures=function(){return this.hitDetectionTextures_};ol.geom.flat.topology={};ol.geom.flat.topology.lineStringIsClosed=function(a,b,c,d){var e=c-d;return a[b]===a[e]&&a[b+1]===a[e+1]&&3<(c-b)/d?!!ol.geom.flat.area.linearRing(a,b,c,d):!1};ol.render.webgl.linestringreplay={};ol.render.webgl.linestringreplay.defaultshader={};
ol.render.webgl.linestringreplay.defaultshader.fragment=new ol.webgl.Fragment(ol.DEBUG_WEBGL?"precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");
ol.render.webgl.linestringreplay.defaultshader.vertex=new ol.webgl.Vertex(ol.DEBUG_WEBGL?"varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n":
"varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}");ol.render.webgl.linestringreplay.defaultshader.Locations=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_projectionMatrix":"h");this.u_offsetScaleMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_offsetScaleMatrix":"i");this.u_offsetRotateMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_offsetRotateMatrix":"j");this.u_lineWidth=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_lineWidth":"k");this.u_miterLimit=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_miterLimit":"l");this.u_opacity=
a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_opacity":"m");this.u_color=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_color":"n");this.u_size=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_size":"o");this.u_pixelRatio=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_pixelRatio":"p");this.a_lastPos=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_lastPos":"d");this.a_position=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_position":"e");this.a_nextPos=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_nextPos":"f");this.a_direction=a.getAttribLocation(b,
ol.DEBUG_WEBGL?"a_direction":"g")};ol.render.webgl.LineStringReplay=function(a,b){ol.render.webgl.Replay.call(this,a,b);this.defaultLocations_=null;this.styles_=[];this.styleIndices_=[];this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}};ol.inherits(ol.render.webgl.LineStringReplay,ol.render.webgl.Replay);
ol.render.webgl.LineStringReplay.prototype.drawCoordinates_=function(a,b,c,d){var e,f=this.vertices.length,g=this.indices.length,h="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,k="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,l=ol.geom.flat.topology.lineStringIsClosed(a,b,c,d),m=g,n=1;for(e=b;e<c;e+=d){var p=f/7;var q=r;var r=u||[a[e],a[e+1]];if(e===b){var u=[a[e+d],a[e+d+1]];if(c-b===2*d&&ol.array.equals(r,u))break;if(l){q=[a[c-2*d],a[c-2*d+1]];var v=u}else{k&&
(f=this.addVertices_([0,0],r,u,n*ol.render.webgl.LineStringReplay.Instruction_.BEGIN_LINE_CAP*k,f),f=this.addVertices_([0,0],r,u,-n*ol.render.webgl.LineStringReplay.Instruction_.BEGIN_LINE_CAP*k,f),this.indices[g++]=p+2,this.indices[g++]=p,this.indices[g++]=p+1,this.indices[g++]=p+1,this.indices[g++]=p+3,this.indices[g++]=p+2);f=this.addVertices_([0,0],r,u,n*ol.render.webgl.LineStringReplay.Instruction_.BEGIN_LINE*(k||1),f);f=this.addVertices_([0,0],r,u,-n*ol.render.webgl.LineStringReplay.Instruction_.BEGIN_LINE*
(k||1),f);m=f/7-1;continue}}else if(e===c-d){l?u=v:(q=q||[0,0],f=this.addVertices_(q,r,[0,0],n*ol.render.webgl.LineStringReplay.Instruction_.END_LINE*(k||1),f),f=this.addVertices_(q,r,[0,0],-n*ol.render.webgl.LineStringReplay.Instruction_.END_LINE*(k||1),f),this.indices[g++]=p,this.indices[g++]=m-1,this.indices[g++]=m,this.indices[g++]=m,this.indices[g++]=p+1,this.indices[g++]=p,k&&(f=this.addVertices_(q,r,[0,0],n*ol.render.webgl.LineStringReplay.Instruction_.END_LINE_CAP*k,f),f=this.addVertices_(q,
r,[0,0],-n*ol.render.webgl.LineStringReplay.Instruction_.END_LINE_CAP*k,f),this.indices[g++]=p+2,this.indices[g++]=p,this.indices[g++]=p+1,this.indices[g++]=p+1,this.indices[g++]=p+3,this.indices[g++]=p+2));break}else u=[a[e+d],a[e+d+1]];var t=ol.render.webgl.triangleIsCounterClockwise(q[0],q[1],r[0],r[1],u[0],u[1])?-1:1;f=this.addVertices_(q,r,u,t*ol.render.webgl.LineStringReplay.Instruction_.BEVEL_FIRST*(h||1),f);f=this.addVertices_(q,r,u,t*ol.render.webgl.LineStringReplay.Instruction_.BEVEL_SECOND*
(h||1),f);f=this.addVertices_(q,r,u,-t*ol.render.webgl.LineStringReplay.Instruction_.MITER_BOTTOM*(h||1),f);e>b&&(this.indices[g++]=p,this.indices[g++]=m-1,this.indices[g++]=m,this.indices[g++]=p+2,this.indices[g++]=p,this.indices[g++]=0<n*t?m:m-1);this.indices[g++]=p;this.indices[g++]=p+2;this.indices[g++]=p+1;m=p+2;n=t;h&&(f=this.addVertices_(q,r,u,t*ol.render.webgl.LineStringReplay.Instruction_.MITER_TOP*h,f),this.indices[g++]=p+1,this.indices[g++]=p+3,this.indices[g++]=p)}l&&(p=p||f/7,t=ol.geom.flat.orient.linearRingIsClockwise([q[0],
q[1],r[0],r[1],u[0],u[1]],0,6,2)?1:-1,f=this.addVertices_(q,r,u,t*ol.render.webgl.LineStringReplay.Instruction_.BEVEL_FIRST*(h||1),f),this.addVertices_(q,r,u,-t*ol.render.webgl.LineStringReplay.Instruction_.MITER_BOTTOM*(h||1),f),this.indices[g++]=p,this.indices[g++]=m-1,this.indices[g++]=m,this.indices[g++]=p+1,this.indices[g++]=p,this.indices[g++]=0<n*t?m:m-1)};
ol.render.webgl.LineStringReplay.prototype.addVertices_=function(a,b,c,d,e){this.vertices[e++]=a[0];this.vertices[e++]=a[1];this.vertices[e++]=b[0];this.vertices[e++]=b[1];this.vertices[e++]=c[0];this.vertices[e++]=c[1];this.vertices[e++]=d;return e};ol.render.webgl.LineStringReplay.prototype.isValid_=function(a,b,c,d){c-=b;return c<2*d?!1:c===2*d?!ol.array.equals([a[b],a[b+1]],[a[b+d],a[b+d+1]]):!0};
ol.render.webgl.LineStringReplay.prototype.drawLineString=function(a,b){var c=a.getFlatCoordinates();a=a.getStride();this.isValid_(c,0,c.length,a)&&(c=ol.geom.flat.transform.translate(c,0,c.length,a,-this.origin[0],-this.origin[1]),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b),this.drawCoordinates_(c,0,c.length,a))};
ol.render.webgl.LineStringReplay.prototype.drawMultiLineString=function(a,b){var c=this.indices.length,d=a.getEnds();d.unshift(0);var e=a.getFlatCoordinates();a=a.getStride();var f;if(1<d.length){var g=1;for(f=d.length;g<f;++g)if(this.isValid_(e,d[g-1],d[g],a)){var h=ol.geom.flat.transform.translate(e,d[g-1],d[g],a,-this.origin[0],-this.origin[1]);this.drawCoordinates_(h,0,h.length,a)}}this.indices.length>c&&(this.startIndices.push(c),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(c),
this.state_.changed=!1))};ol.render.webgl.LineStringReplay.prototype.drawPolygonCoordinates=function(a,b,c){ol.geom.flat.topology.lineStringIsClosed(a,0,a.length,c)||(a.push(a[0]),a.push(a[1]));this.drawCoordinates_(a,0,a.length,c);if(b.length){var d;a=0;for(d=b.length;a<d;++a)ol.geom.flat.topology.lineStringIsClosed(b[a],0,b[a].length,c)||(b[a].push(b[a][0]),b[a].push(b[a][1])),this.drawCoordinates_(b[a],0,b[a].length,c)}};
ol.render.webgl.LineStringReplay.prototype.setPolygonStyle=function(a,b){b=void 0===b?this.indices.length:b;this.startIndices.push(b);this.startIndicesFeature.push(a);this.state_.changed&&(this.styleIndices_.push(b),this.state_.changed=!1)};ol.render.webgl.LineStringReplay.prototype.getCurrentIndex=function(){return this.indices.length};
ol.render.webgl.LineStringReplay.prototype.finish=function(a){this.verticesBuffer=new ol.webgl.Buffer(this.vertices);this.indicesBuffer=new ol.webgl.Buffer(this.indices);this.startIndices.push(this.indices.length);0===this.styleIndices_.length&&0<this.styles_.length&&(this.styles_=[]);this.indices=this.vertices=null};ol.render.webgl.LineStringReplay.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer;return function(){a.deleteBuffer(b);a.deleteBuffer(c)}};
ol.render.webgl.LineStringReplay.prototype.setUpProgram=function(a,b,c,d){var e=b.getProgram(ol.render.webgl.linestringreplay.defaultshader.fragment,ol.render.webgl.linestringreplay.defaultshader.vertex);if(this.defaultLocations_)var f=this.defaultLocations_;else this.defaultLocations_=f=new ol.render.webgl.linestringreplay.defaultshader.Locations(a,e);b.useProgram(e);a.enableVertexAttribArray(f.a_lastPos);a.vertexAttribPointer(f.a_lastPos,2,ol.webgl.FLOAT,!1,28,0);a.enableVertexAttribArray(f.a_position);
a.vertexAttribPointer(f.a_position,2,ol.webgl.FLOAT,!1,28,8);a.enableVertexAttribArray(f.a_nextPos);a.vertexAttribPointer(f.a_nextPos,2,ol.webgl.FLOAT,!1,28,16);a.enableVertexAttribArray(f.a_direction);a.vertexAttribPointer(f.a_direction,1,ol.webgl.FLOAT,!1,28,24);a.uniform2fv(f.u_size,c);a.uniform1f(f.u_pixelRatio,d);return f};
ol.render.webgl.LineStringReplay.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_lastPos);a.disableVertexAttribArray(b.a_position);a.disableVertexAttribArray(b.a_nextPos);a.disableVertexAttribArray(b.a_direction)};
ol.render.webgl.LineStringReplay.prototype.drawReplay=function(a,b,c,d){var e=a.getParameter(a.DEPTH_FUNC),f=a.getParameter(a.DEPTH_WRITEMASK);d||(a.enable(a.DEPTH_TEST),a.depthMask(!0),a.depthFunc(a.NOTEQUAL));if(ol.obj.isEmpty(c)){var g=this.startIndices[this.startIndices.length-1];for(c=this.styleIndices_.length-1;0<=c;--c){var h=this.styleIndices_[c];var k=this.styles_[c];this.setStrokeStyle_(a,k[0],k[1],k[2]);this.drawElements(a,b,h,g);a.clear(a.DEPTH_BUFFER_BIT);g=h}}else this.drawReplaySkipping_(a,
b,c);d||(a.disable(a.DEPTH_TEST),a.clear(a.DEPTH_BUFFER_BIT),a.depthMask(f),a.depthFunc(e))};
ol.render.webgl.LineStringReplay.prototype.drawReplaySkipping_=function(a,b,c){var d,e;var f=this.startIndices.length-2;var g=e=this.startIndices[f+1];for(d=this.styleIndices_.length-1;0<=d;--d){var h=this.styles_[d];this.setStrokeStyle_(a,h[0],h[1],h[2]);for(h=this.styleIndices_[d];0<=f&&this.startIndices[f]>=h;){var k=this.startIndices[f];var l=this.startIndicesFeature[f];l=ol.getUid(l).toString();c[l]&&(e!==g&&(this.drawElements(a,b,e,g),a.clear(a.DEPTH_BUFFER_BIT)),g=k);f--;e=k}e!==g&&(this.drawElements(a,
b,e,g),a.clear(a.DEPTH_BUFFER_BIT));e=g=h}};
ol.render.webgl.LineStringReplay.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,e){var f,g;var h=this.startIndices.length-2;var k=this.startIndices[h+1];for(f=this.styleIndices_.length-1;0<=f;--f){var l=this.styles_[f];this.setStrokeStyle_(a,l[0],l[1],l[2]);for(g=this.styleIndices_[f];0<=h&&this.startIndices[h]>=g;){l=this.startIndices[h];var m=this.startIndicesFeature[h];var n=ol.getUid(m).toString();if(void 0===c[n]&&m.getGeometry()&&(void 0===e||ol.extent.intersects(e,m.getGeometry().getExtent()))&&
(a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this.drawElements(a,b,l,k),k=d(m)))return k;h--;k=l}}};ol.render.webgl.LineStringReplay.prototype.setStrokeStyle_=function(a,b,c,d){a.uniform4fv(this.defaultLocations_.u_color,b);a.uniform1f(this.defaultLocations_.u_lineWidth,c);a.uniform1f(this.defaultLocations_.u_miterLimit,d)};
ol.render.webgl.LineStringReplay.prototype.setFillStrokeStyle=function(a,b){a=b.getLineCap();this.state_.lineCap=void 0!==a?a:ol.render.webgl.defaultLineCap;a=b.getLineDash();this.state_.lineDash=a?a:ol.render.webgl.defaultLineDash;a=b.getLineDashOffset();this.state_.lineDashOffset=a?a:ol.render.webgl.defaultLineDashOffset;a=b.getLineJoin();this.state_.lineJoin=void 0!==a?a:ol.render.webgl.defaultLineJoin;a=b.getColor();a=a instanceof CanvasGradient||a instanceof CanvasPattern?ol.render.webgl.defaultStrokeStyle:
ol.color.asArray(a).map(function(a,b){return 3!=b?a/255:a})||ol.render.webgl.defaultStrokeStyle;var c=b.getWidth();c=void 0!==c?c:ol.render.webgl.defaultLineWidth;b=b.getMiterLimit();b=void 0!==b?b:ol.render.webgl.defaultMiterLimit;this.state_.strokeColor&&ol.array.equals(this.state_.strokeColor,a)&&this.state_.lineWidth===c&&this.state_.miterLimit===b||(this.state_.changed=!0,this.state_.strokeColor=a,this.state_.lineWidth=c,this.state_.miterLimit=b,this.styles_.push([a,c,b]))};
ol.render.webgl.LineStringReplay.Instruction_={ROUND:2,BEGIN_LINE:3,END_LINE:5,BEGIN_LINE_CAP:7,END_LINE_CAP:11,BEVEL_FIRST:13,BEVEL_SECOND:17,MITER_BOTTOM:19,MITER_TOP:23};ol.render.webgl.polygonreplay={};ol.render.webgl.polygonreplay.defaultshader={};ol.render.webgl.polygonreplay.defaultshader.fragment=new ol.webgl.Fragment(ol.DEBUG_WEBGL?"precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");
ol.render.webgl.polygonreplay.defaultshader.vertex=new ol.webgl.Vertex(ol.DEBUG_WEBGL?"\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n":"attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}");ol.render.webgl.polygonreplay.defaultshader.Locations=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_projectionMatrix":"b");this.u_offsetScaleMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_offsetScaleMatrix":"c");this.u_offsetRotateMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_offsetRotateMatrix":"d");this.u_color=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_color":"e");this.u_opacity=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_opacity":"f");this.a_position=a.getAttribLocation(b,
ol.DEBUG_WEBGL?"a_position":"a")};ol.structs.LinkedList=function(a){this.head_=this.last_=this.first_=void 0;this.circular_=void 0===a?!0:a;this.length_=0};ol.structs.LinkedList.prototype.insertItem=function(a){a={prev:void 0,next:void 0,data:a};var b=this.head_;if(b){var c=b.next;a.prev=b;a.next=c;b.next=a;c&&(c.prev=a);b===this.last_&&(this.last_=a)}else this.last_=this.first_=a,this.circular_&&(a.next=a,a.prev=a);this.head_=a;this.length_++};
ol.structs.LinkedList.prototype.removeItem=function(){var a=this.head_;if(a){var b=a.next,c=a.prev;b&&(b.prev=c);c&&(c.next=b);this.head_=b||c;this.first_===this.last_?this.last_=this.first_=this.head_=void 0:this.first_===a?this.first_=this.head_:this.last_===a&&(this.last_=c?this.head_.prev:this.head_);this.length_--}};ol.structs.LinkedList.prototype.firstItem=function(){if(this.head_=this.first_)return this.head_.data};ol.structs.LinkedList.prototype.lastItem=function(){if(this.head_=this.last_)return this.head_.data};
ol.structs.LinkedList.prototype.nextItem=function(){if(this.head_&&this.head_.next)return this.head_=this.head_.next,this.head_.data};ol.structs.LinkedList.prototype.getNextItem=function(){if(this.head_&&this.head_.next)return this.head_.next.data};ol.structs.LinkedList.prototype.prevItem=function(){if(this.head_&&this.head_.prev)return this.head_=this.head_.prev,this.head_.data};ol.structs.LinkedList.prototype.getPrevItem=function(){if(this.head_&&this.head_.prev)return this.head_.prev.data};
ol.structs.LinkedList.prototype.getCurrItem=function(){if(this.head_)return this.head_.data};ol.structs.LinkedList.prototype.setFirstItem=function(){this.circular_&&this.head_&&(this.first_=this.head_,this.last_=this.head_.prev)};
ol.structs.LinkedList.prototype.concat=function(a){if(a.head_){if(this.head_){var b=this.head_.next;this.head_.next=a.first_;a.first_.prev=this.head_;b.prev=a.last_;a.last_.next=b;this.length_+=a.length_}else this.head_=a.head_,this.first_=a.first_,this.last_=a.last_,this.length_=a.length_;a.head_=void 0;a.first_=void 0;a.last_=void 0;a.length_=0}};ol.structs.LinkedList.prototype.getLength=function(){return this.length_};ol.structs.RBush=function(a){this.rbush_=ol.ext.rbush(a);this.items_={}};ol.structs.RBush.prototype.insert=function(a,b){a={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:b};this.rbush_.insert(a);this.items_[ol.getUid(b)]=a};ol.structs.RBush.prototype.load=function(a,b){for(var c=Array(b.length),d=0,e=b.length;d<e;d++){var f=a[d],g=b[d];f={minX:f[0],minY:f[1],maxX:f[2],maxY:f[3],value:g};c[d]=f;this.items_[ol.getUid(g)]=f}this.rbush_.load(c)};
ol.structs.RBush.prototype.remove=function(a){a=ol.getUid(a);var b=this.items_[a];delete this.items_[a];return null!==this.rbush_.remove(b)};ol.structs.RBush.prototype.update=function(a,b){var c=this.items_[ol.getUid(b)];ol.extent.equals([c.minX,c.minY,c.maxX,c.maxY],a)||(this.remove(b),this.insert(a,b))};ol.structs.RBush.prototype.getAll=function(){return this.rbush_.all().map(function(a){return a.value})};
ol.structs.RBush.prototype.getInExtent=function(a){return this.rbush_.search({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}).map(function(a){return a.value})};ol.structs.RBush.prototype.forEach=function(a,b){return this.forEach_(this.getAll(),a,b)};ol.structs.RBush.prototype.forEachInExtent=function(a,b,c){return this.forEach_(this.getInExtent(a),b,c)};ol.structs.RBush.prototype.forEach_=function(a,b,c){for(var d,e=0,f=a.length;e<f&&!(d=b.call(c,a[e]));e++);return d};
ol.structs.RBush.prototype.isEmpty=function(){return ol.obj.isEmpty(this.items_)};ol.structs.RBush.prototype.clear=function(){this.rbush_.clear();this.items_={}};ol.structs.RBush.prototype.getExtent=function(a){var b=this.rbush_.data;return ol.extent.createOrUpdate(b.minX,b.minY,b.maxX,b.maxY,a)};ol.structs.RBush.prototype.concat=function(a){this.rbush_.load(a.rbush_.all());for(var b in a.items_)this.items_[b|0]=a.items_[b|0]};ol.render.webgl.PolygonReplay=function(a,b){ol.render.webgl.Replay.call(this,a,b);this.lineStringReplay=new ol.render.webgl.LineStringReplay(a,b);this.defaultLocations_=null;this.styles_=[];this.styleIndices_=[];this.state_={fillColor:null,changed:!1}};ol.inherits(ol.render.webgl.PolygonReplay,ol.render.webgl.Replay);
ol.render.webgl.PolygonReplay.prototype.drawCoordinates_=function(a,b,c){var d=new ol.structs.LinkedList,e=new ol.structs.RBush;this.processFlatCoordinates_(a,c,d,e,!0);a=this.getMaxCoords_(d);if(b.length){var f,g=[];var h=0;for(f=b.length;h<f;++h){var k={list:new ol.structs.LinkedList,maxCoords:void 0,rtree:new ol.structs.RBush};g.push(k);this.processFlatCoordinates_(b[h],c,k.list,k.rtree,!1);this.classifyPoints_(k.list,k.rtree,!0);k.maxCoords=this.getMaxCoords_(k.list)}g.sort(function(a,b){return b.maxCoords[0]===
a.maxCoords[0]?a.maxCoords[1]-b.maxCoords[1]:b.maxCoords[0]-a.maxCoords[0]});for(h=0;h<g.length;++h){b=g[h].list;f=c=b.firstItem();do{if(this.getIntersections_(f,e).length){var l=!0;break}f=b.nextItem()}while(c!==f);!l&&this.bridgeHole_(b,g[h].maxCoords[0],d,a[0],e)&&(e.concat(g[h].rtree),this.classifyPoints_(d,e,!1))}}else this.classifyPoints_(d,e,!1);this.triangulate_(d,e)};
ol.render.webgl.PolygonReplay.prototype.processFlatCoordinates_=function(a,b,c,d,e){var f=ol.geom.flat.orient.linearRingIsClockwise(a,0,a.length,b),g,h=this.vertices.length/2,k=[],l=[];if(e===f){f=e=this.createPoint_(a[0],a[1],h++);var m=b;for(g=a.length;m<g;m+=b){var n=this.createPoint_(a[m],a[m+1],h++);l.push(this.insertItem_(f,n,c));k.push([Math.min(f.x,n.x),Math.min(f.y,n.y),Math.max(f.x,n.x),Math.max(f.y,n.y)]);f=n}}else for(m=a.length-b,f=e=this.createPoint_(a[m],a[m+1],h++),m-=b,g=0;m>=g;m-=
b)n=this.createPoint_(a[m],a[m+1],h++),l.push(this.insertItem_(f,n,c)),k.push([Math.min(f.x,n.x),Math.min(f.y,n.y),Math.max(f.x,n.x),Math.max(f.y,n.y)]),f=n;l.push(this.insertItem_(n,e,c));k.push([Math.min(f.x,n.x),Math.min(f.y,n.y),Math.max(f.x,n.x),Math.max(f.y,n.y)]);d.load(k,l)};ol.render.webgl.PolygonReplay.prototype.getMaxCoords_=function(a){var b=a.firstItem(),c=b,d=[c.p0.x,c.p0.y];do c=a.nextItem(),c.p0.x>d[0]&&(d=[c.p0.x,c.p0.y]);while(c!==b);return d};
ol.render.webgl.PolygonReplay.prototype.classifyPoints_=function(a,b,c){var d=a.firstItem(),e=d,f=a.nextItem(),g=!1;do{var h=c?ol.render.webgl.triangleIsCounterClockwise(f.p1.x,f.p1.y,e.p1.x,e.p1.y,e.p0.x,e.p0.y):ol.render.webgl.triangleIsCounterClockwise(e.p0.x,e.p0.y,e.p1.x,e.p1.y,f.p1.x,f.p1.y);void 0===h?(this.removeItem_(e,f,a,b),g=!0,f===d&&(d=a.getNextItem()),f=e,a.prevItem()):e.p1.reflex!==h&&(e.p1.reflex=h,g=!0);e=f;f=a.nextItem()}while(e!==d);return g};
ol.render.webgl.PolygonReplay.prototype.bridgeHole_=function(a,b,c,d,e){for(var f=a.firstItem();f.p1.x!==b;)f=a.nextItem();b=f.p1;d={x:d,y:b.y,i:-1};var g=Infinity,h;var k=this.getIntersections_({p0:b,p1:d},e,!0);var l=0;for(h=k.length;l<h;++l){var m=k[l],n=this.calculateIntersection_(b,d,m.p0,m.p1,!0),p=Math.abs(b.x-n[0]);if(p<g&&void 0!==ol.render.webgl.triangleIsCounterClockwise(b.x,b.y,m.p0.x,m.p0.y,m.p1.x,m.p1.y)){g=p;var q={x:n[0],y:n[1],i:-1};f=m}}if(Infinity===g)return!1;k=f.p1;if(0<g&&(f=
this.getPointsInTriangle_(b,q,f.p1,e),f.length))for(q=Infinity,l=0,h=f.length;l<h;++l)if(g=f[l],m=Math.atan2(b.y-g.y,d.x-g.x),m<q||m===q&&g.x<k.x)q=m,k=g;for(f=c.firstItem();f.p1.x!==k.x||f.p1.y!==k.y;)f=c.nextItem();d={x:b.x,y:b.y,i:b.i,reflex:void 0};l={x:f.p1.x,y:f.p1.y,i:f.p1.i,reflex:void 0};a.getNextItem().p0=d;this.insertItem_(b,f.p1,a,e);this.insertItem_(l,d,a,e);f.p1=l;a.setFirstItem();c.concat(a);return!0};
ol.render.webgl.PolygonReplay.prototype.triangulate_=function(a,b){for(var c=!1,d=this.isSimple_(a,b);3<a.getLength();)if(d){if(!this.clipEars_(a,b,d,c)&&!this.classifyPoints_(a,b,c)&&!this.resolveSelfIntersections_(a,b,!0))break}else if(!this.clipEars_(a,b,d,c)&&!this.classifyPoints_(a,b,c)&&!this.resolveSelfIntersections_(a,b))if(d=this.isSimple_(a,b))c=!this.isClockwise_(a),this.classifyPoints_(a,b,c);else{this.splitPolygon_(a,b);break}3===a.getLength()&&(b=this.indices.length,this.indices[b++]=
a.getPrevItem().p0.i,this.indices[b++]=a.getCurrItem().p0.i,this.indices[b++]=a.getNextItem().p0.i)};
ol.render.webgl.PolygonReplay.prototype.clipEars_=function(a,b,c,d){var e=this.indices.length,f=a.firstItem(),g=a.getPrevItem(),h=f,k=a.nextItem(),l=a.getNextItem(),m=!1;do{var n=h.p0;var p=h.p1;var q=k.p1;if(!1===p.reflex){var r=c?0===this.getPointsInTriangle_(n,p,q,b,!0).length:d?this.diagonalIsInside_(l.p1,q,p,n,g.p0):this.diagonalIsInside_(g.p0,n,p,q,l.p1);!c&&0!==this.getIntersections_({p0:n,p1:q},b).length||!r||!c&&!1!==n.reflex&&!1!==q.reflex&&ol.geom.flat.orient.linearRingIsClockwise([g.p0.x,
g.p0.y,n.x,n.y,p.x,p.y,q.x,q.y,l.p1.x,l.p1.y],0,10,2)!==!d||(this.indices[e++]=n.i,this.indices[e++]=p.i,this.indices[e++]=q.i,this.removeItem_(h,k,a,b),k===f&&(f=l),m=!0)}g=a.getPrevItem();h=a.getCurrItem();k=a.nextItem();l=a.getNextItem()}while(h!==f&&3<a.getLength());return m};
ol.render.webgl.PolygonReplay.prototype.resolveSelfIntersections_=function(a,b,c){var d=a.firstItem();a.nextItem();var e=d,f=a.nextItem(),g=!1;do{var h=this.calculateIntersection_(e.p0,e.p1,f.p0,f.p1,c);if(h){g=this.indices.length;var k=this.vertices.length/2,l=a.prevItem();a.removeItem();b.remove(l);var m=l===d;c?(h[0]===e.p0.x&&h[1]===e.p0.y?(a.prevItem(),h=e.p0,f.p0=h,b.remove(e),m=m||e===d):(h=f.p1,e.p1=h,b.remove(f),m=m||f===d),a.removeItem()):(h=this.createPoint_(h[0],h[1],k),e.p1=h,f.p0=h,
b.update([Math.min(e.p0.x,e.p1.x),Math.min(e.p0.y,e.p1.y),Math.max(e.p0.x,e.p1.x),Math.max(e.p0.y,e.p1.y)],e),b.update([Math.min(f.p0.x,f.p1.x),Math.min(f.p0.y,f.p1.y),Math.max(f.p0.x,f.p1.x),Math.max(f.p0.y,f.p1.y)],f));this.indices[g++]=l.p0.i;this.indices[g++]=l.p1.i;this.indices[g++]=h.i;g=!0;if(m)break}e=a.getPrevItem();f=a.nextItem()}while(e!==d);return g};
ol.render.webgl.PolygonReplay.prototype.isSimple_=function(a,b){var c=a.firstItem(),d=c;do{if(this.getIntersections_(d,b).length)return!1;d=a.nextItem()}while(d!==c);return!0};ol.render.webgl.PolygonReplay.prototype.isClockwise_=function(a){var b=2*a.getLength(),c=Array(b),d=a.firstItem(),e=d,f=0;do c[f++]=e.p0.x,c[f++]=e.p0.y,e=a.nextItem();while(e!==d);return ol.geom.flat.orient.linearRingIsClockwise(c,0,b,2)};
ol.render.webgl.PolygonReplay.prototype.splitPolygon_=function(a,b){var c=a.firstItem(),d=c;do{var e=this.getIntersections_(d,b);if(e.length){c=e[0];e=this.vertices.length/2;var f=this.calculateIntersection_(d.p0,d.p1,c.p0,c.p1);e=this.createPoint_(f[0],f[1],e);f=new ol.structs.LinkedList;var g=new ol.structs.RBush;this.insertItem_(e,d.p1,f,g);d.p1=e;b.update([Math.min(d.p0.x,e.x),Math.min(d.p0.y,e.y),Math.max(d.p0.x,e.x),Math.max(d.p0.y,e.y)],d);for(d=a.nextItem();d!==c;)this.insertItem_(d.p0,d.p1,
f,g),b.remove(d),a.removeItem(),d=a.getCurrItem();this.insertItem_(c.p0,e,f,g);c.p0=e;b.update([Math.min(c.p1.x,e.x),Math.min(c.p1.y,e.y),Math.max(c.p1.x,e.x),Math.max(c.p1.y,e.y)],c);this.classifyPoints_(a,b,!1);this.triangulate_(a,b);this.classifyPoints_(f,g,!1);this.triangulate_(f,g);break}d=a.nextItem()}while(d!==c)};ol.render.webgl.PolygonReplay.prototype.createPoint_=function(a,b,c){var d=this.vertices.length;this.vertices[d++]=a;this.vertices[d++]=b;return{x:a,y:b,i:c,reflex:void 0}};
ol.render.webgl.PolygonReplay.prototype.insertItem_=function(a,b,c,d){var e={p0:a,p1:b};c.insertItem(e);d&&d.insert([Math.min(a.x,b.x),Math.min(a.y,b.y),Math.max(a.x,b.x),Math.max(a.y,b.y)],e);return e};ol.render.webgl.PolygonReplay.prototype.removeItem_=function(a,b,c,d){c.getCurrItem()===b&&(c.removeItem(),a.p1=b.p1,d.remove(b),d.update([Math.min(a.p0.x,a.p1.x),Math.min(a.p0.y,a.p1.y),Math.max(a.p0.x,a.p1.x),Math.max(a.p0.y,a.p1.y)],a))};
ol.render.webgl.PolygonReplay.prototype.getPointsInTriangle_=function(a,b,c,d,e){var f,g,h=[],k=d.getInExtent([Math.min(a.x,b.x,c.x),Math.min(a.y,b.y,c.y),Math.max(a.x,b.x,c.x),Math.max(a.y,b.y,c.y)]);d=0;for(f=k.length;d<f;++d)for(g in k[d]){var l=k[d][g];"object"!==typeof l||e&&!l.reflex||l.x===a.x&&l.y===a.y||l.x===b.x&&l.y===b.y||l.x===c.x&&l.y===c.y||-1!==h.indexOf(l)||!ol.geom.flat.contains.linearRingContainsXY([a.x,a.y,b.x,b.y,c.x,c.y],0,6,2,l.x,l.y)||h.push(l)}return h};
ol.render.webgl.PolygonReplay.prototype.getIntersections_=function(a,b,c){var d=a.p0,e=a.p1;b=b.getInExtent([Math.min(d.x,e.x),Math.min(d.y,e.y),Math.max(d.x,e.x),Math.max(d.y,e.y)]);var f=[],g;var h=0;for(g=b.length;h<g;++h){var k=b[h];a!==k&&(c||k.p0!==e||k.p1!==d)&&this.calculateIntersection_(d,e,k.p0,k.p1,c)&&f.push(k)}return f};
ol.render.webgl.PolygonReplay.prototype.calculateIntersection_=function(a,b,c,d,e){var f=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y);if(0!==f&&(d=((d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x))/f,c=((b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x))/f,!e&&d>ol.render.webgl.EPSILON&&d<1-ol.render.webgl.EPSILON&&c>ol.render.webgl.EPSILON&&c<1-ol.render.webgl.EPSILON||e&&0<=d&&1>=d&&0<=c&&1>=c))return[a.x+d*(b.x-a.x),a.y+d*(b.y-a.y)]};
ol.render.webgl.PolygonReplay.prototype.diagonalIsInside_=function(a,b,c,d,e){if(void 0===b.reflex||void 0===d.reflex)return!1;var f=(c.x-d.x)*(b.y-d.y)>(c.y-d.y)*(b.x-d.x);e=(e.x-d.x)*(b.y-d.y)<(e.y-d.y)*(b.x-d.x);a=(a.x-b.x)*(d.y-b.y)>(a.y-b.y)*(d.x-b.x);c=(c.x-b.x)*(d.y-b.y)<(c.y-b.y)*(d.x-b.x);b=b.reflex?c||a:c&&a;return(d.reflex?e||f:e&&f)&&b};
ol.render.webgl.PolygonReplay.prototype.drawMultiPolygon=function(a,b){var c=a.getEndss(),d=a.getStride(),e=this.indices.length,f=this.lineStringReplay.getCurrentIndex();a=a.getFlatCoordinates();var g,h,k;var l=h=0;for(g=c.length;l<g;++l){var m=c[l];if(0<m.length){var n=ol.geom.flat.transform.translate(a,h,m[0],d,-this.origin[0],-this.origin[1]);if(n.length){var p=[];h=1;for(k=m.length;h<k;++h)if(m[h]!==m[h-1]){var q=ol.geom.flat.transform.translate(a,m[h-1],m[h],d,-this.origin[0],-this.origin[1]);
p.push(q)}this.lineStringReplay.drawPolygonCoordinates(n,p,d);this.drawCoordinates_(n,p,d)}}h=m[m.length-1]}this.indices.length>e&&(this.startIndices.push(e),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(e),this.state_.changed=!1));this.lineStringReplay.getCurrentIndex()>f&&this.lineStringReplay.setPolygonStyle(b,f)};
ol.render.webgl.PolygonReplay.prototype.drawPolygon=function(a,b){var c=a.getEnds(),d=a.getStride();if(0<c.length){a=a.getFlatCoordinates().map(Number);var e=ol.geom.flat.transform.translate(a,0,c[0],d,-this.origin[0],-this.origin[1]);if(e.length){var f=[],g;var h=1;for(g=c.length;h<g;++h)if(c[h]!==c[h-1]){var k=ol.geom.flat.transform.translate(a,c[h-1],c[h],d,-this.origin[0],-this.origin[1]);f.push(k)}this.startIndices.push(this.indices.length);this.startIndicesFeature.push(b);this.state_.changed&&
(this.styleIndices_.push(this.indices.length),this.state_.changed=!1);this.lineStringReplay.setPolygonStyle(b);this.lineStringReplay.drawPolygonCoordinates(e,f,d);this.drawCoordinates_(e,f,d)}}};
ol.render.webgl.PolygonReplay.prototype.finish=function(a){this.verticesBuffer=new ol.webgl.Buffer(this.vertices);this.indicesBuffer=new ol.webgl.Buffer(this.indices);this.startIndices.push(this.indices.length);this.lineStringReplay.finish(a);0===this.styleIndices_.length&&0<this.styles_.length&&(this.styles_=[]);this.indices=this.vertices=null};
ol.render.webgl.PolygonReplay.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer,d=this.lineStringReplay.getDeleteResourcesFunction(a);return function(){a.deleteBuffer(b);a.deleteBuffer(c);d()}};
ol.render.webgl.PolygonReplay.prototype.setUpProgram=function(a,b,c,d){c=b.getProgram(ol.render.webgl.polygonreplay.defaultshader.fragment,ol.render.webgl.polygonreplay.defaultshader.vertex);this.defaultLocations_?d=this.defaultLocations_:this.defaultLocations_=d=new ol.render.webgl.polygonreplay.defaultshader.Locations(a,c);b.useProgram(c);a.enableVertexAttribArray(d.a_position);a.vertexAttribPointer(d.a_position,2,ol.webgl.FLOAT,!1,8,0);return d};
ol.render.webgl.PolygonReplay.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position)};
ol.render.webgl.PolygonReplay.prototype.drawReplay=function(a,b,c,d){var e=a.getParameter(a.DEPTH_FUNC),f=a.getParameter(a.DEPTH_WRITEMASK);d||(a.enable(a.DEPTH_TEST),a.depthMask(!0),a.depthFunc(a.NOTEQUAL));if(ol.obj.isEmpty(c)){var g=this.startIndices[this.startIndices.length-1];for(c=this.styleIndices_.length-1;0<=c;--c){var h=this.styleIndices_[c];var k=this.styles_[c];this.setFillStyle_(a,k);this.drawElements(a,b,h,g);g=h}}else this.drawReplaySkipping_(a,b,c);d||(a.disable(a.DEPTH_TEST),a.clear(a.DEPTH_BUFFER_BIT),
a.depthMask(f),a.depthFunc(e))};
ol.render.webgl.PolygonReplay.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,e){var f,g;var h=this.startIndices.length-2;var k=this.startIndices[h+1];for(f=this.styleIndices_.length-1;0<=f;--f){var l=this.styles_[f];this.setFillStyle_(a,l);for(g=this.styleIndices_[f];0<=h&&this.startIndices[h]>=g;){l=this.startIndices[h];var m=this.startIndicesFeature[h];var n=ol.getUid(m).toString();if(void 0===c[n]&&m.getGeometry()&&(void 0===e||ol.extent.intersects(e,m.getGeometry().getExtent()))&&(a.clear(a.COLOR_BUFFER_BIT|
a.DEPTH_BUFFER_BIT),this.drawElements(a,b,l,k),k=d(m)))return k;h--;k=l}}};
ol.render.webgl.PolygonReplay.prototype.drawReplaySkipping_=function(a,b,c){var d,e;var f=this.startIndices.length-2;var g=e=this.startIndices[f+1];for(d=this.styleIndices_.length-1;0<=d;--d){var h=this.styles_[d];this.setFillStyle_(a,h);for(h=this.styleIndices_[d];0<=f&&this.startIndices[f]>=h;){var k=this.startIndices[f];var l=this.startIndicesFeature[f];l=ol.getUid(l).toString();c[l]&&(e!==g&&(this.drawElements(a,b,e,g),a.clear(a.DEPTH_BUFFER_BIT)),g=k);f--;e=k}e!==g&&(this.drawElements(a,b,e,
g),a.clear(a.DEPTH_BUFFER_BIT));e=g=h}};ol.render.webgl.PolygonReplay.prototype.setFillStyle_=function(a,b){a.uniform4fv(this.defaultLocations_.u_color,b)};
ol.render.webgl.PolygonReplay.prototype.setFillStrokeStyle=function(a,b){a=a?a.getColor():[0,0,0,0];a=a instanceof CanvasGradient||a instanceof CanvasPattern?ol.render.webgl.defaultFillStyle:ol.color.asArray(a).map(function(a,b){return 3!=b?a/255:a})||ol.render.webgl.defaultFillStyle;this.state_.fillColor&&ol.array.equals(a,this.state_.fillColor)||(this.state_.fillColor=a,this.state_.changed=!0,this.styles_.push(a));b||(b=new ol.style.Stroke({color:[0,0,0,0],lineWidth:0}));this.lineStringReplay.setFillStrokeStyle(null,
b)};ol.style.Atlas=function(a,b){this.space_=b;this.emptyBlocks_=[{x:0,y:0,width:a,height:a}];this.entries_={};this.context_=ol.dom.createCanvasContext2D(a,a);this.canvas_=this.context_.canvas};ol.style.Atlas.prototype.get=function(a){return this.entries_[a]||null};
ol.style.Atlas.prototype.add=function(a,b,c,d,e){var f;var g=0;for(f=this.emptyBlocks_.length;g<f;++g){var h=this.emptyBlocks_[g];if(h.width>=b+this.space_&&h.height>=c+this.space_)return f={offsetX:h.x+this.space_,offsetY:h.y+this.space_,image:this.canvas_},this.entries_[a]=f,d.call(e,this.context_,h.x+this.space_,h.y+this.space_),this.split_(g,h,b+this.space_,c+this.space_),f}return null};
ol.style.Atlas.prototype.split_=function(a,b,c,d){if(b.width-c>b.height-d){var e={x:b.x+c,y:b.y,width:b.width-c,height:b.height};b={x:b.x,y:b.y+d,width:c,height:b.height-d}}else e={x:b.x+c,y:b.y,width:b.width-c,height:d},b={x:b.x,y:b.y+d,width:b.width,height:b.height-d};this.updateBlocks_(a,e,b)};ol.style.Atlas.prototype.updateBlocks_=function(a,b,c){a=[a,1];0<b.width&&0<b.height&&a.push(b);0<c.width&&0<c.height&&a.push(c);this.emptyBlocks_.splice.apply(this.emptyBlocks_,a)};ol.style.AtlasManager=function(a){a=a||{};this.currentSize_=void 0!==a.initialSize?a.initialSize:ol.INITIAL_ATLAS_SIZE;this.maxSize_=void 0!==a.maxSize?a.maxSize:-1!=ol.MAX_ATLAS_SIZE?ol.MAX_ATLAS_SIZE:void 0!==ol.WEBGL_MAX_TEXTURE_SIZE?ol.WEBGL_MAX_TEXTURE_SIZE:2048;this.space_=void 0!==a.space?a.space:1;this.atlases_=[new ol.style.Atlas(this.currentSize_,this.space_)];this.currentHitSize_=this.currentSize_;this.hitAtlases_=[new ol.style.Atlas(this.currentHitSize_,this.space_)]};
ol.style.AtlasManager.prototype.getInfo=function(a){var b=this.getInfo_(this.atlases_,a);if(!b)return null;a=this.getInfo_(this.hitAtlases_,a);return this.mergeInfos_(b,a)};ol.style.AtlasManager.prototype.getInfo_=function(a,b){var c;var d=0;for(c=a.length;d<c;++d){var e=a[d];if(e=e.get(b))return e}return null};ol.style.AtlasManager.prototype.mergeInfos_=function(a,b){return{offsetX:a.offsetX,offsetY:a.offsetY,image:a.image,hitImage:b.image}};
ol.style.AtlasManager.prototype.add=function(a,b,c,d,e,f){if(b+this.space_>this.maxSize_||c+this.space_>this.maxSize_)return null;d=this.add_(!1,a,b,c,d,f);if(!d)return null;a=this.add_(!0,a,b,c,void 0!==e?e:ol.nullFunction,f);return this.mergeInfos_(d,a)};
ol.style.AtlasManager.prototype.add_=function(a,b,c,d,e,f){var g=a?this.hitAtlases_:this.atlases_,h;var k=0;for(h=g.length;k<h;++k){var l=g[k];if(l=l.add(b,c,d,e,f))return l;l||k!==h-1||(a?this.currentHitSize_=l=Math.min(2*this.currentHitSize_,this.maxSize_):this.currentSize_=l=Math.min(2*this.currentSize_,this.maxSize_),l=new ol.style.Atlas(l,this.space_),g.push(l),++h)}return null};ol.render.webgl.TextReplay=function(a,b){ol.render.webgl.TextureReplay.call(this,a,b);this.images_=[];this.textures_=[];this.measureCanvas_=ol.dom.createCanvasContext2D(0,0).canvas;this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0};this.text_="";this.offsetY_=this.offsetX_=this.textBaseline_=this.textAlign_=void 0;this.atlases_={};this.currAtlas_=void 0;this.opacity=this.scale=1};
ol.inherits(ol.render.webgl.TextReplay,ol.render.webgl.TextureReplay);
ol.render.webgl.TextReplay.prototype.drawText=function(a,b){if(this.text_){var c=null,d=2,e=2;switch(a.getType()){case ol.geom.GeometryType.POINT:case ol.geom.GeometryType.MULTI_POINT:c=a.getFlatCoordinates();d=c.length;e=a.getStride();break;case ol.geom.GeometryType.CIRCLE:c=a.getCenter();break;case ol.geom.GeometryType.LINE_STRING:c=a.getFlatMidpoint();break;case ol.geom.GeometryType.MULTI_LINE_STRING:c=a.getFlatMidpoints();d=c.length;break;case ol.geom.GeometryType.POLYGON:c=a.getFlatInteriorPoint();
break;case ol.geom.GeometryType.MULTI_POLYGON:c=a.getFlatInteriorPoints(),d=c.length}this.startIndices.push(this.indices.length);this.startIndicesFeature.push(b);a=this.currAtlas_;b=this.text_.split("\n");var f=this.getTextSize_(b),g,h,k,l=Math.round(f[0]*this.textAlign_-this.offsetX_),m=Math.round(f[1]*this.textBaseline_-this.offsetY_),n=this.state_.lineWidth/2*this.state_.scale;f=0;for(g=b.length;f<g;++f){var p=0;var q=a.height*f;var r=b[f].split("");var u=0;for(h=r.length;u<h;++u){if(k=a.atlas.getInfo(r[u])){var v=
k.image;this.anchorX=l-p;this.anchorY=m-q;this.originX=0===u?k.offsetX-n:k.offsetX;this.originY=k.offsetY;this.height=a.height;this.width=0===u||u===r.length-1?a.width[r[u]]+n:a.width[r[u]];this.imageHeight=v.height;this.imageWidth=v.width;0===this.images_.length?this.images_.push(v):(k=this.images_[this.images_.length-1],ol.getUid(k)!=ol.getUid(v)&&(this.groupIndices.push(this.indices.length),this.images_.push(v)));this.drawText_(c,0,d,e)}p+=this.width}}}};
ol.render.webgl.TextReplay.prototype.getTextSize_=function(a){var b=this,c=this.currAtlas_,d=a.length*c.height;return[a.map(function(a){var d=0,e;var h=0;for(e=a.length;h<e;++h){var k=a[h];c.width[k]||b.addCharToAtlas_(k);d+=c.width[k]?c.width[k]:0}return d}).reduce(function(a,b){return Math.max(a,b)}),d]};ol.render.webgl.TextReplay.prototype.drawText_=function(a,b,c,d){var e;for(e=b;e<c;e+=d)this.drawCoordinates(a,b,c,d)};
ol.render.webgl.TextReplay.prototype.addCharToAtlas_=function(a){if(1===a.length){var b=this.currAtlas_,c=this.state_,d=this.measureCanvas_.getContext("2d");d.font=c.font;d=Math.ceil(d.measureText(a).width*c.scale);b.atlas.add(a,d,b.height,function(b,d,g){b.font=c.font;b.fillStyle=c.fillColor;b.strokeStyle=c.strokeColor;b.lineWidth=c.lineWidth;b.lineCap=c.lineCap;b.lineJoin=c.lineJoin;b.miterLimit=c.miterLimit;b.textAlign="left";b.textBaseline="top";ol.has.CANVAS_LINE_DASH&&c.lineDash&&(b.setLineDash(c.lineDash),
b.lineDashOffset=c.lineDashOffset);1!==c.scale&&b.setTransform(c.scale,0,0,c.scale,0,0);c.strokeColor&&b.strokeText(a,d,g);c.fillColor&&b.fillText(a,d,g)})&&(b.width[a]=d)}};
ol.render.webgl.TextReplay.prototype.finish=function(a){var b=a.getGL();this.groupIndices.push(this.indices.length);this.hitDetectionGroupIndices=this.groupIndices;this.verticesBuffer=new ol.webgl.Buffer(this.vertices);this.indicesBuffer=new ol.webgl.Buffer(this.indices);this.createTextures(this.textures_,this.images_,{},b);this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0};this.text_=
"";this.offsetY_=this.offsetX_=this.textBaseline_=this.textAlign_=void 0;this.images_=null;this.atlases_={};this.currAtlas_=void 0;ol.render.webgl.TextureReplay.prototype.finish.call(this,a)};
ol.render.webgl.TextReplay.prototype.setTextStyle=function(a){var b=this.state_,c=a.getFill(),d=a.getStroke();a&&a.getText()&&(c||d)?(c?(c=c.getColor(),b.fillColor=ol.colorlike.asColorLike(c?c:ol.render.webgl.defaultFillStyle)):b.fillColor=null,d?(c=d.getColor(),b.strokeColor=ol.colorlike.asColorLike(c?c:ol.render.webgl.defaultStrokeStyle),b.lineWidth=d.getWidth()||ol.render.webgl.defaultLineWidth,b.lineCap=d.getLineCap()||ol.render.webgl.defaultLineCap,b.lineDashOffset=d.getLineDashOffset()||ol.render.webgl.defaultLineDashOffset,
b.lineJoin=d.getLineJoin()||ol.render.webgl.defaultLineJoin,b.miterLimit=d.getMiterLimit()||ol.render.webgl.defaultMiterLimit,d=d.getLineDash(),b.lineDash=d?d.slice():ol.render.webgl.defaultLineDash):(b.strokeColor=null,b.lineWidth=0),b.font=a.getFont()||ol.render.webgl.defaultFont,b.scale=a.getScale()||1,this.text_=a.getText(),d=ol.render.replay.TEXT_ALIGN[a.getTextAlign()],c=ol.render.replay.TEXT_ALIGN[a.getTextBaseline()],this.textAlign_=void 0===d?ol.render.webgl.defaultTextAlign:d,this.textBaseline_=
void 0===c?ol.render.webgl.defaultTextBaseline:c,this.offsetX_=a.getOffsetX()||0,this.offsetY_=a.getOffsetY()||0,this.rotateWithView=!!a.getRotateWithView(),this.rotation=a.getRotation()||0,this.currAtlas_=this.getAtlas_(b)):this.text_=""};
ol.render.webgl.TextReplay.prototype.getAtlas_=function(a){var b=[];for(c in a)if(a[c]||0===a[c])Array.isArray(a[c])?b=b.concat(a[c]):b.push(a[c]);b=this.calculateHash_(b);if(!this.atlases_[b]){var c=this.measureCanvas_.getContext("2d");c.font=a.font;c=Math.ceil((1.5*c.measureText("M").width+a.lineWidth/2)*a.scale);this.atlases_[b]={atlas:new ol.style.AtlasManager({space:a.lineWidth+1}),width:{},height:c}}return this.atlases_[b]};
ol.render.webgl.TextReplay.prototype.calculateHash_=function(a){var b,c="";var d=0;for(b=a.length;d<b;++d)c+=a[d];return c};ol.render.webgl.TextReplay.prototype.getTextures=function(a){return this.textures_};ol.render.webgl.TextReplay.prototype.getHitDetectionTextures=function(){return this.textures_};ol.render.webgl.ReplayGroup=function(a,b,c){ol.render.ReplayGroup.call(this);this.maxExtent_=b;this.tolerance_=a;this.renderBuffer_=c;this.replaysByZIndex_={}};ol.inherits(ol.render.webgl.ReplayGroup,ol.render.ReplayGroup);ol.render.webgl.ReplayGroup.prototype.addDeclutter=function(a,b){};
ol.render.webgl.ReplayGroup.prototype.getDeleteResourcesFunction=function(a){var b=[],c;for(c in this.replaysByZIndex_){var d=this.replaysByZIndex_[c],e;for(e in d)b.push(d[e].getDeleteResourcesFunction(a))}return function(){for(var a=b.length,c,d=0;d<a;d++)c=b[d].apply(this,arguments);return c}};ol.render.webgl.ReplayGroup.prototype.finish=function(a){for(var b in this.replaysByZIndex_){var c=this.replaysByZIndex_[b],d;for(d in c)c[d].finish(a)}};
ol.render.webgl.ReplayGroup.prototype.getReplay=function(a,b){var c=void 0!==a?a.toString():"0";a=this.replaysByZIndex_[c];void 0===a&&(a={},this.replaysByZIndex_[c]=a);c=a[b];void 0===c&&(c=new ol.render.webgl.ReplayGroup.BATCH_CONSTRUCTORS_[b](this.tolerance_,this.maxExtent_),a[b]=c);return c};ol.render.webgl.ReplayGroup.prototype.isEmpty=function(){return ol.obj.isEmpty(this.replaysByZIndex_)};
ol.render.webgl.ReplayGroup.prototype.replay=function(a,b,c,d,e,f,g,h){var k=Object.keys(this.replaysByZIndex_).map(Number);k.sort(ol.array.numberSafeCompareFunction);var l,m;var n=0;for(l=k.length;n<l;++n){var p=this.replaysByZIndex_[k[n].toString()];var q=0;for(m=ol.render.replay.ORDER.length;q<m;++q){var r=p[ol.render.replay.ORDER[q]];void 0!==r&&r.replay(a,b,c,d,e,f,g,h,void 0,!1)}}};
ol.render.webgl.ReplayGroup.prototype.replayHitDetection_=function(a,b,c,d,e,f,g,h,k,l,m){var n=Object.keys(this.replaysByZIndex_).map(Number);n.sort(function(a,b){return b-a});var p,q;var r=0;for(p=n.length;r<p;++r){var u=this.replaysByZIndex_[n[r].toString()];for(q=ol.render.replay.ORDER.length-1;0<=q;--q){var v=u[ol.render.replay.ORDER[q]];if(void 0!==v&&(v=v.replay(a,b,c,d,e,f,g,h,k,l,m)))return v}}};
ol.render.webgl.ReplayGroup.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,f,g,h,k,l){var m=b.getGL();m.bindFramebuffer(m.FRAMEBUFFER,b.getHitDetectionFramebuffer());var n;void 0!==this.renderBuffer_&&(n=ol.extent.buffer(ol.extent.createOrUpdateFromCoordinate(a),d*this.renderBuffer_));return this.replayHitDetection_(b,a,d,e,ol.render.webgl.ReplayGroup.HIT_DETECTION_SIZE_,g,h,k,function(a){var b=new Uint8Array(4);m.readPixels(0,0,1,1,m.RGBA,m.UNSIGNED_BYTE,b);if(0<b[3]&&(a=l(a)))return a},
!0,n)};ol.render.webgl.ReplayGroup.prototype.hasFeatureAtCoordinate=function(a,b,c,d,e,f,g,h,k){var l=b.getGL();l.bindFramebuffer(l.FRAMEBUFFER,b.getHitDetectionFramebuffer());return void 0!==this.replayHitDetection_(b,a,d,e,ol.render.webgl.ReplayGroup.HIT_DETECTION_SIZE_,g,h,k,function(a){a=new Uint8Array(4);l.readPixels(0,0,1,1,l.RGBA,l.UNSIGNED_BYTE,a);return 0<a[3]},!1)};ol.render.webgl.ReplayGroup.HIT_DETECTION_SIZE_=[1,1];
ol.render.webgl.ReplayGroup.BATCH_CONSTRUCTORS_={Circle:ol.render.webgl.CircleReplay,Image:ol.render.webgl.ImageReplay,LineString:ol.render.webgl.LineStringReplay,Polygon:ol.render.webgl.PolygonReplay,Text:ol.render.webgl.TextReplay};ol.render.webgl.Immediate=function(a,b,c,d,e,f,g){ol.render.VectorContext.call(this);this.context_=a;this.center_=b;this.extent_=f;this.pixelRatio_=g;this.size_=e;this.rotation_=d;this.resolution_=c;this.textStyle_=this.strokeStyle_=this.fillStyle_=this.imageStyle_=null};ol.inherits(ol.render.webgl.Immediate,ol.render.VectorContext);
ol.render.webgl.Immediate.prototype.drawText_=function(a,b){var c=this.context_;a=a.getReplay(0,ol.render.ReplayType.TEXT);a.setTextStyle(this.textStyle_);a.drawText(b,null);a.finish(c);a.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);a.getDeleteResourcesFunction(c)()};ol.render.webgl.Immediate.prototype.setStyle=function(a){this.setFillStrokeStyle(a.getFill(),a.getStroke());this.setImageStyle(a.getImage());this.setTextStyle(a.getText())};
ol.render.webgl.Immediate.prototype.drawGeometry=function(a){switch(a.getType()){case ol.geom.GeometryType.POINT:this.drawPoint(a,null);break;case ol.geom.GeometryType.LINE_STRING:this.drawLineString(a,null);break;case ol.geom.GeometryType.POLYGON:this.drawPolygon(a,null);break;case ol.geom.GeometryType.MULTI_POINT:this.drawMultiPoint(a,null);break;case ol.geom.GeometryType.MULTI_LINE_STRING:this.drawMultiLineString(a,null);break;case ol.geom.GeometryType.MULTI_POLYGON:this.drawMultiPolygon(a,null);
break;case ol.geom.GeometryType.GEOMETRY_COLLECTION:this.drawGeometryCollection(a,null);break;case ol.geom.GeometryType.CIRCLE:this.drawCircle(a,null)}};ol.render.webgl.Immediate.prototype.drawFeature=function(a,b){(a=b.getGeometryFunction()(a))&&ol.extent.intersects(this.extent_,a.getExtent())&&(this.setStyle(b),this.drawGeometry(a))};ol.render.webgl.Immediate.prototype.drawGeometryCollection=function(a,b){a=a.getGeometriesArray();var c;b=0;for(c=a.length;b<c;++b)this.drawGeometry(a[b])};
ol.render.webgl.Immediate.prototype.drawPoint=function(a,b){var c=this.context_,d=new ol.render.webgl.ReplayGroup(1,this.extent_),e=d.getReplay(0,ol.render.ReplayType.IMAGE);e.setImageStyle(this.imageStyle_);e.drawPoint(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};
ol.render.webgl.Immediate.prototype.drawMultiPoint=function(a,b){var c=this.context_,d=new ol.render.webgl.ReplayGroup(1,this.extent_),e=d.getReplay(0,ol.render.ReplayType.IMAGE);e.setImageStyle(this.imageStyle_);e.drawMultiPoint(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};
ol.render.webgl.Immediate.prototype.drawLineString=function(a,b){var c=this.context_,d=new ol.render.webgl.ReplayGroup(1,this.extent_),e=d.getReplay(0,ol.render.ReplayType.LINE_STRING);e.setFillStrokeStyle(null,this.strokeStyle_);e.drawLineString(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};
ol.render.webgl.Immediate.prototype.drawMultiLineString=function(a,b){var c=this.context_,d=new ol.render.webgl.ReplayGroup(1,this.extent_),e=d.getReplay(0,ol.render.ReplayType.LINE_STRING);e.setFillStrokeStyle(null,this.strokeStyle_);e.drawMultiLineString(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};
ol.render.webgl.Immediate.prototype.drawPolygon=function(a,b){var c=this.context_,d=new ol.render.webgl.ReplayGroup(1,this.extent_),e=d.getReplay(0,ol.render.ReplayType.POLYGON);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_);e.drawPolygon(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};
ol.render.webgl.Immediate.prototype.drawMultiPolygon=function(a,b){var c=this.context_,d=new ol.render.webgl.ReplayGroup(1,this.extent_),e=d.getReplay(0,ol.render.ReplayType.POLYGON);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_);e.drawMultiPolygon(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};
ol.render.webgl.Immediate.prototype.drawCircle=function(a,b){var c=this.context_,d=new ol.render.webgl.ReplayGroup(1,this.extent_),e=d.getReplay(0,ol.render.ReplayType.CIRCLE);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_);e.drawCircle(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};
ol.render.webgl.Immediate.prototype.setImageStyle=function(a){this.imageStyle_=a};ol.render.webgl.Immediate.prototype.setFillStrokeStyle=function(a,b){this.fillStyle_=a;this.strokeStyle_=b};ol.render.webgl.Immediate.prototype.setTextStyle=function(a){this.textStyle_=a};ol.renderer.webgl={};ol.renderer.webgl.defaultmapshader={};ol.renderer.webgl.defaultmapshader.fragment=new ol.webgl.Fragment(ol.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n":"precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}");
ol.renderer.webgl.defaultmapshader.vertex=new ol.webgl.Vertex(ol.DEBUG_WEBGL?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}");ol.renderer.webgl.defaultmapshader.Locations=function(a,b){this.u_texCoordMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_texCoordMatrix":"d");this.u_projectionMatrix=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_projectionMatrix":"e");this.u_opacity=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_opacity":"f");this.u_texture=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_texture":"g");this.a_position=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_position":"b");this.a_texCoord=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_texCoord":
"c")};ol.renderer.webgl.Layer=function(a,b){ol.renderer.Layer.call(this,b);this.mapRenderer=a;this.arrayBuffer_=new ol.webgl.Buffer([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]);this.framebuffer=this.texture=null;this.framebufferDimension=void 0;this.texCoordMatrix=ol.transform.create();this.projectionMatrix=ol.transform.create();this.tmpMat4_=ol.vec.Mat4.create();this.defaultLocations_=null};ol.inherits(ol.renderer.webgl.Layer,ol.renderer.Layer);
ol.renderer.webgl.Layer.prototype.bindFramebuffer=function(a,b){var c=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=b){var d=function(a,b,c){a.isContextLost()||(a.deleteFramebuffer(b),a.deleteTexture(c))}.bind(null,c,this.framebuffer,this.texture);a.postRenderFunctions.push(d);a=ol.webgl.Context.createEmptyTexture(c,b,b);d=c.createFramebuffer();c.bindFramebuffer(ol.webgl.FRAMEBUFFER,d);c.framebufferTexture2D(ol.webgl.FRAMEBUFFER,ol.webgl.COLOR_ATTACHMENT0,
ol.webgl.TEXTURE_2D,a,0);this.texture=a;this.framebuffer=d;this.framebufferDimension=b}else c.bindFramebuffer(ol.webgl.FRAMEBUFFER,this.framebuffer)};
ol.renderer.webgl.Layer.prototype.composeFrame=function(a,b,c){this.dispatchComposeEvent_(ol.render.EventType.PRECOMPOSE,c,a);c.bindBuffer(ol.webgl.ARRAY_BUFFER,this.arrayBuffer_);var d=c.getGL(),e=c.getProgram(ol.renderer.webgl.defaultmapshader.fragment,ol.renderer.webgl.defaultmapshader.vertex);if(this.defaultLocations_)var f=this.defaultLocations_;else this.defaultLocations_=f=new ol.renderer.webgl.defaultmapshader.Locations(d,e);c.useProgram(e)&&(d.enableVertexAttribArray(f.a_position),d.vertexAttribPointer(f.a_position,
2,ol.webgl.FLOAT,!1,16,0),d.enableVertexAttribArray(f.a_texCoord),d.vertexAttribPointer(f.a_texCoord,2,ol.webgl.FLOAT,!1,16,8),d.uniform1i(f.u_texture,0));d.uniformMatrix4fv(f.u_texCoordMatrix,!1,ol.vec.Mat4.fromTransform(this.tmpMat4_,this.getTexCoordMatrix()));d.uniformMatrix4fv(f.u_projectionMatrix,!1,ol.vec.Mat4.fromTransform(this.tmpMat4_,this.getProjectionMatrix()));d.uniform1f(f.u_opacity,b.opacity);d.bindTexture(ol.webgl.TEXTURE_2D,this.getTexture());d.drawArrays(ol.webgl.TRIANGLE_STRIP,0,
4);this.dispatchComposeEvent_(ol.render.EventType.POSTCOMPOSE,c,a)};ol.renderer.webgl.Layer.prototype.dispatchComposeEvent_=function(a,b,c){var d=this.getLayer();if(d.hasListener(a)){var e=c.viewState;e=new ol.render.webgl.Immediate(b,e.center,e.resolution,e.rotation,c.size,c.extent,c.pixelRatio);a=new ol.render.Event(a,e,c,null,b);d.dispatchEvent(a)}};ol.renderer.webgl.Layer.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix};ol.renderer.webgl.Layer.prototype.getTexture=function(){return this.texture};
ol.renderer.webgl.Layer.prototype.getProjectionMatrix=function(){return this.projectionMatrix};ol.renderer.webgl.Layer.prototype.handleWebGLContextLost=function(){this.framebuffer=this.texture=null;this.framebufferDimension=void 0};ol.renderer.webgl.Layer.prototype.prepareFrame=function(a,b,c){};ol.renderer.webgl.Layer.prototype.forEachLayerAtPixel=function(a,b,c,d){};ol.source.ImageCanvas=function(a){ol.source.Image.call(this,{attributions:a.attributions,logo:a.logo,projection:a.projection,resolutions:a.resolutions,state:a.state});this.canvasFunction_=a.canvasFunction;this.canvas_=null;this.renderedRevision_=0;this.ratio_=void 0!==a.ratio?a.ratio:1.5};ol.inherits(ol.source.ImageCanvas,ol.source.Image);
ol.source.ImageCanvas.prototype.getImageInternal=function(a,b,c,d){b=this.findNearestResolution(b);var e=this.canvas_;if(e&&this.renderedRevision_==this.getRevision()&&e.getResolution()==b&&e.getPixelRatio()==c&&ol.extent.containsExtent(e.getExtent(),a))return e;a=a.slice();ol.extent.scaleFromCenter(a,this.ratio_);var f=ol.extent.getWidth(a)/b,g=ol.extent.getHeight(a)/b;(d=this.canvasFunction_(a,b,c,[f*c,g*c],d))&&(e=new ol.ImageCanvas(a,b,c,d));this.canvas_=e;this.renderedRevision_=this.getRevision();
return e};ol.source.ImageVector=function(a){this.source_=a.source;this.transform_=ol.transform.create();this.canvasContext_=ol.dom.createCanvasContext2D();this.canvasSize_=[0,0];this.declutterTree_=ol.ext.rbush(9);this.renderBuffer_=void 0==a.renderBuffer?100:a.renderBuffer;this.replayGroup_=null;ol.source.ImageCanvas.call(this,{attributions:a.attributions,canvasFunction:this.canvasFunctionInternal_.bind(this),logo:a.logo,projection:a.projection,ratio:a.ratio,resolutions:a.resolutions,state:this.source_.getState()});
this.style_=null;this.styleFunction_=void 0;this.setStyle(a.style);ol.events.listen(this.source_,ol.events.EventType.CHANGE,this.handleSourceChange_,this)};ol.inherits(ol.source.ImageVector,ol.source.ImageCanvas);
ol.source.ImageVector.prototype.canvasFunctionInternal_=function(a,b,c,d,e){var f=new ol.render.canvas.ReplayGroup(ol.renderer.vector.getTolerance(b,c),a,b,c,this.source_.getOverlaps(),this.declutterTree_,this.renderBuffer_);this.source_.loadFeatures(a,b,e);var g=!1;this.source_.forEachFeatureInExtent(a,function(a){g=g||this.renderFeature_(a,b,c,f)},this);f.finish();if(g)return null;this.canvasSize_[0]!=d[0]||this.canvasSize_[1]!=d[1]?(this.canvasContext_.canvas.width=d[0],this.canvasContext_.canvas.height=
d[1],this.canvasSize_[0]=d[0],this.canvasSize_[1]=d[1]):this.canvasContext_.clearRect(0,0,d[0],d[1]);a=this.getTransform_(ol.extent.getCenter(a),b,c,d);f.replay(this.canvasContext_,a,0,{});this.replayGroup_=f;this.declutterTree_.clear();return this.canvasContext_.canvas};
ol.source.ImageVector.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,f){if(this.replayGroup_){var g={};a=this.replayGroup_.forEachFeatureAtCoordinate(a,b,0,d,e,function(a){var b=ol.getUid(a).toString();if(!(b in g))return g[b]=!0,f(a)},null);this.declutterTree_.clear();return a}};ol.source.ImageVector.prototype.getSource=function(){return this.source_};ol.source.ImageVector.prototype.getStyle=function(){return this.style_};ol.source.ImageVector.prototype.getStyleFunction=function(){return this.styleFunction_};
ol.source.ImageVector.prototype.getTransform_=function(a,b,c,d){b=c/b;return ol.transform.compose(this.transform_,d[0]/2,d[1]/2,b,-b,0,-a[0],-a[1])};ol.source.ImageVector.prototype.handleImageChange_=function(a){this.changed()};ol.source.ImageVector.prototype.handleSourceChange_=function(){this.setState(this.source_.getState())};
ol.source.ImageVector.prototype.renderFeature_=function(a,b,c,d){var e,f=a.getStyleFunction();f?e=f.call(a,b):this.styleFunction_&&(e=this.styleFunction_(a,b));if(!e)return!1;var g,h=!1;Array.isArray(e)||(e=[e]);f=0;for(g=e.length;f<g;++f)h=ol.renderer.vector.renderFeature(d,a,e[f],ol.renderer.vector.getSquaredTolerance(b,c),this.handleImageChange_,this)||h;return h};
ol.source.ImageVector.prototype.setStyle=function(a){this.style_=void 0!==a?a:ol.style.Style.defaultFunction;this.styleFunction_=a?ol.style.Style.createFunction(this.style_):void 0;this.changed()};ol.renderer.webgl.ImageLayer=function(a,b){ol.renderer.webgl.Layer.call(this,a,b);this.hitTransformationMatrix_=this.hitCanvasContext_=this.image_=null};ol.inherits(ol.renderer.webgl.ImageLayer,ol.renderer.webgl.Layer);ol.renderer.webgl.ImageLayer.handles=function(a,b){return a===ol.renderer.Type.WEBGL&&b.getType()===ol.LayerType.IMAGE};ol.renderer.webgl.ImageLayer.create=function(a,b){return new ol.renderer.webgl.ImageLayer(a,b)};
ol.renderer.webgl.ImageLayer.prototype.createTexture_=function(a){a=a.getImage();var b=this.mapRenderer.getGL();return ol.webgl.Context.createTexture(b,a,ol.webgl.CLAMP_TO_EDGE,ol.webgl.CLAMP_TO_EDGE)};ol.renderer.webgl.ImageLayer.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){var f=this.getLayer();return f.getSource().forEachFeatureAtCoordinate(a,b.viewState.resolution,b.viewState.rotation,c,b.skippedFeatureUids,function(a){return d.call(e,a,f)})};
ol.renderer.webgl.ImageLayer.prototype.prepareFrame=function(a,b,c){var d=this.mapRenderer.getGL(),e=a.pixelRatio,f=a.viewState,g=f.center,h=f.resolution,k=f.rotation;c=this.image_;var l=this.texture,m=this.getLayer().getSource(),n=a.viewHints,p=a.extent;void 0!==b.extent&&(p=ol.extent.getIntersection(p,b.extent));n[ol.ViewHint.ANIMATING]||n[ol.ViewHint.INTERACTING]||ol.extent.isEmpty(p)||(b=f.projection,ol.ENABLE_RASTER_REPROJECTION||(f=m.getProjection())&&(b=f),(p=m.getImage(p,h,e,b))&&this.loadImage(p)&&
(c=p,l=this.createTexture_(p),this.texture&&(d=function(a,b){a.isContextLost()||a.deleteTexture(b)}.bind(null,d,this.texture),a.postRenderFunctions.push(d))));c&&(d=this.mapRenderer.getContext().getCanvas(),this.updateProjectionMatrix_(d.width,d.height,e,g,h,k,c.getExtent()),this.hitTransformationMatrix_=null,e=this.texCoordMatrix,ol.transform.reset(e),ol.transform.scale(e,1,-1),ol.transform.translate(e,0,-1),this.image_=c,this.texture=l,this.updateLogos(a,m));return!!c};
ol.renderer.webgl.ImageLayer.prototype.updateProjectionMatrix_=function(a,b,c,d,e,f,g){a*=e;b*=e;e=this.projectionMatrix;ol.transform.reset(e);ol.transform.scale(e,2*c/a,2*c/b);ol.transform.rotate(e,-f);ol.transform.translate(e,g[0]-d[0],g[1]-d[1]);ol.transform.scale(e,(g[2]-g[0])/2,(g[3]-g[1])/2);ol.transform.translate(e,1,1)};ol.renderer.webgl.ImageLayer.prototype.hasFeatureAtCoordinate=function(a,b){return void 0!==this.forEachFeatureAtCoordinate(a,b,0,ol.functions.TRUE,this)};
ol.renderer.webgl.ImageLayer.prototype.forEachLayerAtPixel=function(a,b,c,d){if(this.image_&&this.image_.getImage())if(this.getLayer().getSource()instanceof ol.source.ImageVector){var e=ol.transform.apply(b.pixelToCoordinateTransform,a.slice());if(this.forEachFeatureAtCoordinate(e,b,0,ol.functions.TRUE,this))return c.call(d,this.getLayer(),null)}else if(e=[this.image_.getImage().width,this.image_.getImage().height],this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(b.size,
e)),b=ol.transform.apply(this.hitTransformationMatrix_,a.slice()),!(0>b[0]||b[0]>e[0]||0>b[1]||b[1]>e[1])&&(this.hitCanvasContext_||(this.hitCanvasContext_=ol.dom.createCanvasContext2D(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.image_.getImage(),b[0],b[1],1,1,0,0,1,1),b=this.hitCanvasContext_.getImageData(0,0,1,1).data,0<b[3]))return c.call(d,this.getLayer(),b)};
ol.renderer.webgl.ImageLayer.prototype.getHitTransformationMatrix_=function(a,b){var c=ol.transform.create();ol.transform.translate(c,-1,-1);ol.transform.scale(c,2/a[0],2/a[1]);ol.transform.translate(c,0,a[1]);ol.transform.scale(c,1,-1);a=ol.transform.invert(this.projectionMatrix.slice());var d=ol.transform.create();ol.transform.translate(d,0,b[1]);ol.transform.scale(d,1,-1);ol.transform.scale(d,b[0]/2,b[1]/2);ol.transform.translate(d,1,1);ol.transform.multiply(d,a);ol.transform.multiply(d,c);return d};ol.renderer.webgl.Map=function(a,b){ol.renderer.Map.call(this,a,b);this.canvas_=document.createElement("CANVAS");this.canvas_.style.width="100%";this.canvas_.style.height="100%";this.canvas_.style.display="block";this.canvas_.className=ol.css.CLASS_UNSELECTABLE;a.insertBefore(this.canvas_,a.childNodes[0]||null);this.clipTileCanvasHeight_=this.clipTileCanvasWidth_=0;this.clipTileContext_=ol.dom.createCanvasContext2D();this.renderedVisible_=!0;this.gl_=ol.webgl.getContext(this.canvas_,{antialias:!0,
depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0});this.context_=new ol.webgl.Context(this.canvas_,this.gl_);ol.events.listen(this.canvas_,ol.webgl.ContextEventType.LOST,this.handleWebGLContextLost,this);ol.events.listen(this.canvas_,ol.webgl.ContextEventType.RESTORED,this.handleWebGLContextRestored,this);this.textureCache_=new ol.structs.LRUCache;this.focus_=null;this.tileTextureQueue_=new ol.structs.PriorityQueue(function(a){var b=a[1];a=a[2];var c=b[0]-this.focus_[0];
b=b[1]-this.focus_[1];return 65536*Math.log(a)+Math.sqrt(c*c+b*b)/a}.bind(this),function(a){return a[0].getKey()});this.loadNextTileTexture_=function(a,b){this.tileTextureQueue_.isEmpty()||(this.tileTextureQueue_.reprioritize(),a=this.tileTextureQueue_.dequeue(),this.bindTileTexture(a[0],a[3],a[4],ol.webgl.LINEAR,ol.webgl.LINEAR));return!1}.bind(this);this.textureCacheFrameMarkerCount_=0;this.initializeGL_()};ol.inherits(ol.renderer.webgl.Map,ol.renderer.Map);
ol.renderer.webgl.Map.handles=function(a){return ol.has.WEBGL&&a===ol.renderer.Type.WEBGL};ol.renderer.webgl.Map.create=function(a,b){return new ol.renderer.webgl.Map(a,b)};
ol.renderer.webgl.Map.prototype.bindTileTexture=function(a,b,c,d,e){var f=this.getGL(),g=a.getKey();if(this.textureCache_.containsKey(g))a=this.textureCache_.get(g),f.bindTexture(ol.webgl.TEXTURE_2D,a.texture),a.magFilter!=d&&(f.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_MAG_FILTER,d),a.magFilter=d),a.minFilter!=e&&(f.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_MIN_FILTER,e),a.minFilter=e);else{var h=f.createTexture();f.bindTexture(ol.webgl.TEXTURE_2D,h);if(0<c){var k=this.clipTileContext_.canvas,
l=this.clipTileContext_;this.clipTileCanvasWidth_!==b[0]||this.clipTileCanvasHeight_!==b[1]?(k.width=b[0],k.height=b[1],this.clipTileCanvasWidth_=b[0],this.clipTileCanvasHeight_=b[1]):l.clearRect(0,0,b[0],b[1]);l.drawImage(a.getImage(),c,c,b[0],b[1],0,0,b[0],b[1]);f.texImage2D(ol.webgl.TEXTURE_2D,0,ol.webgl.RGBA,ol.webgl.RGBA,ol.webgl.UNSIGNED_BYTE,k)}else f.texImage2D(ol.webgl.TEXTURE_2D,0,ol.webgl.RGBA,ol.webgl.RGBA,ol.webgl.UNSIGNED_BYTE,a.getImage());f.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_MAG_FILTER,
d);f.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_MIN_FILTER,e);f.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_WRAP_S,ol.webgl.CLAMP_TO_EDGE);f.texParameteri(ol.webgl.TEXTURE_2D,ol.webgl.TEXTURE_WRAP_T,ol.webgl.CLAMP_TO_EDGE);this.textureCache_.set(g,{texture:h,magFilter:d,minFilter:e})}};
ol.renderer.webgl.Map.prototype.dispatchComposeEvent_=function(a,b){var c=this.getMap();if(c.hasListener(a)){var d=this.context_,e=b.viewState;e=new ol.render.webgl.Immediate(d,e.center,e.resolution,e.rotation,b.size,b.extent,b.pixelRatio);a=new ol.render.Event(a,e,b,null,d);c.dispatchEvent(a)}};ol.renderer.webgl.Map.prototype.disposeInternal=function(){var a=this.getGL();a.isContextLost()||this.textureCache_.forEach(function(b){b&&a.deleteTexture(b.texture)});this.context_.dispose();ol.renderer.Map.prototype.disposeInternal.call(this)};
ol.renderer.webgl.Map.prototype.expireCache_=function(a,b){a=this.getGL();for(var c;this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>ol.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK;){if(c=this.textureCache_.peekLast())a.deleteTexture(c.texture);else if(+this.textureCache_.peekLastKey()==b.index)break;else--this.textureCacheFrameMarkerCount_;this.textureCache_.pop()}};ol.renderer.webgl.Map.prototype.getContext=function(){return this.context_};ol.renderer.webgl.Map.prototype.getGL=function(){return this.gl_};
ol.renderer.webgl.Map.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_};ol.renderer.webgl.Map.prototype.getType=function(){return ol.renderer.Type.WEBGL};ol.renderer.webgl.Map.prototype.handleWebGLContextLost=function(a){a.preventDefault();this.textureCache_.clear();this.textureCacheFrameMarkerCount_=0;a=this.getLayerRenderers();for(var b in a)a[b].handleWebGLContextLost()};ol.renderer.webgl.Map.prototype.handleWebGLContextRestored=function(){this.initializeGL_();this.getMap().render()};
ol.renderer.webgl.Map.prototype.initializeGL_=function(){var a=this.gl_;a.activeTexture(ol.webgl.TEXTURE0);a.blendFuncSeparate(ol.webgl.SRC_ALPHA,ol.webgl.ONE_MINUS_SRC_ALPHA,ol.webgl.ONE,ol.webgl.ONE_MINUS_SRC_ALPHA);a.disable(ol.webgl.CULL_FACE);a.disable(ol.webgl.DEPTH_TEST);a.disable(ol.webgl.SCISSOR_TEST);a.disable(ol.webgl.STENCIL_TEST)};ol.renderer.webgl.Map.prototype.isTileTextureLoaded=function(a){return this.textureCache_.containsKey(a.getKey())};
ol.renderer.webgl.Map.prototype.renderFrame=function(a){var b=this.getContext(),c=this.getGL();if(c.isContextLost())return!1;if(!a)return this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1),!1;this.focus_=a.focus;this.textureCache_.set((-a.index).toString(),null);++this.textureCacheFrameMarkerCount_;this.dispatchComposeEvent_(ol.render.EventType.PRECOMPOSE,a);var d=[],e=a.layerStatesArray;ol.array.stableSort(e,ol.renderer.Map.sortByZIndex);var f=a.viewState.resolution,
g;var h=0;for(g=e.length;h<g;++h){var k=e[h];if(ol.layer.Layer.visibleAtResolution(k,f)&&k.sourceState==ol.source.State.READY){var l=this.getLayerRenderer(k.layer);l.prepareFrame(a,k,b)&&d.push(k)}}e=a.size[0]*a.pixelRatio;f=a.size[1]*a.pixelRatio;if(this.canvas_.width!=e||this.canvas_.height!=f)this.canvas_.width=e,this.canvas_.height=f;c.bindFramebuffer(ol.webgl.FRAMEBUFFER,null);c.clearColor(0,0,0,0);c.clear(ol.webgl.COLOR_BUFFER_BIT);c.enable(ol.webgl.BLEND);c.viewport(0,0,this.canvas_.width,
this.canvas_.height);h=0;for(g=d.length;h<g;++h)k=d[h],l=this.getLayerRenderer(k.layer),l.composeFrame(a,k,b);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0);this.calculateMatrices2D(a);this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>ol.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK&&a.postRenderFunctions.push(this.expireCache_.bind(this));this.tileTextureQueue_.isEmpty()||(a.postRenderFunctions.push(this.loadNextTileTexture_),a.animate=!0);this.dispatchComposeEvent_(ol.render.EventType.POSTCOMPOSE,
a);this.scheduleRemoveUnusedLayerRenderers(a);this.scheduleExpireIconCache(a)};ol.renderer.webgl.Map.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,f,g){if(this.getGL().isContextLost())return!1;var h=b.viewState,k=b.layerStatesArray,l;for(l=k.length-1;0<=l;--l){var m=k[l];var n=m.layer;if(ol.layer.Layer.visibleAtResolution(m,h.resolution)&&f.call(g,n)&&(m=this.getLayerRenderer(n).forEachFeatureAtCoordinate(a,b,c,d,e)))return m}};
ol.renderer.webgl.Map.prototype.hasFeatureAtCoordinate=function(a,b,c,d,e){c=!1;if(this.getGL().isContextLost())return!1;var f=b.viewState,g=b.layerStatesArray,h;for(h=g.length-1;0<=h;--h){var k=g[h],l=k.layer;if(ol.layer.Layer.visibleAtResolution(k,f.resolution)&&d.call(e,l)&&(c=this.getLayerRenderer(l).hasFeatureAtCoordinate(a,b)))return!0}return c};
ol.renderer.webgl.Map.prototype.forEachLayerAtPixel=function(a,b,c,d,e,f){if(this.getGL().isContextLost())return!1;f=b.viewState;var g=b.layerStatesArray,h;for(h=g.length-1;0<=h;--h){var k=g[h];var l=k.layer;if(ol.layer.Layer.visibleAtResolution(k,f.resolution)&&e.call(d,l)&&(k=this.getLayerRenderer(l).forEachLayerAtPixel(a,b,c,d)))return k}};ol.renderer.webgl.tilelayershader={};ol.renderer.webgl.tilelayershader.fragment=new ol.webgl.Fragment(ol.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n":"precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}");
ol.renderer.webgl.tilelayershader.vertex=new ol.webgl.Vertex(ol.DEBUG_WEBGL?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}");ol.renderer.webgl.tilelayershader.Locations=function(a,b){this.u_tileOffset=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_tileOffset":"d");this.u_texture=a.getUniformLocation(b,ol.DEBUG_WEBGL?"u_texture":"e");this.a_position=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_position":"b");this.a_texCoord=a.getAttribLocation(b,ol.DEBUG_WEBGL?"a_texCoord":"c")};ol.renderer.webgl.TileLayer=function(a,b){ol.renderer.webgl.Layer.call(this,a,b);this.fragmentShader_=ol.renderer.webgl.tilelayershader.fragment;this.vertexShader_=ol.renderer.webgl.tilelayershader.vertex;this.locations_=null;this.renderArrayBuffer_=new ol.webgl.Buffer([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]);this.renderedFramebufferExtent_=this.renderedTileRange_=null;this.renderedRevision_=-1;this.tmpSize_=[0,0]};ol.inherits(ol.renderer.webgl.TileLayer,ol.renderer.webgl.Layer);
ol.renderer.webgl.TileLayer.handles=function(a,b){return a===ol.renderer.Type.WEBGL&&b.getType()===ol.LayerType.TILE};ol.renderer.webgl.TileLayer.create=function(a,b){return new ol.renderer.webgl.TileLayer(a,b)};ol.renderer.webgl.TileLayer.prototype.disposeInternal=function(){this.mapRenderer.getContext().deleteBuffer(this.renderArrayBuffer_);ol.renderer.webgl.Layer.prototype.disposeInternal.call(this)};
ol.renderer.webgl.TileLayer.prototype.createLoadedTileFinder=function(a,b,c){var d=this.mapRenderer;return function(e,f){return a.forEachLoadedTile(b,e,f,function(a){var b=d.isTileTextureLoaded(a);b&&(c[e]||(c[e]={}),c[e][a.tileCoord.toString()]=a);return b})}};ol.renderer.webgl.TileLayer.prototype.handleWebGLContextLost=function(){ol.renderer.webgl.Layer.prototype.handleWebGLContextLost.call(this);this.locations_=null};
ol.renderer.webgl.TileLayer.prototype.prepareFrame=function(a,b,c){var d=this.mapRenderer,e=c.getGL(),f=a.viewState,g=f.projection,h=this.getLayer(),k=h.getSource(),l=k.getTileGridForProjection(g),m=l.getZForResolution(f.resolution),n=l.getResolution(m),p=k.getTilePixelSize(m,a.pixelRatio,g),q=p[0]/ol.size.toSize(l.getTileSize(m),this.tmpSize_)[0],r=n/q,u=k.getTilePixelRatio(q)*k.getGutter(g),v=f.center,t=a.extent,w=l.getTileRangeForExtentAndZ(t,m);if(this.renderedTileRange_&&this.renderedTileRange_.equals(w)&&
this.renderedRevision_==k.getRevision())r=this.renderedFramebufferExtent_;else{var x=w.getSize(),z=ol.math.roundUpToPowerOfTwo(Math.max(x[0]*p[0],x[1]*p[1]));x=r*z;var y=l.getOrigin(m),A=y[0]+w.minX*p[0]*r;r=y[1]+w.minY*p[1]*r;r=[A,r,A+x,r+x];this.bindFramebuffer(a,z);e.viewport(0,0,z,z);e.clearColor(0,0,0,0);e.clear(ol.webgl.COLOR_BUFFER_BIT);e.disable(ol.webgl.BLEND);z=c.getProgram(this.fragmentShader_,this.vertexShader_);c.useProgram(z);this.locations_||(this.locations_=new ol.renderer.webgl.tilelayershader.Locations(e,
z));c.bindBuffer(ol.webgl.ARRAY_BUFFER,this.renderArrayBuffer_);e.enableVertexAttribArray(this.locations_.a_position);e.vertexAttribPointer(this.locations_.a_position,2,ol.webgl.FLOAT,!1,16,0);e.enableVertexAttribArray(this.locations_.a_texCoord);e.vertexAttribPointer(this.locations_.a_texCoord,2,ol.webgl.FLOAT,!1,16,8);e.uniform1i(this.locations_.u_texture,0);c={};c[m]={};var C=this.createLoadedTileFinder(k,g,c),B=h.getUseInterimTilesOnError();z=!0;A=ol.extent.createEmpty();var D=new ol.TileRange(0,
0,0,0),E,G;for(E=w.minX;E<=w.maxX;++E)for(G=w.minY;G<=w.maxY;++G){y=k.getTile(m,E,G,q,g);if(void 0!==b.extent){var F=l.getTileCoordExtent(y.tileCoord,A);if(!ol.extent.intersects(F,b.extent))continue}F=y.getState();(F=F==ol.TileState.LOADED||F==ol.TileState.EMPTY||F==ol.TileState.ERROR&&!B)||(y=y.getInterimTile());F=y.getState();if(F==ol.TileState.LOADED){if(d.isTileTextureLoaded(y)){c[m][y.tileCoord.toString()]=y;continue}}else if(F==ol.TileState.EMPTY||F==ol.TileState.ERROR&&!B)continue;z=!1;F=l.forEachTileCoordParentTileRange(y.tileCoord,
C,null,D,A);F||(y=l.getTileCoordChildTileRange(y.tileCoord,D,A))&&C(m+1,y)}b=Object.keys(c).map(Number);b.sort(ol.array.numberSafeCompareFunction);C=new Float32Array(4);var H;B=0;for(D=b.length;B<D;++B)for(H in E=c[b[B]],E)y=E[H],F=l.getTileCoordExtent(y.tileCoord,A),C[0]=2*(F[2]-F[0])/x,C[1]=2*(F[3]-F[1])/x,C[2]=2*(F[0]-r[0])/x-1,C[3]=2*(F[1]-r[1])/x-1,e.uniform4fv(this.locations_.u_tileOffset,C),d.bindTileTexture(y,p,u*q,ol.webgl.LINEAR,ol.webgl.LINEAR),e.drawArrays(ol.webgl.TRIANGLE_STRIP,0,4);
z?(this.renderedTileRange_=w,this.renderedFramebufferExtent_=r,this.renderedRevision_=k.getRevision()):(this.renderedFramebufferExtent_=this.renderedTileRange_=null,this.renderedRevision_=-1,a.animate=!0)}this.updateUsedTiles(a.usedTiles,k,m,w);var I=d.getTileTextureQueue();this.manageTilePyramid(a,k,l,q,g,t,m,h.getPreload(),function(a){a.getState()!=ol.TileState.LOADED||d.isTileTextureLoaded(a)||I.isKeyQueued(a.getKey())||I.enqueue([a,l.getTileCoordCenter(a.tileCoord),l.getResolution(a.tileCoord[0]),
p,u*q])},this);this.scheduleExpireCache(a,k);this.updateLogos(a,k);e=this.texCoordMatrix;ol.transform.reset(e);ol.transform.translate(e,(Math.round(v[0]/n)*n-r[0])/(r[2]-r[0]),(Math.round(v[1]/n)*n-r[1])/(r[3]-r[1]));0!==f.rotation&&ol.transform.rotate(e,f.rotation);ol.transform.scale(e,a.size[0]*f.resolution/(r[2]-r[0]),a.size[1]*f.resolution/(r[3]-r[1]));ol.transform.translate(e,-.5,-.5);return!0};
ol.renderer.webgl.TileLayer.prototype.forEachLayerAtPixel=function(a,b,c,d){if(this.framebuffer){a=ol.transform.apply(this.texCoordMatrix,[a[0]/b.size[0],(b.size[1]-a[1])/b.size[1]].slice());a=[a[0]*this.framebufferDimension,a[1]*this.framebufferDimension];b=this.mapRenderer.getContext().getGL();b.bindFramebuffer(b.FRAMEBUFFER,this.framebuffer);var e=new Uint8Array(4);b.readPixels(a[0],a[1],1,1,b.RGBA,b.UNSIGNED_BYTE,e);if(0<e[3])return c.call(d,this.getLayer(),e)}};ol.renderer.webgl.VectorLayer=function(a,b){ol.renderer.webgl.Layer.call(this,a,b);this.dirty_=!1;this.renderedRevision_=-1;this.renderedResolution_=NaN;this.renderedExtent_=ol.extent.createEmpty();this.layerState_=this.replayGroup_=this.renderedRenderOrder_=null};ol.inherits(ol.renderer.webgl.VectorLayer,ol.renderer.webgl.Layer);ol.renderer.webgl.VectorLayer.handles=function(a,b){return a===ol.renderer.Type.WEBGL&&b.getType()===ol.LayerType.VECTOR};
ol.renderer.webgl.VectorLayer.create=function(a,b){return new ol.renderer.webgl.VectorLayer(a,b)};ol.renderer.webgl.VectorLayer.prototype.composeFrame=function(a,b,c){this.layerState_=b;var d=a.viewState,e=this.replayGroup_,f=a.size,g=a.pixelRatio,h=this.mapRenderer.getGL();e&&!e.isEmpty()&&(h.enable(h.SCISSOR_TEST),h.scissor(0,0,f[0]*g,f[1]*g),e.replay(c,d.center,d.resolution,d.rotation,f,g,b.opacity,b.managed?a.skippedFeatureUids:{}),h.disable(h.SCISSOR_TEST))};
ol.renderer.webgl.VectorLayer.prototype.disposeInternal=function(){var a=this.replayGroup_;if(a){var b=this.mapRenderer.getContext();a.getDeleteResourcesFunction(b)();this.replayGroup_=null}ol.renderer.webgl.Layer.prototype.disposeInternal.call(this)};
ol.renderer.webgl.VectorLayer.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){if(this.replayGroup_&&this.layerState_){c=this.mapRenderer.getContext();var f=b.viewState,g=this.getLayer(),h={};return this.replayGroup_.forEachFeatureAtCoordinate(a,c,f.center,f.resolution,f.rotation,b.size,b.pixelRatio,this.layerState_.opacity,{},function(a){var b=ol.getUid(a).toString();if(!(b in h))return h[b]=!0,d.call(e,a,g)})}};
ol.renderer.webgl.VectorLayer.prototype.hasFeatureAtCoordinate=function(a,b){if(this.replayGroup_&&this.layerState_){var c=this.mapRenderer.getContext(),d=b.viewState;return this.replayGroup_.hasFeatureAtCoordinate(a,c,d.center,d.resolution,d.rotation,b.size,b.pixelRatio,this.layerState_.opacity,b.skippedFeatureUids)}return!1};
ol.renderer.webgl.VectorLayer.prototype.forEachLayerAtPixel=function(a,b,c,d){a=ol.transform.apply(b.pixelToCoordinateTransform,a.slice());if(this.hasFeatureAtCoordinate(a,b))return c.call(d,this.getLayer(),null)};ol.renderer.webgl.VectorLayer.prototype.handleStyleImageChange_=function(a){this.renderIfReadyAndVisible()};
ol.renderer.webgl.VectorLayer.prototype.prepareFrame=function(a,b,c){var d=this.getLayer();b=d.getSource();this.updateLogos(a,b);var e=a.viewHints[ol.ViewHint.ANIMATING],f=a.viewHints[ol.ViewHint.INTERACTING],g=d.getUpdateWhileAnimating(),h=d.getUpdateWhileInteracting();if(!this.dirty_&&!g&&e||!h&&f)return!0;h=a.extent;f=a.viewState;e=f.projection;var k=f.resolution,l=a.pixelRatio;f=d.getRevision();var m=d.getRenderBuffer();g=d.getRenderOrder();void 0===g&&(g=ol.renderer.vector.defaultOrder);h=ol.extent.buffer(h,
m*k);if(!this.dirty_&&this.renderedResolution_==k&&this.renderedRevision_==f&&this.renderedRenderOrder_==g&&ol.extent.containsExtent(this.renderedExtent_,h))return!0;this.replayGroup_&&a.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(c));this.dirty_=!1;var n=new ol.render.webgl.ReplayGroup(ol.renderer.vector.getTolerance(k,l),h,d.getRenderBuffer());b.loadFeatures(h,k,e);a=function(a){var b=a.getStyleFunction();if(b)var c=b.call(a,k);else(b=d.getStyleFunction())&&(c=b(a,k));
c&&(a=this.renderFeature(a,k,l,c,n),this.dirty_=this.dirty_||a)};if(g){var p=[];b.forEachFeatureInExtent(h,function(a){p.push(a)},this);p.sort(g);p.forEach(a,this)}else b.forEachFeatureInExtent(h,a,this);n.finish(c);this.renderedResolution_=k;this.renderedRevision_=f;this.renderedRenderOrder_=g;this.renderedExtent_=h;this.replayGroup_=n;return!0};
ol.renderer.webgl.VectorLayer.prototype.renderFeature=function(a,b,c,d,e){if(!d)return!1;var f=!1;if(Array.isArray(d))for(var g=d.length-1;0<=g;--g)f=ol.renderer.vector.renderFeature(e,a,d[g],ol.renderer.vector.getSquaredTolerance(b,c),this.handleStyleImageChange_,this)||f;else f=ol.renderer.vector.renderFeature(e,a,d,ol.renderer.vector.getSquaredTolerance(b,c),this.handleStyleImageChange_,this)||f;return f};ol.ENABLE_CANVAS&&(ol.plugins.register(ol.PluginType.MAP_RENDERER,ol.renderer.canvas.Map),ol.plugins.registerMultiple(ol.PluginType.LAYER_RENDERER,[ol.renderer.canvas.ImageLayer,ol.renderer.canvas.TileLayer,ol.renderer.canvas.VectorLayer,ol.renderer.canvas.VectorTileLayer]));ol.ENABLE_WEBGL&&(ol.plugins.register(ol.PluginType.MAP_RENDERER,ol.renderer.webgl.Map),ol.plugins.registerMultiple(ol.PluginType.LAYER_RENDERER,[ol.renderer.webgl.ImageLayer,ol.renderer.webgl.TileLayer,ol.renderer.webgl.VectorLayer]));
ol.Map=function(a){a=ol.obj.assign({},a);a.controls||(a.controls=ol.control.defaults());a.interactions||(a.interactions=ol.interaction.defaults());ol.PluggableMap.call(this,a)};ol.inherits(ol.Map,ol.PluggableMap);ol.xml={};ol.xml.DOCUMENT=document.implementation.createDocument("","",null);ol.xml.createElementNS=function(a,b){return ol.xml.DOCUMENT.createElementNS(a,b)};ol.xml.getAllTextContent=function(a,b){return ol.xml.getAllTextContent_(a,b,[]).join("")};
ol.xml.getAllTextContent_=function(a,b,c){if(a.nodeType==Node.CDATA_SECTION_NODE||a.nodeType==Node.TEXT_NODE)b?c.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):c.push(a.nodeValue);else for(a=a.firstChild;a;a=a.nextSibling)ol.xml.getAllTextContent_(a,b,c);return c};ol.xml.isDocument=function(a){return a instanceof Document};ol.xml.isNode=function(a){return a instanceof Node};ol.xml.getAttributeNS=function(a,b,c){return a.getAttributeNS(b,c)||""};
ol.xml.setAttributeNS=function(a,b,c,d){a.setAttributeNS(b,c,d)};ol.xml.parse=function(a){return(new DOMParser).parseFromString(a,"application/xml")};ol.xml.makeArrayExtender=function(a,b){return function(c,d){c=a.call(b,c,d);void 0!==c&&ol.array.extend(d[d.length-1],c)}};ol.xml.makeArrayPusher=function(a,b){return function(c,d){c=a.call(void 0!==b?b:this,c,d);void 0!==c&&d[d.length-1].push(c)}};
ol.xml.makeReplacer=function(a,b){return function(c,d){c=a.call(void 0!==b?b:this,c,d);void 0!==c&&(d[d.length-1]=c)}};ol.xml.makeObjectPropertyPusher=function(a,b,c){return function(d,e){var f=a.call(void 0!==c?c:this,d,e);void 0!==f&&(e=e[e.length-1],d=void 0!==b?b:d.localName,(d in e?e[d]:e[d]=[]).push(f))}};ol.xml.makeObjectPropertySetter=function(a,b,c){return function(d,e){var f=a.call(void 0!==c?c:this,d,e);void 0!==f&&(e[e.length-1][void 0!==b?b:d.localName]=f)}};
ol.xml.makeChildAppender=function(a,b){return function(c,d,e){a.call(void 0!==b?b:this,c,d,e);e[e.length-1].node.appendChild(c)}};ol.xml.makeArraySerializer=function(a,b){var c,d;return function(b,f,g){if(void 0===c){c={};var e={};e[b.localName]=a;c[b.namespaceURI]=e;d=ol.xml.makeSimpleNodeFactory(b.localName)}ol.xml.serialize(c,d,f,g)}};
ol.xml.makeSimpleNodeFactory=function(a,b){return function(c,d,e){c=d[d.length-1].node;d=a;void 0===d&&(d=e);e=b;void 0===b&&(e=c.namespaceURI);return ol.xml.createElementNS(e,d)}};ol.xml.OBJECT_PROPERTY_NODE_FACTORY=ol.xml.makeSimpleNodeFactory();ol.xml.makeSequence=function(a,b){for(var c=b.length,d=Array(c),e=0;e<c;++e)d[e]=a[b[e]];return d};ol.xml.makeStructureNS=function(a,b,c){c=void 0!==c?c:{};var d;var e=0;for(d=a.length;e<d;++e)c[a[e]]=b;return c};
ol.xml.parseNode=function(a,b,c,d){for(b=b.firstElementChild;b;b=b.nextElementSibling){var e=a[b.namespaceURI];void 0!==e&&(e=e[b.localName],void 0!==e&&e.call(d,b,c))}};ol.xml.pushParseAndPop=function(a,b,c,d,e){d.push(a);ol.xml.parseNode(b,c,d,e);return d.pop()};ol.xml.serialize=function(a,b,c,d,e,f){for(var g=(void 0!==e?e:c).length,h,k,l=0;l<g;++l)h=c[l],void 0!==h&&(k=b.call(f,h,d,void 0!==e?e[l]:void 0),void 0!==k&&a[k.namespaceURI][k.localName].call(f,k,h,d))};
ol.xml.pushSerializeAndPop=function(a,b,c,d,e,f,g){e.push(a);ol.xml.serialize(b,c,d,e,f,g);return e.pop()};ol.featureloader={};
ol.featureloader.loadFeaturesXhr=function(a,b,c,d){return function(e,f,g){var h=new XMLHttpRequest;h.open("GET","function"===typeof a?a(e,f,g):a,!0);b.getType()==ol.format.FormatType.ARRAY_BUFFER&&(h.responseType="arraybuffer");h.onload=function(a){if(!h.status||200<=h.status&&300>h.status){a=b.getType();if(a==ol.format.FormatType.JSON||a==ol.format.FormatType.TEXT)var e=h.responseText;else a==ol.format.FormatType.XML?(e=h.responseXML)||(e=ol.xml.parse(h.responseText)):a==ol.format.FormatType.ARRAY_BUFFER&&(e=
h.response);e?c.call(this,b.readFeatures(e,{featureProjection:g}),b.readProjection(e),b.getLastExtent()):d.call(this)}else d.call(this)}.bind(this);h.onerror=function(){d.call(this)}.bind(this);h.send()}};ol.featureloader.xhr=function(a,b){return ol.featureloader.loadFeaturesXhr(a,b,function(a,b){this.addFeatures(a)},ol.nullFunction)};ol.loadingstrategy={};ol.loadingstrategy.all=function(a,b){return[[-Infinity,-Infinity,Infinity,Infinity]]};ol.loadingstrategy.bbox=function(a,b){return[a]};ol.loadingstrategy.tile=function(a){return function(b,c){c=a.getZForResolution(c);b=a.getTileRangeForExtentAndZ(b,c);var d=[];c=[c,0,0];for(c[1]=b.minX;c[1]<=b.maxX;++c[1])for(c[2]=b.minY;c[2]<=b.maxY;++c[2])d.push(a.getTileCoordExtent(c));return d}};ol.source.VectorEventType={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"};ol.source.Vector=function(a){a=a||{};ol.source.Source.call(this,{attributions:a.attributions,logo:a.logo,projection:void 0,state:ol.source.State.READY,wrapX:void 0!==a.wrapX?a.wrapX:!0});this.loader_=ol.nullFunction;this.format_=a.format;this.overlaps_=void 0==a.overlaps?!0:a.overlaps;this.url_=a.url;void 0!==a.loader?this.loader_=a.loader:void 0!==this.url_&&(ol.asserts.assert(this.format_,7),this.loader_=ol.featureloader.xhr(this.url_,this.format_));this.strategy_=void 0!==a.strategy?a.strategy:
ol.loadingstrategy.all;var b=void 0!==a.useSpatialIndex?a.useSpatialIndex:!0;this.featuresRtree_=b?new ol.structs.RBush:null;this.loadedExtentsRtree_=new ol.structs.RBush;this.nullGeometryFeatures_={};this.idIndex_={};this.undefIdIndex_={};this.featureChangeKeys_={};this.featuresCollection_=null;if(a.features instanceof ol.Collection){var c=a.features;var d=c.getArray()}else Array.isArray(a.features)&&(d=a.features);b||void 0!==c||(c=new ol.Collection(d));void 0!==d&&this.addFeaturesInternal(d);void 0!==
c&&this.bindFeaturesCollection_(c)};ol.inherits(ol.source.Vector,ol.source.Source);ol.source.Vector.prototype.addFeature=function(a){this.addFeatureInternal(a);this.changed()};
ol.source.Vector.prototype.addFeatureInternal=function(a){var b=ol.getUid(a).toString();if(this.addToIndex_(b,a)){this.setupChangeEvents_(b,a);var c=a.getGeometry();c?(b=c.getExtent(),this.featuresRtree_&&this.featuresRtree_.insert(b,a)):this.nullGeometryFeatures_[b]=a;this.dispatchEvent(new ol.source.Vector.Event(ol.source.VectorEventType.ADDFEATURE,a))}};
ol.source.Vector.prototype.setupChangeEvents_=function(a,b){this.featureChangeKeys_[a]=[ol.events.listen(b,ol.events.EventType.CHANGE,this.handleFeatureChange_,this),ol.events.listen(b,ol.ObjectEventType.PROPERTYCHANGE,this.handleFeatureChange_,this)]};ol.source.Vector.prototype.addToIndex_=function(a,b){var c=!0,d=b.getId();void 0!==d?d.toString()in this.idIndex_?c=!1:this.idIndex_[d.toString()]=b:(ol.asserts.assert(!(a in this.undefIdIndex_),30),this.undefIdIndex_[a]=b);return c};
ol.source.Vector.prototype.addFeatures=function(a){this.addFeaturesInternal(a);this.changed()};
ol.source.Vector.prototype.addFeaturesInternal=function(a){var b,c=[],d=[],e=[];var f=0;for(b=a.length;f<b;f++){var g=a[f];var h=ol.getUid(g).toString();this.addToIndex_(h,g)&&d.push(g)}f=0;for(b=d.length;f<b;f++)g=d[f],h=ol.getUid(g).toString(),this.setupChangeEvents_(h,g),(a=g.getGeometry())?(h=a.getExtent(),c.push(h),e.push(g)):this.nullGeometryFeatures_[h]=g;this.featuresRtree_&&this.featuresRtree_.load(c,e);f=0;for(b=d.length;f<b;f++)this.dispatchEvent(new ol.source.Vector.Event(ol.source.VectorEventType.ADDFEATURE,
d[f]))};
ol.source.Vector.prototype.bindFeaturesCollection_=function(a){var b=!1;ol.events.listen(this,ol.source.VectorEventType.ADDFEATURE,function(c){b||(b=!0,a.push(c.feature),b=!1)});ol.events.listen(this,ol.source.VectorEventType.REMOVEFEATURE,function(c){b||(b=!0,a.remove(c.feature),b=!1)});ol.events.listen(a,ol.CollectionEventType.ADD,function(a){b||(b=!0,this.addFeature(a.element),b=!1)},this);ol.events.listen(a,ol.CollectionEventType.REMOVE,function(a){b||(b=!0,this.removeFeature(a.element),b=!1)},
this);this.featuresCollection_=a};
ol.source.Vector.prototype.clear=function(a){if(a){for(var b in this.featureChangeKeys_)this.featureChangeKeys_[b].forEach(ol.events.unlistenByKey);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal,this);for(var c in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[c])}this.featuresCollection_&&this.featuresCollection_.clear();this.featuresRtree_&&
this.featuresRtree_.clear();this.loadedExtentsRtree_.clear();this.nullGeometryFeatures_={};a=new ol.source.Vector.Event(ol.source.VectorEventType.CLEAR);this.dispatchEvent(a);this.changed()};ol.source.Vector.prototype.forEachFeature=function(a,b){if(this.featuresRtree_)return this.featuresRtree_.forEach(a,b);if(this.featuresCollection_)return this.featuresCollection_.forEach(a,b)};
ol.source.Vector.prototype.forEachFeatureAtCoordinateDirect=function(a,b,c){return this.forEachFeatureInExtent([a[0],a[1],a[0],a[1]],function(d){if(d.getGeometry().intersectsCoordinate(a))return b.call(c,d)})};ol.source.Vector.prototype.forEachFeatureInExtent=function(a,b,c){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(a,b,c);if(this.featuresCollection_)return this.featuresCollection_.forEach(b,c)};
ol.source.Vector.prototype.forEachFeatureIntersectingExtent=function(a,b,c){return this.forEachFeatureInExtent(a,function(d){if(d.getGeometry().intersectsExtent(a)&&(d=b.call(c,d)))return d})};ol.source.Vector.prototype.getFeaturesCollection=function(){return this.featuresCollection_};
ol.source.Vector.prototype.getFeatures=function(){if(this.featuresCollection_)var a=this.featuresCollection_.getArray();else this.featuresRtree_&&(a=this.featuresRtree_.getAll(),ol.obj.isEmpty(this.nullGeometryFeatures_)||ol.array.extend(a,ol.obj.getValues(this.nullGeometryFeatures_)));return a};ol.source.Vector.prototype.getFeaturesAtCoordinate=function(a){var b=[];this.forEachFeatureAtCoordinateDirect(a,function(a){b.push(a)});return b};ol.source.Vector.prototype.getFeaturesInExtent=function(a){return this.featuresRtree_.getInExtent(a)};
ol.source.Vector.prototype.getClosestFeatureToCoordinate=function(a,b){var c=a[0],d=a[1],e=null,f=[NaN,NaN],g=Infinity,h=[-Infinity,-Infinity,Infinity,Infinity],k=b?b:ol.functions.TRUE;this.featuresRtree_.forEachInExtent(h,function(a){if(k(a)){var b=a.getGeometry(),l=g;g=b.closestPointXY(c,d,f,g);g<l&&(e=a,a=Math.sqrt(g),h[0]=c-a,h[1]=d-a,h[2]=c+a,h[3]=d+a)}});return e};ol.source.Vector.prototype.getExtent=function(a){return this.featuresRtree_.getExtent(a)};
ol.source.Vector.prototype.getFeatureById=function(a){a=this.idIndex_[a.toString()];return void 0!==a?a:null};ol.source.Vector.prototype.getFormat=function(){return this.format_};ol.source.Vector.prototype.getOverlaps=function(){return this.overlaps_};ol.source.Vector.prototype.getResolutions=function(){};ol.source.Vector.prototype.getUrl=function(){return this.url_};
ol.source.Vector.prototype.handleFeatureChange_=function(a){a=a.target;var b=ol.getUid(a).toString(),c=a.getGeometry();c?(c=c.getExtent(),b in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[b],this.featuresRtree_&&this.featuresRtree_.insert(c,a)):this.featuresRtree_&&this.featuresRtree_.update(c,a)):b in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(a),this.nullGeometryFeatures_[b]=a);c=a.getId();void 0!==c?(c=c.toString(),b in this.undefIdIndex_?(delete this.undefIdIndex_[b],
this.idIndex_[c]=a):this.idIndex_[c]!==a&&(this.removeFromIdIndex_(a),this.idIndex_[c]=a)):b in this.undefIdIndex_||(this.removeFromIdIndex_(a),this.undefIdIndex_[b]=a);this.changed();this.dispatchEvent(new ol.source.Vector.Event(ol.source.VectorEventType.CHANGEFEATURE,a))};ol.source.Vector.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&ol.obj.isEmpty(this.nullGeometryFeatures_)};
ol.source.Vector.prototype.loadFeatures=function(a,b,c){var d=this.loadedExtentsRtree_;a=this.strategy_(a,b);var e;var f=0;for(e=a.length;f<e;++f){var g=a[f];d.forEachInExtent(g,function(a){return ol.extent.containsExtent(a.extent,g)})||(this.loader_.call(this,g,b,c),d.insert(g,{extent:g.slice()}))}};
ol.source.Vector.prototype.removeFeature=function(a){var b=ol.getUid(a).toString();b in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[b]:this.featuresRtree_&&this.featuresRtree_.remove(a);this.removeFeatureInternal(a);this.changed()};
ol.source.Vector.prototype.removeFeatureInternal=function(a){var b=ol.getUid(a).toString();this.featureChangeKeys_[b].forEach(ol.events.unlistenByKey);delete this.featureChangeKeys_[b];var c=a.getId();void 0!==c?delete this.idIndex_[c.toString()]:delete this.undefIdIndex_[b];this.dispatchEvent(new ol.source.Vector.Event(ol.source.VectorEventType.REMOVEFEATURE,a))};
ol.source.Vector.prototype.removeFromIdIndex_=function(a){var b=!1,c;for(c in this.idIndex_)if(this.idIndex_[c]===a){delete this.idIndex_[c];b=!0;break}return b};ol.source.Vector.prototype.setLoader=function(a){this.loader_=a};ol.source.Vector.Event=function(a,b){ol.events.Event.call(this,a);this.feature=b};ol.inherits(ol.source.Vector.Event,ol.events.Event);var ngeo={};ngeo.module=angular.module("ngeo",["gettext","ui.date","floatThead"]);ngeo.baseTemplateUrl="ngeo";ngeo.baseModuleTemplateUrl="ngeomodule";ngeo.AttributeType={BOOLEAN:"boolean",DATE:"date",DATETIME:"datetime",TIME:"time",GEOMETRY:"geometry",NUMBER:"number",SELECT:"select",TEXT:"text"};goog.exportSymbol("ngeo.AttributeType",ngeo.AttributeType);
ngeo.FeatureProperties={ANGLE:"a",COLOR:"c",IS_CIRCLE:"l",IS_RECTANGLE:"r",IS_TEXT:"t",NAME:"n",SHOW_LABEL:"b",OPACITY:"o",AZIMUT:"z",SHOW_MEASURE:"m",SIZE:"s",STROKE:"k"};goog.exportSymbol("ngeo.FeatureProperties",ngeo.FeatureProperties);ngeo.FilterCondition={AND:"&&",NOT:"!",OR:"||"};goog.exportSymbol("ngeo.FilterCondition",ngeo.FilterCondition);
ngeo.GeometryType={CIRCLE:"Circle",LINE_STRING:"LineString",MULTI_LINE_STRING:"MultiLineString",MULTI_POINT:"MultiPoint",MULTI_POLYGON:"MultiPolygon",POINT:"Point",POLYGON:"Polygon",RECTANGLE:"Rectangle",TEXT:"Text"};goog.exportSymbol("ngeo.GeometryType",ngeo.GeometryType);ngeo.NumberType={FLOAT:"float",INTEGER:"integer"};goog.exportSymbol("ngeo.NumberType",ngeo.NumberType);var gmf={};gmf.module=angular.module("gmf",[ngeo.module.name,"gettext","ngAnimate","ngTouch","ngSanitize","tmh.dynamicLocale","ui.date","ui.slider"]);gmf.module.config(["tmhDynamicLocaleProvider","angularLocaleScript",function(a,b){a.localeLocationPattern(b)}]);gmf.module.config(["$animateProvider",function(a){a.classNameFilter(/gmf-animatable/)}]);gmf.baseTemplateUrl="gmf";gmf.DATALAYERGROUP_NAME="data";goog.exportSymbol("gmf.DATALAYERGROUP_NAME",gmf.DATALAYERGROUP_NAME);
gmf.COORDINATES_LAYER_NAME="gmfCoordinatesLayerName";goog.exportSymbol("gmf.COORDINATES_LAYER_NAME",gmf.COORDINATES_LAYER_NAME);gmf.PermalinkParam={BG_LAYER:"baselayer_ref",FEATURES:"rl_features",MAP_CROSSHAIR:"map_crosshair",MAP_TOOLTIP:"map_tooltip",MAP_X:"map_x",MAP_Y:"map_y",MAP_Z:"map_zoom",TREE_GROUPS:"tree_groups",WFS_LAYER:"wfs_layer",WFS_NGROUPS:"wfs_ngroups",WFS_SHOW_FEATURES:"wfs_showFeatures"};ngeo.File=function(a,b,c,d){var e,f;this.isValidFileSize=function(a){return!(2E7<a)};this.isWmsGetCap=function(a){return/<(WMT_MS_Capabilities|WMS_Capabilities)/.test(a)};this.isWmtsGetCap=function(a){return/wmtsGetCapabilities/.test(a)};this.isKml=function(a){return/<kml/.test(a)&&/<\/kml>/.test(a)};this.isGpx=function(a){return/<gpx/.test(a)&&/<\/gpx>/.test(a)};this.read=function(b){var f=a.defer();e&&e.readyState===FileReader.LOADING&&e.abort();e=new FileReader;e.onload=function(a){f.resolve(a.target.result)};
e.onerror=function(a){a=a.target.error;c.console.error("Reading file failed: ",a);f.reject({message:20==a.code?d("Operation canceled"):d("Read failed"),reason:a.message})};e.onprogress=function(a){f.notify(a)};e.readAsText(b);return f.promise};this.load=function(e,h){f&&f.resolve();f=h||a.defer();var g=a.defer();b.get(e,{timeout:f.promise}).then(function(a){g.resolve(a.data)},function(a){c.console.error("Uploading file failed: ",a);g.reject({message:d("Upload failed"),reason:a})});return g.promise}};
ngeo.File.$inject=["$q","$http","$window","gettext"];ngeo.fileService={};ngeo.fileService.module=angular.module("ngeo.fileService",[]);ngeo.fileService.module.service("ngeoFile",ngeo.File);ngeo.importDndDirective=function(a,b,c,d,e,f){return{restrict:"A",templateUrl:f,scope:{options:"=ngeoImportDndOptions"},link:function(f,h){var g=f.options;if(g&&"function"===typeof g.handleFileContent){f.handleFileContent=g.handleFileContent;h.click(function(){this.style.display="none"}).on("dragleave drop",function(a){this.style.display="none"}).on("dragover dragleave drop",function(a){a.stopPropagation();a.preventDefault()}).on("drop",function(b){var h=b.originalEvent.dataTransfer.files;h&&0<h.length?
e.read(h[0]).then(function(a){f.handleFileContent(a,h[0])}):b.originalEvent.dataTransfer.types&&(b=b.originalEvent.dataTransfer.getData("text/plain"),g.isValidUrl(b)?(g.transformUrl||c.when)(b).then(function(b){e.load(b).then(function(a){return f.handleFileContent(a,{url:b})})["catch"](function(b){a.alert(d.getString(b.message))})}):a.alert(d.getString("Invalid URL")+b))});var l=function(a){a.stopPropagation();a.preventDefault();a=a.originalEvent.dataTransfer.types||[];for(var b=0,c=a.length;b<c;++b)if(/(files|text\/plain)/i.test(a[b])){h.css("display",
"table");break}};b.on("dragenter",l);var m=function(){return!1};b.on("dragstart",m);f.$on("$destroy",function(){b.off("dragEnter",l).off("dragstart",m)})}else h.remove()}}};ngeo.importDndDirective.$inject="$window $document $q gettextCatalog ngeoFile ngeoImportDndTemplateUrl".split(" ");ngeo.importDndDirective.module=angular.module("ngeo.importDndDirective",["gettext",ngeo.fileService.module.name]);
ngeo.importDndDirective.module.value("ngeoImportDndTemplateUrl",function(a,b){a=b.ngeoImportDndTemplateUrl;return void 0!==a?a:ngeo.baseModuleTemplateUrl+"/import/partials/import-dnd.html"});ngeo.importDndDirective.module.directive("ngeoImportDnd",ngeo.importDndDirective);ngeo.importLocalDirective=function(a,b,c,d){var e;return{restrict:"A",templateUrl:d,scope:{options:"=ngeoImportLocalOptions"},link:function(d,g){var f=d.options;if(f&&"function"===typeof f.handleFileContent){d.handleFileContent=d.options.handleFileContent;var k=function(){d.userMessage=b("Load local file");d.progress=0;d.fileReader=null};k();f=function(){g.find('input[type="file"]').click()};g.find("button.ngeo-import-browse").click(f);g.find("input.form-control[type=text][readonly]").click(f);g.find("input[type=file]").on("change",
function(a){a.target.files&&0<a.target.files.length&&d.$apply(function(){d.files=a.target.files})});d.$watchCollection("files",function(){if(d.files&&0<d.files.length){var a=d.files[0];d.file=a;d.fileSize=a.size;d.isDropped&&d.handleFile()}});d.isLoading=function(){return 0<d.progress&&100>d.progress};d.isValid=function(a){return!a||c.isValidFileSize(a.size)};d.cancel=function(){d.fileReader&&(d.fileReader.abort(),d.fileReader=null)};d.handleFile=function(){d.file&&(d.loading=!0,d.userMessage=b("Reading file"),
a.cancel(e),c.read(d.file).then(function(a){d.fileReader=null;d.userMessage=b("Parsing file");return d.handleFileContent(a,d.file)}).then(function(a){d.userMessage=a.message},function(a){d.userMessage=a.message},function(a){d.fileReader||(d.fileReader=a.target)}).finally(function(){d.fileReader=null;d.loading=!1;e=a(k,5E3)}))}}else g.remove()}}};ngeo.importLocalDirective.$inject=["$timeout","gettext","ngeoFile","ngeoImportLocalTemplateUrl"];
ngeo.importLocalDirective.module=angular.module("ngeo.importLocalDirective",[ngeo.fileService.module.name]);ngeo.importLocalDirective.module.value("ngeoImportLocalTemplateUrl",function(a,b){a=b.ngeoImportLocalTemplateUrl;return void 0!==a?a:ngeo.baseModuleTemplateUrl+"/import/partials/import-local.html"});ngeo.importLocalDirective.module.directive("ngeoImportLocal",ngeo.importLocalDirective);ngeo.importOnlineDirective=function(a,b,c,d,e){var f;return{restrict:"A",templateUrl:e,scope:{options:"=ngeoImportOnlineOptions"},link:function(e,h){var g=e.options;if(g&&"function"===typeof g.handleFileContent){e.handleFileContent=g.handleFileContent;var l=function(){e.userMessage=d("Connect");e.progress=0;e.loading=!1};l();var m=e.options.urls;m&&0<m.length&&!m[0].name&&(m=m.map(function(a){return{name:a,url:a}}));var n=h.find("input[name=url]").typeahead({hint:!0,highlight:!0,minLength:0},{name:"wms",
displayKey:"name",limit:500,source:function(a){return function(b,c){var d=[];b?a.forEach(function(a){a.name.includes(b)&&d.push(a)}):d=a;c(d)}}(m)}).on("typeahead:selected",function(a,b){n.typeahead("close");e.fileUrl=b.url;e.handleFileUrl();e.$digest()}),p=h.find(".tt-menu");h.find(".ngeo-import-open").on("mousedown",function(a){"none"==p.css("display")?(n.focus(),n.typeahead("val","")):n.blur();a.preventDefault()});e.$on("gettextLanguageChanged",function(){e.fileUrl&&/lang=/.test(e.fileUrl)&&e.handleFileUrl()});
e.cancel=function(){e.progress=0;e.canceler&&(e.canceler.resolve(),e.canceler=null)};e.isValid=function(a){return g.isValidUrl?g.isValidUrl(a):!0};e.handleFileUrl=function(){(g.transformUrl||a.when)(e.fileUrl).then(function(g){e.canceler=a.defer();e.loading=!0;e.userMessage=d("Downloading file");b.cancel(f);c.load(g,e.canceler).then(function(a){e.canceler=null;return e.handleFileContent(a,{url:e.fileUrl})}).then(function(a){e.userMessage=a.message},function(a){e.userMessage=a.message}).finally(function(){e.canceler=
null;e.loading=!1;f=b(l,1E4)})})}}else h.remove()}}};ngeo.importOnlineDirective.$inject=["$q","$timeout","ngeoFile","gettext","ngeoImportOnlineTemplateUrl"];ngeo.importOnlineDirective.module=angular.module("ngeo.importOnlineDirective",[ngeo.fileService.module.name,"gettext"]);ngeo.importOnlineDirective.module.value("ngeoImportOnlineTemplateUrl",function(a,b){a=b.ngeoImportOnlineTemplateUrl;return void 0!==a?a:ngeo.baseModuleTemplateUrl+"/import/partials/import-online.html"});
ngeo.importOnlineDirective.module.directive("ngeoImportOnline",ngeo.importOnlineDirective);ol.format.XLink={};ol.format.XLink.NAMESPACE_URI="http://www.w3.org/1999/xlink";ol.format.XLink.readHref=function(a){return a.getAttributeNS(ol.format.XLink.NAMESPACE_URI,"href")};ol.format.XML=function(){};ol.format.XML.prototype.read=function(a){return ol.xml.isDocument(a)?this.readFromDocument(a):ol.xml.isNode(a)?this.readFromNode(a):"string"===typeof a?(a=ol.xml.parse(a),this.readFromDocument(a)):null};ol.format.XML.prototype.readFromDocument=function(a){};ol.format.XML.prototype.readFromNode=function(a){};ol.format.XSD={};ol.format.XSD.NAMESPACE_URI="http://www.w3.org/2001/XMLSchema";ol.format.XSD.readBoolean=function(a){a=ol.xml.getAllTextContent(a,!1);return ol.format.XSD.readBooleanString(a)};ol.format.XSD.readBooleanString=function(a){if(a=/^\s*(true|1)|(false|0)\s*$/.exec(a))return void 0!==a[1]||!1};ol.format.XSD.readDateTime=function(a){a=ol.xml.getAllTextContent(a,!1);a=Date.parse(a);return isNaN(a)?void 0:a/1E3};ol.format.XSD.readDecimal=function(a){a=ol.xml.getAllTextContent(a,!1);return ol.format.XSD.readDecimalString(a)};
ol.format.XSD.readDecimalString=function(a){if(a=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(a))return parseFloat(a[1])};ol.format.XSD.readNonNegativeInteger=function(a){a=ol.xml.getAllTextContent(a,!1);return ol.format.XSD.readNonNegativeIntegerString(a)};ol.format.XSD.readNonNegativeIntegerString=function(a){if(a=/^\s*(\d+)\s*$/.exec(a))return parseInt(a[1],10)};ol.format.XSD.readString=function(a){return ol.xml.getAllTextContent(a,!1).trim()};
ol.format.XSD.writeBooleanTextNode=function(a,b){ol.format.XSD.writeStringTextNode(a,b?"1":"0")};ol.format.XSD.writeCDATASection=function(a,b){a.appendChild(ol.xml.DOCUMENT.createCDATASection(b))};
ol.format.XSD.writeDateTimeTextNode=function(a,b){b=new Date(1E3*b);b=b.getUTCFullYear()+"-"+ol.string.padNumber(b.getUTCMonth()+1,2)+"-"+ol.string.padNumber(b.getUTCDate(),2)+"T"+ol.string.padNumber(b.getUTCHours(),2)+":"+ol.string.padNumber(b.getUTCMinutes(),2)+":"+ol.string.padNumber(b.getUTCSeconds(),2)+"Z";a.appendChild(ol.xml.DOCUMENT.createTextNode(b))};ol.format.XSD.writeDecimalTextNode=function(a,b){b=b.toPrecision();a.appendChild(ol.xml.DOCUMENT.createTextNode(b))};
ol.format.XSD.writeNonNegativeIntegerTextNode=function(a,b){a.appendChild(ol.xml.DOCUMENT.createTextNode(b.toString()))};ol.format.XSD.writeStringTextNode=function(a,b){a.appendChild(ol.xml.DOCUMENT.createTextNode(b))};ol.format.WMSCapabilities=function(){ol.format.XML.call(this);this.version=void 0};ol.inherits(ol.format.WMSCapabilities,ol.format.XML);ol.format.WMSCapabilities.prototype.readFromDocument=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType==Node.ELEMENT_NODE)return this.readFromNode(a);return null};
ol.format.WMSCapabilities.prototype.readFromNode=function(a){this.version=a.getAttribute("version").trim();return(a=ol.xml.pushParseAndPop({version:this.version},ol.format.WMSCapabilities.PARSERS_,a,[]))?a:null};ol.format.WMSCapabilities.readAttribution_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.ATTRIBUTION_PARSERS_,a,b)};
ol.format.WMSCapabilities.readBoundingBox_=function(a,b){b=[ol.format.XSD.readDecimalString(a.getAttribute("minx")),ol.format.XSD.readDecimalString(a.getAttribute("miny")),ol.format.XSD.readDecimalString(a.getAttribute("maxx")),ol.format.XSD.readDecimalString(a.getAttribute("maxy"))];var c=[ol.format.XSD.readDecimalString(a.getAttribute("resx")),ol.format.XSD.readDecimalString(a.getAttribute("resy"))];return{crs:a.getAttribute("CRS"),extent:b,res:c}};
ol.format.WMSCapabilities.readEXGeographicBoundingBox_=function(a,b){var c=ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.EX_GEOGRAPHIC_BOUNDING_BOX_PARSERS_,a,b);if(c){a=c.westBoundLongitude;b=c.southBoundLatitude;var d=c.eastBoundLongitude;c=c.northBoundLatitude;if(void 0!==a&&void 0!==b&&void 0!==d&&void 0!==c)return[a,b,d,c]}};ol.format.WMSCapabilities.readCapability_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.CAPABILITY_PARSERS_,a,b)};
ol.format.WMSCapabilities.readService_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.SERVICE_PARSERS_,a,b)};ol.format.WMSCapabilities.readContactInformation_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.CONTACT_INFORMATION_PARSERS_,a,b)};ol.format.WMSCapabilities.readContactPersonPrimary_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.CONTACT_PERSON_PARSERS_,a,b)};
ol.format.WMSCapabilities.readContactAddress_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.CONTACT_ADDRESS_PARSERS_,a,b)};ol.format.WMSCapabilities.readException_=function(a,b){return ol.xml.pushParseAndPop([],ol.format.WMSCapabilities.EXCEPTION_PARSERS_,a,b)};ol.format.WMSCapabilities.readCapabilityLayer_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.LAYER_PARSERS_,a,b)};
ol.format.WMSCapabilities.readLayer_=function(a,b){var c=b[b.length-1],d=ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.LAYER_PARSERS_,a,b);if(d)return b=ol.format.XSD.readBooleanString(a.getAttribute("queryable")),void 0===b&&(b=c.queryable),d.queryable=void 0!==b?b:!1,b=ol.format.XSD.readNonNegativeIntegerString(a.getAttribute("cascaded")),void 0===b&&(b=c.cascaded),d.cascaded=b,b=ol.format.XSD.readBooleanString(a.getAttribute("opaque")),void 0===b&&(b=c.opaque),d.opaque=void 0!==b?b:!1,b=
ol.format.XSD.readBooleanString(a.getAttribute("noSubsets")),void 0===b&&(b=c.noSubsets),d.noSubsets=void 0!==b?b:!1,(b=ol.format.XSD.readDecimalString(a.getAttribute("fixedWidth")))||(b=c.fixedWidth),d.fixedWidth=b,(a=ol.format.XSD.readDecimalString(a.getAttribute("fixedHeight")))||(a=c.fixedHeight),d.fixedHeight=a,["Style","CRS","AuthorityURL"].forEach(function(a){a in c&&(d[a]=(d[a]||[]).concat(c[a]))}),"EX_GeographicBoundingBox BoundingBox Dimension Attribution MinScaleDenominator MaxScaleDenominator".split(" ").forEach(function(a){a in
d||(d[a]=c[a])}),d};ol.format.WMSCapabilities.readDimension_=function(a,b){return{name:a.getAttribute("name"),units:a.getAttribute("units"),unitSymbol:a.getAttribute("unitSymbol"),"default":a.getAttribute("default"),multipleValues:ol.format.XSD.readBooleanString(a.getAttribute("multipleValues")),nearestValue:ol.format.XSD.readBooleanString(a.getAttribute("nearestValue")),current:ol.format.XSD.readBooleanString(a.getAttribute("current")),values:ol.format.XSD.readString(a)}};
ol.format.WMSCapabilities.readFormatOnlineresource_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.FORMAT_ONLINERESOURCE_PARSERS_,a,b)};ol.format.WMSCapabilities.readRequest_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.REQUEST_PARSERS_,a,b)};ol.format.WMSCapabilities.readDCPType_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.DCPTYPE_PARSERS_,a,b)};
ol.format.WMSCapabilities.readHTTP_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.HTTP_PARSERS_,a,b)};ol.format.WMSCapabilities.readOperationType_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.OPERATIONTYPE_PARSERS_,a,b)};
ol.format.WMSCapabilities.readSizedFormatOnlineresource_=function(a,b){if(b=ol.format.WMSCapabilities.readFormatOnlineresource_(a,b))return a=[ol.format.XSD.readNonNegativeIntegerString(a.getAttribute("width")),ol.format.XSD.readNonNegativeIntegerString(a.getAttribute("height"))],b.size=a,b};ol.format.WMSCapabilities.readAuthorityURL_=function(a,b){if(b=ol.format.WMSCapabilities.readFormatOnlineresource_(a,b))return b.name=a.getAttribute("name"),b};
ol.format.WMSCapabilities.readMetadataURL_=function(a,b){if(b=ol.format.WMSCapabilities.readFormatOnlineresource_(a,b))return b.type=a.getAttribute("type"),b};ol.format.WMSCapabilities.readStyle_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMSCapabilities.STYLE_PARSERS_,a,b)};ol.format.WMSCapabilities.readKeywordList_=function(a,b){return ol.xml.pushParseAndPop([],ol.format.WMSCapabilities.KEYWORDLIST_PARSERS_,a,b)};ol.format.WMSCapabilities.NAMESPACE_URIS_=[null,"http://www.opengis.net/wms"];
ol.format.WMSCapabilities.PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Service:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readService_),Capability:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readCapability_)});
ol.format.WMSCapabilities.CAPABILITY_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Request:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readRequest_),Exception:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readException_),Layer:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readCapabilityLayer_)});
ol.format.WMSCapabilities.SERVICE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Abstract:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),KeywordList:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readKeywordList_),OnlineResource:ol.xml.makeObjectPropertySetter(ol.format.XLink.readHref),ContactInformation:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readContactInformation_),
Fees:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),AccessConstraints:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),LayerLimit:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MaxWidth:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MaxHeight:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger)});
ol.format.WMSCapabilities.CONTACT_INFORMATION_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{ContactPersonPrimary:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readContactPersonPrimary_),ContactPosition:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ContactAddress:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readContactAddress_),ContactVoiceTelephone:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ContactFacsimileTelephone:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),
ContactElectronicMailAddress:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.WMSCapabilities.CONTACT_PERSON_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{ContactPerson:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ContactOrganization:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});
ol.format.WMSCapabilities.CONTACT_ADDRESS_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{AddressType:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Address:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),City:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),StateOrProvince:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),PostCode:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Country:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});
ol.format.WMSCapabilities.EXCEPTION_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Format:ol.xml.makeArrayPusher(ol.format.XSD.readString)});
ol.format.WMSCapabilities.LAYER_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Abstract:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),KeywordList:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readKeywordList_),CRS:ol.xml.makeObjectPropertyPusher(ol.format.XSD.readString),EX_GeographicBoundingBox:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readEXGeographicBoundingBox_),
BoundingBox:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readBoundingBox_),Dimension:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readDimension_),Attribution:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readAttribution_),AuthorityURL:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readAuthorityURL_),Identifier:ol.xml.makeObjectPropertyPusher(ol.format.XSD.readString),MetadataURL:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readMetadataURL_),
DataURL:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readFormatOnlineresource_),FeatureListURL:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readFormatOnlineresource_),Style:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readStyle_),MinScaleDenominator:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),MaxScaleDenominator:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),Layer:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readLayer_)});
ol.format.WMSCapabilities.ATTRIBUTION_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),OnlineResource:ol.xml.makeObjectPropertySetter(ol.format.XLink.readHref),LogoURL:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readSizedFormatOnlineresource_)});
ol.format.WMSCapabilities.EX_GEOGRAPHIC_BOUNDING_BOX_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{westBoundLongitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),eastBoundLongitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),southBoundLatitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),northBoundLatitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal)});
ol.format.WMSCapabilities.REQUEST_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{GetCapabilities:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readOperationType_),GetMap:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readOperationType_),GetFeatureInfo:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readOperationType_)});
ol.format.WMSCapabilities.OPERATIONTYPE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Format:ol.xml.makeObjectPropertyPusher(ol.format.XSD.readString),DCPType:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readDCPType_)});ol.format.WMSCapabilities.DCPTYPE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{HTTP:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readHTTP_)});
ol.format.WMSCapabilities.HTTP_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Get:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readFormatOnlineresource_),Post:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readFormatOnlineresource_)});
ol.format.WMSCapabilities.STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Abstract:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),LegendURL:ol.xml.makeObjectPropertyPusher(ol.format.WMSCapabilities.readSizedFormatOnlineresource_),StyleSheetURL:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readFormatOnlineresource_),StyleURL:ol.xml.makeObjectPropertySetter(ol.format.WMSCapabilities.readFormatOnlineresource_)});
ol.format.WMSCapabilities.FORMAT_ONLINERESOURCE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Format:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),OnlineResource:ol.xml.makeObjectPropertySetter(ol.format.XLink.readHref)});ol.format.WMSCapabilities.KEYWORDLIST_PARSERS_=ol.xml.makeStructureNS(ol.format.WMSCapabilities.NAMESPACE_URIS_,{Keyword:ol.xml.makeArrayPusher(ol.format.XSD.readString)});ngeo.wmsGetCapDirective=function(a,b,c,d){var e=function(a,c,d){c.Name||(c.isInvalid=!0,c.Abstract=b("Invalid layer: missing name"));if(!c.isInvalid){c.wmsUrl=a.Capability.Request.GetMap.DCPType[0].HTTP.Get.OnlineResource;c.wmsVersion=a.version;c.id="WMS||"+c.wmsUrl+"||"+c.Name;a:{var f=d.getCode();if(c.BoundingBox)for(var g=0,h=c.BoundingBox.length;g<h;g++){var n=c.BoundingBox[g],p=n.crs||n.srs;if(p&&p.toUpperCase()==f.toUpperCase()){f=n.extent;break a}}if(g=c.EX_GeographicBoundingBox||c.LatLonBoundingBox)if(h=
ol.proj.transformExtent(d.getExtent(),f,"EPSG:4326"),g=ol.extent.getIntersection(h,g)){f=ol.proj.transformExtent(g,"EPSG:4326",f);break a}f=void 0}c.extent=f;f=d.getCode();if(g="1.3.0"==a.version)g=c.CRS||c.SRS||[],g=!(-1!=g.indexOf(f.toUpperCase())||-1!=g.indexOf(f.toLowerCase()));g&&(c.useReprojection=!0,c.extent||(c.isInvalid=!0,c.Abstract=b("Invalid layer: outside the map")))}if(c.Layer){for(f=0;f<c.Layer.length;f++)e(a,c.Layer[f],d)||(c.Layer.splice(f,1),f--);0==c.Layer.length&&(c.Layer=void 0)}if(!c.isInvalid||
c.Layer)return c};return{restrict:"A",templateUrl:d,scope:{getCap:"=ngeoWmsGetCap",map:"=ngeoWmsGetCapMap",options:"=ngeoWmsGetCapOptions"},link:function(d){d.layers=[];d.options=d.options||{};d.$watch("getCap",function(f){try{f=(new ol.format.WMSCapabilities).read(f)}catch(k){var g=k}g||!f?(a.console.error("WMS GetCap parsing failed: ",g||f),d.userMsg=b("Parsing failed")):(d.limitations="",d.layers=[],d.options.layerSelected=null,d.options.layerHovered=null,f&&f.Service&&f.Capability&&(f.Service.MaxWidth&&
(d.limitations=c.getString("Maximum WMS size allowed")+" "+f.Service.MaxWidth+" * "+f.Service.MaxHeight),f.Capability.Layer&&(f=e(f,f.Capability.Layer,d.map.getView().getProjection()))&&(d.layers=f.Layer||[f])))});d.addLayerSelected=function(){var b=d.options.layerSelected;if(b&&d.options.getOlLayerFromGetCapLayer){var e=c.getString("WMS layer added succesfully");try{var f=d.options.getOlLayerFromGetCapLayer(b);f&&d.map.addLayer(f)}catch(l){a.console.error("Add layer failed:"+l),e=c.getString("WMS layer could not be added")+
" "+l.message}a.alert(e)}};d.getAbstract=function(){return c.getString((d.options.layerSelected||d.options.layerHovered||{}).Abstract)||""}}}};ngeo.wmsGetCapDirective.$inject=["$window","gettext","gettextCatalog","ngeoWmsGetCapTemplateUrl"];ngeo.wmsGetCapDirective.module=angular.module("ngeo.wmsGetCapDirective",["gettext"]);ngeo.wmsGetCapDirective.module.value("ngeoWmsGetCapTemplateUrl",function(a,b){a=b.ngeoWmsGetCapTemplateUrl;return void 0!==a?a:ngeo.baseModuleTemplateUrl+"/import/partials/wms-get-cap.html"});
ngeo.wmsGetCapDirective.module.directive("ngeoWmsGetCap",ngeo.wmsGetCapDirective);ngeo.wmsGetCapItemDirective={};ngeo.wmsGetCapItemDirective.Controller=function(a){var b=a.options;a.addPreviewLayer=function(c,d){c.stopPropagation();b.layerHovered=d;d.isInvalid||b.addPreviewLayer(a.map,d)};a.removePreviewLayer=function(c){c.stopPropagation();b.layerHovered=null;b.removePreviewLayer(a.map)};a.toggleLayerSelected=function(a,d){a.stopPropagation();b.layerSelected=b.layerSelected&&b.layerSelected.Name==d.Name?null:d}};ngeo.wmsGetCapItemDirective.Controller.$inject=["$scope"];
ngeo.wmsGetCapItemDirective.directive=function(a,b){return{restrict:"A",templateUrl:b,controller:"NgeoWmsGetCapItemDirectiveController",compile:function(b){var c=b.contents().remove(),e;return function(b,d){e||(e=a(c));e(b,function(a,b){d.append(a)});var f=d.find("> .ngeo-header-group"),g=f.find(".fa-plus"),l;f.find(".fa-zoom-in").on("click",function(a){a.stopPropagation();a:{var c=b.layer,d=b.map,e=c.extent;b.options.transformExtent&&(e=b.options.transformExtent(c.extent));a=d.getView();var f=d.getSize();
if(c.MaxScaleDenominator&&e){var g=2834.64*a.getResolutionForExtent(e,f);if(g>c.MaxScaleDenominator){d=ol.extent.getCenter(e);g/=c.MaxScaleDenominator;c=ol.extent.getWidth(e)/g;e=ol.extent.getHeight(e)/g;e=[d[0]-c/2,d[1]-e/2,d[0]+c/2,d[1]+e/2];if(e=b.options.transformExtent(e))e=a.constrainResolution(a.getResolutionForExtent(e,f),0,-1),a.setCenter(d),a.setResolution(e);break a}}e&&a.fit(e,f)}});g.on("click",function(a){a.stopPropagation();g.toggleClass("fa-minus");l||(l=d.find("> .ngeo-child-group"));
l.slideToggle()})}}}};ngeo.wmsGetCapItemDirective.directive.$inject=["$compile","ngeoWmsGetCapItemTemplateUrl"];ngeo.wmsGetCapItemDirective.module=angular.module("ngeo.wmsGetCapItemDirective",[]);ngeo.wmsGetCapItemDirective.module.value("ngeoWmsGetCapItemTemplateUrl",function(a,b){a=b.ngeoWmsGetCapItemTemplateUrl;return void 0!==a?a:ngeo.baseModuleTemplateUrl+"/import/partials/wms-get-cap-item.html"});ngeo.wmsGetCapItemDirective.module.controller("NgeoWmsGetCapItemDirectiveController",ngeo.wmsGetCapItemDirective.Controller);
ngeo.wmsGetCapItemDirective.module.directive("ngeoWmsGetCapItem",ngeo.wmsGetCapItemDirective.directive);ol.format.OWS=function(){ol.format.XML.call(this)};ol.inherits(ol.format.OWS,ol.format.XML);ol.format.OWS.prototype.readFromDocument=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType==Node.ELEMENT_NODE)return this.readFromNode(a);return null};ol.format.OWS.prototype.readFromNode=function(a){return(a=ol.xml.pushParseAndPop({},ol.format.OWS.PARSERS_,a,[]))?a:null};ol.format.OWS.readAddress_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.OWS.ADDRESS_PARSERS_,a,b)};
ol.format.OWS.readAllowedValues_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.OWS.ALLOWED_VALUES_PARSERS_,a,b)};ol.format.OWS.readConstraint_=function(a,b){var c=a.getAttribute("name");if(c)return ol.xml.pushParseAndPop({name:c},ol.format.OWS.CONSTRAINT_PARSERS_,a,b)};ol.format.OWS.readContactInfo_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.OWS.CONTACT_INFO_PARSERS_,a,b)};ol.format.OWS.readDcp_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.OWS.DCP_PARSERS_,a,b)};
ol.format.OWS.readGet_=function(a,b){var c=ol.format.XLink.readHref(a);if(c)return ol.xml.pushParseAndPop({href:c},ol.format.OWS.REQUEST_METHOD_PARSERS_,a,b)};ol.format.OWS.readHttp_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.OWS.HTTP_PARSERS_,a,b)};ol.format.OWS.readOperation_=function(a,b){var c=a.getAttribute("name");(a=ol.xml.pushParseAndPop({},ol.format.OWS.OPERATION_PARSERS_,a,b))&&(b[b.length-1][c]=a)};
ol.format.OWS.readOperationsMetadata_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.OWS.OPERATIONS_METADATA_PARSERS_,a,b)};ol.format.OWS.readPhone_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.OWS.PHONE_PARSERS_,a,b)};ol.format.OWS.readServiceIdentification_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.OWS.SERVICE_IDENTIFICATION_PARSERS_,a,b)};
ol.format.OWS.readServiceContact_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.OWS.SERVICE_CONTACT_PARSERS_,a,b)};ol.format.OWS.readServiceProvider_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.OWS.SERVICE_PROVIDER_PARSERS_,a,b)};ol.format.OWS.readValue_=function(a,b){return ol.format.XSD.readString(a)};ol.format.OWS.NAMESPACE_URIS_=[null,"http://www.opengis.net/ows/1.1"];
ol.format.OWS.PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{ServiceIdentification:ol.xml.makeObjectPropertySetter(ol.format.OWS.readServiceIdentification_),ServiceProvider:ol.xml.makeObjectPropertySetter(ol.format.OWS.readServiceProvider_),OperationsMetadata:ol.xml.makeObjectPropertySetter(ol.format.OWS.readOperationsMetadata_)});
ol.format.OWS.ADDRESS_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{DeliveryPoint:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),City:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),AdministrativeArea:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),PostalCode:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Country:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ElectronicMailAddress:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});
ol.format.OWS.ALLOWED_VALUES_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Value:ol.xml.makeObjectPropertyPusher(ol.format.OWS.readValue_)});ol.format.OWS.CONSTRAINT_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{AllowedValues:ol.xml.makeObjectPropertySetter(ol.format.OWS.readAllowedValues_)});ol.format.OWS.CONTACT_INFO_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Phone:ol.xml.makeObjectPropertySetter(ol.format.OWS.readPhone_),Address:ol.xml.makeObjectPropertySetter(ol.format.OWS.readAddress_)});
ol.format.OWS.DCP_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{HTTP:ol.xml.makeObjectPropertySetter(ol.format.OWS.readHttp_)});ol.format.OWS.HTTP_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Get:ol.xml.makeObjectPropertyPusher(ol.format.OWS.readGet_),Post:void 0});ol.format.OWS.OPERATION_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{DCP:ol.xml.makeObjectPropertySetter(ol.format.OWS.readDcp_)});
ol.format.OWS.OPERATIONS_METADATA_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Operation:ol.format.OWS.readOperation_});ol.format.OWS.PHONE_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Voice:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Facsimile:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.OWS.REQUEST_METHOD_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Constraint:ol.xml.makeObjectPropertyPusher(ol.format.OWS.readConstraint_)});
ol.format.OWS.SERVICE_CONTACT_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{IndividualName:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),PositionName:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ContactInfo:ol.xml.makeObjectPropertySetter(ol.format.OWS.readContactInfo_)});
ol.format.OWS.SERVICE_IDENTIFICATION_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{Abstract:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),AccessConstraints:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Fees:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ServiceTypeVersion:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ServiceType:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});
ol.format.OWS.SERVICE_PROVIDER_PARSERS_=ol.xml.makeStructureNS(ol.format.OWS.NAMESPACE_URIS_,{ProviderName:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),ProviderSite:ol.xml.makeObjectPropertySetter(ol.format.XLink.readHref),ServiceContact:ol.xml.makeObjectPropertySetter(ol.format.OWS.readServiceContact_)});ol.format.WMTSCapabilities=function(){ol.format.XML.call(this);this.owsParser_=new ol.format.OWS};ol.inherits(ol.format.WMTSCapabilities,ol.format.XML);ol.format.WMTSCapabilities.prototype.readFromDocument=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType==Node.ELEMENT_NODE)return this.readFromNode(a);return null};
ol.format.WMTSCapabilities.prototype.readFromNode=function(a){var b=a.getAttribute("version").trim(),c=this.owsParser_.readFromNode(a);if(!c)return null;c.version=b;return(c=ol.xml.pushParseAndPop(c,ol.format.WMTSCapabilities.PARSERS_,a,[]))?c:null};ol.format.WMTSCapabilities.readContents_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.CONTENTS_PARSERS_,a,b)};
ol.format.WMTSCapabilities.readLayer_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.LAYER_PARSERS_,a,b)};ol.format.WMTSCapabilities.readTileMatrixSet_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.TMS_PARSERS_,a,b)};ol.format.WMTSCapabilities.readStyle_=function(a,b){if(b=ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.STYLE_PARSERS_,a,b))return a="true"===a.getAttribute("isDefault"),b.isDefault=a,b};
ol.format.WMTSCapabilities.readTileMatrixSetLink_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.TMS_LINKS_PARSERS_,a,b)};ol.format.WMTSCapabilities.readDimensions_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.DIMENSION_PARSERS_,a,b)};
ol.format.WMTSCapabilities.readResourceUrl_=function(a,b){b=a.getAttribute("format");var c=a.getAttribute("template");a=a.getAttribute("resourceType");var d={};b&&(d.format=b);c&&(d.template=c);a&&(d.resourceType=a);return d};ol.format.WMTSCapabilities.readWgs84BoundingBox_=function(a,b){a=ol.xml.pushParseAndPop([],ol.format.WMTSCapabilities.WGS84_BBOX_READERS_,a,b);if(2==a.length)return ol.extent.boundingExtent(a)};
ol.format.WMTSCapabilities.readLegendUrl_=function(a,b){b={};b.format=a.getAttribute("format");b.href=ol.format.XLink.readHref(a);return b};ol.format.WMTSCapabilities.readCoordinates_=function(a,b){if((b=ol.format.XSD.readString(a).split(" "))&&2==b.length&&(a=+b[0],b=+b[1],!isNaN(a)&&!isNaN(b)))return[a,b]};ol.format.WMTSCapabilities.readTileMatrix_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.TM_PARSERS_,a,b)};
ol.format.WMTSCapabilities.readTileMatrixLimitsList_=function(a,b){return ol.xml.pushParseAndPop([],ol.format.WMTSCapabilities.TMS_LIMITS_LIST_PARSERS_,a,b)};ol.format.WMTSCapabilities.readTileMatrixLimits_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WMTSCapabilities.TMS_LIMITS_PARSERS_,a,b)};ol.format.WMTSCapabilities.NAMESPACE_URIS_=[null,"http://www.opengis.net/wmts/1.0"];ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_=[null,"http://www.opengis.net/ows/1.1"];
ol.format.WMTSCapabilities.PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{Contents:ol.xml.makeObjectPropertySetter(ol.format.WMTSCapabilities.readContents_)});ol.format.WMTSCapabilities.CONTENTS_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{Layer:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readLayer_),TileMatrixSet:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readTileMatrixSet_)});
ol.format.WMTSCapabilities.LAYER_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{Style:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readStyle_),Format:ol.xml.makeObjectPropertyPusher(ol.format.XSD.readString),TileMatrixSetLink:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readTileMatrixSetLink_),Dimension:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readDimensions_),ResourceURL:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readResourceUrl_)},
ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Abstract:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),WGS84BoundingBox:ol.xml.makeObjectPropertySetter(ol.format.WMTSCapabilities.readWgs84BoundingBox_),Identifier:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)}));
ol.format.WMTSCapabilities.STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{LegendURL:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readLegendUrl_)},ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{Title:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Identifier:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)}));
ol.format.WMTSCapabilities.TMS_LINKS_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{TileMatrixSet:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),TileMatrixSetLimits:ol.xml.makeObjectPropertySetter(ol.format.WMTSCapabilities.readTileMatrixLimitsList_)});ol.format.WMTSCapabilities.TMS_LIMITS_LIST_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{TileMatrixLimits:ol.xml.makeArrayPusher(ol.format.WMTSCapabilities.readTileMatrixLimits_)});
ol.format.WMTSCapabilities.TMS_LIMITS_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{TileMatrix:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),MinTileRow:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MaxTileRow:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MinTileCol:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MaxTileCol:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger)});
ol.format.WMTSCapabilities.DIMENSION_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{Default:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Value:ol.xml.makeObjectPropertyPusher(ol.format.XSD.readString)},ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{Identifier:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)}));
ol.format.WMTSCapabilities.WGS84_BBOX_READERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{LowerCorner:ol.xml.makeArrayPusher(ol.format.WMTSCapabilities.readCoordinates_),UpperCorner:ol.xml.makeArrayPusher(ol.format.WMTSCapabilities.readCoordinates_)});
ol.format.WMTSCapabilities.TMS_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{WellKnownScaleSet:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),TileMatrix:ol.xml.makeObjectPropertyPusher(ol.format.WMTSCapabilities.readTileMatrix_)},ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{SupportedCRS:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),Identifier:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)}));
ol.format.WMTSCapabilities.TM_PARSERS_=ol.xml.makeStructureNS(ol.format.WMTSCapabilities.NAMESPACE_URIS_,{TopLeftCorner:ol.xml.makeObjectPropertySetter(ol.format.WMTSCapabilities.readCoordinates_),ScaleDenominator:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),TileWidth:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),TileHeight:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),MatrixWidth:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),
MatrixHeight:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger)},ol.xml.makeStructureNS(ol.format.WMTSCapabilities.OWS_NAMESPACE_URIS_,{Identifier:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)}));ngeo.wmtsGetCapDirective=function(a,b,c){return{restrict:"A",templateUrl:c,scope:{getCap:"=ngeoWmtsGetCap",map:"=ngeoWmtsGetCapMap",url:"=ngeoWmtsGetCapUrl",options:"=ngeoWmtsGetCapOptions"},link:function(c){c.layers=[];c.options=c.options||{};c.$watch("getCap",function(b){try{b=(new ol.format.WMTSCapabilities).read(b)}catch(q){var d=q}if(d||!b)console.error("WMTS GetCap parsing failed: ",d||b),c.userMsg=a("Parsing failed");else if(c.layers=[],c.options.layerSelected=null,c.options.layerHovered=null,
b&&b.Contents&&b.Contents.Layer){d=c.url;for(var e=c.map.getView().getProjection(),h=[],k=$jscomp.makeIterator(b.Contents.Layer),l=k.next();!l.done;l=k.next()){l=l.value;l.Title||(l.isInvalid=!0,l.Abstract=a("Invalid layer: missing name"));if(!l.isInvalid){l.sourceConfig=ol.source.WMTS.optionsFromCapabilities(b,{layer:l.Identifier,requestEnconding:b.OperationsMetadata.GetTile.DCP.HTTP.Get[0].Constraint[0].AllowedValues.Value[0]});"ServiceProvider"in b&&(l.attribution=b.ServiceProvider.ProviderName,
l.attributionUrl=b.ServiceProvider.ProviderSite);l.capabilitiesUrl=d;a:{var m=e;var n=m.getCode();var p=l.WGS84BoundingBox;if(p&&(m=ol.proj.transformExtent(m.getExtent(),n,"EPSG:4326"),p=ol.extent.getIntersection(m,p))){n=ol.proj.transformExtent(p,"EPSG:4326",n);break a}n=void 0}l.extent=n}h.push(l)}c.layers=h}});c.addLayerSelected=function(){var a=c.options.layerSelected;if(a&&c.options.getOlLayerFromGetCapLayer){var d=b.getString("WMTS layer added succesfully");try{var g=c.options.getOlLayerFromGetCapLayer(a);
g&&c.map.addLayer(g)}catch(h){console.error("Add layer failed:"+h),d=b.getString("WMTS layer could not be added")+" "+h.message}alert(d)}};c.getAbstract=function(){return b.getString((c.options.layerSelected||c.options.layerHovered||{}).Abstract)||""}}}};ngeo.wmtsGetCapDirective.$inject=["gettext","gettextCatalog","ngeoWmtsGetCapTemplateUrl"];ngeo.wmtsGetCapDirective.module=angular.module("ngeo.wmtsGetCapDirective",["gettext"]);
ngeo.wmtsGetCapDirective.module.value("ngeoWmtsGetCapTemplateUrl",function(a,b){a=b.ngeoWmtsGetCapTemplateUrl;return void 0!==a?a:ngeo.baseModuleTemplateUrl+"/import/partials/wmts-get-cap.html"});ngeo.wmtsGetCapDirective.module.directive("ngeoWmtsGetCap",ngeo.wmtsGetCapDirective);ngeo.wmtsGetCapItemDirective={};ngeo.wmtsGetCapItemDirective.Controller=function(a){var b=a.options;a.addPreviewLayer=function(c,d){c.stopPropagation();b.layerHovered=d;d.isInvalid||b.addPreviewLayer(a.map,d)};a.removePreviewLayer=function(c){c.stopPropagation();b.layerHovered=null;b.removePreviewLayer(a.map)};a.toggleLayerSelected=function(a,d){a.stopPropagation();b.layerSelected=b.layerSelected&&b.layerSelected.Title==d.Title?null:d}};ngeo.wmtsGetCapItemDirective.Controller.$inject=["$scope"];
ngeo.wmtsGetCapItemDirective.directive=function(a,b){return{restrict:"A",templateUrl:b,controller:"NgeoWmtsGetCapItemDirectiveController",compile:function(b){var c=b.contents().remove(),e;return function(b,d){e||(e=a(c));e(b,function(a,b){d.append(a)});d.find("> .ngeo-header-group").find(".fa-zoom-in").on("click",function(a){a.stopPropagation();var c=b.layer,d=b.map;a=c.extent;b.options.transformExtent&&(a=b.options.transformExtent(c.extent));c=d.getView();d=d.getSize();a&&c.fit(a,d)})}}}};
ngeo.wmtsGetCapItemDirective.directive.$inject=["$compile","ngeoWmtsGetCapItemTemplateUrl"];ngeo.wmtsGetCapItemDirective.module=angular.module("ngeo.wmtsGetCapItemDirective",[]);ngeo.wmtsGetCapItemDirective.module.value("ngeoWmtsGetCapItemTemplateUrl",function(a,b){a=b.ngeoWmsGetCapItemTemplateUrl;return void 0!==a?a:ngeo.baseModuleTemplateUrl+"/import/partials/wmts-get-cap-item.html"});ngeo.wmtsGetCapItemDirective.module.controller("NgeoWmtsGetCapItemDirectiveController",ngeo.wmtsGetCapItemDirective.Controller);
ngeo.wmtsGetCapItemDirective.module.directive("ngeoWmtsGetCapItem",ngeo.wmtsGetCapItemDirective.directive);ngeo.import={};ngeo.import.importModule={};ngeo.import.importModule.module=angular.module("ngeo.import",[ngeo.fileService.module.name,ngeo.importDndDirective.module.name,ngeo.importLocalDirective.module.name,ngeo.importOnlineDirective.module.name,ngeo.wmsGetCapDirective.module.name,ngeo.wmsGetCapItemDirective.module.name,ngeo.wmtsGetCapDirective.module.name,ngeo.wmtsGetCapItemDirective.module.name]);var app={};app.module=angular.module("app",[ngeo.import.importModule.module.name,gmf.module.name]);app.module.config(["$compileProvider",function(a){"debug"in ngeo.utils.decodeQueryString(window.location.search)||a.debugInfoEnabled(!1)}]);gmf.AuthenticationRouteSuffix={CHANGE_PASSWORD:"loginchange",IS_LOGGED_IN:"loginuser",LOGIN:"login",LOGOUT:"logout",RESET_PASSWORD:"loginresetpassword"};gmf.module.value("gmfUser",{functionalities:null,is_password_changed:null,role_id:null,role_name:null,username:null});gmf.AuthenticationEventType={LOGIN:"login",LOGOUT:"logout",READY:"ready"};gmf.AuthenticationEvent=function(a,b){ol.events.Event.call(this,a);this.user=b};ol.inherits(gmf.AuthenticationEvent,ol.events.Event);
gmf.Authentication=function(a,b,c,d){ol.events.EventTarget.call(this);this.$http_=a;this.baseUrl_=c.replace(/\/$/,"");this.user_=d;this.noReloadRole_=b.has("gmfAuthenticationNoReloadRole")?b.get("gmfAuthenticationNoReloadRole"):null;this.load_()};ol.inherits(gmf.Authentication,ol.events.EventTarget);gmf.Authentication.$inject=["$http","$injector","authenticationBaseUrl","gmfUser"];
gmf.Authentication.prototype.load_=function(){this.$http_.get(this.baseUrl_+"/"+gmf.AuthenticationRouteSuffix.IS_LOGGED_IN,{withCredentials:!0}).then(this.handleLogin_.bind(this,!0))};gmf.Authentication.prototype.changePassword=function(a,b,c){return this.$http_.post(this.baseUrl_+"/"+gmf.AuthenticationRouteSuffix.CHANGE_PASSWORD,$.param({oldPassword:a,newPassword:b,confirmNewPassword:c}),{headers:{"Content-Type":"application/x-www-form-urlencoded"},withCredentials:!0})};
goog.exportProperty(gmf.Authentication.prototype,"changePassword",gmf.Authentication.prototype.changePassword);gmf.Authentication.prototype.login=function(a,b){return this.$http_.post(this.baseUrl_+"/"+gmf.AuthenticationRouteSuffix.LOGIN,$.param({login:a,password:b}),{headers:{"Content-Type":"application/x-www-form-urlencoded"},withCredentials:!0}).then(this.handleLogin_.bind(this,!1))};goog.exportProperty(gmf.Authentication.prototype,"login",gmf.Authentication.prototype.login);
gmf.Authentication.prototype.logout=function(){var a=this,b=this.user_.role_name===this.noReloadRole_;return this.$http_.get(this.baseUrl_+"/"+gmf.AuthenticationRouteSuffix.LOGOUT,{withCredentials:!0}).then(function(){a.resetUser_(b)})};goog.exportProperty(gmf.Authentication.prototype,"logout",gmf.Authentication.prototype.logout);
gmf.Authentication.prototype.resetPassword=function(a){var b=this.baseUrl_+"/"+gmf.AuthenticationRouteSuffix.RESET_PASSWORD,c=function(a){return a.data}.bind(this);return this.$http_.post(b,$.param({login:a}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(c)};goog.exportProperty(gmf.Authentication.prototype,"resetPassword",gmf.Authentication.prototype.resetPassword);gmf.Authentication.prototype.getFunctionalities=function(){return this.user_.functionalities};
gmf.Authentication.prototype.getRoleId=function(){return this.user_.role_id};gmf.Authentication.prototype.handleLogin_=function(a,b){this.setUser_(b.data,!a);a&&this.dispatchEvent(new gmf.AuthenticationEvent(gmf.AuthenticationEventType.READY,this.user_));return b};gmf.Authentication.prototype.setUser_=function(a,b){for(var c in a)this.user_[c]=a[c];b&&void 0!==a.username&&this.dispatchEvent(new gmf.AuthenticationEvent(gmf.AuthenticationEventType.LOGIN,this.user_))};
gmf.Authentication.prototype.resetUser_=function(a){a=a||!1;for(var b in this.user_)this.user_[b]=null;this.dispatchEvent(new gmf.AuthenticationEvent(gmf.AuthenticationEventType.LOGOUT,this.user_));a||this.load_()};gmf.module.service("gmfAuthentication",gmf.Authentication);goog.debug={};goog.debug.Error=function(a){if(Error.captureStackTrace)Error.captureStackTrace(this,goog.debug.Error);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a));this.reportErrorToServer=!0};goog.inherits(goog.debug.Error,Error);goog.debug.Error.prototype.name="CustomError";goog.dom={};goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12};goog.string={};goog.string.DETECT_DOUBLE_ESCAPING=!1;goog.string.FORCE_NON_DOM_HTML_UNESCAPING=!1;goog.string.Unicode={NBSP:"\u00a0"};goog.string.startsWith=function(a,b){return 0==a.lastIndexOf(b,0)};goog.string.endsWith=function(a,b){var c=a.length-b.length;return 0<=c&&a.indexOf(b,c)==c};goog.string.caseInsensitiveStartsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(0,b.length))};
goog.string.caseInsensitiveEndsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(a.length-b.length,b.length))};goog.string.caseInsensitiveEquals=function(a,b){return a.toLowerCase()==b.toLowerCase()};goog.string.subs=function(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")};goog.string.collapseWhitespace=function(a){return a.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};
goog.string.isEmptyOrWhitespace=function(a){return/^[\s\xa0]*$/.test(a)};goog.string.isEmptyString=function(a){return 0==a.length};goog.string.isEmpty=goog.string.isEmptyOrWhitespace;goog.string.isEmptyOrWhitespaceSafe=function(a){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(a))};goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe;goog.string.isBreakingWhitespace=function(a){return!/[^\t\n\r ]/.test(a)};goog.string.isAlpha=function(a){return!/[^a-zA-Z]/.test(a)};
goog.string.isNumeric=function(a){return!/[^0-9]/.test(a)};goog.string.isAlphaNumeric=function(a){return!/[^a-zA-Z0-9]/.test(a)};goog.string.isSpace=function(a){return" "==a};goog.string.isUnicodeChar=function(a){return 1==a.length&&" "<=a&&"~">=a||"\u0080"<=a&&"\ufffd">=a};goog.string.stripNewlines=function(a){return a.replace(/(\r\n|\r|\n)+/g," ")};goog.string.canonicalizeNewlines=function(a){return a.replace(/(\r\n|\r|\n)/g,"\n")};
goog.string.normalizeWhitespace=function(a){return a.replace(/\xa0|\s/g," ")};goog.string.normalizeSpaces=function(a){return a.replace(/\xa0|[ \t]+/g," ")};goog.string.collapseBreakingSpaces=function(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")};goog.string.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};goog.string.trimLeft=function(a){return a.replace(/^[\s\xa0]+/,"")};
goog.string.trimRight=function(a){return a.replace(/[\s\xa0]+$/,"")};goog.string.caseInsensitiveCompare=function(a,b){a=String(a).toLowerCase();b=String(b).toLowerCase();return a<b?-1:a==b?0:1};
goog.string.numberAwareCompare_=function(a,b,c){if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var d=a.toLowerCase().match(c),e=b.toLowerCase().match(c),f=Math.min(d.length,e.length),g=0;g<f;g++){c=d[g];var h=e[g];if(c!=h)return a=parseInt(c,10),!isNaN(a)&&(b=parseInt(h,10),!isNaN(b)&&a-b)?a-b:c<h?-1:1}return d.length!=e.length?d.length-e.length:a<b?-1:1};goog.string.intAwareCompare=function(a,b){return goog.string.numberAwareCompare_(a,b,/\d+|\D+/g)};
goog.string.floatAwareCompare=function(a,b){return goog.string.numberAwareCompare_(a,b,/\d+|\.\d+|\D+/g)};goog.string.numerateCompare=goog.string.floatAwareCompare;goog.string.urlEncode=function(a){return encodeURIComponent(String(a))};goog.string.urlDecode=function(a){return decodeURIComponent(a.replace(/\+/g," "))};goog.string.newLineToBr=function(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")};
goog.string.htmlEscape=function(a,b){if(b)a=a.replace(goog.string.AMP_RE_,"&amp;").replace(goog.string.LT_RE_,"&lt;").replace(goog.string.GT_RE_,"&gt;").replace(goog.string.QUOT_RE_,"&quot;").replace(goog.string.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.NULL_RE_,"&#0;"),goog.string.DETECT_DOUBLE_ESCAPING&&(a=a.replace(goog.string.E_RE_,"&#101;"));else{if(!goog.string.ALL_RE_.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(goog.string.AMP_RE_,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(goog.string.LT_RE_,
"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(goog.string.GT_RE_,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(goog.string.QUOT_RE_,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(goog.string.SINGLE_QUOTE_RE_,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(goog.string.NULL_RE_,"&#0;"));goog.string.DETECT_DOUBLE_ESCAPING&&-1!=a.indexOf("e")&&(a=a.replace(goog.string.E_RE_,"&#101;"))}return a};goog.string.AMP_RE_=/&/g;goog.string.LT_RE_=/</g;goog.string.GT_RE_=/>/g;goog.string.QUOT_RE_=/"/g;
goog.string.SINGLE_QUOTE_RE_=/'/g;goog.string.NULL_RE_=/\x00/g;goog.string.E_RE_=/e/g;goog.string.ALL_RE_=goog.string.DETECT_DOUBLE_ESCAPING?/[\x00&<>"'e]/:/[\x00&<>"']/;goog.string.unescapeEntities=function(a){return goog.string.contains(a,"&")?!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(a):goog.string.unescapePureXmlEntities_(a):a};
goog.string.unescapeEntitiesWithDocument=function(a,b){return goog.string.contains(a,"&")?goog.string.unescapeEntitiesUsingDom_(a,b):a};
goog.string.unescapeEntitiesUsingDom_=function(a,b){var c={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'};var d=b?b.createElement("div"):goog.global.document.createElement("div");return a.replace(goog.string.HTML_ENTITY_PATTERN_,function(a,b){var e=c[a];if(e)return e;"#"==b.charAt(0)&&(b=Number("0"+b.substr(1)),isNaN(b)||(e=String.fromCharCode(b)));e||(d.innerHTML=a+" ",e=d.firstChild.nodeValue.slice(0,-1));return c[a]=e})};
goog.string.unescapePureXmlEntities_=function(a){return a.replace(/&([^;]+);/g,function(a,c){switch(c){case "amp":return"&";case "lt":return"<";case "gt":return">";case "quot":return'"';default:return"#"!=c.charAt(0)||(c=Number("0"+c.substr(1)),isNaN(c))?a:String.fromCharCode(c)}})};goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g;goog.string.whitespaceEscape=function(a,b){return goog.string.newLineToBr(a.replace(/  /g," &#160;"),b)};
goog.string.preserveSpaces=function(a){return a.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)};goog.string.stripQuotes=function(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a};goog.string.truncate=function(a,b,c){c&&(a=goog.string.unescapeEntities(a));a.length>b&&(a=a.substring(0,b-3)+"...");c&&(a=goog.string.htmlEscape(a));return a};
goog.string.truncateMiddle=function(a,b,c,d){c&&(a=goog.string.unescapeEntities(a));if(d&&a.length>b){d>b&&(d=b);var e=a.length-d;a=a.substring(0,b-d)+"..."+a.substring(e)}else a.length>b&&(d=Math.floor(b/2),e=a.length-d,a=a.substring(0,d+b%2)+"..."+a.substring(e));c&&(a=goog.string.htmlEscape(a));return a};goog.string.specialEscapeChars_={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\","<":"<"};goog.string.jsEscapeCache_={"'":"\\'"};
goog.string.quote=function(a){a=String(a);for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0);b[c+1]=goog.string.specialEscapeChars_[d]||(31<e&&127>e?d:goog.string.escapeChar(d))}b.push('"');return b.join("")};goog.string.escapeString=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=goog.string.escapeChar(a.charAt(c));return b.join("")};
goog.string.escapeChar=function(a){if(a in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[a];if(a in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[a]=goog.string.specialEscapeChars_[a];var b=a.charCodeAt(0);if(31<b&&127>b)var c=a;else{if(256>b){if(c="\\x",16>b||256<b)c+="0"}else c="\\u",4096>b&&(c+="0");c+=b.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[a]=c};goog.string.contains=function(a,b){return-1!=a.indexOf(b)};
goog.string.caseInsensitiveContains=function(a,b){return goog.string.contains(a.toLowerCase(),b.toLowerCase())};goog.string.countOf=function(a,b){return a&&b?a.split(b).length-1:0};goog.string.removeAt=function(a,b,c){var d=a;0<=b&&b<a.length&&0<c&&(d=a.substr(0,b)+a.substr(b+c,a.length-b-c));return d};goog.string.remove=function(a,b){return a.replace(b,"")};goog.string.removeAll=function(a,b){b=new RegExp(goog.string.regExpEscape(b),"g");return a.replace(b,"")};
goog.string.replaceAll=function(a,b,c){b=new RegExp(goog.string.regExpEscape(b),"g");return a.replace(b,c.replace(/\$/g,"$$$$"))};goog.string.regExpEscape=function(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};goog.string.repeat=String.prototype.repeat?function(a,b){return a.repeat(b)}:function(a,b){return Array(b+1).join(a)};
goog.string.padNumber=function(a,b,c){a=goog.isDef(c)?a.toFixed(c):String(a);c=a.indexOf(".");-1==c&&(c=a.length);return goog.string.repeat("0",Math.max(0,b-c))+a};goog.string.makeSafe=function(a){return null==a?"":String(a)};goog.string.buildString=function(a){return Array.prototype.join.call(arguments,"")};goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)};
goog.string.compareVersions=function(a,b){var c=0;a=goog.string.trim(String(a)).split(".");b=goog.string.trim(String(b)).split(".");for(var d=Math.max(a.length,b.length),e=0;0==c&&e<d;e++){var f=a[e]||"",g=b[e]||"";do{f=/(\d*)(\D*)(.*)/.exec(f)||["","","",""];g=/(\d*)(\D*)(.*)/.exec(g)||["","","",""];if(0==f[0].length&&0==g[0].length)break;c=0==f[1].length?0:parseInt(f[1],10);var h=0==g[1].length?0:parseInt(g[1],10);c=goog.string.compareElements_(c,h)||goog.string.compareElements_(0==f[2].length,
0==g[2].length)||goog.string.compareElements_(f[2],g[2]);f=f[3];g=g[3]}while(0==c)}return c};goog.string.compareElements_=function(a,b){return a<b?-1:a>b?1:0};goog.string.hashCode=function(a){for(var b=0,c=0;c<a.length;++c)b=31*b+a.charCodeAt(c)>>>0;return b};goog.string.uniqueStringCounter_=2147483648*Math.random()|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};
goog.string.toNumber=function(a){var b=Number(a);return 0==b&&goog.string.isEmptyOrWhitespace(a)?NaN:b};goog.string.isLowerCamelCase=function(a){return/^[a-z]+([A-Z][a-z]*)*$/.test(a)};goog.string.isUpperCamelCase=function(a){return/^([A-Z][a-z]*)+$/.test(a)};goog.string.toCamelCase=function(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})};goog.string.toSelectorCase=function(a){return String(a).replace(/([A-Z])/g,"-$1").toLowerCase()};
goog.string.toTitleCase=function(a,b){b=goog.isString(b)?goog.string.regExpEscape(b):"\\s";return a.replace(new RegExp("(^"+(b?"|["+b+"]+":"")+")([a-z])","g"),function(a,b,e){return b+e.toUpperCase()})};goog.string.capitalize=function(a){return String(a.charAt(0)).toUpperCase()+String(a.substr(1)).toLowerCase()};goog.string.parseInt=function(a){isFinite(a)&&(a=String(a));return goog.isString(a)?/^\s*-?0x/i.test(a)?parseInt(a,16):parseInt(a,10):NaN};
goog.string.splitLimit=function(a,b,c){a=a.split(b);for(var d=[];0<c&&a.length;)d.push(a.shift()),c--;a.length&&d.push(a.join(b));return d};goog.string.lastComponent=function(a,b){if(b)"string"==typeof b&&(b=[b]);else return a;for(var c=-1,d=0;d<b.length;d++)if(""!=b[d]){var e=a.lastIndexOf(b[d]);e>c&&(c=e)}return-1==c?a:a.slice(c+1)};
goog.string.editDistance=function(a,b){var c=[],d=[];if(a==b)return 0;if(!a.length||!b.length)return Math.max(a.length,b.length);for(var e=0;e<b.length+1;e++)c[e]=e;for(e=0;e<a.length;e++){d[0]=e+1;for(var f=0;f<b.length;f++)d[f+1]=Math.min(d[f]+1,c[f+1]+1,c[f]+Number(a[e]!=b[f]));for(f=0;f<c.length;f++)c[f]=d[f]}return d[b.length]};goog.asserts={};goog.asserts.ENABLE_ASSERTS=goog.DEBUG;goog.asserts.AssertionError=function(a,b){b.unshift(a);goog.debug.Error.call(this,goog.string.subs.apply(null,b));b.shift();this.messagePattern=a};goog.inherits(goog.asserts.AssertionError,goog.debug.Error);goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.DEFAULT_ERROR_HANDLER=function(a){throw a;};goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER;
goog.asserts.doAssertFailure_=function(a,b,c,d){var e="Assertion failed";if(c){e+=": "+c;var f=d}else a&&(e+=": "+a,f=b);a=new goog.asserts.AssertionError(""+e,f||[]);goog.asserts.errorHandler_(a)};goog.asserts.setErrorHandler=function(a){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=a)};goog.asserts.assert=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!a&&goog.asserts.doAssertFailure_("",null,b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.fail=function(a,b){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1)))};goog.asserts.assertNumber=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(a)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertString=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isString(a)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertFunction=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(a)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertObject=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isObject(a)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertArray=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isArray(a)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertBoolean=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(a)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertElement=function(a,b,c){!goog.asserts.ENABLE_ASSERTS||goog.isObject(a)&&a.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertInstanceof=function(a,b,c,d){!goog.asserts.ENABLE_ASSERTS||a instanceof b||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(b),goog.asserts.getType_(a)],c,Array.prototype.slice.call(arguments,3));return a};goog.asserts.assertObjectPrototypeIsIntact=function(){for(var a in Object.prototype)goog.asserts.fail(a+" should not be enumerable in Object.prototype.")};
goog.asserts.getType_=function(a){return a instanceof Function?a.displayName||a.name||"unknown type name":a instanceof Object?a.constructor.displayName||a.constructor.name||Object.prototype.toString.call(a):null===a?"null":typeof a};ngeo.MessageType={ERROR:"error",INFORMATION:"information",SUCCESS:"success",WARNING:"warning"};goog.exportSymbol("ngeo.MessageType",ngeo.MessageType);ngeo.Message=function(){};ngeo.Message.prototype.showMessage=function(a){};ngeo.Message.prototype.show=function(a){this.getMessageObjects(a).forEach(this.showMessage,this)};goog.exportProperty(ngeo.Message.prototype,"show",ngeo.Message.prototype.show);ngeo.Message.prototype.error=function(a){this.show(this.getMessageObjects(a,ngeo.MessageType.ERROR))};
goog.exportProperty(ngeo.Message.prototype,"error",ngeo.Message.prototype.error);ngeo.Message.prototype.info=function(a){this.show(this.getMessageObjects(a,ngeo.MessageType.INFORMATION))};goog.exportProperty(ngeo.Message.prototype,"info",ngeo.Message.prototype.info);ngeo.Message.prototype.success=function(a){this.show(this.getMessageObjects(a,ngeo.MessageType.SUCCESS))};goog.exportProperty(ngeo.Message.prototype,"success",ngeo.Message.prototype.success);
ngeo.Message.prototype.warn=function(a){this.show(this.getMessageObjects(a,ngeo.MessageType.WARNING))};goog.exportProperty(ngeo.Message.prototype,"warn",ngeo.Message.prototype.warn);
ngeo.Message.prototype.getMessageObjects=function(a,b){var c=[],d=null,e=ngeo.MessageType.INFORMATION;"string"===typeof a?c.push({msg:a,type:void 0!==b?b:e}):Array.isArray(a)?a.forEach(function(f){"string"===typeof a?d={msg:f,type:void 0!==b?b:e}:(d=f,void 0!==b&&(d.type=b));c.push(d)},this):(d=a,void 0!==b&&(d.type=b),void 0===d.type&&(d.type=e),c.push(d));return c};ngeo.Notification=function(a){ngeo.Message.call(this);this.timeout_=a;a=angular.element('<div class="ngeo-notification"></div>');angular.element(document.body).append(a);this.container_=a;this.cache_={}};ol.inherits(ngeo.Notification,ngeo.Message);ngeo.Notification.$inject=["$timeout"];ngeo.Notification.DEFAULT_DELAY_=7E3;ngeo.Notification.prototype.notify=function(a){this.show(a)};goog.exportProperty(ngeo.Notification.prototype,"notify",ngeo.Notification.prototype.notify);
ngeo.Notification.prototype.clear=function(){for(var a in this.cache_)this.clearMessageByCacheItem_(this.cache_[parseInt(a,10)])};goog.exportProperty(ngeo.Notification.prototype,"clear",ngeo.Notification.prototype.clear);
ngeo.Notification.prototype.showMessage=function(a){var b=this,c=a.type;goog.asserts.assertString(c,"Type should be set.");var d=["alert","fade"];switch(c){case ngeo.MessageType.ERROR:d.push("alert-danger");break;case ngeo.MessageType.INFORMATION:d.push("alert-info");break;case ngeo.MessageType.SUCCESS:d.push("alert-success");break;case ngeo.MessageType.WARNING:d.push("alert-warning")}var e=angular.element('<div class="'+d.join(" ")+'"></div>');(a.target?angular.element(a.target):this.container_).append(e);
e.html(a.msg).addClass("in");a=void 0!==a.delay?a.delay:ngeo.Notification.DEFAULT_DELAY_;c={el:e};var f=ol.getUid(e);c.promise=this.timeout_(function(){e.alert("close");delete b.cache_[f]},a);this.cache_[f]=c};ngeo.Notification.prototype.clearMessageByCacheItem_=function(a){var b=a.el;a=a.promise;var c=ol.getUid(b);b.alert("close");this.timeout_.cancel(a);delete this.cache_[c]};ngeo.module.service("ngeoNotification",ngeo.Notification);ngeo.modalDirective=function(a){return{template:'<div class="modal fade" tabindex="-1" role="dialog"><div class="modal-dialog"><div class="modal-content"></div></div></div>',restrict:"E",require:"ngModel",transclude:!0,link:function(a,c,d,e,f){function b(b){l=a.$new();f(l,function(a){k.find(".modal-content").append(a)})}function h(a){l.$destroy();k.find(".modal-content").empty()}var k=c.children();c="true"===d.ngeoModalDestroyContentOnHide;var l=a.$new();angular.element(document.body).append(k);e.$render=
function(){k.modal(e.$viewValue?"show":"hide")};k.on("shown.bs.modal hidden.bs.modal",function(b){var c=b.type;goog.asserts.assert("shown"==c||"hidden"==c);a.$apply(function(){e.$setViewValue("shown"==c)})});c?(k.on("hide.bs.modal",h),k.on("show.bs.modal",b)):k.find(".modal-content").append(f())}}};ngeo.modalDirective.$inject=["$parse"];ngeo.module.directive("ngeoModal",ngeo.modalDirective);gmf.module.value("gmfAuthenticationTemplateUrl",function(a,b){a=b.gmfAuthenticationTemplateurl;return void 0!==a?a:gmf.baseTemplateUrl+"/authentication.html"});gmf.authenticationDirective=function(a){return{bindToController:!0,scope:{allowPasswordReset:"<?gmfAuthenticationAllowPasswordReset",allowPasswordChange:"<?gmfAuthenticationAllowPasswordChange",forcePasswordChange:"<?gmfAuthenticationForcePasswordChange"},controller:"GmfAuthenticationController as authCtrl",templateUrl:a}};
gmf.authenticationDirective.$inject=["gmfAuthenticationTemplateUrl"];gmf.module.directive("gmfAuthentication",gmf.authenticationDirective);
gmf.AuthenticationController=function(a,b,c,d,e){this.gmfUser=d;this.$scope_=b;this.gettextCatalog=a;this.gmfAuthentication_=c;this.notification_=e;this.error=this.resetPasswordModalShown=this.changePasswordModalShown=this.changingPassword=!1;this.newPwdConfVal=this.newPwdVal=this.oldPwdVal=this.pwdVal=this.loginVal="";ol.events.listen(c,gmf.AuthenticationEventType.READY,this.onUserChange_.bind(this))};gmf.AuthenticationController.$inject=["gettextCatalog","$scope","gmfAuthentication","gmfUser","ngeoNotification"];
gmf.AuthenticationController.prototype.$onInit=function(){this.allowPasswordReset=!1!==this.allowPasswordReset;this.allowPasswordChange=!1!==this.allowPasswordChange;this.forcePasswordChange=!0===this.forcePasswordChange};
gmf.AuthenticationController.prototype.changePassword=function(){var a=this,b=this.gettextCatalog,c=this.oldPwdVal,d=this.newPwdVal,e=this.newPwdConfVal,f=[];""===c&&f.push(b.getString("The old password is required."));""===d&&f.push(b.getString("The new password is required."));""===e&&f.push(b.getString("The password confirmation is required."));f.length?this.setError_(f):(c===d&&f.push(b.getString("The old and new passwords are the same.")),d!==e&&f.push(b.getString("The passwords don't match.")),
f.length?this.setError_(f):(b=b.getString("Incorrect old password."),this.gmfAuthentication_.changePassword(c,d,e).then(function(){a.changePasswordModalShown=!0;a.changePasswordReset()},this.setError_.bind(this,b))))};goog.exportProperty(gmf.AuthenticationController.prototype,"changePassword",gmf.AuthenticationController.prototype.changePassword);
gmf.AuthenticationController.prototype.login=function(){var a=this,b=this.gettextCatalog,c=[];""===this.loginVal&&c.push(b.getString("The username is required."));""===this.pwdVal&&c.push(b.getString("The password is required."));c.length?this.setError_(c):(b=b.getString("Incorrect username or password."),this.gmfAuthentication_.login(this.loginVal,this.pwdVal).then(function(){a.resetError_();a.onUserChange_()},this.setError_.bind(this,b)))};
goog.exportProperty(gmf.AuthenticationController.prototype,"login",gmf.AuthenticationController.prototype.login);gmf.AuthenticationController.prototype.logout=function(){var a=this.gettextCatalog.getString("Could not log out.");this.gmfAuthentication_.logout().then(this.resetError_.bind(this),this.setError_.bind(this,a))};goog.exportProperty(gmf.AuthenticationController.prototype,"logout",gmf.AuthenticationController.prototype.logout);
gmf.AuthenticationController.prototype.resetPassword=function(){var a=this.gettextCatalog;if(this.loginVal){a=a.getString("An error occured while reseting the password.");var b=function(a){this.resetPasswordModalShown=!0;this.resetError_()}.bind(this);this.gmfAuthentication_.resetPassword(this.loginVal).then(b,this.setError_.bind(this,a))}else this.setError_(a.getString("Please, input a login..."))};goog.exportProperty(gmf.AuthenticationController.prototype,"resetPassword",gmf.AuthenticationController.prototype.resetPassword);
gmf.AuthenticationController.prototype.changePasswordReset=function(){this.resetError_();this.changingPassword=!1;this.newPwdConfVal=this.newPwdVal=this.oldPwdVal=""};goog.exportProperty(gmf.AuthenticationController.prototype,"changePasswordReset",gmf.AuthenticationController.prototype.changePasswordReset);
gmf.AuthenticationController.prototype.onUserChange_=function(){if(!1===this.gmfUser.is_password_changed&&this.forcePasswordChange){var a=this.gettextCatalog.getString("You must change your password.");this.notification_.notify({msg:a,type:ngeo.MessageType.WARNING})}};
gmf.AuthenticationController.prototype.setError_=function(a){this.error&&this.resetError_();this.error=!0;var b=angular.element(".gmf-authentication-error");Array.isArray(a)||(a=[a]);a.forEach(function(a){this.notification_.notify({msg:a,target:b,type:ngeo.MessageType.ERROR})},this)};gmf.AuthenticationController.prototype.resetError_=function(){this.notification_.clear();this.error=!1};gmf.module.controller("GmfAuthenticationController",gmf.AuthenticationController);ol.Image=function(a,b,c,d,e,f){ol.ImageBase.call(this,a,b,c,ol.ImageState.IDLE);this.src_=d;this.image_=new Image;null!==e&&(this.image_.crossOrigin=e);this.imageListenerKeys_=null;this.state=ol.ImageState.IDLE;this.imageLoadFunction_=f};ol.inherits(ol.Image,ol.ImageBase);ol.Image.prototype.getImage=function(){return this.image_};ol.Image.prototype.handleImageError_=function(){this.state=ol.ImageState.ERROR;this.unlistenImage_();this.changed()};
ol.Image.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=ol.extent.getHeight(this.extent)/this.image_.height);this.state=ol.ImageState.LOADED;this.unlistenImage_();this.changed()};
ol.Image.prototype.load=function(){if(this.state==ol.ImageState.IDLE||this.state==ol.ImageState.ERROR)this.state=ol.ImageState.LOADING,this.changed(),this.imageListenerKeys_=[ol.events.listenOnce(this.image_,ol.events.EventType.ERROR,this.handleImageError_,this),ol.events.listenOnce(this.image_,ol.events.EventType.LOAD,this.handleImageLoad_,this)],this.imageLoadFunction_(this,this.src_)};ol.Image.prototype.setImage=function(a){this.image_=a};
ol.Image.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(ol.events.unlistenByKey);this.imageListenerKeys_=null};ol.source.WMSServerType={CARMENTA_SERVER:"carmentaserver",GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGIS:"qgis"};ol.source.ImageWMS=function(a){a=a||{};ol.source.Image.call(this,{attributions:a.attributions,logo:a.logo,projection:a.projection,resolutions:a.resolutions});this.crossOrigin_=void 0!==a.crossOrigin?a.crossOrigin:null;this.url_=a.url;this.imageLoadFunction_=void 0!==a.imageLoadFunction?a.imageLoadFunction:ol.source.Image.defaultImageLoadFunction;this.params_=a.params||{};this.v13_=!0;this.updateV13_();this.serverType_=a.serverType;this.hidpi_=void 0!==a.hidpi?a.hidpi:!0;this.image_=null;this.imageSize_=
[0,0];this.renderedRevision_=0;this.ratio_=void 0!==a.ratio?a.ratio:1.5};ol.inherits(ol.source.ImageWMS,ol.source.Image);ol.source.ImageWMS.GETFEATUREINFO_IMAGE_SIZE_=[101,101];
ol.source.ImageWMS.prototype.getGetFeatureInfoUrl=function(a,b,c,d){if(void 0!==this.url_){c=ol.proj.get(c);var e=this.getProjection();e&&e!==c&&(b=ol.reproj.calculateSourceResolution(e,c,a,b),a=ol.proj.transform(a,c,e));var f=ol.extent.getForViewAndSize(a,b,0,ol.source.ImageWMS.GETFEATUREINFO_IMAGE_SIZE_),g={SERVICE:"WMS",VERSION:ol.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};ol.obj.assign(g,this.params_,d);d=Math.floor((f[3]-a[1])/
b);g[this.v13_?"I":"X"]=Math.floor((a[0]-f[0])/b);g[this.v13_?"J":"Y"]=d;return this.getRequestUrl_(f,ol.source.ImageWMS.GETFEATUREINFO_IMAGE_SIZE_,1,e||c,g)}};ol.source.ImageWMS.prototype.getParams=function(){return this.params_};
ol.source.ImageWMS.prototype.getImageInternal=function(a,b,c,d){if(void 0===this.url_)return null;b=this.findNearestResolution(b);1==c||this.hidpi_&&void 0!==this.serverType_||(c=1);var e=b/c,f=ol.extent.getCenter(a),g=Math.ceil(ol.extent.getWidth(a)/e),h=Math.ceil(ol.extent.getHeight(a)/e);g=ol.extent.getForViewAndSize(f,e,0,[g,h]);h=Math.ceil(this.ratio_*ol.extent.getWidth(a)/e);a=Math.ceil(this.ratio_*ol.extent.getHeight(a)/e);f=ol.extent.getForViewAndSize(f,e,0,[h,a]);if((a=this.image_)&&this.renderedRevision_==
this.getRevision()&&a.getResolution()==b&&a.getPixelRatio()==c&&ol.extent.containsExtent(a.getExtent(),g))return a;g={SERVICE:"WMS",VERSION:ol.DEFAULT_WMS_VERSION,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};ol.obj.assign(g,this.params_);this.imageSize_[0]=Math.round(ol.extent.getWidth(f)/e);this.imageSize_[1]=Math.round(ol.extent.getHeight(f)/e);d=this.getRequestUrl_(f,this.imageSize_,c,d,g);this.image_=new ol.Image(f,b,c,d,this.crossOrigin_,this.imageLoadFunction_);this.renderedRevision_=
this.getRevision();ol.events.listen(this.image_,ol.events.EventType.CHANGE,this.handleImageChange,this);return this.image_};ol.source.ImageWMS.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_};
ol.source.ImageWMS.prototype.getRequestUrl_=function(a,b,c,d,e){ol.asserts.assert(void 0!==this.url_,9);e[this.v13_?"CRS":"SRS"]=d.getCode();"STYLES"in this.params_||(e.STYLES="");if(1!=c)switch(this.serverType_){case ol.source.WMSServerType.GEOSERVER:c=90*c+.5|0;e.FORMAT_OPTIONS="FORMAT_OPTIONS"in e?e.FORMAT_OPTIONS+(";dpi:"+c):"dpi:"+c;break;case ol.source.WMSServerType.MAPSERVER:e.MAP_RESOLUTION=90*c;break;case ol.source.WMSServerType.CARMENTA_SERVER:case ol.source.WMSServerType.QGIS:e.DPI=90*
c;break;default:ol.asserts.assert(!1,8)}e.WIDTH=b[0];e.HEIGHT=b[1];b=d.getAxisOrientation();a=this.v13_&&"ne"==b.substr(0,2)?[a[1],a[0],a[3],a[2]]:a;e.BBOX=a.join(",");return ol.uri.appendParams(this.url_,e)};ol.source.ImageWMS.prototype.getUrl=function(){return this.url_};ol.source.ImageWMS.prototype.setImageLoadFunction=function(a){this.image_=null;this.imageLoadFunction_=a;this.changed()};ol.source.ImageWMS.prototype.setUrl=function(a){a!=this.url_&&(this.url_=a,this.image_=null,this.changed())};
ol.source.ImageWMS.prototype.updateParams=function(a){ol.obj.assign(this.params_,a);this.updateV13_();this.image_=null;this.changed()};ol.source.ImageWMS.prototype.updateV13_=function(){this.v13_=0<=ol.string.compareVersions(this.params_.VERSION||ol.DEFAULT_WMS_VERSION,"1.3")};ol.source.TileWMS=function(a){a=a||{};var b=a.params||{};ol.source.TileImage.call(this,{attributions:a.attributions,cacheSize:a.cacheSize,crossOrigin:a.crossOrigin,logo:a.logo,opaque:!("TRANSPARENT"in b?b.TRANSPARENT:1),projection:a.projection,reprojectionErrorThreshold:a.reprojectionErrorThreshold,tileClass:a.tileClass,tileGrid:a.tileGrid,tileLoadFunction:a.tileLoadFunction,url:a.url,urls:a.urls,wrapX:void 0!==a.wrapX?a.wrapX:!0,transition:a.transition});this.gutter_=void 0!==a.gutter?a.gutter:0;
this.params_=b;this.v13_=!0;this.serverType_=a.serverType;this.hidpi_=void 0!==a.hidpi?a.hidpi:!0;this.tmpExtent_=ol.extent.createEmpty();this.updateV13_();this.setKey(this.getKeyForParams_())};ol.inherits(ol.source.TileWMS,ol.source.TileImage);
ol.source.TileWMS.prototype.getGetFeatureInfoUrl=function(a,b,c,d){c=ol.proj.get(c);var e=this.getProjection(),f=this.getTileGrid();f||(f=this.getTileGridForProjection(c));b=f.getTileCoordForCoordAndResolution(a,b);if(!(f.getResolutions().length<=b[0])){var g=f.getResolution(b[0]),h=f.getTileCoordExtent(b,this.tmpExtent_);f=ol.size.toSize(f.getTileSize(b[0]),this.tmpSize);var k=this.gutter_;0!==k&&(f=ol.size.buffer(f,k,this.tmpSize),h=ol.extent.buffer(h,g*k,h));e&&e!==c&&(g=ol.reproj.calculateSourceResolution(e,
c,a,g),h=ol.proj.transformExtent(h,c,e),a=ol.proj.transform(a,c,e));k={SERVICE:"WMS",VERSION:ol.DEFAULT_WMS_VERSION,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};ol.obj.assign(k,this.params_,d);d=Math.floor((h[3]-a[1])/g);k[this.v13_?"I":"X"]=Math.floor((a[0]-h[0])/g);k[this.v13_?"J":"Y"]=d;return this.getRequestUrl_(b,f,h,1,e||c,k)}};ol.source.TileWMS.prototype.getGutterInternal=function(){return this.gutter_};ol.source.TileWMS.prototype.getParams=function(){return this.params_};
ol.source.TileWMS.prototype.getRequestUrl_=function(a,b,c,d,e,f){var g=this.urls;if(g){f.WIDTH=b[0];f.HEIGHT=b[1];f[this.v13_?"CRS":"SRS"]=e.getCode();"STYLES"in this.params_||(f.STYLES="");if(1!=d)switch(this.serverType_){case ol.source.WMSServerType.GEOSERVER:b=90*d+.5|0;f.FORMAT_OPTIONS="FORMAT_OPTIONS"in f?f.FORMAT_OPTIONS+(";dpi:"+b):"dpi:"+b;break;case ol.source.WMSServerType.MAPSERVER:f.MAP_RESOLUTION=90*d;break;case ol.source.WMSServerType.CARMENTA_SERVER:case ol.source.WMSServerType.QGIS:f.DPI=
90*d;break;default:ol.asserts.assert(!1,52)}e=e.getAxisOrientation();this.v13_&&"ne"==e.substr(0,2)&&(e=c[0],c[0]=c[1],c[1]=e,e=c[2],c[2]=c[3],c[3]=e);f.BBOX=c.join(",");1==g.length?g=g[0]:(a=ol.math.modulo(ol.tilecoord.hash(a),g.length),g=g[a]);return ol.uri.appendParams(g,f)}};ol.source.TileWMS.prototype.getTilePixelRatio=function(a){return this.hidpi_&&void 0!==this.serverType_?a:1};
ol.source.TileWMS.prototype.getKeyForParams_=function(){var a=0,b=[],c;for(c in this.params_)b[a++]=c+"-"+this.params_[c];return b.join("/")};
ol.source.TileWMS.prototype.fixedTileUrlFunction=function(a,b,c){var d=this.getTileGrid();d||(d=this.getTileGridForProjection(c));if(!(d.getResolutions().length<=a[0])){1==b||this.hidpi_&&void 0!==this.serverType_||(b=1);var e=d.getResolution(a[0]),f=d.getTileCoordExtent(a,this.tmpExtent_);d=ol.size.toSize(d.getTileSize(a[0]),this.tmpSize);var g=this.gutter_;0!==g&&(d=ol.size.buffer(d,g,this.tmpSize),f=ol.extent.buffer(f,e*g,f));1!=b&&(d=ol.size.scale(d,b,this.tmpSize));e={SERVICE:"WMS",VERSION:ol.DEFAULT_WMS_VERSION,
REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};ol.obj.assign(e,this.params_);return this.getRequestUrl_(a,d,f,b,c,e)}};ol.source.TileWMS.prototype.updateParams=function(a){ol.obj.assign(this.params_,a);this.updateV13_();this.setKey(this.getKeyForParams_())};ol.source.TileWMS.prototype.updateV13_=function(){this.v13_=0<=ol.string.compareVersions(this.params_.VERSION||ol.DEFAULT_WMS_VERSION,"1.3")};ngeo.LayerHelper=function(a,b,c){this.$q_=a;this.$http_=b;this.tilesPreloadingLimit_=c};ngeo.LayerHelper.$inject=["$q","$http","ngeoTilesPreloadingLimit"];ngeo.LayerHelper.GROUP_KEY="groupName";ngeo.LayerHelper.REFRESH_PARAM="random";ngeo.LayerHelper.prototype.createBasicWMSLayer=function(a,b,c,d,e,f,g){b={FORMAT:c,LAYERS:b};e&&(b.TIME=e);if(d){b.SERVERTYPE=d;var h=d.replace("qgisserver","qgis")}a=new ol.source.ImageWMS({url:a,params:b,serverType:h,crossOrigin:g});f&&a.updateParams(f);return new ol.layer.Image({source:a})};
goog.exportProperty(ngeo.LayerHelper.prototype,"createBasicWMSLayer",ngeo.LayerHelper.prototype.createBasicWMSLayer);
ngeo.LayerHelper.prototype.createWMTSLayerFromCapabilitites=function(a,b,c,d){var e=new ol.format.WMTSCapabilities,f=new ol.layer.Tile({preload:this.tilesPreloadingLimit_}),g=this.$q_;return this.$http_.get(a,{cache:!0}).then(function(h){var k;h.data&&(k=e.read(h.data));return k?(h=ol.source.WMTS.optionsFromCapabilities(k,{matrixSet:c,crossOrigin:"anonymous",layer:b}),goog.asserts.assert(h),h=new ol.source.WMTS(h),d&&!ol.obj.isEmpty(d)&&h.updateDimensions(d),f.setSource(h),k=ol.array.find(k.Contents.Layer,
function(a,c,d){return a.Identifier==b}),f.set("capabilitiesStyles",k.Style),g.resolve(f)):g.reject("Failed to get WMTS capabilities from "+a)})};goog.exportProperty(ngeo.LayerHelper.prototype,"createWMTSLayerFromCapabilitites",ngeo.LayerHelper.prototype.createWMTSLayerFromCapabilitites);ngeo.LayerHelper.prototype.createBasicGroup=function(a){var b=new ol.layer.Group;a&&b.setLayers(a);return b};goog.exportProperty(ngeo.LayerHelper.prototype,"createBasicGroup",ngeo.LayerHelper.prototype.createBasicGroup);
ngeo.LayerHelper.prototype.getGroupFromMap=function(a,b){a.getLayerGroup().getLayers().getArray().some(function(a){return a.get(ngeo.LayerHelper.GROUP_KEY)===b?(c=a,!0):!1});if(!c){var c=this.createBasicGroup();c.set(ngeo.LayerHelper.GROUP_KEY,b);a.addLayer(c)}return c};goog.exportProperty(ngeo.LayerHelper.prototype,"getGroupFromMap",ngeo.LayerHelper.prototype.getGroupFromMap);ngeo.LayerHelper.prototype.getFlatLayers=function(a){return this.getFlatLayers_(a,[])};
goog.exportProperty(ngeo.LayerHelper.prototype,"getFlatLayers",ngeo.LayerHelper.prototype.getFlatLayers);ngeo.LayerHelper.prototype.getFlatLayers_=function(a,b){a instanceof ol.layer.Group?a.getLayers().forEach(function(a){this.getFlatLayers_(a,b)},this):0>b.indexOf(a)&&b.push(a);return b};
ngeo.LayerHelper.prototype.getLayerByName=function(a,b){var c=null;b.some(function(b){b instanceof ol.layer.Group?(b=b.getLayers().getArray(),c=this.getLayerByName(a,b)):b.get("layerNodeName")===a&&(c=b);return!!c},this);return c};goog.exportProperty(ngeo.LayerHelper.prototype,"getLayerByName",ngeo.LayerHelper.prototype.getLayerByName);ngeo.LayerHelper.prototype.getWMTSLegendURL=function(a){var b;a=a.get("capabilitiesStyles");void 0!==a&&(a=a[0].legendURL,void 0!==a&&(b=a[0].href));return b};
goog.exportProperty(ngeo.LayerHelper.prototype,"getWMTSLegendURL",ngeo.LayerHelper.prototype.getWMTSLegendURL);ngeo.LayerHelper.prototype.getWMSLegendURL=function(a,b,c,d){if(a)return b={FORMAT:"image/png",TRANSPARENT:!0,SERVICE:"WMS",VERSION:"1.1.1",REQUEST:"GetLegendGraphic",LAYER:b},void 0!==c&&(b.SCALE=c),void 0!==d&&(b.RULE=d),ol.uri.appendParams(a,b)};goog.exportProperty(ngeo.LayerHelper.prototype,"getWMSLegendURL",ngeo.LayerHelper.prototype.getWMSLegendURL);
ngeo.LayerHelper.prototype.isLayerVisible=function(a,b){if(!a.getVisible())return!1;b=b.getView().getResolution();return b>a.getMinResolution()&&b<a.getMaxResolution()};ngeo.LayerHelper.prototype.refreshWMSLayer=function(a){a=a.getSource();goog.asserts.assert(a instanceof ol.source.ImageWMS||a instanceof ol.source.TileWMS);var b=a.getParams();b[ngeo.LayerHelper.REFRESH_PARAM]=Math.random();a.updateParams(b)};
ngeo.LayerHelper.prototype.setZIndexToFirstLevelChildren=function(a,b){a instanceof ol.layer.Group&&a.getLayers().forEach(function(a){return a.setZIndex(b)})};ngeo.LayerHelper.prototype.updateWMSLayerState=function(a,b,c){0>=b.length?a.setVisible(!1):(a.setVisible(!0),a=a.getSource(),c?a.updateParams({LAYERS:b,TIME:c}):a.updateParams({LAYERS:b}))};goog.exportProperty(ngeo.LayerHelper.prototype,"updateWMSLayerState",ngeo.LayerHelper.prototype.updateWMSLayerState);
ngeo.module.value("ngeoTilesPreloadingLimit",Infinity);ngeo.module.service("ngeoLayerHelper",ngeo.LayerHelper);gmf.ThemesEventType={CHANGE:"change"};gmf.module.value("gmfThemesOptions",{});
gmf.Themes=function(a,b,c,d,e,f){ol.events.EventTarget.call(this);this.addBlankBackgroundLayer_=!0;void 0!==f.addBlankBackgroundLayer&&(this.addBlankBackgroundLayer_=f.addBlankBackgroundLayer);this.$q_=c;this.$http_=a;this.treeUrl_=void 0;b.has("gmfTreeUrl")&&(this.treeUrl_=b.get("gmfTreeUrl"));this.cacheVersion_="0";b.has("cacheVersion")&&(this.cacheVersion_=b.get("cacheVersion"));this.ngeoLocation_=null;b.has("ngeoLocation")&&(this.ngeoLocation_=b.get("ngeoLocation"));this.layerHelper_=d;this.gettextCatalog=
e;this.deferred_=c.defer();this.promise_=this.deferred_.promise;this.loaded=!1;this.bgLayerPromise_=null};ol.inherits(gmf.Themes,ol.events.EventTarget);gmf.Themes.$inject="$http $injector $q ngeoLayerHelper gettextCatalog gmfThemesOptions".split(" ");gmf.Themes.findGroupByLayerNodeName=function(a,b){for(var c=0,d=a.length;c<d;c++)for(var e=a[c],f=0,g=e.children.length;f<g;f++){var h=e.children[f],k=[];gmf.Themes.getFlatNodes(h,k);if(gmf.Themes.findObjectByName(k,b))return h}return null};
gmf.Themes.findGroupByName=function(a,b){for(var c=0,d=a.length;c<d;c++)for(var e=a[c],f=0,g=e.children.length;f<g;f++){var h=e.children[f],k=[];gmf.Themes.getFlatInternalNodes(h,k);if(gmf.Themes.findObjectByName(k,b))return h}return null};gmf.Themes.findObjectByName=function(a,b){return ol.array.find(a,function(a){return a.name===b})};gmf.Themes.findThemeByName=function(a,b){return gmf.Themes.findObjectByName(a,b)};
gmf.Themes.getFlatInternalNodes=function(a,b){var c=a.children;if(void 0!==c)for(b.push(a),a=0;a<c.length;a++)gmf.Themes.getFlatInternalNodes(c[a],b)};gmf.Themes.getFlatNodes=function(a,b){var c=a.children;if(void 0!==c)for(a=0;a<c.length;a++)gmf.Themes.getFlatNodes(c[a],b);else b.push(a)};
gmf.Themes.prototype.getBgLayers=function(){var a=this,b=this.gettextCatalog;if(this.bgLayerPromise_)return this.bgLayerPromise_;var c=this.$q_,d=this.layerHelper_,e=function(a,b){b.push(ol.getUid(a));(a.children||[]).forEach(function(a){e(a,b)})},f=function(a,b){b.set("label",a.name);b.set("metadata",a.metadata);b.set("dimensions",a.dimensions);var c=[];e(a,c);b.set("querySourceIds",c);return b},g=function(a,b){if("WMTS"===b.type)return goog.asserts.assert(b.url,"Layer URL is required"),d.createWMTSLayerFromCapabilitites(b.url,
b.layer||"",b.matrixSet,b.dimensions).then(f.bind(null,b)).then(null,function(a){var d='Unable to build layer "'+b.layer+'" from WMTSCapabilities: '+b.url+"\n";d+='OpenLayers error is "'+a.message;console.error(d);return c.resolve(void 0)});if("WMS"===b.type)return goog.asserts.assert(b.ogcServer,"An OGC server is required"),a=a[b.ogcServer],goog.asserts.assert(a,"The OGC server was not found"),goog.asserts.assert(a.url,"The server URL is required"),goog.asserts.assert(a.imageType,"The server image type is required"),
f(b,d.createBasicWMSLayer(a.url,b.layers||"",a.imageType,a.type,void 0,b.dimensions,a.credential?"use-credentials":"anonymous"));goog.asserts.fail("Unsupported type: "+b.type)},h=function(a,b){a=b.children.map(function(a){return a}).reverse().map(g.bind(null,a));return c.all(a).then(function(a){if(a){a=a.filter(function(a){return a});var c=new ol.Collection(a)}a=d.createBasicGroup(c);f(b,a);return a})},k=function(a){var b=a.background_layers.map(function(b){var c=b.type;if("WMTS"===c||"WMS"===c)return g(a.ogcServers,
b);if(b.children)return h(a.ogcServers,b)},this);return c.all(b)}.bind(this);return this.bgLayerPromise_=this.promise_.then(k).then(function(c){var d=[];a.addBlankBackgroundLayer_&&(b.getString("blank"),d.push(new ol.layer.Tile({label:"blank",metadata:{thumbnail:""}})));c.forEach(function(a){a&&d.push(a)});return d})};gmf.Themes.prototype.getThemeObject=function(a){return this.promise_.then(function(b){return gmf.Themes.findThemeByName(b.themes,a)})};
goog.exportProperty(gmf.Themes.prototype,"getThemeObject",gmf.Themes.prototype.getThemeObject);gmf.Themes.prototype.getThemesObject=function(){return this.promise_.then(function(a){return a.themes})};goog.exportProperty(gmf.Themes.prototype,"getThemesObject",gmf.Themes.prototype.getThemesObject);gmf.Themes.prototype.getBackgroundLayersObject=function(){goog.asserts.assert(null!==this.promise_);return this.promise_.then(function(a){return a.background_layers})};
gmf.Themes.prototype.getOgcServersObject=function(){goog.asserts.assert(null!==this.promise_);return this.promise_.then(function(a){return a.ogcServers})};goog.exportProperty(gmf.Themes.prototype,"getOgcServersObject",gmf.Themes.prototype.getOgcServersObject);gmf.Themes.prototype.hasEditableLayers=function(){goog.asserts.assert(null!==this.promise_);return this.promise_.then(this.hasEditableLayers_.bind(this))};gmf.Themes.prototype.hasEditableLayers_=function(a){var b=this;return a.themes.some(function(a){return a.children.some(b.hasNodeEditableLayers_.bind(b))})};
gmf.Themes.prototype.hasNodeEditableLayers_=function(a){if(a.editable)return!0;var b=!1;(a=a.children)&&a.length&&(b=a.some(this.hasNodeEditableLayers_.bind(this)));return b};gmf.Themes.getNodeMaxResolution=function(a){var b=a.metadata;a=a.maxResolutionHint;void 0===a&&void 0!==b&&(a=b.maxResolution);return a};gmf.Themes.getNodeMinResolution=function(a){var b=a.metadata;a=a.minResolutionHint;void 0===a&&void 0!==b&&(a=b.minResolution);return a};
gmf.Themes.prototype.loadThemes=function(a){var b=this;goog.asserts.assert(this.treeUrl_,"gmfTreeUrl should be defined.");this.loaded&&(this.deferred_=this.$q_.defer(),this.promise_=this.deferred_.promise,this.bgLayerPromise_=null,this.loaded=!1);this.$http_.get(this.treeUrl_,{params:void 0!==a?{role:a,cache_version:this.cacheVersion_}:{cache_version:this.cacheVersion_},cache:!1,withCredentials:!0}).then(function(a){if(0!=a.data.errors.length){var c="The themes contain some errors:\n"+a.data.errors.join("\n");
console.error(c);null!==b.ngeoLocation_&&b.ngeoLocation_.hasParam("debug")&&window.alert(c)}b.deferred_.resolve(a.data);b.dispatchEvent(gmf.ThemesEventType.CHANGE);b.loaded=!0},function(a){b.deferred_.reject(a)})};goog.exportProperty(gmf.Themes.prototype,"loadThemes",gmf.Themes.prototype.loadThemes);gmf.module.service("gmfThemes",gmf.Themes);gmf.Themes.NodeType={MIXED_GROUP:"MixedGroup",NOT_MIXED_GROUP:"NotMixedGroup",WMTS:"WMTS",WMS:"WMS"};ngeo.BackgroundEventType={CHANGE:"change"};ngeo.BackgroundEvent=function(a,b,c){ol.events.Event.call(this,a);this.current=b;this.previous=c};ol.inherits(ngeo.BackgroundEvent,ol.events.Event);ngeo.BackgroundLayerMgr=function(a){ol.Observable.call(this);this.mapUids_={};this.ngeoLayerHelper_=a};ol.inherits(ngeo.BackgroundLayerMgr,ol.Observable);ngeo.BackgroundLayerMgr.$inject=["ngeoLayerHelper"];
ngeo.BackgroundLayerMgr.prototype.get=function(a){return ol.getUid(a).toString()in this.mapUids_?this.ngeoLayerHelper_.getGroupFromMap(a,ngeo.BackgroundLayerMgr.BACKGROUNDLAYERGROUP_NAME).getLayers().item(0):null};goog.exportProperty(ngeo.BackgroundLayerMgr.prototype,"get",ngeo.BackgroundLayerMgr.prototype.get);
ngeo.BackgroundLayerMgr.prototype.set=function(a,b){var c=ol.getUid(a).toString(),d=this.get(a);null!==b&&(b.setZIndex(-200),this.ngeoLayerHelper_.setZIndexToFirstLevelChildren(b,-200));a=this.ngeoLayerHelper_.getGroupFromMap(a,ngeo.BackgroundLayerMgr.BACKGROUNDLAYERGROUP_NAME);null!==d?(goog.asserts.assert(c in this.mapUids_),null!==b?a.getLayers().setAt(0,b):(a.getLayers().removeAt(0),delete this.mapUids_[c])):null!==b&&(a.getLayers().insertAt(0,b),this.mapUids_[c]=!0);this.dispatchEvent(new ngeo.BackgroundEvent(ngeo.BackgroundEventType.CHANGE,
b,d));return d};goog.exportProperty(ngeo.BackgroundLayerMgr.prototype,"set",ngeo.BackgroundLayerMgr.prototype.set);ngeo.BackgroundLayerMgr.prototype.getOpacityBgLayer=function(a){return ol.getUid(a).toString()in this.mapUids_?this.ngeoLayerHelper_.getGroupFromMap(a,ngeo.BackgroundLayerMgr.BACKGROUNDLAYERGROUP_NAME).getLayers().item(1):null};goog.exportProperty(ngeo.BackgroundLayerMgr.prototype,"getOpacityBgLayer",ngeo.BackgroundLayerMgr.prototype.getOpacityBgLayer);
ngeo.BackgroundLayerMgr.prototype.setOpacityBgLayer=function(a,b){b.setOpacity(0);b.setVisible(!0);b.setZIndex(-100);this.ngeoLayerHelper_.setZIndexToFirstLevelChildren(b,-100);a=this.ngeoLayerHelper_.getGroupFromMap(a,ngeo.BackgroundLayerMgr.BACKGROUNDLAYERGROUP_NAME);-1===a.getLayers().getArray().indexOf(b)&&a.getLayers().push(b)};goog.exportProperty(ngeo.BackgroundLayerMgr.prototype,"setOpacityBgLayer",ngeo.BackgroundLayerMgr.prototype.setOpacityBgLayer);
ngeo.BackgroundLayerMgr.prototype.updateDimensions=function(a,b){if(a=this.get(a)){var c=[a];a instanceof ol.layer.Group&&(c=a.getLayers().getArray());c.forEach(function(a){goog.asserts.assertInstanceof(a,ol.layer.Layer);if(a){var c=!1,d={},g;for(g in a.get("dimensions")){var h=b[g];void 0!==h&&(d[g]=h,c=!0)}if(c)if(a=a.getSource(),a instanceof ol.source.WMTS)a.updateDimensions(d),a.refresh();else if(a instanceof ol.source.TileWMS||a instanceof ol.source.ImageWMS)a.updateParams(d),a.refresh()}})}};
goog.exportProperty(ngeo.BackgroundLayerMgr.prototype,"updateDimensions",ngeo.BackgroundLayerMgr.prototype.updateDimensions);ngeo.module.service("ngeoBackgroundLayerMgr",ngeo.BackgroundLayerMgr);ngeo.BackgroundLayerMgr.BACKGROUNDLAYERGROUP_NAME="background";gmf.module.value("gmfBackgroundlayerselectorTemplateUrl",function(a,b){a=b.gmfBackgroundlayerselectorTemplateurl;return void 0!==a?a:gmf.baseTemplateUrl+"/backgroundlayerselector.html"});function gmfBackgroundlayerselectorTemplateUrl(a,b,c){return c(a,b)}gmfBackgroundlayerselectorTemplateUrl.$inject=["$element","$attrs","gmfBackgroundlayerselectorTemplateUrl"];
gmf.backgroundlayerselectorComponent={controller:"GmfBackgroundlayerselectorController as ctrl",bindings:{map:"=gmfBackgroundlayerselectorMap",opacityOptions:"=gmfBackgroundlayerOpacityOptions",select:"&?gmfBackgroundlayerselectorSelect"},templateUrl:gmfBackgroundlayerselectorTemplateUrl};gmf.module.component("gmfBackgroundlayerselector",gmf.backgroundlayerselectorComponent);
gmf.BackgroundlayerselectorController=function(a,b,c){this.gmfThemes_=c;this.listenerKeys_=[];this.listenerKeys_.push(ol.events.listen(c,gmf.ThemesEventType.CHANGE,this.handleThemesChange_,this));this.backgroundLayerMgr_=b;this.listenerKeys_.push(ol.events.listen(this.backgroundLayerMgr_,ngeo.BackgroundEventType.CHANGE,function(a){this.bgLayer=a.current},this));a.$on("$destroy",this.handleDestroy_.bind(this))};gmf.BackgroundlayerselectorController.$inject=["$scope","ngeoBackgroundLayerMgr","gmfThemes"];
gmf.module.controller("GmfBackgroundlayerselectorController",gmf.BackgroundlayerselectorController);gmf.BackgroundlayerselectorController.prototype.$onInit=function(){this.handleThemesChange_()};
gmf.BackgroundlayerselectorController.prototype.handleThemesChange_=function(){var a=this;this.gmfThemes_.getBgLayers().then(function(b){a.bgLayers=b;if(void 0!==a.opacityOptions&&(b=b.find(function(b){return b.get("label")===a.opacityOptions}),void 0!==b)){a.setOpacityBgLayer(b);a.opacityLayer=b;a.bgLayers=a.bgLayers.slice();var c=a.bgLayers.findIndex(function(b){return b===a.opacityLayer});a.bgLayers.splice(c,1);a.bgLayers.push(b)}})};
gmf.BackgroundlayerselectorController.prototype.getSetBgLayerOpacity=function(a){a&&this.opacityLayer.setOpacity(a);return this.opacityLayer.getOpacity()};goog.exportProperty(gmf.BackgroundlayerselectorController.prototype,"getSetBgLayerOpacity",gmf.BackgroundlayerselectorController.prototype.getSetBgLayerOpacity);gmf.BackgroundlayerselectorController.prototype.setLayer=function(a,b){this.bgLayer=a;this.backgroundLayerMgr_.set(this.map,a);!b&&this.select&&this.select()};
goog.exportProperty(gmf.BackgroundlayerselectorController.prototype,"setLayer",gmf.BackgroundlayerselectorController.prototype.setLayer);gmf.BackgroundlayerselectorController.prototype.setOpacityBgLayer=function(a){this.backgroundLayerMgr_.setOpacityBgLayer(this.map,a)};goog.exportProperty(gmf.BackgroundlayerselectorController.prototype,"setOpacityBgLayer",gmf.BackgroundlayerselectorController.prototype.setOpacityBgLayer);
gmf.BackgroundlayerselectorController.prototype.handleDestroy_=function(){this.listenerKeys_.forEach(ol.events.unlistenByKey);this.listenerKeys_.length=0};ol.format.XMLFeature=function(){this.xmlSerializer_=new XMLSerializer;ol.format.Feature.call(this)};ol.inherits(ol.format.XMLFeature,ol.format.Feature);ol.format.XMLFeature.prototype.getType=function(){return ol.format.FormatType.XML};ol.format.XMLFeature.prototype.readFeature=function(a,b){return ol.xml.isDocument(a)?this.readFeatureFromDocument(a,b):ol.xml.isNode(a)?this.readFeatureFromNode(a,b):"string"===typeof a?(a=ol.xml.parse(a),this.readFeatureFromDocument(a,b)):null};
ol.format.XMLFeature.prototype.readFeatureFromDocument=function(a,b){a=this.readFeaturesFromDocument(a,b);return 0<a.length?a[0]:null};ol.format.XMLFeature.prototype.readFeatureFromNode=function(a,b){return null};ol.format.XMLFeature.prototype.readFeatures=function(a,b){return ol.xml.isDocument(a)?this.readFeaturesFromDocument(a,b):ol.xml.isNode(a)?this.readFeaturesFromNode(a,b):"string"===typeof a?(a=ol.xml.parse(a),this.readFeaturesFromDocument(a,b)):[]};
ol.format.XMLFeature.prototype.readFeaturesFromDocument=function(a,b){var c=[];for(a=a.firstChild;a;a=a.nextSibling)a.nodeType==Node.ELEMENT_NODE&&ol.array.extend(c,this.readFeaturesFromNode(a,b));return c};ol.format.XMLFeature.prototype.readFeaturesFromNode=function(a,b){};
ol.format.XMLFeature.prototype.readGeometry=function(a,b){return ol.xml.isDocument(a)?this.readGeometryFromDocument(a,b):ol.xml.isNode(a)?this.readGeometryFromNode(a,b):"string"===typeof a?(a=ol.xml.parse(a),this.readGeometryFromDocument(a,b)):null};ol.format.XMLFeature.prototype.readGeometryFromDocument=function(a,b){return null};ol.format.XMLFeature.prototype.readGeometryFromNode=function(a,b){return null};
ol.format.XMLFeature.prototype.readProjection=function(a){return ol.xml.isDocument(a)?this.readProjectionFromDocument(a):ol.xml.isNode(a)?this.readProjectionFromNode(a):"string"===typeof a?(a=ol.xml.parse(a),this.readProjectionFromDocument(a)):null};ol.format.XMLFeature.prototype.readProjectionFromDocument=function(a){return this.defaultDataProjection};ol.format.XMLFeature.prototype.readProjectionFromNode=function(a){return this.defaultDataProjection};
ol.format.XMLFeature.prototype.writeFeature=function(a,b){a=this.writeFeatureNode(a,b);return this.xmlSerializer_.serializeToString(a)};ol.format.XMLFeature.prototype.writeFeatureNode=function(a,b){return null};ol.format.XMLFeature.prototype.writeFeatures=function(a,b){a=this.writeFeaturesNode(a,b);return this.xmlSerializer_.serializeToString(a)};ol.format.XMLFeature.prototype.writeFeaturesNode=function(a,b){return null};
ol.format.XMLFeature.prototype.writeGeometry=function(a,b){a=this.writeGeometryNode(a,b);return this.xmlSerializer_.serializeToString(a)};ol.format.XMLFeature.prototype.writeGeometryNode=function(a,b){return null};ol.geom.MultiLineString=function(a,b){ol.geom.SimpleGeometry.call(this);this.ends_=[];this.maxDeltaRevision_=this.maxDelta_=-1;this.setCoordinates(a,b)};ol.inherits(ol.geom.MultiLineString,ol.geom.SimpleGeometry);ol.geom.MultiLineString.prototype.appendLineString=function(a){this.flatCoordinates?ol.array.extend(this.flatCoordinates,a.getFlatCoordinates().slice()):this.flatCoordinates=a.getFlatCoordinates().slice();this.ends_.push(this.flatCoordinates.length);this.changed()};
ol.geom.MultiLineString.prototype.clone=function(){var a=new ol.geom.MultiLineString(null);a.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice());return a};
ol.geom.MultiLineString.prototype.closestPointXY=function(a,b,c,d){if(d<ol.extent.closestSquaredDistanceXY(this.getExtent(),a,b))return d;this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ol.geom.flat.closest.getsMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision());return ol.geom.flat.closest.getsClosestPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,a,b,c,d)};
ol.geom.MultiLineString.prototype.getCoordinateAtM=function(a,b,c){return this.layout!=ol.geom.GeometryLayout.XYM&&this.layout!=ol.geom.GeometryLayout.XYZM||0===this.flatCoordinates.length?null:ol.geom.flat.interpolate.lineStringsCoordinateAtM(this.flatCoordinates,0,this.ends_,this.stride,a,void 0!==b?b:!1,void 0!==c?c:!1)};ol.geom.MultiLineString.prototype.getCoordinates=function(){return ol.geom.flat.inflate.coordinatess(this.flatCoordinates,0,this.ends_,this.stride)};
ol.geom.MultiLineString.prototype.getEnds=function(){return this.ends_};ol.geom.MultiLineString.prototype.getLineString=function(a){if(0>a||this.ends_.length<=a)return null;var b=new ol.geom.LineString(null);b.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===a?0:this.ends_[a-1],this.ends_[a]));return b};
ol.geom.MultiLineString.prototype.getLineStrings=function(){var a=this.flatCoordinates,b=this.ends_,c=this.layout,d=[],e=0,f;var g=0;for(f=b.length;g<f;++g){var h=b[g],k=new ol.geom.LineString(null);k.setFlatCoordinates(c,a.slice(e,h));d.push(k);e=h}return d};
ol.geom.MultiLineString.prototype.getFlatMidpoints=function(){var a=[],b=this.flatCoordinates,c=0,d=this.ends_,e=this.stride,f;var g=0;for(f=d.length;g<f;++g){var h=d[g];c=ol.geom.flat.interpolate.lineString(b,c,h,e,.5);ol.array.extend(a,c);c=h}return a};
ol.geom.MultiLineString.prototype.getSimplifiedGeometryInternal=function(a){var b=[],c=[];b.length=ol.geom.flat.simplify.douglasPeuckers(this.flatCoordinates,0,this.ends_,this.stride,a,b,0,c);a=new ol.geom.MultiLineString(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,b,c);return a};ol.geom.MultiLineString.prototype.getType=function(){return ol.geom.GeometryType.MULTI_LINE_STRING};
ol.geom.MultiLineString.prototype.intersectsExtent=function(a){return ol.geom.flat.intersectsextent.lineStrings(this.flatCoordinates,0,this.ends_,this.stride,a)};
ol.geom.MultiLineString.prototype.setCoordinates=function(a,b){a?(this.setLayout(b,a,2),this.flatCoordinates||(this.flatCoordinates=[]),a=ol.geom.flat.deflate.coordinatess(this.flatCoordinates,0,a,this.stride,this.ends_),this.flatCoordinates.length=0===a.length?0:a[a.length-1],this.changed()):this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null,this.ends_)};ol.geom.MultiLineString.prototype.setFlatCoordinates=function(a,b,c){this.setFlatCoordinatesInternal(a,b);this.ends_=c;this.changed()};
ol.geom.MultiLineString.prototype.setLineStrings=function(a){var b=this.getLayout(),c=[],d=[],e;var f=0;for(e=a.length;f<e;++f){var g=a[f];0===f&&(b=g.getLayout());ol.array.extend(c,g.getFlatCoordinates());d.push(c.length)}this.setFlatCoordinates(b,c,d)};ol.geom.MultiPoint=function(a,b){ol.geom.SimpleGeometry.call(this);this.setCoordinates(a,b)};ol.inherits(ol.geom.MultiPoint,ol.geom.SimpleGeometry);ol.geom.MultiPoint.prototype.appendPoint=function(a){this.flatCoordinates?ol.array.extend(this.flatCoordinates,a.getFlatCoordinates()):this.flatCoordinates=a.getFlatCoordinates().slice();this.changed()};ol.geom.MultiPoint.prototype.clone=function(){var a=new ol.geom.MultiPoint(null);a.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return a};
ol.geom.MultiPoint.prototype.closestPointXY=function(a,b,c,d){if(d<ol.extent.closestSquaredDistanceXY(this.getExtent(),a,b))return d;var e=this.flatCoordinates,f=this.stride,g;var h=0;for(g=e.length;h<g;h+=f){var k=ol.math.squaredDistance(a,b,e[h],e[h+1]);if(k<d){d=k;for(k=0;k<f;++k)c[k]=e[h+k];c.length=f}}return d};ol.geom.MultiPoint.prototype.getCoordinates=function(){return ol.geom.flat.inflate.coordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};
ol.geom.MultiPoint.prototype.getPoint=function(a){var b=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;if(0>a||b<=a)return null;b=new ol.geom.Point(null);b.setFlatCoordinates(this.layout,this.flatCoordinates.slice(a*this.stride,(a+1)*this.stride));return b};ol.geom.MultiPoint.prototype.getPoints=function(){var a=this.flatCoordinates,b=this.layout,c=this.stride,d=[],e;var f=0;for(e=a.length;f<e;f+=c){var g=new ol.geom.Point(null);g.setFlatCoordinates(b,a.slice(f,f+c));d.push(g)}return d};
ol.geom.MultiPoint.prototype.getType=function(){return ol.geom.GeometryType.MULTI_POINT};ol.geom.MultiPoint.prototype.intersectsExtent=function(a){var b=this.flatCoordinates,c=this.stride,d;var e=0;for(d=b.length;e<d;e+=c){var f=b[e];var g=b[e+1];if(ol.extent.containsXY(a,f,g))return!0}return!1};
ol.geom.MultiPoint.prototype.setCoordinates=function(a,b){a?(this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ol.geom.flat.deflate.coordinates(this.flatCoordinates,0,a,this.stride),this.changed()):this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null)};ol.geom.MultiPoint.prototype.setFlatCoordinates=function(a,b){this.setFlatCoordinatesInternal(a,b);this.changed()};ol.geom.flat.center={};ol.geom.flat.center.linearRingss=function(a,b,c,d){var e=[],f;ol.extent.createEmpty();var g=0;for(f=c.length;g<f;++g){var h=c[g];b=ol.extent.createOrUpdateFromFlatCoordinates(a,b,h[0],d);e.push((b[0]+b[2])/2,(b[1]+b[3])/2);b=h[h.length-1]}return e};ol.geom.MultiPolygon=function(a,b){ol.geom.SimpleGeometry.call(this);this.endss_=[];this.flatInteriorPointsRevision_=-1;this.flatInteriorPoints_=null;this.orientedRevision_=this.maxDeltaRevision_=this.maxDelta_=-1;this.orientedFlatCoordinates_=null;this.setCoordinates(a,b)};ol.inherits(ol.geom.MultiPolygon,ol.geom.SimpleGeometry);
ol.geom.MultiPolygon.prototype.appendPolygon=function(a){if(this.flatCoordinates){var b=this.flatCoordinates.length;ol.array.extend(this.flatCoordinates,a.getFlatCoordinates());a=a.getEnds().slice();var c;var d=0;for(c=a.length;d<c;++d)a[d]+=b}else this.flatCoordinates=a.getFlatCoordinates().slice(),a=a.getEnds().slice(),this.endss_.push();this.endss_.push(a);this.changed()};
ol.geom.MultiPolygon.prototype.clone=function(){for(var a=new ol.geom.MultiPolygon(null),b=this.endss_.length,c=Array(b),d=0;d<b;++d)c[d]=this.endss_[d].slice();a.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),c);return a};
ol.geom.MultiPolygon.prototype.closestPointXY=function(a,b,c,d){if(d<ol.extent.closestSquaredDistanceXY(this.getExtent(),a,b))return d;this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ol.geom.flat.closest.getssMaxSquaredDelta(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision());return ol.geom.flat.closest.getssClosestPoint(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,a,b,c,d)};
ol.geom.MultiPolygon.prototype.containsXY=function(a,b){return ol.geom.flat.contains.linearRingssContainsXY(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,a,b)};ol.geom.MultiPolygon.prototype.getArea=function(){return ol.geom.flat.area.linearRingss(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)};
ol.geom.MultiPolygon.prototype.getCoordinates=function(a){if(void 0!==a){var b=this.getOrientedFlatCoordinates().slice();ol.geom.flat.orient.orientLinearRingss(b,0,this.endss_,this.stride,a)}else b=this.flatCoordinates;return ol.geom.flat.inflate.coordinatesss(b,0,this.endss_,this.stride)};ol.geom.MultiPolygon.prototype.getEndss=function(){return this.endss_};
ol.geom.MultiPolygon.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var a=ol.geom.flat.center.linearRingss(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=ol.geom.flat.interiorpoint.linearRingss(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,a);this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_};
ol.geom.MultiPolygon.prototype.getInteriorPoints=function(){var a=new ol.geom.MultiPoint(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XYM,this.getFlatInteriorPoints().slice());return a};
ol.geom.MultiPolygon.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var a=this.flatCoordinates;ol.geom.flat.orient.linearRingssAreOriented(a,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=a:(this.orientedFlatCoordinates_=a.slice(),this.orientedFlatCoordinates_.length=ol.geom.flat.orient.orientLinearRingss(this.orientedFlatCoordinates_,0,this.endss_,this.stride));this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_};
ol.geom.MultiPolygon.prototype.getSimplifiedGeometryInternal=function(a){var b=[],c=[];b.length=ol.geom.flat.simplify.quantizess(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(a),b,0,c);a=new ol.geom.MultiPolygon(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,b,c);return a};
ol.geom.MultiPolygon.prototype.getPolygon=function(a){if(0>a||this.endss_.length<=a)return null;if(0===a)var b=0;else b=this.endss_[a-1],b=b[b.length-1];a=this.endss_[a].slice();var c=a[a.length-1];if(0!==b){var d;var e=0;for(d=a.length;e<d;++e)a[e]-=b}e=new ol.geom.Polygon(null);e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(b,c),a);return e};
ol.geom.MultiPolygon.prototype.getPolygons=function(){var a=this.layout,b=this.flatCoordinates,c=this.endss_,d=[],e=0,f,g;var h=0;for(f=c.length;h<f;++h){var k=c[h].slice(),l=k[k.length-1];if(0!==e){var m=0;for(g=k.length;m<g;++m)k[m]-=e}m=new ol.geom.Polygon(null);m.setFlatCoordinates(a,b.slice(e,l),k);d.push(m);e=l}return d};ol.geom.MultiPolygon.prototype.getType=function(){return ol.geom.GeometryType.MULTI_POLYGON};
ol.geom.MultiPolygon.prototype.intersectsExtent=function(a){return ol.geom.flat.intersectsextent.linearRingss(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,a)};
ol.geom.MultiPolygon.prototype.setCoordinates=function(a,b){a?(this.setLayout(b,a,3),this.flatCoordinates||(this.flatCoordinates=[]),a=ol.geom.flat.deflate.coordinatesss(this.flatCoordinates,0,a,this.stride,this.endss_),0===a.length?this.flatCoordinates.length=0:(a=a[a.length-1],this.flatCoordinates.length=0===a.length?0:a[a.length-1]),this.changed()):this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null,this.endss_)};
ol.geom.MultiPolygon.prototype.setFlatCoordinates=function(a,b,c){this.setFlatCoordinatesInternal(a,b);this.endss_=c;this.changed()};ol.geom.MultiPolygon.prototype.setPolygons=function(a){var b=this.getLayout(),c=[],d=[],e;var f=0;for(e=a.length;f<e;++f){var g=a[f];0===f&&(b=g.getLayout());var h=c.length;var k=g.getEnds();var l;var m=0;for(l=k.length;m<l;++m)k[m]+=h;ol.array.extend(c,g.getFlatCoordinates());d.push(k)}this.setFlatCoordinates(b,c,d)};ol.format.GMLBase=function(a){a=a?a:{};this.featureType=a.featureType;this.featureNS=a.featureNS;this.srsName=a.srsName;this.schemaLocation="";this.FEATURE_COLLECTION_PARSERS={};this.FEATURE_COLLECTION_PARSERS[ol.format.GMLBase.GMLNS]={featureMember:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readFeaturesInternal),featureMembers:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readFeaturesInternal)};ol.format.XMLFeature.call(this)};ol.inherits(ol.format.GMLBase,ol.format.XMLFeature);
ol.format.GMLBase.GMLNS="http://www.opengis.net/gml";ol.format.GMLBase.ONLY_WHITESPACE_RE_=/^[\s\xa0]*$/;
ol.format.GMLBase.prototype.readFeaturesInternal=function(a,b){var c=a.localName,d=null;if("FeatureCollection"==c)d="http://www.opengis.net/wfs"===a.namespaceURI?ol.xml.pushParseAndPop([],this.FEATURE_COLLECTION_PARSERS,a,b,this):ol.xml.pushParseAndPop(null,this.FEATURE_COLLECTION_PARSERS,a,b,this);else if("featureMembers"==c||"featureMember"==c){var e=b[0],f=e.featureType;d=e.featureNS;var g;if(!f&&a.childNodes){f=[];d={};var h=0;for(g=a.childNodes.length;h<g;++h){var k=a.childNodes[h];if(1===k.nodeType){var l=
k.nodeName.split(":").pop();if(-1===f.indexOf(l)){var m="",n=0;k=k.namespaceURI;for(var p in d){if(d[p]===k){m=p;break}++n}m||(m="p"+n,d[m]=k);f.push(m+":"+l)}}}"featureMember"!=c&&(e.featureType=f,e.featureNS=d)}"string"===typeof d&&(h=d,d={},d.p0=h);p={};f=Array.isArray(f)?f:[f];for(var q in d){e={};h=0;for(g=f.length;h<g;++h)(-1===f[h].indexOf(":")?"p0":f[h].split(":")[0])===q&&(e[f[h].split(":").pop()]="featureMembers"==c?ol.xml.makeArrayPusher(this.readFeatureElement,this):ol.xml.makeReplacer(this.readFeatureElement,
this));p[d[q]]=e}d="featureMember"==c?ol.xml.pushParseAndPop(void 0,p,a,b):ol.xml.pushParseAndPop([],p,a,b)}null===d&&(d=[]);return d};ol.format.GMLBase.prototype.readGeometryElement=function(a,b){var c=b[0];c.srsName=a.firstElementChild.getAttribute("srsName");c.srsDimension=a.firstElementChild.getAttribute("srsDimension");if(a=ol.xml.pushParseAndPop(null,this.GEOMETRY_PARSERS_,a,b,this))return ol.format.Feature.transformWithOptions(a,!1,c)};
ol.format.GMLBase.prototype.readFeatureElement=function(a,b){var c=a.getAttribute("fid")||ol.xml.getAttributeNS(a,ol.format.GMLBase.GMLNS,"id"),d={},e;for(a=a.firstElementChild;a;a=a.nextElementSibling){var f=a.localName;if(0===a.childNodes.length||1===a.childNodes.length&&(3===a.firstChild.nodeType||4===a.firstChild.nodeType)){var g=ol.xml.getAllTextContent(a,!1);ol.format.GMLBase.ONLY_WHITESPACE_RE_.test(g)&&(g=void 0);d[f]=g}else"boundedBy"!==f&&(e=f),d[f]=this.readGeometryElement(a,b)}b=new ol.Feature(d);
e&&b.setGeometryName(e);c&&b.setId(c);return b};ol.format.GMLBase.prototype.readPoint=function(a,b){if(a=this.readFlatCoordinatesFromNode_(a,b))return b=new ol.geom.Point(null),b.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,a),b};ol.format.GMLBase.prototype.readMultiPoint=function(a,b){if(a=ol.xml.pushParseAndPop([],this.MULTIPOINT_PARSERS_,a,b,this))return new ol.geom.MultiPoint(a)};
ol.format.GMLBase.prototype.readMultiLineString=function(a,b){if(a=ol.xml.pushParseAndPop([],this.MULTILINESTRING_PARSERS_,a,b,this))return b=new ol.geom.MultiLineString(null),b.setLineStrings(a),b};ol.format.GMLBase.prototype.readMultiPolygon=function(a,b){if(a=ol.xml.pushParseAndPop([],this.MULTIPOLYGON_PARSERS_,a,b,this))return b=new ol.geom.MultiPolygon(null),b.setPolygons(a),b};ol.format.GMLBase.prototype.pointMemberParser_=function(a,b){ol.xml.parseNode(this.POINTMEMBER_PARSERS_,a,b,this)};
ol.format.GMLBase.prototype.lineStringMemberParser_=function(a,b){ol.xml.parseNode(this.LINESTRINGMEMBER_PARSERS_,a,b,this)};ol.format.GMLBase.prototype.polygonMemberParser_=function(a,b){ol.xml.parseNode(this.POLYGONMEMBER_PARSERS_,a,b,this)};ol.format.GMLBase.prototype.readLineString=function(a,b){if(a=this.readFlatCoordinatesFromNode_(a,b))return b=new ol.geom.LineString(null),b.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,a),b};
ol.format.GMLBase.prototype.readFlatLinearRing_=function(a,b){if(a=ol.xml.pushParseAndPop(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS_,a,b,this))return a};ol.format.GMLBase.prototype.readLinearRing=function(a,b){if(a=this.readFlatCoordinatesFromNode_(a,b))return b=new ol.geom.LinearRing(null),b.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,a),b};
ol.format.GMLBase.prototype.readPolygon=function(a,b){if((a=ol.xml.pushParseAndPop([null],this.FLAT_LINEAR_RINGS_PARSERS_,a,b,this))&&a[0]){b=new ol.geom.Polygon(null);var c=a[0],d=[c.length],e;var f=1;for(e=a.length;f<e;++f)ol.array.extend(c,a[f]),d.push(c.length);b.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,c,d);return b}};ol.format.GMLBase.prototype.readFlatCoordinatesFromNode_=function(a,b){return ol.xml.pushParseAndPop(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS_,a,b,this)};
ol.format.GMLBase.prototype.MULTIPOINT_PARSERS_={"http://www.opengis.net/gml":{pointMember:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.pointMemberParser_),pointMembers:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.pointMemberParser_)}};ol.format.GMLBase.prototype.MULTILINESTRING_PARSERS_={"http://www.opengis.net/gml":{lineStringMember:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.lineStringMemberParser_),lineStringMembers:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.lineStringMemberParser_)}};
ol.format.GMLBase.prototype.MULTIPOLYGON_PARSERS_={"http://www.opengis.net/gml":{polygonMember:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.polygonMemberParser_),polygonMembers:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.polygonMemberParser_)}};ol.format.GMLBase.prototype.POINTMEMBER_PARSERS_={"http://www.opengis.net/gml":{Point:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readFlatCoordinatesFromNode_)}};ol.format.GMLBase.prototype.LINESTRINGMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readLineString)}};
ol.format.GMLBase.prototype.POLYGONMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readPolygon)}};ol.format.GMLBase.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readFlatLinearRing_)}};ol.format.GMLBase.prototype.readGeometryFromNode=function(a,b){return(a=this.readGeometryElement(a,[this.getReadOptions(a,b?b:{})]))?a:null};
ol.format.GMLBase.prototype.readFeaturesFromNode=function(a,b){var c={featureType:this.featureType,featureNS:this.featureNS};b&&ol.obj.assign(c,this.getReadOptions(a,b));return this.readFeaturesInternal(a,[c])||[]};ol.format.GMLBase.prototype.readProjectionFromNode=function(a){return ol.proj.get(this.srsName?this.srsName:a.firstElementChild.getAttribute("srsName"))};ol.format.GML2=function(a){a=a?a:{};ol.format.GMLBase.call(this,a);this.FEATURE_COLLECTION_PARSERS[ol.format.GMLBase.GMLNS].featureMember=ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readFeaturesInternal);this.schemaLocation=a.schemaLocation?a.schemaLocation:ol.format.GML2.schemaLocation_};ol.inherits(ol.format.GML2,ol.format.GMLBase);ol.format.GML2.schemaLocation_=ol.format.GMLBase.GMLNS+" http://schemas.opengis.net/gml/2.1.2/feature.xsd";
ol.format.GML2.prototype.readFlatCoordinates_=function(a,b){a=ol.xml.getAllTextContent(a,!1).replace(/^\s*|\s*$/g,"");var c=b[0].srsName;b="enu";c&&(c=ol.proj.get(c))&&(b=c.getAxisOrientation());a=a.trim().split(/\s+/);for(var d,e,f=[],g=0,h=a.length;g<h;g++)e=a[g].split(/,+/),c=parseFloat(e[0]),d=parseFloat(e[1]),e=3===e.length?parseFloat(e[2]):0,"en"===b.substr(0,2)?f.push(c,d,e):f.push(d,c,e);return f};
ol.format.GML2.prototype.readBox_=function(a,b){a=ol.xml.pushParseAndPop([null],this.BOX_PARSERS_,a,b,this);return ol.extent.createOrUpdate(a[1][0],a[1][1],a[1][3],a[1][4])};ol.format.GML2.prototype.innerBoundaryIsParser_=function(a,b){(a=ol.xml.pushParseAndPop(void 0,this.RING_PARSERS,a,b,this))&&b[b.length-1].push(a)};ol.format.GML2.prototype.outerBoundaryIsParser_=function(a,b){(a=ol.xml.pushParseAndPop(void 0,this.RING_PARSERS,a,b,this))&&(b[b.length-1][0]=a)};
ol.format.GML2.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS_={"http://www.opengis.net/gml":{coordinates:ol.xml.makeReplacer(ol.format.GML2.prototype.readFlatCoordinates_)}};ol.format.GML2.prototype.FLAT_LINEAR_RINGS_PARSERS_={"http://www.opengis.net/gml":{innerBoundaryIs:ol.format.GML2.prototype.innerBoundaryIsParser_,outerBoundaryIs:ol.format.GML2.prototype.outerBoundaryIsParser_}};ol.format.GML2.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:ol.xml.makeArrayPusher(ol.format.GML2.prototype.readFlatCoordinates_)}};
ol.format.GML2.prototype.GEOMETRY_PARSERS_={"http://www.opengis.net/gml":{Point:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readPoint),MultiPoint:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiPoint),LineString:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readLineString),MultiLineString:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiLineString),LinearRing:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readLinearRing),Polygon:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readPolygon),
MultiPolygon:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiPolygon),Box:ol.xml.makeReplacer(ol.format.GML2.prototype.readBox_)}};ol.format.GML2.prototype.GEOMETRY_NODE_FACTORY_=function(a,b,c){var d=b[b.length-1];b=d.multiSurface;c=d.surface;d=d.multiCurve;Array.isArray(a)?a="Envelope":(a=a.getType(),"MultiPolygon"===a&&!0===b?a="MultiSurface":"Polygon"===a&&!0===c?a="Surface":"MultiLineString"===a&&!0===d&&(a="MultiCurve"));return ol.xml.createElementNS("http://www.opengis.net/gml",a)};
ol.format.GML2.prototype.writeFeatureElement=function(a,b,c){var d=b.getId();d&&a.setAttribute("fid",d);d=c[c.length-1];var e=d.featureNS,f=b.getGeometryName();d.serializers||(d.serializers={},d.serializers[e]={});var g=b.getProperties();b=[];var h=[];for(l in g){var k=g[l];null!==k&&(b.push(l),h.push(k),l==f||k instanceof ol.geom.Geometry?l in d.serializers[e]||(d.serializers[e][l]=ol.xml.makeChildAppender(this.writeGeometryElement,this)):l in d.serializers[e]||(d.serializers[e][l]=ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)))}var l=
ol.obj.assign({},d);l.node=a;ol.xml.pushSerializeAndPop(l,d.serializers,ol.xml.makeSimpleNodeFactory(void 0,e),h,c,b)};ol.format.GML2.prototype.writeGeometryElement=function(a,b,c){var d=c[c.length-1],e=ol.obj.assign({},d);e.node=a;a=Array.isArray(b)?d.dataProjection?ol.proj.transformExtent(b,d.featureProjection,d.dataProjection):b:ol.format.Feature.transformWithOptions(b,!0,d);ol.xml.pushSerializeAndPop(e,ol.format.GML2.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[a],c,void 0,this)};
ol.format.GML2.prototype.writeCurveOrLineString_=function(a,b,c){var d=c[c.length-1].srsName;"LineStringSegment"!==a.nodeName&&d&&a.setAttribute("srsName",d);"LineString"===a.nodeName||"LineStringSegment"===a.nodeName?(d=this.createCoordinatesNode_(a.namespaceURI),a.appendChild(d),this.writeCoordinates_(d,b,c)):"Curve"===a.nodeName&&(d=ol.xml.createElementNS(a.namespaceURI,"segments"),a.appendChild(d),this.writeCurveSegments_(d,b,c))};
ol.format.GML2.prototype.createCoordinatesNode_=function(a){a=ol.xml.createElementNS(a,"coordinates");a.setAttribute("decimal",".");a.setAttribute("cs",",");a.setAttribute("ts"," ");return a};ol.format.GML2.prototype.writeCoordinates_=function(a,b,c){var d=c[c.length-1];c=d.hasZ;d=d.srsName;b=b.getCoordinates();for(var e=b.length,f=Array(e),g,h=0;h<e;++h)g=b[h],f[h]=this.getCoords_(g,d,c);ol.format.XSD.writeStringTextNode(a,f.join(" "))};
ol.format.GML2.prototype.writeCurveSegments_=function(a,b,c){var d=ol.xml.createElementNS(a.namespaceURI,"LineStringSegment");a.appendChild(d);this.writeCurveOrLineString_(d,b,c)};
ol.format.GML2.prototype.writeSurfaceOrPolygon_=function(a,b,c){var d=c[c.length-1],e=d.hasZ;d=d.srsName;"PolygonPatch"!==a.nodeName&&d&&a.setAttribute("srsName",d);"Polygon"===a.nodeName||"PolygonPatch"===a.nodeName?(b=b.getLinearRings(),ol.xml.pushSerializeAndPop({node:a,hasZ:e,srsName:d},ol.format.GML2.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,b,c,void 0,this)):"Surface"===a.nodeName&&(e=ol.xml.createElementNS(a.namespaceURI,"patches"),a.appendChild(e),this.writeSurfacePatches_(e,b,c))};
ol.format.GML2.prototype.RING_NODE_FACTORY_=function(a,b,c){a=b[b.length-1];b=a.node;c=a.exteriorWritten;void 0===c&&(a.exteriorWritten=!0);return ol.xml.createElementNS(b.namespaceURI,void 0!==c?"innerBoundaryIs":"outerBoundaryIs")};ol.format.GML2.prototype.writeSurfacePatches_=function(a,b,c){var d=ol.xml.createElementNS(a.namespaceURI,"PolygonPatch");a.appendChild(d);this.writeSurfaceOrPolygon_(d,b,c)};
ol.format.GML2.prototype.writeRing_=function(a,b,c){var d=ol.xml.createElementNS(a.namespaceURI,"LinearRing");a.appendChild(d);this.writeLinearRing_(d,b,c)};ol.format.GML2.prototype.getCoords_=function(a,b,c){var d="enu";b&&(d=ol.proj.get(b).getAxisOrientation());b="en"===d.substr(0,2)?a[0]+","+a[1]:a[1]+","+a[0];c&&(b+=","+(a[2]||0));return b};
ol.format.GML2.prototype.writeMultiCurveOrLineString_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName;d=d.curve;f&&a.setAttribute("srsName",f);b=b.getLineStrings();ol.xml.pushSerializeAndPop({node:a,hasZ:e,srsName:f,curve:d},ol.format.GML2.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,b,c,void 0,this)};
ol.format.GML2.prototype.writePoint_=function(a,b,c){var d=c[c.length-1];c=d.hasZ;var e=d.srsName;e&&a.setAttribute("srsName",e);d=this.createCoordinatesNode_(a.namespaceURI);a.appendChild(d);a=b.getCoordinates();a=this.getCoords_(a,e,c);ol.format.XSD.writeStringTextNode(d,a)};
ol.format.GML2.prototype.writeMultiPoint_=function(a,b,c){var d=c[c.length-1],e=d.hasZ;(d=d.srsName)&&a.setAttribute("srsName",d);b=b.getPoints();ol.xml.pushSerializeAndPop({node:a,hasZ:e,srsName:d},ol.format.GML2.POINTMEMBER_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("pointMember"),b,c,void 0,this)};ol.format.GML2.prototype.writePointMember_=function(a,b,c){var d=ol.xml.createElementNS(a.namespaceURI,"Point");a.appendChild(d);this.writePoint_(d,b,c)};
ol.format.GML2.prototype.writeLineStringOrCurveMember_=function(a,b,c){var d=this.GEOMETRY_NODE_FACTORY_(b,c);d&&(a.appendChild(d),this.writeCurveOrLineString_(d,b,c))};ol.format.GML2.prototype.writeLinearRing_=function(a,b,c){var d=c[c.length-1].srsName;d&&a.setAttribute("srsName",d);d=this.createCoordinatesNode_(a.namespaceURI);a.appendChild(d);this.writeCoordinates_(d,b,c)};
ol.format.GML2.prototype.writeMultiSurfaceOrPolygon_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName;d=d.surface;f&&a.setAttribute("srsName",f);b=b.getPolygons();ol.xml.pushSerializeAndPop({node:a,hasZ:e,srsName:f,surface:d},ol.format.GML2.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,b,c,void 0,this)};
ol.format.GML2.prototype.writeSurfaceOrPolygonMember_=function(a,b,c){var d=this.GEOMETRY_NODE_FACTORY_(b,c);d&&(a.appendChild(d),this.writeSurfaceOrPolygon_(d,b,c))};ol.format.GML2.prototype.writeEnvelope=function(a,b,c){var d=c[c.length-1].srsName;d&&a.setAttribute("srsName",d);ol.xml.pushSerializeAndPop({node:a},ol.format.GML2.ENVELOPE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[b[0]+" "+b[1],b[2]+" "+b[3]],c,["lowerCorner","upperCorner"],this)};
ol.format.GML2.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeCurveOrLineString_),MultiCurve:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeMultiCurveOrLineString_),Point:ol.xml.makeChildAppender(ol.format.GML2.prototype.writePoint_),MultiPoint:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeMultiPoint_),LineString:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeCurveOrLineString_),MultiLineString:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeMultiCurveOrLineString_),
LinearRing:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeLinearRing_),Polygon:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeSurfaceOrPolygon_),MultiPolygon:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeMultiSurfaceOrPolygon_),Surface:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeSurfaceOrPolygon_),MultiSurface:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeMultiSurfaceOrPolygon_),Envelope:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeEnvelope)}};
ol.format.GML2.RING_SERIALIZERS_={"http://www.opengis.net/gml":{outerBoundaryIs:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeRing_),innerBoundaryIs:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeRing_)}};ol.format.GML2.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:ol.xml.makeChildAppender(ol.format.GML2.prototype.writePointMember_)}};
ol.format.GML2.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeLineStringOrCurveMember_),curveMember:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeLineStringOrCurveMember_)}};ol.format.GML2.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(a,b,c){return ol.xml.createElementNS("http://www.opengis.net/gml",ol.format.GML2.MULTIGEOMETRY_TO_MEMBER_NODENAME_[b[b.length-1].node.nodeName])};
ol.format.GML2.MULTIGEOMETRY_TO_MEMBER_NODENAME_={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};ol.format.GML2.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeSurfaceOrPolygonMember_),polygonMember:ol.xml.makeChildAppender(ol.format.GML2.prototype.writeSurfaceOrPolygonMember_)}};
ol.format.GML2.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),upperCorner:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)}};ol.format.GML3=function(a){a=a?a:{};ol.format.GMLBase.call(this,a);this.surface_=void 0!==a.surface?a.surface:!1;this.curve_=void 0!==a.curve?a.curve:!1;this.multiCurve_=void 0!==a.multiCurve?a.multiCurve:!0;this.multiSurface_=void 0!==a.multiSurface?a.multiSurface:!0;this.schemaLocation=a.schemaLocation?a.schemaLocation:ol.format.GML3.schemaLocation_;this.hasZ=void 0!==a.hasZ?a.hasZ:!1};ol.inherits(ol.format.GML3,ol.format.GMLBase);ol.format.GML3.schemaLocation_=ol.format.GMLBase.GMLNS+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd";
ol.format.GML3.prototype.readMultiCurve_=function(a,b){if(a=ol.xml.pushParseAndPop([],this.MULTICURVE_PARSERS_,a,b,this))return b=new ol.geom.MultiLineString(null),b.setLineStrings(a),b};ol.format.GML3.prototype.readMultiSurface_=function(a,b){if(a=ol.xml.pushParseAndPop([],this.MULTISURFACE_PARSERS_,a,b,this))return b=new ol.geom.MultiPolygon(null),b.setPolygons(a),b};ol.format.GML3.prototype.curveMemberParser_=function(a,b){ol.xml.parseNode(this.CURVEMEMBER_PARSERS_,a,b,this)};
ol.format.GML3.prototype.surfaceMemberParser_=function(a,b){ol.xml.parseNode(this.SURFACEMEMBER_PARSERS_,a,b,this)};ol.format.GML3.prototype.readPatch_=function(a,b){return ol.xml.pushParseAndPop([null],this.PATCHES_PARSERS_,a,b,this)};ol.format.GML3.prototype.readSegment_=function(a,b){return ol.xml.pushParseAndPop([null],this.SEGMENTS_PARSERS_,a,b,this)};ol.format.GML3.prototype.readPolygonPatch_=function(a,b){return ol.xml.pushParseAndPop([null],this.FLAT_LINEAR_RINGS_PARSERS_,a,b,this)};
ol.format.GML3.prototype.readLineStringSegment_=function(a,b){return ol.xml.pushParseAndPop([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS_,a,b,this)};ol.format.GML3.prototype.interiorParser_=function(a,b){(a=ol.xml.pushParseAndPop(void 0,this.RING_PARSERS,a,b,this))&&b[b.length-1].push(a)};ol.format.GML3.prototype.exteriorParser_=function(a,b){(a=ol.xml.pushParseAndPop(void 0,this.RING_PARSERS,a,b,this))&&(b[b.length-1][0]=a)};
ol.format.GML3.prototype.readSurface_=function(a,b){if((a=ol.xml.pushParseAndPop([null],this.SURFACE_PARSERS_,a,b,this))&&a[0]){b=new ol.geom.Polygon(null);var c=a[0],d=[c.length],e;var f=1;for(e=a.length;f<e;++f)ol.array.extend(c,a[f]),d.push(c.length);b.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,c,d);return b}};
ol.format.GML3.prototype.readCurve_=function(a,b){if(a=ol.xml.pushParseAndPop([null],this.CURVE_PARSERS_,a,b,this))return b=new ol.geom.LineString(null),b.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,a),b};ol.format.GML3.prototype.readEnvelope_=function(a,b){a=ol.xml.pushParseAndPop([null],this.ENVELOPE_PARSERS_,a,b,this);return ol.extent.createOrUpdate(a[1][0],a[1][1],a[2][0],a[2][1])};
ol.format.GML3.prototype.readFlatPos_=function(a,b){var c=ol.xml.getAllTextContent(a,!1),d=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/;a=[];for(var e;e=d.exec(c);)a.push(parseFloat(e[1])),c=c.substr(e[0].length);if(""===c){b=b[0].srsName;c="enu";b&&(c=ol.proj.get(b).getAxisOrientation());if("neu"===c)for(b=0,c=a.length;b<c;b+=3)d=a[b],a[b]=a[b+1],a[b+1]=d;b=a.length;2==b&&a.push(0);if(0!==b)return a}};
ol.format.GML3.prototype.readFlatPosList_=function(a,b){var c=ol.xml.getAllTextContent(a,!1).replace(/^\s*|\s*$/g,"");b=b[0];var d=b.srsName,e=b.srsDimension;b="enu";d&&(b=ol.proj.get(d).getAxisOrientation());c=c.split(/\s+/);d=2;a.getAttribute("srsDimension")?d=ol.format.XSD.readNonNegativeIntegerString(a.getAttribute("srsDimension")):a.getAttribute("dimension")?d=ol.format.XSD.readNonNegativeIntegerString(a.getAttribute("dimension")):a.parentNode.getAttribute("srsDimension")?d=ol.format.XSD.readNonNegativeIntegerString(a.parentNode.getAttribute("srsDimension")):
e&&(d=ol.format.XSD.readNonNegativeIntegerString(e));for(var f,g=[],h=0,k=c.length;h<k;h+=d)a=parseFloat(c[h]),e=parseFloat(c[h+1]),f=3===d?parseFloat(c[h+2]):0,"en"===b.substr(0,2)?g.push(a,e,f):g.push(e,a,f);return g};ol.format.GML3.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS_={"http://www.opengis.net/gml":{pos:ol.xml.makeReplacer(ol.format.GML3.prototype.readFlatPos_),posList:ol.xml.makeReplacer(ol.format.GML3.prototype.readFlatPosList_)}};
ol.format.GML3.prototype.FLAT_LINEAR_RINGS_PARSERS_={"http://www.opengis.net/gml":{interior:ol.format.GML3.prototype.interiorParser_,exterior:ol.format.GML3.prototype.exteriorParser_}};
ol.format.GML3.prototype.GEOMETRY_PARSERS_={"http://www.opengis.net/gml":{Point:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readPoint),MultiPoint:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiPoint),LineString:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readLineString),MultiLineString:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiLineString),LinearRing:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readLinearRing),Polygon:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readPolygon),
MultiPolygon:ol.xml.makeReplacer(ol.format.GMLBase.prototype.readMultiPolygon),Surface:ol.xml.makeReplacer(ol.format.GML3.prototype.readSurface_),MultiSurface:ol.xml.makeReplacer(ol.format.GML3.prototype.readMultiSurface_),Curve:ol.xml.makeReplacer(ol.format.GML3.prototype.readCurve_),MultiCurve:ol.xml.makeReplacer(ol.format.GML3.prototype.readMultiCurve_),Envelope:ol.xml.makeReplacer(ol.format.GML3.prototype.readEnvelope_)}};
ol.format.GML3.prototype.MULTICURVE_PARSERS_={"http://www.opengis.net/gml":{curveMember:ol.xml.makeArrayPusher(ol.format.GML3.prototype.curveMemberParser_),curveMembers:ol.xml.makeArrayPusher(ol.format.GML3.prototype.curveMemberParser_)}};ol.format.GML3.prototype.MULTISURFACE_PARSERS_={"http://www.opengis.net/gml":{surfaceMember:ol.xml.makeArrayPusher(ol.format.GML3.prototype.surfaceMemberParser_),surfaceMembers:ol.xml.makeArrayPusher(ol.format.GML3.prototype.surfaceMemberParser_)}};
ol.format.GML3.prototype.CURVEMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readLineString),Curve:ol.xml.makeArrayPusher(ol.format.GML3.prototype.readCurve_)}};ol.format.GML3.prototype.SURFACEMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readPolygon),Surface:ol.xml.makeArrayPusher(ol.format.GML3.prototype.readSurface_)}};ol.format.GML3.prototype.SURFACE_PARSERS_={"http://www.opengis.net/gml":{patches:ol.xml.makeReplacer(ol.format.GML3.prototype.readPatch_)}};
ol.format.GML3.prototype.CURVE_PARSERS_={"http://www.opengis.net/gml":{segments:ol.xml.makeReplacer(ol.format.GML3.prototype.readSegment_)}};ol.format.GML3.prototype.ENVELOPE_PARSERS_={"http://www.opengis.net/gml":{lowerCorner:ol.xml.makeArrayPusher(ol.format.GML3.prototype.readFlatPosList_),upperCorner:ol.xml.makeArrayPusher(ol.format.GML3.prototype.readFlatPosList_)}};ol.format.GML3.prototype.PATCHES_PARSERS_={"http://www.opengis.net/gml":{PolygonPatch:ol.xml.makeReplacer(ol.format.GML3.prototype.readPolygonPatch_)}};
ol.format.GML3.prototype.SEGMENTS_PARSERS_={"http://www.opengis.net/gml":{LineStringSegment:ol.xml.makeReplacer(ol.format.GML3.prototype.readLineStringSegment_)}};ol.format.GML3.prototype.writePos_=function(a,b,c){var d=c[c.length-1];c=d.hasZ;a.setAttribute("srsDimension",c?3:2);var e=d.srsName;d="enu";e&&(d=ol.proj.get(e).getAxisOrientation());b=b.getCoordinates();d="en"===d.substr(0,2)?b[0]+" "+b[1]:b[1]+" "+b[0];c&&(d+=" "+(b[2]||0));ol.format.XSD.writeStringTextNode(a,d)};
ol.format.GML3.prototype.getCoords_=function(a,b,c){var d="enu";b&&(d=ol.proj.get(b).getAxisOrientation());b="en"===d.substr(0,2)?a[0]+" "+a[1]:a[1]+" "+a[0];c&&(b+=" "+(a[2]||0));return b};ol.format.GML3.prototype.writePosList_=function(a,b,c){var d=c[c.length-1];c=d.hasZ;a.setAttribute("srsDimension",c?3:2);d=d.srsName;b=b.getCoordinates();for(var e=b.length,f=Array(e),g,h=0;h<e;++h)g=b[h],f[h]=this.getCoords_(g,d,c);ol.format.XSD.writeStringTextNode(a,f.join(" "))};
ol.format.GML3.prototype.writePoint_=function(a,b,c){var d=c[c.length-1].srsName;d&&a.setAttribute("srsName",d);d=ol.xml.createElementNS(a.namespaceURI,"pos");a.appendChild(d);this.writePos_(d,b,c)};ol.format.GML3.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),upperCorner:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)}};
ol.format.GML3.prototype.writeEnvelope=function(a,b,c){var d=c[c.length-1].srsName;d&&a.setAttribute("srsName",d);ol.xml.pushSerializeAndPop({node:a},ol.format.GML3.ENVELOPE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[b[0]+" "+b[1],b[2]+" "+b[3]],c,["lowerCorner","upperCorner"],this)};ol.format.GML3.prototype.writeLinearRing_=function(a,b,c){var d=c[c.length-1].srsName;d&&a.setAttribute("srsName",d);d=ol.xml.createElementNS(a.namespaceURI,"posList");a.appendChild(d);this.writePosList_(d,b,c)};
ol.format.GML3.prototype.RING_NODE_FACTORY_=function(a,b,c){a=b[b.length-1];b=a.node;c=a.exteriorWritten;void 0===c&&(a.exteriorWritten=!0);return ol.xml.createElementNS(b.namespaceURI,void 0!==c?"interior":"exterior")};
ol.format.GML3.prototype.writeSurfaceOrPolygon_=function(a,b,c){var d=c[c.length-1],e=d.hasZ;d=d.srsName;"PolygonPatch"!==a.nodeName&&d&&a.setAttribute("srsName",d);"Polygon"===a.nodeName||"PolygonPatch"===a.nodeName?(b=b.getLinearRings(),ol.xml.pushSerializeAndPop({node:a,hasZ:e,srsName:d},ol.format.GML3.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,b,c,void 0,this)):"Surface"===a.nodeName&&(e=ol.xml.createElementNS(a.namespaceURI,"patches"),a.appendChild(e),this.writeSurfacePatches_(e,b,c))};
ol.format.GML3.prototype.writeCurveOrLineString_=function(a,b,c){var d=c[c.length-1].srsName;"LineStringSegment"!==a.nodeName&&d&&a.setAttribute("srsName",d);"LineString"===a.nodeName||"LineStringSegment"===a.nodeName?(d=ol.xml.createElementNS(a.namespaceURI,"posList"),a.appendChild(d),this.writePosList_(d,b,c)):"Curve"===a.nodeName&&(d=ol.xml.createElementNS(a.namespaceURI,"segments"),a.appendChild(d),this.writeCurveSegments_(d,b,c))};
ol.format.GML3.prototype.writeMultiSurfaceOrPolygon_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName;d=d.surface;f&&a.setAttribute("srsName",f);b=b.getPolygons();ol.xml.pushSerializeAndPop({node:a,hasZ:e,srsName:f,surface:d},ol.format.GML3.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,b,c,void 0,this)};
ol.format.GML3.prototype.writeMultiPoint_=function(a,b,c){var d=c[c.length-1],e=d.srsName;d=d.hasZ;e&&a.setAttribute("srsName",e);b=b.getPoints();ol.xml.pushSerializeAndPop({node:a,hasZ:d,srsName:e},ol.format.GML3.POINTMEMBER_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("pointMember"),b,c,void 0,this)};
ol.format.GML3.prototype.writeMultiCurveOrLineString_=function(a,b,c){var d=c[c.length-1],e=d.hasZ,f=d.srsName;d=d.curve;f&&a.setAttribute("srsName",f);b=b.getLineStrings();ol.xml.pushSerializeAndPop({node:a,hasZ:e,srsName:f,curve:d},ol.format.GML3.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,b,c,void 0,this)};ol.format.GML3.prototype.writeRing_=function(a,b,c){var d=ol.xml.createElementNS(a.namespaceURI,"LinearRing");a.appendChild(d);this.writeLinearRing_(d,b,c)};
ol.format.GML3.prototype.writeSurfaceOrPolygonMember_=function(a,b,c){var d=this.GEOMETRY_NODE_FACTORY_(b,c);d&&(a.appendChild(d),this.writeSurfaceOrPolygon_(d,b,c))};ol.format.GML3.prototype.writePointMember_=function(a,b,c){var d=ol.xml.createElementNS(a.namespaceURI,"Point");a.appendChild(d);this.writePoint_(d,b,c)};ol.format.GML3.prototype.writeLineStringOrCurveMember_=function(a,b,c){var d=this.GEOMETRY_NODE_FACTORY_(b,c);d&&(a.appendChild(d),this.writeCurveOrLineString_(d,b,c))};
ol.format.GML3.prototype.writeSurfacePatches_=function(a,b,c){var d=ol.xml.createElementNS(a.namespaceURI,"PolygonPatch");a.appendChild(d);this.writeSurfaceOrPolygon_(d,b,c)};ol.format.GML3.prototype.writeCurveSegments_=function(a,b,c){var d=ol.xml.createElementNS(a.namespaceURI,"LineStringSegment");a.appendChild(d);this.writeCurveOrLineString_(d,b,c)};
ol.format.GML3.prototype.writeGeometryElement=function(a,b,c){var d=c[c.length-1],e=ol.obj.assign({},d);e.node=a;a=Array.isArray(b)?d.dataProjection?ol.proj.transformExtent(b,d.featureProjection,d.dataProjection):b:ol.format.Feature.transformWithOptions(b,!0,d);ol.xml.pushSerializeAndPop(e,ol.format.GML3.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[a],c,void 0,this)};
ol.format.GML3.prototype.writeFeatureElement=function(a,b,c){var d=b.getId();d&&a.setAttribute("fid",d);d=c[c.length-1];var e=d.featureNS,f=b.getGeometryName();d.serializers||(d.serializers={},d.serializers[e]={});var g=b.getProperties();b=[];var h=[];for(l in g){var k=g[l];null!==k&&(b.push(l),h.push(k),l==f||k instanceof ol.geom.Geometry?l in d.serializers[e]||(d.serializers[e][l]=ol.xml.makeChildAppender(this.writeGeometryElement,this)):l in d.serializers[e]||(d.serializers[e][l]=ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)))}var l=
ol.obj.assign({},d);l.node=a;ol.xml.pushSerializeAndPop(l,d.serializers,ol.xml.makeSimpleNodeFactory(void 0,e),h,c,b)};ol.format.GML3.prototype.writeFeatureMembers_=function(a,b,c){var d=c[c.length-1],e=d.featureType,f=d.featureNS,g={};g[f]={};g[f][e]=ol.xml.makeChildAppender(this.writeFeatureElement,this);d=ol.obj.assign({},d);d.node=a;ol.xml.pushSerializeAndPop(d,g,ol.xml.makeSimpleNodeFactory(e,f),b,c)};
ol.format.GML3.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeSurfaceOrPolygonMember_),polygonMember:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeSurfaceOrPolygonMember_)}};ol.format.GML3.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:ol.xml.makeChildAppender(ol.format.GML3.prototype.writePointMember_)}};
ol.format.GML3.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeLineStringOrCurveMember_),curveMember:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeLineStringOrCurveMember_)}};ol.format.GML3.RING_SERIALIZERS_={"http://www.opengis.net/gml":{exterior:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeRing_),interior:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeRing_)}};
ol.format.GML3.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeCurveOrLineString_),MultiCurve:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeMultiCurveOrLineString_),Point:ol.xml.makeChildAppender(ol.format.GML3.prototype.writePoint_),MultiPoint:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeMultiPoint_),LineString:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeCurveOrLineString_),MultiLineString:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeMultiCurveOrLineString_),
LinearRing:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeLinearRing_),Polygon:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeSurfaceOrPolygon_),MultiPolygon:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeMultiSurfaceOrPolygon_),Surface:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeSurfaceOrPolygon_),MultiSurface:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeMultiSurfaceOrPolygon_),Envelope:ol.xml.makeChildAppender(ol.format.GML3.prototype.writeEnvelope)}};
ol.format.GML3.MULTIGEOMETRY_TO_MEMBER_NODENAME_={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};ol.format.GML3.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(a,b,c){return ol.xml.createElementNS("http://www.opengis.net/gml",ol.format.GML3.MULTIGEOMETRY_TO_MEMBER_NODENAME_[b[b.length-1].node.nodeName])};
ol.format.GML3.prototype.GEOMETRY_NODE_FACTORY_=function(a,b,c){var d=b[b.length-1];b=d.multiSurface;c=d.surface;var e=d.curve;d=d.multiCurve;Array.isArray(a)?a="Envelope":(a=a.getType(),"MultiPolygon"===a&&!0===b?a="MultiSurface":"Polygon"===a&&!0===c?a="Surface":"LineString"===a&&!0===e?a="Curve":"MultiLineString"===a&&!0===d&&(a="MultiCurve"));return ol.xml.createElementNS("http://www.opengis.net/gml",a)};
ol.format.GML3.prototype.writeGeometryNode=function(a,b){b=this.adaptOptions(b);var c=ol.xml.createElementNS("http://www.opengis.net/gml","geom"),d={node:c,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};b&&ol.obj.assign(d,b);this.writeGeometryElement(c,a,[d]);return c};
ol.format.GML3.prototype.writeFeaturesNode=function(a,b){b=this.adaptOptions(b);var c=ol.xml.createElementNS("http://www.opengis.net/gml","featureMembers");ol.xml.setAttributeNS(c,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",this.schemaLocation);var d={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};b&&ol.obj.assign(d,b);this.writeFeatureMembers_(c,
a,[d]);return c};ol.format.filter={};ol.format.filter.Filter=function(a){this.tagName_=a};ol.format.filter.Filter.prototype.getTagName=function(){return this.tagName_};ol.format.filter.LogicalNary=function(a,b){ol.format.filter.Filter.call(this,a);this.conditions=Array.prototype.slice.call(arguments,1);ol.asserts.assert(2<=this.conditions.length,57)};ol.inherits(ol.format.filter.LogicalNary,ol.format.filter.Filter);ol.format.filter.And=function(a){var b=["And"].concat(Array.prototype.slice.call(arguments));ol.format.filter.LogicalNary.apply(this,b)};ol.inherits(ol.format.filter.And,ol.format.filter.LogicalNary);ol.format.filter.Bbox=function(a,b,c){ol.format.filter.Filter.call(this,"BBOX");this.geometryName=a;this.extent=b;this.srsName=c};ol.inherits(ol.format.filter.Bbox,ol.format.filter.Filter);ol.format.filter.Spatial=function(a,b,c,d){ol.format.filter.Filter.call(this,a);this.geometryName=b||"the_geom";this.geometry=c;this.srsName=d};ol.inherits(ol.format.filter.Spatial,ol.format.filter.Filter);ol.format.filter.Contains=function(a,b,c){ol.format.filter.Spatial.call(this,"Contains",a,b,c)};ol.inherits(ol.format.filter.Contains,ol.format.filter.Spatial);ol.format.filter.Comparison=function(a,b){ol.format.filter.Filter.call(this,a);this.propertyName=b};ol.inherits(ol.format.filter.Comparison,ol.format.filter.Filter);ol.format.filter.During=function(a,b,c){ol.format.filter.Comparison.call(this,"During",a);this.begin=b;this.end=c};ol.inherits(ol.format.filter.During,ol.format.filter.Comparison);ol.format.filter.ComparisonBinary=function(a,b,c,d){ol.format.filter.Comparison.call(this,a,b);this.expression=c;this.matchCase=d};ol.inherits(ol.format.filter.ComparisonBinary,ol.format.filter.Comparison);ol.format.filter.EqualTo=function(a,b,c){ol.format.filter.ComparisonBinary.call(this,"PropertyIsEqualTo",a,b,c)};ol.inherits(ol.format.filter.EqualTo,ol.format.filter.ComparisonBinary);ol.format.filter.GreaterThan=function(a,b){ol.format.filter.ComparisonBinary.call(this,"PropertyIsGreaterThan",a,b)};ol.inherits(ol.format.filter.GreaterThan,ol.format.filter.ComparisonBinary);ol.format.filter.GreaterThanOrEqualTo=function(a,b){ol.format.filter.ComparisonBinary.call(this,"PropertyIsGreaterThanOrEqualTo",a,b)};ol.inherits(ol.format.filter.GreaterThanOrEqualTo,ol.format.filter.ComparisonBinary);ol.format.filter.Intersects=function(a,b,c){ol.format.filter.Spatial.call(this,"Intersects",a,b,c)};ol.inherits(ol.format.filter.Intersects,ol.format.filter.Spatial);ol.format.filter.IsBetween=function(a,b,c){ol.format.filter.Comparison.call(this,"PropertyIsBetween",a);this.lowerBoundary=b;this.upperBoundary=c};ol.inherits(ol.format.filter.IsBetween,ol.format.filter.Comparison);ol.format.filter.IsLike=function(a,b,c,d,e,f){ol.format.filter.Comparison.call(this,"PropertyIsLike",a);this.pattern=b;this.wildCard=void 0!==c?c:"*";this.singleChar=void 0!==d?d:".";this.escapeChar=void 0!==e?e:"!";this.matchCase=f};ol.inherits(ol.format.filter.IsLike,ol.format.filter.Comparison);ol.format.filter.IsNull=function(a){ol.format.filter.Comparison.call(this,"PropertyIsNull",a)};ol.inherits(ol.format.filter.IsNull,ol.format.filter.Comparison);ol.format.filter.LessThan=function(a,b){ol.format.filter.ComparisonBinary.call(this,"PropertyIsLessThan",a,b)};ol.inherits(ol.format.filter.LessThan,ol.format.filter.ComparisonBinary);ol.format.filter.LessThanOrEqualTo=function(a,b){ol.format.filter.ComparisonBinary.call(this,"PropertyIsLessThanOrEqualTo",a,b)};ol.inherits(ol.format.filter.LessThanOrEqualTo,ol.format.filter.ComparisonBinary);ol.format.filter.Not=function(a){ol.format.filter.Filter.call(this,"Not");this.condition=a};ol.inherits(ol.format.filter.Not,ol.format.filter.Filter);ol.format.filter.NotEqualTo=function(a,b,c){ol.format.filter.ComparisonBinary.call(this,"PropertyIsNotEqualTo",a,b,c)};ol.inherits(ol.format.filter.NotEqualTo,ol.format.filter.ComparisonBinary);ol.format.filter.Or=function(a){var b=["Or"].concat(Array.prototype.slice.call(arguments));ol.format.filter.LogicalNary.apply(this,b)};ol.inherits(ol.format.filter.Or,ol.format.filter.LogicalNary);ol.format.filter.Within=function(a,b,c){ol.format.filter.Spatial.call(this,"Within",a,b,c)};ol.inherits(ol.format.filter.Within,ol.format.filter.Spatial);ol.format.filter.and=function(a){var b=[null].concat(Array.prototype.slice.call(arguments));return new (Function.prototype.bind.apply(ol.format.filter.And,b))};ol.format.filter.or=function(a){var b=[null].concat(Array.prototype.slice.call(arguments));return new (Function.prototype.bind.apply(ol.format.filter.Or,b))};ol.format.filter.not=function(a){return new ol.format.filter.Not(a)};ol.format.filter.bbox=function(a,b,c){return new ol.format.filter.Bbox(a,b,c)};
ol.format.filter.contains=function(a,b,c){return new ol.format.filter.Contains(a,b,c)};ol.format.filter.intersects=function(a,b,c){return new ol.format.filter.Intersects(a,b,c)};ol.format.filter.within=function(a,b,c){return new ol.format.filter.Within(a,b,c)};ol.format.filter.equalTo=function(a,b,c){return new ol.format.filter.EqualTo(a,b,c)};ol.format.filter.notEqualTo=function(a,b,c){return new ol.format.filter.NotEqualTo(a,b,c)};
ol.format.filter.lessThan=function(a,b){return new ol.format.filter.LessThan(a,b)};ol.format.filter.lessThanOrEqualTo=function(a,b){return new ol.format.filter.LessThanOrEqualTo(a,b)};ol.format.filter.greaterThan=function(a,b){return new ol.format.filter.GreaterThan(a,b)};ol.format.filter.greaterThanOrEqualTo=function(a,b){return new ol.format.filter.GreaterThanOrEqualTo(a,b)};ol.format.filter.isNull=function(a){return new ol.format.filter.IsNull(a)};
ol.format.filter.between=function(a,b,c){return new ol.format.filter.IsBetween(a,b,c)};ol.format.filter.like=function(a,b,c,d,e,f){return new ol.format.filter.IsLike(a,b,c,d,e,f)};ol.format.filter.during=function(a,b,c){return new ol.format.filter.During(a,b,c)};ol.format.WFS=function(a){a=a?a:{};this.featureType_=a.featureType;this.featureNS_=a.featureNS;this.gmlFormat_=a.gmlFormat?a.gmlFormat:new ol.format.GML3;this.schemaLocation_=a.schemaLocation?a.schemaLocation:ol.format.WFS.SCHEMA_LOCATIONS[ol.format.WFS.DEFAULT_VERSION];ol.format.XMLFeature.call(this)};ol.inherits(ol.format.WFS,ol.format.XMLFeature);ol.format.WFS.FEATURE_PREFIX="feature";ol.format.WFS.XMLNS="http://www.w3.org/2000/xmlns/";ol.format.WFS.OGCNS="http://www.opengis.net/ogc";
ol.format.WFS.WFSNS="http://www.opengis.net/wfs";ol.format.WFS.FESNS="http://www.opengis.net/fes";ol.format.WFS.SCHEMA_LOCATIONS={"1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"};ol.format.WFS.DEFAULT_VERSION="1.1.0";ol.format.WFS.prototype.getFeatureType=function(){return this.featureType_};ol.format.WFS.prototype.setFeatureType=function(a){this.featureType_=a};
ol.format.WFS.prototype.readFeaturesFromNode=function(a,b){var c={featureType:this.featureType_,featureNS:this.featureNS_};ol.obj.assign(c,this.getReadOptions(a,b?b:{}));b=[c];this.gmlFormat_.FEATURE_COLLECTION_PARSERS[ol.format.GMLBase.GMLNS].featureMember=ol.xml.makeArrayPusher(ol.format.GMLBase.prototype.readFeaturesInternal);(a=ol.xml.pushParseAndPop([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,a,b,this.gmlFormat_))||(a=[]);return a};
ol.format.WFS.prototype.readTransactionResponse=function(a){if(ol.xml.isDocument(a))return this.readTransactionResponseFromDocument(a);if(ol.xml.isNode(a))return this.readTransactionResponseFromNode(a);if("string"===typeof a)return a=ol.xml.parse(a),this.readTransactionResponseFromDocument(a)};
ol.format.WFS.prototype.readFeatureCollectionMetadata=function(a){if(ol.xml.isDocument(a))return this.readFeatureCollectionMetadataFromDocument(a);if(ol.xml.isNode(a))return this.readFeatureCollectionMetadataFromNode(a);if("string"===typeof a)return a=ol.xml.parse(a),this.readFeatureCollectionMetadataFromDocument(a)};ol.format.WFS.prototype.readFeatureCollectionMetadataFromDocument=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(a)};
ol.format.WFS.FEATURE_COLLECTION_PARSERS_={"http://www.opengis.net/gml":{boundedBy:ol.xml.makeObjectPropertySetter(ol.format.GMLBase.prototype.readGeometryElement,"bounds")}};ol.format.WFS.prototype.readFeatureCollectionMetadataFromNode=function(a){var b={},c=ol.format.XSD.readNonNegativeIntegerString(a.getAttribute("numberOfFeatures"));b.numberOfFeatures=c;return ol.xml.pushParseAndPop(b,ol.format.WFS.FEATURE_COLLECTION_PARSERS_,a,[],this.gmlFormat_)};
ol.format.WFS.TRANSACTION_SUMMARY_PARSERS_={"http://www.opengis.net/wfs":{totalInserted:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),totalUpdated:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),totalDeleted:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger)}};ol.format.WFS.readTransactionSummary_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WFS.TRANSACTION_SUMMARY_PARSERS_,a,b)};
ol.format.WFS.OGC_FID_PARSERS_={"http://www.opengis.net/ogc":{FeatureId:ol.xml.makeArrayPusher(function(a,b){return a.getAttribute("fid")})}};ol.format.WFS.fidParser_=function(a,b){ol.xml.parseNode(ol.format.WFS.OGC_FID_PARSERS_,a,b)};ol.format.WFS.INSERT_RESULTS_PARSERS_={"http://www.opengis.net/wfs":{Feature:ol.format.WFS.fidParser_}};ol.format.WFS.readInsertResults_=function(a,b){return ol.xml.pushParseAndPop([],ol.format.WFS.INSERT_RESULTS_PARSERS_,a,b)};
ol.format.WFS.TRANSACTION_RESPONSE_PARSERS_={"http://www.opengis.net/wfs":{TransactionSummary:ol.xml.makeObjectPropertySetter(ol.format.WFS.readTransactionSummary_,"transactionSummary"),InsertResults:ol.xml.makeObjectPropertySetter(ol.format.WFS.readInsertResults_,"insertIds")}};ol.format.WFS.prototype.readTransactionResponseFromDocument=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(a)};
ol.format.WFS.prototype.readTransactionResponseFromNode=function(a){return ol.xml.pushParseAndPop({},ol.format.WFS.TRANSACTION_RESPONSE_PARSERS_,a,[])};ol.format.WFS.QUERY_SERIALIZERS_={"http://www.opengis.net/wfs":{PropertyName:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)}};
ol.format.WFS.writeFeature_=function(a,b,c){var d=c[c.length-1],e=d.gmlVersion;d=ol.xml.createElementNS(d.featureNS,d.featureType);a.appendChild(d);2===e?ol.format.GML2.prototype.writeFeatureElement(d,b,c):ol.format.GML3.prototype.writeFeatureElement(d,b,c)};ol.format.WFS.writeOgcFidFilter_=function(a,b,c){c=ol.xml.createElementNS(ol.format.WFS.OGCNS,"Filter");var d=ol.xml.createElementNS(ol.format.WFS.OGCNS,"FeatureId");c.appendChild(d);d.setAttribute("fid",b);a.appendChild(c)};
ol.format.WFS.getTypeName_=function(a,b){a=a?a:ol.format.WFS.FEATURE_PREFIX;a+=":";return 0===b.indexOf(a)?b:a+b};ol.format.WFS.writeDelete_=function(a,b,c){var d=c[c.length-1];ol.asserts.assert(void 0!==b.getId(),26);var e=d.featurePrefix,f=d.featureNS;d=ol.format.WFS.getTypeName_(e,d.featureType);a.setAttribute("typeName",d);ol.xml.setAttributeNS(a,ol.format.WFS.XMLNS,"xmlns:"+e,f);b=b.getId();void 0!==b&&ol.format.WFS.writeOgcFidFilter_(a,b,c)};
ol.format.WFS.writeUpdate_=function(a,b,c){var d=c[c.length-1];ol.asserts.assert(void 0!==b.getId(),27);var e=d.featurePrefix,f=d.featureNS,g=ol.format.WFS.getTypeName_(e,d.featureType),h=b.getGeometryName();a.setAttribute("typeName",g);ol.xml.setAttributeNS(a,ol.format.WFS.XMLNS,"xmlns:"+e,f);e=b.getId();if(void 0!==e){f=b.getKeys();g=[];for(var k=0,l=f.length;k<l;k++){var m=b.get(f[k]);if(void 0!==m){var n=f[k];m instanceof ol.geom.Geometry&&(n=h);g.push({name:n,value:m})}}ol.xml.pushSerializeAndPop({gmlVersion:d.gmlVersion,
node:a,hasZ:d.hasZ,srsName:d.srsName},ol.format.WFS.TRANSACTION_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Property"),g,c);ol.format.WFS.writeOgcFidFilter_(a,e,c)}};
ol.format.WFS.writeProperty_=function(a,b,c){var d=ol.xml.createElementNS(ol.format.WFS.WFSNS,"Name"),e=c[c.length-1].gmlVersion;a.appendChild(d);ol.format.XSD.writeStringTextNode(d,b.name);void 0!==b.value&&null!==b.value&&(d=ol.xml.createElementNS(ol.format.WFS.WFSNS,"Value"),a.appendChild(d),b.value instanceof ol.geom.Geometry?2===e?ol.format.GML2.prototype.writeGeometryElement(d,b.value,c):ol.format.GML3.prototype.writeGeometryElement(d,b.value,c):ol.format.XSD.writeStringTextNode(d,b.value))};
ol.format.WFS.writeNative_=function(a,b,c){b.vendorId&&a.setAttribute("vendorId",b.vendorId);void 0!==b.safeToIgnore&&a.setAttribute("safeToIgnore",b.safeToIgnore);void 0!==b.value&&ol.format.XSD.writeStringTextNode(a,b.value)};
ol.format.WFS.TRANSACTION_SERIALIZERS_={"http://www.opengis.net/wfs":{Insert:ol.xml.makeChildAppender(ol.format.WFS.writeFeature_),Update:ol.xml.makeChildAppender(ol.format.WFS.writeUpdate_),Delete:ol.xml.makeChildAppender(ol.format.WFS.writeDelete_),Property:ol.xml.makeChildAppender(ol.format.WFS.writeProperty_),Native:ol.xml.makeChildAppender(ol.format.WFS.writeNative_)}};
ol.format.WFS.writeQuery_=function(a,b,c){var d=c[c.length-1],e=d.featurePrefix,f=d.featureNS,g=d.propertyNames,h=d.srsName;b=e?ol.format.WFS.getTypeName_(e,b):b;a.setAttribute("typeName",b);h&&a.setAttribute("srsName",h);f&&ol.xml.setAttributeNS(a,ol.format.WFS.XMLNS,"xmlns:"+e,f);e=ol.obj.assign({},d);e.node=a;ol.xml.pushSerializeAndPop(e,ol.format.WFS.QUERY_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("PropertyName"),g,c);if(d=d.filter)g=ol.xml.createElementNS(ol.format.WFS.OGCNS,"Filter"),a.appendChild(g),
ol.format.WFS.writeFilterCondition_(g,d,c)};ol.format.WFS.writeFilterCondition_=function(a,b,c){ol.xml.pushSerializeAndPop({node:a},ol.format.WFS.GETFEATURE_SERIALIZERS_,ol.xml.makeSimpleNodeFactory(b.getTagName()),[b],c)};ol.format.WFS.writeBboxFilter_=function(a,b,c){c[c.length-1].srsName=b.srsName;ol.format.WFS.writeOgcPropertyName_(a,b.geometryName);ol.format.GML3.prototype.writeGeometryElement(a,b.extent,c)};
ol.format.WFS.writeContainsFilter_=function(a,b,c){c[c.length-1].srsName=b.srsName;ol.format.WFS.writeOgcPropertyName_(a,b.geometryName);ol.format.GML3.prototype.writeGeometryElement(a,b.geometry,c)};ol.format.WFS.writeIntersectsFilter_=function(a,b,c){c[c.length-1].srsName=b.srsName;ol.format.WFS.writeOgcPropertyName_(a,b.geometryName);ol.format.GML3.prototype.writeGeometryElement(a,b.geometry,c)};
ol.format.WFS.writeWithinFilter_=function(a,b,c){c[c.length-1].srsName=b.srsName;ol.format.WFS.writeOgcPropertyName_(a,b.geometryName);ol.format.GML3.prototype.writeGeometryElement(a,b.geometry,c)};
ol.format.WFS.writeDuringFilter_=function(a,b,c){c=ol.xml.createElementNS(ol.format.WFS.FESNS,"ValueReference");ol.format.XSD.writeStringTextNode(c,b.propertyName);a.appendChild(c);c=ol.xml.createElementNS(ol.format.GMLBase.GMLNS,"TimePeriod");a.appendChild(c);a=ol.xml.createElementNS(ol.format.GMLBase.GMLNS,"begin");c.appendChild(a);ol.format.WFS.writeTimeInstant_(a,b.begin);a=ol.xml.createElementNS(ol.format.GMLBase.GMLNS,"end");c.appendChild(a);ol.format.WFS.writeTimeInstant_(a,b.end)};
ol.format.WFS.writeLogicalFilter_=function(a,b,c){a={node:a};b=b.conditions;for(var d=0,e=b.length;d<e;++d){var f=b[d];ol.xml.pushSerializeAndPop(a,ol.format.WFS.GETFEATURE_SERIALIZERS_,ol.xml.makeSimpleNodeFactory(f.getTagName()),[f],c)}};ol.format.WFS.writeNotFilter_=function(a,b,c){b=b.condition;ol.xml.pushSerializeAndPop({node:a},ol.format.WFS.GETFEATURE_SERIALIZERS_,ol.xml.makeSimpleNodeFactory(b.getTagName()),[b],c)};
ol.format.WFS.writeComparisonFilter_=function(a,b,c){void 0!==b.matchCase&&a.setAttribute("matchCase",b.matchCase.toString());ol.format.WFS.writeOgcPropertyName_(a,b.propertyName);ol.format.WFS.writeOgcLiteral_(a,""+b.expression)};ol.format.WFS.writeIsNullFilter_=function(a,b,c){ol.format.WFS.writeOgcPropertyName_(a,b.propertyName)};
ol.format.WFS.writeIsBetweenFilter_=function(a,b,c){ol.format.WFS.writeOgcPropertyName_(a,b.propertyName);c=ol.xml.createElementNS(ol.format.WFS.OGCNS,"LowerBoundary");a.appendChild(c);ol.format.WFS.writeOgcLiteral_(c,""+b.lowerBoundary);c=ol.xml.createElementNS(ol.format.WFS.OGCNS,"UpperBoundary");a.appendChild(c);ol.format.WFS.writeOgcLiteral_(c,""+b.upperBoundary)};
ol.format.WFS.writeIsLikeFilter_=function(a,b,c){a.setAttribute("wildCard",b.wildCard);a.setAttribute("singleChar",b.singleChar);a.setAttribute("escapeChar",b.escapeChar);void 0!==b.matchCase&&a.setAttribute("matchCase",b.matchCase.toString());ol.format.WFS.writeOgcPropertyName_(a,b.propertyName);ol.format.WFS.writeOgcLiteral_(a,""+b.pattern)};ol.format.WFS.writeOgcExpression_=function(a,b,c){a=ol.xml.createElementNS(ol.format.WFS.OGCNS,a);ol.format.XSD.writeStringTextNode(a,c);b.appendChild(a)};
ol.format.WFS.writeOgcPropertyName_=function(a,b){ol.format.WFS.writeOgcExpression_("PropertyName",a,b)};ol.format.WFS.writeOgcLiteral_=function(a,b){ol.format.WFS.writeOgcExpression_("Literal",a,b)};ol.format.WFS.writeTimeInstant_=function(a,b){var c=ol.xml.createElementNS(ol.format.GMLBase.GMLNS,"TimeInstant");a.appendChild(c);a=ol.xml.createElementNS(ol.format.GMLBase.GMLNS,"timePosition");c.appendChild(a);ol.format.XSD.writeStringTextNode(a,b)};
ol.format.WFS.GETFEATURE_SERIALIZERS_={"http://www.opengis.net/wfs":{Query:ol.xml.makeChildAppender(ol.format.WFS.writeQuery_)},"http://www.opengis.net/ogc":{During:ol.xml.makeChildAppender(ol.format.WFS.writeDuringFilter_),And:ol.xml.makeChildAppender(ol.format.WFS.writeLogicalFilter_),Or:ol.xml.makeChildAppender(ol.format.WFS.writeLogicalFilter_),Not:ol.xml.makeChildAppender(ol.format.WFS.writeNotFilter_),BBOX:ol.xml.makeChildAppender(ol.format.WFS.writeBboxFilter_),Contains:ol.xml.makeChildAppender(ol.format.WFS.writeContainsFilter_),
Intersects:ol.xml.makeChildAppender(ol.format.WFS.writeIntersectsFilter_),Within:ol.xml.makeChildAppender(ol.format.WFS.writeWithinFilter_),PropertyIsEqualTo:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),PropertyIsNotEqualTo:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),PropertyIsLessThan:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),PropertyIsLessThanOrEqualTo:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),PropertyIsGreaterThan:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),
PropertyIsGreaterThanOrEqualTo:ol.xml.makeChildAppender(ol.format.WFS.writeComparisonFilter_),PropertyIsNull:ol.xml.makeChildAppender(ol.format.WFS.writeIsNullFilter_),PropertyIsBetween:ol.xml.makeChildAppender(ol.format.WFS.writeIsBetweenFilter_),PropertyIsLike:ol.xml.makeChildAppender(ol.format.WFS.writeIsLikeFilter_)}};ol.format.WFS.writeFilter=function(a){var b=ol.xml.createElementNS(ol.format.WFS.OGCNS,"Filter");ol.format.WFS.writeFilterCondition_(b,a,[]);return b};
ol.format.WFS.writeGetFeature_=function(a,b,c){var d=ol.obj.assign({},c[c.length-1]);d.node=a;ol.xml.pushSerializeAndPop(d,ol.format.WFS.GETFEATURE_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Query"),b,c)};
ol.format.WFS.prototype.writeGetFeature=function(a){var b=ol.xml.createElementNS(ol.format.WFS.WFSNS,"GetFeature");b.setAttribute("service","WFS");b.setAttribute("version","1.1.0");if(a){a.handle&&b.setAttribute("handle",a.handle);a.outputFormat&&b.setAttribute("outputFormat",a.outputFormat);void 0!==a.maxFeatures&&b.setAttribute("maxFeatures",a.maxFeatures);a.resultType&&b.setAttribute("resultType",a.resultType);void 0!==a.startIndex&&b.setAttribute("startIndex",a.startIndex);void 0!==a.count&&b.setAttribute("count",
a.count);var c=a.filter;if(a.bbox){ol.asserts.assert(a.geometryName,12);var d=ol.format.filter.bbox(a.geometryName,a.bbox,a.srsName);c=c?ol.format.filter.and(c,d):d}}ol.xml.setAttributeNS(b,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",this.schemaLocation_);c={node:b,srsName:a.srsName,featureNS:a.featureNS?a.featureNS:this.featureNS_,featurePrefix:a.featurePrefix,geometryName:a.geometryName,filter:c,propertyNames:a.propertyNames?a.propertyNames:[]};ol.asserts.assert(Array.isArray(a.featureTypes),
11);ol.format.WFS.writeGetFeature_(b,a.featureTypes,[c]);return b};
ol.format.WFS.prototype.writeTransaction=function(a,b,c,d){var e=[],f=ol.xml.createElementNS(ol.format.WFS.WFSNS,"Transaction"),g=d.version?d.version:ol.format.WFS.DEFAULT_VERSION,h="1.0.0"===g?2:3;f.setAttribute("service","WFS");f.setAttribute("version",g);if(d){var k=d.gmlOptions?d.gmlOptions:{};d.handle&&f.setAttribute("handle",d.handle)}ol.xml.setAttributeNS(f,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",ol.format.WFS.SCHEMA_LOCATIONS[g]);var l=d.featurePrefix?d.featurePrefix:
ol.format.WFS.FEATURE_PREFIX;a&&(g={node:f,featureNS:d.featureNS,featureType:d.featureType,featurePrefix:l,gmlVersion:h,hasZ:d.hasZ,srsName:d.srsName},ol.obj.assign(g,k),ol.xml.pushSerializeAndPop(g,ol.format.WFS.TRANSACTION_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Insert"),a,e));b&&(g={node:f,featureNS:d.featureNS,featureType:d.featureType,featurePrefix:l,gmlVersion:h,hasZ:d.hasZ,srsName:d.srsName},ol.obj.assign(g,k),ol.xml.pushSerializeAndPop(g,ol.format.WFS.TRANSACTION_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Update"),
b,e));c&&ol.xml.pushSerializeAndPop({node:f,featureNS:d.featureNS,featureType:d.featureType,featurePrefix:l,gmlVersion:h,srsName:d.srsName},ol.format.WFS.TRANSACTION_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Delete"),c,e);d.nativeElements&&ol.xml.pushSerializeAndPop({node:f,featureNS:d.featureNS,featureType:d.featureType,featurePrefix:l,gmlVersion:h,srsName:d.srsName},ol.format.WFS.TRANSACTION_SERIALIZERS_,ol.xml.makeSimpleNodeFactory("Native"),d.nativeElements,e);return f};
ol.format.WFS.prototype.readProjectionFromDocument=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(a);return null};
ol.format.WFS.prototype.readProjectionFromNode=function(a){if(a.firstElementChild&&a.firstElementChild.firstElementChild)for(a=a.firstElementChild.firstElementChild,a=a.firstElementChild;a;a=a.nextElementSibling)if(0!==a.childNodes.length&&(1!==a.childNodes.length||3!==a.firstChild.nodeType)){var b=[{}];this.gmlFormat_.readGeometryElement(a,b);return ol.proj.get(b.pop().srsName)}return null};ol.format.WMSGetFeatureInfo=function(a){a=a?a:{};this.featureNS_="http://mapserver.gis.umn.edu/mapserver";this.gmlFormat_=new ol.format.GML2;this.layers_=a.layers?a.layers:null;ol.format.XMLFeature.call(this)};ol.inherits(ol.format.WMSGetFeatureInfo,ol.format.XMLFeature);ol.format.WMSGetFeatureInfo.featureIdentifier_="_feature";ol.format.WMSGetFeatureInfo.layerIdentifier_="_layer";ol.format.WMSGetFeatureInfo.prototype.getLayers=function(){return this.layers_};
ol.format.WMSGetFeatureInfo.prototype.setLayers=function(a){this.layers_=a};
ol.format.WMSGetFeatureInfo.prototype.readFeatures_=function(a,b){a.setAttribute("namespaceURI",this.featureNS_);var c=a.localName,d=[];if(0===a.childNodes.length)return d;if("msGMLOutput"==c)for(var e=0,f=a.childNodes.length;e<f;e++){var g=a.childNodes[e];if(g.nodeType===Node.ELEMENT_NODE){var h=b[0],k=g.localName.replace(ol.format.WMSGetFeatureInfo.layerIdentifier_,"");if(!this.layers_||ol.array.includes(this.layers_,k)){k+=ol.format.WMSGetFeatureInfo.featureIdentifier_;h.featureType=k;h.featureNS=
this.featureNS_;var l={};l[k]=ol.xml.makeArrayPusher(this.gmlFormat_.readFeatureElement,this.gmlFormat_);h=ol.xml.makeStructureNS([h.featureNS,null],l);g.setAttribute("namespaceURI",this.featureNS_);(g=ol.xml.pushParseAndPop([],h,g,b,this.gmlFormat_))&&ol.array.extend(d,g)}}}"FeatureCollection"==c&&(a=ol.xml.pushParseAndPop([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,a,[{}],this.gmlFormat_))&&(d=a);return d};
ol.format.WMSGetFeatureInfo.prototype.readFeaturesFromNode=function(a,b){var c={};b&&ol.obj.assign(c,this.getReadOptions(a,b));return this.readFeatures_(a,[c])};ol.format.WMSGetFeatureInfo.prototype.writeFeatureNode=function(a,b){};ol.format.WMSGetFeatureInfo.prototype.writeFeaturesNode=function(a,b){};ol.format.WMSGetFeatureInfo.prototype.writeGeometryNode=function(a,b){};ngeo.DataSource=function(a){this.dimensionsConfig_=a.dimensionsConfig||null;this.filterCondition_=a.filterCondition||ngeo.FilterCondition.AND;this.filterRules_=a.filterRules||null;this.filtrable_=a.filtrable||null;this.inRange_=!1!==a.inRange;this.visible_=!0===a.visible;this.attributes_=a.attributes||null;this.copyable_=!0===a.copyable;this.dimensions_=a.dimensions||null;this.geometryName_=a.geometryName||ngeo.DataSource.DEFAULT_GEOMETRY_NAME_;this.id_=a.id;this.identifierAttribute_=a.identifierAttribute;
this.maxResolution_=a.maxResolution;this.minResolution_=a.minResolution;this.name_=a.name;this.ogcImageType_=a.ogcImageType||"image/png";this.ogcLayers_=a.ogcLayers||null;this.ogcServerType_=a.ogcServerType||ngeo.DataSource.OGCServerType.MAPSERVER;this.ogcType_=a.ogcType||ngeo.DataSource.OGCType.WMS;this.snappable_=!0===a.snappable;this.snappingToEdges_=!1!==a.snappingToEdges;this.snappingToVertice_=!1!==a.snappingToVertice;this.snappingTolerance_=void 0!==a.snappingTolerance?a.snappingTolerance:
10;this.timeAttributeName_=a.timeAttributeName;this.timeLowerValue_=a.timeLowerValue;this.timeProperty_=void 0!==a.timeProperty?a.timeProperty:null;this.timeUpperValue_=a.timeUpperValue;this.wfsFeatureNS_=a.wfsFeatureNS||ngeo.DataSource.WFSFeatureNS[this.ogcServerType_];this.wfsFeaturePrefix_=a.wfsFeaturePrefix||ngeo.DataSource.WFSFeaturePrefix.FEATURE;this.wfsOutputFormat_=a.wfsOutputFormat||ngeo.DataSource.WFSOutputFormat.GML3;this.wfsUrl_=a.wfsUrl;this.wmsInfoFormat_=a.wmsInfoFormat||ngeo.DataSource.WMSInfoFormat.GML;
this.wmsIsSingleTile_=!0===a.wmsIsSingleTile;this.wmsUrl_=a.wmsUrl;this.wmtsLayer_=a.wmtsLayer;this.wmtsUrl_=a.wmtsUrl;a=[];if(this.queryable&&this.ogcLayers)for(var b=$jscomp.makeIterator(this.ogcLayers),c=b.next();!c.done;c=b.next())c=c.value,c.queryable&&a.push(c.name);b=null;this.supportsWFS&&a.length&&(b=void 0,this.wfsOutputFormat_===ngeo.DataSource.WFSOutputFormat.GML3?b=new ol.format.GML3:this.wfsOutputFormat_===ngeo.DataSource.WFSOutputFormat.GML2&&(b=new ol.format.GML2),goog.asserts.assert(b),
b=new ol.format.WFS({featureNS:this.wfsFeatureNS,featureType:a,gmlFormat:b}));this.wfsFormat_=b;b=null;this.supportsWMS&&a.length&&this.wmsInfoFormat===ngeo.DataSource.WMSInfoFormat.GML&&(b=new ol.format.WMSGetFeatureInfo({layers:a}));this.wmsFormat_=b};ngeo.DataSource.prototype.combinableWithDataSourceForWFS=function(a){return this.combinableForWFS&&a.combinableForWFS&&this.supportsWFS&&a.supportsWFS&&this.queryable&&a.queryable&&this.wfsUrl===a.wfsUrl&&this.haveTheSameActiveDimensions(a)};
goog.exportProperty(ngeo.DataSource.prototype,"combinableWithDataSourceForWFS",ngeo.DataSource.prototype.combinableWithDataSourceForWFS);ngeo.DataSource.prototype.combinableWithDataSourceForWMS=function(a){return this.combinableForWMS&&a.combinableForWMS&&this.supportsWMS&&a.supportsWMS&&this.queryable&&a.queryable&&this.wmsUrl===a.wmsUrl&&this.haveTheSameActiveDimensions(a)};goog.exportProperty(ngeo.DataSource.prototype,"combinableWithDataSourceForWMS",ngeo.DataSource.prototype.combinableWithDataSourceForWMS);
ngeo.DataSource.prototype.isAnyOGCLayerInRange=function(a,b){return!!this.getInRangeOGCLayerNames(a,void 0===b?!1:b).length};goog.exportProperty(ngeo.DataSource.prototype,"isAnyOGCLayerInRange",ngeo.DataSource.prototype.isAnyOGCLayerInRange);
ngeo.DataSource.prototype.getInRangeOGCLayerNames=function(a,b){b=void 0===b?!1:b;var c=[];if(this.ogcLayers)for(var d=$jscomp.makeIterator(this.ogcLayers),e=d.next();!e.done;e=d.next()){e=e.value;var f=e.maxResolution,g=e.minResolution;f=void 0===f||a<=f;(void 0===g||a>=g)&&f&&(!b||e.queryable)&&c.push(e.name)}return c};goog.exportProperty(ngeo.DataSource.prototype,"getInRangeOGCLayerNames",ngeo.DataSource.prototype.getInRangeOGCLayerNames);
ngeo.DataSource.prototype.getOGCLayerNames=function(a){a=void 0===a?!1:a;var b=[];if(this.ogcLayers)for(var c=$jscomp.makeIterator(this.ogcLayers),d=c.next();!d.done;d=c.next())d=d.value,a&&!d.queryable||b.push(d.name);return b};goog.exportProperty(ngeo.DataSource.prototype,"getOGCLayerNames",ngeo.DataSource.prototype.getOGCLayerNames);ngeo.DataSource.prototype.getFiltrableOGCLayerName=function(){goog.asserts.assert(this.filtrable);var a=this.getOGCLayerNames();goog.asserts.assert(1===a.length);return a[0]};
goog.exportProperty(ngeo.DataSource.prototype,"getFiltrableOGCLayerName",ngeo.DataSource.prototype.getFiltrableOGCLayerName);ngeo.DataSource.prototype.updateGeometryNameFromAttributes_=function(){var a=ngeo.DataSource.DEFAULT_GEOMETRY_NAME_;if(this.attributes)for(var b=$jscomp.makeIterator(this.attributes),c=b.next();!c.done;c=b.next())if(c=c.value,c.type===ngeo.AttributeType.GEOMETRY){a=c.name;break}this.geometryName_=a};
ngeo.DataSource.prototype.haveTheSameActiveDimensions=function(a){var b=!0,c=this.activeDimensions;a=a.activeDimensions;for(var d in c)if(c[d]!==a[d]){b=!1;break}if(b)for(var e in a)if(a[e]!==c[e]){b=!1;break}return b};goog.exportProperty(ngeo.DataSource.prototype,"haveTheSameActiveDimensions",ngeo.DataSource.prototype.haveTheSameActiveDimensions);
$jscomp.global.Object.defineProperties(ngeo.DataSource.prototype,{dimensionsConfig:{configurable:!0,enumerable:!0,get:function(){return this.dimensionsConfig_},set:function(a){this.dimensionsConfig_=a}},filterCondition:{configurable:!0,enumerable:!0,get:function(){return this.filterCondition_},set:function(a){this.filterCondition_=a}},filterRules:{configurable:!0,enumerable:!0,get:function(){return this.filterRules_},set:function(a){this.filterRules_=a}},inRange:{configurable:!0,enumerable:!0,get:function(){return this.inRange_},
set:function(a){this.inRange_=a}},timeLowerValue:{configurable:!0,enumerable:!0,get:function(){return this.timeLowerValue_},set:function(a){this.timeLowerValue_=a}},timeRangeValue:{configurable:!0,enumerable:!0,get:function(){var a=null,b=this.timeLowerValue,c=this.timeUpperValue;void 0!==b&&(a={end:c,start:b});return a},set:function(a){a?(this.timeUpperValue=a.end,this.timeLowerValue=a.start):this.timeLowerValue=this.timeUpperValue=void 0}},timeUpperValue:{configurable:!0,enumerable:!0,get:function(){return this.timeUpperValue_},
set:function(a){this.timeUpperValue_=a}},visible:{configurable:!0,enumerable:!0,get:function(){return this.visible_},set:function(a){this.visible_=a}},attributes:{configurable:!0,enumerable:!0,get:function(){return this.attributes_},set:function(a){this.attributes_=a;this.updateGeometryNameFromAttributes_()}},copyable:{configurable:!0,enumerable:!0,get:function(){return this.copyable_}},filtrable:{configurable:!0,enumerable:!0,get:function(){return this.filtrable_},set:function(a){this.filtrable_=
a}},geometryName:{configurable:!0,enumerable:!0,get:function(){return this.geometryName_}},id:{configurable:!0,enumerable:!0,get:function(){return this.id_}},identifierAttribute:{configurable:!0,enumerable:!0,get:function(){return this.identifierAttribute_}},maxResolution:{configurable:!0,enumerable:!0,get:function(){return this.maxResolution_}},minResolution:{configurable:!0,enumerable:!0,get:function(){return this.minResolution_}},name:{configurable:!0,enumerable:!0,get:function(){return this.name_}},
ogcImageType:{configurable:!0,enumerable:!0,get:function(){return this.ogcImageType_}},ogcLayers:{configurable:!0,enumerable:!0,get:function(){return this.ogcLayers_}},ogcServerType:{configurable:!0,enumerable:!0,get:function(){return this.ogcServerType_}},ogcType:{configurable:!0,enumerable:!0,get:function(){return this.ogcType_}},snappable:{configurable:!0,enumerable:!0,get:function(){return this.snappable_}},snappingToEdges:{configurable:!0,enumerable:!0,get:function(){return this.snappingToEdges_}},
snappingToVertice:{configurable:!0,enumerable:!0,get:function(){return this.snappingToVertice_}},snappingTolerance:{configurable:!0,enumerable:!0,get:function(){return this.snappingTolerance_}},timeAttributeName:{configurable:!0,enumerable:!0,get:function(){return this.timeAttributeName_}},timeProperty:{configurable:!0,enumerable:!0,get:function(){return this.timeProperty_}},wfsFeatureNS:{configurable:!0,enumerable:!0,get:function(){return this.wfsFeatureNS_}},wfsFeaturePrefix:{configurable:!0,enumerable:!0,
get:function(){return this.wfsFeaturePrefix_}},wfsOutputFormat:{configurable:!0,enumerable:!0,get:function(){return this.wfsOutputFormat_}},wfsUrl:{configurable:!0,enumerable:!0,get:function(){return this.wfsUrl_}},wmsInfoFormat:{configurable:!0,enumerable:!0,get:function(){return this.wmsInfoFormat_}},wmsIsSingleTile:{configurable:!0,enumerable:!0,get:function(){return this.wmsIsSingleTile_}},wmsUrl:{configurable:!0,enumerable:!0,get:function(){return this.wmsUrl_}},wmtsLayer:{configurable:!0,enumerable:!0,
get:function(){return this.wmtsLayer_}},wmtsUrl:{configurable:!0,enumerable:!0,get:function(){return this.wmtsUrl_}},activeDimensions:{configurable:!0,enumerable:!0,get:function(){var a={},b=this.dimensions_||{},c=this.dimensionsConfig||{},d;for(d in c)null===c[d]?void 0!==b[d]&&null!==b[d]&&(a[d]=b[d]):a[d]=c[d];return a}},combinableForWFS:{configurable:!0,enumerable:!0,get:function(){return null===this.filterRules_&&null===this.timeRangeValue}},combinableForWMS:{configurable:!0,enumerable:!0,get:function(){return null===
this.filterRules_&&null===this.timeRangeValue}},queryable:{configurable:!0,enumerable:!0,get:function(){var a=!1;if((this.supportsWMS||this.supportsWFS)&&this.ogcLayers)for(var b=$jscomp.makeIterator(this.ogcLayers),c=b.next();!c.done;c=b.next())if(!0===c.value.queryable){a=!0;break}return a}},supportsDynamicInRange:{configurable:!0,enumerable:!0,get:function(){return null!==this.maxResolution||null!==this.minResolution}},supportsWFS:{configurable:!0,enumerable:!0,get:function(){return void 0!==this.wfsUrl}},
supportsAttributes:{configurable:!0,enumerable:!0,get:function(){return null!==this.attributes||this.supportsWFS&&null!==this.ogcLayers&&1===this.ogcLayers.length&&!0===this.ogcLayers[0].queryable}},supportsWMS:{configurable:!0,enumerable:!0,get:function(){return void 0!==this.wmsUrl}},supportsWMTS:{configurable:!0,enumerable:!0,get:function(){return void 0!==this.wmtsUrl}},wfsFormat:{configurable:!0,enumerable:!0,get:function(){return this.wfsFormat_}},wmsFormat:{configurable:!0,enumerable:!0,get:function(){return this.wmsFormat_}}});
ngeo.DataSource.DEFAULT_GEOMETRY_NAME_="the_geom";ngeo.DataSource.OGCServerType={GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGISSERVER:"qgisserver"};ngeo.DataSource.OGCType={WMS:"WMS",WMTS:"WMTS"};ngeo.DataSource.WFSFeatureNS={geoserver:"http://www.opengis.net/gml/3.2",mapserver:"http://mapserver.gis.umn.edu/mapserver",qgisserver:"http://www.qgis.org/gml"};ngeo.DataSource.WFSFeaturePrefix={FEATURE:"feature"};ngeo.DataSource.WFSOutputFormat={GML2:"GML2",GML3:"GML3"};
ngeo.DataSource.WMSInfoFormat={GML:"application/vnd.ogc.gml"};gmf.DataSource=function(a){ngeo.DataSource.call(this,a);this.gmfLayer_=a.gmfLayer};$jscomp.inherits(gmf.DataSource,ngeo.DataSource);gmf.DataSource.WMSInfoFormat=ngeo.DataSource.WMSInfoFormat;gmf.DataSource.WFSOutputFormat=ngeo.DataSource.WFSOutputFormat;gmf.DataSource.WFSFeaturePrefix=ngeo.DataSource.WFSFeaturePrefix;gmf.DataSource.WFSFeatureNS=ngeo.DataSource.WFSFeatureNS;gmf.DataSource.OGCType=ngeo.DataSource.OGCType;gmf.DataSource.OGCServerType=ngeo.DataSource.OGCServerType;
gmf.DataSource.DEFAULT_GEOMETRY_NAME_=ngeo.DataSource.DEFAULT_GEOMETRY_NAME_;$jscomp.global.Object.defineProperties(gmf.DataSource.prototype,{gmfLayer:{configurable:!0,enumerable:!0,get:function(){return this.gmfLayer_}}});ngeo.Time=function(){};ngeo.Time.prototype.getOptions=function(a){var b=new Date(a.minValue),c=new Date(a.maxValue),d=a.minDefValue?new Date(a.minDefValue):b,e=a.maxDefValue?new Date(a.maxDefValue):c;a="range"===a.mode?[d.getTime(),e.getTime()]:d.getTime();return{minDate:b.getTime(),maxDate:c.getTime(),values:a}};goog.exportProperty(ngeo.Time.prototype,"getOptions",ngeo.Time.prototype.getOptions);ngeo.Time.prototype.getUTCDate=function(a){return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())};
goog.exportProperty(ngeo.Time.prototype,"getUTCDate",ngeo.Time.prototype.getUTCDate);ngeo.module.service("ngeoTime",ngeo.Time);ngeo.WMSTime=function(a,b){this.$filter_=a;this.gettextCatalog_=b;ngeo.Time.call(this)};ol.inherits(ngeo.WMSTime,ngeo.Time);ngeo.WMSTime.$inject=["$filter","gettextCatalog"];
ngeo.WMSTime.prototype.formatTimeValue=function(a,b,c,d){a=new Date(a);d=d?"UTC":void 0;var e="yyyy",f="yyyy-MM",g="yyyy-MM-dd";c||(c=this.gettextCatalog_,e=c.getString("yyyy"),f=c.getString("M/yyyy"),g=c.getString("M/d/yyyy"));switch(b){case "year":return this.$filter_("date")(a,e,d);case "month":return this.$filter_("date")(a,f,d);case "day":return this.$filter_("date")(a,g,d);default:return a.toISOString().replace(/\.\d{3}/,"")}};
ngeo.WMSTime.prototype.formatWMSTimeParam=function(a,b,c){goog.asserts.assert(void 0!==a.resolution);return"range"===a.mode?(goog.asserts.assert(void 0!==b.end),this.formatTimeValue(b.start,a.resolution,!0,c)+"/"+this.formatTimeValue(b.end,a.resolution,!0,c)):this.formatTimeValue(b.start,a.resolution,!0,c)};goog.exportProperty(ngeo.WMSTime.prototype,"formatWMSTimeParam",ngeo.WMSTime.prototype.formatWMSTimeParam);ngeo.module.service("ngeoWMSTime",ngeo.WMSTime);gmf.SyncLayertreeMap=function(a,b,c,d){var e=this;this.layerHelper_=b;this.ngeoWMSTime_=c;d.getOgcServersObject().then(function(a){e.ogcServersObject_=a});a.$on("ngeo-layertree-state",function(a,b,c){e.sync_(a,c)})};gmf.SyncLayertreeMap.$inject=["$rootScope","ngeoLayerHelper","ngeoWMSTime","gmfThemes"];
gmf.SyncLayertreeMap.prototype.createLayer=function(a,b,c,d){var e=null;void 0!==a.node.children&&a.node.mixed?e=this.createGroup_(a,b,c,d):void 0===a.node.children&&a.parent.node.mixed?e=this.createLeafInAMixedGroup_(a,b):void 0===a.node.children?this.initGmfLayerInANotMixedGroup_(a,b):1!==a.depth||a.node.mixed||(e=this.createGroup_(a,b,c,d));e&&a.node.metadata.opacity&&e.setOpacity(a.node.metadata.opacity);return e};
gmf.SyncLayertreeMap.prototype.sync_=function(a,b){var c=this;b.traverseDepthFirst(function(a){a.layer&&!a.node.mixed&&c.updateLayerState_(a.layer,a)})};
gmf.SyncLayertreeMap.prototype.updateLayerState_=function(a,b){var c="on"===b.getState();if("WMTS"===b.node.type)a.setVisible(c);else if(b.node.mixed||1!==b.depth)goog.asserts.assertInstanceof(a,ol.layer.Image),a.setVisible(c);else{goog.asserts.assertInstanceof(a,ol.layer.Image);var d=[];b.traverseDepthFirst(function(a){void 0===a.node.children&&"on"===a.getState()&&d.push(a.node.layers)});0===d.length&&a.setVisible(!1);a.getSource().updateParams({LAYERS:d.reverse().join(",")});0!==d.length&&a.setVisible(!0)}};
gmf.SyncLayertreeMap.prototype.createGroup_=function(a,b,c,d){var e=a.node;b=null;var f=a.parent.isRoot,g=!0;void 0!==e.metadata.printNativeAngle&&(g=e.metadata.printNativeAngle);f?(b=this.createLayerFromGroup_(a,!!e.mixed),a=d|0,c.getLayers().insertAt(a,b)):this.isOneParentNotMixed_(a)||(b=this.createLayerFromGroup_(a,!0),gmf.SyncLayertreeMap.getLayer(a.parent).getLayers().insertAt(0,b));b.set("printNativeAngle",g);return b};
gmf.SyncLayertreeMap.prototype.createLayerFromGroup_=function(a,b){var c=this,d=a.node;if(b)var e=this.layerHelper_.createBasicGroup();else{b=this.getTimeParam_(a);var f=this.ogcServersObject_[d.ogcServer||""];goog.asserts.assert(f);goog.asserts.assert(f.url);goog.asserts.assert(f.type);goog.asserts.assert(f.imageType);e=this.layerHelper_.createBasicWMSLayer(f.url,"",f.imageType,f.type,b,void 0,f.credential?"use-credentials":"anonymous");var g=!1;a.traverseDepthFirst(function(a){c.updateLayerReferences_(a.node,
e);a.node.metadata.isChecked&&(a.setState("on",!1),c.updateLayerState_(e,a),g=!0)});e.setVisible(g);e.set("layerNodeName",d.name)}return e};
gmf.SyncLayertreeMap.prototype.createLeafInAMixedGroup_=function(a,b){b=a.node;if("WMTS"===b.type)var c=this.createWMTSLayer_(b);else{c=this.getTimeParam_(a);var d=this.ogcServersObject_[b.ogcServer];goog.asserts.assert(d);goog.asserts.assert(d.url);goog.asserts.assert(d.type);goog.asserts.assert(b.layers);goog.asserts.assert(d.imageType);c=this.layerHelper_.createBasicWMSLayer(d.url,b.layers,d.imageType,d.type,c,void 0,d.credential?"use-credentials":"anonymous")}c.set("layerNodeName",b.name);this.updateLayerReferences_(b,
c);(b=!0===b.metadata.isChecked)&&a.setState("on",!1);c.setVisible(b);gmf.SyncLayertreeMap.getLayer(a.parent).getLayers().insertAt(0,c);return c};gmf.SyncLayertreeMap.prototype.initGmfLayerInANotMixedGroup_=function(a,b){b=a.node;var c=this.getFirstLevelGroupCtrl_(a);goog.asserts.assert(c);var d=c.layer;goog.asserts.assertInstanceof(d,ol.layer.Image);this.updateLayerReferences_(b,d);b.metadata.isChecked?(a.setState("on",!1),this.updateLayerState_(d,c)):a.parent.refreshState()};
gmf.SyncLayertreeMap.prototype.createWMTSLayer_=function(a){var b=new ol.layer.Tile;goog.asserts.assert(a.url);goog.asserts.assert(a.layer);this.layerHelper_.createWMTSLayerFromCapabilitites(a.url,a.layer,a.matrixSet,a.dimensions).then(function(a){b.setSource(a.getSource());b.set("capabilitiesStyles",a.get("capabilitiesStyles"))});return b};
gmf.SyncLayertreeMap.prototype.updateLayerReferences_=function(a,b){var c=ol.getUid(a),d=b.get("querySourceIds")||[];d.push(c);b.set("querySourceIds",d);a.metadata.disclaimer&&(c=b.get("disclaimers")||[],c.push(a.metadata.disclaimer),b.set("disclaimers",c))};
gmf.SyncLayertreeMap.prototype.getTimeParam_=function(a){var b,c=a.node;c.time?b=c.time:c.children&&a.traverseDepthFirst(function(a){if(void 0===a.node.children&&a.node.time)return b=a.node.time,ngeo.LayertreeController.VisitorDecision.STOP});if(b){a=this.ngeoWMSTime_.getOptions(b).values;var d=this.ngeoWMSTime_.formatWMSTimeParam(b,{start:a[0]||a,end:a[1]})}return d};
gmf.SyncLayertreeMap.prototype.isOneParentNotMixed_=function(a){a=a.parent;do{var b=!1===a.node.mixed;a=a.parent}while(a.parent&&!b);return b};gmf.SyncLayertreeMap.prototype.getFirstLevelGroupCtrl_=function(a){for(;!a.parent.isRoot;)a=a.parent;return a};gmf.SyncLayertreeMap.getLayer=function(a){for(var b=null;!a.isRoot&&null===b;)a.layer&&(b=a.layer),a=a.parent;return b};gmf.module.service("gmfSyncLayertreeMap",gmf.SyncLayertreeMap);ngeo.utils={};ngeo.utils.toMulti=function(a){if(a instanceof ol.geom.Point){var b=new ol.geom.MultiPoint([]);b.appendPoint(a)}else a instanceof ol.geom.LineString?(b=new ol.geom.MultiLineString([]),b.appendLineString(a)):a instanceof ol.geom.Polygon?(b=new ol.geom.MultiPolygon([]),b.appendPolygon(a)):b=a;return b};ngeo.utils.isSafari=function(){return-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")};
ngeo.utils.colorZeroPadding=function(a){return 1==a.length?"0"+a:a};ngeo.utils.rgbArrayToHex=function(a){var b=a[0],c=a[1];a=a[2];if(b!=(b&255)||c!=(c&255)||a!=(a&255))throw Error('"('+b+","+c+","+a+')" is not a valid RGB color');b=ngeo.utils.colorZeroPadding(b.toString(16));c=ngeo.utils.colorZeroPadding(c.toString(16));a=ngeo.utils.colorZeroPadding(a.toString(16));return"#"+b+c+a};
ngeo.utils.decodeQueryString=function(a){var b={};if(a){a=a.substring(1).split("&");a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next()){var d=c.value,e=d.indexOf("=");0<=e?(c=d.substring(0,e),d=d.substring(e+1),b[decodeURIComponent(c)]=decodeURIComponent(d)):b[d]=""}}return b};ngeo.utils.encodeQueryString=function(a){var b=[],c;for(c in a){var d=a[c];b.push(encodeURIComponent(c)+"="+encodeURIComponent(d))}return b.join("&")};
ngeo.utils.deleteCondition=function(a){return ol.events.condition.noModifierKeys(a)&&ol.events.condition.singleClick(a)};ngeo.Location=function(a,b){this.history_=b;this.schema_=a.protocol.substring(0,a.protocol.length-1);this.domain_=a.hostname;this.port_=a.port?parseInt(a.port,10):void 0;this.path_=a.pathname;this.queryData_=ngeo.utils.decodeQueryString(a.search);this.fragment_=ngeo.utils.decodeQueryString(a.hash)};ngeo.Location.prototype.getPath=function(){return this.path_};goog.exportProperty(ngeo.Location.prototype,"getPath",ngeo.Location.prototype.getPath);
ngeo.Location.prototype.getUriString=function(){var a=[];this.schema_&&a.push(this.schema_,":");if(this.domain_||"file"===this.schema_)a.push("//"),a.push(this.domain_),void 0!==this.port_&&a.push(":",String(this.port_));this.path_&&(this.domain_&&"/"!==this.path_.charAt(0)&&a.push("/"),a.push(this.path_));var b=ngeo.utils.encodeQueryString(this.queryData_);0<b.length&&a.push("?",b);b=ngeo.utils.encodeQueryString(this.fragment_);0<b.length&&a.push("#",b);return a.join("")};
goog.exportProperty(ngeo.Location.prototype,"getUriString",ngeo.Location.prototype.getUriString);ngeo.Location.prototype.hasParam=function(a){return a in this.queryData_};goog.exportProperty(ngeo.Location.prototype,"hasParam",ngeo.Location.prototype.hasParam);ngeo.Location.prototype.hasFragmentParam=function(a){return a in this.fragment_};goog.exportProperty(ngeo.Location.prototype,"hasFragmentParam",ngeo.Location.prototype.hasFragmentParam);ngeo.Location.prototype.getParam=function(a){return this.queryData_[a]};
goog.exportProperty(ngeo.Location.prototype,"getParam",ngeo.Location.prototype.getParam);ngeo.Location.prototype.getFragmentParam=function(a){return this.fragment_[a]};goog.exportProperty(ngeo.Location.prototype,"getFragmentParam",ngeo.Location.prototype.getFragmentParam);ngeo.Location.prototype.getParamAsInt=function(a){a=this.getParam(a);if(void 0!==a)return goog.asserts.assertString(a),a=parseInt(a,10),isNaN(a)?void 0:a};goog.exportProperty(ngeo.Location.prototype,"getParamAsInt",ngeo.Location.prototype.getParamAsInt);
ngeo.Location.prototype.getFragmentParamAsInt=function(a){a=this.getFragmentParam(a);if(void 0!==a)return goog.asserts.assertString(a),a=parseInt(a,10),isNaN(a)?void 0:a};goog.exportProperty(ngeo.Location.prototype,"getFragmentParamAsInt",ngeo.Location.prototype.getFragmentParamAsInt);ngeo.Location.prototype.getParamKeys=function(){var a=[],b;for(b in this.queryData_)a.push(b);return a};goog.exportProperty(ngeo.Location.prototype,"getParamKeys",ngeo.Location.prototype.getParamKeys);
ngeo.Location.prototype.getFragmentParamKeys=function(){var a=[],b;for(b in this.fragment_)a.push(b);return a};goog.exportProperty(ngeo.Location.prototype,"getFragmentParamKeys",ngeo.Location.prototype.getFragmentParamKeys);ngeo.Location.prototype.getParamKeysWithPrefix=function(a){var b=[],c;for(c in this.queryData_)0==c.indexOf(a)&&b.push(c);return b};goog.exportProperty(ngeo.Location.prototype,"getParamKeysWithPrefix",ngeo.Location.prototype.getParamKeysWithPrefix);
ngeo.Location.prototype.getFragmentParamKeysWithPrefix=function(a){var b=[],c;for(c in this.fragment_)0==c.indexOf(a)&&b.push(c);return b};goog.exportProperty(ngeo.Location.prototype,"getFragmentParamKeysWithPrefix",ngeo.Location.prototype.getFragmentParamKeysWithPrefix);ngeo.Location.prototype.updateParams=function(a){for(var b in a)this.queryData_[b]=a[b]};goog.exportProperty(ngeo.Location.prototype,"updateParams",ngeo.Location.prototype.updateParams);
ngeo.Location.prototype.updateFragmentParams=function(a){for(var b in a)this.fragment_[b]=a[b]};goog.exportProperty(ngeo.Location.prototype,"updateFragmentParams",ngeo.Location.prototype.updateFragmentParams);ngeo.Location.prototype.deleteParam=function(a){delete this.queryData_[a]};goog.exportProperty(ngeo.Location.prototype,"deleteParam",ngeo.Location.prototype.deleteParam);ngeo.Location.prototype.deleteFragmentParam=function(a){delete this.fragment_[a]};
goog.exportProperty(ngeo.Location.prototype,"deleteFragmentParam",ngeo.Location.prototype.deleteFragmentParam);ngeo.Location.prototype.refresh=function(){this.history_.replaceState(null,"",this.getUriString())};goog.exportProperty(ngeo.Location.prototype,"refresh",ngeo.Location.prototype.refresh);ngeo.Location.prototype.setPath=function(a){this.path_=a};goog.exportProperty(ngeo.Location.prototype,"setPath",ngeo.Location.prototype.setPath);
ngeo.LocationFactory=function(a,b){var c=b.history,d=new ngeo.Location(b.location,b.history),e=d.getUriString();a.$watch(function(){var b=d.getUriString();e!==b&&a.$evalAsync(function(){e=b;void 0!==c&&void 0!==c.replaceState&&c.replaceState(null,"",b);a.$broadcast("ngeoLocationChange")})});return d};ngeo.LocationFactory.$inject=["$rootScope","$window"];ngeo.module.factory("ngeoLocation",ngeo.LocationFactory);
ngeo.mockLocationProvider=function(a){a.$get=function(){return{absUrl:function(){return""},hash:function(a){return void 0!==a?this:""},host:function(){return""},path:function(a){return void 0!==a?this:""},port:function(){return 0},protocol:function(){return""},replace:function(){},search:function(a,c){return void 0!==a?this:{}},url:function(a){return""}}}};ngeo.mockLocationProvider.$inject=["$locationProvider"];ngeo.module.value("ngeoUsedKeyRegexp",[/.*/]);
ngeo.StateManager=function(a,b){var c=this;this.initialState={};this.ngeoLocation=a;this.usedKeyRegexp=b;this.useLocalStorage=!1;try{"localStorage"in window?(window.localStorage.test="",delete window.localStorage.test):this.useLocalStorage=!1}catch(e){console.error(e),this.useLocalStorage=!1}a=a.getParamKeys().filter(function(a){return"debug"!=a&&"no_redirect"!=a});if(0===a.length){if(this.useLocalStorage){a={};for(var d in window.localStorage)a.key=d,goog.asserts.assert(a.key),this.usedKeyRegexp.some(function(a){return function(b){if(a.key.match(b))return b=
window.localStorage[a.key],c.initialState[a.key]=void 0!==b||null!==b?b:"",!0}}(a)),a={key:a.key}}}else a.forEach(function(a){c.usedKeyRegexp.some(function(b){if(a.match(b)&&(b=c.ngeoLocation.getParam(a),void 0!==b))return c.initialState[a]=b,!0})})};ngeo.StateManager.$inject=["ngeoLocation","ngeoUsedKeyRegexp"];ngeo.StateManager.prototype.getInitialValue=function(a){return this.initialState[a]};ngeo.StateManager.prototype.getInitialStringValue=function(a){a=this.initialState[a];if(void 0!==a)return a};
ngeo.StateManager.prototype.getInitialNumberValue=function(a){a=this.initialState[a];if(void 0!==a)return parseFloat(a)};ngeo.StateManager.prototype.getInitialBooleanValue=function(a){a=this.initialState[a];if(void 0!==a)return"true"===a};ngeo.StateManager.prototype.updateState=function(a){this.ngeoLocation.updateParams(a);if(this.useLocalStorage)for(var b in a){goog.asserts.assert(b);var c=a[b];goog.asserts.assert(void 0!==c);window.localStorage[b]=c}};
ngeo.StateManager.prototype.deleteParam=function(a){this.ngeoLocation.deleteParam(a);this.useLocalStorage&&delete window.localStorage[a]};ngeo.module.service("ngeoStateManager",ngeo.StateManager);ngeo.decorateLayer=function(a){goog.asserts.assertInstanceof(a,ol.layer.Base);Object.defineProperty(a,"visible",{configurable:!0,get:function(){return a.getVisible()},set:function(b){a.setVisible(b)}});Object.defineProperty(a,"opacity",{configurable:!0,get:function(){return a.getOpacity()},set:function(b){a.setOpacity(b)}})};ngeo.module.value("ngeoDecorateLayer",ngeo.decorateLayer);ngeo.decorateLayerLoading=function(a,b){function c(a){var b=a.get("load_count"),d=a.get("parent_group");a.set("load_count",++b,!0);d&&c(d)}function d(a){var b=a.get("load_count"),c=a.get("parent_group");a.set("load_count",--b,!0);c&&d(c)}var e=null,f=null;a.set("load_count",0,!0);if(a instanceof ol.layer.Group)a.getLayers().on("add",function(b){b.element.set("parent_group",a)});if(a instanceof ol.layer.Layer){var g=a.getSource();if(null===g)return;g instanceof ol.source.Tile?(e=["tileloadstart"],
f=["tileloadend","tileloaderror"]):g instanceof ol.source.Image?(e=["imageloadstart"],f=["imageloadend","imageloaderror"]):goog.asserts.fail("unsupported source type");g.on(e,function(){c(a);b.$applyAsync()});g.on(f,function(){d(a);b.$applyAsync()})}Object.defineProperty(a,"loading",{configurable:!0,get:function(){return 0<a.get("load_count")}})};ngeo.module.value("ngeoDecorateLayerLoading",ngeo.decorateLayerLoading);ngeo.module.value("ngeoLayertreeTemplateUrl",function(a,b){a=b.ngeoLayertreeTemplateurl;return void 0!==a?a:ngeo.baseTemplateUrl+"/layertree.html"});ngeo.layertreeDirective=function(a,b){return{restrict:"A",scope:!0,templateUrl:b,controller:"NgeoLayertreeController"}};ngeo.layertreeDirective.$inject=["$compile","ngeoLayertreeTemplateUrl"];ngeo.module.directive("ngeoLayertree",ngeo.layertreeDirective);
ngeo.LayertreeController=function(a,b,c,d,e){var f=this,g=void 0===c.ngeoLayertreeNotroot;this.isRoot=g;var h=c.ngeoLayertree;this.rootScope_=b;this.properties={};this.state_="off";g?a.$watch(h,function(a,b){f.node=a}):(this.node=a.$eval(h),goog.asserts.assert(void 0!==this.node));b=a.$eval(c.ngeoLayertreeMap);goog.asserts.assert(void 0!==b);this.parent=a.$parent.layertreeCtrl;this.children=[];this.parent&&this.parent.children.push(this);a.$on("$destroy",function(){if(f.parent){var a=f.parent.children.indexOf(f);
goog.asserts.assert(0<=a);f.parent.children.splice(a,1)}});this.uid=ol.getUid(this);this.depth=g?0:this.parent.depth+1;a.uid=this.uid;a.depth=this.depth;this.map=b;b=c.ngeoLayertreeNodelayer;void 0===b&&(b=a.$eval(c.ngeoLayertreeNodelayerexpr),goog.asserts.assertString(b));goog.asserts.assert(void 0!==b);this.nodelayerExpr=b;this.layer=null;!g&&(g=a.$eval(b,{treeCtrl:this})||null)&&(goog.asserts.assert(g instanceof ol.layer.Layer||g instanceof ol.layer.Group),this.layer=g);this.dataSource_=null;this.layer&&
(e(this.layer,a),d(this.layer),ol.events.listen(this.layer,ol.Object.getChangeEventType(ol.layer.Property.OPACITY),function(a){this.rootScope_.$broadcast("ngeo-layertree-opacity",this)},this));d=c.ngeoLayertreeListeners;void 0===d&&(d=a.$eval(c.ngeoLayertreeListenersexpr));void 0!==d&&goog.asserts.assertString(d);(this.listenersExpr=d)&&a.$eval(d,{treeScope:a,treeCtrl:this});a.layertreeCtrl=this};goog.exportSymbol("ngeo.LayertreeController",ngeo.LayertreeController);
ngeo.LayertreeController.$inject=["$scope","$rootScope","$attrs","ngeoDecorateLayer","ngeoDecorateLayerLoading"];ngeo.LayertreeController.prototype.getState=function(){return this.state_};goog.exportProperty(ngeo.LayertreeController.prototype,"getState",ngeo.LayertreeController.prototype.getState);
ngeo.LayertreeController.prototype.setState=function(a,b){var c=this;a!==this.state_&&(this.setStateInternal_(a),this.parent&&this.parent.refreshState(),a=this.isRoot?this.children:[ngeo.LayertreeController.getFirstParentTree(this)],(void 0===b||b)&&a.forEach(function(a){c.rootScope_.$broadcast("ngeo-layertree-state",c,a)}))};goog.exportProperty(ngeo.LayertreeController.prototype,"setState",ngeo.LayertreeController.prototype.setState);
ngeo.LayertreeController.prototype.setStateInternal_=function(a){this.state_="on"===a?"on":"off";this.children.forEach(function(a){a.setStateInternal_(this.state_)},this)};ngeo.LayertreeController.prototype.refreshState=function(){var a=this.getCalculateState();this.state_!==a&&(this.state_=a,this.parent&&this.parent.refreshState())};
ngeo.LayertreeController.prototype.getCalculateState=function(){if(void 0===this.node.children)return this.state_;var a,b;this.children.some(function(c){a=c.getCalculateState();if(b&&b!==a)return a="indeterminate";b=a});return a};goog.exportProperty(ngeo.LayertreeController.prototype,"getCalculateState",ngeo.LayertreeController.prototype.getCalculateState);
ngeo.LayertreeController.prototype.getSetActive=function(a){var b=this.layer,c=this.map;if(b)if(void 0!==a)a?c.addLayer(b):c.removeLayer(b);else return 0<=c.getLayers().getArray().indexOf(b)};goog.exportProperty(ngeo.LayertreeController.prototype,"getSetActive",ngeo.LayertreeController.prototype.getSetActive);ngeo.LayertreeController.prototype.getDataSource=function(){return this.dataSource_};goog.exportProperty(ngeo.LayertreeController.prototype,"getDataSource",ngeo.LayertreeController.prototype.getDataSource);
ngeo.LayertreeController.prototype.setDataSource=function(a){this.dataSource_=a};goog.exportProperty(ngeo.LayertreeController.prototype,"setDataSource",ngeo.LayertreeController.prototype.setDataSource);ngeo.LayertreeController.getFirstParentTree=function(a){for(;!a.parent.isRoot;)a=a.parent;return a};ngeo.LayertreeController.VisitorDecision={STOP:"STOP",SKIP:"SKIP",DESCEND:"DESCEND"};
ngeo.LayertreeController.prototype.traverseDepthFirst=function(a){switch(a(this)||ngeo.LayertreeController.VisitorDecision.DESCEND){case ngeo.LayertreeController.VisitorDecision.STOP:return!0;case ngeo.LayertreeController.VisitorDecision.SKIP:return!1;case ngeo.LayertreeController.VisitorDecision.DESCEND:for(var b=0;b<this.children.length;++b)if(this.children[b].traverseDepthFirst(a))return!0;return!1;default:goog.asserts.fail("Unhandled case")}};
goog.exportProperty(ngeo.LayertreeController.prototype,"traverseDepthFirst",ngeo.LayertreeController.prototype.traverseDepthFirst);ngeo.module.controller("NgeoLayertreeController",ngeo.LayertreeController);gmf.TreeManager=function(a,b,c,d,e,f,g){this.$timeout_=a;this.$injector_=b;this.gettextCatalog_=c;this.layerHelper_=d;this.ngeoNotification_=e;this.gmfThemes_=f;this.root={children:[]};this.rootCtrl=null;this.numberOfGroupsToAddInThisDigestLoop=0;this.groupsToAddInThisDigestLoop_=[];this.promiseForGroupsToAddInThisDigestLoop_=null;this.ngeoStateManager_=g;this.ogcServers_=null;ol.events.listen(this.gmfThemes_,gmf.ThemesEventType.CHANGE,this.handleThemesChange_,this)};gmf.TreeManager.$inject="$timeout $injector gettextCatalog ngeoLayerHelper ngeoNotification gmfThemes ngeoStateManager".split(" ");
gmf.TreeManager.prototype.handleThemesChange_=function(){var a=this;this.gmfThemes_.getOgcServersObject().then(function(b){a.ogcServers_=b});this.rootCtrl&&this.rootCtrl.children&&this.gmfThemes_.getThemesObject().then(function(b){a.refreshFirstLevelGroups_(b)})};gmf.TreeManager.prototype.setFirstLevelGroups=function(a){this.root.children.length=0;this.ngeoStateManager_.deleteParam(gmf.PermalinkParam.TREE_GROUPS);return this.addFirstLevelGroups(a)};
goog.exportProperty(gmf.TreeManager.prototype,"setFirstLevelGroups",gmf.TreeManager.prototype.setFirstLevelGroups);gmf.TreeManager.prototype.addFirstLevelGroups=function(a,b,c){var d=this,e=[];a.slice().reverse().forEach(function(a){d.addFirstLevelGroup_(a)||e.push(a)});0<e.length&&!c&&this.notifyCantAddGroups_(e);return 0===e.length};goog.exportProperty(gmf.TreeManager.prototype,"addFirstLevelGroups",gmf.TreeManager.prototype.addFirstLevelGroups);
gmf.TreeManager.prototype.updateTreeGroupsState_=function(a){var b={};b[gmf.PermalinkParam.TREE_GROUPS]=a.map(function(a){return a.name}).join(",");this.ngeoStateManager_.updateState(b);this.$injector_.has("gmfPermalink")&&this.$injector_.get("gmfPermalink").cleanParams(a)};
gmf.TreeManager.prototype.addFirstLevelGroup_=function(a){var b=this,c=!1,d=a.id;this.root.children.some(function(a){if(d===a.id)return c=!0},this);this.groupsToAddInThisDigestLoop_.some(function(a){if(d===a.id)return c=!0},this);if(c)return!1;this.groupsToAddInThisDigestLoop_.push(a);this.numberOfGroupsToAddInThisDigestLoop=0;null!==this.promiseForGroupsToAddInThisDigestLoop_&&this.$timeout_.cancel(this.promiseForGroupsToAddInThisDigestLoop_);this.promiseForGroupsToAddInThisDigestLoop_=this.$timeout_(function(){b.numberOfGroupsToAddInThisDigestLoop=
b.groupsToAddInThisDigestLoop_.length;b.groupsToAddInThisDigestLoop_.forEach(function(a){this.root.children.unshift(a)},b);b.updateTreeGroupsState_(b.root.children);b.groupsToAddInThisDigestLoop_.length=0;b.promiseForGroupsToAddInThisDigestLoop_=null});return!0};gmf.TreeManager.prototype.addGroupByName=function(a,b){var c=this;this.gmfThemes_.getThemesObject().then(function(d){(d=gmf.Themes.findGroupByName(d,a))&&c.addFirstLevelGroups([d],b,!1)})};
goog.exportProperty(gmf.TreeManager.prototype,"addGroupByName",gmf.TreeManager.prototype.addGroupByName);
gmf.TreeManager.prototype.addGroupByLayerName=function(a,b,c){var d=this;this.gmfThemes_.getThemesObject().then(function(e){var f=gmf.Themes.findGroupByLayerNodeName(e,a);if(f){var g=d.addFirstLevelGroups([f],b,c);d.$timeout_(function(){var b=d.getTreeCtrlByNodeId(f.id);if(b){var c;b.traverseDepthFirst(function(b){if(b.node.name===a)return c=b,ngeo.LayertreeController.VisitorDecision.STOP});g&&b.setState("off");c&&c.setState("on")}else console.warn("Tree controller not found, unable to add the group")})}})};
goog.exportProperty(gmf.TreeManager.prototype,"addGroupByLayerName",gmf.TreeManager.prototype.addGroupByLayerName);gmf.TreeManager.prototype.removeGroup=function(a){var b=this.root.children,c=0,d=!1;b.some(function(b){if(b.name===a.name)return d=!0;c++});d&&(b.splice(c,1),this.updateTreeGroupsState_(b))};goog.exportProperty(gmf.TreeManager.prototype,"removeGroup",gmf.TreeManager.prototype.removeGroup);gmf.TreeManager.prototype.removeAll=function(){for(;this.root.children.length;)this.removeGroup(this.root.children[0])};
goog.exportProperty(gmf.TreeManager.prototype,"removeAll",gmf.TreeManager.prototype.removeAll);gmf.TreeManager.prototype.cloneGroupNode_=function(a,b){a=ol.obj.assign({},a);this.toggleNodeCheck_(a,b);return a};gmf.TreeManager.prototype.toggleNodeCheck_=function(a,b){a.children&&a.children.forEach(function(a){a.children?this.toggleNodeCheck_(a,b):a.metadata&&(a.metadata.isChecked=ol.array.includes(b,a.name))},this)};
gmf.TreeManager.prototype.notifyCantAddGroups_=function(a){var b=[],c=this.gettextCatalog_;a.forEach(function(a){b.push(c.getString(a.name))});a=2>b.length?c.getString("group is already loaded."):c.getString("groups are already loaded.");this.ngeoNotification_.notify({msg:b.join(", ")+" "+a,type:ngeo.MessageType.INFORMATION})};
gmf.TreeManager.prototype.getTreeCtrlByNodeId=function(a){var b=null;this.rootCtrl&&this.rootCtrl.traverseDepthFirst&&this.rootCtrl.traverseDepthFirst(function(c){if(c.node.id===a)return b=c,ngeo.LayertreeController.VisitorDecision.STOP});return b};gmf.TreeManager.prototype.getOgcServer=function(a){if(a.parent.node.mixed)return a=a.node,goog.asserts.assert(a.ogcServer),this.ogcServers_[a.ogcServer];for(;!a.parent.isRoot;)a=a.parent;a=a.node;goog.asserts.assert(a.ogcServer);return this.ogcServers_[a.ogcServer]};
gmf.TreeManager.prototype.refreshFirstLevelGroups_=function(a){var b=this,c={};this.rootCtrl.children.map(function(a){c[a.node.name]=b.getFirstLevelGroupFullState_(a)});var d=[];this.root.children.map(function(e){var f=e.name;if(e=gmf.Themes.findGroupByName(a,f))(f=c[f])&&b.setNodeMetadataFromFullState_(e,f),d.push(e)});this.setFirstLevelGroups(d);this.$timeout_(function(){b.updateTreeGroupsState_(b.root.children)})};
gmf.TreeManager.prototype.getFirstLevelGroupFullState_=function(a){var b=this,c={};a.children.map(function(a){c[a.node.name]=b.getFirstLevelGroupFullState_(a)});var d,e;if(0<a.children.length)(a=$("#gmf-layertree-layer-group-"+a.uid))&&(d=a.hasClass("in"));else{var f=a.getState();f="on"===f?!0:"off"===f?!1:void 0;(a=$("#gmf-layertree-node-"+a.uid+"-legend"))&&(e=a.is(":visible"))}return{children:c,isChecked:f,isExpanded:d,isLegendExpanded:e}};
gmf.TreeManager.prototype.setNodeMetadataFromFullState_=function(a,b){var c=this;if(!b)return a;a.children&&a.children.map(function(a){c.setNodeMetadataFromFullState_(a,b.children[a.name])});var d=a.metadata;d.isChecked=b.isChecked;d.isExpanded=b.isExpanded;d.isLegendExpanded=b.isLegendExpanded;return a};gmf.module.service("gmfTreeManager",gmf.TreeManager);ngeo.module.value("ngeoDataSources",new ol.Collection);ngeo.filters={};ngeo.Scalify=function(a){var b=a("number");a=function(a){return(a=b(a,0))?"1\u00a0:\u00a0"+a:""};a.$stateful=!0;return a};ngeo.Scalify.$inject=["$filter"];ngeo.module.filter("ngeoScalify",ngeo.Scalify);
ngeo.Number=function(a){var b=a.NUMBER_FORMATS;return function(a,d){var c=b.GROUP_SEP,f=b.DECIMAL_SEP;void 0===d&&(d=3);if(Infinity===a)return"\u221e";if(-Infinity===a)return"-\u221e";if(0===a)return"0";var g=0>a;a=Math.abs(a);var h=d-Math.floor(Math.log(a)/Math.log(10))-1,k=Math.pow(10,h);a=Math.round(a*k);d="";k=Math.floor(a/k);if(0<h){for(d=""+a;d.length<h;)d="0"+d;for(d=d.substring(d.length-h);"0"===d[d.length-1];)d=d.substring(0,d.length-1)}a=[];for(h=""+k;3<h.length;)k=h.length-3,a.unshift(h.substring(k)),
h=h.substring(0,k);a.unshift(h);return(g?"-":"")+a.join(c)+(0===d.length?"":f+d)}};ngeo.Number.$inject=["$locale"];ngeo.module.filter("ngeoNumber",ngeo.Number);ngeo.UnitPrefix=function(a){var b=a("ngeoNumber"),c=" k M G T P".split(" "),d=" Ki Mi Gi Ti Pi".split(" ");return function(a,f,g,h){void 0===f&&(f="");var e=1E3,l=c;"square"===g?e=1E6:"binary"===g&&(e=1024,l=d);g=0;for(var m=l.length-1;a>=e&&g<m;)a/=e,g++;f=l[g]+f;e=0==f.length?"":"\u00a0";return b(a,h)+e+f}};ngeo.UnitPrefix.$inject=["$filter"];
ngeo.module.filter("ngeoUnitPrefix",ngeo.UnitPrefix);ngeo.NumberCoordinates=function(a){return function(b,c,d){d=d?d:"{x} {y}";var e=b[0];b=b[1];c=parseInt(c,10)|0;e=a("number")(e,c);b=a("number")(b,c);return d.replace("{x}",e).replace("{y}",b)}};ngeo.NumberCoordinates.$inject=["$filter"];ngeo.module.filter("ngeoNumberCoordinates",ngeo.NumberCoordinates);
ngeo.DMSCoordinates=function(){var a=function(a,c,d){a=ol.math.modulo(a+180,360)-180;var b=Math.abs(3600*a),f=b%60;return Math.floor(b/3600)+"\u00b0 "+ol.string.padNumber(Math.floor(b/60%60),2)+"\u2032 "+ol.string.padNumber(f,2,d)+"\u2033 "+c.charAt(0>a?1:0)};return function(b,c,d){c=parseInt(c,10)|0;d=d?d:"{x} {y}";var e=a(b[0],"EW",c);b=a(b[1],"NS",c);return d.replace("{x}",e).replace("{y}",b)}};ngeo.module.filter("ngeoDMSCoordinates",ngeo.DMSCoordinates);
ngeo.trustHtmlFilter=function(a){return function(b){return void 0!==b&&null!==b?a.trustAsHtml(""+b):a.trustAsHtml("&nbsp;")}};ngeo.trustHtmlFilter.$inject=["$sce"];ngeo.module.filter("ngeoTrustHtml",ngeo.trustHtmlFilter);ol.interaction.DrawEventType={DRAWSTART:"drawstart",DRAWEND:"drawend"};ngeo.interaction={};ngeo.MeasureEventType={MEASUREEND:"measureend"};ngeo.MeasureEvent=function(a,b){ol.events.Event.call(this,a);this.feature=b};ol.inherits(ngeo.MeasureEvent,ol.events.Event);
ngeo.interaction.Measure=function(a){a=void 0!==a?a:{};ol.interaction.Interaction.call(this,{handleEvent:ngeo.interaction.Measure.handleEvent_});this.continueMsg=this.sketchFeature=this.measureTooltipOverlayCoord_=this.measureTooltipOverlay_=this.measureTooltipElement_=this.helpTooltipOverlay_=this.helpTooltipElement_=null;this.decimals=a.decimals;this.precision=a.precision;this.displayHelpTooltip_=void 0!==a.displayHelpTooltip?a.displayHelpTooltip:!0;void 0!==a.startMsg?this.startMsg=a.startMsg:
(this.startMsg=document.createElement("span"),this.startMsg.textContent="Click to start drawing.");this.postcomposeEventKey_=this.changeEventKey_=null;var b=void 0!==a.style?a.style:[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})}),new ol.style.Style({stroke:new ol.style.Stroke({color:"white",width:5})}),new ol.style.Style({stroke:new ol.style.Stroke({color:"#ffcc33",width:3})})];this.vectorLayer_=new ol.layer.Vector({source:new ol.source.Vector,style:b});this.drawInteraction_=
this.createDrawInteraction(a.sketchStyle,this.vectorLayer_.getSource());this.shouldHandleDrawInteractionActiveChange_=!0;ol.events.listen(this.drawInteraction_,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),this.handleDrawInteractionActiveChange_,this);ol.events.listen(this.drawInteraction_,ol.interaction.DrawEventType.DRAWSTART,this.onDrawStart_,this);ol.events.listen(this.drawInteraction_,ol.interaction.DrawEventType.DRAWEND,this.onDrawEnd_,this);ol.events.listen(this,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),
this.updateState_,this)};ol.inherits(ngeo.interaction.Measure,ol.interaction.Interaction);ngeo.interaction.Measure.SPHERE_WGS84=new ol.Sphere(ol.proj.EPSG4326.RADIUS);ngeo.interaction.Measure.getFormattedArea=function(a,b,c,d){a=a.clone().transform(b,"EPSG:4326").getLinearRing(0).getCoordinates();a=Math.abs(ngeo.interaction.Measure.SPHERE_WGS84.geodesicArea(a));return d(a,"m\u00b2","square",c)};goog.exportSymbol("ngeo.interaction.Measure.getFormattedArea",ngeo.interaction.Measure.getFormattedArea);
ngeo.interaction.Measure.getFormattedCircleArea=function(a,b,c){a=Math.PI*Math.pow(a.getRadius(),2);return c(a,"m\u00b2","square",b)};goog.exportSymbol("ngeo.interaction.Measure.getFormattedCircleArea",ngeo.interaction.Measure.getFormattedCircleArea);
ngeo.interaction.Measure.getFormattedLength=function(a,b,c,d){var e=0;a=a.getCoordinates();for(var f=0,g=a.length-1;f<g;++f){var h=ol.proj.transform(a[f],b,"EPSG:4326"),k=ol.proj.transform(a[f+1],b,"EPSG:4326");e+=ngeo.interaction.Measure.SPHERE_WGS84.haversineDistance(h,k)}return d(e,"m","unit",c)};goog.exportSymbol("ngeo.interaction.Measure.getFormattedLength",ngeo.interaction.Measure.getFormattedLength);
ngeo.interaction.Measure.getFormattedPoint=function(a,b,c,d){return c(a.getCoordinates(),b,d)};ngeo.interaction.Measure.handleEvent_=function(a){if(a.type!=ol.MapBrowserEventType.POINTERMOVE||a.dragging)return!0;var b=this.startMsg;null!==this.sketchFeature&&(b=this.continueMsg);this.displayHelpTooltip_&&(ol.dom.removeChildren(this.helpTooltipElement_),this.helpTooltipElement_.appendChild(b),this.helpTooltipOverlay_.setPosition(a.coordinate));return!0};
ngeo.interaction.Measure.prototype.getDrawInteraction=function(){return this.drawInteraction_};goog.exportProperty(ngeo.interaction.Measure.prototype,"getDrawInteraction",ngeo.interaction.Measure.prototype.getDrawInteraction);ngeo.interaction.Measure.prototype.createDrawInteraction=function(a,b){};
ngeo.interaction.Measure.prototype.setMap=function(a){ol.interaction.Interaction.prototype.setMap.call(this,a);this.vectorLayer_.setMap(a);var b=this.drawInteraction_.getMap();null!==b&&b.removeInteraction(this.drawInteraction_);null!==a&&a.addInteraction(this.drawInteraction_)};
ngeo.interaction.Measure.prototype.onDrawStart_=function(a){var b=this;this.sketchFeature=a.feature;this.vectorLayer_.getSource().clear(!0);this.createMeasureTooltip_();a=this.sketchFeature.getGeometry();goog.asserts.assert(void 0!==a);this.changeEventKey_=ol.events.listen(a,"change",function(){b.handleMeasure(function(a,d){null!==d&&(b.measureTooltipElement_.innerHTML=a,b.measureTooltipOverlayCoord_=d)})});this.postcomposeEventKey_=ol.events.listen(this.getMap(),"postcompose",function(){b.measureTooltipOverlay_.setPosition(b.measureTooltipOverlayCoord_)})};
ngeo.interaction.Measure.prototype.onDrawEnd_=function(a){this.measureTooltipElement_.classList.add("ngeo-tooltip-static");this.measureTooltipOverlay_.setOffset([0,-7]);this.dispatchEvent(new ngeo.MeasureEvent(ngeo.MeasureEventType.MEASUREEND,this.sketchFeature));this.sketchFeature=null;this.unlistenerEvent_()};
ngeo.interaction.Measure.prototype.unlistenerEvent_=function(){null!==this.changeEventKey_&&null!==this.postcomposeEventKey_&&(ol.events.unlistenByKey(this.changeEventKey_),ol.events.unlistenByKey(this.postcomposeEventKey_),this.postcomposeEventKey_=this.changeEventKey_=null)};
ngeo.interaction.Measure.prototype.createHelpTooltip_=function(){this.removeHelpTooltip_();this.displayHelpTooltip_&&(this.helpTooltipElement_=document.createElement("div"),this.helpTooltipElement_.classList.add("tooltip"),this.helpTooltipOverlay_=new ol.Overlay({element:this.helpTooltipElement_,offset:[15,0],positioning:"center-left"}),this.getMap().addOverlay(this.helpTooltipOverlay_))};
ngeo.interaction.Measure.prototype.removeHelpTooltip_=function(){this.displayHelpTooltip_&&(this.getMap().removeOverlay(this.helpTooltipOverlay_),null!==this.helpTooltipElement_&&this.helpTooltipElement_.parentNode.removeChild(this.helpTooltipElement_),this.helpTooltipOverlay_=this.helpTooltipElement_=null)};
ngeo.interaction.Measure.prototype.createMeasureTooltip_=function(){this.removeMeasureTooltip_();this.measureTooltipElement_=document.createElement("div");this.measureTooltipElement_.classList.add("tooltip");this.measureTooltipElement_.classList.add("ngeo-tooltip-measure");this.measureTooltipOverlay_=new ol.Overlay({element:this.measureTooltipElement_,offset:[0,-15],positioning:"bottom-center",stopEvent:!1});this.getMap().addOverlay(this.measureTooltipOverlay_)};
ngeo.interaction.Measure.prototype.removeMeasureTooltip_=function(){null!==this.measureTooltipElement_&&(this.measureTooltipElement_.parentNode.removeChild(this.measureTooltipElement_),this.measureTooltipOverlayCoord_=this.measureTooltipOverlay_=this.measureTooltipElement_=null)};
ngeo.interaction.Measure.prototype.updateState_=function(){var a=this.getActive();this.shouldHandleDrawInteractionActiveChange_=!1;this.drawInteraction_.setActive(a);this.shouldHandleDrawInteractionActiveChange_=!0;this.getMap()&&(a?this.measureTooltipOverlay_||(this.createMeasureTooltip_(),this.createHelpTooltip_()):(this.vectorLayer_.getSource().clear(!0),this.getMap().removeOverlay(this.measureTooltipOverlay_),this.removeMeasureTooltip_(),this.removeHelpTooltip_(),this.unlistenerEvent_()))};
ngeo.interaction.Measure.prototype.handleMeasure=function(a){};ngeo.interaction.Measure.prototype.getTooltipElement=function(){return this.measureTooltipElement_};goog.exportProperty(ngeo.interaction.Measure.prototype,"getTooltipElement",ngeo.interaction.Measure.prototype.getTooltipElement);ngeo.interaction.Measure.prototype.handleDrawInteractionActiveChange_=function(){this.shouldHandleDrawInteractionActiveChange_&&this.setActive(this.drawInteraction_.getActive())};ol.geom.Circle=function(a,b,c){ol.geom.SimpleGeometry.call(this);this.setCenterAndRadius(a,b?b:0,c)};ol.inherits(ol.geom.Circle,ol.geom.SimpleGeometry);ol.geom.Circle.prototype.clone=function(){var a=new ol.geom.Circle(null);a.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return a};
ol.geom.Circle.prototype.closestPointXY=function(a,b,c,d){var e=this.flatCoordinates;a-=e[0];var f=b-e[1];b=a*a+f*f;if(b<d){0===b?d=0:(d=this.getRadius()/Math.sqrt(b),c[0]=e[0]+d*a,c[1]=e[1]+d*f,d=2);for(;d<this.stride;++d)c[d]=e[d];c.length=this.stride;return b}return d};ol.geom.Circle.prototype.containsXY=function(a,b){var c=this.flatCoordinates;a-=c[0];b-=c[1];return a*a+b*b<=this.getRadiusSquared_()};ol.geom.Circle.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)};
ol.geom.Circle.prototype.computeExtent=function(a){var b=this.flatCoordinates,c=b[this.stride]-b[0];return ol.extent.createOrUpdate(b[0]-c,b[1]-c,b[0]+c,b[1]+c,a)};ol.geom.Circle.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())};ol.geom.Circle.prototype.getRadiusSquared_=function(){var a=this.flatCoordinates[this.stride]-this.flatCoordinates[0],b=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return a*a+b*b};ol.geom.Circle.prototype.getType=function(){return ol.geom.GeometryType.CIRCLE};
ol.geom.Circle.prototype.intersectsExtent=function(a){var b=this.getExtent();return ol.extent.intersects(a,b)?(b=this.getCenter(),a[0]<=b[0]&&a[2]>=b[0]||a[1]<=b[1]&&a[3]>=b[1]?!0:ol.extent.forEachCorner(a,this.intersectsCoordinate,this)):!1};ol.geom.Circle.prototype.setCenter=function(a){var b=this.stride,c=this.flatCoordinates[b]-this.flatCoordinates[0],d=a.slice();d[b]=d[0]+c;for(c=1;c<b;++c)d[b+c]=a[c];this.setFlatCoordinates(this.layout,d)};
ol.geom.Circle.prototype.setCenterAndRadius=function(a,b,c){if(a){this.setLayout(c,a,0);this.flatCoordinates||(this.flatCoordinates=[]);c=this.flatCoordinates;a=ol.geom.flat.deflate.coordinate(c,0,a,this.stride);c[a++]=c[0]+b;var d;b=1;for(d=this.stride;b<d;++b)c[a++]=c[b];c.length=a;this.changed()}else this.setFlatCoordinates(ol.geom.GeometryLayout.XY,null)};ol.geom.Circle.prototype.getCoordinates=function(){};ol.geom.Circle.prototype.setCoordinates=function(a,b){};
ol.geom.Circle.prototype.setFlatCoordinates=function(a,b){this.setFlatCoordinatesInternal(a,b);this.changed()};ol.geom.Circle.prototype.setRadius=function(a){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+a;this.changed()};ol.geom.GeometryCollection=function(a){ol.geom.Geometry.call(this);this.geometries_=a?a:null;this.listenGeometriesChange_()};ol.inherits(ol.geom.GeometryCollection,ol.geom.Geometry);ol.geom.GeometryCollection.cloneGeometries_=function(a){var b=[],c;var d=0;for(c=a.length;d<c;++d)b.push(a[d].clone());return b};
ol.geom.GeometryCollection.prototype.unlistenGeometriesChange_=function(){var a;if(this.geometries_){var b=0;for(a=this.geometries_.length;b<a;++b)ol.events.unlisten(this.geometries_[b],ol.events.EventType.CHANGE,this.changed,this)}};ol.geom.GeometryCollection.prototype.listenGeometriesChange_=function(){var a;if(this.geometries_){var b=0;for(a=this.geometries_.length;b<a;++b)ol.events.listen(this.geometries_[b],ol.events.EventType.CHANGE,this.changed,this)}};
ol.geom.GeometryCollection.prototype.clone=function(){var a=new ol.geom.GeometryCollection(null);a.setGeometries(this.geometries_);return a};ol.geom.GeometryCollection.prototype.closestPointXY=function(a,b,c,d){if(d<ol.extent.closestSquaredDistanceXY(this.getExtent(),a,b))return d;var e=this.geometries_,f;var g=0;for(f=e.length;g<f;++g)d=e[g].closestPointXY(a,b,c,d);return d};
ol.geom.GeometryCollection.prototype.containsXY=function(a,b){var c=this.geometries_,d;var e=0;for(d=c.length;e<d;++e)if(c[e].containsXY(a,b))return!0;return!1};ol.geom.GeometryCollection.prototype.computeExtent=function(a){ol.extent.createOrUpdateEmpty(a);for(var b=this.geometries_,c=0,d=b.length;c<d;++c)ol.extent.extend(a,b[c].getExtent());return a};ol.geom.GeometryCollection.prototype.getGeometries=function(){return ol.geom.GeometryCollection.cloneGeometries_(this.geometries_)};
ol.geom.GeometryCollection.prototype.getGeometriesArray=function(){return this.geometries_};
ol.geom.GeometryCollection.prototype.getSimplifiedGeometry=function(a){this.simplifiedGeometryRevision!=this.getRevision()&&(ol.obj.clear(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision());if(0>a||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&a<this.simplifiedGeometryMaxMinSquaredTolerance)return this;var b=a.toString();if(this.simplifiedGeometryCache.hasOwnProperty(b))return this.simplifiedGeometryCache[b];var c=
[],d=this.geometries_,e=!1,f;var g=0;for(f=d.length;g<f;++g){var h=d[g],k=h.getSimplifiedGeometry(a);c.push(k);k!==h&&(e=!0)}if(e)return a=new ol.geom.GeometryCollection(null),a.setGeometriesArray(c),this.simplifiedGeometryCache[b]=a;this.simplifiedGeometryMaxMinSquaredTolerance=a;return this};ol.geom.GeometryCollection.prototype.getType=function(){return ol.geom.GeometryType.GEOMETRY_COLLECTION};
ol.geom.GeometryCollection.prototype.intersectsExtent=function(a){var b=this.geometries_,c;var d=0;for(c=b.length;d<c;++d)if(b[d].intersectsExtent(a))return!0;return!1};ol.geom.GeometryCollection.prototype.isEmpty=function(){return 0===this.geometries_.length};ol.geom.GeometryCollection.prototype.rotate=function(a,b){for(var c=this.geometries_,d=0,e=c.length;d<e;++d)c[d].rotate(a,b);this.changed()};
ol.geom.GeometryCollection.prototype.scale=function(a,b,c){c||(c=ol.extent.getCenter(this.getExtent()));for(var d=this.geometries_,e=0,f=d.length;e<f;++e)d[e].scale(a,b,c);this.changed()};ol.geom.GeometryCollection.prototype.setGeometries=function(a){this.setGeometriesArray(ol.geom.GeometryCollection.cloneGeometries_(a))};ol.geom.GeometryCollection.prototype.setGeometriesArray=function(a){this.unlistenGeometriesChange_();this.geometries_=a;this.listenGeometriesChange_();this.changed()};
ol.geom.GeometryCollection.prototype.applyTransform=function(a){var b=this.geometries_,c;var d=0;for(c=b.length;d<c;++d)b[d].applyTransform(a);this.changed()};ol.geom.GeometryCollection.prototype.translate=function(a,b){var c=this.geometries_,d;var e=0;for(d=c.length;e<d;++e)c[e].translate(a,b);this.changed()};ol.geom.GeometryCollection.prototype.disposeInternal=function(){this.unlistenGeometriesChange_();ol.geom.Geometry.prototype.disposeInternal.call(this)};ol.interaction.Draw=function(a){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.Draw.handleDownEvent_,handleEvent:ol.interaction.Draw.handleEvent,handleUpEvent:ol.interaction.Draw.handleUpEvent_});this.shouldHandle_=!1;this.downPx_=null;this.freehand_=!1;this.source_=a.source?a.source:null;this.features_=a.features?a.features:null;this.snapTolerance_=a.snapTolerance?a.snapTolerance:12;this.type_=a.type;this.mode_=ol.interaction.Draw.getMode_(this.type_);this.minPoints_=a.minPoints?
a.minPoints:this.mode_===ol.interaction.Draw.Mode_.POLYGON?3:2;this.maxPoints_=a.maxPoints?a.maxPoints:Infinity;this.finishCondition_=a.finishCondition?a.finishCondition:ol.functions.TRUE;var b=a.geometryFunction;if(!b)if(this.type_===ol.geom.GeometryType.CIRCLE)b=function(a,b){b=b?b:new ol.geom.Circle([NaN,NaN]);var c=ol.coordinate.squaredDistance(a[0],a[1]);b.setCenterAndRadius(a[0],Math.sqrt(c));return b};else{var c=this.mode_;if(c===ol.interaction.Draw.Mode_.POINT)var d=ol.geom.Point;else c===
ol.interaction.Draw.Mode_.LINE_STRING?d=ol.geom.LineString:c===ol.interaction.Draw.Mode_.POLYGON&&(d=ol.geom.Polygon);b=function(a,b){b?c===ol.interaction.Draw.Mode_.POLYGON?b.setCoordinates([a[0].concat([a[0][0]])]):b.setCoordinates(a):b=new d(a);return b}}this.geometryFunction_=b;this.sketchLineCoords_=this.sketchLine_=this.sketchCoords_=this.sketchPoint_=this.sketchFeature_=this.finishCoordinate_=null;this.squaredClickTolerance_=a.clickTolerance?a.clickTolerance*a.clickTolerance:36;this.overlay_=
new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,wrapX:a.wrapX?a.wrapX:!1}),style:a.style?a.style:ol.interaction.Draw.getDefaultStyleFunction()});this.geometryName_=a.geometryName;this.condition_=a.condition?a.condition:ol.events.condition.noModifierKeys;this.freehandCondition_=a.freehand?ol.events.condition.always:a.freehandCondition?a.freehandCondition:ol.events.condition.shiftKeyOnly;ol.events.listen(this,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),this.updateState_,
this)};ol.inherits(ol.interaction.Draw,ol.interaction.Pointer);ol.interaction.Draw.getDefaultStyleFunction=function(){var a=ol.style.Style.createDefaultEditing();return function(b,c){return a[b.getGeometry().getType()]}};ol.interaction.Draw.prototype.setMap=function(a){ol.interaction.Pointer.prototype.setMap.call(this,a);this.updateState_()};
ol.interaction.Draw.handleEvent=function(a){this.freehand_=this.mode_!==ol.interaction.Draw.Mode_.POINT&&this.freehandCondition_(a);var b=!0;this.freehand_&&a.type===ol.MapBrowserEventType.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(a),b=!1):this.freehand_&&a.type===ol.MapBrowserEventType.POINTERDOWN?b=!1:a.type===ol.MapBrowserEventType.POINTERMOVE?b=this.handlePointerMove_(a):a.type===ol.MapBrowserEventType.DBLCLICK&&(b=!1);return ol.interaction.Pointer.handleEvent.call(this,a)&&
b};ol.interaction.Draw.handleDownEvent_=function(a){this.shouldHandle_=!this.freehand_;return this.freehand_?(this.downPx_=a.pixel,this.finishCoordinate_||this.startDrawing_(a),!0):this.condition_(a)?(this.downPx_=a.pixel,!0):!1};
ol.interaction.Draw.handleUpEvent_=function(a){var b=!0;this.handlePointerMove_(a);var c=this.mode_===ol.interaction.Draw.Mode_.CIRCLE;this.shouldHandle_?(this.finishCoordinate_?this.freehand_||c?this.finishDrawing():this.atFinish_(a)?this.finishCondition_(a)&&this.finishDrawing():this.addToDrawing_(a):(this.startDrawing_(a),this.mode_===ol.interaction.Draw.Mode_.POINT&&this.finishDrawing()),b=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_());return b};
ol.interaction.Draw.prototype.handlePointerMove_=function(a){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var b=this.downPx_,c=a.pixel,d=b[0]-c[0];b=b[1]-c[1];d=d*d+b*b;this.shouldHandle_=this.freehand_?d>this.squaredClickTolerance_:d<=this.squaredClickTolerance_}this.finishCoordinate_?this.modifyDrawing_(a):this.createOrUpdateSketchPoint_(a);return!0};
ol.interaction.Draw.prototype.atFinish_=function(a){var b=!1;if(this.sketchFeature_){var c=!1,d=[this.finishCoordinate_];this.mode_===ol.interaction.Draw.Mode_.LINE_STRING?c=this.sketchCoords_.length>this.minPoints_:this.mode_===ol.interaction.Draw.Mode_.POLYGON&&(c=this.sketchCoords_[0].length>this.minPoints_,d=[this.sketchCoords_[0][0],this.sketchCoords_[0][this.sketchCoords_[0].length-2]]);if(c){c=a.map;for(var e=0,f=d.length;e<f;e++){var g=d[e],h=c.getPixelFromCoordinate(g),k=a.pixel;b=k[0]-h[0];
h=k[1]-h[1];if(b=Math.sqrt(b*b+h*h)<=(this.freehand_?1:this.snapTolerance_)){this.finishCoordinate_=g;break}}}}return b};ol.interaction.Draw.prototype.createOrUpdateSketchPoint_=function(a){a=a.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(a):(this.sketchPoint_=new ol.Feature(new ol.geom.Point(a)),this.updateSketchFeatures_())};
ol.interaction.Draw.prototype.startDrawing_=function(a){this.finishCoordinate_=a=a.coordinate;this.mode_===ol.interaction.Draw.Mode_.POINT?this.sketchCoords_=a.slice():this.mode_===ol.interaction.Draw.Mode_.POLYGON?(this.sketchCoords_=[[a.slice(),a.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):(this.sketchCoords_=[a.slice(),a.slice()],this.mode_===ol.interaction.Draw.Mode_.CIRCLE&&(this.sketchLineCoords_=this.sketchCoords_));this.sketchLineCoords_&&(this.sketchLine_=new ol.Feature(new ol.geom.LineString(this.sketchLineCoords_)));
a=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new ol.Feature;this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_);this.sketchFeature_.setGeometry(a);this.updateSketchFeatures_();this.dispatchEvent(new ol.interaction.Draw.Event(ol.interaction.DrawEventType.DRAWSTART,this.sketchFeature_))};
ol.interaction.Draw.prototype.modifyDrawing_=function(a){var b=a.coordinate,c=this.sketchFeature_.getGeometry();if(this.mode_===ol.interaction.Draw.Mode_.POINT)var d=this.sketchCoords_;else this.mode_===ol.interaction.Draw.Mode_.POLYGON?(d=this.sketchCoords_[0],d=d[d.length-1],this.atFinish_(a)&&(b=this.finishCoordinate_.slice())):(d=this.sketchCoords_,d=d[d.length-1]);d[0]=b[0];d[1]=b[1];this.geometryFunction_(this.sketchCoords_,c);this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(b);
c instanceof ol.geom.Polygon&&this.mode_!==ol.interaction.Draw.Mode_.POLYGON?(this.sketchLine_||(this.sketchLine_=new ol.Feature(new ol.geom.LineString(null))),b=c.getLinearRing(0),a=this.sketchLine_.getGeometry(),a.setFlatCoordinates(b.getLayout(),b.getFlatCoordinates())):this.sketchLineCoords_&&(a=this.sketchLine_.getGeometry(),a.setCoordinates(this.sketchLineCoords_));this.updateSketchFeatures_()};
ol.interaction.Draw.prototype.addToDrawing_=function(a){a=a.coordinate;var b=this.sketchFeature_.getGeometry(),c;if(this.mode_===ol.interaction.Draw.Mode_.LINE_STRING){this.finishCoordinate_=a.slice();var d=this.sketchCoords_;d.length>=this.maxPoints_&&(this.freehand_?d.pop():c=!0);d.push(a.slice());this.geometryFunction_(d,b)}else this.mode_===ol.interaction.Draw.Mode_.POLYGON&&(d=this.sketchCoords_[0],d.length>=this.maxPoints_&&(this.freehand_?d.pop():c=!0),d.push(a.slice()),c&&(this.finishCoordinate_=
d[0]),this.geometryFunction_(this.sketchCoords_,b));this.updateSketchFeatures_();c&&this.finishDrawing()};
ol.interaction.Draw.prototype.removeLastPoint=function(){if(this.sketchFeature_){var a=this.sketchFeature_.getGeometry();if(this.mode_===ol.interaction.Draw.Mode_.LINE_STRING){var b=this.sketchCoords_;b.splice(-2,1);this.geometryFunction_(b,a);2<=b.length&&(this.finishCoordinate_=b[b.length-2].slice())}else if(this.mode_===ol.interaction.Draw.Mode_.POLYGON){b=this.sketchCoords_[0];b.splice(-2,1);var c=this.sketchLine_.getGeometry();c.setCoordinates(b);this.geometryFunction_(this.sketchCoords_,a)}0===
b.length&&(this.finishCoordinate_=null);this.updateSketchFeatures_()}};
ol.interaction.Draw.prototype.finishDrawing=function(){var a=this.abortDrawing_(),b=this.sketchCoords_,c=a.getGeometry();this.mode_===ol.interaction.Draw.Mode_.LINE_STRING?(b.pop(),this.geometryFunction_(b,c)):this.mode_===ol.interaction.Draw.Mode_.POLYGON&&(b[0].pop(),this.geometryFunction_(b,c),b=c.getCoordinates());this.type_===ol.geom.GeometryType.MULTI_POINT?a.setGeometry(new ol.geom.MultiPoint([b])):this.type_===ol.geom.GeometryType.MULTI_LINE_STRING?a.setGeometry(new ol.geom.MultiLineString([b])):
this.type_===ol.geom.GeometryType.MULTI_POLYGON&&a.setGeometry(new ol.geom.MultiPolygon([b]));this.dispatchEvent(new ol.interaction.Draw.Event(ol.interaction.DrawEventType.DRAWEND,a));this.features_&&this.features_.push(a);this.source_&&this.source_.addFeature(a)};ol.interaction.Draw.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var a=this.sketchFeature_;a&&(this.sketchLine_=this.sketchPoint_=this.sketchFeature_=null,this.overlay_.getSource().clear(!0));return a};
ol.interaction.Draw.prototype.extend=function(a){var b=a.getGeometry();this.sketchFeature_=a;this.sketchCoords_=b.getCoordinates();a=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=a.slice();this.sketchCoords_.push(a.slice());this.updateSketchFeatures_();this.dispatchEvent(new ol.interaction.Draw.Event(ol.interaction.DrawEventType.DRAWSTART,this.sketchFeature_))};ol.interaction.Draw.prototype.shouldStopEvent=ol.functions.FALSE;
ol.interaction.Draw.prototype.updateSketchFeatures_=function(){var a=[];this.sketchFeature_&&a.push(this.sketchFeature_);this.sketchLine_&&a.push(this.sketchLine_);this.sketchPoint_&&a.push(this.sketchPoint_);var b=this.overlay_.getSource();b.clear(!0);b.addFeatures(a)};ol.interaction.Draw.prototype.updateState_=function(){var a=this.getMap(),b=this.getActive();a&&b||this.abortDrawing_();this.overlay_.setMap(b?a:null)};
ol.interaction.Draw.createRegularPolygon=function(a,b){return function(c,d){var e=c[0];c=c[1];var f=Math.sqrt(ol.coordinate.squaredDistance(e,c));d=d?d:ol.geom.Polygon.fromCircle(new ol.geom.Circle(e),a);ol.geom.Polygon.makeRegular(d,e,f,b?b:Math.atan((c[1]-e[1])/(c[0]-e[0])));return d}};
ol.interaction.Draw.createBox=function(){return function(a,b){a=ol.extent.boundingExtent(a);b=b||new ol.geom.Polygon(null);b.setCoordinates([[ol.extent.getBottomLeft(a),ol.extent.getBottomRight(a),ol.extent.getTopRight(a),ol.extent.getTopLeft(a),ol.extent.getBottomLeft(a)]]);return b}};
ol.interaction.Draw.getMode_=function(a){if(a===ol.geom.GeometryType.POINT||a===ol.geom.GeometryType.MULTI_POINT)var b=ol.interaction.Draw.Mode_.POINT;else a===ol.geom.GeometryType.LINE_STRING||a===ol.geom.GeometryType.MULTI_LINE_STRING?b=ol.interaction.Draw.Mode_.LINE_STRING:a===ol.geom.GeometryType.POLYGON||a===ol.geom.GeometryType.MULTI_POLYGON?b=ol.interaction.Draw.Mode_.POLYGON:a===ol.geom.GeometryType.CIRCLE&&(b=ol.interaction.Draw.Mode_.CIRCLE);return b};
ol.interaction.Draw.Mode_={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"};ol.interaction.Draw.Event=function(a,b){ol.events.Event.call(this,a);this.feature=b};ol.inherits(ol.interaction.Draw.Event,ol.events.Event);ngeo.interaction.MeasureAzimut=function(a,b,c){c=c||{};ngeo.interaction.Measure.call(this,c);void 0!==c.continueMsg?this.continueMsg=c.continueMsg:(this.continueMsg=document.createElement("span"),this.continueMsg.textContent="Click to finish.");this.numberFormat=goog.asserts.assert(b);this.unitPrefixFormat=goog.asserts.assert(a)};ol.inherits(ngeo.interaction.MeasureAzimut,ngeo.interaction.Measure);goog.exportSymbol("ngeo.interaction.MeasureAzimut",ngeo.interaction.MeasureAzimut);
ngeo.interaction.MeasureAzimut.prototype.createDrawInteraction=function(a,b){return new ngeo.interaction.DrawAzimut({source:b,style:a})};
ngeo.interaction.MeasureAzimut.prototype.handleMeasure=function(a){var b=goog.asserts.assertInstanceof(this.sketchFeature.getGeometry(),ol.geom.GeometryCollection);b=goog.asserts.assertInstanceof(b.getGeometries()[0],ol.geom.LineString);var c=ngeo.interaction.MeasureAzimut.getFormattedAzimutRadius(b,goog.asserts.assertInstanceof(this.getMap().getView().getProjection(),ol.proj.Projection),this.decimals,this.precision,this.unitPrefixFormat,this.numberFormat);a(c,b.getLastCoordinate())};
ngeo.interaction.MeasureAzimut.getFormattedAzimutRadius=function(a,b,c,d,e,f){c=ngeo.interaction.MeasureAzimut.getFormattedAzimut(a,c,f);return c+=", "+ngeo.interaction.Measure.getFormattedLength(a,b,d,e)};ngeo.interaction.MeasureAzimut.getFormattedAzimut=function(a,b,c){a=ngeo.interaction.MeasureAzimut.getAzimut(a);return c(a,b)+"\u00b0"};
ngeo.interaction.MeasureAzimut.getAzimut=function(a){var b=a.getCoordinates();a=b[1][0]-b[0][0];b=b[1][1]-b[0][1];return(0<a?1:-1)*Math.acos(b/Math.sqrt(a*a+b*b))*180/Math.PI%360};
ngeo.interaction.DrawAzimut=function(a){ol.interaction.Pointer.call(this,{handleDownEvent:ngeo.interaction.DrawAzimut.handleDownEvent_,handleEvent:ngeo.interaction.DrawAzimut.handleEvent_,handleUpEvent:ngeo.interaction.DrawAzimut.handleUpEvent_});this.downPx_=null;this.source_=void 0!==a.source?a.source:null;this.started_=!1;this.sketchPoint_=this.sketchFeature_=null;this.squaredClickTolerance_=4;this.sketchLayer_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,wrapX:!1}),style:void 0!==
a.style?a.style:ol.interaction.Draw.getDefaultStyleFunction()});ol.events.listen(this,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),this.updateState_,this)};ol.inherits(ngeo.interaction.DrawAzimut,ol.interaction.Pointer);goog.exportSymbol("ngeo.interaction.DrawAzimut",ngeo.interaction.DrawAzimut);ngeo.interaction.DrawAzimut.handleDownEvent_=function(a){this.downPx_=a.pixel;return!0};
ngeo.interaction.DrawAzimut.handleUpEvent_=function(a){var b=this.downPx_,c=a.pixel,d=b[0]-c[0];b=b[1]-c[1];c=!0;d*d+b*b<=this.squaredClickTolerance_&&(this.handlePointerMove_(a),this.started_?this.finishDrawing_():this.startDrawing_(a),c=!1);return c};ngeo.interaction.DrawAzimut.handleEvent_=function(a){var b=!0;a.type===ol.MapBrowserEventType.POINTERMOVE?b=this.handlePointerMove_(a):a.type===ol.MapBrowserEventType.DBLCLICK&&(b=!1);return ol.interaction.Pointer.handleEvent.call(this,a)&&b};
ngeo.interaction.DrawAzimut.prototype.handlePointerMove_=function(a){this.started_?this.modifyDrawing_(a):this.createOrUpdateSketchPoint_(a);return!0};ngeo.interaction.DrawAzimut.prototype.createOrUpdateSketchPoint_=function(a){a=a.coordinate.slice();if(null===this.sketchPoint_)this.sketchPoint_=new ol.Feature(new ol.geom.Point(a)),this.updateSketchFeatures_();else{var b=this.sketchPoint_.getGeometry();goog.asserts.assertInstanceof(b,ol.geom.Point);b.setCoordinates(a)}};
ngeo.interaction.DrawAzimut.prototype.updateSketchFeatures_=function(){var a=[];null!==this.sketchFeature_&&a.push(this.sketchFeature_);null!==this.sketchPoint_&&a.push(this.sketchPoint_);var b=this.sketchLayer_.getSource();b.clear(!0);b.addFeatures(a)};
ngeo.interaction.DrawAzimut.prototype.startDrawing_=function(a){var b=a.coordinate;this.started_=!0;a=new ol.geom.LineString([b.slice(),b.slice()]);b=new ol.geom.Circle(b,0);a=new ol.geom.GeometryCollection([a,b]);goog.asserts.assert(void 0!==a);this.sketchFeature_=new ol.Feature;this.sketchFeature_.setGeometry(a);this.updateSketchFeatures_();this.dispatchEvent(new ol.interaction.Draw.Event(ol.interaction.DrawEventType.DRAWSTART,this.sketchFeature_))};
ngeo.interaction.DrawAzimut.prototype.modifyDrawing_=function(a){a=a.coordinate;var b=goog.asserts.assertInstanceof(this.sketchFeature_.getGeometry(),ol.geom.GeometryCollection).getGeometriesArray(),c=b[0];goog.asserts.assertInstanceof(c,ol.geom.LineString);var d=c.getCoordinates(),e=this.sketchPoint_.getGeometry();goog.asserts.assertInstanceof(e,ol.geom.Point);e.setCoordinates(a);e=d[d.length-1];e[0]=a[0];e[1]=a[1];goog.asserts.assertInstanceof(c,ol.geom.LineString);c.setCoordinates(d);goog.asserts.assertInstanceof(b[1],
ol.geom.Circle).setRadius(c.getLength());this.updateSketchFeatures_()};ngeo.interaction.DrawAzimut.prototype.abortDrawing_=function(){this.started_=!1;var a=this.sketchFeature_;null!==a&&(this.sketchPoint_=this.sketchFeature_=null,this.sketchLayer_.getSource().clear(!0));return a};ngeo.interaction.DrawAzimut.prototype.shouldStopEvent=ol.functions.FALSE;
ngeo.interaction.DrawAzimut.prototype.updateState_=function(){var a=this.getMap(),b=this.getActive();null!==a&&b||this.abortDrawing_();this.sketchLayer_.setMap(b?a:null)};ngeo.interaction.DrawAzimut.prototype.finishDrawing_=function(){var a=this.abortDrawing_();goog.asserts.assert(null!==a);null!==this.source_&&this.source_.addFeature(a);this.dispatchEvent(new ol.interaction.Draw.Event(ol.interaction.DrawEventType.DRAWEND,a))};
ngeo.interaction.DrawAzimut.prototype.setMap=function(a){ol.interaction.Pointer.prototype.setMap.call(this,a);this.updateState_()};ngeo.downloadFactory_=function(){return function(a,b,c){c=void 0===c||ngeo.utils.isSafari()?"text/plain;charset=utf-8":c;a=new Blob([a],{type:c});saveAs(a,b)}};ngeo.module.factory("ngeoDownload",ngeo.downloadFactory_);ol.format.GPX=function(a){a=a?a:{};ol.format.XMLFeature.call(this);this.defaultDataProjection=ol.proj.get("EPSG:4326");this.readExtensions_=a.readExtensions};ol.inherits(ol.format.GPX,ol.format.XMLFeature);ol.format.GPX.NAMESPACE_URIS_=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"];ol.format.GPX.SCHEMA_LOCATION_="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd";
ol.format.GPX.appendCoordinate_=function(a,b,c,d){a.push(parseFloat(c.getAttribute("lon")),parseFloat(c.getAttribute("lat")));"ele"in d?(a.push(d.ele),delete d.ele,b.hasZ=!0):a.push(0);"time"in d?(a.push(d.time),delete d.time,b.hasM=!0):a.push(0);return a};
ol.format.GPX.applyLayoutOptions_=function(a,b,c){var d=ol.geom.GeometryLayout.XY,e=2;a.hasZ&&a.hasM?(d=ol.geom.GeometryLayout.XYZM,e=4):a.hasZ?(d=ol.geom.GeometryLayout.XYZ,e=3):a.hasM&&(d=ol.geom.GeometryLayout.XYM,e=3);if(4!==e){var f;var g=0;for(f=b.length/4;g<f;g++)b[g*e]=b[4*g],b[g*e+1]=b[4*g+1],a.hasZ&&(b[g*e+2]=b[4*g+2]),a.hasM&&(b[g*e+2]=b[4*g+3]);b.length=b.length/4*e;if(c)for(g=0,f=c.length;g<f;g++)c[g]=c[g]/4*e}return d};
ol.format.GPX.parseLink_=function(a,b){var c=b[b.length-1],d=a.getAttribute("href");null!==d&&(c.link=d);ol.xml.parseNode(ol.format.GPX.LINK_PARSERS_,a,b)};ol.format.GPX.parseExtensions_=function(a,b){b[b.length-1].extensionsNode_=a};ol.format.GPX.parseRtePt_=function(a,b){var c=ol.xml.pushParseAndPop({},ol.format.GPX.RTEPT_PARSERS_,a,b);c&&(b=b[b.length-1],ol.format.GPX.appendCoordinate_(b.flatCoordinates,b.layoutOptions,a,c))};
ol.format.GPX.parseTrkPt_=function(a,b){var c=ol.xml.pushParseAndPop({},ol.format.GPX.TRKPT_PARSERS_,a,b);c&&(b=b[b.length-1],ol.format.GPX.appendCoordinate_(b.flatCoordinates,b.layoutOptions,a,c))};ol.format.GPX.parseTrkSeg_=function(a,b){var c=b[b.length-1];ol.xml.parseNode(ol.format.GPX.TRKSEG_PARSERS_,a,b);c.ends.push(c.flatCoordinates.length)};
ol.format.GPX.readRte_=function(a,b){var c=b[0];if(a=ol.xml.pushParseAndPop({flatCoordinates:[],layoutOptions:{}},ol.format.GPX.RTE_PARSERS_,a,b)){b=a.flatCoordinates;delete a.flatCoordinates;var d=a.layoutOptions;delete a.layoutOptions;d=ol.format.GPX.applyLayoutOptions_(d,b);var e=new ol.geom.LineString(null);e.setFlatCoordinates(d,b);ol.format.Feature.transformWithOptions(e,!1,c);c=new ol.Feature(e);c.setProperties(a);return c}};
ol.format.GPX.readTrk_=function(a,b){var c=b[0];if(a=ol.xml.pushParseAndPop({flatCoordinates:[],ends:[],layoutOptions:{}},ol.format.GPX.TRK_PARSERS_,a,b)){b=a.flatCoordinates;delete a.flatCoordinates;var d=a.ends;delete a.ends;var e=a.layoutOptions;delete a.layoutOptions;e=ol.format.GPX.applyLayoutOptions_(e,b,d);var f=new ol.geom.MultiLineString(null);f.setFlatCoordinates(e,b,d);ol.format.Feature.transformWithOptions(f,!1,c);c=new ol.Feature(f);c.setProperties(a);return c}};
ol.format.GPX.readWpt_=function(a,b){var c=b[0];if(b=ol.xml.pushParseAndPop({},ol.format.GPX.WPT_PARSERS_,a,b)){var d={};a=ol.format.GPX.appendCoordinate_([],d,a,b);d=ol.format.GPX.applyLayoutOptions_(d,a);a=new ol.geom.Point(a,d);ol.format.Feature.transformWithOptions(a,!1,c);c=new ol.Feature(a);c.setProperties(b);return c}};ol.format.GPX.FEATURE_READER_={rte:ol.format.GPX.readRte_,trk:ol.format.GPX.readTrk_,wpt:ol.format.GPX.readWpt_};
ol.format.GPX.GPX_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{rte:ol.xml.makeArrayPusher(ol.format.GPX.readRte_),trk:ol.xml.makeArrayPusher(ol.format.GPX.readTrk_),wpt:ol.xml.makeArrayPusher(ol.format.GPX.readWpt_)});ol.format.GPX.LINK_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{text:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString,"linkText"),type:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString,"linkType")});
ol.format.GPX.RTE_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),cmt:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),desc:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),src:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),link:ol.format.GPX.parseLink_,number:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),extensions:ol.format.GPX.parseExtensions_,type:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),
rtept:ol.format.GPX.parseRtePt_});ol.format.GPX.RTEPT_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{ele:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),time:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDateTime)});
ol.format.GPX.TRK_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),cmt:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),desc:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),src:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),link:ol.format.GPX.parseLink_,number:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),type:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),
extensions:ol.format.GPX.parseExtensions_,trkseg:ol.format.GPX.parseTrkSeg_});ol.format.GPX.TRKSEG_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{trkpt:ol.format.GPX.parseTrkPt_});ol.format.GPX.TRKPT_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{ele:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),time:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDateTime)});
ol.format.GPX.WPT_PARSERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{ele:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),time:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDateTime),magvar:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),geoidheight:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),cmt:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),desc:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),
src:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),link:ol.format.GPX.parseLink_,sym:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),type:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),fix:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),sat:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),hdop:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),vdop:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),pdop:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),
ageofdgpsdata:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),dgpsid:ol.xml.makeObjectPropertySetter(ol.format.XSD.readNonNegativeInteger),extensions:ol.format.GPX.parseExtensions_});ol.format.GPX.prototype.handleReadExtensions_=function(a){a||(a=[]);for(var b=0,c=a.length;b<c;++b){var d=a[b];if(this.readExtensions_){var e=d.get("extensionsNode_")||null;this.readExtensions_(d,e)}d.set("extensionsNode_",void 0)}};
ol.format.GPX.prototype.readFeatureFromNode=function(a,b){if(!ol.array.includes(ol.format.GPX.NAMESPACE_URIS_,a.namespaceURI))return null;var c=ol.format.GPX.FEATURE_READER_[a.localName];if(!c)return null;a=c(a,[this.getReadOptions(a,b)]);if(!a)return null;this.handleReadExtensions_([a]);return a};
ol.format.GPX.prototype.readFeaturesFromNode=function(a,b){return ol.array.includes(ol.format.GPX.NAMESPACE_URIS_,a.namespaceURI)?"gpx"==a.localName&&(a=ol.xml.pushParseAndPop([],ol.format.GPX.GPX_PARSERS_,a,[this.getReadOptions(a,b)]))?(this.handleReadExtensions_(a),a):[]:[]};
ol.format.GPX.writeLink_=function(a,b,c){a.setAttribute("href",b);b=c[c.length-1].properties;ol.xml.pushSerializeAndPop({node:a},ol.format.GPX.LINK_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[b.linkText,b.linkType],c,ol.format.GPX.LINK_SEQUENCE_)};
ol.format.GPX.writeWptType_=function(a,b,c){var d=c[c.length-1],e=d.node.namespaceURI,f=d.properties;ol.xml.setAttributeNS(a,null,"lat",b[1]);ol.xml.setAttributeNS(a,null,"lon",b[0]);switch(d.geometryLayout){case ol.geom.GeometryLayout.XYZM:0!==b[3]&&(f.time=b[3]);case ol.geom.GeometryLayout.XYZ:0!==b[2]&&(f.ele=b[2]);break;case ol.geom.GeometryLayout.XYM:0!==b[2]&&(f.time=b[2])}b="rtept"==a.nodeName?ol.format.GPX.RTEPT_TYPE_SEQUENCE_[e]:ol.format.GPX.WPT_TYPE_SEQUENCE_[e];d=ol.xml.makeSequence(f,
b);ol.xml.pushSerializeAndPop({node:a,properties:f},ol.format.GPX.WPT_TYPE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,d,c,b)};
ol.format.GPX.writeRte_=function(a,b,c){var d=c[0],e=b.getProperties();a={node:a,properties:e};if(b=b.getGeometry())b=ol.format.Feature.transformWithOptions(b,!0,d),a.geometryLayout=b.getLayout(),e.rtept=b.getCoordinates();d=ol.format.GPX.RTE_SEQUENCE_[c[c.length-1].node.namespaceURI];e=ol.xml.makeSequence(e,d);ol.xml.pushSerializeAndPop(a,ol.format.GPX.RTE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,e,c,d)};
ol.format.GPX.writeTrk_=function(a,b,c){var d=c[0],e=b.getProperties();a={node:a,properties:e};if(b=b.getGeometry())b=ol.format.Feature.transformWithOptions(b,!0,d),e.trkseg=b.getLineStrings();d=ol.format.GPX.TRK_SEQUENCE_[c[c.length-1].node.namespaceURI];e=ol.xml.makeSequence(e,d);ol.xml.pushSerializeAndPop(a,ol.format.GPX.TRK_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,e,c,d)};
ol.format.GPX.writeTrkSeg_=function(a,b,c){a={node:a,geometryLayout:b.getLayout(),properties:{}};ol.xml.pushSerializeAndPop(a,ol.format.GPX.TRKSEG_SERIALIZERS_,ol.format.GPX.TRKSEG_NODE_FACTORY_,b.getCoordinates(),c)};ol.format.GPX.writeWpt_=function(a,b,c){var d=c[0],e=c[c.length-1];e.properties=b.getProperties();if(b=b.getGeometry())b=ol.format.Feature.transformWithOptions(b,!0,d),e.geometryLayout=b.getLayout(),ol.format.GPX.writeWptType_(a,b.getCoordinates(),c)};
ol.format.GPX.LINK_SEQUENCE_=["text","type"];ol.format.GPX.LINK_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{text:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),type:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)});ol.format.GPX.RTE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,"name cmt desc src link number type rtept".split(" "));
ol.format.GPX.RTE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{name:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),cmt:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),desc:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),src:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),link:ol.xml.makeChildAppender(ol.format.GPX.writeLink_),number:ol.xml.makeChildAppender(ol.format.XSD.writeNonNegativeIntegerTextNode),type:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),
rtept:ol.xml.makeArraySerializer(ol.xml.makeChildAppender(ol.format.GPX.writeWptType_))});ol.format.GPX.RTEPT_TYPE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,["ele","time"]);ol.format.GPX.TRK_SEQUENCE_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,"name cmt desc src link number type trkseg".split(" "));
ol.format.GPX.TRK_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{name:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),cmt:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),desc:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),src:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),link:ol.xml.makeChildAppender(ol.format.GPX.writeLink_),number:ol.xml.makeChildAppender(ol.format.XSD.writeNonNegativeIntegerTextNode),type:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),
trkseg:ol.xml.makeArraySerializer(ol.xml.makeChildAppender(ol.format.GPX.writeTrkSeg_))});ol.format.GPX.TRKSEG_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("trkpt");ol.format.GPX.TRKSEG_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{trkpt:ol.xml.makeChildAppender(ol.format.GPX.writeWptType_)});ol.format.GPX.WPT_TYPE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,"ele time magvar geoidheight name cmt desc src link sym type fix sat hdop vdop pdop ageofdgpsdata dgpsid".split(" "));
ol.format.GPX.WPT_TYPE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{ele:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),time:ol.xml.makeChildAppender(ol.format.XSD.writeDateTimeTextNode),magvar:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),geoidheight:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),name:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),cmt:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),desc:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),
src:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),link:ol.xml.makeChildAppender(ol.format.GPX.writeLink_),sym:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),type:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),fix:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),sat:ol.xml.makeChildAppender(ol.format.XSD.writeNonNegativeIntegerTextNode),hdop:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),vdop:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),
pdop:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),ageofdgpsdata:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),dgpsid:ol.xml.makeChildAppender(ol.format.XSD.writeNonNegativeIntegerTextNode)});ol.format.GPX.GEOMETRY_TYPE_TO_NODENAME_={Point:"wpt",LineString:"rte",MultiLineString:"trk"};
ol.format.GPX.GPX_NODE_FACTORY_=function(a,b,c){if(a=a.getGeometry())if(a=ol.format.GPX.GEOMETRY_TYPE_TO_NODENAME_[a.getType()])return ol.xml.createElementNS(b[b.length-1].node.namespaceURI,a)};ol.format.GPX.GPX_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.GPX.NAMESPACE_URIS_,{rte:ol.xml.makeChildAppender(ol.format.GPX.writeRte_),trk:ol.xml.makeChildAppender(ol.format.GPX.writeTrk_),wpt:ol.xml.makeChildAppender(ol.format.GPX.writeWpt_)});
ol.format.GPX.prototype.writeFeaturesNode=function(a,b){b=this.adaptOptions(b);var c=ol.xml.createElementNS("http://www.topografix.com/GPX/1/1","gpx");ol.xml.setAttributeNS(c,"http://www.w3.org/2000/xmlns/","xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");ol.xml.setAttributeNS(c,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",ol.format.GPX.SCHEMA_LOCATION_);c.setAttribute("version","1.1");c.setAttribute("creator","OpenLayers");ol.xml.pushSerializeAndPop({node:c},ol.format.GPX.GPX_SERIALIZERS_,
ol.format.GPX.GPX_NODE_FACTORY_,a,[b]);return c};ol.style.Text=function(a){a=a||{};this.font_=a.font;this.rotation_=a.rotation;this.rotateWithView_=a.rotateWithView;this.scale_=a.scale;this.text_=a.text;this.textAlign_=a.textAlign;this.textBaseline_=a.textBaseline;this.fill_=void 0!==a.fill?a.fill:new ol.style.Fill({color:ol.style.Text.DEFAULT_FILL_COLOR_});this.maxAngle_=void 0!==a.maxAngle?a.maxAngle:Math.PI/4;this.placement_=void 0!==a.placement?a.placement:ol.style.TextPlacement.POINT;this.exceedLength_=void 0!==a.exceedLength?a.exceedLength:
!1;this.stroke_=void 0!==a.stroke?a.stroke:null;this.offsetX_=void 0!==a.offsetX?a.offsetX:0;this.offsetY_=void 0!==a.offsetY?a.offsetY:0};ol.style.Text.DEFAULT_FILL_COLOR_="#333";
ol.style.Text.prototype.clone=function(){return new ol.style.Text({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),exceedLength:this.getExceedLength(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY()})};
ol.style.Text.prototype.getExceedLength=function(){return this.exceedLength_};ol.style.Text.prototype.getFont=function(){return this.font_};ol.style.Text.prototype.getMaxAngle=function(){return this.maxAngle_};ol.style.Text.prototype.getPlacement=function(){return this.placement_};ol.style.Text.prototype.getOffsetX=function(){return this.offsetX_};ol.style.Text.prototype.getOffsetY=function(){return this.offsetY_};ol.style.Text.prototype.getFill=function(){return this.fill_};
ol.style.Text.prototype.getRotateWithView=function(){return this.rotateWithView_};ol.style.Text.prototype.getRotation=function(){return this.rotation_};ol.style.Text.prototype.getScale=function(){return this.scale_};ol.style.Text.prototype.getStroke=function(){return this.stroke_};ol.style.Text.prototype.getText=function(){return this.text_};ol.style.Text.prototype.getTextAlign=function(){return this.textAlign_};ol.style.Text.prototype.getTextBaseline=function(){return this.textBaseline_};
ol.style.Text.prototype.setExceedLength=function(a){this.exceedLength_=a};ol.style.Text.prototype.setFont=function(a){this.font_=a};ol.style.Text.prototype.setMaxAngle=function(a){this.maxAngle_=a};ol.style.Text.prototype.setOffsetX=function(a){this.offsetX_=a};ol.style.Text.prototype.setOffsetY=function(a){this.offsetY_=a};ol.style.Text.prototype.setPlacement=function(a){this.placement_=a};ol.style.Text.prototype.setFill=function(a){this.fill_=a};
ol.style.Text.prototype.setRotation=function(a){this.rotation_=a};ol.style.Text.prototype.setScale=function(a){this.scale_=a};ol.style.Text.prototype.setStroke=function(a){this.stroke_=a};ol.style.Text.prototype.setText=function(a){this.text_=a};ol.style.Text.prototype.setTextAlign=function(a){this.textAlign_=a};ol.style.Text.prototype.setTextBaseline=function(a){this.textBaseline_=a};ol.format.KML=function(a){a=a?a:{};ol.format.XMLFeature.call(this);ol.format.KML.DEFAULT_STYLE_ARRAY_||ol.format.KML.createStyleDefaults_();this.defaultDataProjection=ol.proj.get("EPSG:4326");this.defaultStyle_=a.defaultStyle?a.defaultStyle:ol.format.KML.DEFAULT_STYLE_ARRAY_;this.extractStyles_=void 0!==a.extractStyles?a.extractStyles:!0;this.writeStyles_=void 0!==a.writeStyles?a.writeStyles:!0;this.sharedStyles_={};this.showPointNames_=void 0!==a.showPointNames?a.showPointNames:!0};
ol.inherits(ol.format.KML,ol.format.XMLFeature);ol.format.KML.GX_NAMESPACE_URIS_=["http://www.google.com/kml/ext/2.2"];ol.format.KML.NAMESPACE_URIS_=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"];ol.format.KML.SCHEMA_LOCATION_="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd";
ol.format.KML.createStyleDefaults_=function(){ol.format.KML.DEFAULT_COLOR_=[255,255,255,1];ol.format.KML.DEFAULT_FILL_STYLE_=new ol.style.Fill({color:ol.format.KML.DEFAULT_COLOR_});ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_=[20,2];ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS_=ol.style.IconAnchorUnits.PIXELS;ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS_=ol.style.IconAnchorUnits.PIXELS;ol.format.KML.DEFAULT_IMAGE_STYLE_SIZE_=[64,64];ol.format.KML.DEFAULT_IMAGE_STYLE_SRC_="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png";
ol.format.KML.DEFAULT_IMAGE_SCALE_MULTIPLIER_=.5;ol.format.KML.DEFAULT_IMAGE_STYLE_=new ol.style.Icon({anchor:ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_,anchorOrigin:ol.style.IconOrigin.BOTTOM_LEFT,anchorXUnits:ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS_,anchorYUnits:ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS_,crossOrigin:"anonymous",rotation:0,scale:ol.format.KML.DEFAULT_IMAGE_SCALE_MULTIPLIER_,size:ol.format.KML.DEFAULT_IMAGE_STYLE_SIZE_,src:ol.format.KML.DEFAULT_IMAGE_STYLE_SRC_});ol.format.KML.DEFAULT_NO_IMAGE_STYLE_=
"NO_IMAGE";ol.format.KML.DEFAULT_STROKE_STYLE_=new ol.style.Stroke({color:ol.format.KML.DEFAULT_COLOR_,width:1});ol.format.KML.DEFAULT_TEXT_STROKE_STYLE_=new ol.style.Stroke({color:[51,51,51,1],width:2});ol.format.KML.DEFAULT_TEXT_STYLE_=new ol.style.Text({font:"bold 16px Helvetica",fill:ol.format.KML.DEFAULT_FILL_STYLE_,stroke:ol.format.KML.DEFAULT_TEXT_STROKE_STYLE_,scale:.8});ol.format.KML.DEFAULT_STYLE_=new ol.style.Style({fill:ol.format.KML.DEFAULT_FILL_STYLE_,image:ol.format.KML.DEFAULT_IMAGE_STYLE_,
text:ol.format.KML.DEFAULT_TEXT_STYLE_,stroke:ol.format.KML.DEFAULT_STROKE_STYLE_,zIndex:0});ol.format.KML.DEFAULT_STYLE_ARRAY_=[ol.format.KML.DEFAULT_STYLE_];return ol.format.KML.DEFAULT_STYLE_ARRAY_};ol.format.KML.ICON_ANCHOR_UNITS_MAP_={fraction:ol.style.IconAnchorUnits.FRACTION,pixels:ol.style.IconAnchorUnits.PIXELS,insetPixels:ol.style.IconAnchorUnits.PIXELS};
ol.format.KML.createNameStyleFunction_=function(a,b){var c=[0,0],d="start";if(a.getImage()){var e=a.getImage().getImageSize();null===e&&(e=ol.format.KML.DEFAULT_IMAGE_STYLE_SIZE_);2==e.length&&(d=a.getImage().getScale(),c[0]=d*e[0]/2,c[1]=-d*e[1]/2,d="left")}null!==a.getText()?(e=a.getText(),a=e.clone(),a.setFont(e.getFont()||ol.format.KML.DEFAULT_TEXT_STYLE_.getFont()),a.setScale(e.getScale()||ol.format.KML.DEFAULT_TEXT_STYLE_.getScale()),a.setFill(e.getFill()||ol.format.KML.DEFAULT_TEXT_STYLE_.getFill()),
a.setStroke(e.getStroke()||ol.format.KML.DEFAULT_TEXT_STROKE_STYLE_)):a=ol.format.KML.DEFAULT_TEXT_STYLE_.clone();a.setText(b);a.setOffsetX(c[0]);a.setOffsetY(c[1]);a.setTextAlign(d);return new ol.style.Style({text:a})};
ol.format.KML.createFeatureStyleFunction_=function(a,b,c,d,e){return function(f){var g=e,h="";g&&this.getGeometry()&&(g=this.getGeometry().getType()===ol.geom.GeometryType.POINT);g&&(h=this.get("name"),g=g&&h);return a?g?(g=ol.format.KML.createNameStyleFunction_(a[0],h),a.concat(g)):a:b?(f=ol.format.KML.findStyle_(b,c,d),g?(g=ol.format.KML.createNameStyleFunction_(f[0],h),f.concat(g)):f):g?(g=ol.format.KML.createNameStyleFunction_(c[0],h),c.concat(g)):c}};
ol.format.KML.findStyle_=function(a,b,c){return Array.isArray(a)?a:"string"===typeof a?(!(a in c)&&"#"+a in c&&(a="#"+a),ol.format.KML.findStyle_(c[a],b,c)):b};ol.format.KML.readColor_=function(a){a=ol.xml.getAllTextContent(a,!1);if(a=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(a))return a=a[1],[parseInt(a.substr(6,2),16),parseInt(a.substr(4,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(0,2),16)/255]};
ol.format.KML.readFlatCoordinates_=function(a){a=ol.xml.getAllTextContent(a,!1);for(var b=[],c=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i,d;d=c.exec(a);){var e=parseFloat(d[1]),f=parseFloat(d[2]),g=d[3]?parseFloat(d[3]):0;b.push(e,f,g);a=a.substr(d[0].length)}if(""===a)return b};
ol.format.KML.readURI_=function(a){var b=ol.xml.getAllTextContent(a,!1).trim();a=a.baseURI;a&&"about:blank"!=a||(a=window.location.href);return a?(new URL(b,a)).href:b};
ol.format.KML.readVec2_=function(a){var b=a.getAttribute("xunits"),c=a.getAttribute("yunits");var d="insetPixels"!==b?"insetPixels"!==c?ol.style.IconOrigin.BOTTOM_LEFT:ol.style.IconOrigin.TOP_LEFT:"insetPixels"!==c?ol.style.IconOrigin.BOTTOM_RIGHT:ol.style.IconOrigin.TOP_RIGHT;return{x:parseFloat(a.getAttribute("x")),xunits:ol.format.KML.ICON_ANCHOR_UNITS_MAP_[b],y:parseFloat(a.getAttribute("y")),yunits:ol.format.KML.ICON_ANCHOR_UNITS_MAP_[c],origin:d}};ol.format.KML.readScale_=function(a){return ol.format.XSD.readDecimal(a)};
ol.format.KML.readStyleMapValue_=function(a,b){return ol.xml.pushParseAndPop(void 0,ol.format.KML.STYLE_MAP_PARSERS_,a,b)};
ol.format.KML.IconStyleParser_=function(a,b){if(a=ol.xml.pushParseAndPop({},ol.format.KML.ICON_STYLE_PARSERS_,a,b)){b=b[b.length-1];var c="Icon"in a?a.Icon:{},d=!("Icon"in a)||0<Object.keys(c).length,e=c.href;if(e)var f=e;else d&&(f=ol.format.KML.DEFAULT_IMAGE_STYLE_SRC_);e=ol.style.IconOrigin.BOTTOM_LEFT;var g=a.hotSpot;if(g){var h=[g.x,g.y];var k=g.xunits;var l=g.yunits;e=g.origin}else f===ol.format.KML.DEFAULT_IMAGE_STYLE_SRC_?(h=ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_,k=ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS_,
l=ol.format.KML.DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS_):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(f)&&(h=[.5,0],l=k=ol.style.IconAnchorUnits.FRACTION);var m;g=c.x;var n=c.y;void 0!==g&&void 0!==n&&(m=[g,n]);var p;g=c.w;c=c.h;void 0!==g&&void 0!==c&&(p=[g,c]);var q;c=a.heading;void 0!==c&&(q=ol.math.toRadians(c));a=a.scale;d?(f==ol.format.KML.DEFAULT_IMAGE_STYLE_SRC_&&(p=ol.format.KML.DEFAULT_IMAGE_STYLE_SIZE_,void 0===a&&(a=ol.format.KML.DEFAULT_IMAGE_SCALE_MULTIPLIER_)),f=new ol.style.Icon({anchor:h,
anchorOrigin:e,anchorXUnits:k,anchorYUnits:l,crossOrigin:"anonymous",offset:m,offsetOrigin:ol.style.IconOrigin.BOTTOM_LEFT,rotation:q,scale:a,size:p,src:f}),b.imageStyle=f):b.imageStyle=ol.format.KML.DEFAULT_NO_IMAGE_STYLE_}};ol.format.KML.LabelStyleParser_=function(a,b){if(a=ol.xml.pushParseAndPop({},ol.format.KML.LABEL_STYLE_PARSERS_,a,b))b=b[b.length-1],a=new ol.style.Text({fill:new ol.style.Fill({color:"color"in a?a.color:ol.format.KML.DEFAULT_COLOR_}),scale:a.scale}),b.textStyle=a};
ol.format.KML.LineStyleParser_=function(a,b){if(a=ol.xml.pushParseAndPop({},ol.format.KML.LINE_STYLE_PARSERS_,a,b))b=b[b.length-1],a=new ol.style.Stroke({color:"color"in a?a.color:ol.format.KML.DEFAULT_COLOR_,width:"width"in a?a.width:1}),b.strokeStyle=a};
ol.format.KML.PolyStyleParser_=function(a,b){if(a=ol.xml.pushParseAndPop({},ol.format.KML.POLY_STYLE_PARSERS_,a,b)){b=b[b.length-1];var c=new ol.style.Fill({color:"color"in a?a.color:ol.format.KML.DEFAULT_COLOR_});b.fillStyle=c;c=a.fill;void 0!==c&&(b.fill=c);a=a.outline;void 0!==a&&(b.outline=a)}};ol.format.KML.readFlatLinearRing_=function(a,b){return ol.xml.pushParseAndPop(null,ol.format.KML.FLAT_LINEAR_RING_PARSERS_,a,b)};
ol.format.KML.gxCoordParser_=function(a,b){b=b[b.length-1].flatCoordinates;a=ol.xml.getAllTextContent(a,!1);var c=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(a);if(c){a=parseFloat(c[1]);var d=parseFloat(c[2]);c=parseFloat(c[3]);b.push(a,d,c,0)}else b.push(0,0,0,0)};
ol.format.KML.readGxMultiTrack_=function(a,b){if(a=ol.xml.pushParseAndPop([],ol.format.KML.GX_MULTITRACK_GEOMETRY_PARSERS_,a,b))return b=new ol.geom.MultiLineString(null),b.setLineStrings(a),b};
ol.format.KML.readGxTrack_=function(a,b){if(b=ol.xml.pushParseAndPop({flatCoordinates:[],whens:[]},ol.format.KML.GX_TRACK_PARSERS_,a,b)){a=b.flatCoordinates;b=b.whens;var c;var d=0;for(c=Math.min(a.length,b.length);d<c;++d)a[4*d+3]=b[d];b=new ol.geom.LineString(null);b.setFlatCoordinates(ol.geom.GeometryLayout.XYZM,a);return b}};ol.format.KML.readIcon_=function(a,b){return(a=ol.xml.pushParseAndPop({},ol.format.KML.ICON_PARSERS_,a,b))?a:null};
ol.format.KML.readFlatCoordinatesFromNode_=function(a,b){return ol.xml.pushParseAndPop(null,ol.format.KML.GEOMETRY_FLAT_COORDINATES_PARSERS_,a,b)};ol.format.KML.readLineString_=function(a,b){var c=ol.xml.pushParseAndPop({},ol.format.KML.EXTRUDE_AND_ALTITUDE_MODE_PARSERS_,a,b);if(a=ol.format.KML.readFlatCoordinatesFromNode_(a,b))return b=new ol.geom.LineString(null),b.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,a),b.setProperties(c),b};
ol.format.KML.readLinearRing_=function(a,b){var c=ol.xml.pushParseAndPop({},ol.format.KML.EXTRUDE_AND_ALTITUDE_MODE_PARSERS_,a,b);if(a=ol.format.KML.readFlatCoordinatesFromNode_(a,b))return b=new ol.geom.Polygon(null),b.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,a,[a.length]),b.setProperties(c),b};
ol.format.KML.readMultiGeometry_=function(a,b){a=ol.xml.pushParseAndPop([],ol.format.KML.MULTI_GEOMETRY_PARSERS_,a,b);if(!a)return null;if(0===a.length)return new ol.geom.GeometryCollection(a);var c=!0,d=a[0].getType(),e;var f=1;for(e=a.length;f<e;++f)if(b=a[f],b.getType()!=d){c=!1;break}if(c)if(d==ol.geom.GeometryType.POINT){var g=a[0];c=g.getLayout();d=g.getFlatCoordinates();f=1;for(e=a.length;f<e;++f)b=a[f],ol.array.extend(d,b.getFlatCoordinates());g=new ol.geom.MultiPoint(null);g.setFlatCoordinates(c,
d);ol.format.KML.setCommonGeometryProperties_(g,a)}else d==ol.geom.GeometryType.LINE_STRING?(g=new ol.geom.MultiLineString(null),g.setLineStrings(a),ol.format.KML.setCommonGeometryProperties_(g,a)):d==ol.geom.GeometryType.POLYGON?(g=new ol.geom.MultiPolygon(null),g.setPolygons(a),ol.format.KML.setCommonGeometryProperties_(g,a)):d==ol.geom.GeometryType.GEOMETRY_COLLECTION?g=new ol.geom.GeometryCollection(a):ol.asserts.assert(!1,37);else g=new ol.geom.GeometryCollection(a);return g};
ol.format.KML.readPoint_=function(a,b){var c=ol.xml.pushParseAndPop({},ol.format.KML.EXTRUDE_AND_ALTITUDE_MODE_PARSERS_,a,b);if(a=ol.format.KML.readFlatCoordinatesFromNode_(a,b))return b=new ol.geom.Point(null),b.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,a),b.setProperties(c),b};
ol.format.KML.readPolygon_=function(a,b){var c=ol.xml.pushParseAndPop({},ol.format.KML.EXTRUDE_AND_ALTITUDE_MODE_PARSERS_,a,b);if((a=ol.xml.pushParseAndPop([null],ol.format.KML.FLAT_LINEAR_RINGS_PARSERS_,a,b))&&a[0]){b=new ol.geom.Polygon(null);var d=a[0],e=[d.length],f;var g=1;for(f=a.length;g<f;++g)ol.array.extend(d,a[g]),e.push(d.length);b.setFlatCoordinates(ol.geom.GeometryLayout.XYZ,d,e);b.setProperties(c);return b}};
ol.format.KML.readStyle_=function(a,b){b=ol.xml.pushParseAndPop({},ol.format.KML.STYLE_PARSERS_,a,b);if(!b)return null;a="fillStyle"in b?b.fillStyle:ol.format.KML.DEFAULT_FILL_STYLE_;var c=b.fill;void 0===c||c||(a=null);c="imageStyle"in b?b.imageStyle:ol.format.KML.DEFAULT_IMAGE_STYLE_;c==ol.format.KML.DEFAULT_NO_IMAGE_STYLE_&&(c=void 0);var d="textStyle"in b?b.textStyle:ol.format.KML.DEFAULT_TEXT_STYLE_,e="strokeStyle"in b?b.strokeStyle:ol.format.KML.DEFAULT_STROKE_STYLE_;b=b.outline;void 0===b||
b||(e=null);return[new ol.style.Style({fill:a,image:c,stroke:e,text:d,zIndex:void 0})]};ol.format.KML.setCommonGeometryProperties_=function(a,b){var c=b.length,d=Array(b.length),e=Array(b.length),f=Array(b.length),g,h,k;var l=h=k=!1;for(g=0;g<c;++g){var m=b[g];d[g]=m.get("extrude");e[g]=m.get("tessellate");f[g]=m.get("altitudeMode");l=l||void 0!==d[g];h=h||void 0!==e[g];k=k||f[g]}l&&a.set("extrude",d);h&&a.set("tessellate",e);k&&a.set("altitudeMode",f)};
ol.format.KML.DataParser_=function(a,b){var c=a.getAttribute("name");ol.xml.parseNode(ol.format.KML.DATA_PARSERS_,a,b);a=b[b.length-1];null!==c?a[c]=a.value:null!==a.displayName&&(a[a.displayName]=a.value);delete a.value};ol.format.KML.ExtendedDataParser_=function(a,b){ol.xml.parseNode(ol.format.KML.EXTENDED_DATA_PARSERS_,a,b)};ol.format.KML.RegionParser_=function(a,b){ol.xml.parseNode(ol.format.KML.REGION_PARSERS_,a,b)};
ol.format.KML.PairDataParser_=function(a,b){if(a=ol.xml.pushParseAndPop({},ol.format.KML.PAIR_PARSERS_,a,b)){var c=a.key;c&&"normal"==c&&((c=a.styleUrl)&&(b[b.length-1]=c),(a=a.Style)&&(b[b.length-1]=a))}};ol.format.KML.PlacemarkStyleMapParser_=function(a,b){if(a=ol.format.KML.readStyleMapValue_(a,b))b=b[b.length-1],Array.isArray(a)?b.Style=a:"string"===typeof a?b.styleUrl=a:ol.asserts.assert(!1,38)};
ol.format.KML.SchemaDataParser_=function(a,b){ol.xml.parseNode(ol.format.KML.SCHEMA_DATA_PARSERS_,a,b)};ol.format.KML.SimpleDataParser_=function(a,b){var c=a.getAttribute("name");null!==c&&(a=ol.format.XSD.readString(a),b[b.length-1][c]=a)};
ol.format.KML.LatLonAltBoxParser_=function(a,b){if(a=ol.xml.pushParseAndPop({},ol.format.KML.LAT_LON_ALT_BOX_PARSERS_,a,b)){b=b[b.length-1];var c=[parseFloat(a.west),parseFloat(a.south),parseFloat(a.east),parseFloat(a.north)];b.extent=c;b.altitudeMode=a.altitudeMode;b.minAltitude=parseFloat(a.minAltitude);b.maxAltitude=parseFloat(a.maxAltitude)}};
ol.format.KML.LodParser_=function(a,b){if(a=ol.xml.pushParseAndPop({},ol.format.KML.LOD_PARSERS_,a,b))b=b[b.length-1],b.minLodPixels=parseFloat(a.minLodPixels),b.maxLodPixels=parseFloat(a.maxLodPixels),b.minFadeExtent=parseFloat(a.minFadeExtent),b.maxFadeExtent=parseFloat(a.maxFadeExtent)};ol.format.KML.innerBoundaryIsParser_=function(a,b){(a=ol.xml.pushParseAndPop(void 0,ol.format.KML.INNER_BOUNDARY_IS_PARSERS_,a,b))&&b[b.length-1].push(a)};
ol.format.KML.outerBoundaryIsParser_=function(a,b){(a=ol.xml.pushParseAndPop(void 0,ol.format.KML.OUTER_BOUNDARY_IS_PARSERS_,a,b))&&(b[b.length-1][0]=a)};ol.format.KML.LinkParser_=function(a,b){ol.xml.parseNode(ol.format.KML.LINK_PARSERS_,a,b)};ol.format.KML.whenParser_=function(a,b){b=b[b.length-1].whens;a=ol.xml.getAllTextContent(a,!1);a=Date.parse(a);b.push(isNaN(a)?0:a)};
ol.format.KML.DATA_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{displayName:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),value:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.KML.EXTENDED_DATA_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Data:ol.format.KML.DataParser_,SchemaData:ol.format.KML.SchemaDataParser_});
ol.format.KML.REGION_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LatLonAltBox:ol.format.KML.LatLonAltBoxParser_,Lod:ol.format.KML.LodParser_});
ol.format.KML.LAT_LON_ALT_BOX_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{altitudeMode:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),minAltitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),maxAltitude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),north:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),south:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),east:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),west:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal)});
ol.format.KML.LOD_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{minLodPixels:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),maxLodPixels:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),minFadeExtent:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),maxFadeExtent:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal)});
ol.format.KML.EXTRUDE_AND_ALTITUDE_MODE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{extrude:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean),tessellate:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean),altitudeMode:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString)});ol.format.KML.FLAT_LINEAR_RING_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{coordinates:ol.xml.makeReplacer(ol.format.KML.readFlatCoordinates_)});
ol.format.KML.FLAT_LINEAR_RINGS_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{innerBoundaryIs:ol.format.KML.innerBoundaryIsParser_,outerBoundaryIs:ol.format.KML.outerBoundaryIsParser_});ol.format.KML.GX_TRACK_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{when:ol.format.KML.whenParser_},ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,{coord:ol.format.KML.gxCoordParser_}));
ol.format.KML.GEOMETRY_FLAT_COORDINATES_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{coordinates:ol.xml.makeReplacer(ol.format.KML.readFlatCoordinates_)});
ol.format.KML.ICON_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{href:ol.xml.makeObjectPropertySetter(ol.format.KML.readURI_)},ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,{x:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),y:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),w:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),h:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal)}));
ol.format.KML.ICON_STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Icon:ol.xml.makeObjectPropertySetter(ol.format.KML.readIcon_),heading:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal),hotSpot:ol.xml.makeObjectPropertySetter(ol.format.KML.readVec2_),scale:ol.xml.makeObjectPropertySetter(ol.format.KML.readScale_)});ol.format.KML.INNER_BOUNDARY_IS_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LinearRing:ol.xml.makeReplacer(ol.format.KML.readFlatLinearRing_)});
ol.format.KML.LABEL_STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeObjectPropertySetter(ol.format.KML.readColor_),scale:ol.xml.makeObjectPropertySetter(ol.format.KML.readScale_)});ol.format.KML.LINE_STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeObjectPropertySetter(ol.format.KML.readColor_),width:ol.xml.makeObjectPropertySetter(ol.format.XSD.readDecimal)});
ol.format.KML.MULTI_GEOMETRY_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LineString:ol.xml.makeArrayPusher(ol.format.KML.readLineString_),LinearRing:ol.xml.makeArrayPusher(ol.format.KML.readLinearRing_),MultiGeometry:ol.xml.makeArrayPusher(ol.format.KML.readMultiGeometry_),Point:ol.xml.makeArrayPusher(ol.format.KML.readPoint_),Polygon:ol.xml.makeArrayPusher(ol.format.KML.readPolygon_)});
ol.format.KML.GX_MULTITRACK_GEOMETRY_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,{Track:ol.xml.makeArrayPusher(ol.format.KML.readGxTrack_)});
ol.format.KML.NETWORK_LINK_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{ExtendedData:ol.format.KML.ExtendedDataParser_,Region:ol.format.KML.RegionParser_,Link:ol.format.KML.LinkParser_,address:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),description:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),open:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean),phoneNumber:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),
visibility:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean)});ol.format.KML.LINK_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{href:ol.xml.makeObjectPropertySetter(ol.format.KML.readURI_)});ol.format.KML.OUTER_BOUNDARY_IS_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LinearRing:ol.xml.makeReplacer(ol.format.KML.readFlatLinearRing_)});
ol.format.KML.PAIR_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Style:ol.xml.makeObjectPropertySetter(ol.format.KML.readStyle_),key:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),styleUrl:ol.xml.makeObjectPropertySetter(ol.format.KML.readURI_)});
ol.format.KML.PLACEMARK_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{ExtendedData:ol.format.KML.ExtendedDataParser_,Region:ol.format.KML.RegionParser_,MultiGeometry:ol.xml.makeObjectPropertySetter(ol.format.KML.readMultiGeometry_,"geometry"),LineString:ol.xml.makeObjectPropertySetter(ol.format.KML.readLineString_,"geometry"),LinearRing:ol.xml.makeObjectPropertySetter(ol.format.KML.readLinearRing_,"geometry"),Point:ol.xml.makeObjectPropertySetter(ol.format.KML.readPoint_,"geometry"),
Polygon:ol.xml.makeObjectPropertySetter(ol.format.KML.readPolygon_,"geometry"),Style:ol.xml.makeObjectPropertySetter(ol.format.KML.readStyle_),StyleMap:ol.format.KML.PlacemarkStyleMapParser_,address:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),description:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),name:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),open:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean),phoneNumber:ol.xml.makeObjectPropertySetter(ol.format.XSD.readString),
styleUrl:ol.xml.makeObjectPropertySetter(ol.format.KML.readURI_),visibility:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean)},ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,{MultiTrack:ol.xml.makeObjectPropertySetter(ol.format.KML.readGxMultiTrack_,"geometry"),Track:ol.xml.makeObjectPropertySetter(ol.format.KML.readGxTrack_,"geometry")}));
ol.format.KML.POLY_STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeObjectPropertySetter(ol.format.KML.readColor_),fill:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean),outline:ol.xml.makeObjectPropertySetter(ol.format.XSD.readBoolean)});ol.format.KML.SCHEMA_DATA_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{SimpleData:ol.format.KML.SimpleDataParser_});
ol.format.KML.STYLE_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{IconStyle:ol.format.KML.IconStyleParser_,LabelStyle:ol.format.KML.LabelStyleParser_,LineStyle:ol.format.KML.LineStyleParser_,PolyStyle:ol.format.KML.PolyStyleParser_});ol.format.KML.STYLE_MAP_PARSERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Pair:ol.format.KML.PairDataParser_});
ol.format.KML.prototype.readDocumentOrFolder_=function(a,b){var c=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Document:ol.xml.makeArrayExtender(this.readDocumentOrFolder_,this),Folder:ol.xml.makeArrayExtender(this.readDocumentOrFolder_,this),Placemark:ol.xml.makeArrayPusher(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)});if(a=ol.xml.pushParseAndPop([],c,a,b,this))return a};
ol.format.KML.prototype.readPlacemark_=function(a,b){var c=ol.xml.pushParseAndPop({geometry:null},ol.format.KML.PLACEMARK_PARSERS_,a,b);if(c){var d=new ol.Feature;a=a.getAttribute("id");null!==a&&d.setId(a);b=b[0];(a=c.geometry)&&ol.format.Feature.transformWithOptions(a,!1,b);d.setGeometry(a);delete c.geometry;this.extractStyles_&&(b=ol.format.KML.createFeatureStyleFunction_(c.Style,c.styleUrl,this.defaultStyle_,this.sharedStyles_,this.showPointNames_),d.setStyle(b));delete c.Style;d.setProperties(c);
return d}};ol.format.KML.prototype.readSharedStyle_=function(a,b){var c=a.getAttribute("id");null!==c&&(b=ol.format.KML.readStyle_(a,b))&&(a=a.baseURI,a&&"about:blank"!=a||(a=window.location.href),c=a?(new URL("#"+c,a)).href:"#"+c,this.sharedStyles_[c]=b)};
ol.format.KML.prototype.readSharedStyleMap_=function(a,b){var c=a.getAttribute("id");null!==c&&(b=ol.format.KML.readStyleMapValue_(a,b))&&(a=a.baseURI,a&&"about:blank"!=a||(a=window.location.href),c=a?(new URL("#"+c,a)).href:"#"+c,this.sharedStyles_[c]=b)};ol.format.KML.prototype.readFeatureFromNode=function(a,b){return ol.array.includes(ol.format.KML.NAMESPACE_URIS_,a.namespaceURI)?(a=this.readPlacemark_(a,[this.getReadOptions(a,b)]))?a:null:null};
ol.format.KML.prototype.readFeaturesFromNode=function(a,b){if(!ol.array.includes(ol.format.KML.NAMESPACE_URIS_,a.namespaceURI))return[];var c=a.localName;if("Document"==c||"Folder"==c)return(c=this.readDocumentOrFolder_(a,[this.getReadOptions(a,b)]))?c:[];if("Placemark"==c)return(b=this.readPlacemark_(a,[this.getReadOptions(a,b)]))?[b]:[];if("kml"==c){c=[];for(a=a.firstElementChild;a;a=a.nextElementSibling){var d=this.readFeaturesFromNode(a,b);d&&ol.array.extend(c,d)}return c}return[]};
ol.format.KML.prototype.readName=function(a){if(ol.xml.isDocument(a))return this.readNameFromDocument(a);if(ol.xml.isNode(a))return this.readNameFromNode(a);if("string"===typeof a)return a=ol.xml.parse(a),this.readNameFromDocument(a)};ol.format.KML.prototype.readNameFromDocument=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType==Node.ELEMENT_NODE){var b=this.readNameFromNode(a);if(b)return b}};
ol.format.KML.prototype.readNameFromNode=function(a){var b;for(b=a.firstElementChild;b;b=b.nextElementSibling)if(ol.array.includes(ol.format.KML.NAMESPACE_URIS_,b.namespaceURI)&&"name"==b.localName)return ol.format.XSD.readString(b);for(b=a.firstElementChild;b;b=b.nextElementSibling)if(a=b.localName,ol.array.includes(ol.format.KML.NAMESPACE_URIS_,b.namespaceURI)&&("Document"==a||"Folder"==a||"Placemark"==a||"kml"==a)&&(a=this.readNameFromNode(b)))return a};
ol.format.KML.prototype.readNetworkLinks=function(a){var b=[];ol.xml.isDocument(a)?ol.array.extend(b,this.readNetworkLinksFromDocument(a)):ol.xml.isNode(a)?ol.array.extend(b,this.readNetworkLinksFromNode(a)):"string"===typeof a&&(a=ol.xml.parse(a),ol.array.extend(b,this.readNetworkLinksFromDocument(a)));return b};
ol.format.KML.prototype.readNetworkLinksFromDocument=function(a){var b=[];for(a=a.firstChild;a;a=a.nextSibling)a.nodeType==Node.ELEMENT_NODE&&ol.array.extend(b,this.readNetworkLinksFromNode(a));return b};
ol.format.KML.prototype.readNetworkLinksFromNode=function(a){var b,c=[];for(b=a.firstElementChild;b;b=b.nextElementSibling)if(ol.array.includes(ol.format.KML.NAMESPACE_URIS_,b.namespaceURI)&&"NetworkLink"==b.localName){var d=ol.xml.pushParseAndPop({},ol.format.KML.NETWORK_LINK_PARSERS_,b,[]);c.push(d)}for(b=a.firstElementChild;b;b=b.nextElementSibling)a=b.localName,!ol.array.includes(ol.format.KML.NAMESPACE_URIS_,b.namespaceURI)||"Document"!=a&&"Folder"!=a&&"kml"!=a||ol.array.extend(c,this.readNetworkLinksFromNode(b));
return c};ol.format.KML.prototype.readRegion=function(a){var b=[];ol.xml.isDocument(a)?ol.array.extend(b,this.readRegionFromDocument(a)):ol.xml.isNode(a)?ol.array.extend(b,this.readRegionFromNode(a)):"string"===typeof a&&(a=ol.xml.parse(a),ol.array.extend(b,this.readRegionFromDocument(a)));return b};ol.format.KML.prototype.readRegionFromDocument=function(a){var b=[];for(a=a.firstChild;a;a=a.nextSibling)a.nodeType==Node.ELEMENT_NODE&&ol.array.extend(b,this.readRegionFromNode(a));return b};
ol.format.KML.prototype.readRegionFromNode=function(a){var b,c=[];for(b=a.firstElementChild;b;b=b.nextElementSibling)if(ol.array.includes(ol.format.KML.NAMESPACE_URIS_,b.namespaceURI)&&"Region"==b.localName){var d=ol.xml.pushParseAndPop({},ol.format.KML.REGION_PARSERS_,b,[]);c.push(d)}for(b=a.firstElementChild;b;b=b.nextElementSibling)a=b.localName,!ol.array.includes(ol.format.KML.NAMESPACE_URIS_,b.namespaceURI)||"Document"!=a&&"Folder"!=a&&"kml"!=a||ol.array.extend(c,this.readRegionFromNode(b));
return c};ol.format.KML.writeColorTextNode_=function(a,b){b=ol.color.asArray(b);b=[255*(4==b.length?b[3]:1),b[2],b[1],b[0]];var c;for(c=0;4>c;++c){var d=parseInt(b[c],10).toString(16);b[c]=1==d.length?"0"+d:d}ol.format.XSD.writeStringTextNode(a,b.join(""))};
ol.format.KML.writeCoordinatesTextNode_=function(a,b,c){c=c[c.length-1];var d=c.layout;c=c.stride;var e;d==ol.geom.GeometryLayout.XY||d==ol.geom.GeometryLayout.XYM?e=2:d==ol.geom.GeometryLayout.XYZ||d==ol.geom.GeometryLayout.XYZM?e=3:ol.asserts.assert(!1,34);var f,g=b.length,h="";if(0<g){h+=b[0];for(d=1;d<e;++d)h+=","+b[d];for(f=c;f<g;f+=c)for(h+=" "+b[f],d=1;d<e;++d)h+=","+b[f+d]}ol.format.XSD.writeStringTextNode(a,h)};
ol.format.KML.writeDataNode_=function(a,b,c){a.setAttribute("name",b.name);a={node:a};b=b.value;"object"==typeof b?(null!==b&&b.displayName&&ol.xml.pushSerializeAndPop(a,ol.format.KML.EXTENDEDDATA_NODE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[b.displayName],c,["displayName"]),null!==b&&b.value&&ol.xml.pushSerializeAndPop(a,ol.format.KML.EXTENDEDDATA_NODE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[b.value],c,["value"])):ol.xml.pushSerializeAndPop(a,ol.format.KML.EXTENDEDDATA_NODE_SERIALIZERS_,
ol.xml.OBJECT_PROPERTY_NODE_FACTORY,[b],c,["value"])};ol.format.KML.writeDataNodeName_=function(a,b){ol.format.XSD.writeCDATASection(a,b)};ol.format.KML.writeDataNodeValue_=function(a,b){ol.format.XSD.writeStringTextNode(a,b)};ol.format.KML.writeDocument_=function(a,b,c){ol.xml.pushSerializeAndPop({node:a},ol.format.KML.DOCUMENT_SERIALIZERS_,ol.format.KML.DOCUMENT_NODE_FACTORY_,b,c,void 0,this)};
ol.format.KML.writeExtendedData_=function(a,b,c){a={node:a};var d=b.names;b=b.values;for(var e=d.length,f=0;f<e;f++)ol.xml.pushSerializeAndPop(a,ol.format.KML.EXTENDEDDATA_NODE_SERIALIZERS_,ol.format.KML.DATA_NODE_FACTORY_,[{name:d[f],value:b[f]}],c)};
ol.format.KML.writeIcon_=function(a,b,c){a={node:a};var d=ol.format.KML.ICON_SEQUENCE_[c[c.length-1].node.namespaceURI],e=ol.xml.makeSequence(b,d);ol.xml.pushSerializeAndPop(a,ol.format.KML.ICON_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,e,c,d);d=ol.format.KML.ICON_SEQUENCE_[ol.format.KML.GX_NAMESPACE_URIS_[0]];e=ol.xml.makeSequence(b,d);ol.xml.pushSerializeAndPop(a,ol.format.KML.ICON_SERIALIZERS_,ol.format.KML.GX_NODE_FACTORY_,e,c,d)};
ol.format.KML.writeIconStyle_=function(a,b,c){a={node:a};var d={},e=b.getSrc(),f=b.getSize(),g=b.getImageSize();e={href:e};if(f){e.w=f[0];e.h=f[1];var h=b.getAnchor(),k=b.getOrigin();k&&g&&0!==k[0]&&k[1]!==f[1]&&(e.x=k[0],e.y=g[1]-(k[1]+f[1]));!h||h[0]===f[0]/2&&h[1]===f[1]/2||(d.hotSpot={x:h[0],xunits:ol.style.IconAnchorUnits.PIXELS,y:f[1]-h[1],yunits:ol.style.IconAnchorUnits.PIXELS})}d.Icon=e;f=b.getScale();1!==f&&(d.scale=f);b=b.getRotation();0!==b&&(d.heading=b);b=ol.format.KML.ICON_STYLE_SEQUENCE_[c[c.length-
1].node.namespaceURI];d=ol.xml.makeSequence(d,b);ol.xml.pushSerializeAndPop(a,ol.format.KML.ICON_STYLE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,d,c,b)};
ol.format.KML.writeLabelStyle_=function(a,b,c){a={node:a};var d={},e=b.getFill();e&&(d.color=e.getColor());(b=b.getScale())&&1!==b&&(d.scale=b);b=ol.format.KML.LABEL_STYLE_SEQUENCE_[c[c.length-1].node.namespaceURI];d=ol.xml.makeSequence(d,b);ol.xml.pushSerializeAndPop(a,ol.format.KML.LABEL_STYLE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,d,c,b)};
ol.format.KML.writeLineStyle_=function(a,b,c){a={node:a};var d={color:b.getColor(),width:b.getWidth()};b=ol.format.KML.LINE_STYLE_SEQUENCE_[c[c.length-1].node.namespaceURI];d=ol.xml.makeSequence(d,b);ol.xml.pushSerializeAndPop(a,ol.format.KML.LINE_STYLE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,d,c,b)};
ol.format.KML.writeMultiGeometry_=function(a,b,c){a={node:a};var d=b.getType();if(d==ol.geom.GeometryType.GEOMETRY_COLLECTION){var e=b.getGeometries();var f=ol.format.KML.GEOMETRY_NODE_FACTORY_}else d==ol.geom.GeometryType.MULTI_POINT?(e=b.getPoints(),f=ol.format.KML.POINT_NODE_FACTORY_):d==ol.geom.GeometryType.MULTI_LINE_STRING?(e=b.getLineStrings(),f=ol.format.KML.LINE_STRING_NODE_FACTORY_):d==ol.geom.GeometryType.MULTI_POLYGON?(e=b.getPolygons(),f=ol.format.KML.POLYGON_NODE_FACTORY_):ol.asserts.assert(!1,
39);ol.xml.pushSerializeAndPop(a,ol.format.KML.MULTI_GEOMETRY_SERIALIZERS_,f,e,c)};ol.format.KML.writeBoundaryIs_=function(a,b,c){ol.xml.pushSerializeAndPop({node:a},ol.format.KML.BOUNDARY_IS_SERIALIZERS_,ol.format.KML.LINEAR_RING_NODE_FACTORY_,[b],c)};
ol.format.KML.writePlacemark_=function(a,b,c){var d={node:a};b.getId()&&a.setAttribute("id",b.getId());a=b.getProperties();var e={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};e[b.getGeometryName()]=1;var f=Object.keys(a||{}).sort().filter(function(a){return!e[a]});if(0<f.length){var g=ol.xml.makeSequence(a,f);ol.xml.pushSerializeAndPop(d,ol.format.KML.PLACEMARK_SERIALIZERS_,ol.format.KML.EXTENDEDDATA_NODE_FACTORY_,[{names:f,values:g}],c)}if(f=b.getStyleFunction())if(f=
f.call(b,0))f=Array.isArray(f)?f[0]:f,this.writeStyles_&&(a.Style=f),(f=f.getText())&&(a.name=f.getText());f=ol.format.KML.PLACEMARK_SEQUENCE_[c[c.length-1].node.namespaceURI];a=ol.xml.makeSequence(a,f);ol.xml.pushSerializeAndPop(d,ol.format.KML.PLACEMARK_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,a,c,f);a=c[0];(b=b.getGeometry())&&(b=ol.format.Feature.transformWithOptions(b,!0,a));ol.xml.pushSerializeAndPop(d,ol.format.KML.PLACEMARK_SERIALIZERS_,ol.format.KML.GEOMETRY_NODE_FACTORY_,[b],c)};
ol.format.KML.writePrimitiveGeometry_=function(a,b,c){var d=b.getFlatCoordinates();a={node:a};a.layout=b.getLayout();a.stride=b.getStride();b=b.getProperties();b.coordinates=d;d=ol.format.KML.PRIMITIVE_GEOMETRY_SEQUENCE_[c[c.length-1].node.namespaceURI];b=ol.xml.makeSequence(b,d);ol.xml.pushSerializeAndPop(a,ol.format.KML.PRIMITIVE_GEOMETRY_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,b,c,d)};
ol.format.KML.writePolygon_=function(a,b,c){b=b.getLinearRings();var d=b.shift();a={node:a};ol.xml.pushSerializeAndPop(a,ol.format.KML.POLYGON_SERIALIZERS_,ol.format.KML.INNER_BOUNDARY_NODE_FACTORY_,b,c);ol.xml.pushSerializeAndPop(a,ol.format.KML.POLYGON_SERIALIZERS_,ol.format.KML.OUTER_BOUNDARY_NODE_FACTORY_,[d],c)};ol.format.KML.writePolyStyle_=function(a,b,c){ol.xml.pushSerializeAndPop({node:a},ol.format.KML.POLY_STYLE_SERIALIZERS_,ol.format.KML.COLOR_NODE_FACTORY_,[b.getColor()],c)};
ol.format.KML.writeScaleTextNode_=function(a,b){ol.format.XSD.writeDecimalTextNode(a,Math.round(1E6*b)/1E6)};
ol.format.KML.writeStyle_=function(a,b,c){a={node:a};var d={},e=b.getFill(),f=b.getStroke(),g=b.getImage();b=b.getText();g instanceof ol.style.Icon&&(d.IconStyle=g);b&&(d.LabelStyle=b);f&&(d.LineStyle=f);e&&(d.PolyStyle=e);b=ol.format.KML.STYLE_SEQUENCE_[c[c.length-1].node.namespaceURI];d=ol.xml.makeSequence(d,b);ol.xml.pushSerializeAndPop(a,ol.format.KML.STYLE_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,d,c,b)};
ol.format.KML.writeVec2_=function(a,b){a.setAttribute("x",b.x);a.setAttribute("y",b.y);a.setAttribute("xunits",b.xunits);a.setAttribute("yunits",b.yunits)};ol.format.KML.KML_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["Document","Placemark"]);ol.format.KML.KML_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Document:ol.xml.makeChildAppender(ol.format.KML.writeDocument_),Placemark:ol.xml.makeChildAppender(ol.format.KML.writePlacemark_)});
ol.format.KML.DOCUMENT_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Placemark:ol.xml.makeChildAppender(ol.format.KML.writePlacemark_)});ol.format.KML.EXTENDEDDATA_NODE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Data:ol.xml.makeChildAppender(ol.format.KML.writeDataNode_),value:ol.xml.makeChildAppender(ol.format.KML.writeDataNodeValue_),displayName:ol.xml.makeChildAppender(ol.format.KML.writeDataNodeName_)});
ol.format.KML.GEOMETRY_TYPE_TO_NODENAME_={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"};ol.format.KML.ICON_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["href"],ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,["x","y","w","h"]));
ol.format.KML.ICON_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{href:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode)},ol.xml.makeStructureNS(ol.format.KML.GX_NAMESPACE_URIS_,{x:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),y:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),w:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),h:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode)}));
ol.format.KML.ICON_STYLE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["scale","heading","Icon","hotSpot"]);ol.format.KML.ICON_STYLE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{Icon:ol.xml.makeChildAppender(ol.format.KML.writeIcon_),heading:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode),hotSpot:ol.xml.makeChildAppender(ol.format.KML.writeVec2_),scale:ol.xml.makeChildAppender(ol.format.KML.writeScaleTextNode_)});
ol.format.KML.LABEL_STYLE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["color","scale"]);ol.format.KML.LABEL_STYLE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeChildAppender(ol.format.KML.writeColorTextNode_),scale:ol.xml.makeChildAppender(ol.format.KML.writeScaleTextNode_)});ol.format.KML.LINE_STYLE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["color","width"]);
ol.format.KML.LINE_STYLE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeChildAppender(ol.format.KML.writeColorTextNode_),width:ol.xml.makeChildAppender(ol.format.XSD.writeDecimalTextNode)});ol.format.KML.BOUNDARY_IS_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LinearRing:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_)});
ol.format.KML.MULTI_GEOMETRY_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{LineString:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_),Point:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_),Polygon:ol.xml.makeChildAppender(ol.format.KML.writePolygon_),GeometryCollection:ol.xml.makeChildAppender(ol.format.KML.writeMultiGeometry_)});ol.format.KML.PLACEMARK_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,"name open visibility address phoneNumber description styleUrl Style".split(" "));
ol.format.KML.PLACEMARK_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{ExtendedData:ol.xml.makeChildAppender(ol.format.KML.writeExtendedData_),MultiGeometry:ol.xml.makeChildAppender(ol.format.KML.writeMultiGeometry_),LineString:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_),LinearRing:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_),Point:ol.xml.makeChildAppender(ol.format.KML.writePrimitiveGeometry_),Polygon:ol.xml.makeChildAppender(ol.format.KML.writePolygon_),
Style:ol.xml.makeChildAppender(ol.format.KML.writeStyle_),address:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),description:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),name:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),open:ol.xml.makeChildAppender(ol.format.XSD.writeBooleanTextNode),phoneNumber:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),styleUrl:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),visibility:ol.xml.makeChildAppender(ol.format.XSD.writeBooleanTextNode)});
ol.format.KML.PRIMITIVE_GEOMETRY_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["extrude","tessellate","altitudeMode","coordinates"]);ol.format.KML.PRIMITIVE_GEOMETRY_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{extrude:ol.xml.makeChildAppender(ol.format.XSD.writeBooleanTextNode),tessellate:ol.xml.makeChildAppender(ol.format.XSD.writeBooleanTextNode),altitudeMode:ol.xml.makeChildAppender(ol.format.XSD.writeStringTextNode),coordinates:ol.xml.makeChildAppender(ol.format.KML.writeCoordinatesTextNode_)});
ol.format.KML.POLYGON_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{outerBoundaryIs:ol.xml.makeChildAppender(ol.format.KML.writeBoundaryIs_),innerBoundaryIs:ol.xml.makeChildAppender(ol.format.KML.writeBoundaryIs_)});ol.format.KML.POLY_STYLE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{color:ol.xml.makeChildAppender(ol.format.KML.writeColorTextNode_)});
ol.format.KML.STYLE_SEQUENCE_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,["IconStyle","LabelStyle","LineStyle","PolyStyle"]);ol.format.KML.STYLE_SERIALIZERS_=ol.xml.makeStructureNS(ol.format.KML.NAMESPACE_URIS_,{IconStyle:ol.xml.makeChildAppender(ol.format.KML.writeIconStyle_),LabelStyle:ol.xml.makeChildAppender(ol.format.KML.writeLabelStyle_),LineStyle:ol.xml.makeChildAppender(ol.format.KML.writeLineStyle_),PolyStyle:ol.xml.makeChildAppender(ol.format.KML.writePolyStyle_)});
ol.format.KML.GX_NODE_FACTORY_=function(a,b,c){return ol.xml.createElementNS(ol.format.KML.GX_NAMESPACE_URIS_[0],"gx:"+c)};ol.format.KML.DOCUMENT_NODE_FACTORY_=function(a,b,c){return ol.xml.createElementNS(b[b.length-1].node.namespaceURI,"Placemark")};ol.format.KML.GEOMETRY_NODE_FACTORY_=function(a,b,c){if(a)return ol.xml.createElementNS(b[b.length-1].node.namespaceURI,ol.format.KML.GEOMETRY_TYPE_TO_NODENAME_[a.getType()])};ol.format.KML.COLOR_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("color");
ol.format.KML.DATA_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("Data");ol.format.KML.EXTENDEDDATA_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("ExtendedData");ol.format.KML.INNER_BOUNDARY_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("innerBoundaryIs");ol.format.KML.POINT_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("Point");ol.format.KML.LINE_STRING_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("LineString");ol.format.KML.LINEAR_RING_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("LinearRing");
ol.format.KML.POLYGON_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("Polygon");ol.format.KML.OUTER_BOUNDARY_NODE_FACTORY_=ol.xml.makeSimpleNodeFactory("outerBoundaryIs");
ol.format.KML.prototype.writeFeaturesNode=function(a,b){b=this.adaptOptions(b);var c=ol.xml.createElementNS(ol.format.KML.NAMESPACE_URIS_[4],"kml");ol.xml.setAttributeNS(c,"http://www.w3.org/2000/xmlns/","xmlns:gx",ol.format.KML.GX_NAMESPACE_URIS_[0]);ol.xml.setAttributeNS(c,"http://www.w3.org/2000/xmlns/","xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");ol.xml.setAttributeNS(c,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",ol.format.KML.SCHEMA_LOCATION_);var d={node:c},
e={};1<a.length?e.Document=a:1==a.length&&(e.Placemark=a[0]);a=ol.format.KML.KML_SEQUENCE_[c.namespaceURI];e=ol.xml.makeSequence(e,a);ol.xml.pushSerializeAndPop(d,ol.format.KML.KML_SERIALIZERS_,ol.xml.OBJECT_PROPERTY_NODE_FACTORY,e,[b],a,this);return c};ngeo.FeatureHelper=function(a,b){this.$filter_=b;this.decimals_=void 0;a.has("ngeoMeasureDecimals")&&(this.decimals_=a.get("ngeoMeasureDecimals"));this.precision_=void 0;a.has("ngeoMeasurePrecision")&&(this.precision_=a.get("ngeoMeasurePrecision"));this.numberFormat_=b("number");this.unitPrefixFormat_=b("ngeoUnitPrefix");this.ngeoNumberCoordinates_=b("ngeoNumberCoordinates");this.pointFilterFn_=null;this.pointFilterArgs_=[];if(a.has("ngeoPointfilter")){b=a.get("ngeoPointfilter").split(":");var c=
b.shift();c=this.$filter_(c);goog.asserts.assertFunction(c);this.pointFilterFn_=c;this.pointFilterArgs_=b}else this.pointFilterFn_=null;this.download_=a.get("ngeoDownload")};ngeo.FeatureHelper.$inject=["$injector","$filter"];ngeo.FeatureHelper.prototype.setProjection=function(a){this.projection_=a};goog.exportProperty(ngeo.FeatureHelper.prototype,"setProjection",ngeo.FeatureHelper.prototype.setProjection);
ngeo.FeatureHelper.prototype.setStyle=function(a,b){var c=this.getStyle(a);b&&(this.supportsVertex_(a)&&c.push(this.getVertexStyle()),c.unshift(this.getHaloStyle_(a)));a.setStyle(c)};goog.exportProperty(ngeo.FeatureHelper.prototype,"setStyle",ngeo.FeatureHelper.prototype.setStyle);
ngeo.FeatureHelper.prototype.getStyle=function(a){switch(this.getType(a)){case ngeo.GeometryType.LINE_STRING:var b=this.getLineStringStyle_(a);break;case ngeo.GeometryType.POINT:b=this.getPointStyle_(a);break;case ngeo.GeometryType.CIRCLE:case ngeo.GeometryType.POLYGON:case ngeo.GeometryType.RECTANGLE:b=this.getPolygonStyle_(a);break;case ngeo.GeometryType.TEXT:b=this.getTextStyle_(a)}goog.asserts.assert(b,"Style should be thruthy");return b.constructor===Array?b:[b]};
goog.exportProperty(ngeo.FeatureHelper.prototype,"getStyle",ngeo.FeatureHelper.prototype.getStyle);
ngeo.FeatureHelper.prototype.getLineStringStyle_=function(a){var b=this.getStrokeProperty(a),c=this.getShowLabelProperty(a),d=this.getShowMeasureProperty(a),e=this.getRGBAColorProperty(a);b=[new ol.style.Style({stroke:new ol.style.Stroke({color:e,width:b})})];e=[];d&&e.push(this.getMeasure(a));c&&e.push(this.getNameProperty(a));if(c||d)a=e.join("\n"),b.push(new ol.style.Style({text:this.createTextStyle_({text:a})}));return b};
ngeo.FeatureHelper.prototype.getPointStyle_=function(a){var b=this.getSizeProperty(a),c=this.getRGBAColorProperty(a),d=this.getShowLabelProperty(a),e=this.getShowMeasureProperty(a);c=[new ol.style.Style({image:new ol.style.Circle({radius:b,fill:new ol.style.Fill({color:c})})})];var f=[];e&&f.push(this.getMeasure(a));d&&f.push(this.getNameProperty(a));if(d||e)a=f.join("\n"),c.push(new ol.style.Style({text:this.createTextStyle_({text:a,size:10,offsetY:-(b+6.5*f.length+4)})}));return c};
ngeo.FeatureHelper.prototype.optNumber=function(a,b){a=a.get(b);if(void 0!==a)return"string"==typeof a?+a:goog.asserts.assertNumber(a)};ngeo.FeatureHelper.prototype.getNumber=function(a,b){a=a.get(b);return"string"==typeof a?+a:goog.asserts.assertNumber(a)};
ngeo.FeatureHelper.prototype.getPolygonStyle_=function(a){var b=this.getStrokeProperty(a),c=this.getOpacityProperty(a),d=this.getRGBAColorProperty(a),e=this.getShowLabelProperty(a),f=this.getShowMeasureProperty(a),g=d.slice();g[3]=c;var h=this.optNumber(a,ngeo.FeatureProperties.AZIMUT);c=[new ol.style.Style({fill:new ol.style.Fill({color:g}),stroke:new ol.style.Stroke({color:d,width:b})})];if(f||e)if(f&&void 0!==h){f=this.getRadiusLine(a,h);var k=ngeo.interaction.Measure.getFormattedLength(f,this.projection_,
this.precision_,this.unitPrefixFormat_);c.push(new ol.style.Style({geometry:f,fill:new ol.style.Fill({color:g}),stroke:new ol.style.Stroke({color:d,width:b}),text:this.createTextStyle_({text:k,angle:(h%180+180)%180-90})}));c.push(new ol.style.Style({geometry:new ol.geom.Point(f.getLastCoordinate()),text:this.createTextStyle_({text:this.numberFormat_(h,this.decimals_)+"\u00b0",size:10,offsetX:20*Math.cos((h-90)*Math.PI/180),offsetY:20*Math.sin((h-90)*Math.PI/180)})}));e&&c.push(new ol.style.Style({text:this.createTextStyle_({text:this.getNameProperty(a),
offsetY:-8,exceedLength:!0})}))}else if(b=[],f&&b.push(this.getMeasure(a)),e&&b.push(this.getNameProperty(a)),e||f)a=b.join("\n"),c.push(new ol.style.Style({text:this.createTextStyle_({text:a,exceedLength:!0})}));return c};ngeo.FeatureHelper.prototype.getTextStyle_=function(a){return new ol.style.Style({text:this.createTextStyle_({text:this.getNameProperty(a),size:this.getSizeProperty(a),angle:this.getAngleProperty(a),color:this.getRGBAColorProperty(a),width:this.getStrokeProperty(a)})})};
ngeo.FeatureHelper.prototype.createEditingStyles=function(a){var b=[255,255,255,1],c=[0,153,255,1],d=[];a=a.getGeometry();console.assert(a);a=a.getType();a===ol.geom.GeometryType.POINT?d.push(new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:c}),stroke:new ol.style.Stroke({color:b,width:1.5})}),zIndex:Infinity})):(a===ol.geom.GeometryType.LINE_STRING?(d.push(new ol.style.Style({stroke:new ol.style.Stroke({color:b,width:5})})),d.push(new ol.style.Style({stroke:new ol.style.Stroke({color:c,
width:3})}))):d.push(new ol.style.Style({stroke:new ol.style.Stroke({color:c,width:1.5}),fill:new ol.style.Fill({color:[255,255,255,.5]})})),d.push(this.getVertexStyle(!0)));return d};goog.exportProperty(ngeo.FeatureHelper.prototype,"createEditingStyles",ngeo.FeatureHelper.prototype.createEditingStyles);
ngeo.FeatureHelper.prototype.getVertexStyle=function(a){a=void 0!==a?a:!0;var b={image:new ol.style.RegularShape({radius:6,points:4,angle:Math.PI/4,fill:new ol.style.Fill({color:[255,255,255,.5]}),stroke:new ol.style.Stroke({color:[0,0,0,1]})})};a&&(b.geometry=function(a){a=a.getGeometry();if(a.getType()!=ol.geom.GeometryType.POINT){var b,c=[],f=[],g;a instanceof ol.geom.LineString?f=a.getCoordinates():a instanceof ol.geom.MultiLineString?c=a.getCoordinates():a instanceof ol.geom.Polygon?f=a.getCoordinates()[0]:
a instanceof ol.geom.MultiPolygon&&(b=a.getCoordinates());if(b){var h=0;for(g=b.length;h<g;h++)c=c.concat(b[h])}h=0;for(g=c.length;h<g;h++)f=f.concat(c[h]);return f.length?new ol.geom.MultiPoint(f):a}});return new ol.style.Style(b)};goog.exportProperty(ngeo.FeatureHelper.prototype,"getVertexStyle",ngeo.FeatureHelper.prototype.getVertexStyle);
ngeo.FeatureHelper.prototype.supportsVertex_=function(a){var b=[ngeo.GeometryType.LINE_STRING,ngeo.GeometryType.POLYGON,ngeo.GeometryType.RECTANGLE];a=this.getType(a);return ol.array.includes(b,a)};
ngeo.FeatureHelper.prototype.getHaloStyle_=function(a){switch(this.getType(a)){case ngeo.GeometryType.POINT:a=this.getSizeProperty(a);var b=new ol.style.Style({image:new ol.style.Circle({radius:a+3,fill:new ol.style.Fill({color:[255,255,255,1]})})});break;case ngeo.GeometryType.LINE_STRING:case ngeo.GeometryType.CIRCLE:case ngeo.GeometryType.POLYGON:case ngeo.GeometryType.RECTANGLE:a=this.getStrokeProperty(a);b=new ol.style.Style({stroke:new ol.style.Stroke({color:[255,255,255,1],width:a+6})});break;
case ngeo.GeometryType.TEXT:b=new ol.style.Style({text:this.createTextStyle_({text:this.getNameProperty(a),size:this.getSizeProperty(a),angle:this.getAngleProperty(a),width:9})})}goog.asserts.assert(b,"Style should be thruthy");return b};ngeo.FeatureHelper.getFilteredFeatureValues=function(a){var b=a.getProperties();delete b.boundedBy;delete b[a.getGeometryName()];delete b.ngeo_feature_type_;return b};goog.exportSymbol("ngeo.FeatureHelper.getFilteredFeatureValues",ngeo.FeatureHelper.getFilteredFeatureValues);
ngeo.FeatureHelper.prototype.getAngleProperty=function(a){a=+a.get(ngeo.FeatureProperties.ANGLE);goog.asserts.assertNumber(a);return a};goog.exportProperty(ngeo.FeatureHelper.prototype,"getAngleProperty",ngeo.FeatureHelper.prototype.getAngleProperty);ngeo.FeatureHelper.prototype.getColorProperty=function(a){a=goog.asserts.assertString(a.get(ngeo.FeatureProperties.COLOR));goog.asserts.assertString(a);return a};goog.exportProperty(ngeo.FeatureHelper.prototype,"getColorProperty",ngeo.FeatureHelper.prototype.getColorProperty);
ngeo.FeatureHelper.prototype.getRGBAColorProperty=function(a){return ol.color.fromString(this.getColorProperty(a))};goog.exportProperty(ngeo.FeatureHelper.prototype,"getRGBAColorProperty",ngeo.FeatureHelper.prototype.getRGBAColorProperty);ngeo.FeatureHelper.prototype.getNameProperty=function(a){a=goog.asserts.assertString(a.get(ngeo.FeatureProperties.NAME));goog.asserts.assertString(a);return a};goog.exportProperty(ngeo.FeatureHelper.prototype,"getNameProperty",ngeo.FeatureHelper.prototype.getNameProperty);
ngeo.FeatureHelper.prototype.getOpacityProperty=function(a){return this.getNumber(a,ngeo.FeatureProperties.OPACITY)};goog.exportProperty(ngeo.FeatureHelper.prototype,"getOpacityProperty",ngeo.FeatureHelper.prototype.getOpacityProperty);ngeo.FeatureHelper.prototype.getShowMeasureProperty=function(a){a=a.get(ngeo.FeatureProperties.SHOW_MEASURE);void 0===a?a=!1:"string"===typeof a&&(a="true"===a?!0:!1);return goog.asserts.assertBoolean(a)};
goog.exportProperty(ngeo.FeatureHelper.prototype,"getShowMeasureProperty",ngeo.FeatureHelper.prototype.getShowMeasureProperty);ngeo.FeatureHelper.prototype.getShowLabelProperty=function(a){a=a.get(ngeo.FeatureProperties.SHOW_LABEL);void 0===a?a=!1:"string"===typeof a&&(a="true"===a?!0:!1);return goog.asserts.assertBoolean(a)};goog.exportProperty(ngeo.FeatureHelper.prototype,"getShowLabelProperty",ngeo.FeatureHelper.prototype.getShowLabelProperty);
ngeo.FeatureHelper.prototype.getSizeProperty=function(a){return this.getNumber(a,ngeo.FeatureProperties.SIZE)};goog.exportProperty(ngeo.FeatureHelper.prototype,"getSizeProperty",ngeo.FeatureHelper.prototype.getSizeProperty);ngeo.FeatureHelper.prototype.getStrokeProperty=function(a){return this.getNumber(a,ngeo.FeatureProperties.STROKE)};goog.exportProperty(ngeo.FeatureHelper.prototype,"getStrokeProperty",ngeo.FeatureHelper.prototype.getStrokeProperty);
ngeo.FeatureHelper.prototype.export=function(a,b){switch(b){case ngeo.FeatureHelper.FormatType.GPX:this.exportGPX(a);break;case ngeo.FeatureHelper.FormatType.KML:this.exportKML(a)}};goog.exportProperty(ngeo.FeatureHelper.prototype,"export",ngeo.FeatureHelper.prototype.export);ngeo.FeatureHelper.prototype.exportGPX=function(a){var b=new ol.format.GPX;this.export_(a,b,"export.gpx","application/gpx+xml")};goog.exportProperty(ngeo.FeatureHelper.prototype,"exportGPX",ngeo.FeatureHelper.prototype.exportGPX);
ngeo.FeatureHelper.prototype.exportKML=function(a){var b=new ol.format.KML;this.export_(a,b,"export.kml","application/vnd.google-earth.kml+xml")};goog.exportProperty(ngeo.FeatureHelper.prototype,"exportKML",ngeo.FeatureHelper.prototype.exportKML);
ngeo.FeatureHelper.prototype.export_=function(a,b,c,d){var e=this;d=void 0!==d?d:"text/plain";var f=[],g;a.forEach(function(a){g=new ol.Feature(a.getProperties());e.setStyle(g,!1);f.push(g)});a=b.writeFeatures(f,this.projection_?{dataProjection:"EPSG:4326",featureProjection:this.projection_}:{});this.download_(a,c,d+";charset=utf-8")};
ngeo.FeatureHelper.prototype.createTextStyle_=function(a){a.angle&&(a.rotation=(void 0!==a.angle?a.angle:0)*Math.PI/180,delete a.angle);a.font=["normal",(a.size||10)+"pt","Arial"].join(" ");a.color&&(a.fill=new ol.style.Fill({color:a.color||[0,0,0,1]}),delete a.color);a.stroke=new ol.style.Stroke({color:[255,255,255,1],width:a.width||3});delete a.width;return new ol.style.Text(a)};
ngeo.FeatureHelper.prototype.getMeasure=function(a){var b=a.getGeometry();goog.asserts.assert(b,"Geometry should be truthy");var c="";b instanceof ol.geom.Polygon?this.getType(a)===ngeo.GeometryType.CIRCLE?(b=this.optNumber(a,ngeo.FeatureProperties.AZIMUT),goog.asserts.assertNumber(b),a=this.getRadiusLine(a,b),c=ngeo.interaction.MeasureAzimut.getFormattedAzimutRadius(a,this.projection_,this.decimals_,this.precision_,this.unitPrefixFormat_,this.numberFormat_)):c=ngeo.interaction.Measure.getFormattedArea(b,
this.projection_,this.precision_,this.unitPrefixFormat_):b instanceof ol.geom.LineString?c=ngeo.interaction.Measure.getFormattedLength(b,this.projection_,this.precision_,this.unitPrefixFormat_):b instanceof ol.geom.Point&&(null===this.pointFilterFn_?c=ngeo.interaction.Measure.getFormattedPoint(b,this.decimals_,this.ngeoNumberCoordinates_):(a=b.getCoordinates(),b=this.pointFilterArgs_.slice(0),b.unshift(a),c=this.pointFilterFn_.apply(this,[].concat($jscomp.arrayFromIterable(b)))));return c};
goog.exportProperty(ngeo.FeatureHelper.prototype,"getMeasure",ngeo.FeatureHelper.prototype.getMeasure);
ngeo.FeatureHelper.prototype.getType=function(a){var b=a.getGeometry();goog.asserts.assert(b,"Geometry should be thruthy");if(b instanceof ol.geom.Point)var c=a.get(ngeo.FeatureProperties.IS_TEXT)?ngeo.GeometryType.TEXT:ngeo.GeometryType.POINT;else b instanceof ol.geom.MultiPoint?c=ngeo.GeometryType.MULTI_POINT:b instanceof ol.geom.Polygon?c=a.get(ngeo.FeatureProperties.IS_CIRCLE)?ngeo.GeometryType.CIRCLE:a.get(ngeo.FeatureProperties.IS_RECTANGLE)?ngeo.GeometryType.RECTANGLE:ngeo.GeometryType.POLYGON:
b instanceof ol.geom.MultiPolygon?c=ngeo.GeometryType.MULTI_POLYGON:b instanceof ol.geom.LineString?c=ngeo.GeometryType.LINE_STRING:b instanceof ol.geom.MultiLineString&&(c=ngeo.GeometryType.MULTI_LINE_STRING);goog.asserts.assert(c,"Type should be thruthy");return c};goog.exportProperty(ngeo.FeatureHelper.prototype,"getType",ngeo.FeatureHelper.prototype.getType);
ngeo.FeatureHelper.prototype.panMapToFeature=function(a,b,c){c=void 0!==c?c:250;var d=b.getSize();goog.asserts.assertArray(d);b=b.getView();d=b.calculateExtent(d);a=a.getGeometry();a.intersectsExtent(d)||(d=b.getCenter(),goog.asserts.assertArray(d),a=a instanceof ol.geom.LineString?a.getCoordinateAt(.5):a instanceof ol.geom.Polygon?a.getInteriorPoint().getCoordinates():a instanceof ol.geom.Point?a.getCoordinates():ol.extent.getCenter(a.getExtent()),b.animate({center:d,duration:c},{center:a,duration:c}))};
goog.exportProperty(ngeo.FeatureHelper.prototype,"panMapToFeature",ngeo.FeatureHelper.prototype.panMapToFeature);ngeo.FeatureHelper.prototype.getRadiusLine=function(a,b){a=a.getGeometry();var c=a.getExtent();c=(c[3]-c[1])/2;a=ol.extent.getCenter(a.getExtent());return new ol.geom.LineString([a,[Math.cos((b-90)*Math.PI/180)*c+a[0],-Math.sin((b-90)*Math.PI/180)*c+a[1]]])};
ngeo.FeatureHelper.prototype.getNonSpatialProperties=function(a){var b=a.getGeometryName(),c={};a=a.getProperties();for(var d in a)d!==b&&(c[d]=a[d]);return c};goog.exportProperty(ngeo.FeatureHelper.prototype,"getNonSpatialProperties",ngeo.FeatureHelper.prototype.getNonSpatialProperties);ngeo.FeatureHelper.prototype.clearNonSpatialProperties=function(a){var b=a.getGeometryName(),c=a.getProperties(),d;for(d in c)d!==b&&a.set(d,void 0)};
goog.exportProperty(ngeo.FeatureHelper.prototype,"clearNonSpatialProperties",ngeo.FeatureHelper.prototype.clearNonSpatialProperties);ngeo.module.service("ngeoFeatureHelper",ngeo.FeatureHelper);ngeo.FeatureHelper.FormatType={GPX:"GPX",KML:"KML"};goog.exportSymbol("ngeo.FeatureHelper.FormatType",ngeo.FeatureHelper.FormatType);ngeo.rule={};ngeo.rule.Rule=function(a){this.active_=!0===a.active;this.expression=void 0!==a.expression?a.expression:null;this.lowerBoundary_=void 0!==a.lowerBoundary?a.lowerBoundary:null;this.operator_=a.operator||null;this.upperBoundary_=void 0!==a.upperBoundary?a.upperBoundary:null;this.isCustom_=!1!==a.isCustom;this.name_=a.name;this.operators_=a.operators||null;this.propertyName_=a.propertyName;this.type_=goog.asserts.assert(a.type);this.listenerKeys=[]};
ngeo.rule.Rule.prototype.getExpression=function(){return this.expression};goog.exportProperty(ngeo.rule.Rule.prototype,"getExpression",ngeo.rule.Rule.prototype.getExpression);ngeo.rule.Rule.prototype.setExpression=function(a){this.expression=a};goog.exportProperty(ngeo.rule.Rule.prototype,"setExpression",ngeo.rule.Rule.prototype.setExpression);
ngeo.rule.Rule.prototype.reset=function(){null!==this.getExpression()&&this.setExpression(null);null!==this.lowerBoundary&&(this.lowerBoundary=null);null!==this.upperBoundary&&(this.upperBoundary=null)};goog.exportProperty(ngeo.rule.Rule.prototype,"reset",ngeo.rule.Rule.prototype.reset);ngeo.rule.Rule.prototype.destroy=function(){ol.Observable.unByKey(this.listenerKeys);this.listenerKeys.length=0};goog.exportProperty(ngeo.rule.Rule.prototype,"destroy",ngeo.rule.Rule.prototype.destroy);
$jscomp.global.Object.defineProperties(ngeo.rule.Rule.prototype,{active:{configurable:!0,enumerable:!0,get:function(){return this.active_},set:function(a){this.active_=a}},lowerBoundary:{configurable:!0,enumerable:!0,get:function(){return this.lowerBoundary_},set:function(a){this.lowerBoundary_=a}},operator:{configurable:!0,enumerable:!0,get:function(){return this.operator_},set:function(a){this.operator_=a}},upperBoundary:{configurable:!0,enumerable:!0,get:function(){return this.upperBoundary_},
set:function(a){this.upperBoundary_=a}},isCustom:{configurable:!0,enumerable:!0,get:function(){return this.isCustom_}},name:{configurable:!0,enumerable:!0,get:function(){return this.name_}},operators:{configurable:!0,enumerable:!0,get:function(){return this.operators_}},propertyName:{configurable:!0,enumerable:!0,get:function(){return this.propertyName_}},type:{configurable:!0,enumerable:!0,get:function(){return this.type_}},value:{configurable:!0,enumerable:!0,get:function(){var a=null,b=this.getExpression(),
c=this.lowerBoundary,d=this.operator,e=this.propertyName,f=this.upperBoundary;d&&(d===ngeo.rule.Rule.OperatorType.BETWEEN||d===ngeo.rule.Rule.TemporalOperatorType.DURING?null!==c&&null!==f&&(a={operator:d,lowerBoundary:c,propertyName:e,upperBoundary:f}):null!==b&&(a={expression:b,operator:d,propertyName:e}));return a}}});ngeo.rule.Rule.OperatorType={BETWEEN:"..",EQUAL_TO:"=",GREATER_THAN:">",GREATER_THAN_OR_EQUAL_TO:">=",LESSER_THAN:"<",LESSER_THAN_OR_EQUAL_TO:"<=",LIKE:"~",NOT_EQUAL_TO:"!="};
ngeo.rule.Rule.SpatialOperatorType={CONTAINS:"contains",INTERSECTS:"intersects",WITHIN:"within"};ngeo.rule.Rule.TemporalOperatorType={BEGINS:"time_start",DURING:"time_during",ENDS:"time_end",EQUALS:"time_equal"};ngeo.rule.Date=function(a){a.type=a.type||ngeo.AttributeType.DATE;ngeo.rule.Rule.call(this,a)};$jscomp.inherits(ngeo.rule.Date,ngeo.rule.Rule);ngeo.rule.Date.TemporalOperatorType=ngeo.rule.Rule.TemporalOperatorType;ngeo.rule.Date.SpatialOperatorType=ngeo.rule.Rule.SpatialOperatorType;ngeo.rule.Date.OperatorType=ngeo.rule.Rule.OperatorType;ol.format.JSONFeature=function(){ol.format.Feature.call(this)};ol.inherits(ol.format.JSONFeature,ol.format.Feature);ol.format.JSONFeature.prototype.getObject_=function(a){return"string"===typeof a?(a=JSON.parse(a))?a:null:null!==a?a:null};ol.format.JSONFeature.prototype.getType=function(){return ol.format.FormatType.JSON};ol.format.JSONFeature.prototype.readFeature=function(a,b){return this.readFeatureFromObject(this.getObject_(a),this.getReadOptions(a,b))};
ol.format.JSONFeature.prototype.readFeatures=function(a,b){return this.readFeaturesFromObject(this.getObject_(a),this.getReadOptions(a,b))};ol.format.JSONFeature.prototype.readFeatureFromObject=function(a,b){};ol.format.JSONFeature.prototype.readFeaturesFromObject=function(a,b){};ol.format.JSONFeature.prototype.readGeometry=function(a,b){return this.readGeometryFromObject(this.getObject_(a),this.getReadOptions(a,b))};ol.format.JSONFeature.prototype.readGeometryFromObject=function(a,b){};
ol.format.JSONFeature.prototype.readProjection=function(a){return this.readProjectionFromObject(this.getObject_(a))};ol.format.JSONFeature.prototype.readProjectionFromObject=function(a){};ol.format.JSONFeature.prototype.writeFeature=function(a,b){return JSON.stringify(this.writeFeatureObject(a,b))};ol.format.JSONFeature.prototype.writeFeatureObject=function(a,b){};ol.format.JSONFeature.prototype.writeFeatures=function(a,b){return JSON.stringify(this.writeFeaturesObject(a,b))};
ol.format.JSONFeature.prototype.writeFeaturesObject=function(a,b){};ol.format.JSONFeature.prototype.writeGeometry=function(a,b){return JSON.stringify(this.writeGeometryObject(a,b))};ol.format.JSONFeature.prototype.writeGeometryObject=function(a,b){};ol.format.GeoJSON=function(a){a=a?a:{};ol.format.JSONFeature.call(this);this.defaultDataProjection=ol.proj.get(a.defaultDataProjection?a.defaultDataProjection:"EPSG:4326");a.featureProjection&&(this.defaultFeatureProjection=ol.proj.get(a.featureProjection));this.geometryName_=a.geometryName;this.extractGeometryName_=a.extractGeometryName};ol.inherits(ol.format.GeoJSON,ol.format.JSONFeature);
ol.format.GeoJSON.readGeometry_=function(a,b){return a?ol.format.Feature.transformWithOptions((0,ol.format.GeoJSON.GEOMETRY_READERS_[a.type])(a),!1,b):null};ol.format.GeoJSON.readGeometryCollectionGeometry_=function(a,b){a=a.geometries.map(function(a){return ol.format.GeoJSON.readGeometry_(a,b)});return new ol.geom.GeometryCollection(a)};ol.format.GeoJSON.readPointGeometry_=function(a){return new ol.geom.Point(a.coordinates)};ol.format.GeoJSON.readLineStringGeometry_=function(a){return new ol.geom.LineString(a.coordinates)};
ol.format.GeoJSON.readMultiLineStringGeometry_=function(a){return new ol.geom.MultiLineString(a.coordinates)};ol.format.GeoJSON.readMultiPointGeometry_=function(a){return new ol.geom.MultiPoint(a.coordinates)};ol.format.GeoJSON.readMultiPolygonGeometry_=function(a){return new ol.geom.MultiPolygon(a.coordinates)};ol.format.GeoJSON.readPolygonGeometry_=function(a){return new ol.geom.Polygon(a.coordinates)};
ol.format.GeoJSON.writeGeometry_=function(a,b){return(0,ol.format.GeoJSON.GEOMETRY_WRITERS_[a.getType()])(ol.format.Feature.transformWithOptions(a,!0,b),b)};ol.format.GeoJSON.writeEmptyGeometryCollectionGeometry_=function(a){return{type:"GeometryCollection",geometries:[]}};
ol.format.GeoJSON.writeGeometryCollectionGeometry_=function(a,b){return{type:"GeometryCollection",geometries:a.getGeometriesArray().map(function(a){var c=ol.obj.assign({},b);delete c.featureProjection;return ol.format.GeoJSON.writeGeometry_(a,c)})}};ol.format.GeoJSON.writeLineStringGeometry_=function(a,b){return{type:"LineString",coordinates:a.getCoordinates()}};ol.format.GeoJSON.writeMultiLineStringGeometry_=function(a,b){return{type:"MultiLineString",coordinates:a.getCoordinates()}};
ol.format.GeoJSON.writeMultiPointGeometry_=function(a,b){return{type:"MultiPoint",coordinates:a.getCoordinates()}};ol.format.GeoJSON.writeMultiPolygonGeometry_=function(a,b){if(b)var c=b.rightHanded;return{type:"MultiPolygon",coordinates:a.getCoordinates(c)}};ol.format.GeoJSON.writePointGeometry_=function(a,b){return{type:"Point",coordinates:a.getCoordinates()}};ol.format.GeoJSON.writePolygonGeometry_=function(a,b){if(b)var c=b.rightHanded;return{type:"Polygon",coordinates:a.getCoordinates(c)}};
ol.format.GeoJSON.GEOMETRY_READERS_={Point:ol.format.GeoJSON.readPointGeometry_,LineString:ol.format.GeoJSON.readLineStringGeometry_,Polygon:ol.format.GeoJSON.readPolygonGeometry_,MultiPoint:ol.format.GeoJSON.readMultiPointGeometry_,MultiLineString:ol.format.GeoJSON.readMultiLineStringGeometry_,MultiPolygon:ol.format.GeoJSON.readMultiPolygonGeometry_,GeometryCollection:ol.format.GeoJSON.readGeometryCollectionGeometry_};
ol.format.GeoJSON.GEOMETRY_WRITERS_={Point:ol.format.GeoJSON.writePointGeometry_,LineString:ol.format.GeoJSON.writeLineStringGeometry_,Polygon:ol.format.GeoJSON.writePolygonGeometry_,MultiPoint:ol.format.GeoJSON.writeMultiPointGeometry_,MultiLineString:ol.format.GeoJSON.writeMultiLineStringGeometry_,MultiPolygon:ol.format.GeoJSON.writeMultiPolygonGeometry_,GeometryCollection:ol.format.GeoJSON.writeGeometryCollectionGeometry_,Circle:ol.format.GeoJSON.writeEmptyGeometryCollectionGeometry_};
ol.format.GeoJSON.prototype.readFeatureFromObject=function(a,b){a="Feature"===a.type?a:{type:"Feature",geometry:a};b=ol.format.GeoJSON.readGeometry_(a.geometry,b);var c=new ol.Feature;this.geometryName_?c.setGeometryName(this.geometryName_):this.extractGeometryName_&&void 0!==a.geometry_name&&c.setGeometryName(a.geometry_name);c.setGeometry(b);void 0!==a.id&&c.setId(a.id);a.properties&&c.setProperties(a.properties);return c};
ol.format.GeoJSON.prototype.readFeaturesFromObject=function(a,b){if("FeatureCollection"===a.type){var c=[];a=a.features;var d;var e=0;for(d=a.length;e<d;++e)c.push(this.readFeatureFromObject(a[e],b))}else c=[this.readFeatureFromObject(a,b)];return c};ol.format.GeoJSON.prototype.readGeometryFromObject=function(a,b){return ol.format.GeoJSON.readGeometry_(a,b)};
ol.format.GeoJSON.prototype.readProjectionFromObject=function(a){a=a.crs;var b;a?"name"==a.type?b=ol.proj.get(a.properties.name):ol.asserts.assert(!1,36):b=this.defaultDataProjection;return b};
ol.format.GeoJSON.prototype.writeFeatureObject=function(a,b){b=this.adaptOptions(b);var c={type:"Feature"},d=a.getId();void 0!==d&&(c.id=d);d=a.getGeometry();c.geometry=d?ol.format.GeoJSON.writeGeometry_(d,b):null;b=a.getProperties();delete b[a.getGeometryName()];ol.obj.isEmpty(b)?c.properties=null:c.properties=b;return c};
ol.format.GeoJSON.prototype.writeFeaturesObject=function(a,b){b=this.adaptOptions(b);var c=[],d;var e=0;for(d=a.length;e<d;++e)c.push(this.writeFeatureObject(a[e],b));return{type:"FeatureCollection",features:c}};ol.format.GeoJSON.prototype.writeGeometryObject=function(a,b){return ol.format.GeoJSON.writeGeometry_(a,this.adaptOptions(b))};ngeo.rule.Geometry=function(a){a.type=ngeo.AttributeType.GEOMETRY;ngeo.rule.Rule.call(this,a);this.feature_=new ol.Feature(a.featureProperties||{});this.format_=new ol.format.GeoJSON;this.updatingGeometry_=this.updatingExpression_=!1;this.geometryChangeListenerKey_=null;this.listenerKeys.push(ol.events.listen(this.feature_,ol.Object.getChangeEventType(this.feature.getGeometryName()),this.handleFeatureGeometryChange_,this));this.setGeometryFromExpression_()};$jscomp.inherits(ngeo.rule.Geometry,ngeo.rule.Rule);
ngeo.rule.Geometry.TemporalOperatorType=ngeo.rule.Rule.TemporalOperatorType;ngeo.rule.Geometry.SpatialOperatorType=ngeo.rule.Rule.SpatialOperatorType;ngeo.rule.Geometry.OperatorType=ngeo.rule.Rule.OperatorType;ngeo.rule.Geometry.prototype.setExpression=function(a){this.updatingExpression_=!0;ngeo.rule.Rule.prototype.setExpression.call(this,a);this.updatingGeometry_||this.setGeometryFromExpression_();this.registerGeometryChange_();this.updatingExpression_=!1};
ngeo.rule.Geometry.prototype.handleFeatureGeometryChange_=function(){if(!this.updatingExpression_){this.updatingGeometry_=!0;var a=this.feature_.getGeometry();this.expression=a?this.format_.writeGeometry(a):null;this.registerGeometryChange_();this.updatingGeometry_=!1}};ngeo.rule.Geometry.prototype.handleGeometryChange_=function(a){a=goog.asserts.assertInstanceof(a.target,ol.geom.Geometry);this.updatingGeometry_=!0;this.expression=this.format_.writeGeometry(a);this.updatingGeometry_=!1};
ngeo.rule.Geometry.prototype.setGeometryFromExpression_=function(){var a=null;this.expression&&(a=goog.asserts.assertString(this.expression),a=this.format_.readGeometry(a));this.geometry=a};
ngeo.rule.Geometry.prototype.registerGeometryChange_=function(){null!==this.geometryChangeListenerKey_&&(ol.Observable.unByKey(this.geometryChangeListenerKey_),this.geometryChangeListenerKey_=null);var a=this.feature_.getGeometry();a&&(this.geometryChangeListenerKey_=ol.events.listen(a,ol.events.EventType.CHANGE,this.handleGeometryChange_,this))};
$jscomp.global.Object.defineProperties(ngeo.rule.Geometry.prototype,{feature:{configurable:!0,enumerable:!0,get:function(){return this.feature_}},geometry:{configurable:!0,enumerable:!0,get:function(){return this.feature_.getGeometry()||null},set:function(a){this.feature_.setGeometry(a)}}});ngeo.rule.Select=function(a){a.operator=ngeo.rule.Rule.OperatorType.EQUAL_TO;a.type=ngeo.AttributeType.SELECT;ngeo.rule.Rule.call(this,a);this.choices_=a.choices};$jscomp.inherits(ngeo.rule.Select,ngeo.rule.Rule);ngeo.rule.Select.TemporalOperatorType=ngeo.rule.Rule.TemporalOperatorType;ngeo.rule.Select.SpatialOperatorType=ngeo.rule.Rule.SpatialOperatorType;ngeo.rule.Select.OperatorType=ngeo.rule.Rule.OperatorType;
$jscomp.global.Object.defineProperties(ngeo.rule.Select.prototype,{choices:{configurable:!0,enumerable:!0,get:function(){return this.choices_}},selectedChoices:{configurable:!0,enumerable:!0,get:function(){return this.expression?String(this.expression).split(","):[]}}});ngeo.rule.Text=function(a){a.operator=a.operator||ngeo.rule.Rule.OperatorType.LIKE;a.type=ngeo.AttributeType.TEXT;ngeo.rule.Rule.call(this,a)};$jscomp.inherits(ngeo.rule.Text,ngeo.rule.Rule);ngeo.rule.Text.TemporalOperatorType=ngeo.rule.Rule.TemporalOperatorType;ngeo.rule.Text.SpatialOperatorType=ngeo.rule.Rule.SpatialOperatorType;ngeo.rule.Text.OperatorType=ngeo.rule.Rule.OperatorType;ngeo.RuleHelper=function(a,b,c){this.gettextCatalog_=a;this.ngeoFeatureHelper_=b;this.ngeoWMSTime_=c};ngeo.RuleHelper.prototype.createRulesFromAttributes=function(a,b){var c=[];a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())c.push(this.createRuleFromAttribute(d.value,b));return c};goog.exportProperty(ngeo.RuleHelper.prototype,"createRulesFromAttributes",ngeo.RuleHelper.prototype.createRulesFromAttributes);
ngeo.RuleHelper.prototype.createRuleFromAttribute=function(a,b){b=!0===b;var c=this.gettextCatalog_.getString(a.name);switch(a.type){case ngeo.AttributeType.DATE:case ngeo.AttributeType.DATETIME:a=b?new ngeo.rule.Date({name:c,operator:ngeo.rule.Rule.TemporalOperatorType.EQUALS,operators:[ngeo.rule.Rule.TemporalOperatorType.EQUALS,ngeo.rule.Rule.TemporalOperatorType.BEGINS,ngeo.rule.Rule.TemporalOperatorType.ENDS],propertyName:a.name,type:a.type}):new ngeo.rule.Date({name:c,operator:ngeo.rule.Rule.TemporalOperatorType.DURING,
propertyName:a.name,type:a.type});break;case ngeo.AttributeType.GEOMETRY:a=new ngeo.rule.Geometry({name:c,operator:ngeo.rule.Rule.SpatialOperatorType.WITHIN,operators:[ngeo.rule.Rule.SpatialOperatorType.CONTAINS,ngeo.rule.Rule.SpatialOperatorType.INTERSECTS,ngeo.rule.Rule.SpatialOperatorType.WITHIN],propertyName:a.name,type:a.type});break;case ngeo.AttributeType.NUMBER:a=b?new ngeo.rule.Rule({name:c,operator:ngeo.rule.Rule.OperatorType.EQUAL_TO,operators:[ngeo.rule.Rule.OperatorType.EQUAL_TO,ngeo.rule.Rule.OperatorType.GREATER_THAN,
ngeo.rule.Rule.OperatorType.GREATER_THAN_OR_EQUAL_TO,ngeo.rule.Rule.OperatorType.LESSER_THAN,ngeo.rule.Rule.OperatorType.LESSER_THAN_OR_EQUAL_TO,ngeo.rule.Rule.OperatorType.NOT_EQUAL_TO],propertyName:a.name,type:ngeo.AttributeType.NUMBER}):new ngeo.rule.Rule({name:c,operator:ngeo.rule.Rule.OperatorType.BETWEEN,propertyName:a.name,type:ngeo.AttributeType.NUMBER});break;case ngeo.AttributeType.SELECT:a=new ngeo.rule.Select({choices:goog.asserts.assert(a.choices),name:c,propertyName:a.name});break;default:a=
b?new ngeo.rule.Text({name:c,operator:ngeo.rule.Rule.OperatorType.LIKE,operators:[ngeo.rule.Rule.OperatorType.LIKE,ngeo.rule.Rule.OperatorType.EQUAL_TO,ngeo.rule.Rule.OperatorType.NOT_EQUAL_TO],propertyName:a.name}):new ngeo.rule.Text({name:c,operator:ngeo.rule.Rule.OperatorType.LIKE,propertyName:a.name})}return a};goog.exportProperty(ngeo.RuleHelper.prototype,"createRuleFromAttribute",ngeo.RuleHelper.prototype.createRuleFromAttribute);
ngeo.RuleHelper.prototype.createRules=function(a){var b=[];a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())b.push(this.createRule(c.value));return b};goog.exportProperty(ngeo.RuleHelper.prototype,"createRules",ngeo.RuleHelper.prototype.createRules);
ngeo.RuleHelper.prototype.createRule=function(a){switch(a.type){case ngeo.AttributeType.DATE:case ngeo.AttributeType.DATETIME:a=new ngeo.rule.Date(a);break;case ngeo.AttributeType.GEOMETRY:a=new ngeo.rule.Geometry(a);break;case ngeo.AttributeType.SELECT:goog.asserts.assert(a.choices);a=new ngeo.rule.Select(a);break;default:a=new ngeo.rule.Text(a)}return a};goog.exportProperty(ngeo.RuleHelper.prototype,"createRule",ngeo.RuleHelper.prototype.createRule);
ngeo.RuleHelper.prototype.cloneRule=function(a){var b=a.getExpression();null===b&&(b=void 0);var c=a.isCustom,d=null!==a.lowerBoundary?a.lowerBoundary:void 0,e=a.name,f=null!==a.operator?a.operator:void 0,g=a.operators?a.operators.slice(0):void 0;b={expression:b,isCustom:c,lowerBoundary:d,name:e,operator:f,operators:g,propertyName:a.propertyName,type:null!==a.type?a.type:void 0,upperBoundary:null!==a.upperBoundary?a.upperBoundary:void 0};a instanceof ngeo.rule.Date?b=new ngeo.rule.Date(b):a instanceof
ngeo.rule.Geometry?(b=new ngeo.rule.Geometry(b),b.feature.setProperties(this.ngeoFeatureHelper_.getNonSpatialProperties(a.feature))):a instanceof ngeo.rule.Select?(b.choices=a.choices.slice(0),b=new ngeo.rule.Select(b)):b=a instanceof ngeo.rule.Text?new ngeo.rule.Text(b):new ngeo.rule.Rule(b);return b};goog.exportProperty(ngeo.RuleHelper.prototype,"cloneRule",ngeo.RuleHelper.prototype.cloneRule);
ngeo.RuleHelper.prototype.extendRule=function(a,b){b.getExpression()!==a.getExpression()&&b.setExpression(a.getExpression());b.lowerBoundary!==a.lowerBoundary&&(b.lowerBoundary=a.lowerBoundary);b.operator!==a.operator&&(b.operator=a.operator);b.upperBoundary!==a.upperBoundary&&(b.upperBoundary=a.upperBoundary);a instanceof ngeo.rule.Geometry&&b instanceof ngeo.rule.Geometry&&(this.ngeoFeatureHelper_.clearNonSpatialProperties(b.feature),b.feature.setProperties(this.ngeoFeatureHelper_.getNonSpatialProperties(a.feature)))};
goog.exportProperty(ngeo.RuleHelper.prototype,"extendRule",ngeo.RuleHelper.prototype.extendRule);ngeo.RuleHelper.prototype.serializeRules=function(a){var b=this;return a.map(function(a){return b.serializeRule(a)})};goog.exportProperty(ngeo.RuleHelper.prototype,"serializeRules",ngeo.RuleHelper.prototype.serializeRules);
ngeo.RuleHelper.prototype.serializeRule=function(a){var b={name:a.name,propertyName:a.propertyName,type:a.type};null!==a.expression&&(b.expression=a.expression);null!==a.lowerBoundary&&(b.lowerBoundary=a.lowerBoundary);null!==a.operator&&(b.operator=a.operator);null!==a.operators&&(b.operators=a.operators.slice(0));null!==a.upperBoundary&&(b.upperBoundary=a.upperBoundary);a instanceof ngeo.rule.Geometry&&(b.featureProperties=this.ngeoFeatureHelper_.getNonSpatialProperties(a.feature));a instanceof
ngeo.rule.Select&&(b.choices=a.choices);return b};goog.exportProperty(ngeo.RuleHelper.prototype,"serializeRule",ngeo.RuleHelper.prototype.serializeRule);
ngeo.RuleHelper.prototype.createFilter=function(a){var b=a.dataSource,c=null;if(a.filter)c=a.filter;else{var d=a.filterRules||b.filterRules,e=[];if(d&&d.length){d=$jscomp.makeIterator(d);for(var f=d.next();!f.done;f=d.next())(f=this.createFilterFromRule_(f.value,b,a.srsName))&&e.push(f)}d=b.filterCondition;if(1===e.length)c=e[0];else if(2<=e.length)if(d===ngeo.FilterCondition.AND)c=ol.format.filter.and.apply(null,e);else if(d===ngeo.FilterCondition.OR||d===ngeo.FilterCondition.NOT)c=ol.format.filter.or.apply(null,
e);c&&d===ngeo.FilterCondition.NOT&&(c=ol.format.filter.not(c))}a.incTime&&(a=this.createTimeFilterFromDataSource_(b))&&(c=c?ol.format.filter.and.apply(null,[c,a]):a);return c};goog.exportProperty(ngeo.RuleHelper.prototype,"createFilter",ngeo.RuleHelper.prototype.createFilter);ngeo.RuleHelper.prototype.createFilterString=function(a){var b=null;if(a=this.createFilter(a))b=ol.format.WFS.writeFilter(a),b=(new XMLSerializer).serializeToString(b);return b};
goog.exportProperty(ngeo.RuleHelper.prototype,"createFilterString",ngeo.RuleHelper.prototype.createFilterString);
ngeo.RuleHelper.prototype.createFilterFromRule_=function(a,b,c){var d=null,e=a.value;if(!e)return null;var f=e.expression,g=e.lowerBoundary,h=e.operator,k=e.propertyName,l=e.upperBoundary,m=ngeo.rule.Rule.OperatorType;e=ngeo.rule.Rule.SpatialOperatorType;var n=ngeo.rule.Rule.TemporalOperatorType,p=[e.CONTAINS,e.INTERSECTS,e.WITHIN],q=[m.GREATER_THAN,m.GREATER_THAN_OR_EQUAL_TO,m.LESSER_THAN,m.LESSER_THAN_OR_EQUAL_TO];if(a instanceof ngeo.rule.Date){if(h===n.DURING){var r=moment(g).format("YYYY-MM-DD");
var u=moment(l).format("YYYY-MM-DD")}else h===n.EQUALS?(r=moment(f).format("YYYY-MM-DD HH:mm:ss"),u=moment(f).add(1,"days").subtract(1,"seconds").format("YYYY-MM-DD HH:mm:ss")):h===n.BEGINS?(r=moment(f).format("YYYY-MM-DD"),u=moment(f).add(30,"years").format("YYYY-MM-DD")):h===n.ENDS&&(r="1970-01-01",u=moment(f).format("YYYY-MM-DD"));r&&u&&(d=ol.format.filter.during(k,r,u))}else if(a instanceof ngeo.rule.Select)if(h=a.selectedChoices,1===h.length)d=ol.format.filter.equalTo(k,h[0]);else{if(2<=h.length){d=
[];h=$jscomp.makeIterator(h);for(c=h.next();!c.done;c=h.next())d.push(ol.format.filter.equalTo(k,c.value));d=ol.format.filter.or.apply(null,d)}}else ol.array.includes(p,h)?(k=b.geometryName,goog.asserts.assertInstanceof(a,ngeo.rule.Geometry),a=goog.asserts.assert(a.geometry),h===e.CONTAINS?d=ol.format.filter.contains(k,a,c):h===e.INTERSECTS?d=ol.format.filter.intersects(k,a,c):h===e.WITHIN&&(d=ol.format.filter.within(k,a,c))):ol.array.includes(q,h)?(c=goog.asserts.assertNumber(f),h===m.GREATER_THAN?
d=ol.format.filter.greaterThan(k,c):h===m.GREATER_THAN_OR_EQUAL_TO?d=ol.format.filter.greaterThanOrEqualTo(k,c):h===m.LESSER_THAN?d=ol.format.filter.lessThan(k,c):h===m.LESSER_THAN_OR_EQUAL_TO&&(d=ol.format.filter.lessThanOrEqualTo(k,c))):h===m.BETWEEN?d=ol.format.filter.between(k,g,l):h===m.EQUAL_TO?d=ol.format.filter.equalTo(k,f):h===m.LIKE?(d=String(f).replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*"),d=ol.format.filter.like(k,"*"+d+"*")):h===m.NOT_EQUAL_TO&&(d=ol.format.filter.notEqualTo(k,
f));return d};
ngeo.RuleHelper.prototype.createTimeFilterFromDataSource_=function(a){var b=null,c=a.timeRangeValue,d=a.timeProperty;a=a.timeAttributeName;if(c&&d&&a)if(void 0!==c.end){var e=this.ngeoWMSTime_.formatWMSTimeParam(d,c).split("/");b=ol.format.filter.during(a,e[0],e[1])}else{var f=d.resolution||"seconds";c=this.ngeoWMSTime_.formatWMSTimeParam(d,c);switch(f){case "year":e=moment(c).add(1,"years").subtract(1,"seconds");break;case "month":e=moment(c).add(1,"months").subtract(1,"seconds");break;case "day":e=
moment(c).add(1,"days").subtract(1,"seconds")}e&&(b=moment(c).format("YYYY-MM-DD HH:mm:ss"),e=e.format("YYYY-MM-DD HH:mm:ss"),b=ol.format.filter.during(a,b,e))}return b};ngeo.RuleHelper.$inject=["gettextCatalog","ngeoFeatureHelper","ngeoWMSTime"];ngeo.module.service("ngeoRuleHelper",ngeo.RuleHelper);gmf.DataSourcesManager=function(a,b,c,d,e,f,g,h,k,l){this.q_=a;this.rootScope_=b;this.timeout_=c;this.gmfThemes_=d;this.gmfTreeManager_=e;this.ngeoBackgroundLayerMgr_=f;this.ngeoDataSources_=g;this.ngeoLayerHelper_=h;this.ngeoRuleHelper_=k;this.ngeoWMSTime_=l;this.dataSourcesCache_={};this.treeCtrlCache_={};this.treeCtrlsUnregister_=null;ol.events.listen(this.ngeoBackgroundLayerMgr_,ngeo.BackgroundEventType.CHANGE,this.handleNgeoBackgroundLayerChange_,this);ol.events.listen(this.gmfThemes_,gmf.ThemesEventType.CHANGE,
this.handleThemesChange_,this)};gmf.DataSourcesManager.prototype.setDimensions=function(a){this.dimensions_=a};
gmf.DataSourcesManager.prototype.handleThemesChange_=function(){var a=this;this.clearDataSources_();this.treeCtrlsUnregister_&&this.treeCtrlsUnregister_();this.clearTreeCtrlCache_();this.gmfThemes_.getOgcServersObject().then(function(b){var c=a.gmfThemes_.getThemesObject().then(function(c){c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next()){d=$jscomp.makeIterator(d.value.children);for(var e=d.next();!e.done;e=d.next())e=e.value,goog.asserts.assert(e),a.createDataSource_(e,e,b)}}),d=a.gmfThemes_.getBackgroundLayersObject().then(function(c){c=
$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next())a.createDataSource_(null,d.value,b)});a.q_.all([c,d]).then(function(){a.treeCtrlsUnregister_=a.rootScope_.$watchCollection(function(){if(a.gmfTreeManager_.rootCtrl)return a.gmfTreeManager_.rootCtrl.children},function(b){a.timeout_(function(){if(b){for(var c=[],d=function(a,b){b.node.children||a.push(b)},e=0,k=b.length;e<k;e++)b[e].traverseDepthFirst(d.bind(a,c));d=0;for(k=c.length;d<k;d++)e=c[d],a.getTreeCtrlCacheItem_(e)||a.addTreeCtrlToCache_(e);
k=a.treeCtrlCache_;for(var l in a.treeCtrlCache_)d=k[l],c.includes(d.treeCtrl)||a.removeTreeCtrlCacheItem_(d)}})})})})};gmf.DataSourcesManager.prototype.clearDataSources_=function(){this.ngeoDataSources_.clear();ol.obj.clear(this.dataSourcesCache_)};
gmf.DataSourcesManager.prototype.createDataSource_=function(a,b,c){var d=b.children;if(d){b=$jscomp.makeIterator(d);for(var e=b.next();!e.done;e=b.next())e=e.value,goog.asserts.assert(e),this.createDataSource_(a,e,c)}else if(d=ol.getUid(b),!this.dataSourcesCache_[d]){var f=b.metadata,g=b.type,h,k;if(g===gmf.Themes.NodeType.WMTS){var l=b.layer;var m=b.url;var n=f.maxResolution;var p=f.minResolution;(k=f.queryLayers||f.wmsLayers)&&(e=k.split(",").map(function(a){return{maxResolution:n,minResolution:p,
name:a,queryable:!0}}));f.ogcServer&&c[f.ogcServer]&&(h=c[f.ogcServer]);k=b.imageType}else if(g===gmf.Themes.NodeType.WMS)if(n=b.maxResolutionHint,p=b.minResolutionHint,e=b.childLayers.map(function(a){return{maxResolution:a.maxResolutionHint,minResolution:a.minResolutionHint,name:a.name,queryable:a.queryable}}),k=!a||a.mixed?b.ogcServer:a.ogcServer,goog.asserts.assert(k),h=c[k],k=h.imageType,b.time)var q=b.time;else a&&a.time&&(q=a.time);c=h?h.type:void 0;var r=h?h.isSingleTile:void 0,u=h&&h.wfsSupport?
h.urlWfs:void 0;h=h?h.url:void 0;var v=ngeo.DataSource.WFSOutputFormat.GML3;c===ngeo.DataSource.OGCServerType.QGISSERVER&&(v=ngeo.DataSource.WFSOutputFormat.GML2);var t=!!f.snappingConfig,w=f.snappingConfig?f.snappingConfig.tolerance:void 0,x=f.snappingConfig?f.snappingConfig.edge:void 0,z=f.snappingConfig?f.snappingConfig.vertex:void 0,y=this.dimensions_;a=b.dimensions||a.dimensions;if(q){var A=this.ngeoWMSTime_.getOptions(q).values;if(Array.isArray(A)){var C=A[0];var B=A[1]}else C=A}this.dataSourcesCache_[d]=
new gmf.DataSource({copyable:f.copyable,dimensions:y,dimensionsConfig:a,gmfLayer:b,id:d,identifierAttribute:f.identifierAttributeField,maxResolution:n,minResolution:p,name:b.name,ogcImageType:k,ogcLayers:e,ogcServerType:c,ogcType:g,snappable:t,snappingTolerance:w,snappingToEdges:x,snappingToVertice:z,timeAttributeName:f.timeAttribute,timeLowerValue:C,timeProperty:q,timeUpperValue:B,visible:!0===f.isChecked,wfsOutputFormat:v,wfsUrl:u,wmsIsSingleTile:r,wmsUrl:h,wmtsLayer:l,wmtsUrl:m})}};
gmf.DataSourcesManager.prototype.addTreeCtrlToCache_=function(a){var b=ol.getUid(a.node),c=this.dataSourcesCache_[b];goog.asserts.assert(c,"DataSource should be set");a.setDataSource(c);var d=this.rootScope_.$watch(function(){return a.getState()},this.handleTreeCtrlStateChange_.bind(this,a)),e=this.rootScope_.$watch(function(){var a=c.visible;return null!==c.filterRules&&a},this.handleDataSourceFilterRulesChange_.bind(this,c)),f;if(c.timeProperty&&c.ogcType===ngeo.DataSource.OGCType.WMS){var g=this.rootScope_.$watch(function(){return c.timeLowerValue},
this.handleDataSourceTimeValueChange_.bind(this,c));"range"===c.timeProperty.mode&&(f=this.rootScope_.$watch(function(){return c.timeUpperValue},this.handleDataSourceTimeValueChange_.bind(this,c)));var h=goog.asserts.assertInstanceof(gmf.SyncLayertreeMap.getLayer(a),ol.layer.Image)}this.treeCtrlCache_[b]={filterRulesWatcherUnregister:e,stateWatcherUnregister:d,timeLowerValueWatcherUnregister:g,timeUpperValueWatcherUnregister:f,treeCtrl:a,wmsLayer:h};this.ngeoDataSources_.push(c)};
gmf.DataSourcesManager.prototype.removeTreeCtrlCacheItem_=function(a){var b=a.treeCtrl.getDataSource();goog.asserts.assert(b,"DataSource should be set");this.ngeoDataSources_.remove(b);a.treeCtrl.setDataSource(null);a.filterRulesWatcherUnregister();a.stateWatcherUnregister();a.timeLowerValueWatcherUnregister&&a.timeLowerValueWatcherUnregister();a.timeUpperValueWatcherUnregister&&a.timeUpperValueWatcherUnregister();delete this.treeCtrlCache_[ol.getUid(a.treeCtrl.node)]};
gmf.DataSourcesManager.prototype.clearTreeCtrlCache_=function(){for(var a in this.treeCtrlCache_)this.removeTreeCtrlCacheItem_(this.treeCtrlCache_[a])};
gmf.DataSourcesManager.prototype.handleTreeCtrlStateChange_=function(a,b){var c=a.getDataSource();goog.asserts.assert(c,"DataSource should be set");c.visible="on"===b;a=gmf.SyncLayertreeMap.getLayer(a).get("querySourceIds");if(Array.isArray(a)){b=this.ngeoDataSources_.getArray();b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())if(d=d.value,null!==d.filterRules&&d.id!==c.id&&a.includes(d.id)&&d.visible){goog.asserts.assertInstanceof(d,gmf.DataSource);this.handleDataSourceFilterRulesChange_(d,
!0);break}}};gmf.DataSourcesManager.prototype.getTreeCtrlCacheItem_=function(a){return this.treeCtrlCache_[ol.getUid(a.node)]||null};
gmf.DataSourcesManager.prototype.handleDataSourceFilterRulesChange_=function(a,b){if(!0===a.filtrable&&a.ogcType===ngeo.DataSource.OGCType.WMS){b=ol.getUid(a.gmfLayer);b=this.treeCtrlCache_[b];goog.asserts.assert(b);var c=b.treeCtrl;b=gmf.SyncLayertreeMap.getLayer(c);goog.asserts.assert(b instanceof ol.layer.Image||b instanceof ol.layer.Tile);b=b.getSource();goog.asserts.assert(b instanceof ol.source.ImageWMS||b instanceof ol.source.TileWMS);var d=a.getFiltrableOGCLayerName();c=c.map.getView().getProjection().getCode();
a=a.visible?this.ngeoRuleHelper_.createFilterString({dataSource:a,projCode:c}):null;c=null;if(a)if(c=b.getParams().LAYERS.split(","),goog.asserts.assert(1<=c.length),1===c.length)c=a;else{for(var e=[],f=0,g=c.length;f<g;f++)c[f]===d?e.push("("+a+")"):e.push("()");c=e.join("")}d={};b.updateParams((d.FILTER=c,d))}};
gmf.DataSourcesManager.prototype.handleDataSourceTimeValueChange_=function(a){var b=ol.getUid(a.gmfLayer);b=this.treeCtrlCache_[b];goog.asserts.assert(b);b=goog.asserts.assert(b.wmsLayer);var c=goog.asserts.assertInstanceof(b.getSource(),ol.source.ImageWMS),d=goog.asserts.assert(a.timeProperty),e;(a=a.timeRangeValue)&&(e=this.ngeoWMSTime_.formatWMSTimeParam(d,a));c.getParams().TIME!==e&&this.ngeoLayerHelper_.updateWMSLayerState(b,c.getParams().LAYERS,e)};
gmf.DataSourcesManager.prototype.handleNgeoBackgroundLayerChange_=function(a){var b=a.previous,c=a.current;a=this.dataSourcesCache_;if(b&&(b=b.get("querySourceIds"),Array.isArray(b))){b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())if(d=a[d.value])d.visible=!1,this.ngeoDataSources_.remove(d)}if(c&&(c=c.get("querySourceIds"),Array.isArray(c)))for(c=$jscomp.makeIterator(c),d=c.next();!d.done;d=c.next())if(b=a[d.value])b.visible=!0,this.ngeoDataSources_.push(b)};
gmf.DataSourcesManager.$inject="$q $rootScope $timeout gmfThemes gmfTreeManager ngeoBackgroundLayerMgr ngeoDataSources ngeoLayerHelper ngeoRuleHelper ngeoWMSTime".split(" ");gmf.module.service("gmfDataSourcesManager",gmf.DataSourcesManager);ngeo.module.value("ngeoPopupTemplateUrl",function(a,b){a=b.ngeoPopupTemplateurl;return void 0!==a?a:ngeo.baseTemplateUrl+"/popup.html"});ngeo.popupDirective=function(a){return{restrict:"A",templateUrl:a,link:function(a,c,d){c.addClass("popover");a.close=function(a){a&&(a.stopPropagation(),a.preventDefault());c.addClass("hidden")};a.$watch("open",function(a,b){c.css("display",a?"block":"none")})}}};ngeo.popupDirective.$inject=["ngeoPopupTemplateUrl"];ngeo.module.directive("ngeoPopup",ngeo.popupDirective);ngeo.Popup=function(a,b,c,d){var e=this;this.scope=b.$new(!0);this.scope.$watch(function(){return e.scope.open},function(a){!a&&e.autoDestroy_&&e.timeout_(function(){e.destroy()})});this.sce_=c;this.timeout_=d;this.element_=angular.element("<div ngeo-popup></div>");this.autoDestroy_=!1;a(this.element_)(this.scope);angular.element(document.body).append(this.element_)};ngeo.Popup.prototype.getOpen=function(){return this.scope.open};goog.exportProperty(ngeo.Popup.prototype,"getOpen",ngeo.Popup.prototype.getOpen);
ngeo.Popup.prototype.setOpen=function(a){this.scope.open=a};goog.exportProperty(ngeo.Popup.prototype,"setOpen",ngeo.Popup.prototype.setOpen);ngeo.Popup.prototype.destroy=function(){this.scope.$destroy();this.element_.remove()};goog.exportProperty(ngeo.Popup.prototype,"destroy",ngeo.Popup.prototype.destroy);ngeo.Popup.prototype.setTitle=function(a){a=this.sce_.trustAsHtml(a);this.scope.title=a};goog.exportProperty(ngeo.Popup.prototype,"setTitle",ngeo.Popup.prototype.setTitle);
ngeo.Popup.prototype.setContent=function(a,b){this.scope.content=b?this.sce_.trustAsHtml(a):a};goog.exportProperty(ngeo.Popup.prototype,"setContent",ngeo.Popup.prototype.setContent);ngeo.Popup.prototype.setUrl=function(a){a=this.sce_.trustAsHtml('<iframe src="'+a+'" width="100%" height="100%"></iframe>');this.setContent(a)};goog.exportProperty(ngeo.Popup.prototype,"setUrl",ngeo.Popup.prototype.setUrl);ngeo.Popup.prototype.setWidth=function(a){this.element_.width(a)};
goog.exportProperty(ngeo.Popup.prototype,"setWidth",ngeo.Popup.prototype.setWidth);ngeo.Popup.prototype.setHeight=function(a){this.element_.height(a)};goog.exportProperty(ngeo.Popup.prototype,"setHeight",ngeo.Popup.prototype.setHeight);ngeo.Popup.prototype.setSize=function(a,b){this.setWidth(a);this.setHeight(b)};goog.exportProperty(ngeo.Popup.prototype,"setSize",ngeo.Popup.prototype.setSize);ngeo.Popup.prototype.setAutoDestroy=function(a){this.autoDestroy_=a};
goog.exportProperty(ngeo.Popup.prototype,"setAutoDestroy",ngeo.Popup.prototype.setAutoDestroy);ngeo.Popup.prototype.addClass=function(a){this.element_.addClass(a)};goog.exportProperty(ngeo.Popup.prototype,"addClass",ngeo.Popup.prototype.addClass);
ngeo.Popup.prototype.open=function(a){a.url?this.setUrl(a.url):a.content?this.setContent(a.content):goog.asserts.fail('ngeo.Popup options requirest "url" or "content".');void 0!==a.autoDestroy&&this.setAutoDestroy(a.autoDestroy);void 0!==a.cls&&this.addClass(a.cls);void 0!==a.height&&this.setHeight(a.height);void 0!==a.title&&this.setTitle(a.title);void 0!==a.width&&this.setWidth(a.width);this.setOpen(!0)};goog.exportProperty(ngeo.Popup.prototype,"open",ngeo.Popup.prototype.open);
ngeo.createPopupServiceFactory=function(a,b,c,d){return function(){return new ngeo.Popup(a,b,c,d)}};ngeo.createPopupServiceFactory.$inject=["$compile","$rootScope","$sce","$timeout"];ngeo.module.factory("ngeoCreatePopup",ngeo.createPopupServiceFactory);ngeo.Disclaimer=function(a,b,c){this.sce_=a;this.gettextCatalog_=b;this.createPopup_=c;ngeo.Message.call(this);a=angular.element('<div class="ngeo-disclaimer"></div>');angular.element(document.body).append(a);this.container_=a;this.messages_={}};ol.inherits(ngeo.Disclaimer,ngeo.Message);ngeo.Disclaimer.$inject=["$sce","gettextCatalog","ngeoCreatePopup"];ngeo.Disclaimer.prototype.alert=function(a){this.show(a)};goog.exportProperty(ngeo.Disclaimer.prototype,"alert",ngeo.Disclaimer.prototype.alert);
ngeo.Disclaimer.prototype.close=function(a){this.getMessageObjects(a).forEach(this.closeMessage_,this)};goog.exportProperty(ngeo.Disclaimer.prototype,"close",ngeo.Disclaimer.prototype.close);
ngeo.Disclaimer.prototype.showMessage=function(a){var b=this,c=this.gettextCatalog_,d=a.type;goog.asserts.assertString(d,"Type should be set.");var e=this.getMessageUid_(a);if(void 0===this.messages_[e])if(!0===a.popup)c=this.createPopup_(),d=this.sce_.trustAsHtml(a.msg),c.open({autoDestroy:!0,content:d,title:"&nbsp;"}),c.scope.$watch("open",function(c,d){c||b.closeMessage_(a)}),this.messages_[e]=c;else{var f=["alert","fade","alert-dismissible"];switch(d){case ngeo.MessageType.ERROR:f.push("alert-danger");
break;case ngeo.MessageType.INFORMATION:f.push("alert-info");break;case ngeo.MessageType.SUCCESS:f.push("alert-success");break;case ngeo.MessageType.WARNING:f.push("alert-warning")}d=angular.element('<div role="alert" class="'+f.join(" ")+'"></div>');c=angular.element('<button type="button" class="close" data-dismiss="alert" aria-label="'+c.getString("Close")+'"><span aria-hidden="true" class="fa fa-times"></span></button>');f=angular.element("<span />").html(a.msg);d.append(c).append(f);(a.target?
angular.element(a.target):this.container_).append(d);d.addClass("in");d.on("closed.bs.alert",function(){b.closeMessage_(a)});this.messages_[e]=d}};ngeo.Disclaimer.prototype.getMessageUid_=function(a){return a.msg+"-"+a.type};ngeo.Disclaimer.prototype.closeMessage_=function(a){a=this.getMessageUid_(a);var b=this.messages_[a];void 0!==b&&(b instanceof ngeo.Popup?b.getOpen()&&b.setOpen(!1):b.hasClass("in")&&b.alert("close"),delete this.messages_[a])};ngeo.module.service("ngeoDisclaimer",ngeo.Disclaimer);goog.debug.entryPointRegistry={};goog.debug.EntryPointMonitor=function(){};goog.debug.entryPointRegistry.refList_=[];goog.debug.entryPointRegistry.monitors_=[];goog.debug.entryPointRegistry.monitorsMayExist_=!1;goog.debug.entryPointRegistry.register=function(a){goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=a;if(goog.debug.entryPointRegistry.monitorsMayExist_)for(var b=goog.debug.entryPointRegistry.monitors_,c=0;c<b.length;c++)a(goog.bind(b[c].wrap,b[c]))};
goog.debug.entryPointRegistry.monitorAll=function(a){goog.debug.entryPointRegistry.monitorsMayExist_=!0;for(var b=goog.bind(a.wrap,a),c=0;c<goog.debug.entryPointRegistry.refList_.length;c++)goog.debug.entryPointRegistry.refList_[c](b);goog.debug.entryPointRegistry.monitors_.push(a)};
goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(a){var b=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(a==b[b.length-1],"Only the most recent monitor can be unwrapped.");a=goog.bind(a.unwrap,a);for(var c=0;c<goog.debug.entryPointRegistry.refList_.length;c++)goog.debug.entryPointRegistry.refList_[c](a);b.length--};goog.array={};goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE;goog.array.ASSUME_NATIVE_FUNCTIONS=!1;goog.array.peek=function(a){return a[a.length-1]};goog.array.last=goog.array.peek;
goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.indexOf)?function(a,b,c){goog.asserts.assert(null!=a.length);return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(goog.isString(a))return goog.isString(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};
goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.lastIndexOf)?function(a,b,c){goog.asserts.assert(null!=a.length);return Array.prototype.lastIndexOf.call(a,b,null==c?a.length-1:c)}:function(a,b,c){c=null==c?a.length-1:c;0>c&&(c=Math.max(0,a.length+c));if(goog.isString(a))return goog.isString(b)&&1==b.length?a.lastIndexOf(b,c):-1;for(;0<=c;c--)if(c in a&&a[c]===b)return c;return-1};
goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.forEach)?function(a,b,c){goog.asserts.assert(null!=a.length);Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};goog.array.forEachRight=function(a,b,c){var d=a.length,e=goog.isString(a)?a.split(""):a;for(--d;0<=d;--d)d in e&&b.call(c,e[d],d,a)};
goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.filter)?function(a,b,c){goog.asserts.assert(null!=a.length);return Array.prototype.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=goog.isString(a)?a.split(""):a,h=0;h<d;h++)if(h in g){var k=g[h];b.call(c,k,h,a)&&(e[f++]=k)}return e};
goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.map)?function(a,b,c){goog.asserts.assert(null!=a.length);return Array.prototype.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=goog.isString(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e};
goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduce)?function(a,b,c,d){goog.asserts.assert(null!=a.length);d&&(b=goog.bind(b,d));return Array.prototype.reduce.call(a,b,c)}:function(a,b,c,d){var e=c;goog.array.forEach(a,function(c,g){e=b.call(d,e,c,g,a)});return e};
goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduceRight)?function(a,b,c,d){goog.asserts.assert(null!=a.length);goog.asserts.assert(null!=b);d&&(b=goog.bind(b,d));return Array.prototype.reduceRight.call(a,b,c)}:function(a,b,c,d){var e=c;goog.array.forEachRight(a,function(c,g){e=b.call(d,e,c,g,a)});return e};
goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.some)?function(a,b,c){goog.asserts.assert(null!=a.length);return Array.prototype.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};
goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.every)?function(a,b,c){goog.asserts.assert(null!=a.length);return Array.prototype.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};goog.array.count=function(a,b,c){var d=0;goog.array.forEach(a,function(a,f,g){b.call(c,a,f,g)&&++d},c);return d};
goog.array.find=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};goog.array.findIndex=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1};goog.array.findRight=function(a,b,c){b=goog.array.findIndexRight(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};
goog.array.findIndexRight=function(a,b,c){var d=a.length,e=goog.isString(a)?a.split(""):a;for(--d;0<=d;d--)if(d in e&&b.call(c,e[d],d,a))return d;return-1};goog.array.contains=function(a,b){return 0<=goog.array.indexOf(a,b)};goog.array.isEmpty=function(a){return 0==a.length};goog.array.clear=function(a){if(!goog.isArray(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0};goog.array.insert=function(a,b){goog.array.contains(a,b)||a.push(b)};
goog.array.insertAt=function(a,b,c){goog.array.splice(a,c,0,b)};goog.array.insertArrayAt=function(a,b,c){goog.partial(goog.array.splice,a,c,0).apply(null,b)};goog.array.insertBefore=function(a,b,c){var d;2==arguments.length||0>(d=goog.array.indexOf(a,c))?a.push(b):goog.array.insertAt(a,b,d)};goog.array.remove=function(a,b){b=goog.array.indexOf(a,b);var c;(c=0<=b)&&goog.array.removeAt(a,b);return c};
goog.array.removeLast=function(a,b){b=goog.array.lastIndexOf(a,b);return 0<=b?(goog.array.removeAt(a,b),!0):!1};goog.array.removeAt=function(a,b){goog.asserts.assert(null!=a.length);return 1==Array.prototype.splice.call(a,b,1).length};goog.array.removeIf=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0<=b?(goog.array.removeAt(a,b),!0):!1};goog.array.removeAllIf=function(a,b,c){var d=0;goog.array.forEachRight(a,function(e,f){b.call(c,e,f,a)&&goog.array.removeAt(a,f)&&d++});return d};
goog.array.concat=function(a){return Array.prototype.concat.apply([],arguments)};goog.array.join=function(a){return Array.prototype.concat.apply([],arguments)};goog.array.toArray=function(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};goog.array.clone=goog.array.toArray;goog.array.extend=function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(goog.isArrayLike(d)){var e=a.length||0,f=d.length||0;a.length=e+f;for(var g=0;g<f;g++)a[e+g]=d[g]}else a.push(d)}};
goog.array.splice=function(a,b,c,d){goog.asserts.assert(null!=a.length);return Array.prototype.splice.apply(a,goog.array.slice(arguments,1))};goog.array.slice=function(a,b,c){goog.asserts.assert(null!=a.length);return 2>=arguments.length?Array.prototype.slice.call(a,b):Array.prototype.slice.call(a,b,c)};
goog.array.removeDuplicates=function(a,b,c){b=b||a;var d=function(a){return goog.isObject(a)?"o"+goog.getUid(a):(typeof a).charAt(0)+a};c=c||d;d={};for(var e=0,f=0;f<a.length;){var g=a[f++],h=c(g);Object.prototype.hasOwnProperty.call(d,h)||(d[h]=!0,b[e++]=g)}b.length=e};goog.array.binarySearch=function(a,b,c){return goog.array.binarySearch_(a,c||goog.array.defaultCompare,!1,b)};goog.array.binarySelect=function(a,b,c){return goog.array.binarySearch_(a,b,!0,void 0,c)};
goog.array.binarySearch_=function(a,b,c,d,e){for(var f=0,g=a.length,h;f<g;){var k=f+g>>1;var l=c?b.call(e,a[k],k,a):b(d,a[k]);0<l?f=k+1:(g=k,h=!l)}return h?f:~f};goog.array.sort=function(a,b){a.sort(b||goog.array.defaultCompare)};goog.array.stableSort=function(a,b){for(var c=Array(a.length),d=0;d<a.length;d++)c[d]={index:d,value:a[d]};var e=b||goog.array.defaultCompare;goog.array.sort(c,function(a,b){return e(a.value,b.value)||a.index-b.index});for(d=0;d<a.length;d++)a[d]=c[d].value};
goog.array.sortByKey=function(a,b,c){var d=c||goog.array.defaultCompare;goog.array.sort(a,function(a,c){return d(b(a),b(c))})};goog.array.sortObjectsByKey=function(a,b,c){goog.array.sortByKey(a,function(a){return a[b]},c)};goog.array.isSorted=function(a,b,c){b=b||goog.array.defaultCompare;for(var d=1;d<a.length;d++){var e=b(a[d-1],a[d]);if(0<e||0==e&&c)return!1}return!0};
goog.array.equals=function(a,b,c){if(!goog.isArrayLike(a)||!goog.isArrayLike(b)||a.length!=b.length)return!1;var d=a.length;c=c||goog.array.defaultCompareEquality;for(var e=0;e<d;e++)if(!c(a[e],b[e]))return!1;return!0};goog.array.compare3=function(a,b,c){c=c||goog.array.defaultCompare;for(var d=Math.min(a.length,b.length),e=0;e<d;e++){var f=c(a[e],b[e]);if(0!=f)return f}return goog.array.defaultCompare(a.length,b.length)};goog.array.defaultCompare=function(a,b){return a>b?1:a<b?-1:0};
goog.array.inverseDefaultCompare=function(a,b){return-goog.array.defaultCompare(a,b)};goog.array.defaultCompareEquality=function(a,b){return a===b};goog.array.binaryInsert=function(a,b,c){c=goog.array.binarySearch(a,b,c);return 0>c?(goog.array.insertAt(a,b,-(c+1)),!0):!1};goog.array.binaryRemove=function(a,b,c){b=goog.array.binarySearch(a,b,c);return 0<=b?goog.array.removeAt(a,b):!1};
goog.array.bucket=function(a,b,c){for(var d={},e=0;e<a.length;e++){var f=a[e],g=b.call(c,f,e,a);goog.isDef(g)&&(d[g]||(d[g]=[])).push(f)}return d};goog.array.toObject=function(a,b,c){var d={};goog.array.forEach(a,function(e,f){d[b.call(c,e,f,a)]=e});return d};goog.array.range=function(a,b,c){var d=[],e=0,f=a;c=c||1;void 0!==b&&(e=a,f=b);if(0>c*(f-e))return[];if(0<c)for(a=e;a<f;a+=c)d.push(a);else for(a=e;a>f;a+=c)d.push(a);return d};
goog.array.repeat=function(a,b){for(var c=[],d=0;d<b;d++)c[d]=a;return c};goog.array.flatten=function(a){for(var b=[],c=0;c<arguments.length;c++){var d=arguments[c];if(goog.isArray(d))for(var e=0;e<d.length;e+=8192){var f=goog.array.slice(d,e,e+8192);f=goog.array.flatten.apply(null,f);for(var g=0;g<f.length;g++)b.push(f[g])}else b.push(d)}return b};
goog.array.rotate=function(a,b){goog.asserts.assert(null!=a.length);a.length&&(b%=a.length,0<b?Array.prototype.unshift.apply(a,a.splice(-b,b)):0>b&&Array.prototype.push.apply(a,a.splice(0,-b)));return a};goog.array.moveItem=function(a,b,c){goog.asserts.assert(0<=b&&b<a.length);goog.asserts.assert(0<=c&&c<a.length);b=Array.prototype.splice.call(a,b,1);Array.prototype.splice.call(a,c,0,b[0])};
goog.array.zip=function(a){if(!arguments.length)return[];for(var b=[],c=arguments[0].length,d=1;d<arguments.length;d++)arguments[d].length<c&&(c=arguments[d].length);for(d=0;d<c;d++){for(var e=[],f=0;f<arguments.length;f++)e.push(arguments[f][d]);b.push(e)}return b};goog.array.shuffle=function(a,b){b=b||Math.random;for(var c=a.length-1;0<c;c--){var d=Math.floor(b()*(c+1)),e=a[c];a[c]=a[d];a[d]=e}};goog.array.copyByIndex=function(a,b){var c=[];goog.array.forEach(b,function(b){c.push(a[b])});return c};
goog.array.concatMap=function(a,b,c){return goog.array.concat.apply([],goog.array.map(a,b,c))};goog.labs={};goog.labs.userAgent={};goog.labs.userAgent.util={};goog.labs.userAgent.util.getNativeUserAgentString_=function(){var a=goog.labs.userAgent.util.getNavigator_();return a&&(a=a.userAgent)?a:""};goog.labs.userAgent.util.getNavigator_=function(){return goog.global.navigator};goog.labs.userAgent.util.userAgent_=goog.labs.userAgent.util.getNativeUserAgentString_();goog.labs.userAgent.util.setUserAgent=function(a){goog.labs.userAgent.util.userAgent_=a||goog.labs.userAgent.util.getNativeUserAgentString_()};
goog.labs.userAgent.util.getUserAgent=function(){return goog.labs.userAgent.util.userAgent_};goog.labs.userAgent.util.matchUserAgent=function(a){var b=goog.labs.userAgent.util.getUserAgent();return goog.string.contains(b,a)};goog.labs.userAgent.util.matchUserAgentIgnoreCase=function(a){var b=goog.labs.userAgent.util.getUserAgent();return goog.string.caseInsensitiveContains(b,a)};
goog.labs.userAgent.util.extractVersionTuples=function(a){for(var b=/(\w[\w ]+)\/([^\s]+)\s*(?:\((.*?)\))?/g,c=[],d;d=b.exec(a);)c.push([d[1],d[2],d[3]||void 0]);return c};goog.object={};goog.object.is=function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b};goog.object.forEach=function(a,b,c){for(var d in a)b.call(c,a[d],d,a)};goog.object.filter=function(a,b,c){var d={},e;for(e in a)b.call(c,a[e],e,a)&&(d[e]=a[e]);return d};goog.object.map=function(a,b,c){var d={},e;for(e in a)d[e]=b.call(c,a[e],e,a);return d};goog.object.some=function(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return!0;return!1};
goog.object.every=function(a,b,c){for(var d in a)if(!b.call(c,a[d],d,a))return!1;return!0};goog.object.getCount=function(a){var b=0,c;for(c in a)b++;return b};goog.object.getAnyKey=function(a){for(var b in a)return b};goog.object.getAnyValue=function(a){for(var b in a)return a[b]};goog.object.contains=function(a,b){return goog.object.containsValue(a,b)};goog.object.getValues=function(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b};
goog.object.getKeys=function(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b};goog.object.getValueByKeys=function(a,b){var c=goog.isArrayLike(b),d=c?b:arguments;for(c=c?0:1;c<d.length&&(a=a[d[c]],goog.isDef(a));c++);return a};goog.object.containsKey=function(a,b){return null!==a&&b in a};goog.object.containsValue=function(a,b){for(var c in a)if(a[c]==b)return!0;return!1};goog.object.findKey=function(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return d};
goog.object.findValue=function(a,b,c){return(b=goog.object.findKey(a,b,c))&&a[b]};goog.object.isEmpty=function(a){for(var b in a)return!1;return!0};goog.object.clear=function(a){for(var b in a)delete a[b]};goog.object.remove=function(a,b){var c;(c=b in a)&&delete a[b];return c};goog.object.add=function(a,b,c){if(null!==a&&b in a)throw Error('The object already contains the key "'+b+'"');goog.object.set(a,b,c)};goog.object.get=function(a,b,c){return null!==a&&b in a?a[b]:c};
goog.object.set=function(a,b,c){a[b]=c};goog.object.setIfUndefined=function(a,b,c){return b in a?a[b]:a[b]=c};goog.object.setWithReturnValueIfNotSet=function(a,b,c){if(b in a)return a[b];c=c();return a[b]=c};goog.object.equals=function(a,b){for(var c in a)if(!(c in b)||a[c]!==b[c])return!1;for(c in b)if(!(c in a))return!1;return!0};goog.object.clone=function(a){var b={},c;for(c in a)b[c]=a[c];return b};
goog.object.unsafeClone=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(goog.isFunction(a.clone))return a.clone();b="array"==b?[]:{};for(var c in a)b[c]=goog.object.unsafeClone(a[c]);return b}return a};goog.object.transpose=function(a){var b={},c;for(c in a)b[a[c]]=c;return b};goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.object.extend=function(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<goog.object.PROTOTYPE_FIELDS_.length;f++)c=goog.object.PROTOTYPE_FIELDS_[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};
goog.object.create=function(a){var b=arguments.length;if(1==b&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(b%2)throw Error("Uneven number of arguments");for(var c={},d=0;d<b;d+=2)c[arguments[d]]=arguments[d+1];return c};goog.object.createSet=function(a){var b=arguments.length;if(1==b&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c};
goog.object.createImmutableView=function(a){var b=a;Object.isFrozen&&!Object.isFrozen(a)&&(b=Object.create(a),Object.freeze(b));return b};goog.object.isImmutableView=function(a){return!!Object.isFrozen&&Object.isFrozen(a)};
goog.object.getAllPropertyNames=function(a,b,c){if(!a)return[];if(!Object.getOwnPropertyNames||!Object.getPrototypeOf)return goog.object.getKeys(a);for(var d={};a&&(a!==Object.prototype||b)&&(a!==Function.prototype||c);){for(var e=Object.getOwnPropertyNames(a),f=0;f<e.length;f++)d[e[f]]=!0;a=Object.getPrototypeOf(a)}return goog.object.getKeys(d)};goog.labs.userAgent.browser={};goog.labs.userAgent.browser.matchOpera_=function(){return goog.labs.userAgent.util.matchUserAgent("Opera")};goog.labs.userAgent.browser.matchIE_=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")};goog.labs.userAgent.browser.matchEdge_=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")};goog.labs.userAgent.browser.matchFirefox_=function(){return goog.labs.userAgent.util.matchUserAgent("Firefox")};
goog.labs.userAgent.browser.matchSafari_=function(){return goog.labs.userAgent.util.matchUserAgent("Safari")&&!(goog.labs.userAgent.browser.matchChrome_()||goog.labs.userAgent.browser.matchCoast_()||goog.labs.userAgent.browser.matchOpera_()||goog.labs.userAgent.browser.matchEdge_()||goog.labs.userAgent.browser.isSilk()||goog.labs.userAgent.util.matchUserAgent("Android"))};goog.labs.userAgent.browser.matchCoast_=function(){return goog.labs.userAgent.util.matchUserAgent("Coast")};
goog.labs.userAgent.browser.matchIosWebview_=function(){return(goog.labs.userAgent.util.matchUserAgent("iPad")||goog.labs.userAgent.util.matchUserAgent("iPhone"))&&!goog.labs.userAgent.browser.matchSafari_()&&!goog.labs.userAgent.browser.matchChrome_()&&!goog.labs.userAgent.browser.matchCoast_()&&goog.labs.userAgent.util.matchUserAgent("AppleWebKit")};
goog.labs.userAgent.browser.matchChrome_=function(){return(goog.labs.userAgent.util.matchUserAgent("Chrome")||goog.labs.userAgent.util.matchUserAgent("CriOS"))&&!goog.labs.userAgent.browser.matchEdge_()};goog.labs.userAgent.browser.matchAndroidBrowser_=function(){return goog.labs.userAgent.util.matchUserAgent("Android")&&!(goog.labs.userAgent.browser.isChrome()||goog.labs.userAgent.browser.isFirefox()||goog.labs.userAgent.browser.isOpera()||goog.labs.userAgent.browser.isSilk())};
goog.labs.userAgent.browser.isOpera=goog.labs.userAgent.browser.matchOpera_;goog.labs.userAgent.browser.isIE=goog.labs.userAgent.browser.matchIE_;goog.labs.userAgent.browser.isEdge=goog.labs.userAgent.browser.matchEdge_;goog.labs.userAgent.browser.isFirefox=goog.labs.userAgent.browser.matchFirefox_;goog.labs.userAgent.browser.isSafari=goog.labs.userAgent.browser.matchSafari_;goog.labs.userAgent.browser.isCoast=goog.labs.userAgent.browser.matchCoast_;goog.labs.userAgent.browser.isIosWebview=goog.labs.userAgent.browser.matchIosWebview_;
goog.labs.userAgent.browser.isChrome=goog.labs.userAgent.browser.matchChrome_;goog.labs.userAgent.browser.isAndroidBrowser=goog.labs.userAgent.browser.matchAndroidBrowser_;goog.labs.userAgent.browser.isSilk=function(){return goog.labs.userAgent.util.matchUserAgent("Silk")};
goog.labs.userAgent.browser.getVersion=function(){function a(a){a=goog.array.find(a,d);return c[a]||""}var b=goog.labs.userAgent.util.getUserAgent();if(goog.labs.userAgent.browser.isIE())return goog.labs.userAgent.browser.getIEVersion_(b);b=goog.labs.userAgent.util.extractVersionTuples(b);var c={};goog.array.forEach(b,function(a){c[a[0]]=a[1]});var d=goog.partial(goog.object.containsKey,c);return goog.labs.userAgent.browser.isOpera()?a(["Version","Opera"]):goog.labs.userAgent.browser.isEdge()?a(["Edge"]):
goog.labs.userAgent.browser.isChrome()?a(["Chrome","CriOS"]):(b=b[2])&&b[1]||""};goog.labs.userAgent.browser.isVersionOrHigher=function(a){return 0<=goog.string.compareVersions(goog.labs.userAgent.browser.getVersion(),a)};
goog.labs.userAgent.browser.getIEVersion_=function(a){var b=/rv: *([\d\.]*)/.exec(a);if(b&&b[1])return b[1];b="";var c=/MSIE +([\d\.]+)/.exec(a);if(c&&c[1])if(a=/Trident\/(\d.\d)/.exec(a),"7.0"==c[1])if(a&&a[1])switch(a[1]){case "4.0":b="8.0";break;case "5.0":b="9.0";break;case "6.0":b="10.0";break;case "7.0":b="11.0"}else b="7.0";else b=c[1];return b};goog.labs.userAgent.engine={};goog.labs.userAgent.engine.isPresto=function(){return goog.labs.userAgent.util.matchUserAgent("Presto")};goog.labs.userAgent.engine.isTrident=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")};goog.labs.userAgent.engine.isEdge=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")};
goog.labs.userAgent.engine.isWebKit=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("WebKit")&&!goog.labs.userAgent.engine.isEdge()};goog.labs.userAgent.engine.isGecko=function(){return goog.labs.userAgent.util.matchUserAgent("Gecko")&&!goog.labs.userAgent.engine.isWebKit()&&!goog.labs.userAgent.engine.isTrident()&&!goog.labs.userAgent.engine.isEdge()};
goog.labs.userAgent.engine.getVersion=function(){var a=goog.labs.userAgent.util.getUserAgent();if(a){a=goog.labs.userAgent.util.extractVersionTuples(a);var b=goog.labs.userAgent.engine.getEngineTuple_(a);if(b)return"Gecko"==b[0]?goog.labs.userAgent.engine.getVersionForKey_(a,"Firefox"):b[1];a=a[0];var c;if(a&&(c=a[2])&&(c=/Trident\/([^\s;]+)/.exec(c)))return c[1]}return""};
goog.labs.userAgent.engine.getEngineTuple_=function(a){if(!goog.labs.userAgent.engine.isEdge())return a[1];for(var b=0;b<a.length;b++){var c=a[b];if("Edge"==c[0])return c}};goog.labs.userAgent.engine.isVersionOrHigher=function(a){return 0<=goog.string.compareVersions(goog.labs.userAgent.engine.getVersion(),a)};goog.labs.userAgent.engine.getVersionForKey_=function(a,b){return(a=goog.array.find(a,function(a){return b==a[0]}))&&a[1]||""};goog.labs.userAgent.platform={};goog.labs.userAgent.platform.isAndroid=function(){return goog.labs.userAgent.util.matchUserAgent("Android")};goog.labs.userAgent.platform.isIpod=function(){return goog.labs.userAgent.util.matchUserAgent("iPod")};goog.labs.userAgent.platform.isIphone=function(){return goog.labs.userAgent.util.matchUserAgent("iPhone")&&!goog.labs.userAgent.util.matchUserAgent("iPod")&&!goog.labs.userAgent.util.matchUserAgent("iPad")};goog.labs.userAgent.platform.isIpad=function(){return goog.labs.userAgent.util.matchUserAgent("iPad")};
goog.labs.userAgent.platform.isIos=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpad()||goog.labs.userAgent.platform.isIpod()};goog.labs.userAgent.platform.isMacintosh=function(){return goog.labs.userAgent.util.matchUserAgent("Macintosh")};goog.labs.userAgent.platform.isLinux=function(){return goog.labs.userAgent.util.matchUserAgent("Linux")};goog.labs.userAgent.platform.isWindows=function(){return goog.labs.userAgent.util.matchUserAgent("Windows")};
goog.labs.userAgent.platform.isChromeOS=function(){return goog.labs.userAgent.util.matchUserAgent("CrOS")};
goog.labs.userAgent.platform.getVersion=function(){var a=goog.labs.userAgent.util.getUserAgent();var b="";goog.labs.userAgent.platform.isWindows()?(b=/Windows (?:NT|Phone) ([0-9.]+)/,b=(a=b.exec(a))?a[1]:"0.0"):goog.labs.userAgent.platform.isIos()?(b=/(?:iPhone|iPod|iPad|CPU)\s+OS\s+(\S+)/,b=(a=b.exec(a))&&a[1].replace(/_/g,".")):goog.labs.userAgent.platform.isMacintosh()?(b=/Mac OS X ([0-9_.]+)/,b=(a=b.exec(a))?a[1].replace(/_/g,"."):"10"):goog.labs.userAgent.platform.isAndroid()?(b=/Android\s+([^\);]+)(\)|;)/,
b=(a=b.exec(a))&&a[1]):goog.labs.userAgent.platform.isChromeOS()&&(b=/(?:CrOS\s+(?:i686|x86_64)\s+([0-9.]+))/,b=(a=b.exec(a))&&a[1]);return b||""};goog.labs.userAgent.platform.isVersionOrHigher=function(a){return 0<=goog.string.compareVersions(goog.labs.userAgent.platform.getVersion(),a)};goog.reflect={};goog.reflect.object=function(a,b){return b};goog.reflect.objectProperty=function(a,b){return a};goog.reflect.sinkValue=function(a){goog.reflect.sinkValue[" "](a);return a};goog.reflect.sinkValue[" "]=goog.nullFunction;goog.reflect.canAccessProperty=function(a,b){try{return goog.reflect.sinkValue(a[b]),!0}catch(c){}return!1};goog.reflect.cache=function(a,b,c,d){d=d?d(b):b;return Object.prototype.hasOwnProperty.call(a,d)?a[d]:a[d]=c(b)};goog.userAgent={};goog.userAgent.ASSUME_IE=!1;goog.userAgent.ASSUME_EDGE=!1;goog.userAgent.ASSUME_GECKO=!1;goog.userAgent.ASSUME_WEBKIT=!1;goog.userAgent.ASSUME_MOBILE_WEBKIT=!1;goog.userAgent.ASSUME_OPERA=!1;goog.userAgent.ASSUME_ANY_VERSION=!1;goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA;goog.userAgent.getUserAgentString=function(){return goog.labs.userAgent.util.getUserAgent()};
goog.userAgent.getNavigator=function(){return goog.global.navigator||null};goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.labs.userAgent.browser.isOpera();goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.labs.userAgent.browser.isIE();goog.userAgent.EDGE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_EDGE:goog.labs.userAgent.engine.isEdge();goog.userAgent.EDGE_OR_IE=goog.userAgent.EDGE||goog.userAgent.IE;
goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.labs.userAgent.engine.isGecko();goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.labs.userAgent.engine.isWebKit();goog.userAgent.isMobile_=function(){return goog.userAgent.WEBKIT&&goog.labs.userAgent.util.matchUserAgent("Mobile")};goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.isMobile_();goog.userAgent.SAFARI=goog.userAgent.WEBKIT;
goog.userAgent.determinePlatform_=function(){var a=goog.userAgent.getNavigator();return a&&a.platform||""};goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_();goog.userAgent.ASSUME_MAC=!1;goog.userAgent.ASSUME_WINDOWS=!1;goog.userAgent.ASSUME_LINUX=!1;goog.userAgent.ASSUME_X11=!1;goog.userAgent.ASSUME_ANDROID=!1;goog.userAgent.ASSUME_IPHONE=!1;goog.userAgent.ASSUME_IPAD=!1;goog.userAgent.ASSUME_IPOD=!1;
goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD;goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.labs.userAgent.platform.isMacintosh();goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.labs.userAgent.platform.isWindows();
goog.userAgent.isLegacyLinux_=function(){return goog.labs.userAgent.platform.isLinux()||goog.labs.userAgent.platform.isChromeOS()};goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.isLegacyLinux_();goog.userAgent.isX11_=function(){var a=goog.userAgent.getNavigator();return!!a&&goog.string.contains(a.appVersion||"","X11")};goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.isX11_();
goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.labs.userAgent.platform.isAndroid();goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.labs.userAgent.platform.isIphone();goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad();goog.userAgent.IPOD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIpod();
goog.userAgent.IOS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIos();goog.userAgent.determineVersion_=function(){var a="",b=goog.userAgent.getVersionRegexResult_();b&&(a=b?b[1]:"");return goog.userAgent.IE&&(b=goog.userAgent.getDocumentMode_(),null!=b&&b>parseFloat(a))?String(b):a};
goog.userAgent.getVersionRegexResult_=function(){var a=goog.userAgent.getUserAgentString();if(goog.userAgent.GECKO)return/rv\:([^\);]+)(\)|;)/.exec(a);if(goog.userAgent.EDGE)return/Edge\/([\d\.]+)/.exec(a);if(goog.userAgent.IE)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(goog.userAgent.WEBKIT)return/WebKit\/(\S+)/.exec(a);if(goog.userAgent.OPERA)return/(?:Version)[ \/]?(\S+)/.exec(a)};goog.userAgent.getDocumentMode_=function(){var a=goog.global.document;return a?a.documentMode:void 0};
goog.userAgent.VERSION=goog.userAgent.determineVersion_();goog.userAgent.compare=function(a,b){return goog.string.compareVersions(a,b)};goog.userAgent.isVersionOrHigherCache_={};goog.userAgent.isVersionOrHigher=function(a){return goog.userAgent.ASSUME_ANY_VERSION||goog.reflect.cache(goog.userAgent.isVersionOrHigherCache_,a,function(){return 0<=goog.string.compareVersions(goog.userAgent.VERSION,a)})};goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher;
goog.userAgent.isDocumentModeOrHigher=function(a){return Number(goog.userAgent.DOCUMENT_MODE)>=a};goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher;goog.userAgent.DOCUMENT_MODE=function(){var a=goog.global.document,b=goog.userAgent.getDocumentMode_();if(a&&goog.userAgent.IE)return b||("CSS1Compat"==a.compatMode?parseInt(goog.userAgent.VERSION,10):5)}();goog.events={};$jscomp.scope.purify=function(a){return a()};
goog.events.BrowserFeature={HAS_W3C_BUTTON:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),HAS_W3C_EVENT_SUPPORT:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),SET_KEY_CODE_TO_PREVENT_DEFAULT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),HAS_NAVIGATOR_ONLINE_PROPERTY:!goog.userAgent.WEBKIT||goog.userAgent.isVersionOrHigher("528"),HAS_HTML5_NETWORK_EVENT_SUPPORT:goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9b")||goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("8")||
goog.userAgent.OPERA&&goog.userAgent.isVersionOrHigher("9.5")||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("528"),HTML5_NETWORK_EVENTS_FIRE_ON_BODY:goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("8")||goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),TOUCH_ENABLED:"ontouchstart"in goog.global||!!(goog.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!goog.global.navigator||!goog.global.navigator.msMaxTouchPoints),PASSIVE_EVENTS:(0,$jscomp.scope.purify)(function(){if(!goog.global.addEventListener||
!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});goog.global.addEventListener("test",goog.nullFunction,b);goog.global.removeEventListener("test",goog.nullFunction,b);return a})};goog.disposable={};goog.disposable.IDisposable=function(){};goog.disposable.IDisposable.prototype.dispose=goog.abstractMethod;goog.disposable.IDisposable.prototype.isDisposed=goog.abstractMethod;goog.Disposable=function(){goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF&&(goog.Disposable.INCLUDE_STACK_ON_CREATION&&(this.creationStack=Error().stack),goog.Disposable.instances_[goog.getUid(this)]=this);this.disposed_=this.disposed_;this.onDisposeCallbacks_=this.onDisposeCallbacks_};goog.Disposable.MonitoringMode={OFF:0,PERMANENT:1,INTERACTIVE:2};goog.Disposable.MONITORING_MODE=0;goog.Disposable.INCLUDE_STACK_ON_CREATION=!0;goog.Disposable.instances_={};
goog.Disposable.getUndisposedObjects=function(){var a=[],b;for(b in goog.Disposable.instances_)goog.Disposable.instances_.hasOwnProperty(b)&&a.push(goog.Disposable.instances_[Number(b)]);return a};goog.Disposable.clearUndisposedObjects=function(){goog.Disposable.instances_={}};goog.Disposable.prototype.disposed_=!1;goog.Disposable.prototype.isDisposed=function(){return this.disposed_};goog.Disposable.prototype.getDisposed=goog.Disposable.prototype.isDisposed;
goog.Disposable.prototype.dispose=function(){if(!this.disposed_&&(this.disposed_=!0,this.disposeInternal(),goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF)){var a=goog.getUid(this);if(goog.Disposable.MONITORING_MODE==goog.Disposable.MonitoringMode.PERMANENT&&!goog.Disposable.instances_.hasOwnProperty(a))throw Error(this+" did not call the goog.Disposable base constructor or was disposed of after a clearUndisposedObjects call");delete goog.Disposable.instances_[a]}};
goog.Disposable.prototype.registerDisposable=function(a){this.addOnDisposeCallback(goog.partial(goog.dispose,a))};goog.Disposable.prototype.addOnDisposeCallback=function(a,b){this.disposed_?goog.isDef(b)?a.call(b):a():(this.onDisposeCallbacks_||(this.onDisposeCallbacks_=[]),this.onDisposeCallbacks_.push(goog.isDef(b)?goog.bind(a,b):a))};goog.Disposable.prototype.disposeInternal=function(){if(this.onDisposeCallbacks_)for(;this.onDisposeCallbacks_.length;)this.onDisposeCallbacks_.shift()()};
goog.Disposable.isDisposed=function(a){return a&&"function"==typeof a.isDisposed?a.isDisposed():!1};goog.dispose=function(a){a&&"function"==typeof a.dispose&&a.dispose()};goog.disposeAll=function(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];goog.isArrayLike(d)?goog.disposeAll.apply(null,d):goog.dispose(d)}};goog.events.EventId=function(a){this.id=a};goog.events.EventId.prototype.toString=function(){return this.id};goog.events.Event=function(a,b){this.type=a instanceof goog.events.EventId?String(a):a;this.currentTarget=this.target=b;this.defaultPrevented=this.propagationStopped_=!1;this.returnValue_=!0};goog.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=!0};goog.events.Event.prototype.preventDefault=function(){this.defaultPrevented=!0;this.returnValue_=!1};goog.events.Event.stopPropagation=function(a){a.stopPropagation()};goog.events.Event.preventDefault=function(a){a.preventDefault()};goog.events.getVendorPrefixedName_=function(a){return goog.userAgent.WEBKIT?"webkit"+a:goog.userAgent.OPERA?"o"+a.toLowerCase():a.toLowerCase()};
goog.events.EventType={CLICK:"click",RIGHTCLICK:"rightclick",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",SELECTIONCHANGE:"selectionchange",SELECTSTART:"selectstart",WHEEL:"wheel",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:goog.userAgent.IE?"focusin":"DOMFocusIn",FOCUSOUT:goog.userAgent.IE?"focusout":"DOMFocusOut",
CHANGE:"change",RESET:"reset",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",DRAG:"drag",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",DRAGEND:"dragend",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",BEFOREUNLOAD:"beforeunload",CONSOLEMESSAGE:"consolemessage",CONTEXTMENU:"contextmenu",DEVICEMOTION:"devicemotion",DEVICEORIENTATION:"deviceorientation",DOMCONTENTLOADED:"DOMContentLoaded",
ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",ORIENTATIONCHANGE:"orientationchange",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",CANPLAY:"canplay",CANPLAYTHROUGH:"canplaythrough",DURATIONCHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",LOADEDDATA:"loadeddata",LOADEDMETADATA:"loadedmetadata",PAUSE:"pause",PLAY:"play",PLAYING:"playing",RATECHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIMEUPDATE:"timeupdate",
VOLUMECHANGE:"volumechange",WAITING:"waiting",SOURCEOPEN:"sourceopen",SOURCEENDED:"sourceended",SOURCECLOSED:"sourceclosed",ABORT:"abort",UPDATE:"update",UPDATESTART:"updatestart",UPDATEEND:"updateend",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",COPY:"copy",PASTE:"paste",CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",INSTALL:"install",ACTIVATE:"activate",
FETCH:"fetch",FOREIGNFETCH:"foreignfetch",MESSAGEERROR:"messageerror",STATECHANGE:"statechange",UPDATEFOUND:"updatefound",CONTROLLERCHANGE:"controllerchange",ANIMATIONSTART:goog.events.getVendorPrefixedName_("AnimationStart"),ANIMATIONEND:goog.events.getVendorPrefixedName_("AnimationEnd"),ANIMATIONITERATION:goog.events.getVendorPrefixedName_("AnimationIteration"),TRANSITIONEND:goog.events.getVendorPrefixedName_("TransitionEnd"),POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTERCANCEL:"pointercancel",
POINTERMOVE:"pointermove",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",MSGESTURECHANGE:"MSGestureChange",MSGESTUREEND:"MSGestureEnd",MSGESTUREHOLD:"MSGestureHold",MSGESTURESTART:"MSGestureStart",MSGESTURETAP:"MSGestureTap",MSGOTPOINTERCAPTURE:"MSGotPointerCapture",MSINERTIASTART:"MSInertiaStart",MSLOSTPOINTERCAPTURE:"MSLostPointerCapture",MSPOINTERCANCEL:"MSPointerCancel",
MSPOINTERDOWN:"MSPointerDown",MSPOINTERENTER:"MSPointerEnter",MSPOINTERHOVER:"MSPointerHover",MSPOINTERLEAVE:"MSPointerLeave",MSPOINTERMOVE:"MSPointerMove",MSPOINTEROUT:"MSPointerOut",MSPOINTEROVER:"MSPointerOver",MSPOINTERUP:"MSPointerUp",TEXT:"text",TEXTINPUT:goog.userAgent.IE?"textinput":"textInput",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend",BEFOREINPUT:"beforeinput",EXIT:"exit",LOADABORT:"loadabort",LOADCOMMIT:"loadcommit",LOADREDIRECT:"loadredirect",
LOADSTART:"loadstart",LOADSTOP:"loadstop",RESPONSIVE:"responsive",SIZECHANGED:"sizechanged",UNRESPONSIVE:"unresponsive",VISIBILITYCHANGE:"visibilitychange",STORAGE:"storage",DOMSUBTREEMODIFIED:"DOMSubtreeModified",DOMNODEINSERTED:"DOMNodeInserted",DOMNODEREMOVED:"DOMNodeRemoved",DOMNODEREMOVEDFROMDOCUMENT:"DOMNodeRemovedFromDocument",DOMNODEINSERTEDINTODOCUMENT:"DOMNodeInsertedIntoDocument",DOMATTRMODIFIED:"DOMAttrModified",DOMCHARACTERDATAMODIFIED:"DOMCharacterDataModified",BEFOREPRINT:"beforeprint",
AFTERPRINT:"afterprint"};goog.events.BrowserEvent=function(a,b){goog.events.Event.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.key="";this.charCode=this.keyCode=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.platformModifierKey=!1;this.event_=null;a&&this.init(a,b)};goog.inherits(goog.events.BrowserEvent,goog.events.Event);
goog.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2};goog.events.BrowserEvent.IEButtonMap=[1,4,2];
goog.events.BrowserEvent.prototype.init=function(a,b){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;(b=a.relatedTarget)?goog.userAgent.GECKO&&(goog.reflect.canAccessProperty(b,"nodeName")||(b=null)):c==goog.events.EventType.MOUSEOVER?b=a.fromElement:c==goog.events.EventType.MOUSEOUT&&(b=a.toElement);this.relatedTarget=b;goog.isNull(d)?(this.offsetX=goog.userAgent.WEBKIT||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=
goog.userAgent.WEBKIT||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0);this.button=a.button;this.keyCode=a.keyCode||0;this.key=a.key||"";this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=
a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.platformModifierKey=goog.userAgent.MAC?a.metaKey:a.ctrlKey;this.state=a.state;this.event_=a;a.defaultPrevented&&this.preventDefault()};goog.events.BrowserEvent.prototype.isButton=function(a){return goog.events.BrowserFeature.HAS_W3C_BUTTON?this.event_.button==a:"click"==this.type?a==goog.events.BrowserEvent.MouseButton.LEFT:!!(this.event_.button&goog.events.BrowserEvent.IEButtonMap[a])};
goog.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT)&&!(goog.userAgent.WEBKIT&&goog.userAgent.MAC&&this.ctrlKey)};goog.events.BrowserEvent.prototype.stopPropagation=function(){goog.events.BrowserEvent.superClass_.stopPropagation.call(this);this.event_.stopPropagation?this.event_.stopPropagation():this.event_.cancelBubble=!0};
goog.events.BrowserEvent.prototype.preventDefault=function(){goog.events.BrowserEvent.superClass_.preventDefault.call(this);var a=this.event_;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};goog.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_};goog.events.Listenable=function(){};goog.events.Listenable.IMPLEMENTED_BY_PROP="closure_listenable_"+(1E6*Math.random()|0);goog.events.Listenable.addImplementation=function(a){a.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP]=!0};goog.events.Listenable.isImplementedBy=function(a){return!(!a||!a[goog.events.Listenable.IMPLEMENTED_BY_PROP])};goog.events.ListenableKey=function(){};goog.events.ListenableKey.counter_=0;goog.events.ListenableKey.reserveKey=function(){return++goog.events.ListenableKey.counter_};goog.events.Listener=function(a,b,c,d,e,f){goog.events.Listener.ENABLE_MONITORING&&(this.creationStack=Error().stack);this.listener=a;this.proxy=b;this.src=c;this.type=d;this.capture=!!e;this.handler=f;this.key=goog.events.ListenableKey.reserveKey();this.removed=this.callOnce=!1};goog.events.Listener.ENABLE_MONITORING=!1;goog.events.Listener.prototype.markAsRemoved=function(){this.removed=!0;this.handler=this.src=this.proxy=this.listener=null};goog.events.ListenerMap=function(a){this.src=a;this.listeners={};this.typeCount_=0};goog.events.ListenerMap.prototype.getTypeCount=function(){return this.typeCount_};goog.events.ListenerMap.prototype.getListenerCount=function(){var a=0,b;for(b in this.listeners)a+=this.listeners[b].length;return a};
goog.events.ListenerMap.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.listeners[f];a||(a=this.listeners[f]=[],this.typeCount_++);var g=goog.events.ListenerMap.findListenerIndex_(a,b,d,e);-1<g?(b=a[g],c||(b.callOnce=!1)):(b=new goog.events.Listener(b,null,this.src,f,!!d,e),b.callOnce=c,a.push(b));return b};
goog.events.ListenerMap.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.listeners))return!1;var e=this.listeners[a];b=goog.events.ListenerMap.findListenerIndex_(e,b,c,d);return-1<b?(e[b].markAsRemoved(),goog.array.removeAt(e,b),0==e.length&&(delete this.listeners[a],this.typeCount_--),!0):!1};
goog.events.ListenerMap.prototype.removeByKey=function(a){var b=a.type;if(!(b in this.listeners))return!1;var c=goog.array.remove(this.listeners[b],a);c&&(a.markAsRemoved(),0==this.listeners[b].length&&(delete this.listeners[b],this.typeCount_--));return c};goog.events.ListenerMap.prototype.removeAll=function(a){a=a&&a.toString();var b=0,c;for(c in this.listeners)if(!a||c==a){for(var d=this.listeners[c],e=0;e<d.length;e++)++b,d[e].markAsRemoved();delete this.listeners[c];this.typeCount_--}return b};
goog.events.ListenerMap.prototype.getListeners=function(a,b){a=this.listeners[a.toString()];var c=[];if(a)for(var d=0;d<a.length;++d){var e=a[d];e.capture==b&&c.push(e)}return c};goog.events.ListenerMap.prototype.getListener=function(a,b,c,d){a=this.listeners[a.toString()];var e=-1;a&&(e=goog.events.ListenerMap.findListenerIndex_(a,b,c,d));return-1<e?a[e]:null};
goog.events.ListenerMap.prototype.hasListener=function(a,b){var c=goog.isDef(a),d=c?a.toString():"",e=goog.isDef(b);return goog.object.some(this.listeners,function(a,g){for(g=0;g<a.length;++g)if(!(c&&a[g].type!=d||e&&a[g].capture!=b))return!0;return!1})};goog.events.ListenerMap.findListenerIndex_=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.listener==b&&f.capture==!!c&&f.handler==d)return e}return-1};goog.events.LISTENER_MAP_PROP_="closure_lm_"+(1E6*Math.random()|0);goog.events.onString_="on";goog.events.onStringMap_={};goog.events.CaptureSimulationMode={OFF_AND_FAIL:0,OFF_AND_SILENT:1,ON:2};goog.events.CAPTURE_SIMULATION_MODE=2;goog.events.listenerCountEstimate_=0;
goog.events.listen=function(a,b,c,d,e){if(d&&d.once)return goog.events.listenOnce(a,b,c,d,e);if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.listen(a,b[f],c,d,e);return null}c=goog.events.wrapListener(c);return goog.events.Listenable.isImplementedBy(a)?(d=goog.isObject(d)?!!d.capture:!!d,a.listen(b,c,d,e)):goog.events.listen_(a,b,c,!1,d,e)};
goog.events.listen_=function(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=goog.isObject(e)?!!e.capture:!!e;if(g&&!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_FAIL)return goog.asserts.fail("Can not register capture listener in IE8-."),null;if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_SILENT)return null}var h=goog.events.getListenerMap_(a);h||(a[goog.events.LISTENER_MAP_PROP_]=
h=new goog.events.ListenerMap(a));c=h.add(b,c,d,g,f);if(c.proxy)return c;d=goog.events.getProxy();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)goog.events.BrowserFeature.PASSIVE_EVENTS||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(goog.events.getOnString_(b.toString()),d);else throw Error("addEventListener and attachEvent are unavailable.");goog.events.listenerCountEstimate_++;return c};
goog.events.getProxy=function(){var a=goog.events.handleBrowserEvent_,b=goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b};
goog.events.listenOnce=function(a,b,c,d,e){if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.listenOnce(a,b[f],c,d,e);return null}c=goog.events.wrapListener(c);return goog.events.Listenable.isImplementedBy(a)?(d=goog.isObject(d)?!!d.capture:!!d,a.listenOnce(b,c,d,e)):goog.events.listen_(a,b,c,!0,d,e)};goog.events.listenWithWrapper=function(a,b,c,d,e){b.listen(a,c,d,e)};
goog.events.unlisten=function(a,b,c,d,e){if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.unlisten(a,b[f],c,d,e);return null}d=goog.isObject(d)?!!d.capture:!!d;c=goog.events.wrapListener(c);if(goog.events.Listenable.isImplementedBy(a))return a.unlisten(b,c,d,e);if(!a)return!1;if(a=goog.events.getListenerMap_(a))if(b=a.getListener(b,c,d,e))return goog.events.unlistenByKey(b);return!1};
goog.events.unlistenByKey=function(a){if(goog.isNumber(a)||!a||a.removed)return!1;var b=a.src;if(goog.events.Listenable.isImplementedBy(b))return b.unlistenByKey(a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent&&b.detachEvent(goog.events.getOnString_(c),d);goog.events.listenerCountEstimate_--;(c=goog.events.getListenerMap_(b))?(c.removeByKey(a),0==c.getTypeCount()&&(c.src=null,b[goog.events.LISTENER_MAP_PROP_]=null)):a.markAsRemoved();return!0};
goog.events.unlistenWithWrapper=function(a,b,c,d,e){b.unlisten(a,c,d,e)};goog.events.removeAll=function(a,b){if(!a)return 0;if(goog.events.Listenable.isImplementedBy(a))return a.removeAllListeners(b);a=goog.events.getListenerMap_(a);if(!a)return 0;var c=0;b=b&&b.toString();for(var d in a.listeners)if(!b||d==b)for(var e=a.listeners[d].concat(),f=0;f<e.length;++f)goog.events.unlistenByKey(e[f])&&++c;return c};
goog.events.getListeners=function(a,b,c){return goog.events.Listenable.isImplementedBy(a)?a.getListeners(b,c):a?(a=goog.events.getListenerMap_(a))?a.getListeners(b,c):[]:[]};goog.events.getListener=function(a,b,c,d,e){c=goog.events.wrapListener(c);d=!!d;return goog.events.Listenable.isImplementedBy(a)?a.getListener(b,c,d,e):a?(a=goog.events.getListenerMap_(a))?a.getListener(b,c,d,e):null:null};
goog.events.hasListener=function(a,b,c){if(goog.events.Listenable.isImplementedBy(a))return a.hasListener(b,c);a=goog.events.getListenerMap_(a);return!!a&&a.hasListener(b,c)};goog.events.expose=function(a){var b=[],c;for(c in a)a[c]&&a[c].id?b.push(c+" = "+a[c]+" ("+a[c].id+")"):b.push(c+" = "+a[c]);return b.join("\n")};goog.events.getOnString_=function(a){return a in goog.events.onStringMap_?goog.events.onStringMap_[a]:goog.events.onStringMap_[a]=goog.events.onString_+a};
goog.events.fireListeners=function(a,b,c,d){return goog.events.Listenable.isImplementedBy(a)?a.fireListeners(b,c,d):goog.events.fireListeners_(a,b,c,d)};goog.events.fireListeners_=function(a,b,c,d){var e=!0;if(a=goog.events.getListenerMap_(a))if(b=a.listeners[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.removed&&(f=goog.events.fireListener(f,d),e=e&&!1!==f)}return e};
goog.events.fireListener=function(a,b){var c=a.listener,d=a.handler||a.src;a.callOnce&&goog.events.unlistenByKey(a);return c.call(d,b)};goog.events.getTotalListenerCount=function(){return goog.events.listenerCountEstimate_};goog.events.dispatchEvent=function(a,b){goog.asserts.assert(goog.events.Listenable.isImplementedBy(a),"Can not use goog.events.dispatchEvent with non-goog.events.Listenable instance.");return a.dispatchEvent(b)};
goog.events.protectBrowserEventEntryPoint=function(a){goog.events.handleBrowserEvent_=a.protectEntryPoint(goog.events.handleBrowserEvent_)};
goog.events.handleBrowserEvent_=function(a,b){if(a.removed)return!0;if(!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){var c=b||goog.getObjectByName("window.event");b=new goog.events.BrowserEvent(c,this);var d=!0;if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.ON){if(!goog.events.isMarkedIeEvent_(c)){goog.events.markIeEvent_(c);c=[];for(var e=b.currentTarget;e;e=e.parentNode)c.push(e);e=a.type;for(var f=c.length-1;!b.propagationStopped_&&0<=f;f--)b.currentTarget=c[f],
a=goog.events.fireListeners_(c[f],e,!0,b),d=d&&a;for(f=0;!b.propagationStopped_&&f<c.length;f++)b.currentTarget=c[f],a=goog.events.fireListeners_(c[f],e,!1,b),d=d&&a}}else d=goog.events.fireListener(a,b);return d}return goog.events.fireListener(a,new goog.events.BrowserEvent(b,this))};goog.events.markIeEvent_=function(a){var b=!1;if(0==a.keyCode)try{a.keyCode=-1;return}catch(c){b=!0}if(b||void 0==a.returnValue)a.returnValue=!0};
goog.events.isMarkedIeEvent_=function(a){return 0>a.keyCode||void 0!=a.returnValue};goog.events.uniqueIdCounter_=0;goog.events.getUniqueId=function(a){return a+"_"+goog.events.uniqueIdCounter_++};goog.events.getListenerMap_=function(a){a=a[goog.events.LISTENER_MAP_PROP_];return a instanceof goog.events.ListenerMap?a:null};goog.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(1E9*Math.random()>>>0);
goog.events.wrapListener=function(a){goog.asserts.assert(a,"Listener can not be null.");if(goog.isFunction(a))return a;goog.asserts.assert(a.handleEvent,"An object listener must have handleEvent method.");a[goog.events.LISTENER_WRAPPER_PROP_]||(a[goog.events.LISTENER_WRAPPER_PROP_]=function(b){return a.handleEvent(b)});return a[goog.events.LISTENER_WRAPPER_PROP_]};goog.debug.entryPointRegistry.register(function(a){goog.events.handleBrowserEvent_=a(goog.events.handleBrowserEvent_)});ngeo.EventHelper=function(){this.listenerKeys_={}};ngeo.EventHelper.prototype.addListenerKey=function(a,b,c){this.listenerKeys_[a]||this.initListenerKey_(a);(void 0!==c?c:1)?this.listenerKeys_[a].ol.push(b):this.listenerKeys_[a].goog.push(b)};goog.exportProperty(ngeo.EventHelper.prototype,"addListenerKey",ngeo.EventHelper.prototype.addListenerKey);ngeo.EventHelper.prototype.clearListenerKey=function(a){this.initListenerKey_(a)};goog.exportProperty(ngeo.EventHelper.prototype,"clearListenerKey",ngeo.EventHelper.prototype.clearListenerKey);
ngeo.EventHelper.prototype.initListenerKey_=function(a){this.listenerKeys_[a]?(this.listenerKeys_[a].goog.length&&(this.listenerKeys_[a].goog.forEach(function(a){goog.events.unlistenByKey(a)},this),this.listenerKeys_[a].goog.length=0),this.listenerKeys_[a].ol.length&&(this.listenerKeys_[a].ol.forEach(function(a){ol.events.unlistenByKey(a)},this),this.listenerKeys_[a].ol.length=0)):this.listenerKeys_[a]={goog:[],ol:[]}};ngeo.module.service("ngeoEventHelper",ngeo.EventHelper);gmf.disclaimerComponent={controller:"GmfDisclaimerController as dclCtrl",bindings:{popup:"<?gmfDisclaimerPopup",map:"=gmfDisclaimerMap",external:"<?gmfDisclaimerExternal",visibility:"=?gmfDisclaimerExternalVisibility",msg:"=?gmfDisclaimerExternalMsg"}};gmf.module.component("gmfDisclaimer",gmf.disclaimerComponent);
gmf.DisclaimerController=function(a,b,c,d,e,f,g,h,k){this.visibility=!1;this.msgs_=[];this.sce_=c;this.timeout_=d;this.gettextCatalog_=e;this.element_=a;this.createPopup_=f;this.disclaimer_=g;this.eventHelper_=h;this.ngeoLayerHelper_=k;this.dataLayerGroup_=null};gmf.DisclaimerController.$inject="$element $scope $sce $timeout gettextCatalog ngeoCreatePopup ngeoDisclaimer ngeoEventHelper ngeoLayerHelper".split(" ");
gmf.DisclaimerController.prototype.$onInit=function(){this.dataLayerGroup_=this.ngeoLayerHelper_.getGroupFromMap(this.map,gmf.DATALAYERGROUP_NAME);this.registerLayer_(this.dataLayerGroup_)};gmf.DisclaimerController.prototype.handleLayersAdd_=function(a){var b=this;this.timeout_(function(){var c=a.element;goog.asserts.assertInstanceof(c,ol.layer.Base);b.registerLayer_(c)})};
gmf.DisclaimerController.prototype.handleLayersRemove_=function(a){a=a.element;goog.asserts.assertInstanceof(a,ol.layer.Base);this.unregisterLayer_(a)};
gmf.DisclaimerController.prototype.registerLayer_=function(a){var b=ol.getUid(a);a instanceof ol.layer.Group?(this.eventHelper_.addListenerKey(b,ol.events.listen(a.getLayers(),ol.CollectionEventType.ADD,this.handleLayersAdd_,this)),this.eventHelper_.addListenerKey(b,ol.events.listen(a.getLayers(),ol.CollectionEventType.REMOVE,this.handleLayersRemove_,this)),a.getLayers().forEach(function(a){this.registerLayer_(a)},this)):(a=a.get("disclaimers"))&&Array.isArray(a)&&a.forEach(function(a){this.showDisclaimerMessage_(a)},
this)};gmf.DisclaimerController.prototype.unregisterLayer_=function(a){var b=ol.getUid(a);a instanceof ol.layer.Group?(this.eventHelper_.clearListenerKey(b),a.getLayers().forEach(this.unregisterLayer_,this)):(a=a.get("disclaimers"))&&Array.isArray(a)&&a.forEach(function(a){this.closeDisclaimerMessage_(a)},this)};gmf.DisclaimerController.prototype.$onDestroy=function(){this.unregisterLayer_(this.dataLayerGroup_)};
gmf.DisclaimerController.prototype.showDisclaimerMessage_=function(a){a=this.gettextCatalog_.getString(a);this.external?(0>this.msgs_.indexOf(a)&&this.msgs_.push(a),this.msg=""+this.sce_.trustAsHtml(this.msgs_.join("<br />")),this.visibility=!0):this.disclaimer_.alert({popup:this.popup,msg:a,target:this.element_,type:ngeo.MessageType.WARNING})};
gmf.DisclaimerController.prototype.closeDisclaimerMessage_=function(a){a=this.gettextCatalog_.getString(a);this.external?(this.visibility=!1,this.msgs_.length=0,this.msg=""):this.disclaimer_.close({popup:this.popup,msg:a,target:this.element_,type:ngeo.MessageType.WARNING})};gmf.module.controller("GmfDisclaimerController",gmf.DisclaimerController);ngeo.FeatureOverlayMgr=function(){this.featureUidToGroupIndex_={};this.groups_=[];this.source_=new ol.source.Vector({useSpatialIndex:!1});this.layer_=new ol.layer.Vector({source:this.source_,style:this.styleFunction_.bind(this),updateWhileAnimating:!0,updateWhileInteracting:!0})};
ngeo.FeatureOverlayMgr.prototype.addFeature=function(a,b){goog.asserts.assert(0<=b);goog.asserts.assert(b<this.groups_.length);var c=ol.getUid(a).toString();this.featureUidToGroupIndex_[c]=b;this.groups_[b].features[c]=a;this.source_.addFeature(a)};ngeo.FeatureOverlayMgr.prototype.removeFeature=function(a,b){goog.asserts.assert(0<=b);goog.asserts.assert(b<this.groups_.length);var c=ol.getUid(a).toString();delete this.featureUidToGroupIndex_[c];delete this.groups_[b].features[c];this.source_.removeFeature(a)};
ngeo.FeatureOverlayMgr.prototype.clear=function(a){goog.asserts.assert(0<=a);goog.asserts.assert(a<this.groups_.length);var b=this.groups_[a],c;for(c in b.features)this.removeFeature(b.features[c],a);goog.asserts.assert(ol.obj.isEmpty(b.features))};ngeo.FeatureOverlayMgr.prototype.getLayer=function(){return this.layer_};goog.exportProperty(ngeo.FeatureOverlayMgr.prototype,"getLayer",ngeo.FeatureOverlayMgr.prototype.getLayer);
ngeo.FeatureOverlayMgr.prototype.getFeatureOverlay=function(){var a=this.groups_.length;this.groups_.push({styleFunction:ol.style.Style.defaultFunction,features:{}});return new ngeo.FeatureOverlay(this,a)};goog.exportProperty(ngeo.FeatureOverlayMgr.prototype,"getFeatureOverlay",ngeo.FeatureOverlayMgr.prototype.getFeatureOverlay);ngeo.FeatureOverlayMgr.prototype.init=function(a){this.layer_.setMap(a)};goog.exportProperty(ngeo.FeatureOverlayMgr.prototype,"init",ngeo.FeatureOverlayMgr.prototype.init);
ngeo.FeatureOverlayMgr.prototype.setStyle=function(a,b){goog.asserts.assert(0<=b);goog.asserts.assert(b<this.groups_.length);this.groups_[b].styleFunction=null===a?ol.style.Style.defaultFunction:ol.style.Style.createFunction(a)};ngeo.FeatureOverlayMgr.prototype.styleFunction_=function(a,b){var c=ol.getUid(a).toString();goog.asserts.assert(c in this.featureUidToGroupIndex_);return this.groups_[this.featureUidToGroupIndex_[c]].styleFunction(a,b)};
ngeo.FeatureOverlay=function(a,b){this.manager_=a;this.features_=null;this.index_=b};ngeo.FeatureOverlay.prototype.addFeature=function(a){this.manager_.addFeature(a,this.index_)};goog.exportProperty(ngeo.FeatureOverlay.prototype,"addFeature",ngeo.FeatureOverlay.prototype.addFeature);ngeo.FeatureOverlay.prototype.removeFeature=function(a){this.manager_.removeFeature(a,this.index_)};goog.exportProperty(ngeo.FeatureOverlay.prototype,"removeFeature",ngeo.FeatureOverlay.prototype.removeFeature);
ngeo.FeatureOverlay.prototype.clear=function(){this.manager_.clear(this.index_)};goog.exportProperty(ngeo.FeatureOverlay.prototype,"clear",ngeo.FeatureOverlay.prototype.clear);
ngeo.FeatureOverlay.prototype.setFeatures=function(a){null!==this.features_&&(this.features_.clear(),ol.events.unlisten(this.features_,ol.CollectionEventType.ADD,this.handleFeatureAdd_,this),ol.events.unlisten(this.features_,ol.CollectionEventType.REMOVE,this.handleFeatureRemove_,this));null!==a&&(a.forEach(function(a){this.addFeature(a)},this),ol.events.listen(a,ol.CollectionEventType.ADD,this.handleFeatureAdd_,this),ol.events.listen(a,ol.CollectionEventType.REMOVE,this.handleFeatureRemove_,this));
this.features_=a};goog.exportProperty(ngeo.FeatureOverlay.prototype,"setFeatures",ngeo.FeatureOverlay.prototype.setFeatures);ngeo.FeatureOverlay.prototype.setStyle=function(a){this.manager_.setStyle(a,this.index_)};goog.exportProperty(ngeo.FeatureOverlay.prototype,"setStyle",ngeo.FeatureOverlay.prototype.setStyle);ngeo.FeatureOverlay.prototype.handleFeatureAdd_=function(a){this.addFeature(a.element)};ngeo.FeatureOverlay.prototype.handleFeatureRemove_=function(a){this.removeFeature(a.element)};
ngeo.module.service("ngeoFeatureOverlayMgr",ngeo.FeatureOverlayMgr);ol.format.WFSDescribeFeatureType=function(){ol.format.XML.call(this)};ol.inherits(ol.format.WFSDescribeFeatureType,ol.format.XML);ol.format.WFSDescribeFeatureType.prototype.readFromDocument=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType==Node.ELEMENT_NODE)return this.readFromNode(a);return null};ol.format.WFSDescribeFeatureType.prototype.readFromNode=function(a){var b={};return b=ol.xml.pushParseAndPop(b,ol.format.WFSDescribeFeatureType.PARSERS_,a,[])};
ol.format.WFSDescribeFeatureType.readElement_=function(a,b){for(var c={},d=0,e=a.attributes.length;d<e;d++){var f=a.attributes.item(d);c[f.name]=f.value}1===b.length&&(c.type=c.type.split(":").pop());return c};ol.format.WFSDescribeFeatureType.readComplexType_=function(a,b){var c=a.getAttribute("name");a=ol.xml.pushParseAndPop({name:c},ol.format.WFSDescribeFeatureType.COMPLEX_TYPE_PARSERS_,a,b);a.complexContent=a.complexContent.extension.sequence.element;return a};
ol.format.WFSDescribeFeatureType.readComplexContent_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WFSDescribeFeatureType.COMPLEX_CONTENT_PARSERS_,a,b)};ol.format.WFSDescribeFeatureType.readExtension_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WFSDescribeFeatureType.EXTENSION_PARSERS_,a,b)};ol.format.WFSDescribeFeatureType.readSequence_=function(a,b){return ol.xml.pushParseAndPop({},ol.format.WFSDescribeFeatureType.SEQUENCE_PARSERS_,a,b)};
ol.format.WFSDescribeFeatureType.NAMESPACE_URIS_=[null,"http://www.w3.org/2001/XMLSchema"];ol.format.WFSDescribeFeatureType.PARSERS_=goog.asserts.assert(ol.xml.makeStructureNS(ol.format.WFSDescribeFeatureType.NAMESPACE_URIS_,{element:ol.xml.makeObjectPropertyPusher(ol.format.WFSDescribeFeatureType.readElement_),complexType:ol.xml.makeObjectPropertyPusher(ol.format.WFSDescribeFeatureType.readComplexType_)}));
ol.format.WFSDescribeFeatureType.COMPLEX_TYPE_PARSERS_=goog.asserts.assert(ol.xml.makeStructureNS(ol.format.WFSDescribeFeatureType.NAMESPACE_URIS_,{complexContent:ol.xml.makeObjectPropertySetter(ol.format.WFSDescribeFeatureType.readComplexContent_)}));ol.format.WFSDescribeFeatureType.COMPLEX_CONTENT_PARSERS_=goog.asserts.assert(ol.xml.makeStructureNS(ol.format.WFSDescribeFeatureType.NAMESPACE_URIS_,{extension:ol.xml.makeObjectPropertySetter(ol.format.WFSDescribeFeatureType.readExtension_)}));
ol.format.WFSDescribeFeatureType.EXTENSION_PARSERS_=goog.asserts.assert(ol.xml.makeStructureNS(ol.format.WFSDescribeFeatureType.NAMESPACE_URIS_,{sequence:ol.xml.makeObjectPropertySetter(ol.format.WFSDescribeFeatureType.readSequence_)}));ol.format.WFSDescribeFeatureType.SEQUENCE_PARSERS_=goog.asserts.assert(ol.xml.makeStructureNS(ol.format.WFSDescribeFeatureType.NAMESPACE_URIS_,{element:ol.xml.makeObjectPropertyPusher(ol.format.WFSDescribeFeatureType.readElement_)}));ngeo.Querent=function(a,b,c,d){this.http_=a;this.q_=b;this.ngeoRuleHelper_=c;this.ngeoWMSTime_=d;this.requestCancelers_=[]};
ngeo.Querent.prototype.issue=function(a){var b=[],c=a.map;this.cancelStillRunningRequests_();if(a.queryableDataSources)c=a.queryableDataSources;else{var d=a.dataSources;goog.asserts.assert(d,"DataSources should be set");c=this.getQueryableDataSources(d,c)}d=this.getCombinableWFSDataSources_(c.wfs);b.push(this.issueCombinedWFS_(d,a));a.coordinate&&(c=this.getCombinableWMSDataSources_(c.wms),b.push(this.issueCombinedWMS_(c,a)));return this.q_.all(b).then(this.handleCombinedQueryResult_.bind(this))};
goog.exportProperty(ngeo.Querent.prototype,"issue",ngeo.Querent.prototype.issue);ngeo.Querent.prototype.getQueryableDataSources=function(a,b){var c={wfs:[],wms:[]};b=goog.asserts.assertNumber(b.getView().getResolution());a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())d=d.value,this.isDataSourceQueryable_(d,b)&&(d.supportsWFS?c.wfs.push(d):c.wms.push(d));return c};goog.exportProperty(ngeo.Querent.prototype,"getQueryableDataSources",ngeo.Querent.prototype.getQueryableDataSources);
ngeo.Querent.prototype.wfsDescribeFeatureType=function(a){goog.asserts.assert(a.supportsAttributes,"The data source must support WFS, have a single OGCLayer that\n      is queryable in order to issue WFS DescribeFeatureType requests");var b=a.getOGCLayerNames();a=ol.uri.appendParams(goog.asserts.assertString(a.wfsUrl),{REQUEST:"DescribeFeatureType",SERVICE:"WFS",VERSION:"2.0.0",TYPENAME:b});return this.http_.get(a).then(function(a){return(new ol.format.WFSDescribeFeatureType).read(a.data)})};
goog.exportProperty(ngeo.Querent.prototype,"wfsDescribeFeatureType",ngeo.Querent.prototype.wfsDescribeFeatureType);ngeo.Querent.prototype.handleCombinedQueryResult_=function(a){var b={};a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;for(var d in c){var e=Number(d);b[e]=c[e]}}return b};
ngeo.Querent.prototype.handleQueryResult_=function(a,b,c,d){var e={};a=$jscomp.makeIterator(a);for(var f=a.next();!f.done;f=a.next()){f=f.value;var g=void 0,h=void 0;if("number"===typeof d){var k=[];g=!0;h=d}else k=this.readAndTypeFeatures_(f,d.data,c);var l=f.id;this.setUniqueIds_(k,f.id);e[l]={features:k,limit:b,tooManyFeatures:g,totalFeatureCount:h}}return e};
ngeo.Querent.prototype.readAndTypeFeatures_=function(a,b,c){var d=this,e=[],f,g=this.getSetOlFormatTypes_(a,c).slice();g.forEach(function(g){d.getSetOlFormatTypes_(a,c,[g]);f=c?a.wfsFormat.readFeatures(b):a.wmsFormat.readFeatures(b);0<f.length&&f.forEach(function(a){a.set("ngeo_feature_type_",g);e.push(a)})});this.getSetOlFormatTypes_(a,c,g);return e};
ngeo.Querent.prototype.getSetOlFormatTypes_=function(a,b,c){b?(c&&a.wfsFormat.setFeatureType(c),a=a.wfsFormat.getFeatureType()):(c&&a.wmsFormat.setLayers(c),a=a.wmsFormat.getLayers());return a?Array.isArray(a)?a:[a]:[]};
ngeo.Querent.prototype.issueCombinedWFS_=function(a,b){var c=this,d=[],e=goog.asserts.assertNumber(b.limit),f=b.map.getView(),g=goog.asserts.assertNumber(f.getResolution());f=f.getProjection().getCode();var h=!0===b.wfsCount,k;if(k=b.coordinate){var l=b.tolerancePx;goog.asserts.assert(l);l*=g;k=ol.extent.buffer(ol.extent.createOrUpdateFromCoordinate(k),l)}else k=b.extent;var m=new ol.format.WFS,n=new XMLSerializer;l={};a=$jscomp.makeIterator(a);for(var p=a.next();!p.done;l={dataSources:l.dataSources,
getFeatureCommonOptions:l.getFeatureCommonOptions,url:l.url,params:l.params,getFeatureDefer:l.getFeatureDefer},p=a.next()){l.dataSources=p.value;var q=l.getFeatureCommonOptions=void 0;p=[];l.url=void 0;l.params={};for(var r=$jscomp.makeIterator(l.dataSources),u=r.next();!u.done;u=r.next()){u=u.value;l.getFeatureCommonOptions||(q=u.wfsFeatureNS,l.getFeatureCommonOptions={bbox:k,featureNS:q,featurePrefix:u.wfsFeaturePrefix,geometryName:u.geometryName,outputFormat:u.wfsOutputFormat,srsName:f},l.url=
u.wfsUrl,ol.obj.assign(l.params,u.activeDimensions));p=p.concat(u.getInRangeOGCLayerNames(g,!0));q=void 0;if(b.filter)q=this.ngeoRuleHelper_.createFilter({dataSource:u,filter:b.filter,incTime:!0});else if(u.filterRules&&u.filterRules.length||u.timeRangeValue)goog.asserts.assert(1===l.dataSources.length,"A data source having filterRules or timeRangeValue should issue\n            a single query, alone."),q=this.ngeoRuleHelper_.createFilter({dataSource:u,incTime:!0,srsName:f});q&&(l.getFeatureCommonOptions.filter=
q)}goog.asserts.assert(l.getFeatureCommonOptions);l.getFeatureCommonOptions.featureTypes=p;goog.asserts.assert(l.url);l.getFeatureDefer=this.q_.defer();d.push(l.getFeatureDefer.promise.then(this.handleQueryResult_.bind(this,l.dataSources,e,!0)));p=void 0;h?(p=ol.obj.assign({resultType:"hits"},l.getFeatureCommonOptions),p=m.writeGetFeature(p),p=n.serializeToString(p),r=this.registerCanceler_(),p=this.http_.post(l.url,p,{params:l.params,headers:{"Content-Type":"text/xml; charset=UTF-8"},timeout:r.promise}).then(function(a){return function(b){return a.dataSources[0].wfsFormat.readFeatureCollectionMetadata(b.data).numberOfFeatures}}(l).bind(this))):
p=this.q_.resolve();p.then(function(a){return function(b){if(void 0===b||b<e){b=ol.obj.assign({maxFeatures:e},a.getFeatureCommonOptions);b=m.writeGetFeature(b);b=n.serializeToString(b);goog.asserts.assertString(a.url);var d=c.registerCanceler_();c.http_.post(a.url,b,{params:a.params,headers:{"Content-Type":"text/xml; charset=UTF-8"},timeout:d.promise}).then(function(b){a.getFeatureDefer.resolve(b)})}else a.getFeatureDefer.resolve(b)}}(l))}return this.q_.all(d).then(this.handleCombinedQueryResult_.bind(this))};
ngeo.Querent.prototype.issueCombinedWMS_=function(a,b){var c=[],d=goog.asserts.assertNumber(b.limit),e=b.map.getView(),f=goog.asserts.assertNumber(e.getResolution());e=e.getProjection().getCode();b=b.coordinate;goog.asserts.assert(b);a=$jscomp.makeIterator(a);for(var g=a.next();!g.done;g=a.next()){g=g.value;for(var h=void 0,k=[],l=void 0,m=!1,n={},p=null,q=null,r=$jscomp.makeIterator(g),u=r.next();!u.done;u=r.next())u=u.value,l||(l=u.wmsInfoFormat,h=u.wmsUrl),k=k.concat(u.getInRangeOGCLayerNames(f,
!0)),m||(ol.obj.assign(n,u.activeDimensions),m=!0),u.filterRules&&u.filterRules.length&&(goog.asserts.assert(1===g.length),q=u.getFiltrableOGCLayerName(),p=this.ngeoRuleHelper_.createFilterString({dataSource:u,srsName:e})),null!==u.timeRangeValue&&u.timeProperty&&(goog.asserts.assert(1===g.length),n.TIME=this.ngeoWMSTime_.formatWMSTimeParam(u.timeProperty,u.timeRangeValue));n.LAYERS=k;n.QUERY_LAYERS=k;if(p&&q){if(1===k.length)k=p;else{m=[];r=0;for(u=k.length;r<u;r++)k[r]===q?m.push("("+p+")"):m.push("()");
k=m.join("")}n.FILTER=k}goog.asserts.assert(h);h=new ol.source.ImageWMS({params:n,url:h});l=goog.asserts.assertString(h.getGetFeatureInfoUrl(b,f,e,{FEATURE_COUNT:d,INFO_FORMAT:l}));h=this.registerCanceler_();c.push(this.http_.get(l,{timeout:h.promise}).then(this.handleQueryResult_.bind(this,g,d,!1)))}return this.q_.all(c).then(this.handleCombinedQueryResult_.bind(this))};
ngeo.Querent.prototype.getCombinableWFSDataSources_=function(a){var b=[],c=[];a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())if(d=d.value,d.combinableForWFS){for(var e=!1,f=$jscomp.makeIterator(b),g=f.next();!g.done;g=f.next())g=g.value,d.combinableWithDataSourceForWFS(g[0])&&(g.push(d),e=!0);e||b.push([d])}else c.push([d]);return b.concat(c)};
ngeo.Querent.prototype.getCombinableWMSDataSources_=function(a){var b=[],c=[];a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())if(d=d.value,d.combinableForWMS){for(var e=!1,f=$jscomp.makeIterator(b),g=f.next();!g.done;g=f.next())g=g.value,d.combinableWithDataSourceForWMS(g[0])&&(g.push(d),e=!0);e||b.push([d])}else c.push([d]);return b.concat(c)};ngeo.Querent.prototype.isDataSourceQueryable_=function(a,b){return a.visible&&a.inRange&&a.queryable&&a.isAnyOGCLayerInRange(b,!0)};
ngeo.Querent.prototype.setUniqueIds_=function(a,b){a.forEach(function(a){if(void 0!==a.getId()){var c=b+"_"+a.getId();a.setId(c)}})};ngeo.Querent.prototype.registerCanceler_=function(){var a=this.q_.defer();this.requestCancelers_.push(a);return a};ngeo.Querent.prototype.cancelStillRunningRequests_=function(){for(var a=$jscomp.makeIterator(this.requestCancelers_),b=a.next();!b.done;b=a.next())b.value.resolve();this.requestCancelers_.length=0};ngeo.Querent.$inject=["$http","$q","ngeoRuleHelper","ngeoWMSTime"];
ngeo.module.service("ngeoQuerent",ngeo.Querent);ngeo.Attribute={};
ngeo.Attribute.setGeometryType=function(a,b){/gml:((Multi)?(Point|Line|Polygon|Curve|Surface|Geometry)).*/.exec(b)&&(a.type=ngeo.AttributeType.GEOMETRY,/^gml:Point/.exec(b)?a.geomType=ol.geom.GeometryType.POINT:/^gml:LineString|^gml:Curve/.exec(b)?a.geomType=ol.geom.GeometryType.LINE_STRING:/^gml:Polygon|^gml:Surface/.exec(b)?a.geomType=ol.geom.GeometryType.POLYGON:/^gml:MultiPoint/.exec(b)?a.geomType=ol.geom.GeometryType.MULTI_POINT:/^gml:MultiLineString|^gml:MultiCurve/.exec(b)?a.geomType=ol.geom.GeometryType.MULTI_LINE_STRING:
/^gml:MultiPolygon|^gml:MultiSurface/.exec(b)&&(a.geomType=ol.geom.GeometryType.MULTI_POLYGON));return!!a.type&&!!a.geomType};ngeo.format={};ngeo.format.WFSAttribute=function(){};ngeo.format.WFSAttribute.prototype.read=function(a){return a.map(this.readFromComplexTypeElement_)};goog.exportProperty(ngeo.format.WFSAttribute.prototype,"read",ngeo.format.WFSAttribute.prototype.read);
ngeo.format.WFSAttribute.prototype.readFromComplexTypeElement_=function(a){var b={name:goog.asserts.assertString(a.name),required:"0"!=a.minOccurs};a=goog.asserts.assertString(a.type);ngeo.Attribute.setGeometryType(b,a)||("gml:TimeInstantType"===a||"dateTime"===a?b.type=ngeo.AttributeType.DATETIME:"date"===a?b.type=ngeo.AttributeType.DATE:"time"===a?b.type=ngeo.AttributeType.TIME:"decimal"===a||"double"===a?(b.type=ngeo.AttributeType.NUMBER,b.numType=ngeo.NumberType.FLOAT):"integer"===a||"long"===
a?(b.type=ngeo.AttributeType.NUMBER,b.numType=ngeo.NumberType.INTEGER):b.type="boolean"===a?ngeo.AttributeType.BOOLEAN:ngeo.AttributeType.TEXT);return b};ngeo.DataSourcesHelper=function(a,b,c){this.q_=a;this.collection_=b;this.ngeoQuerent_=c;this.cache_={};ol.events.listen(b,ol.CollectionEventType.ADD,this.handleDataSourcesAdd_,this);ol.events.listen(b,ol.CollectionEventType.REMOVE,this.handleDataSourcesRemove_,this)};ngeo.DataSourcesHelper.prototype.getDataSource=function(a){return this.cache_[a]||null};goog.exportProperty(ngeo.DataSourcesHelper.prototype,"getDataSource",ngeo.DataSourcesHelper.prototype.getDataSource);
ngeo.DataSourcesHelper.prototype.getDataSourceAttributes=function(a){var b=this.q_.defer();a.attributes?b.resolve(a.attributes):this.ngeoQuerent_.wfsDescribeFeatureType(a).then(function(c){var d=a.getOGCLayerNames()[0];goog.asserts.assertString(d,"The data source should have only one ogcLayer.");var e=c.element[0];goog.asserts.assert(e.name===d);goog.asserts.assert(c.complexType[0].name===e.type);c=c.complexType[0].complexContent;c=(new ngeo.format.WFSAttribute).read(c);a.attributes=c;b.resolve(c)});
return b.promise};goog.exportProperty(ngeo.DataSourcesHelper.prototype,"getDataSourceAttributes",ngeo.DataSourcesHelper.prototype.getDataSourceAttributes);ngeo.DataSourcesHelper.prototype.handleDataSourcesAdd_=function(a){a=goog.asserts.assertInstanceof(a.element,ngeo.DataSource);this.cache_[a.id]=a};ngeo.DataSourcesHelper.prototype.handleDataSourcesRemove_=function(a){a=goog.asserts.assertInstanceof(a.element,ngeo.DataSource);delete this.cache_[a.id]};
$jscomp.global.Object.defineProperties(ngeo.DataSourcesHelper.prototype,{collection:{configurable:!0,enumerable:!0,get:function(){return this.collection_}}});ngeo.DataSourcesHelper.$inject=["$q","ngeoDataSources","ngeoQuerent"];ngeo.module.service("ngeoDataSourcesHelper",ngeo.DataSourcesHelper);ngeo.module.value("ngeoQueryResult",{sources:[],total:0,pending:!1});ngeo.MapQuerent=function(a,b,c,d,e){a=a.has("ngeoQueryOptions")?a.get("ngeoQueryOptions"):{};this.ngeoDataSources_=b;this.ngeoDataSourcesHelper_=c;this.ngeoQuerent_=d;this.result_=e;this.limit_=void 0!==a.limit?a.limit:50;this.queryCountFirst_=void 0!==a.queryCountFirst?a.queryCountFirst:!1;this.tolerancePx_=void 0!==a.tolerance?a.tolerance:3;this.dataSourceNames_={}};
ngeo.MapQuerent.prototype.issue=function(a){this.clear();var b;void 0===a.dataSources&&void 0===a.queryableDataSources&&(b=this.ngeoQuerent_.getQueryableDataSources(this.ngeoDataSources_.getArray(),a.map));ol.obj.assign(a,{queryableDataSources:b,limit:void 0!==a.limit?a.limit:this.limit_,tolerancePx:this.tolerancePx_,wfsCount:this.queryCountFirst_});this.result_.pending=!0;this.ngeoQuerent_.issue(a).then(this.handleResult_.bind(this))};goog.exportProperty(ngeo.MapQuerent.prototype,"issue",ngeo.MapQuerent.prototype.issue);
ngeo.MapQuerent.prototype.clear=function(){this.result_.total=0;for(var a=$jscomp.makeIterator(this.result_.sources),b=a.next();!b.done;b=a.next())b=b.value,b.features.length=0,b.pending=!1,b.queried=!1,b.tooManyResults=!1,b.totalFeatureCount=void 0;this.result_.sources.length=0;this.result_.pending=!1};goog.exportProperty(ngeo.MapQuerent.prototype,"clear",ngeo.MapQuerent.prototype.clear);
ngeo.MapQuerent.prototype.handleResult_=function(a){var b=0,c={},d;for(d in a){var e=Number(d),f=this.ngeoDataSourcesHelper_.getDataSource(e),g=f.name;goog.asserts.assert(f);var h=a[e];f=h.features;var k=h.limit,l=!0===h.tooManyFeatures;h=h.totalFeatureCount;c.typeSeparatedFeatures={};f.forEach(function(a){return function(b){var c=goog.asserts.assertString(b.get("ngeo_feature_type_"));a.typeSeparatedFeatures[c]||(a.typeSeparatedFeatures[c]=[]);a.typeSeparatedFeatures[c].push(b)}}(c));for(var m in c.typeSeparatedFeatures)g=
m?m:g,this.result_.sources.push({features:c.typeSeparatedFeatures[m],id:e,label:g,limit:k,pending:!1,queried:!0,tooManyResults:l,totalFeatureCount:h}),b+=f.length;c={typeSeparatedFeatures:c.typeSeparatedFeatures}}this.result_.total=b;this.result_.pending=!1};ngeo.MapQuerent.$inject=["$injector","ngeoDataSources","ngeoDataSourcesHelper","ngeoQuerent","ngeoQueryResult"];ngeo.module.service("ngeoMapQuerent",ngeo.MapQuerent);ngeo.module.value("gmfDisplayquerywindowTemplateUrl",function(a,b){a=b.gmfDisplayquerywindowTemplateurl;return void 0!==a?a:gmf.baseTemplateUrl+"/displayquerywindow.html"});function gmfDisplayquerywindowTemplateUrl(a,b,c){return c(a,b)}gmfDisplayquerywindowTemplateUrl.$inject=["$element","$attrs","gmfDisplayquerywindowTemplateUrl"];
gmf.displayquerywindowComponent={controller:"GmfDisplayquerywindowController as ctrl",bindings:{featuresStyleFn:"&gmfDisplayquerywindowFeaturesstyle",selectedFeatureStyleFn:"&gmfDisplayquerywindowSelectedfeaturestyle",defaultCollapsedFn:"&?gmfDisplayquerywindowDefaultcollapsed",desktop:"=gmfDisplayquerywindowDesktop",showUnqueriedLayers:"=gmfDisplayquerywindowShowunqueriedlayers"},templateUrl:gmfDisplayquerywindowTemplateUrl};gmf.module.component("gmfDisplayquerywindow",gmf.displayquerywindowComponent);
gmf.DisplayquerywindowController=function(a,b,c,d){var e=this;this.desktop=!1;this.collapsed=!this.desktop;this.showUnqueriedLayers_=!1;this.sourcesFilter={queried:!0};this.ngeoQueryResult={sources:[],total:0,pending:!1};this.ngeoMapQuerent_=c;this.selectedSource=null;this.features_=new ol.Collection;this.ngeoFeatureOverlayMgr_=d;this.highlightFeatures_=new ol.Collection;this.feature=this.source=null;this.currentResult=-1;this.isNext=!0;this.animate=0;this.open=!1;a.$watchCollection(function(){return b},
function(a,b){e.updateQueryResult_(a);0<a.total?e.show():b!==a&&e.close()})};gmf.DisplayquerywindowController.$inject=["$scope","ngeoQueryResult","ngeoMapQuerent","ngeoFeatureOverlayMgr"];
gmf.DisplayquerywindowController.prototype.$onInit=function(){this.desktop=this.desktop;this.collapsed=this.defaultCollapsedFn?!0===this.defaultCollapsedFn():!this.desktop;this.sourcesFilter=(this.showUnqueriedLayers_=this.showUnqueriedLayers?!0===this.showUnqueriedLayers:!1)?{}:{queried:!0};var a=this.ngeoFeatureOverlayMgr_.getFeatureOverlay();a.setFeatures(this.features_);var b=this.featuresStyleFn();void 0!==b&&(goog.asserts.assertInstanceof(b,ol.style.Style),a.setStyle(b));a=this.ngeoFeatureOverlayMgr_.getFeatureOverlay();
a.setFeatures(this.highlightFeatures_);b=this.selectedFeatureStyleFn();if(void 0!==b)goog.asserts.assertInstanceof(b,ol.style.Style);else{b=new ol.style.Fill({color:[255,0,0,.6]});var c=new ol.style.Stroke({color:[255,0,0,1],width:2});b=new ol.style.Style({fill:b,image:new ol.style.Circle({fill:b,radius:5,stroke:c}),stroke:c})}a.setStyle(b)};gmf.DisplayquerywindowController.prototype.show=function(){this.clear();this.updateFeatures_()};
goog.exportProperty(gmf.DisplayquerywindowController.prototype,"show",gmf.DisplayquerywindowController.prototype.show);gmf.DisplayquerywindowController.prototype.updateFeatures_=function(){this.setCurrentResult_(0,!1);null!==this.source&&(this.collectFeatures_(),this.highlightCurrentFeature_(),this.open=!0)};
gmf.DisplayquerywindowController.prototype.setCurrentResult_=function(a,b){var c=!1;if(a!==this.currentResult){var d,e=this.feature,f=this.ngeoQueryResult.sources;this.currentResult=a;for(d=0;d<f.length;d++){var g=f[d];if(null===this.selectedSource||this.selectedSource===g){var h=g.features;if(a>=h.length)a-=h.length;else{this.source=g;this.feature=g.features[a];c=!0;break}}}b&&this.highlightCurrentFeature_(e)}return c};
gmf.DisplayquerywindowController.prototype.previous=function(){var a=this.currentResult-1;0>a&&(a=this.getResultLength()-1);this.setCurrentResult_(a,!0)&&this.animate_(!1)};goog.exportProperty(gmf.DisplayquerywindowController.prototype,"previous",gmf.DisplayquerywindowController.prototype.previous);gmf.DisplayquerywindowController.prototype.next=function(){var a=this.currentResult+1,b=this.getResultLength()-1;a>b&&(a=0);this.setCurrentResult_(a,!0)&&this.animate_(!0)};
goog.exportProperty(gmf.DisplayquerywindowController.prototype,"next",gmf.DisplayquerywindowController.prototype.next);
gmf.DisplayquerywindowController.prototype.updateQueryResult_=function(a){this.ngeoQueryResult.total=0;for(var b=this.ngeoQueryResult.sources.length=0;b<a.sources.length;b++){var c=a.sources[b];c.features=c.features.filter(function(a){goog.asserts.assert(a);return!ol.obj.isEmpty(ngeo.FeatureHelper.getFilteredFeatureValues(a))});this.ngeoQueryResult.sources.push(c);this.ngeoQueryResult.total+=c.features.length}};
gmf.DisplayquerywindowController.prototype.getResultLength=function(){return null===this.selectedSource?this.ngeoQueryResult.total:this.selectedSource.features.length};goog.exportProperty(gmf.DisplayquerywindowController.prototype,"getResultLength",gmf.DisplayquerywindowController.prototype.getResultLength);gmf.DisplayquerywindowController.prototype.isFirst=function(){return 0==this.currentResult};goog.exportProperty(gmf.DisplayquerywindowController.prototype,"isFirst",gmf.DisplayquerywindowController.prototype.isFirst);
gmf.DisplayquerywindowController.prototype.isLast=function(){return this.currentResult==this.getResultLength()-1};goog.exportProperty(gmf.DisplayquerywindowController.prototype,"isLast",gmf.DisplayquerywindowController.prototype.isLast);gmf.DisplayquerywindowController.prototype.getFeatureValues=function(){return this.feature?ngeo.FeatureHelper.getFilteredFeatureValues(this.feature):null};goog.exportProperty(gmf.DisplayquerywindowController.prototype,"getFeatureValues",gmf.DisplayquerywindowController.prototype.getFeatureValues);
gmf.DisplayquerywindowController.prototype.animate_=function(a){this.isNext=a;this.animate++};gmf.DisplayquerywindowController.prototype.collectFeatures_=function(){var a=this.ngeoQueryResult.sources;this.features_.clear();for(var b=0;b<a.length;b++){var c=a[b];if(null===this.selectedSource||this.selectedSource===c){c=c.features;for(var d=0;d<c.length;d++)this.features_.push(c[d])}}};
gmf.DisplayquerywindowController.prototype.highlightCurrentFeature_=function(a){this.highlightFeatures_.clear();this.features_.remove(this.feature);this.highlightFeatures_.push(this.feature);void 0!==a&&this.features_.push(a)};gmf.DisplayquerywindowController.prototype.close=function(){this.open=!1;this.clear();this.ngeoMapQuerent_.clear()};goog.exportProperty(gmf.DisplayquerywindowController.prototype,"close",gmf.DisplayquerywindowController.prototype.close);
gmf.DisplayquerywindowController.prototype.clear=function(){this.source=this.feature=null;this.currentResult=-1;this.features_.clear();this.highlightFeatures_.clear();this.selectedSource=null};goog.exportProperty(gmf.DisplayquerywindowController.prototype,"clear",gmf.DisplayquerywindowController.prototype.clear);gmf.DisplayquerywindowController.prototype.setSelectedSource=function(a){null!==a&&0>=a.features.length||(this.clear(),this.selectedSource=a,this.updateFeatures_())};
goog.exportProperty(gmf.DisplayquerywindowController.prototype,"setSelectedSource",gmf.DisplayquerywindowController.prototype.setSelectedSource);gmf.module.controller("GmfDisplayquerywindowController",gmf.DisplayquerywindowController);ngeo.syncArrays=function(a,b,c,d,e){var f=d.$watchCollection(function(){return a},function(){var d;if(c){var f=a.length-1;for(d=0;0<=f;--f)e(a[f])&&(b[d++]=a[f])}else{f=0;var g=a.length;for(d=0;f<g;++f)e(a[f])&&(b[d++]=a[f])}b.length=d}),g=d.$watchCollection(function(){return b},function(){var d;if(c){var f=0;var g=a.length;for(d=b.length-1;f<g;++f)e(a[f])&&(a[f]=b[d--]);goog.asserts.assert(-1==d)}else{f=0;g=a.length;for(d=0;f<g;++f)e(a[f])&&(a[f]=b[d++]);goog.asserts.assert(d==b.length)}});return function(){f();
g()}};ngeo.module.value("ngeoSyncArrays",ngeo.syncArrays);gmf.module.value("gmfDataSourceBeingFiltered",{dataSource:null});gmf.DataSourceBeingFiltered=function(){};goog.exportSymbol("gmf.DataSourceBeingFiltered",gmf.DataSourceBeingFiltered);ngeo.AutoProjection=function(){};ngeo.AutoProjection.prototype.stringToCoordinates=function(a){var b=a.match(/([\d\.']+)[\s,]+([\d\.']+)/);return!b||(a=parseFloat(b[1].replace("'","")),b=parseFloat(b[2].replace("'","")),isNaN(a)||isNaN(b))?null:[a,b]};goog.exportProperty(ngeo.AutoProjection.prototype,"stringToCoordinates",ngeo.AutoProjection.prototype.stringToCoordinates);
ngeo.AutoProjection.prototype.getProjectionList=function(a){var b,c,d=[];a.forEach(function(a){b=a.toUpperCase();"EPSG:"!=b.substr(0,5)&&(b="EPSG:"+b);c=ol.proj.get(b);null!==c?d.push(c):console.error("The projection "+b+" is not defined in ol.proj.")});return d};goog.exportProperty(ngeo.AutoProjection.prototype,"getProjectionList",ngeo.AutoProjection.prototype.getProjectionList);
ngeo.AutoProjection.prototype.tryProjections=function(a,b,c,d){var e;void 0===d&&(d=[c]);d.some(function(d){try{if(e=ol.proj.transform(a,d,c),ol.extent.containsCoordinate(b,e))return!0}catch(g){console.log(g)}e=null});return e};goog.exportProperty(ngeo.AutoProjection.prototype,"tryProjections",ngeo.AutoProjection.prototype.tryProjections);
ngeo.AutoProjection.prototype.tryProjectionsWithInversion=function(a,b,c,d){var e=this.tryProjections(a,b,c,d);null===e&&(e=this.tryProjections(a.reverse(),b,c,d));return e};goog.exportProperty(ngeo.AutoProjection.prototype,"tryProjectionsWithInversion",ngeo.AutoProjection.prototype.tryProjectionsWithInversion);ngeo.module.service("ngeoAutoProjection",ngeo.AutoProjection);gmf.module.value("gmfTreeManagerModeFlush",!0);gmf.ThemeManagerEventType={THEME_NAME_SET:"gmf-thememanager-theme_name_set"};goog.exportSymbol("gmf.ThemeManagerEventType",gmf.ThemeManagerEventType);gmf.ThemeManager=function(a,b,c,d,e){this.$rootScope_=a;this.gmfThemes_=b;this.modeFlush=c;this.gmfTreeManager_=d;this.ngeoStateManager_=e;this.themeName_=""};gmf.ThemeManager.$inject=["$rootScope","gmfThemes","gmfTreeManagerModeFlush","gmfTreeManager","ngeoStateManager"];
gmf.ThemeManager.prototype.addTheme=function(a,b){this.modeFlush?(this.ngeoStateManager_.updateState({theme:a.name}),this.setThemeName(a.name),this.gmfTreeManager_.setFirstLevelGroups(a.children)):this.gmfTreeManager_.addFirstLevelGroups(a.children,!1,b)};goog.exportProperty(gmf.ThemeManager.prototype,"addTheme",gmf.ThemeManager.prototype.addTheme);gmf.ThemeManager.prototype.getThemeName=function(){return this.themeName_};goog.exportProperty(gmf.ThemeManager.prototype,"getThemeName",gmf.ThemeManager.prototype.getThemeName);
gmf.ThemeManager.prototype.isLoading=function(){return!this.gmfThemes_.loaded};goog.exportProperty(gmf.ThemeManager.prototype,"isLoading",gmf.ThemeManager.prototype.isLoading);gmf.ThemeManager.prototype.setThemeName=function(a,b){this.themeName_=a;b||this.$rootScope_.$emit(gmf.ThemeManagerEventType.THEME_NAME_SET,a)};gmf.ThemeManager.prototype.removeAll=function(){this.gmfTreeManager_.removeAll()};goog.exportProperty(gmf.ThemeManager.prototype,"removeAll",gmf.ThemeManager.prototype.removeAll);
gmf.module.service("gmfThemeManager",gmf.ThemeManager);ngeo.debounceServiceFactory=function(a){return function(b,c,d){var e=null;return function(f){for(var g=[],h=0;h<arguments.length;++h)g[h-0]=arguments[h];var k=this;null!==e&&a.cancel(e);e=a(function(){e=null;b.apply(k,g)},c,d)}}};ngeo.debounceServiceFactory.$inject=["$timeout"];ngeo.module.factory("ngeoDebounce",ngeo.debounceServiceFactory);ngeo.Features={};ngeo.module.value("ngeoFeatures",new ol.Collection);ngeo.Popover=function(a){a=void 0!==a?a:{};this.clickKey_=null;if(a.element){var b=a.element;delete a.element}else b=$("<div />")[0];this.closeEl_=$("<button>",{"class":"close",html:"&times;"});this.contentEl_=$("<div/>").append(this.closeEl_).append(b);a.element=$("<div />")[0];ol.Overlay.call(this,a)};ol.inherits(ngeo.Popover,ol.Overlay);
ngeo.Popover.prototype.setMap=function(a){var b=this.getElement();this.getMap()&&(this.clickKey_&&(goog.events.unlistenByKey(this.clickKey_),this.clickKey_=null),$(b).popover("destroy"));ol.Overlay.prototype.setMap.call(this,a);if(a){var c=this.contentEl_;window.setTimeout(function(){$(b).popover({content:c,html:!0,placement:"top",template:'<div class="popover ngeo-popover" role="tooltip">  <div class="arrow"></div>  <h3 class="popover-title"></h3>  <div class="popover-content"></div></div>'}).popover("show")},
0);this.clickKey_=goog.events.listen(this.closeEl_[0],goog.events.EventType.CLICK,this.handleCloseElClick_,!1,this)}};goog.exportProperty(ngeo.Popover.prototype,"setMap",ngeo.Popover.prototype.setMap);ngeo.Popover.prototype.handleCloseElClick_=function(){var a=this.getMap();a&&a.removeOverlay(this)};ngeo.format.FeatureHashStyleType={LINE_STRING:"LineString",POINT:"Point",POLYGON:"Polygon"};ngeo.format.FeatureHashStyleTypes_={};ngeo.format.FeatureHashStyleTypes_[ol.geom.GeometryType.LINE_STRING]=ngeo.format.FeatureHashStyleType.LINE_STRING;ngeo.format.FeatureHashStyleTypes_[ol.geom.GeometryType.POINT]=ngeo.format.FeatureHashStyleType.POINT;ngeo.format.FeatureHashStyleTypes_[ol.geom.GeometryType.POLYGON]=ngeo.format.FeatureHashStyleType.POLYGON;
ngeo.format.FeatureHashStyleTypes_[ol.geom.GeometryType.MULTI_LINE_STRING]=ngeo.format.FeatureHashStyleType.LINE_STRING;ngeo.format.FeatureHashStyleTypes_[ol.geom.GeometryType.MULTI_POINT]=ngeo.format.FeatureHashStyleType.POINT;ngeo.format.FeatureHashStyleTypes_[ol.geom.GeometryType.MULTI_POLYGON]=ngeo.format.FeatureHashStyleType.POLYGON;ngeo.format.FeatureHashLegacyProperties_={};
ngeo.format.FeatureHash=function(a){ol.format.TextFeature.call(this);a=void 0!==a?a:{};this.accuracy_=void 0!==a.accuracy?a.accuracy:ngeo.format.FeatureHash.ACCURACY_;this.encodeStyles_=void 0!==a.encodeStyles?a.encodeStyles:!0;this.propertiesFunction_=void 0!==a.properties?a.properties:ngeo.format.FeatureHash.defaultPropertiesFunction_;this.setStyle_=void 0!==a.setStyle?a.setStyle:!0;this.prevY_=this.prevX_=0;ngeo.format.FeatureHashLegacyProperties_=void 0!==a.propertiesType&&a.propertiesType;this.defaultValues_=
void 0!==a.defaultValues?a.defaultValues:{}};ol.inherits(ngeo.format.FeatureHash,ol.format.TextFeature);goog.exportSymbol("ngeo.format.FeatureHash",ngeo.format.FeatureHash);ngeo.format.FeatureHash.CHAR64_=".-_!*ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghjkmnpqrstuvwxyz";ngeo.format.FeatureHash.ACCURACY_=.1;ngeo.format.FeatureHash.defaultPropertiesFunction_=function(a){return a.getProperties()};ngeo.format.FeatureHash.encodeSignedNumber_=function(a){var b=a<<1;0>a&&(b=~b);return ngeo.format.FeatureHash.encodeNumber_(b)};
ngeo.format.FeatureHash.encodeNumber_=function(a){for(var b="";32<=a;)b+=ngeo.format.FeatureHash.CHAR64_.charAt(32|a&31),a>>=5;return b+=ngeo.format.FeatureHash.CHAR64_.charAt(a)};
ngeo.format.FeatureHash.encodeStyles_=function(a,b,c){b=ngeo.format.FeatureHashStyleTypes_[b];goog.asserts.assert(void 0!==b);for(var d=0;d<a.length;++d){var e=a[d],f=e.getFill(),g=e.getImage(),h=e.getStroke();e=e.getText();b==ngeo.format.FeatureHashStyleType.POLYGON?null!==f&&ngeo.format.FeatureHash.encodeStylePolygon_(f,h,c):b==ngeo.format.FeatureHashStyleType.LINE_STRING?null!==h&&ngeo.format.FeatureHash.encodeStyleLine_(h,c):b==ngeo.format.FeatureHashStyleType.POINT&&null!==g&&ngeo.format.FeatureHash.encodeStylePoint_(g,
c);null!==e&&ngeo.format.FeatureHash.encodeStyleText_(e,c)}};ngeo.format.FeatureHash.encodeStyleLine_=function(a,b){ngeo.format.FeatureHash.encodeStyleStroke_(a,b)};ngeo.format.FeatureHash.encodeStylePoint_=function(a,b){if(a instanceof ol.style.Circle){var c=a.getRadius();0<b.length&&b.push("'");b.push(encodeURIComponent("pointRadius*"+c));c=a.getFill();null!==c&&ngeo.format.FeatureHash.encodeStyleFill_(c,b);a=a.getStroke();null!==a&&ngeo.format.FeatureHash.encodeStyleStroke_(a,b)}};
ngeo.format.FeatureHash.encodeStylePolygon_=function(a,b,c){ngeo.format.FeatureHash.encodeStyleFill_(a,c);null!==b&&ngeo.format.FeatureHash.encodeStyleStroke_(b,c)};
ngeo.format.FeatureHash.encodeStyleFill_=function(a,b,c){c=void 0!==c?c:"fillColor";a=a.getColor();null!==a&&(goog.asserts.assert(Array.isArray(a),"only supporting fill colors"),a=ol.color.asArray(a),goog.asserts.assert(Array.isArray(a),"fill color must be an array"),a=ngeo.utils.rgbArrayToHex(a),0<b.length&&b.push("'"),b.push(encodeURIComponent(c+"*"+a)))};
ngeo.format.FeatureHash.encodeStyleStroke_=function(a,b){var c=a.getColor();null!==c&&(goog.asserts.assert(Array.isArray(c)),c=ol.color.asArray(c),goog.asserts.assert(Array.isArray(c),"only supporting stroke colors"),c=ngeo.utils.rgbArrayToHex(c),0<b.length&&b.push("'"),b.push(encodeURIComponent("strokeColor*"+c)));a=a.getWidth();void 0!==a&&(0<b.length&&b.push("'"),b.push(encodeURIComponent("strokeWidth*"+a)))};
ngeo.format.FeatureHash.encodeStyleText_=function(a,b){var c=a.getFont();void 0!==c&&(c=c.split(" "),3<=c.length&&(0<b.length&&b.push("'"),b.push(encodeURIComponent("fontSize*"+c[1]))));a=a.getFill();null!==a&&ngeo.format.FeatureHash.encodeStyleFill_(a,b,"fontColor")};
ngeo.format.FeatureHash.readLineStringGeometry_=function(a){goog.asserts.assert("l("===a.substring(0,2));goog.asserts.assert(")"==a[a.length-1]);a=a.substring(2,a.length-1);a=this.decodeCoordinates_(a);var b=new ol.geom.LineString(null);b.setFlatCoordinates(ol.geom.GeometryLayout.XY,a);return b};
ngeo.format.FeatureHash.readMultiLineStringGeometry_=function(a){goog.asserts.assert("L("===a.substring(0,2));goog.asserts.assert(")"==a[a.length-1]);a=a.substring(2,a.length-1);var b=[],c=[];a=a.split("'");for(var d=0,e=a.length;d<e;++d)b=this.decodeCoordinates_(a[d],b),c[d]=b.length;a=new ol.geom.MultiLineString(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,b,c);return a};
ngeo.format.FeatureHash.readPointGeometry_=function(a){goog.asserts.assert("p("===a.substring(0,2));goog.asserts.assert(")"==a[a.length-1]);a=a.substring(2,a.length-1);a=this.decodeCoordinates_(a);goog.asserts.assert(2===a.length);var b=new ol.geom.Point(null);b.setFlatCoordinates(ol.geom.GeometryLayout.XY,a);return b};
ngeo.format.FeatureHash.readMultiPointGeometry_=function(a){goog.asserts.assert("P("===a.substring(0,2));goog.asserts.assert(")"==a[a.length-1]);a=a.substring(2,a.length-1);a=this.decodeCoordinates_(a);var b=new ol.geom.MultiPoint(null);b.setFlatCoordinates(ol.geom.GeometryLayout.XY,a);return b};
ngeo.format.FeatureHash.readPolygonGeometry_=function(a){goog.asserts.assert("a("===a.substring(0,2));goog.asserts.assert(")"==a[a.length-1]);a=a.substring(2,a.length-1);var b=[],c=[];a=a.split("'");for(var d=0,e=a.length;d<e;++d){b=this.decodeCoordinates_(a[d],b);var f=b.length;0===d?(b[f++]=b[0],b[f++]=b[1]):(b[f++]=b[c[d-1]],b[f++]=b[c[d-1]+1]);c[d]=f}a=new ol.geom.Polygon(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,b,c);return a};
ngeo.format.FeatureHash.readMultiPolygonGeometry_=function(a){goog.asserts.assert("A("===a.substring(0,2));goog.asserts.assert(")"==a[a.length-1]);a=a.substring(2,a.length-1);var b=[],c=[];a=a.split(")(");for(var d=0,e=a.length;d<e;++d)for(var f=a[d].split("'"),g=c[d]=[],h=0,k=f.length;h<k;++h){b=this.decodeCoordinates_(f[h],b);var l=b.length;0===h?(b[l++]=b[0],b[l++]=b[1]):(b[l++]=b[g[h-1]],b[l++]=b[g[h-1]+1]);g[h]=l}a=new ol.geom.MultiPolygon(null);a.setFlatCoordinates(ol.geom.GeometryLayout.XY,
b,c);return a};
ngeo.format.FeatureHash.setStyleInFeature_=function(a,b){if(""!=a){var c=ngeo.format.FeatureHash.getStyleProperties_(a,b),d=c.fillColor;a=c.fontSize;var e=c.fontColor,f=c.pointRadius,g=c.strokeColor,h=c.strokeWidth;c=null;void 0!==d&&(c=new ol.style.Fill({color:d}));d=null;void 0!==g&&void 0!==h&&(d=new ol.style.Stroke({color:g,width:h}));g=null;void 0!==f&&(g=new ol.style.Circle({radius:f,fill:c,stroke:d}),c=d=null);f=null;void 0!==a&&void 0!==e&&(f=new ol.style.Text({font:a+" sans-serif",fill:new ol.style.Fill({color:e})}));
a=new ol.style.Style({fill:c,image:g,stroke:d,text:f});b.setStyle(a)}};
ngeo.format.FeatureHash.setStyleProperties_=function(a,b){a=ngeo.format.FeatureHash.getStyleProperties_(a,b);var c=b.getGeometry();c instanceof ol.geom.Point?a.isLabel||a[ngeo.FeatureProperties.IS_TEXT]?(delete a.strokeColor,delete a.fillColor):(delete a.fontColor,delete a.fontSize):(delete a.fontColor,c instanceof ol.geom.LineString&&(delete a.fillColor,delete a.fillOpacity));a.fontSize&&(c=parseFloat(a.fontSize),-1!==a.fontSize.indexOf("px")&&(c=Math.round(c/1.333333)),a.fontSize=c);c={};for(var d in a){var e=
a[d];ngeo.format.FeatureHashLegacyProperties_[d]?c[ngeo.format.FeatureHashLegacyProperties_[d]]=e:c[d]=e}b.setProperties(c)};
ngeo.format.FeatureHash.castValue_=function(a,b){var c=[ngeo.FeatureProperties.IS_CIRCLE,ngeo.FeatureProperties.IS_RECTANGLE,ngeo.FeatureProperties.IS_TEXT,ngeo.FeatureProperties.SHOW_MEASURE,ngeo.FeatureProperties.SHOW_LABEL,"isCircle","isRectangle","isLabel","showMeasure","showLabel"];return ol.array.includes([ngeo.FeatureProperties.ANGLE,ngeo.FeatureProperties.OPACITY,ngeo.FeatureProperties.SIZE,ngeo.FeatureProperties.STROKE,"pointRadius","strokeWidth"],a)?+b:ol.array.includes(c,a)?"true"===b?
!0:!1:b};ngeo.format.FeatureHash.getStyleProperties_=function(a,b){a=a.split("'");b={};for(var c=0;c<a.length;++c){var d=decodeURIComponent(a[c]).split("*");goog.asserts.assert(2===d.length);var e=d[0];b[e]=ngeo.format.FeatureHash.castValue_(e,d[1])}return b};ngeo.format.FeatureHash.writeLineStringGeometry_=function(a){goog.asserts.assertInstanceof(a,ol.geom.LineString);var b=a.getFlatCoordinates();a=a.getStride();return"l("+this.encodeCoordinates_(b,a,0,b.length)+")"};
ngeo.format.FeatureHash.writeMultiLineStringGeometry_=function(a){goog.asserts.assertInstanceof(a,ol.geom.MultiLineString);var b=a.getEnds(),c=b.length,d=a.getFlatCoordinates();a=a.getStride();for(var e=0,f=["L("],g=0;g<c;++g){var h=b[g];e=this.encodeCoordinates_(d,a,e,h);0!==g&&f.push("'");f.push(e);e=h}f.push(")");return f.join("")};
ngeo.format.FeatureHash.writePointGeometry_=function(a){goog.asserts.assertInstanceof(a,ol.geom.Point);var b=a.getFlatCoordinates();a=a.getStride();return"p("+this.encodeCoordinates_(b,a,0,b.length)+")"};ngeo.format.FeatureHash.writeMultiPointGeometry_=function(a){goog.asserts.assertInstanceof(a,ol.geom.MultiPoint);var b=a.getFlatCoordinates();a=a.getStride();return"P("+this.encodeCoordinates_(b,a,0,b.length)+")"};
ngeo.format.FeatureHash.encodeRings_=function(a,b,c,d,e){for(var f=d.length,g=0;g<f;++g)c=this.encodeCoordinates_(a,b,c,d[g]-b),0!==g&&e.push("'"),e.push(c),c=d[g];return c};ngeo.format.FeatureHash.writePolygonGeometry_=function(a){goog.asserts.assertInstanceof(a,ol.geom.Polygon);var b=a.getFlatCoordinates(),c=a.getStride();a=a.getEnds();var d=["a("];ngeo.format.FeatureHash.encodeRings_.call(this,b,c,0,a,d);d.push(")");return d.join("")};
ngeo.format.FeatureHash.writeMultiPolygonGeometry_=function(a){goog.asserts.assertInstanceof(a,ol.geom.MultiPolygon);var b=a.getFlatCoordinates(),c=a.getStride();a=a.getEndss();for(var d=a.length,e=0,f=["A"],g=0;g<d;++g){var h=a[g];f.push("(");e=ngeo.format.FeatureHash.encodeRings_.call(this,b,c,e,h,f);f.push(")")}return f.join("")};
ngeo.format.FeatureHash.GEOMETRY_READERS_={P:ngeo.format.FeatureHash.readMultiPointGeometry_,L:ngeo.format.FeatureHash.readMultiLineStringGeometry_,A:ngeo.format.FeatureHash.readMultiPolygonGeometry_,l:ngeo.format.FeatureHash.readLineStringGeometry_,p:ngeo.format.FeatureHash.readPointGeometry_,a:ngeo.format.FeatureHash.readPolygonGeometry_};
ngeo.format.FeatureHash.GEOMETRY_WRITERS_={MultiLineString:ngeo.format.FeatureHash.writeMultiLineStringGeometry_,MultiPoint:ngeo.format.FeatureHash.writeMultiPointGeometry_,MultiPolygon:ngeo.format.FeatureHash.writeMultiPolygonGeometry_,LineString:ngeo.format.FeatureHash.writeLineStringGeometry_,Point:ngeo.format.FeatureHash.writePointGeometry_,Polygon:ngeo.format.FeatureHash.writePolygonGeometry_};
ngeo.format.FeatureHash.prototype.decodeCoordinates_=function(a,b){var c=a.length,d=0;b=void 0!==b?b:[];for(var e=b.length;d<c;){var f=0,g=0;do{var h=ngeo.format.FeatureHash.CHAR64_.indexOf(a.charAt(d++));g|=(h&31)<<f;f+=5}while(32<=h);this.prevX_+=g&1?~(g>>1):g>>1;g=f=0;do h=ngeo.format.FeatureHash.CHAR64_.indexOf(a.charAt(d++)),g|=(h&31)<<f,f+=5;while(32<=h);this.prevY_+=g&1?~(g>>1):g>>1;b[e++]=this.prevX_*this.accuracy_;b[e++]=this.prevY_*this.accuracy_}return b};
ngeo.format.FeatureHash.prototype.encodeCoordinates_=function(a,b,c,d){for(var e="";c<d;c+=b){var f=a[c],g=a[c+1];f=Math.floor(f/this.accuracy_);g=Math.floor(g/this.accuracy_);var h=f-this.prevX_,k=g-this.prevY_;this.prevX_=f;this.prevY_=g;e+=ngeo.format.FeatureHash.encodeSignedNumber_(h)+ngeo.format.FeatureHash.encodeSignedNumber_(k)}return e};
ngeo.format.FeatureHash.prototype.readFeatureFromText=function(a,b){goog.asserts.assert(2<a.length);goog.asserts.assert("("===a[1]);goog.asserts.assert(")"===a[a.length-1]);var c=a.indexOf("~"),d=0<=c?a.substring(0,c)+")":a;b=this.readGeometryFromText(d,b);b=new ol.Feature(b);if(0<=c){a=a.substring(c+1,a.length-1);c=a.indexOf("~");d=0<=c?a.substring(0,c):a;if(""!=d){d=d.split("'");for(var e=0;e<d.length;++e){var f=decodeURIComponent(d[e]).split("*");goog.asserts.assert(2===f.length);var g=f[0];f=
f[1];!this.setStyle_&&ngeo.format.FeatureHashLegacyProperties_[g]&&(g=ngeo.format.FeatureHashLegacyProperties_[g]);b.set(g,ngeo.format.FeatureHash.castValue_(g,f))}}0<=c&&(c=a.substring(c+1),this.setStyle_?ngeo.format.FeatureHash.setStyleInFeature_(c,b):ngeo.format.FeatureHash.setStyleProperties_(c,b))}return b};
ngeo.format.FeatureHash.prototype.readFeaturesFromText=function(a,b){var c=this;goog.asserts.assert("F"===a[0]);this.prevY_=this.prevX_=0;var d=[];for(a=a.substring(1);0<a.length;){var e=a.indexOf(")");goog.asserts.assert(0<=e);var f=this.readFeatureFromText(a.substring(0,e+1),b);d.push(f);a=a.substring(e+1)}d.forEach(function(a){for(var b in c.defaultValues_){var d=ngeo.format.FeatureHashLegacyProperties_[b];void 0===a.get(d)&&a.set(d,c.defaultValues_[b].call(null,a))}});return d};
ngeo.format.FeatureHash.prototype.readGeometryFromText=function(a,b){b=ngeo.format.FeatureHash.GEOMETRY_READERS_[a[0]];goog.asserts.assert(void 0!==b);return b.call(this,a)};
ngeo.format.FeatureHash.prototype.writeFeatureText=function(a,b){var c=[],d="",e=a.getGeometry();e&&(d=this.writeGeometryText(e,b));0<d.length&&(goog.asserts.assert(")"===d[d.length-1]),d=d.substring(0,d.length-1),c.push(d));b=[];d=this.propertiesFunction_(a);for(var f in d){var g=d[f];void 0!==g&&null!==g&&f!==a.getGeometryName()&&(0!==b.length&&b.push("'"),g=encodeURIComponent(f.replace(/[()'*]/g,"_")+"*"+g.toString().replace(/[()'*]/g,"_")),b.push(g))}0<b.length&&(c.push("~"),Array.prototype.push.apply(c,
b));this.encodeStyles_&&(f=a.getStyleFunction(),void 0!==f&&(a=f.call(a,0),null!==a&&(f=[],a=Array.isArray(a)?a:[a],ngeo.format.FeatureHash.encodeStyles_(a,e.getType(),f),0<f.length&&(c.push("~"),Array.prototype.push.apply(c,f)))));c.push(")");return c.join("")};ngeo.format.FeatureHash.prototype.writeFeaturesText=function(a,b){this.prevY_=this.prevX_=0;var c=[];if(0<a.length){c.push("F");for(var d=0,e=a.length;d<e;++d)c.push(this.writeFeatureText(a[d],b))}return c.join("")};
ngeo.format.FeatureHash.prototype.writeGeometryText=function(a,b){var c=ngeo.format.FeatureHash.GEOMETRY_WRITERS_[a.getType()];goog.asserts.assert(void 0!==c);a=ol.format.Feature.transformWithOptions(a,!0,b);return c.call(this,a)};ngeo.module.value("ngeoWfsPermalinkOptions",{url:"",wfsTypes:[],defaultFeatureNS:"",defaultFeaturePrefix:""});
ngeo.WfsPermalink=function(a,b,c){var d=this;this.url_=c.url;this.maxFeatures_=void 0!==c.maxFeatures?c.maxFeatures:50;this.wfsTypes_={};goog.asserts.assertArray(c.wfsTypes,"wfsTypes is not correctly set");c.wfsTypes.forEach(function(a){d.wfsTypes_[a.featureType]=a});this.defaultFeatureNS_=c.defaultFeatureNS;this.defaultFeaturePrefix_=c.defaultFeaturePrefix;this.pointRecenterZoom_=c.pointRecenterZoom;this.$http_=a;this.result_=b};ngeo.WfsPermalink.$inject=["$http","ngeoQueryResult","ngeoWfsPermalinkOptions"];
ngeo.WfsPermalink.prototype.clear=function(){this.clearResult_()};goog.exportProperty(ngeo.WfsPermalink.prototype,"clear",ngeo.WfsPermalink.prototype.clear);ngeo.WfsPermalink.prototype.issue=function(a,b){goog.asserts.assert(this.url_,"url is not set. to use the wfs permalink service, set the value `ngeoWfsPermalinkOptions`");this.clearResult_();var c=a.wfsType;if(this.wfsTypes_.hasOwnProperty(c)){c=this.wfsTypes_[c];var d=this.createFilters_(a.filterGroups);null!==d&&this.issueRequest_(c,d,b,a.showFeatures)}};
goog.exportProperty(ngeo.WfsPermalink.prototype,"issue",ngeo.WfsPermalink.prototype.issue);
ngeo.WfsPermalink.prototype.issueRequest_=function(a,b,c,d){var e=this,f=new ol.format.WFS;b=f.writeGetFeature({srsName:c.getView().getProjection().getCode(),featureNS:void 0!==a.featureNS?a.featureNS:this.defaultFeatureNS_,featurePrefix:void 0!==a.featurePrefix?a.featurePrefix:this.defaultFeaturePrefix_,featureTypes:[a.featureType],outputFormat:"GML3",filter:b,maxFeatures:this.maxFeatures_});b=(new XMLSerializer).serializeToString(b);this.$http_.post(this.url_,b,{headers:{"Content-Type":"text/xml; charset=UTF-8"}}).then(function(b){b=
f.readFeatures(b.data);if(0!=b.length){var g=c.getSize();if(void 0!==g){var k=e.pointRecenterZoom_;c.getView().fit(e.getExtent_(b),{size:g,maxZoom:k,padding:[10,10,10,10]})}d&&(e.result_.sources.push({features:b,id:a.featureType,identifierAttributeField:a.label,label:a.featureType,pending:!1}),e.result_.total=b.length)}})};ngeo.WfsPermalink.prototype.getExtent_=function(a){return a.reduce(function(a,c){return ol.extent.extend(a,c.getGeometry().getExtent())},ol.extent.createEmpty())};
ngeo.WfsPermalink.prototype.createFilters_=function(a){if(0==a.length)return null;var b=ol.format.filter;return ngeo.WfsPermalink.or_(a.map(function(a){a=a.filters.map(function(a){var c=a.condition;return Array.isArray(c)?ngeo.WfsPermalink.or_(c.map(function(c){return b.equalTo(a.property,c)})):b.equalTo(a.property,a.condition)});return ngeo.WfsPermalink.and_(a)}))};ngeo.WfsPermalink.and_=function(a){return ngeo.WfsPermalink.joinFilters_(a,ol.format.filter.and)};
ngeo.WfsPermalink.or_=function(a){return ngeo.WfsPermalink.joinFilters_(a,ol.format.filter.or)};ngeo.WfsPermalink.joinFilters_=function(a,b){return a.reduce(function(a,d){if(null===a)return d;goog.asserts.assert(null!==d);return b(a,d)},null)};ngeo.WfsPermalink.prototype.clearResult_=function(){this.result_.total=0;this.result_.sources.forEach(function(a){a.features.length=0},this)};ngeo.module.service("ngeoWfsPermalink",ngeo.WfsPermalink);gmf.PermalinkOpenLayersLayerProperties={OPACITY:"opacity"};gmf.PermalinkParamPrefix={DIMENSIONS:"dim_",TREE_ENABLE:"tree_enable_",TREE_GROUP_LAYERS:"tree_group_layers_",TREE_GROUP_OPACITY:"tree_group_opacity_",TREE_OPACITY:"tree_opacity_",WFS:"wfs_"};gmf.module.value("gmfPermalinkOptions",{});
(function(){var a=[],b;for(b in gmf.PermalinkParamPrefix)a.push(new RegExp(gmf.PermalinkParamPrefix[b]+".*"));for(var c in gmf.PermalinkParam)a.push(new RegExp(gmf.PermalinkParamPrefix[c]));ngeo.module.value("ngeoUsedKeyRegexp",a)})();
gmf.Permalink=function(a,b,c,d,e,f,g){var h=this;this.rootScope_=b;this.$timeout_=a;this.mapViewPropertyChangeEventKey_=null;this.listenerKeys_={};this.ngeoDebounce_=d;this.ngeoStateManager_=f;this.ngeoFeatures_=c.has("ngeoFeatures")?c.get("ngeoFeatures"):null;this.ngeoBackgroundLayerMgr_=c.has("ngeoBackgroundLayerMgr")?c.get("ngeoBackgroundLayerMgr"):null;this.featureOverlay_=(a=c.has("ngeoFeatureOverlayMgr")?c.get("ngeoFeatureOverlayMgr"):null)?a.getFeatureOverlay():null;this.featureHelper_=c.has("ngeoFeatureHelper")?
c.get("ngeoFeatureHelper"):null;a=c.has("gmfPermalinkOptions")?c.get("gmfPermalinkOptions"):{};!1===a.useLocalStorage&&(this.ngeoStateManager_.useLocalStorage=!1);this.crosshairEnabledByDefault_=!!a.crosshairEnabledByDefault;this.gmfThemes_=c.has("gmfThemes")?c.get("gmfThemes"):null;this.gmfObjectEditingManager_=c.has("gmfObjectEditingManager")?c.get("gmfObjectEditingManager"):null;this.gmfThemeManager_=c.has("gmfThemeManager")?c.get("gmfThemeManager"):null;this.defaultTheme_=c.has("defaultTheme")?
c.get("defaultTheme"):void 0;this.gmfTreeManager_=c.has("gmfTreeManager")?c.get("gmfTreeManager"):null;this.ngeoLocation_=g;this.ngeoWfsPermalink_=c.has("ngeoWfsPermalink")?c.get("ngeoWfsPermalink"):null;this.gmfUser_=c.has("gmfUser")?c.get("gmfUser"):null;this.map_=null;this.ngeoAutoProjection_=c.has("ngeoAutoProjection")?c.get("ngeoAutoProjection"):null;this.sourceProjections_=null;void 0!==a.projectionCodes&&this.ngeoAutoProjection_&&(c=this.ngeoAutoProjection_.getProjectionList(a.projectionCodes),
0<c.length&&(this.sourceProjections_=c));this.crosshairFeature_=null;this.crosshairStyle_=void 0!==a.crosshairStyle?a.crosshairStyle:[new ol.style.Style({image:new ol.style.RegularShape({stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 0.8)",width:5}),points:4,radius:8,radius2:0,angle:0})}),new ol.style.Style({image:new ol.style.RegularShape({stroke:new ol.style.Stroke({color:"rgba(255, 0, 0, 1)",width:2}),points:4,radius:8,radius2:0,angle:0})})];this.mapTooltip_=null;this.featureHashFormat_=
new ngeo.format.FeatureHash({setStyle:!1,encodeStyles:!1,propertiesType:{fillColor:ngeo.FeatureProperties.COLOR,fillOpacity:ngeo.FeatureProperties.OPACITY,fontColor:ngeo.FeatureProperties.COLOR,fontSize:ngeo.FeatureProperties.SIZE,isBox:ngeo.FeatureProperties.IS_RECTANGLE,isCircle:ngeo.FeatureProperties.IS_CIRCLE,isLabel:ngeo.FeatureProperties.IS_TEXT,name:ngeo.FeatureProperties.NAME,pointRadius:ngeo.FeatureProperties.SIZE,showLabel:ngeo.FeatureProperties.SHOW_LABEL,showMeasure:ngeo.FeatureProperties.SHOW_MEASURE,
strokeColor:ngeo.FeatureProperties.COLOR,strokeWidth:ngeo.FeatureProperties.STROKE},defaultValues:{name:function(a){return e.getString(a.getGeometry().getType())},fillOpacity:function(){return.5},showLabel:function(){return!1},showMeasure:function(){return!1}}});this.ngeoBackgroundLayerMgr_&&ol.events.listen(this.ngeoBackgroundLayerMgr_,ngeo.BackgroundEventType.CHANGE,this.handleBackgroundLayerManagerChange_,this);this.rootScope_.$on("ngeo-layertree-state",function(a,b,c){var d={};if(c.node.mixed){a=
b.getState();goog.asserts.assert("on"===a||"off"===a);var e="on"===a;b.traverseDepthFirst(function(a){void 0===a.node.children&&(d[gmf.PermalinkParamPrefix.TREE_ENABLE+a.node.name]=e)})}else{var f=[];c.traverseDepthFirst(function(a){void 0===a.node.children&&"on"===a.getState()&&f.push(a.node.name)});d[gmf.PermalinkParamPrefix.TREE_GROUP_LAYERS+c.node.name]=f.join(",")}h.ngeoStateManager_.updateState(d)});this.rootScope_.$on("ngeo-layertree-opacity",function(a,b){a={};var c=b.layer.getOpacity();a[(b.parent.node.mixed?
gmf.PermalinkParamPrefix.TREE_OPACITY:gmf.PermalinkParamPrefix.TREE_GROUP_OPACITY)+b.node.name]=c;h.ngeoStateManager_.updateState(a)});var k=this.getFeatures();this.ngeoFeatures_&&(k.forEach(function(a){this.featureHelper_&&this.featureHelper_.setStyle(a);this.addNgeoFeature_(a)},this),this.ngeoFeatures_.extend(k),ol.events.listen(this.ngeoFeatures_,ol.CollectionEventType.ADD,this.handleNgeoFeaturesAdd_,this),ol.events.listen(this.ngeoFeatures_,ol.CollectionEventType.REMOVE,this.handleNgeoFeaturesRemove_,
this));this.featureHelper_&&this.rootScope_.$on("$localeChangeSuccess",function(){k.forEach(function(a){this.featureHelper_.setStyle(a)},h)});this.gmfThemeManager_&&this.rootScope_.$on(gmf.ThemeManagerEventType.THEME_NAME_SET,function(a,b){h.setThemeInUrl_(b)});this.initLayers_()};gmf.Permalink.$inject="$timeout $rootScope $injector ngeoDebounce gettextCatalog ngeoStateManager ngeoLocation".split(" ");
gmf.Permalink.prototype.initListenerKey_=function(a){this.listenerKeys_[a]?(this.listenerKeys_[a].goog.length&&(this.listenerKeys_[a].goog.forEach(function(a){goog.events.unlistenByKey(a)},this),this.listenerKeys_[a].goog.length=0),this.listenerKeys_[a].ol.length&&(this.listenerKeys_[a].ol.forEach(function(a){ol.events.unlistenByKey(a)},this),this.listenerKeys_[a].ol.length=0)):this.listenerKeys_[a]={goog:[],ol:[]}};
gmf.Permalink.prototype.addListenerKey_=function(a,b,c){this.listenerKeys_[a]||this.initListenerKey_(a);(void 0!==c?c:1)?this.listenerKeys_[a].ol.push(b):this.listenerKeys_[a].goog.push(b)};
gmf.Permalink.prototype.getMapCenter=function(){var a=this.ngeoStateManager_.getInitialNumberValue(gmf.PermalinkParam.MAP_X),b=this.ngeoStateManager_.getInitialNumberValue(gmf.PermalinkParam.MAP_Y);return isNaN(a)||isNaN(b)?null:(a=[a,b],null!==this.sourceProjections_&&this.ngeoAutoProjection_&&(b=this.map_.getView().getProjection(),b=this.ngeoAutoProjection_.tryProjectionsWithInversion(a,b.getExtent(),b,this.sourceProjections_))?b:a)};goog.exportProperty(gmf.Permalink.prototype,"getMapCenter",gmf.Permalink.prototype.getMapCenter);
gmf.Permalink.prototype.getMapZoom=function(){var a=this.ngeoStateManager_.getInitialNumberValue(gmf.PermalinkParam.MAP_Z);return isNaN(a)?void 0:a};goog.exportProperty(gmf.Permalink.prototype,"getMapZoom",gmf.Permalink.prototype.getMapZoom);gmf.Permalink.prototype.getMapCrosshair=function(){var a=this.ngeoStateManager_.getInitialBooleanValue(gmf.PermalinkParam.MAP_CROSSHAIR);return void 0===a?this.crosshairEnabledByDefault_:a};goog.exportProperty(gmf.Permalink.prototype,"getMapCrosshair",gmf.Permalink.prototype.getMapCrosshair);
gmf.Permalink.prototype.setMapCrosshair=function(a){a=a?a:this.map_.getView().getCenter();goog.asserts.assertArray(a);this.crosshairFeature_&&this.featureOverlay_.removeFeature(this.crosshairFeature_);this.crosshairFeature_=new ol.Feature(new ol.geom.Point(a));this.crosshairFeature_.setStyle(this.crosshairStyle_);this.featureOverlay_.addFeature(this.crosshairFeature_)};gmf.Permalink.prototype.getMapTooltip=function(){return this.ngeoStateManager_.getInitialStringValue(gmf.PermalinkParam.MAP_TOOLTIP)};
goog.exportProperty(gmf.Permalink.prototype,"getMapTooltip",gmf.Permalink.prototype.getMapTooltip);gmf.Permalink.prototype.setMapTooltip=function(a,b){b=b?b:this.map_.getView().getCenter();goog.asserts.assertArray(b);a=$("<div/>",{"class":"gmf-permalink-tooltip",text:a})[0];null!==this.mapTooltip_&&this.map_.removeOverlay(this.mapTooltip_);this.mapTooltip_=new ngeo.Popover({element:a,position:b});this.map_.addOverlay(this.mapTooltip_)};
gmf.Permalink.prototype.getFeatures=function(){var a=this.ngeoStateManager_.getInitialStringValue(gmf.PermalinkParam.FEATURES);return void 0!==a&&""!==a?goog.asserts.assert(this.featureHashFormat_.readFeatures(a)):[]};goog.exportProperty(gmf.Permalink.prototype,"getFeatures",gmf.Permalink.prototype.getFeatures);
gmf.Permalink.prototype.setDimensions=function(a){for(var b=this,c=this.ngeoLocation_.getParamKeysWithPrefix(gmf.PermalinkParamPrefix.DIMENSIONS),d=0;d<c.length;d++){var e=c[d],f=this.ngeoLocation_.getParam(e);goog.asserts.assert(f);a[e.slice(gmf.PermalinkParamPrefix.DIMENSIONS.length)]=f}this.rootScope_.$watchCollection(function(){return a},function(a){var c={},d;for(d in a)c[gmf.PermalinkParamPrefix.DIMENSIONS+d]=a[d];b.ngeoLocation_.updateParams(c)})};
goog.exportProperty(gmf.Permalink.prototype,"setDimensions",gmf.Permalink.prototype.setDimensions);gmf.Permalink.prototype.setMap=function(a){var b=this;a!==this.map_&&(this.map_&&(this.unregisterMap_(),this.map_=null),a&&(this.map_=a,this.gmfObjectEditingManager_?this.gmfObjectEditingManager_.getFeature().then(function(c){b.registerMap_(a,c)}):this.registerMap_(a,null)))};goog.exportProperty(gmf.Permalink.prototype,"setMap",gmf.Permalink.prototype.setMap);
gmf.Permalink.prototype.registerMap_=function(a,b){var c=this,d=a.getView(),e;if(b&&b.getGeometry()){var f=a.getSize();goog.asserts.assert(f);d.fit(b.getGeometry().getExtent(),f)}else(e=this.getMapCenter())&&d.setCenter(e),b=this.getMapZoom(),void 0!==b&&d.setZoom(b);this.mapViewPropertyChangeEventKey_=ol.events.listen(d,"propertychange",this.ngeoDebounce_(function(){var a=d.getCenter(),b=d.getZoom(),e={};e[gmf.PermalinkParam.MAP_X]=Math.round(a[0]);e[gmf.PermalinkParam.MAP_Y]=Math.round(a[1]);e[gmf.PermalinkParam.MAP_Z]=
b;c.ngeoStateManager_.updateState(e)},300,!0),this);this.getMapCrosshair()&&this.featureOverlay_&&this.setMapCrosshair(e);(b=this.getMapTooltip())&&this.setMapTooltip(b,e);e=this.getWfsPermalinkData_();null!==e&&this.ngeoWfsPermalink_&&this.ngeoWfsPermalink_.issue(e,a)};gmf.Permalink.prototype.unregisterMap_=function(){goog.asserts.assert(this.mapViewPropertyChangeEventKey_,"Key should be thruthy");ol.events.unlistenByKey(this.mapViewPropertyChangeEventKey_);this.mapViewPropertyChangeEventKey_=null};
gmf.Permalink.prototype.getBackgroundLayer=function(a){var b=this.ngeoStateManager_.getInitialStringValue(gmf.PermalinkParam.BG_LAYER);if(void 0!==b){a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())if(c=c.value,c.get("label")===b)return c}return null};goog.exportProperty(gmf.Permalink.prototype,"getBackgroundLayer",gmf.Permalink.prototype.getBackgroundLayer);
gmf.Permalink.prototype.handleBackgroundLayerManagerChange_=function(){if(this.map_&&this.ngeoBackgroundLayerMgr_){var a=this.ngeoBackgroundLayerMgr_.get(this.map_).get("label");goog.asserts.assertString(a);var b={};b[gmf.PermalinkParam.BG_LAYER]=a;this.ngeoStateManager_.updateState(b)}};
gmf.Permalink.prototype.refreshFirstLevelGroups=function(){if(this.gmfTreeManager_){var a=this.gmfTreeManager_.rootCtrl.node.children.map(function(a){return a.name}),b={};b[gmf.PermalinkParam.TREE_GROUPS]=a.join(",");this.ngeoStateManager_.updateState(b)}};goog.exportProperty(gmf.Permalink.prototype,"refreshFirstLevelGroups",gmf.Permalink.prototype.refreshFirstLevelGroups);gmf.Permalink.prototype.themeInUrl_=function(a){var b=a.indexOf("theme");return-1!=b&&b==a.length-2};
gmf.Permalink.prototype.setThemeInUrl_=function(a){if(a){var b=this.ngeoLocation_.getPath().split("/");goog.asserts.assert(1<b.length);""===b[b.length-1]&&b.splice(b.length-1);this.themeInUrl_(b)?b[b.length-1]=a:b.push("theme",a);this.ngeoLocation_.setPath(b.join("/"))}};
gmf.Permalink.prototype.defaultThemeName=function(){var a=this.ngeoLocation_.getPath().split("/");if(this.themeInUrl_(a))return a[a.length-1];if(a=this.ngeoStateManager_.getInitialStringValue("theme"))return a;a=this.defaultThemeNameFromFunctionalities();return null!==a?a:this.defaultTheme_?this.defaultTheme_:null};goog.exportProperty(gmf.Permalink.prototype,"defaultThemeName",gmf.Permalink.prototype.defaultThemeName);
gmf.Permalink.prototype.defaultThemeNameFromFunctionalities=function(){if(!this.gmfUser_)return null;var a=this.gmfUser_.functionalities;return a&&"default_theme"in a&&(a=a.default_theme,0<a.length)?a[0]:null};goog.exportProperty(gmf.Permalink.prototype,"defaultThemeNameFromFunctionalities",gmf.Permalink.prototype.defaultThemeNameFromFunctionalities);
gmf.Permalink.prototype.initLayers_=function(){var a=this;this.gmfThemes_&&this.gmfThemes_.getThemesObject().then(function(b){var c=a.defaultThemeName();goog.asserts.assert(null!==c);a.gmfThemeManager_&&a.gmfThemeManager_.setThemeName(a.gmfThemeManager_.modeFlush?c:"");var d=[],e=a.ngeoLocation_.getParam(gmf.PermalinkParam.TREE_GROUPS);if(void 0===e){if(goog.asserts.assertString(c),c=gmf.Themes.findThemeByName(b,c))d=c.children}else e.split(",").forEach(function(a){(a=gmf.Themes.findGroupByName(b,
a))&&d.push(a)});a.gmfTreeManager_&&a.gmfTreeManager_.setFirstLevelGroups(d);a.$timeout_(function(){a.gmfTreeManager_&&a.gmfTreeManager_.rootCtrl&&(a.gmfTreeManager_.rootCtrl.traverseDepthFirst(function(b){if(!b.isRoot){var c=a.ngeoStateManager_.getInitialNumberValue((b.parent.node.mixed?gmf.PermalinkParamPrefix.TREE_OPACITY:gmf.PermalinkParamPrefix.TREE_GROUP_OPACITY)+b.node.name);void 0!==c&&b.layer&&b.layer.setOpacity(c);if(b.parent.node&&b.parent.node.mixed&&void 0==b.node.children)c=a.ngeoStateManager_.getInitialBooleanValue(gmf.PermalinkParamPrefix.TREE_ENABLE+
b.node.name),void 0!==c&&b.setState(c?"on":"off",!1);else if(!b.node.mixed&&1==b.depth&&(c=a.ngeoStateManager_.getInitialStringValue(gmf.PermalinkParamPrefix.TREE_GROUP_LAYERS+b.node.name),void 0!==c)){var d=c.split(",");b.traverseDepthFirst(function(a){if(void 0===a.node.children){var b=ol.array.includes(d,a.node.name);a.setState(b?"on":"off",!1)}})}}}),a.gmfTreeManager_.rootCtrl.children.forEach(function(b){b.traverseDepthFirst(function(c){if("indeterminate"!==c.getState())return a.rootScope_.$broadcast("ngeo-layertree-state",
c,b),ngeo.LayertreeController.VisitorDecision.STOP})}))})})};gmf.Permalink.prototype.handleNgeoFeaturesAdd_=function(a){a=a.element;goog.asserts.assertInstanceof(a,ol.Feature);this.addNgeoFeature_(a)};gmf.Permalink.prototype.handleNgeoFeaturesRemove_=function(a){a=a.element;goog.asserts.assertInstanceof(a,ol.Feature);this.removeNgeoFeature_(a)};
gmf.Permalink.prototype.addNgeoFeature_=function(a){var b=ol.getUid(a);this.addListenerKey_(b,ol.events.listen(a,ol.events.EventType.CHANGE,this.handleNgeoFeaturesChange_,this),!0)};gmf.Permalink.prototype.removeNgeoFeature_=function(a){a=ol.getUid(a);this.initListenerKey_(a);this.handleNgeoFeaturesChange_()};
gmf.Permalink.prototype.handleNgeoFeaturesChange_=function(){if(this.ngeoFeatures_){var a=this.ngeoFeatures_.getArray();a=this.featureHashFormat_.writeFeatures(a);var b={};b[gmf.PermalinkParam.FEATURES]=a;this.ngeoStateManager_.updateState(b)}};
gmf.Permalink.prototype.getWfsPermalinkData_=function(){var a=this.ngeoLocation_.getParam(gmf.PermalinkParam.WFS_LAYER);if(!a)return null;var b=this.ngeoLocation_.getParamAsInt(gmf.PermalinkParam.WFS_NGROUPS),c=this.ngeoLocation_.getParamKeysWithPrefix(gmf.PermalinkParamPrefix.WFS),d=[];if(void 0===b){var e=this.createFilterGroup_(gmf.PermalinkParamPrefix.WFS,c);null!==e&&d.push(e)}else for(var f=0;f<b;f++)e=this.createFilterGroup_(gmf.PermalinkParamPrefix.WFS+f+"_",c),null!==e&&d.push(e);if(0==d.length)return null;
b=this.ngeoLocation_.getParam(gmf.PermalinkParam.WFS_SHOW_FEATURES);return{wfsType:a,showFeatures:!("0"===b||"false"===b),filterGroups:d}};
gmf.Permalink.prototype.createFilterGroup_=function(a,b){var c=this,d=[];b.forEach(function(b){if(b!=gmf.PermalinkParam.WFS_LAYER&&b!=gmf.PermalinkParam.WFS_SHOW_FEATURES&&b!=gmf.PermalinkParam.WFS_NGROUPS&&0==b.indexOf(a)){var e=c.ngeoLocation_.getParam(b);if(e){var g=e;-1<e.indexOf(",")&&(g=e.split(","));b={property:b.replace(a,""),condition:g};d.push(b)}}});return 0<d.length?{filters:d}:null};
gmf.Permalink.prototype.containsLayerName=function(a,b){if(a instanceof ol.layer.Group){a=$jscomp.makeIterator(a.getLayers().getArray());for(var c=a.next();!c.done;c=a.next())if(c=c.value,goog.asserts.assert(c),this.containsLayerName(c,b))return!0;return!1}return a.get("layerNodeName")==b};
gmf.Permalink.prototype.cleanParams=function(a){for(var b=this,c=goog.asserts.assert(this.ngeoLocation_.getParamKeys()),d=$jscomp.makeIterator(c),e=d.next();!e.done;e=d.next()){e=e.value;if(e.startsWith(gmf.PermalinkParamPrefix.TREE_GROUP_LAYERS))for(var f=e.substring(gmf.PermalinkParamPrefix.TREE_GROUP_LAYERS.length),g=$jscomp.makeIterator(a),h=g.next();!h.done;h=g.next())if(h.value.name==f){this.ngeoStateManager_.deleteParam(e);break}if(e.startsWith(gmf.PermalinkParamPrefix.TREE_GROUP_OPACITY))for(f=
e.substring(gmf.PermalinkParamPrefix.TREE_GROUP_OPACITY.length),g=$jscomp.makeIterator(a),h=g.next();!h.done;h=g.next())if(h.value.name==f){this.ngeoStateManager_.deleteParam(e);break}}this.$timeout_(function(){if(b.map_){var a=b.map_.getLayerGroup();goog.asserts.assert(a);for(var d=$jscomp.makeIterator(c),e=d.next();!e.done;e=d.next()){e=e.value;if(e.startsWith(gmf.PermalinkParamPrefix.TREE_ENABLE)){var f=e.substring(gmf.PermalinkParamPrefix.TREE_ENABLE.length);b.containsLayerName(a,f)||b.ngeoStateManager_.deleteParam(e)}e.startsWith(gmf.PermalinkParamPrefix.TREE_OPACITY)&&
(f=e.substring(gmf.PermalinkParamPrefix.TREE_OPACITY.length),b.containsLayerName(a,f)||b.ngeoStateManager_.deleteParam(e))}}})};gmf.module.service("gmfPermalink",gmf.Permalink);ngeo.popoverDirective=function(){return{restrict:"A",scope:!0,controller:"NgeoPopoverController as popoverCtrl",link:function(a,b,c,d){d.anchorElm.on("hidden.bs.popover",function(){d.anchorElm.data("bs.popover").inState.click=!1});d.anchorElm.on("inserted.bs.popover",function(){d.bodyElm.show();d.shown=!0});d.anchorElm.popover({container:"body",html:!0,content:d.bodyElm,placement:c.ngeoPopoverPlacement||"right"});if(c.ngeoPopoverDismiss)$(c.ngeoPopoverDismiss).on("scroll",function(){d.dismissPopover()});
a.$on("$destroy",function(){d.anchorElm.popover("destroy");d.anchorElm.unbind("inserted.bs.popover");d.anchorElm.unbind("hidden.bs.popover")})}}};ngeo.popoverAnchorDirective=function(){return{restrict:"A",require:"^^ngeoPopover",link:function(a,b,c,d){d.anchorElm=b}}};ngeo.popoverContentDirective=function(){return{restrict:"A",require:"^^ngeoPopover",link:function(a,b,c,d){d.bodyElm=b;b.hide()}}};
ngeo.PopoverController=function(a){function b(a){this.anchorElm[0]!==a.target&&this.bodyElm.parent()[0]!==a.target&0===this.bodyElm.parent().find(a.target).length&&this.shown&&this.dismissPopover()}this.shown=!1;this.bodyElm=this.anchorElm=void 0;angular.element("body").on("mousedown",b.bind(this));a.$on("$destroy",function(){angular.element("body").off("mousedown",b)})};ngeo.PopoverController.$inject=["$scope"];ngeo.PopoverController.prototype.dismissPopover=function(){this.shown=!1;this.anchorElm.popover("hide")};
goog.exportProperty(ngeo.PopoverController.prototype,"dismissPopover",ngeo.PopoverController.prototype.dismissPopover);ngeo.module.controller("NgeoPopoverController",ngeo.PopoverController);ngeo.module.directive("ngeoPopover",ngeo.popoverDirective);ngeo.module.directive("ngeoPopoverAnchor",ngeo.popoverAnchorDirective);ngeo.module.directive("ngeoPopoverContent",ngeo.popoverContentDirective);gmf.module.value("gmfLayertreeTemplate",function(a,b){return'<div ngeo-layertree="gmfLayertreeCtrl.root" ngeo-layertree-map="gmfLayertreeCtrl.map" ngeo-layertree-nodelayer="gmfLayertreeCtrl.getLayer(treeCtrl)" ngeo-layertree-listeners="gmfLayertreeCtrl.listeners(treeScope, treeCtrl)" ngeo-layertree-templateurl="'+(gmf.baseTemplateUrl+"/layertree.html")+'"></div>'});function gmfLayertreeTemplate(a,b,c){return c(a,b)}gmfLayertreeTemplate.$inject=["$element","$attrs","gmfLayertreeTemplate"];
ngeo.module.value("ngeoLayertreeTemplateUrl",function(a,b){return gmf.baseTemplateUrl+"/layertree.html"});gmf.layertreeComponent={controller:"GmfLayertreeController as gmfLayertreeCtrl",bindings:{map:"=gmfLayertreeMap",dimensions:"=?gmfLayertreeDimensions",openLinksInNewWindow:"<?gmfLayertreeOpenlinksinnewwindow"},template:gmfLayertreeTemplate};gmf.module.component("gmfLayertree",gmf.layertreeComponent);
gmf.LayertreeController=function(a,b,c,d,e,f,g,h,k,l,m,n,p){var q=this;this.scope_=d;this.$http_=b;this.$sce_=c;this.layerHelper_=f;this.gmfDataSourceBeingFiltered=g;this.gmfPermalink_=h;this.gmfTreeManager_=k;b=k.root;goog.asserts.assert(b);this.root=b;this.gmfSyncLayertreeMap_=l;this.ngeoWMSTime_=n;this.infoPopup_=e();this.promises_={};this.groupNodeStates_={};this.dataLayerGroup_=null;this.layers=[];this.gmfThemes_=p;this.ngeoSyncArrays_=m;a.on("shown.bs.collapse",function(){q.scope_.$apply()})};
goog.exportSymbol("gmf.LayertreeController",gmf.LayertreeController);gmf.LayertreeController.$inject="$element $http $sce $scope ngeoCreatePopup ngeoLayerHelper gmfDataSourceBeingFiltered gmfPermalink gmfTreeManager gmfSyncLayertreeMap ngeoSyncArrays ngeoWMSTime gmfThemes".split(" ");
gmf.LayertreeController.prototype.$onInit=function(){var a=this;this.openLinksInNewWindow=!0===this.openLinksInNewWindow;this.dataLayerGroup_=this.layerHelper_.getGroupFromMap(this.map,gmf.DATALAYERGROUP_NAME);this.ngeoSyncArrays_(this.dataLayerGroup_.getLayers().getArray(),this.layers,!0,this.scope_,function(){return!0});this.scope_.$watchCollection(function(){return a.layers},function(){a.map.render()});this.scope_.$watchCollection(function(){if(a.gmfTreeManager_.rootCtrl)return a.dimensions},function(b){b&&
a.updateDimensions_(a.gmfTreeManager_.rootCtrl)})};gmf.LayertreeController.prototype.updateDimensions_=function(a){var b=this;a.traverseDepthFirst(function(a){if(a.node.dimensions){var c=a.layer;goog.asserts.assertInstanceof(c,ol.layer.Layer);b.updateLayerDimensions_(c,a.node)}})};
gmf.LayertreeController.prototype.updateLayerDimensions_=function(a,b){var c=this;if(this.dimensions&&b.dimensions){var d={};for(f in b.dimensions)if(null===b.dimensions[f]){var e=this.dimensions[f];void 0!==e&&(d[f]=e)}else d[f]=b.dimensions[f];if(!ol.obj.isEmpty(d)){var f=a.getSource();if(f instanceof ol.source.WMTS)f.updateDimensions(d);else if(f instanceof ol.source.TileWMS||f instanceof ol.source.ImageWMS)f.updateParams(d);else a.once("change:source",function(){goog.asserts.assertInstanceof(a,
ol.layer.Layer);c.updateLayerDimensions_(a,b)})}}};gmf.LayertreeController.prototype.getLayer=function(a){if(a.parent.isRoot){this.gmfTreeManager_.rootCtrl=a.parent;var b=this.gmfTreeManager_.root.children.length-this.gmfTreeManager_.numberOfGroupsToAddInThisDigestLoop||0}b=this.gmfSyncLayertreeMap_.createLayer(a,this.map,this.dataLayerGroup_,b);b instanceof ol.layer.Layer&&this.updateLayerDimensions_(b,a.node);return b};goog.exportProperty(gmf.LayertreeController.prototype,"getLayer",gmf.LayertreeController.prototype.getLayer);
gmf.LayertreeController.prototype.listeners=function(a,b){var c=this.dataLayerGroup_;a.$on("$destroy",function(){c.getLayers().remove(b.layer)})};goog.exportProperty(gmf.LayertreeController.prototype,"listeners",gmf.LayertreeController.prototype.listeners);gmf.LayertreeController.prototype.toggleActive=function(a){a.setState("on"===a.getState()?"off":"on")};goog.exportProperty(gmf.LayertreeController.prototype,"toggleActive",gmf.LayertreeController.prototype.toggleActive);
gmf.LayertreeController.prototype.getNodeState=function(a){return a.getState()};goog.exportProperty(gmf.LayertreeController.prototype,"getNodeState",gmf.LayertreeController.prototype.getNodeState);gmf.LayertreeController.prototype.updateWMSTimeLayerState=function(a,b){if(b){var c=a.getDataSource();if(c)c.timeRangeValue=b;else if(a.children){c=0;for(var d=a.children.length;c<d;c++)this.updateWMSTimeLayerState(a.children[c],b)}}};
goog.exportProperty(gmf.LayertreeController.prototype,"updateWMSTimeLayerState",gmf.LayertreeController.prototype.updateWMSTimeLayerState);gmf.LayertreeController.prototype.getLegendIconURL=function(a){var b=a.node.metadata.iconUrl;if(void 0!==b)return b;if(void 0===a.node.children){var c=a.node;if("WMS"===c.type&&(b=c.metadata.legendRule,void 0!==b))return c=c.layers.split(",")[0],a=this.gmfTreeManager_.getOgcServer(a),this.layerHelper_.getWMSLegendURL(a.url,c,void 0,b)}};
goog.exportProperty(gmf.LayertreeController.prototype,"getLegendIconURL",gmf.LayertreeController.prototype.getLegendIconURL);
gmf.LayertreeController.prototype.getLegendsObject=function(a){var b=this,c={};if(void 0!==a.node.children)return null;var d=a.node,e=d.name;if(d.metadata.legendImage)return c[e]=d.metadata.legendImage,c;var f=a.layer;if("WMTS"===d.type)return goog.asserts.assertInstanceof(f,ol.layer.Tile),a=this.layerHelper_.getWMTSLegendURL(f),(c[e]=a)?c:null;e=d.layers;var g=this.gmfTreeManager_.getOgcServer(a),h=this.getScale_();e=g.type===ngeo.DataSource.OGCServerType.QGISSERVER?[e]:e.split(",");e.forEach(function(a){c[a]=
b.layerHelper_.getWMSLegendURL(g.url,a,h)});return c};goog.exportProperty(gmf.LayertreeController.prototype,"getLegendsObject",gmf.LayertreeController.prototype.getLegendsObject);gmf.LayertreeController.prototype.getNumberOfLegendsObject=function(a){return(a=this.getLegendsObject(a))?Object.keys(a).length:0};goog.exportProperty(gmf.LayertreeController.prototype,"getNumberOfLegendsObject",gmf.LayertreeController.prototype.getNumberOfLegendsObject);
gmf.LayertreeController.prototype.getScale_=function(){var a=this.map.getView(),b=a.getResolution();a=a.getProjection().getMetersPerUnit();return 25.4/.28*a*39.37*b};
gmf.LayertreeController.prototype.displayMetadata=function(a){var b=this,c=a.uid.toString(),d=a.node;a=d.metadata.metadataUrl;if(void 0!==a){c in this.promises_||(this.promises_[c]=this.$http_.get(a).then(function(a){return b.$sce_.trustAsHtml(a.data)}));var e=this.infoPopup_;this.promises_[c].then(function(a){e.setTitle(d.name);e.setContent(a);e.setOpen(!0)})}};goog.exportProperty(gmf.LayertreeController.prototype,"displayMetadata",gmf.LayertreeController.prototype.displayMetadata);
gmf.LayertreeController.prototype.afterReorder=function(){var a=this.gmfTreeManager_.rootCtrl.children,b=[];this.gmfTreeManager_.rootCtrl.node.children.forEach(function(c){a.some(function(a){a.node===c&&b.push(a)})},this);this.gmfTreeManager_.rootCtrl.children=b;this.layers.length=0;this.gmfTreeManager_.rootCtrl.children.forEach(function(a){this.layers.push(a.layer)},this);this.gmfPermalink_.refreshFirstLevelGroups()};goog.exportProperty(gmf.LayertreeController.prototype,"afterReorder",gmf.LayertreeController.prototype.afterReorder);
gmf.LayertreeController.prototype.removeNode=function(a){this.gmfTreeManager_.removeGroup(a)};goog.exportProperty(gmf.LayertreeController.prototype,"removeNode",gmf.LayertreeController.prototype.removeNode);gmf.LayertreeController.prototype.removeAllNodes=function(){this.gmfTreeManager_.removeAll()};goog.exportProperty(gmf.LayertreeController.prototype,"removeAllNodes",gmf.LayertreeController.prototype.removeAllNodes);gmf.LayertreeController.prototype.nodesCount=function(){return this.gmfTreeManager_.root.children.length};
goog.exportProperty(gmf.LayertreeController.prototype,"nodesCount",gmf.LayertreeController.prototype.nodesCount);gmf.LayertreeController.prototype.getResolutionStyle=function(a){var b=this.map.getView().getResolution(),c=gmf.Themes.getNodeMinResolution(a);if(void 0!==c&&b<c)return"out-of-resolution";a=gmf.Themes.getNodeMaxResolution(a);if(void 0!==a&&b>a)return"out-of-resolution"};goog.exportProperty(gmf.LayertreeController.prototype,"getResolutionStyle",gmf.LayertreeController.prototype.getResolutionStyle);
gmf.LayertreeController.prototype.zoomToResolution=function(a){var b=a.node;a=this.map.getView();var c=a.getResolution(),d=gmf.Themes.getNodeMinResolution(b);void 0!==d&&c<d?a.setResolution(a.constrainResolution(d,0,1)):(b=gmf.Themes.getNodeMaxResolution(b),void 0!==b&&c>b&&a.setResolution(a.constrainResolution(b,0,-1)))};goog.exportProperty(gmf.LayertreeController.prototype,"zoomToResolution",gmf.LayertreeController.prototype.zoomToResolution);gmf.LayertreeController.prototype.toggleNodeLegend=function(a){$(a).toggle({toggle:!0})};
goog.exportProperty(gmf.LayertreeController.prototype,"toggleNodeLegend",gmf.LayertreeController.prototype.toggleNodeLegend);gmf.LayertreeController.prototype.toggleFiltrableDataSource=function(a){this.gmfDataSourceBeingFiltered.dataSource=a};goog.exportProperty(gmf.LayertreeController.prototype,"toggleFiltrableDataSource",gmf.LayertreeController.prototype.toggleFiltrableDataSource);gmf.LayertreeController.prototype.isNodeLegendVisible=function(a){return $(a).is(":visible")};
goog.exportProperty(gmf.LayertreeController.prototype,"isNodeLegendVisible",gmf.LayertreeController.prototype.isNodeLegendVisible);gmf.LayertreeController.getSnappingConfig=function(a){a=a.node;return a.metadata&&void 0!==a.metadata.snappingConfig?a.metadata.snappingConfig:null};goog.exportProperty(gmf.LayertreeController,"getSnappingConfig",gmf.LayertreeController.getSnappingConfig);gmf.module.controller("GmfLayertreeController",gmf.LayertreeController);ol.interaction.Snap=function(a){ol.interaction.Pointer.call(this,{handleEvent:ol.interaction.Snap.handleEvent_,handleDownEvent:ol.functions.TRUE,handleUpEvent:ol.interaction.Snap.handleUpEvent_});a=a?a:{};this.source_=a.source?a.source:null;this.vertex_=void 0!==a.vertex?a.vertex:!0;this.edge_=void 0!==a.edge?a.edge:!0;this.features_=a.features?a.features:null;this.featuresListenerKeys_=[];this.featureChangeListenerKeys_={};this.indexedFeaturesExtents_={};this.pendingFeatures_={};this.pixelCoordinate_=
null;this.pixelTolerance_=void 0!==a.pixelTolerance?a.pixelTolerance:10;this.sortByDistance_=ol.interaction.Snap.sortByDistance.bind(this);this.rBush_=new ol.structs.RBush;this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_,
Circle:this.writeCircleGeometry_}};ol.inherits(ol.interaction.Snap,ol.interaction.Pointer);ol.interaction.Snap.prototype.addFeature=function(a,b){b=void 0!==b?b:!0;var c=ol.getUid(a),d=a.getGeometry();if(d){var e=this.SEGMENT_WRITERS_[d.getType()];e&&(this.indexedFeaturesExtents_[c]=d.getExtent(ol.extent.createEmpty()),e.call(this,a,d))}b&&(this.featureChangeListenerKeys_[c]=ol.events.listen(a,ol.events.EventType.CHANGE,this.handleFeatureChange_,this))};
ol.interaction.Snap.prototype.forEachFeatureAdd_=function(a){this.addFeature(a)};ol.interaction.Snap.prototype.forEachFeatureRemove_=function(a){this.removeFeature(a)};ol.interaction.Snap.prototype.getFeatures_=function(){var a;this.features_?a=this.features_:this.source_&&(a=this.source_.getFeatures());return a};ol.interaction.Snap.prototype.handleFeatureAdd_=function(a){if(a instanceof ol.source.Vector.Event)var b=a.feature;else a instanceof ol.Collection.Event&&(b=a.element);this.addFeature(b)};
ol.interaction.Snap.prototype.handleFeatureRemove_=function(a){if(a instanceof ol.source.Vector.Event)var b=a.feature;else a instanceof ol.Collection.Event&&(b=a.element);this.removeFeature(b)};ol.interaction.Snap.prototype.handleFeatureChange_=function(a){a=a.target;if(this.handlingDownUpSequence){var b=ol.getUid(a);b in this.pendingFeatures_||(this.pendingFeatures_[b]=a)}else this.updateFeature_(a)};
ol.interaction.Snap.prototype.removeFeature=function(a,b){b=void 0!==b?b:!0;var c=ol.getUid(a),d=this.indexedFeaturesExtents_[c];if(d){var e=this.rBush_,f=[];e.forEachInExtent(d,function(b){a===b.feature&&f.push(b)});for(d=f.length-1;0<=d;--d)e.remove(f[d])}b&&(ol.events.unlistenByKey(this.featureChangeListenerKeys_[c]),delete this.featureChangeListenerKeys_[c])};
ol.interaction.Snap.prototype.setMap=function(a){var b=this.getMap(),c=this.featuresListenerKeys_,d=this.getFeatures_();b&&(c.forEach(ol.events.unlistenByKey),c.length=0,d.forEach(this.forEachFeatureRemove_,this));ol.interaction.Pointer.prototype.setMap.call(this,a);a&&(this.features_?c.push(ol.events.listen(this.features_,ol.CollectionEventType.ADD,this.handleFeatureAdd_,this),ol.events.listen(this.features_,ol.CollectionEventType.REMOVE,this.handleFeatureRemove_,this)):this.source_&&c.push(ol.events.listen(this.source_,
ol.source.VectorEventType.ADDFEATURE,this.handleFeatureAdd_,this),ol.events.listen(this.source_,ol.source.VectorEventType.REMOVEFEATURE,this.handleFeatureRemove_,this)),d.forEach(this.forEachFeatureAdd_,this))};ol.interaction.Snap.prototype.shouldStopEvent=ol.functions.FALSE;
ol.interaction.Snap.prototype.snapTo=function(a,b,c){var d=c.getCoordinateFromPixel([a[0]-this.pixelTolerance_,a[1]+this.pixelTolerance_]),e=c.getCoordinateFromPixel([a[0]+this.pixelTolerance_,a[1]-this.pixelTolerance_]);d=ol.extent.boundingExtent([d,e]);var f=this.rBush_.getInExtent(d);this.vertex_&&!this.edge_&&(f=f.filter(function(a){return a.feature.getGeometry().getType()!==ol.geom.GeometryType.CIRCLE}));var g=!1;d=!1;var h=e=null;if(0<f.length){this.pixelCoordinate_=b;f.sort(this.sortByDistance_);
var k=f[0].segment;g=f[0].feature.getGeometry().getType()===ol.geom.GeometryType.CIRCLE;if(this.vertex_&&!this.edge_){if(b=c.getPixelFromCoordinate(k[0]),g=c.getPixelFromCoordinate(k[1]),b=ol.coordinate.squaredDistance(a,b),a=ol.coordinate.squaredDistance(a,g),g=Math.sqrt(Math.min(b,a)),g=g<=this.pixelTolerance_)d=!0,e=b>a?k[1]:k[0],h=c.getPixelFromCoordinate(e)}else this.edge_&&(e=g?ol.coordinate.closestOnCircle(b,f[0].feature.getGeometry()):ol.coordinate.closestOnSegment(b,k),h=c.getPixelFromCoordinate(e),
ol.coordinate.distance(a,h)<=this.pixelTolerance_&&(d=!0,this.vertex_&&!g&&(b=c.getPixelFromCoordinate(k[0]),g=c.getPixelFromCoordinate(k[1]),b=ol.coordinate.squaredDistance(h,b),a=ol.coordinate.squaredDistance(h,g),g=Math.sqrt(Math.min(b,a)),g=g<=this.pixelTolerance_)))&&(e=b>a?k[1]:k[0],h=c.getPixelFromCoordinate(e));d&&(h=[Math.round(h[0]),Math.round(h[1])])}return{snapped:d,vertex:e,vertexPixel:h}};
ol.interaction.Snap.prototype.updateFeature_=function(a){this.removeFeature(a,!1);this.addFeature(a,!1)};ol.interaction.Snap.prototype.writeCircleGeometry_=function(a,b){b=ol.geom.Polygon.fromCircle(b).getCoordinates()[0];var c;var d=0;for(c=b.length-1;d<c;++d){var e=b.slice(d,d+2);var f={feature:a,segment:e};this.rBush_.insert(ol.extent.boundingExtent(e),f)}};
ol.interaction.Snap.prototype.writeGeometryCollectionGeometry_=function(a,b){var c=b.getGeometriesArray();for(b=0;b<c.length;++b){var d=this.SEGMENT_WRITERS_[c[b].getType()];d&&d.call(this,a,c[b])}};ol.interaction.Snap.prototype.writeLineStringGeometry_=function(a,b){b=b.getCoordinates();var c;var d=0;for(c=b.length-1;d<c;++d){var e=b.slice(d,d+2);var f={feature:a,segment:e};this.rBush_.insert(ol.extent.boundingExtent(e),f)}};
ol.interaction.Snap.prototype.writeMultiLineStringGeometry_=function(a,b){b=b.getCoordinates();var c,d;var e=0;for(d=b.length;e<d;++e){var f=b[e];var g=0;for(c=f.length-1;g<c;++g){var h=f.slice(g,g+2);var k={feature:a,segment:h};this.rBush_.insert(ol.extent.boundingExtent(h),k)}}};ol.interaction.Snap.prototype.writeMultiPointGeometry_=function(a,b){var c=b.getCoordinates(),d;var e=0;for(d=c.length;e<d;++e){var f=c[e];f={feature:a,segment:[f,f]};this.rBush_.insert(b.getExtent(),f)}};
ol.interaction.Snap.prototype.writeMultiPolygonGeometry_=function(a,b){b=b.getCoordinates();var c,d,e;var f=0;for(e=b.length;f<e;++f){var g=b[f];var h=0;for(d=g.length;h<d;++h){var k=g[h];var l=0;for(c=k.length-1;l<c;++l){var m=k.slice(l,l+2);var n={feature:a,segment:m};this.rBush_.insert(ol.extent.boundingExtent(m),n)}}}};ol.interaction.Snap.prototype.writePointGeometry_=function(a,b){var c=b.getCoordinates();a={feature:a,segment:[c,c]};this.rBush_.insert(b.getExtent(),a)};
ol.interaction.Snap.prototype.writePolygonGeometry_=function(a,b){b=b.getCoordinates();var c,d;var e=0;for(d=b.length;e<d;++e){var f=b[e];var g=0;for(c=f.length-1;g<c;++g){var h=f.slice(g,g+2);var k={feature:a,segment:h};this.rBush_.insert(ol.extent.boundingExtent(h),k)}}};ol.interaction.Snap.handleEvent_=function(a){var b=this.snapTo(a.pixel,a.coordinate,a.map);b.snapped&&(a.coordinate=b.vertex.slice(0,2),a.pixel=b.vertexPixel);return ol.interaction.Pointer.handleEvent.call(this,a)};
ol.interaction.Snap.handleUpEvent_=function(a){a=ol.obj.getValues(this.pendingFeatures_);a.length&&(a.forEach(this.updateFeature_,this),this.pendingFeatures_={});return!1};ol.interaction.Snap.sortByDistance=function(a,b){return ol.coordinate.squaredDistanceToSegment(this.pixelCoordinate_,a.segment)-ol.coordinate.squaredDistanceToSegment(this.pixelCoordinate_,b.segment)};gmf.Snapping=function(a,b,c,d,e,f){this.http_=a;this.q_=b;this.rootScope_=c;this.timeout_=d;this.gmfThemes_=e;this.gmfTreeManager_=f;this.cache_={};this.listenerKeys_=[];this.ogcServers_=this.mapViewChangePromise_=this.map_=null};gmf.Snapping.$inject="$http $q $rootScope $timeout gmfThemes gmfTreeManager".split(" ");
gmf.Snapping.prototype.ensureSnapInteractionsOnTop=function(){var a=this.map_;goog.asserts.assert(a);var b;for(b in this.cache_){var c=this.cache_[+b];c.active&&(goog.asserts.assert(c.interaction),a.removeInteraction(c.interaction),a.addInteraction(c.interaction))}};goog.exportProperty(gmf.Snapping.prototype,"ensureSnapInteractionsOnTop",gmf.Snapping.prototype.ensureSnapInteractionsOnTop);
gmf.Snapping.prototype.setMap=function(a){var b=this,c=this.listenerKeys_;this.map_&&(this.treeCtrlsUnregister_(),this.unregisterAllTreeCtrl_(),c.forEach(ol.events.unlistenByKey),c.length=0);if(this.map_=a)this.treeCtrlsUnregister_=this.rootScope_.$watchCollection(function(){if(b.gmfTreeManager_.rootCtrl)return b.gmfTreeManager_.rootCtrl.children},function(a){b.timeout_(function(){a&&(b.unregisterAllTreeCtrl_(),b.gmfTreeManager_.rootCtrl.traverseDepthFirst(b.registerTreeCtrl_.bind(b)))},0)}),c.push(ol.events.listen(this.gmfThemes_,
gmf.ThemesEventType.CHANGE,this.handleThemesChange_,this)),c.push(ol.events.listen(a,"moveend",this.handleMapMoveEnd_,this))};goog.exportProperty(gmf.Snapping.prototype,"setMap",gmf.Snapping.prototype.setMap);gmf.Snapping.prototype.handleThemesChange_=function(){var a=this;this.ogcServers_=null;this.gmfThemes_.getOgcServersObject().then(function(b){a.ogcServers_=b})};
gmf.Snapping.prototype.registerTreeCtrl_=function(a){if(!a.node.children){var b=gmf.LayertreeController.getSnappingConfig(a);if(b){var c=this.getWFSConfig_(a);if(c){var d=ol.getUid(a),e=this.rootScope_.$watch(function(){return a.getState()},this.handleTreeCtrlStateChange_.bind(this,a));this.cache_[d]={active:!1,featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",features:new ol.Collection,geometryName:"geom",interaction:null,maxFeatures:50,requestDeferred:null,snappingConfig:b,
treeCtrl:a,wfsConfig:c,stateWatcherUnregister:e};this.handleTreeCtrlStateChange_(a,a.getState())}}}};gmf.Snapping.prototype.unregisterAllTreeCtrl_=function(){for(var a in this.cache_){var b=this.cache_[+a];b&&(b.stateWatcherUnregister(),this.deactivateItem_(b),delete this.cache_[+a])}};
gmf.Snapping.prototype.getWFSConfig_=function(a){if(null===this.ogcServers_)return null;var b=a.node;if(b.type!==gmf.Themes.NodeType.WMS)return null;for(var c=[],d=0,e=b.childLayers.length;d<e;d++)b.childLayers[d].queryable&&c.push(b.childLayers[d].name);if(!c.length)return null;a=a.parent.node.mixed?b.ogcServer:ngeo.LayertreeController.getFirstParentTree(a).node.ogcServer;if(!a)return null;a=this.ogcServers_[a];if(!a.wfsSupport)return null;a=a.urlWfs;goog.asserts.assert(a,"urlWfs should be defined.");
return{featureTypes:c.join(","),url:a}};gmf.Snapping.prototype.handleTreeCtrlStateChange_=function(a,b){a=ol.getUid(a);a=this.cache_[a];"on"===b?this.activateItem_(a):this.deactivateItem_(a)};gmf.Snapping.prototype.activateItem_=function(a){if(!a.active){var b=this.map_;goog.asserts.assert(b);var c=new ol.interaction.Snap({edge:a.snappingConfig.edge,features:a.features,pixelTolerance:a.snappingConfig.tolerance,vertex:a.snappingConfig.vertex});b.addInteraction(c);a.interaction=c;a.active=!0;this.loadItemFeatures_(a)}};
gmf.Snapping.prototype.deactivateItem_=function(a){if(a.active){var b=this.map_;goog.asserts.assert(b);b.removeInteraction(a.interaction);a.interaction=null;a.features.clear();a.requestDeferred&&(a.requestDeferred.resolve(),a.requestDeferred=null);a.active=!1}};gmf.Snapping.prototype.loadAllItems_=function(){this.mapViewChangePromise_=null;var a;for(a in this.cache_){var b=this.cache_[+a];b.active&&this.loadItemFeatures_(b)}};
gmf.Snapping.prototype.loadItemFeatures_=function(a){a.requestDeferred&&a.requestDeferred.resolve();var b=this.map_;goog.asserts.assert(b);var c=b.getView();b=b.getSize();goog.asserts.assert(b);b=c.calculateExtent(b);c=c.getProjection().getCode();var d=a.wfsConfig.featureTypes.split(",");b={srsName:c,featureNS:a.featureNS,featurePrefix:a.featurePrefix,featureTypes:d,outputFormat:"GML3",bbox:b,geometryName:a.geometryName,maxFeatures:a.maxFeatures};d=new ol.format.WFS;c=new XMLSerializer;b=d.writeGetFeature(b);
c=c.serializeToString(b);b=a.wfsConfig.url;a.requestDeferred=this.q_.defer();this.http_.post(b,c,{timeout:a.requestDeferred.promise}).then(function(b){a.requestDeferred=null;a.features.clear();(b=(new ol.format.WFS).readFeatures(b.data))&&a.features.extend(b)})};gmf.Snapping.prototype.handleMapMoveEnd_=function(){this.mapViewChangePromise_&&this.timeout_.cancel(this.mapViewChangePromise_);this.mapViewChangePromise_=this.timeout_(this.loadAllItems_.bind(this),400)};
gmf.module.service("gmfSnapping",gmf.Snapping);ngeo.SyncDataSourcesMap=function(a){this.ngeoDataSources_=a;this.map_=null;this.listenerKeys_=[];ol.events.listen(this.ngeoDataSources_,ol.CollectionEventType.ADD,this.handleDataSourcesAdd_,this)};ngeo.SyncDataSourcesMap.prototype.bindMap_=function(a){a=a.getView();this.listenerKeys_.push(ol.events.listen(a,ol.Object.getChangeEventType(ol.ViewProperty.RESOLUTION),this.handleViewResolutionChange_,this));a=a.getResolution();goog.asserts.assertNumber(a);this.syncDataSourcesToResolution_(a)};
ngeo.SyncDataSourcesMap.prototype.unbindMap_=function(a){ol.Observable.unByKey(this.listenerKeys_);this.listenerKeys_=[]};ngeo.SyncDataSourcesMap.prototype.handleViewResolutionChange_=function(a){a=a.target;goog.asserts.assertInstanceof(a,ol.View);a=a.getResolution();goog.asserts.assertNumber(a);this.syncDataSourcesToResolution_(a)};ngeo.SyncDataSourcesMap.prototype.syncDataSourcesToResolution_=function(a){var b=this;this.ngeoDataSources_.forEach(function(c){b.syncDataSourceToResolution_(c,a)})};
ngeo.SyncDataSourcesMap.prototype.syncDataSourceToResolution_=function(a,b){if(a.supportsDynamicInRange){var c=a.maxResolution,d=a.minResolution;a.inRange=(null===d||void 0===d||b>=d)&&(null===c||void 0===c||b<=c)}};ngeo.SyncDataSourcesMap.prototype.handleDataSourcesAdd_=function(a){a=goog.asserts.assertInstanceof(a.element,ngeo.DataSource);if(this.map_){var b=this.map_.getView().getResolution();goog.asserts.assertNumber(b);this.syncDataSourceToResolution_(a,b)}};
$jscomp.global.Object.defineProperties(ngeo.SyncDataSourcesMap.prototype,{map:{configurable:!0,enumerable:!0,set:function(a){this.map_&&this.unbindMap_(this.map_);(this.map_=a)&&this.bindMap_(a)}}});ngeo.SyncDataSourcesMap.$inject=["ngeoDataSources"];ngeo.module.service("ngeoSyncDataSourcesMap",ngeo.SyncDataSourcesMap);ngeo.mapDirective=function(a,b){return{restrict:"A",link:function(c,d,e){var f=c.$eval(e.ngeoMap);goog.asserts.assertInstanceof(f,ol.Map);f.setTarget(d[0]);b.map=f;if(c.$eval(e.ngeoMapManageResize)){var g=c.$eval(e.ngeoMapResizeTransition);ol.events.listen(a,"resize",function(){if(g){var b=Date.now(),c=!0,d=function(){f.updateSize();f.renderSync();c&&a.requestAnimationFrame(d);Date.now()-b>g&&(c=!1)};d()}else f.updateSize()})}}}};ngeo.mapDirective.$inject=["$window","ngeoSyncDataSourcesMap"];
ngeo.module.directive("ngeoMap",ngeo.mapDirective);gmf.mapDirective=function(){return{scope:{map:"<gmfMapMap",manageResize:"<gmfMapManageResize",resizeTransition:"<gmfMapResizeTransition"},controller:"GmfMapController as ctrl",bindToController:!0,templateUrl:gmf.baseTemplateUrl+"/map.html"}};gmf.module.directive("gmfMap",gmf.mapDirective);gmf.MapController=function(a,b,c){this.ngeoFeatureOverlayMgr_=a;this.gmfPermalink_=b;this.gmfSnapping_=c};gmf.MapController.$inject=["ngeoFeatureOverlayMgr","gmfPermalink","gmfSnapping"];
gmf.module.controller("GmfMapController",gmf.MapController);gmf.MapController.prototype.$onInit=function(){this.ngeoFeatureOverlayMgr_.init(this.map);this.gmfPermalink_.setMap(this.map);this.gmfSnapping_.setMap(this.map)};ngeo.module.value("ngeoColorpickerTemplateUrl",function(a,b){a=b.ngeoColorpickerTemplateurl;return void 0!==a?a:ngeo.baseTemplateUrl+"/colorpicker.html"});ngeo.colorpickerDirective=function(a){return{restrict:"A",scope:{colors:"<?ngeoColorpicker",color:"=?ngeoColorpickerColor"},controller:"NgeoColorpickerController as ctrl",bindToController:!0,templateUrl:a}};ngeo.colorpickerDirective.$inject=["ngeoColorpickerTemplateUrl"];ngeo.module.directive("ngeoColorpicker",ngeo.colorpickerDirective);
var defaultColors=["#F4EB37 #CDDC39 #62AF44 #009D57 #0BA9CC #4186F0 #3F5BA9 #7C3592 #A61B4A #DB4436 #F8971B #F4B400 #795046".split(" "),"#F9F7A6 #E6EEA3 #B7DBAB #7CCFA9 #93D7E8 #9FC3FF #A7B5D7 #C6A4CF #D698AD #EE9C96 #FAD199 #FFDD5E #B29189".split(" "),["#ffffff","#CCCCCC","#777","#000000"]];ngeo.ColorpickerController=function(a,b,c){this.colors=this.colors||defaultColors};ngeo.ColorpickerController.$inject=["$scope","$element","$attrs"];
ngeo.ColorpickerController.prototype.setColor=function(a){this.color=a};goog.exportProperty(ngeo.ColorpickerController.prototype,"setColor",ngeo.ColorpickerController.prototype.setColor);ngeo.module.controller("NgeoColorpickerController",ngeo.ColorpickerController);gmf.FulltextSearchService=function(a,b){this.$http_=b;this.url_=a.get("fulltextsearchUrl");a=this.url_.split("?");this.baseUrl_=a[0];this.defaultParams_=ngeo.utils.decodeQueryString(2==a.length?"?"+a[1]:"")};goog.exportSymbol("gmf.FulltextSearchService",gmf.FulltextSearchService);gmf.FulltextSearchService.$inject=["$injector","$http"];
gmf.FulltextSearchService.prototype.search=function(a,b){var c=this;b=Object.assign({},this.defaultParams_,b);b.query=a;var d=this.baseUrl_+"?"+ngeo.utils.encodeQueryString(b);return new Promise(function(a,b){c.$http_.get(d).then(function(b){return a(b.data)}).catch(b)})};gmf.module.service("gmfFulltextSearchService",gmf.FulltextSearchService);ngeo.search={};
ngeo.search.searchDirective=function(){return{restrict:"A",link:function(a,b,c){var d=a.$eval(c.ngeoSearch),e=a.$eval(c.ngeoSearchDatasets).slice();e.unshift(d);b.typeahead.apply(b,[].concat($jscomp.arrayFromIterable(e)));c=a.$eval(c.ngeoSearchListeners);var f=ngeo.search.searchDirective.adaptListeners_(c);b.on("typeahead:open",function(){a.$apply(function(){f.open()})});b.on("typeahead:close",function(){a.$apply(function(){f.close()})});b.on("typeahead:cursorchange",function(b,c,d){a.$apply(function(){f.cursorchange(b,c,
d)})});b.on("typeahead:select",function(b,c,d){a.$apply(function(){f.select(b,c,d)})});b.on("typeahead:autocomplete",function(b,c,d){a.$apply(function(){f.autocomplete(b,c,d)})});b.on("typeahead:asyncreceive",function(c,d,e){a.$apply(function(){var a=b.data("tt-typeahead").menu._allDatasetsEmpty();f.datasetsempty(c,e,a)})})}}};
ngeo.search.searchDirective.adaptListeners_=function(a){return void 0===a?{open:ol.nullFunction,close:ol.nullFunction,cursorchange:ol.nullFunction,datasetsempty:ol.nullFunction,select:ol.nullFunction,autocomplete:ol.nullFunction}:{open:void 0!==a.open?a.open:ol.nullFunction,close:void 0!==a.close?a.close:ol.nullFunction,cursorchange:void 0!==a.cursorchange?a.cursorchange:ol.nullFunction,datasetsempty:void 0!==a.datasetsempty?a.datasetsempty:ol.nullFunction,select:void 0!==a.select?a.select:ol.nullFunction,
autocomplete:void 0!==a.autocomplete?a.autocomplete:ol.nullFunction}};ngeo.search.searchDirective.module=angular.module("ngeoSearchDirective",[]);ngeo.search.searchDirective.module.directive("ngeoSearch",ngeo.search.searchDirective);ngeo.search.createGeoJSONBloodhound=function(a,b,c,d,e,f){var g=new ol.format.GeoJSON;a={remote:{url:a,prepare:function(a,b){b.url=b.url.replace("%QUERY",a);return b},transform:function(a){void 0!==b&&(a={type:"FeatureCollection",features:a.features.filter(b)});return g.readFeatures(a,{featureProjection:c,dataProjection:d})}},datumTokenizer:ol.nullFunction,queryTokenizer:Bloodhound.tokenizers.whitespace};e=ol.obj.assign({},e||{});f=ol.obj.assign({},f||{});e.remote&&(ol.obj.assign(f,e.remote),delete e.remote);
ol.obj.assign(a,e);ol.obj.assign(a.remote,f);return new Bloodhound(a)};ngeo.search.createGeoJSONBloodhound.module=angular.module("ngeoSearchCreategeojsonbloodhound",[]);ngeo.search.createGeoJSONBloodhound.module.value("ngeoSearchCreateGeoJSONBloodhound",ngeo.search.createGeoJSONBloodhound);ngeo.proj={};"function"!==typeof ol.proj.proj4.get()&&"function"===typeof proj4&&ol.proj.setProj4(proj4);if("function"==typeof ol.proj.proj4.get()){var epsg21781def="+proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +k_0=1 +x_0=600000 +y_0=200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs",epsg21781extent=[42E4,3E4,9E5,35E4];ol.proj.proj4.get().defs("EPSG:21781",epsg21781def);ol.proj.get("EPSG:21781").setExtent(epsg21781extent)}ngeo.proj.EPSG21781="EPSG:21781";ngeo.search.createLocationSearchBloodhound=function(a){var b=a||{},c=ol.proj.get("EPSG:21781"),d=b.targetProjection;a={remote:{url:"https://api3.geo.admin.ch/rest/services/api/SearchServer?type=locations&searchText=%QUERY",prepare:function(a,c){c.url=c.url.replace("%QUERY",a);void 0!==b.limit&&(c.url+="&limit="+b.limit);void 0!==b.origins&&(c.url+="&origins="+b.origins);return void 0!==b.prepare?b.prepare(a,c):c},transform:function(a){return a.results.map(function(a){a=a.attrs;var b=new ol.geom.Point([a.y,
a.x]);var e=/BOX\((.*?) (.*?),(.*?) (.*?)\)/g.exec(a.geom_st_box2d);e=null!==e?[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])]:null;void 0!==d&&(b.transform(c,d),null!==e&&(e=ol.proj.transformExtent(e,c,d)));a.geometry=b;a.bbox=e;b=a.label;a.label_no_html=b.replace(/<\/?[ib]>/g,"");e=/<b>(.*?)<\/b>/g.exec(b);b=null!==e?e[1]:b;a.label_simple=b;b=new ol.Feature(a);b.setId(a.featureId);return b})}},datumTokenizer:ol.nullFunction,queryTokenizer:Bloodhound.tokenizers.whitespace};
var e=ol.obj.assign({},b.options||{}),f=ol.obj.assign({},b.remoteOptions||{});e.remote&&(ol.obj.assign(f,e.remote),delete e.remote);ol.obj.assign(a,e);ol.obj.assign(a.remote,f);return new Bloodhound(a)};ngeo.search.createLocationSearchBloodhound.module=angular.module("ngeoCreateLocationSearchBloodhound",[]);ngeo.search.createLocationSearchBloodhound.module.value("ngeoCreateLocationSearchBloodhound",ngeo.search.createLocationSearchBloodhound);ngeo.search.searchModule={};ngeo.search.searchModule.module=angular.module("ngeoSearchModule",[ngeo.search.searchDirective.module.name,ngeo.search.createGeoJSONBloodhound.module.name,ngeo.search.createLocationSearchBloodhound.module.name]);gmf.module.requires.push(ngeo.search.searchModule.module.name);gmf.module.value("gmfSearchTemplateUrl",function(a,b){a=b.gmfSearchTemplateurl;return void 0!==a?a:gmf.baseTemplateUrl+"/search.html"});
gmf.searchDirective=function(a){return{restrict:"E",bindToController:{inputValue:"=?gmfSearchInputValue",placeholder:"@?gmfSearchPlaceholder"},scope:{getMapFn:"&gmfSearchMap",getDatasourcesFn:"&gmfSearchDatasources",typeaheadOptions:"<?gmfSearchOptions",featuresStyles:"<?gmfSearchStyles",clearbutton:"=gmfSearchClearbutton",colorchooser:"=gmfSearchColorchooser",coordinatesProjections:"=?gmfSearchCoordinatesprojections",additionalListeners:"=gmfSearchListeners",maxZoom:"<gmfSearchMaxzoom",delay:"<gmfSearchDelay",
onInitCallback:"&?gmfSearchOnInit"},controller:"GmfSearchController as ctrl",templateUrl:a,link:function(a,c,d){if(!a.clearbutton){var b=a.ctrl;c.find("input").on("focus blur",function(){b.clear()})}(a=a.onInitCallback)&&a()}}};gmf.searchDirective.$inject=["gmfSearchTemplateUrl"];gmf.module.directive("gmfSearch",gmf.searchDirective);
gmf.SearchController=function(a,b,c,d,e,f,g,h,k,l,m){var n=this;this.scope_=a;this.compile_=b;this.timeout_=c;this.gettextCatalog_=e;this.gmfThemes_=k;this.gmfTreeManager_=l;this.fullTextSearch_=m;this.ngeoSearchCreateGeoJSONBloodhound_=g;this.ngeoFeatureOverlayMgr=h;d.has("ngeoLocation")&&(this.ngeoLocation_=d.get("ngeoLocation"));this.ngeoAutoProjection_=f;b=this.scope_.getMapFn();goog.asserts.assertInstanceof(b,ol.Map);this.map_=b;this.styles_={};this.clearButton=this.scope_.clearbutton||!1;this.colorchooser=
this.scope_.colorchooser||!1;this.delay=parseInt(this.scope_.delay,10)||50;this.maxZoom=parseInt(this.scope_.maxZoom,10)||16;b=this.scope_.coordinatesProjections;this.coordinatesProjections_=b=void 0===b?[this.map_.getView().getProjection()]:this.ngeoAutoProjection_.getProjectionList(b);this.initStyles_();this.featureOverlay_=h.getFeatureOverlay();this.featureOverlay_.setStyle(this.getSearchStyle_.bind(this));h=this.scope_.getDatasourcesFn();goog.asserts.assertArray(h);this.datasources_=h;this.options=
{highlight:!0};ol.obj.assign(this.options,this.scope_.typeaheadOptions||{});this.datasets=[];h={};for(b=0;b<this.datasources_.length;h={filters:h.filters,datasource:h.datasource},b++)h.datasource=this.datasources_[b],c=void 0!==h.datasource.groupValues?h.datasource.groupValues:[],d=h.datasource.groupActions?h.datasource.groupActions:[],h.filters=[],0===c.length?h.filters.push({title:"",filter:this.filterLayername_()}):c.forEach(function(a){return function(b){a.filters.push({title:b,filter:this.filterLayername_(b)})}}(h),
this),d.forEach(function(a){return function(b){a.filters.push({title:e.getString(b.title),filter:this.filterAction_(b.action)})}}(h),this),h.filters.forEach(function(a){return function(b){this.datasets.push(this.createDataset_({bloodhoundOptions:a.datasource.bloodhoundOptions,datasetTitle:b.title,groupsKey:"layer_name",labelKey:a.datasource.labelKey,projection:a.datasource.projection,typeaheadDatasetOptions:a.datasource.typeaheadDatasetOptions,url:a.datasource.url},b.filter))}}(h),this);this.datasets.push({source:this.createSearchCoordinates_(this.map_.getView()),
name:"coordinates",display:"label",templates:{header:function(){return'<div class="gmf-search-header" translate>'+e.getString("Recenter to")+"</div>"},suggestion:function(a){return'<div class="gmf-search-datum">'+('<p class="gmf-search-label">'+a.label+"</p>")+"</div>"}}});this.displayColorPicker=!1;a.$watch(function(){return n.color},this.setStyleColor.bind(this));this.listeners=this.mergeListeners_(this.scope_.additionalListeners,{select:gmf.SearchController.select_.bind(this),close:gmf.SearchController.close_.bind(this),
datasetsempty:gmf.SearchController.datasetsempty_.bind(this)})};gmf.SearchController.$inject="$scope $compile $timeout $injector gettextCatalog ngeoAutoProjection ngeoSearchCreateGeoJSONBloodhound ngeoFeatureOverlayMgr gmfThemes gmfTreeManager gmfFulltextSearchService".split(" ");
gmf.SearchController.prototype.$onInit=function(){this.inputValue=this.inputValue||"";this.placeholder=this.placeholder||"";if(this.ngeoLocation_){var a=this.ngeoLocation_.getParam("search");if(a){var b=1;this.ngeoLocation_.getParam("search-select-index")&&(b=parseInt(this.ngeoLocation_.getParam("search-select-index"),10));this.ngeoLocation_.getParam("search-maxzoom")&&(this.maxZoom=parseInt(this.ngeoLocation_.getParam("search-maxzoom"),10)||16);this.fulltextsearch_(a,b)}}};
gmf.SearchController.prototype.mergeListeners_=function(a,b){return void 0===a?b:{open:a.open,close:void 0===a.close?b.close:function(){b.close();a.close()},cursorchange:a.cursorchange,datasetsempty:a.datasetsempty,select:void 0===a.select?b.select:function(c,d,e){b.select(c,d,e);a.select(c,d,e)},autocomplete:a.autocomplete}};
gmf.SearchController.prototype.createDataset_=function(a,b){var c=this.gettextCatalog_,d=this.scope_,e=this.compile_;b=this.createAndInitBloodhound_(a,b);b={limit:Infinity,source:b.ttAdapter(),display:function(b){return b.get(a.labelKey)},templates:{header:function(){return void 0===a.datasetTitle?"":'<div class="gmf-search-header">'+c.getString(a.datasetTitle)+"</div>"},suggestion:function(b){var c=d.$new(!0);c.feature=b;var f='<p class="gmf-search-label" translate>'+b.get(a.labelKey)+"</p>";f+=
'<p class="gmf-search-group" translate>'+(b.get("layer_name")||a.datasetTitle)+"</p>";return e('<div class="gmf-search-datum">'+f+"</div>")(c)}}};a.typeaheadDatasetOptions&&ol.obj.assign(b,a.typeaheadDatasetOptions);return b};gmf.SearchController.prototype.filterAction_=function(a){return function(b){b=b.properties;return b.actions?!b.layer_name&&b.actions.some(function(b){return b.action===a}):!1}};
gmf.SearchController.prototype.filterLayername_=function(a){return function(b){b=b.properties.layer_name;return void 0===b?!1:void 0===a?!0:b===a}};gmf.SearchController.prototype.createAndInitBloodhound_=function(a,b){var c=this.map_.getView().getProjection().getCode(),d=this.getBloodhoudRemoteOptions_();a=this.ngeoSearchCreateGeoJSONBloodhound_(a.url,b,ol.proj.get(c),ol.proj.get(a.projection),a.bloodhoundOptions,d);a.initialize();return a};
gmf.SearchController.prototype.getBloodhoudRemoteOptions_=function(){var a=this.gettextCatalog_;return{rateLimitWait:this.delay,prepare:function(b,c){var d=c.url,e=a.currentLanguage;c.xhrFields={withCredentials:!0};c.url=ol.uri.appendParams(d,{query:b,lang:e,"interface":"mobile"});return c}}};
gmf.SearchController.prototype.createSearchCoordinates_=function(a){var b=a.getProjection(),c=b.getExtent();return function(a,e){var d=[];a=this.ngeoAutoProjection_.stringToCoordinates(a);if(null!==a){var g=this.ngeoAutoProjection_.tryProjectionsWithInversion(a,c,b,this.coordinatesProjections_);null!==g&&(d.push({label:a.join(" "),position:g,tt_source:"coordinates"}),e(d))}}.bind(this)};
gmf.SearchController.prototype.initStyles_=function(){this.styles_[gmf.COORDINATES_LAYER_NAME]=new ol.style.Style({image:new ol.style.RegularShape({stroke:new ol.style.Stroke({color:[0,0,0,.7],width:2}),points:4,radius:8,radius2:0,angle:0})});var a=new ol.style.Fill({color:[65,134,240,.5]}),b=new ol.style.Stroke({color:[65,134,240,1],width:2});this.styles_["default"]=new ol.style.Style({fill:a,stroke:b,image:new ol.style.Circle({radius:5,fill:a,stroke:b})});ol.obj.assign(this.styles_,this.scope_.featuresStyles||
{})};gmf.SearchController.prototype.getSearchStyle_=function(a,b){goog.asserts.assert(a);a=this.styles_[a.get("layer_name")]||this.styles_["default"];if(this.color){var c=ol.color.asArray(this.color);b=c.slice();b[3]=1;c=c.slice();c[3]=.5;var d=a.getStroke();d&&d.setColor(b);(d=a.getFill())&&d.setColor(c);if(d=a.getImage()){d=d.clone();var e=d.getStroke();e&&e.setColor(b);(b=d.getFill())&&b.setColor(c);a.setImage(d)}}return a};
gmf.SearchController.prototype.setStyleColor=function(a){a&&(this.color=a,this.ngeoFeatureOverlayMgr.getLayer().changed())};goog.exportProperty(gmf.SearchController.prototype,"setStyleColor",gmf.SearchController.prototype.setStyleColor);gmf.SearchController.prototype.setTTDropdownVisibility_=function(){if(this.clearButton){var a=$(".twitter-typeahead .tt-menu");this.inputValue?a.show():a.hide()}};gmf.SearchController.prototype.onClearButton=function(){this.featureOverlay_.clear();this.clear()};
goog.exportProperty(gmf.SearchController.prototype,"onClearButton",gmf.SearchController.prototype.onClearButton);gmf.SearchController.prototype.clear=function(){var a=$(".twitter-typeahead"),b=a.children(".tt-menu");a=a.children("input");this.inputValue="";$(a[1]).typeahead("val","");b.children(".tt-dataset").empty();this.setTTDropdownVisibility_();this.displayColorPicker=!1};goog.exportProperty(gmf.SearchController.prototype,"clear",gmf.SearchController.prototype.clear);
gmf.SearchController.prototype.blur=function(){var a=$(".twitter-typeahead").children("input");this.timeout_(function(){$(a[1]).blur()})};goog.exportProperty(gmf.SearchController.prototype,"blur",gmf.SearchController.prototype.blur);
gmf.SearchController.select_=function(a,b,c){"coordinates"===b.tt_source?(a=new ol.geom.Point(b.position),this.featureOverlay_.clear(),this.featureOverlay_.addFeature(new ol.Feature({geometry:a,layer_name:gmf.COORDINATES_LAYER_NAME})),this.map_.getView().setCenter(b.position),this.leaveSearch_()):(goog.asserts.assertInstanceof(b,ol.Feature),this.selectFromGMF_(a,b,c))};
gmf.SearchController.prototype.selectFromGMF_=function(a,b,c){var d=this;c=b.get("actions");a=b.getGeometry();if(c)for(var e={},f=0,g=c.length;f<g;e={actionData:e.actionData,datasourcesActionsHaveAddLayer:e.datasourcesActionsHaveAddLayer},f++){var h=c[f],k=h.action;e.actionData=h.data;"add_theme"==k?this.gmfThemes_.getThemesObject().then(function(a){return function(b){(b=gmf.Themes.findThemeByName(b,a.actionData))&&d.gmfTreeManager_.addFirstLevelGroups(b.children)}}(e)):"add_group"==k?this.gmfTreeManager_.addGroupByName(e.actionData,
!0):"add_layer"==k&&(h=this.datasources_[0].groupActions,e.datasourcesActionsHaveAddLayer=void 0,h.forEach(function(a){return function(b){if("add_layer"===b.action)return a.datasourcesActionsHaveAddLayer=!0}}(e)),e.datasourcesActionsHaveAddLayer&&this.gmfTreeManager_.addGroupByLayerName(e.actionData,!0,!!a))}a&&this.map_.getSize()&&(c=this.map_.getView(),this.featureOverlay_.clear(),this.featureOverlay_.addFeature(b),this.displayColorPicker=!0,b="GeometryCollection"===a.getType()?a.getExtent():a,
c.fit(b,{size:this.map_.getSize(),maxZoom:this.maxZoom}));this.leaveSearch_()};gmf.SearchController.prototype.leaveSearch_=function(){this.clearButton||this.clear();this.blur()};gmf.SearchController.close_=function(a){this.clearButton||this.setTTDropdownVisibility_()};
gmf.SearchController.datasetsempty_=function(a,b,c){a=$(".twitter-typeahead .tt-menu");b=a.children(".gmf-search-no-results");if(0==b.length){var d=$('<div class="gmf-search-no-results" translate>No result found</div>');a.append(d)}c?(b.show(),a.addClass("gmf-search-no-results")):(a.removeClass("gmf-search-no-results"),b.hide())};
gmf.SearchController.prototype.fulltextsearch_=function(a,b){var c=this;1>b&&(b=1);this.fullTextSearch_.search(a,{limit:b}).then(function(a){a&&a.features[b-1]&&(a=(new ol.format.GeoJSON).readFeature(a.features[b-1]),c.featureOverlay_.addFeature(a),c.map_.getView().fit(a.getGeometry().getExtent(),{size:c.map_.getSize(),maxZoom:c.maxZoom}),c.inputValue=a.get("label"))})};gmf.module.controller("GmfSearchController",gmf.SearchController);gmf.themeselectorDirective=function(){return{restrict:"E",controller:"gmfThemeselectorController as tsCtrl",scope:{filter:"=gmfThemeselectorFilter"},bindToController:!0,templateUrl:gmf.baseTemplateUrl+"/themeselector.html"}};gmf.module.directive("gmfThemeselector",gmf.themeselectorDirective);
gmf.ThemeselectorController=function(a,b,c){this.gmfThemeManager=b;this.gmfThemes_=c;this.listenerKeys_=[];this.listenerKeys_.push(ol.events.listen(this.gmfThemes_,gmf.ThemesEventType.CHANGE,this.setThemes_,this));a.$on("$destroy",this.handleDestroy_.bind(this))};gmf.ThemeselectorController.$inject=["$scope","gmfThemeManager","gmfThemes"];gmf.ThemeselectorController.prototype.setThemes_=function(){var a=this;this.gmfThemes_.getThemesObject().then(function(b){a.themes=a.filter?b.filter(a.filter):b})};
gmf.ThemeselectorController.prototype.setTheme=function(a,b){a&&this.gmfThemeManager.addTheme(a,b)};goog.exportProperty(gmf.ThemeselectorController.prototype,"setTheme",gmf.ThemeselectorController.prototype.setTheme);gmf.ThemeselectorController.prototype.handleDestroy_=function(){this.listenerKeys_.forEach(ol.events.unlistenByKey);this.listenerKeys_.length=0};gmf.module.controller("gmfThemeselectorController",gmf.ThemeselectorController);ngeo.mapQueryDirective=function(a,b){return{restrict:"A",scope:!1,link:function(c,d,e){var f=c.$eval(e.ngeoMapQueryMap),g=null,h=null,k=function(b){a.issue({coordinate:b.coordinate,map:f})},l=function(a){a.dragging||(a=f.getEventPixel(a.originalEvent),a=f.forEachLayerAtPixel(a,function(){return!0},void 0,function(a){var b=a.get("visible");a=a.get("querySourceIds");return b&&!!a}),f.getTargetElement().style.cursor=a?"pointer":"")};c.$watch(e.ngeoMapQueryActive,function(d,n){d?(g=ol.events.listen(f,
"singleclick",k),(b.has("ngeoQueryOptions")?b.get("ngeoQueryOptions"):{}).cursorHover&&(h=ol.events.listen(f,"pointermove",l))):(null!==g&&(ol.events.unlistenByKey(g),g=null),null!==h&&(ol.events.unlistenByKey(h),h=null),!1!==c.$eval(e.ngeoMapQueryAutoclear)&&a.clear())})}}};ngeo.mapQueryDirective.$inject=["ngeoMapQuerent","$injector"];ngeo.module.directive("ngeoMapQuery",ngeo.mapQueryDirective);ngeo.getBrowserLanguageFactory=function(a){return function(b){var c=a.navigator;c=c.languages||c.language||c.browserLanguage||c.systemLanguage||c.userLanguage;Array.isArray(c)||(c=[c]);c=c.map(function(a){return a.substring(0,2)});c=c.filter(function(a,b,c){return c.indexOf(a)==b});return c.filter(function(a){return-1!=b.indexOf(a)})[0]}};ngeo.getBrowserLanguageFactory.$inject=["$window"];ngeo.module.factory("ngeoGetBrowserLanguage",ngeo.getBrowserLanguageFactory);ngeo.ToolActivate=function(a,b){this.getActive=function(){return a[b]};this.setActive=function(c){a[b]=c}};goog.exportSymbol("ngeo.ToolActivate",ngeo.ToolActivate);ngeo.module.value("ngeoToolActivate",ngeo.ToolActivate);ngeo.ToolActivateMgr=function(a){this.groups_={};this.scope_=a};ngeo.ToolActivateMgr.$inject=["$rootScope"];
ngeo.ToolActivateMgr.prototype.registerTool=function(a,b,c){var d=this,e=this.groups_[a];e||(e=this.groups_[a]=[]);var f=this.scope_.$watch(b.getActive,function(c,e){c!==e&&(c?d.deactivateTools_(a,b):d.activateDefault_(a))});e.push({tool:b,defaultTool:c||!1,unlisten:f});if(goog.asserts.ENABLE_ASSERTS){var g=0;e.forEach(function(a){a.defaultTool&&g++});goog.asserts.assert(1>=g,"more than one default tool in group "+a)}};goog.exportProperty(ngeo.ToolActivateMgr.prototype,"registerTool",ngeo.ToolActivateMgr.prototype.registerTool);
ngeo.ToolActivateMgr.prototype.unregisterTool=function(a,b){if(a=this.groups_[a])for(var c=0;c<a.length;c++)if(a[c].tool==b){a[c].unlisten();a.splice(c,1);break}};goog.exportProperty(ngeo.ToolActivateMgr.prototype,"unregisterTool",ngeo.ToolActivateMgr.prototype.unregisterTool);ngeo.ToolActivateMgr.prototype.unregisterGroup=function(a){var b=this.groups_[a];if(b){for(var c=0;c<b.length;c++)b[c].unlisten();delete this.groups_[a]}};
goog.exportProperty(ngeo.ToolActivateMgr.prototype,"unregisterGroup",ngeo.ToolActivateMgr.prototype.unregisterGroup);ngeo.ToolActivateMgr.prototype.activateTool=function(a){a.setActive(!0)};goog.exportProperty(ngeo.ToolActivateMgr.prototype,"activateTool",ngeo.ToolActivateMgr.prototype.activateTool);ngeo.ToolActivateMgr.prototype.deactivateTool=function(a){a.setActive(!1)};goog.exportProperty(ngeo.ToolActivateMgr.prototype,"deactivateTool",ngeo.ToolActivateMgr.prototype.deactivateTool);
ngeo.ToolActivateMgr.prototype.deactivateTools_=function(a,b){a=this.groups_[a];for(var c=0;c<a.length;c++)b!=a[c].tool&&a[c].tool.setActive(!1)};ngeo.ToolActivateMgr.prototype.activateDefault_=function(a){a=this.groups_[a];for(var b=null,c=!1,d=0;d<a.length;d++)c=c||a[d].tool.getActive(),a[d].defaultTool&&(b=a[d].tool);c||null===b||b.setActive(!0)};ngeo.module.service("ngeoToolActivateMgr",ngeo.ToolActivateMgr);gmf.module.value("ngeoExportFeatureFormats",[ngeo.FeatureHelper.FormatType.KML,ngeo.FeatureHelper.FormatType.GPX]);
gmf.AbstractController=function(a,b,c){var d=this;this.ngeoLocation=c.get("ngeoLocation");this.ngeoLocation.hasParam("debug")&&(window.injector=c);goog.asserts.assertInstanceof(this.map,ol.Map);c.get("ngeoFeatureHelper").setProjection(goog.asserts.assert(this.map.getView().getProjection()));this.gmfThemeManager=c.get("gmfThemeManager");this.gmfTreeManager_=c.get("gmfTreeManager");this.gmfThemes_=c.get("gmfThemes");this.permalink_=c.get("gmfPermalink");var e=c.get("gmfAuthentication");this.hasEditableLayers=
!1;this.updateHasEditableLayers_=function(){var a=this;this.gmfThemes_.hasEditableLayers().then(function(b){a.hasEditableLayers=b})};var f=function(a){var b=null!==a.user.username?a.user.role_id:void 0;d.gmfThemes_.getThemesObject().then(function(a){(a=d.gmfUser.functionalities)&&a.open_panel&&"layer_filter"===a.open_panel[0]&&(d.filterSelectorActive=!0)});var c=d.gmfThemeManager.getThemeName();d.gmfThemeManager.setThemeName("",!0);a.type!==gmf.AuthenticationEventType.READY&&d.updateCurrentTheme_(c);
d.gmfThemes_.loadThemes(b);d.updateHasEditableLayers_()};ol.events.listen(e,gmf.AuthenticationEventType.READY,f);ol.events.listen(e,gmf.AuthenticationEventType.LOGIN,f);ol.events.listen(e,gmf.AuthenticationEventType.LOGOUT,f);this.searchDatasources=[{labelKey:"label",groupValues:c.get("gmfSearchGroups"),groupActions:c.get("gmfSearchActions"),projection:"EPSG:"+(a.srid||21781),url:c.get("fulltextsearchUrl")}];this.dimensions={};this.permalink_.setDimensions(this.dimensions);c.get("gmfDataSourcesManager").setDimensions(this.dimensions);
if(c.has("gmfDefaultDimensions")){a=c.get("gmfDefaultDimensions");for(var g in a)void 0===this.dimensions[g]&&(this.dimensions[g]=a[g])}this.backgroundLayerMgr_=c.get("ngeoBackgroundLayerMgr");b.$watchCollection(function(){return d.dimensions},function(){d.backgroundLayerMgr_.updateDimensions(d.map,d.dimensions)});this.backgroundLayerMgr_.on(ngeo.BackgroundEventType.CHANGE,function(){d.backgroundLayerMgr_.updateDimensions(d.map,d.dimensions)});this.rightNavVisible=this.leftNavVisible=!1;g=new ol.style.Fill({color:[255,
170,0,.6]});a=new ol.style.Stroke({color:[255,170,0,1],width:2});this.queryFeatureStyle=new ol.style.Style({fill:g,image:new ol.style.Circle({fill:g,radius:5,stroke:a}),stroke:a});this.filterSelectorActive=!1;this.queryAutoClear=this.queryActive=!0;this.printActive=this.printPanelActive=!1;this.ngeoMapQuerent_=c.get("ngeoMapQuerent");b.$watch(function(){return d.printPanelActive},function(a){a||d.queryActive||d.ngeoMapQuerent_.clear();d.queryAutoClear=!a;d.printActive=a});this.drawProfilePanelActive=
this.drawFeatureActive=this.measureLengthActive=this.measurePointActive=!1;this.gmfUser=c.get("gmfUser");b.$watch(function(){return d.gmfUser.username},function(a){null!==a&&d.navIsVisible&&(d.rightNavVisible=!1)});this.getBrowserLanguage=c.get("ngeoGetBrowserLanguage");this.stateManager=c.get("ngeoStateManager");this.tmhDynamicLocale=c.get("tmhDynamicLocale");this.$scope=b;this.defaultLang=c.get("defaultLang");this.langUrls=c.get("langUrls");this.gettextCatalog=c.get("gettextCatalog");this.initLanguage();
this.mapToolsGroup="mapTools";c.get("ngeoFeatureOverlayMgr").init(this.map);g=c.get("ngeoToolActivateMgr");a=new ngeo.ToolActivate(this,"queryActive");g.registerTool("mapTools",a,!0);a=new ngeo.ToolActivate(this,"measurePointActive");g.registerTool("mapTools",a,!1);a=new ngeo.ToolActivate(this,"measureLengthActive");g.registerTool("mapTools",a,!1);a=new ngeo.ToolActivate(this,"drawFeatureActive");g.registerTool("mapTools",a,!1);a=new ngeo.ToolActivate(this,"drawProfilePanelActive");g.registerTool("mapTools",
a,!1);a=new ngeo.ToolActivate(this,"printPanelActive");g.registerTool("mapTools",a,!1);b.$root.$on(gmf.ThemeManagerEventType.THEME_NAME_SET,function(a,b){d.gmfThemes_.getThemeObject(b).then(function(a){d.setDefaultBackground_(a)})});var h=c.get("ngeoCreatePopup"),k=window.gmfx||{};window.gmfx=k;k.openIframePopup=function(a,b,c,d){var e=h();e.setUrl(""+a);k.openPopup_(e,b,c,d)};k.openTextPopup=function(a,b,c,d){var e=h();e.setContent(""+a,!0);k.openPopup_(e,b,c,d)};k.openPopup_=function(a,b,c,d){c&&
a.setWidth(""+c);d&&a.setHeight(""+d);a.setTitle(""+b);a.setAutoDestroy(!0);a.setOpen(!0)};this.manageResize=!1;b=window.cgxp||{};window.cgxp=b;b.tools=window.cgxp.tools||{};b.tools.openInfoWindow=function(a,b,c,d){k.openIframePopup(a,b,c,d)}};goog.exportSymbol("gmf.AbstractController",gmf.AbstractController);gmf.AbstractController.$inject=["config","$scope","$injector"];
gmf.AbstractController.getLayerByLabels=function(a,b){return b&&0<b.length?ol.array.find(a,function(a){return a.get("label")===b[0]}):null};gmf.AbstractController.prototype.switchLanguage=function(a){goog.asserts.assert(a in this.langUrls);this.gettextCatalog.setCurrentLanguage(a);this.gettextCatalog.loadRemote(this.langUrls[a]);this.tmhDynamicLocale.set(a);this.lang=a};goog.exportProperty(gmf.AbstractController.prototype,"switchLanguage",gmf.AbstractController.prototype.switchLanguage);
gmf.AbstractController.prototype.initLanguage=function(){var a=this;this.$scope.$watch(function(){return a.lang},function(b){a.stateManager.updateState({lang:b})});var b=this.getBrowserLanguage(Object.keys(this.langUrls)),c=this.stateManager.getInitialValue("lang");void 0!==c&&c in this.langUrls?this.switchLanguage(c):void 0!==b&&b in this.langUrls?this.switchLanguage(b):this.switchLanguage(this.defaultLang)};
gmf.AbstractController.prototype.setDefaultBackground_=function(a){var b=this;this.gmfThemes_.getBgLayers().then(function(c){var d=b.permalink_.getBackgroundLayer(c);!d&&b.gmfUser.functionalities&&(d=gmf.AbstractController.getLayerByLabels(c,b.gmfUser.functionalities.default_basemap));!d&&a&&(d=gmf.AbstractController.getLayerByLabels(c,a.functionalities.default_basemap));d||(d=c[1<c.length?1:0]);goog.asserts.assert(d);b.backgroundLayerMgr_.set(b.map,d)})};
gmf.AbstractController.prototype.updateCurrentTheme_=function(a){var b=this;this.gmfThemes_.getThemesObject().then(function(c){var d=b.permalink_.defaultThemeNameFromFunctionalities();d?(c=gmf.Themes.findThemeByName(c,d))&&b.gmfThemeManager.addTheme(c,!0):b.gmfThemeManager.setThemeName(a)})};gmf.module.controller("AbstractController",gmf.AbstractController);ngeo.bboxQueryDirective=function(a){return{restrict:"A",scope:!1,link:function(b,c,d){var e=b.$eval(d.ngeoBboxQueryMap),f=new ol.interaction.DragBox({condition:ol.events.condition.platformModifierKeyOnly});f.on("boxend",function(b){b=f.getGeometry().getExtent();a.issue({extent:b,map:e})});b.$watch(d.ngeoBboxQueryActive,function(c,h){c?e.addInteraction(f):(e.removeInteraction(f),!1!==b.$eval(d.ngeoBboxQueryAutoclear)&&a.clear())})}}};ngeo.bboxQueryDirective.$inject=["ngeoMapQuerent"];
ngeo.module.directive("ngeoBboxQuery",ngeo.bboxQueryDirective);gmf.RasterParam={X:"lon",Y:"lat"};gmf.Raster=function(a,b){this.$http_=a;this.url_=b};gmf.Raster.$inject=["$http","gmfRasterUrl"];gmf.Raster.prototype.getRaster=function(a,b){b=b||{};b[gmf.RasterParam.X]=a[0];b[gmf.RasterParam.Y]=a[1];return this.$http_.get(this.url_,{params:b}).then(this.handleGetRaster_.bind(this))};goog.exportProperty(gmf.Raster.prototype,"getRaster",gmf.Raster.prototype.getRaster);gmf.Raster.prototype.handleGetRaster_=function(a){return a.data};
gmf.module.service("gmfRaster",gmf.Raster);gmf.contextualdataDirective=function(){return{restrict:"A",scope:!1,controller:"GmfContextualdataController as cdCtrl",bindToController:{map:"<gmfContextualdataMap",projections:"<gmfContextualdataProjections",callback:"<gmfContextualdataCallback"},link:function(a,b,c,d){d.init()}}};gmf.module.directive("gmfContextualdata",gmf.contextualdataDirective);gmf.ContextualdataController=function(a,b,c){this.$compile_=a;this.$scope_=b;this.gmfRaster_=c;angular.element("body").on("mousedown",this.hidePopover.bind(this))};
gmf.ContextualdataController.$inject=["$compile","$scope","gmfRaster"];gmf.ContextualdataController.prototype.init=function(){this.preparePopover_();var a=this.map.getTargetElement();goog.asserts.assertElement(a);goog.events.listen(a,goog.events.EventType.CONTEXTMENU,this.handleMapContextMenu_,!1,this)};
gmf.ContextualdataController.prototype.handleMapContextMenu_=function(a){var b=this;this.$scope_.$apply(function(){var c=b.map.getEventPixel(a);c=b.map.getCoordinateFromPixel(c);b.setContent_(c);a.preventDefault();b.hidePopover();b.showPopover();b.overlay_.setPosition(c)})};
gmf.ContextualdataController.prototype.setContent_=function(a){var b=this.$scope_.$new(!0);this.$compile_(this.content_)(b);var c=this.map.getView().getProjection().getCode();this.projections.forEach(function(d){var e=ol.proj.transform(a,c,"EPSG:"+d);b["coord_"+d]=e;b["coord_"+d+"_eastern"]=e[0];b["coord_"+d+"_northern"]=e[1]});var d=function(c){ol.obj.assign(b,c);this.callback&&ol.obj.assign(b,this.callback.call(this,a,c))}.bind(this);this.gmfRaster_.getRaster(a).then(d,function(a){console.error("Error on getting the raster.")})};
gmf.ContextualdataController.prototype.preparePopover_=function(){var a=document.createElement("DIV");a.classList.add("popover");a.classList.add("bottom");a.classList.add("gmf-contextualdata");angular.element(a).css("position","relative");var b=document.createElement("DIV");b.classList.add("arrow");a.appendChild(b);this.content_=document.createElement("DIV");this.content_.setAttribute("gmf-contextualdatacontent","");this.content_.classList.add("popover-content");a.appendChild(this.content_);this.overlay_=
new ol.Overlay({element:a,stopEvent:!0,autoPan:!0,autoPanAnimation:{duration:250},positioning:"top-center"});this.map.addOverlay(this.overlay_)};gmf.ContextualdataController.prototype.showPopover=function(){var a=this.overlay_.getElement();angular.element(a).css("display","block")};gmf.ContextualdataController.prototype.hidePopover=function(){var a=this.overlay_.getElement();angular.element(a).css("display","none")};gmf.module.controller("GmfContextualdataController",gmf.ContextualdataController);
gmf.contextualdatacontentDirective=function(a){return{restrict:"A",scope:!0,templateUrl:a}};gmf.contextualdatacontentDirective.$inject=["gmfContextualdatacontentTemplateUrl"];gmf.module.directive("gmfContextualdatacontent",gmf.contextualdatacontentDirective);ngeo.CsvDownload=function(a,b){this.gettextCatalog_=b;this.encoding_=a.has("ngeoCsvEncoding")?a.get("ngeoCsvEncoding"):"utf-8";this.extension_=a.has("ngeoCsvExtension")?a.get("ngeoCsvExtension"):".csv";this.includeHeader_=a.has("ngeoCsvIncludeHeader")?a.get("ngeoCsvIncludeHeader"):!0;this.quote_=a.has("ngeoCsvQuote")?a.get("ngeoCsvQuote"):'"';this.separator_=a.has("ngeoCsvSeparator")?a.get("ngeoCsvSeparator"):",";this.download_=a.get("ngeoDownload")};ngeo.CsvDownload.$inject=["$injector","gettextCatalog"];
ngeo.CsvDownload.prototype.generateCsv=function(a,b){var c=this;if(0==a.length||0==b.length)return"";var d=b.map(function(a){return c.gettextCatalog_.getString(a.name)});d=this.getRow_(d);a=a.map(function(a){var d=b.map(function(b){return a[b.name]});return c.getRow_(d)});return this.includeHeader_?d+a.join(""):a.join("")};goog.exportProperty(ngeo.CsvDownload.prototype,"generateCsv",ngeo.CsvDownload.prototype.generateCsv);
ngeo.CsvDownload.prototype.getRow_=function(a){var b=this,c=new RegExp(this.quote_,"g"),d=this.quote_+this.quote_;return a.map(function(a){return void 0!==a&&null!==a?b.quote_+(""+a).replace(c,d)+b.quote_:""}).join(this.separator_)+"\n"};ngeo.CsvDownload.prototype.startDownload=function(a,b,c){a=this.generateCsv(a,b);this.download_(a,c,"text/csv;charset="+this.encoding_)};goog.exportProperty(ngeo.CsvDownload.prototype,"startDownload",ngeo.CsvDownload.prototype.startDownload);
ngeo.module.service("ngeoCsvDownload",ngeo.CsvDownload);ngeo.module.value("ngeoGridTemplateUrl",function(a,b){a=b.ngeoGridTemplateurl;return void 0!==a?a:ngeo.baseTemplateUrl+"/grid.html"});ngeo.GridConfig=function(a,b){this.data=a;this.columnDefs=b;this.selectedRows={}};goog.exportSymbol("ngeo.GridConfig",ngeo.GridConfig);ngeo.GridConfig.getRowUid=function(a){return""+ol.getUid(a)};goog.exportProperty(ngeo.GridConfig,"getRowUid",ngeo.GridConfig.getRowUid);ngeo.GridConfig.prototype.isRowSelected=function(a){return!!this.selectedRows[ngeo.GridConfig.getRowUid(a)]};
goog.exportProperty(ngeo.GridConfig.prototype,"isRowSelected",ngeo.GridConfig.prototype.isRowSelected);ngeo.GridConfig.prototype.getSelectedCount=function(){return Object.keys(this.selectedRows).length};goog.exportProperty(ngeo.GridConfig.prototype,"getSelectedCount",ngeo.GridConfig.prototype.getSelectedCount);ngeo.GridConfig.prototype.getSelectedRows=function(){var a=this;return this.data.filter(function(b){return a.isRowSelected(b)})};
goog.exportProperty(ngeo.GridConfig.prototype,"getSelectedRows",ngeo.GridConfig.prototype.getSelectedRows);ngeo.GridConfig.prototype.selectRow=function(a){var b=ngeo.GridConfig.getRowUid(a);this.selectedRows[b]=a};ngeo.GridConfig.prototype.toggleRow=function(a){var b=ngeo.GridConfig.getRowUid(a);this.isRowSelected(a)?delete this.selectedRows[b]:this.selectedRows[b]=a};ngeo.GridConfig.prototype.selectAll=function(){var a=this;this.data.forEach(function(b){a.selectRow(b)})};
goog.exportProperty(ngeo.GridConfig.prototype,"selectAll",ngeo.GridConfig.prototype.selectAll);ngeo.GridConfig.prototype.unselectAll=function(){for(var a in this.selectedRows)delete this.selectedRows[a]};goog.exportProperty(ngeo.GridConfig.prototype,"unselectAll",ngeo.GridConfig.prototype.unselectAll);ngeo.GridConfig.prototype.invertSelection=function(){var a=this;this.data.forEach(function(b){a.toggleRow(b)})};goog.exportProperty(ngeo.GridConfig.prototype,"invertSelection",ngeo.GridConfig.prototype.invertSelection);
function ngeoGridTemplateUrl(a,b,c){return c(a,b)}ngeoGridTemplateUrl.$inject=["$element","$attrs","ngeoGridTemplateUrl"];ngeo.gridComponent={controller:"ngeoGridController as ctrl",bindings:{configuration:"=ngeoGridConfiguration"},templateUrl:ngeoGridTemplateUrl};ngeo.module.component("ngeoGrid",ngeo.gridComponent);ngeo.GridController=function(a){this.scope_=a;this.sortAscending=!0;this.floatTheadConfig={scrollContainer:function(a){return a.closest(".ngeo-grid-table-container")}}};
ngeo.GridController.$inject=["$scope"];ngeo.GridController.prototype.$onInit=function(){this.selectedRows=this.configuration.selectedRows};ngeo.GridController.prototype.sort=function(a){this.sortAscending=this.sortedBy===a?!this.sortAscending:!0;this.sortedBy=a;var b=this.sortAscending?1:-1;this.configuration.data.sort(function(c,d){return c[a]?d[a]?c[a]>d[a]?b:-b:-1:1})};goog.exportProperty(ngeo.GridController.prototype,"sort",ngeo.GridController.prototype.sort);
ngeo.GridController.prototype.clickRow=function(a,b){var c=this.isShiftKeyOnly_(b);b=this.isPlatformModifierKeyOnly_(b);this.clickRow_(a,c,b)};goog.exportProperty(ngeo.GridController.prototype,"clickRow",ngeo.GridController.prototype.clickRow);ngeo.GridController.prototype.clickRow_=function(a,b,c){b&&!c?this.selectRange_(a):!b&&c?this.configuration.toggleRow(a):(b=this.configuration.isRowSelected(a),this.configuration.unselectAll(),b||this.configuration.selectRow(a))};
ngeo.GridController.prototype.selectRange_=function(a){var b=ngeo.GridConfig.getRowUid(a),c=this.configuration.data;if(!this.configuration.isRowSelected(a)){for(var d=void 0,e=[],f=0;f<c.length;f++){var g=c[f],h=ngeo.GridConfig.getRowUid(g);b===h?d=f:this.configuration.isRowSelected(g)&&e.push(f)}goog.asserts.assert(void 0!==d);0==e.length&&this.configuration.selectRow(a);b=Infinity;a=e[0];for(f=0;f<e.length;f++)g=e[f],h=Math.abs(g-d),b>h&&(b=h,a=g);e=d>a?d:a;for(d=d<a?d:a;d<=e;d++)this.configuration.selectRow(c[d])}};
ngeo.GridController.prototype.preventTextSelection=function(a){var b=this.isShiftKeyOnly_(a),c=this.isPlatformModifierKeyOnly_(a);(b||c)&&a.preventDefault()};goog.exportProperty(ngeo.GridController.prototype,"preventTextSelection",ngeo.GridController.prototype.preventTextSelection);ngeo.GridController.prototype.isPlatformModifierKeyOnly_=function(a){return!a.altKey&&(ol.has.MAC?a.metaKey:a.ctrlKey)&&!a.shiftKey};
ngeo.GridController.prototype.isShiftKeyOnly_=function(a){return!a.altKey&&!(a.metaKey||a.ctrlKey)&&a.shiftKey};ngeo.module.controller("ngeoGridController",ngeo.GridController);ngeo.module.value("gmfDisplayquerygridTemplateUrl",function(a,b){a=b.gmfDisplayquerygridTemplateurl;return void 0!==a?a:gmf.baseTemplateUrl+"/displayquerygrid.html"});function gmfDisplayquerygridTemplateUrl(a,b,c){return c(a,b)}gmfDisplayquerygridTemplateUrl.$inject=["$element","$attrs","gmfDisplayquerygridTemplateUrl"];
gmf.displayquerygridComponent={controller:"GmfDisplayquerygridController as ctrl",bindings:{active:"=?gmfDisplayquerygridActive",featuresStyleFn:"&gmfDisplayquerygridFeaturesstyle",selectedFeatureStyleFn:"&gmfDisplayquerygridSelectedfeaturestyle",getMapFn:"&gmfDisplayquerygridMap",removeEmptyColumnsFn:"&?gmfDisplayquerygridRemoveemptycolumns",maxResultsFn:"&?gmfDisplayquerygridMaxresults",maxRecenterZoomFn:"&?gmfDisplayquerygridMaxrecenterzoom",mergeTabs:"<?gmfDisplayquerygridMergetabs"},templateUrl:gmfDisplayquerygridTemplateUrl};
gmf.module.component("gmfDisplayquerygrid",gmf.displayquerygridComponent);
gmf.DisplayquerygridController=function(a,b,c,d,e,f,g,h){var k=this;a=a.has("ngeoQueryOptions")?a.get("ngeoQueryOptions"):{};this.$scope_=b;this.$timeout_=f;this.ngeoQueryResult=c;this.ngeoMapQuerent_=d;this.ngeoCsvDownload_=g;this.$element_=h;this.maxResults=void 0!==a.limit?a.limit:50;this.pending=this.active=!1;this.gridSources={};this.loadedGridSources=[];this.selectedTab=null;this.removeEmptyColumns_=!1;this.mergeTabs={};this.featuresForSources_={};this.features_=new ol.Collection;this.ngeoFeatureOverlayMgr_=
e;this.highlightFeatures_=new ol.Collection;this.map_=null;this.$scope_.$watchCollection(function(){return c},function(a,b){a!==b&&k.updateData_()});this.unregisterSelectWatcher_=null};gmf.DisplayquerygridController.$inject="$injector $scope ngeoQueryResult ngeoMapQuerent ngeoFeatureOverlayMgr $timeout ngeoCsvDownload $element".split(" ");
gmf.DisplayquerygridController.prototype.$onInit=function(){this.removeEmptyColumns_=this.removeEmptyColumnsFn?!0===this.removeEmptyColumnsFn():!1;this.maxRecenterZoom=this.maxRecenterZoomFn?this.maxRecenterZoomFn():void 0;var a=this.ngeoFeatureOverlayMgr_.getFeatureOverlay();a.setFeatures(this.features_);var b=this.featuresStyleFn();void 0!==b&&(goog.asserts.assertInstanceof(b,ol.style.Style),a.setStyle(b));a=this.ngeoFeatureOverlayMgr_.getFeatureOverlay();a.setFeatures(this.highlightFeatures_);
b=this.selectedFeatureStyleFn();if(void 0!==b)goog.asserts.assertInstanceof(b,ol.style.Style);else{b=new ol.style.Fill({color:[255,0,0,.6]});var c=new ol.style.Stroke({color:[255,0,0,1],width:2});b=new ol.style.Style({fill:b,image:new ol.style.Circle({fill:b,radius:5,stroke:c}),stroke:c,zIndex:10})}a.setStyle(b);if(a=this.getMapFn)a=a(),goog.asserts.assertInstanceof(a,ol.Map),this.map_=a};gmf.DisplayquerygridController.prototype.getGridSources=function(){var a=this;return this.loadedGridSources.map(function(b){return a.gridSources[b]})};
goog.exportProperty(gmf.DisplayquerygridController.prototype,"getGridSources",gmf.DisplayquerygridController.prototype.getGridSources);
gmf.DisplayquerygridController.prototype.updateData_=function(){var a=this;if(0!==this.ngeoQueryResult.total||this.hasOneWithTooManyResults_()){this.active=!0;this.pending=!1;var b=this.ngeoQueryResult.sources;0<Object.keys(this.mergeTabs).length&&(b=this.getMergedSources_(b));b.forEach(function(b){b.tooManyResults?a.makeGrid_(null,b):(b.id=a.escapeValue(b.id),0<b.features.length&&a.collectData_(b))});0===this.loadedGridSources.length?this.active=!1:null!==this.selectedTab&&""+this.selectedTab in
this.gridSources||this.$timeout_(function(){a.selectTab(a.gridSources[a.loadedGridSources[0]])},0)}else b=this.active,this.clear(),b&&(this.pending=this.active=this.ngeoQueryResult.pending)};gmf.DisplayquerygridController.prototype.hasOneWithTooManyResults_=function(){return this.ngeoQueryResult.sources.some(function(a){return a.tooManyResults})};
gmf.DisplayquerygridController.prototype.escapeValue=function(a){if(Number.isInteger(a))return a;var b=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\ |]/g;return null!==a.match(b)?a.replace(b,"_"):a};goog.exportProperty(gmf.DisplayquerygridController.prototype,"escapeValue",gmf.DisplayquerygridController.prototype.escapeValue);gmf.DisplayquerygridController.prototype.isSelected=function(a){return this.selectedTab===a.source.label};goog.exportProperty(gmf.DisplayquerygridController.prototype,"isSelected",gmf.DisplayquerygridController.prototype.isSelected);
gmf.DisplayquerygridController.prototype.getMergedSources_=function(a){var b=this,c=[],d={};a.forEach(function(a){null===b.getMergedSource_(a,d)&&c.push(a)});for(var e in d)c.push(d[e]);return c};
gmf.DisplayquerygridController.prototype.getMergedSource_=function(a,b){var c=null,d;for(d in this.mergeTabs)if(this.mergeTabs[d].some(function(b){return b==a.label})){c=d;break}if(null===c)return null;if(c in b)var e=b[c];else e={features:[],id:c,label:c,limit:this.maxResults,pending:!1,queried:!0,tooManyResults:!1,totalFeatureCount:void 0},b[c]=e;a.features.forEach(function(a){e.features.push(a)});e.tooManyResults=e.tooManyResults||a.tooManyResults;e.tooManyResults&&(e.totalFeatureCount=void 0!==
e.totalFeatureCount?e.totalFeatureCount+e.features.length:e.features.length,e.features=[]);void 0!==a.totalFeatureCount&&(e.totalFeatureCount=void 0!==e.totalFeatureCount?e.totalFeatureCount+a.totalFeatureCount:a.totalFeatureCount);return e};
gmf.DisplayquerygridController.prototype.collectData_=function(a){var b=[],c=[],d={},e,f;a.features.forEach(function(a){e=a.getProperties();void 0!==e&&(f=a.getGeometryName(),-1===c.indexOf(f)&&c.push(f),b.push(e),d[ngeo.GridConfig.getRowUid(e)]=a)});this.cleanProperties_(b,c);0<b.length&&this.makeGrid_(b,a)&&(this.featuresForSources_[""+a.label]=d)};
gmf.DisplayquerygridController.prototype.cleanProperties_=function(a,b){a.forEach(function(a){b.forEach(function(b){delete a[b]});delete a.boundedBy;delete a.ngeo_feature_type_});!0===this.removeEmptyColumns_&&this.removeEmptyColumnsFn_(a)};gmf.DisplayquerygridController.prototype.removeEmptyColumnsFn_=function(a){var b=[],c,d;for(d in a[0])for(c=0;c<a.length;c++)if(void 0!==a[c][d]){b.push(d);break}var e;a.forEach(function(a){e=[];for(d in a)-1===b.indexOf(d)&&e.push(d);e.forEach(function(b){delete a[b]})})};
gmf.DisplayquerygridController.prototype.makeGrid_=function(a,b){var c=""+b.label,d=null;if(null!==a&&(d=this.getGridConfiguration_(a),null===d))return!1;-1==this.loadedGridSources.indexOf(c)&&this.loadedGridSources.push(c);this.gridSources[c]={configuration:d,source:b};return!0};
gmf.DisplayquerygridController.prototype.getGridConfiguration_=function(a){goog.asserts.assert(0<a.length);var b={};Object.assign(b,a[0]);delete b.ol_uid;var c=[];Object.keys(b).forEach(function(a){c.push({name:a})});return 0<c.length?new ngeo.GridConfig(a,c):null};
gmf.DisplayquerygridController.prototype.clear=function(){this.pending=this.active=!1;this.gridSources={};this.loadedGridSources=[];this.selectedTab=null;this.tooManyResults=!1;this.features_.clear();this.highlightFeatures_.clear();this.ngeoMapQuerent_.clear();this.featuresForSources_={};this.unregisterSelectWatcher_&&this.unregisterSelectWatcher_()};goog.exportProperty(gmf.DisplayquerygridController.prototype,"clear",gmf.DisplayquerygridController.prototype.clear);
gmf.DisplayquerygridController.prototype.selectTab=function(a){var b=this;this.selectedTab=a.source.label;this.unregisterSelectWatcher_&&(this.unregisterSelectWatcher_(),this.unregisterSelectWatcher_=null);null!==a.configuration&&(this.unregisterSelectWatcher_=this.$scope_.$watchCollection(function(){return a.configuration.selectedRows},function(a,d){if(Object.keys(a)!==Object.keys(d))b.onSelectionChanged_()}));this.updateFeatures_(a);this.reflowGrid_()};
goog.exportProperty(gmf.DisplayquerygridController.prototype,"selectTab",gmf.DisplayquerygridController.prototype.selectTab);gmf.DisplayquerygridController.prototype.reflowGrid_=function(){var a=this.escapeValue(this.selectedTab||""),b=this.$element_.find("div.tab-pane#"+a);b.removeClass("active").addClass("active");this.$timeout_(function(){b.find("div.ngeo-grid-table-container table").trigger("reflow")})};
gmf.DisplayquerygridController.prototype.onSelectionChanged_=function(){null!==this.selectedTab&&this.updateFeatures_(this.gridSources[""+this.selectedTab])};gmf.DisplayquerygridController.prototype.updateFeatures_=function(a){this.features_.clear();this.highlightFeatures_.clear();if(null!==a.configuration){var b=this.featuresForSources_[""+a.source.label];a=a.configuration.selectedRows;for(var c in b){var d=b[c];c in a?this.highlightFeatures_.push(d):this.features_.push(d)}}};
gmf.DisplayquerygridController.prototype.getActiveGridSource=function(){return null===this.selectedTab?null:this.gridSources[""+this.selectedTab]};goog.exportProperty(gmf.DisplayquerygridController.prototype,"getActiveGridSource",gmf.DisplayquerygridController.prototype.getActiveGridSource);gmf.DisplayquerygridController.prototype.isOneSelected=function(){var a=this.getActiveGridSource();return null===a||null===a.configuration?!1:0<a.configuration.getSelectedCount()};
goog.exportProperty(gmf.DisplayquerygridController.prototype,"isOneSelected",gmf.DisplayquerygridController.prototype.isOneSelected);gmf.DisplayquerygridController.prototype.getSelectedRowCount=function(){var a=this.getActiveGridSource();return null===a||null===a.configuration?0:a.configuration.getSelectedCount()};goog.exportProperty(gmf.DisplayquerygridController.prototype,"getSelectedRowCount",gmf.DisplayquerygridController.prototype.getSelectedRowCount);
gmf.DisplayquerygridController.prototype.selectAll=function(){var a=this.getActiveGridSource();null!==a&&a.configuration.selectAll()};goog.exportProperty(gmf.DisplayquerygridController.prototype,"selectAll",gmf.DisplayquerygridController.prototype.selectAll);gmf.DisplayquerygridController.prototype.unselectAll=function(){var a=this.getActiveGridSource();null!==a&&a.configuration.unselectAll()};goog.exportProperty(gmf.DisplayquerygridController.prototype,"unselectAll",gmf.DisplayquerygridController.prototype.unselectAll);
gmf.DisplayquerygridController.prototype.invertSelection=function(){var a=this.getActiveGridSource();null!==a&&a.configuration.invertSelection()};goog.exportProperty(gmf.DisplayquerygridController.prototype,"invertSelection",gmf.DisplayquerygridController.prototype.invertSelection);
gmf.DisplayquerygridController.prototype.zoomToSelection=function(){if(null!==this.getActiveGridSource()){var a=ol.extent.createEmpty();this.highlightFeatures_.forEach(function(b){ol.extent.extend(a,b.getGeometry().getExtent())});var b=this.map_.getSize();goog.asserts.assert(void 0!==b);var c=this.maxRecenterZoom;this.map_.getView().fit(a,{size:b,maxZoom:c})}};goog.exportProperty(gmf.DisplayquerygridController.prototype,"zoomToSelection",gmf.DisplayquerygridController.prototype.zoomToSelection);
gmf.DisplayquerygridController.prototype.downloadCsv=function(){var a=this.getActiveGridSource();if(null!==a){var b=a.configuration.columnDefs;goog.asserts.assert(void 0!==b);a=a.configuration.getSelectedRows();this.ngeoCsvDownload_.startDownload(a,b,"query-results.csv")}};goog.exportProperty(gmf.DisplayquerygridController.prototype,"downloadCsv",gmf.DisplayquerygridController.prototype.downloadCsv);gmf.module.controller("GmfDisplayquerygridController",gmf.DisplayquerygridController);gmf.featurestyleDirective=function(){return{controller:"GmfFeaturestyleController as fsCtrl",scope:{feature:"=gmfFeaturestyleFeature"},bindToController:!0,templateUrl:gmf.baseTemplateUrl+"/featurestyle.html"}};gmf.module.directive("gmfFeaturestyle",gmf.featurestyleDirective);
gmf.FeaturestyleController=function(a,b){var c=this;this.scope_=a;this.featureHelper_=b;this.measure=this.label=this.color=void 0;a.$watch(function(){return c.color},this.handleColorSet_.bind(this));this.featureListenerKeys_=[];a.$watch(function(){return c.feature},this.handleFeatureSet_.bind(this))};gmf.FeaturestyleController.$inject=["$scope","ngeoFeatureHelper"];
gmf.FeaturestyleController.prototype.handleFeatureSet_=function(a,b){var c=this.featureListenerKeys_;b&&(c.forEach(function(a){ol.events.unlistenByKey(a)},this),this.label=this.measure=this.color=this.type=void 0);a&&([ngeo.FeatureProperties.ANGLE,ngeo.FeatureProperties.COLOR,ngeo.FeatureProperties.NAME,ngeo.FeatureProperties.SHOW_LABEL,ngeo.FeatureProperties.OPACITY,ngeo.FeatureProperties.SHOW_MEASURE,ngeo.FeatureProperties.SIZE,ngeo.FeatureProperties.STROKE].forEach(function(b){c.push(ol.events.listen(a,
ol.Object.getChangeEventType(b),this.handleFeatureChange_,this))},this),b=a.getGeometry(),goog.asserts.assert(b,"Geometry should be thruthy"),c.push(ol.events.listen(b,"change",this.handleGeometryChange_,this)),this.type=this.featureHelper_.getType(a),this.color=this.featureHelper_.getColorProperty(a),this.measure=this.featureHelper_.getMeasure(a))};
gmf.FeaturestyleController.prototype.handleColorSet_=function(a){this.feature&&a&&this.feature.get(ngeo.FeatureProperties.COLOR)!==a&&this.feature.set(ngeo.FeatureProperties.COLOR,a)};gmf.FeaturestyleController.prototype.getSetAngle=function(a){return goog.asserts.assertNumber(this.getSetProperty_(ngeo.FeatureProperties.ANGLE,a))};goog.exportProperty(gmf.FeaturestyleController.prototype,"getSetAngle",gmf.FeaturestyleController.prototype.getSetAngle);
gmf.FeaturestyleController.prototype.getSetName=function(a){return goog.asserts.assertString(this.getSetProperty_(ngeo.FeatureProperties.NAME,a))};goog.exportProperty(gmf.FeaturestyleController.prototype,"getSetName",gmf.FeaturestyleController.prototype.getSetName);gmf.FeaturestyleController.prototype.getSetShowLabel=function(a){return goog.asserts.assertBoolean(this.getSetProperty_(ngeo.FeatureProperties.SHOW_LABEL,a))};goog.exportProperty(gmf.FeaturestyleController.prototype,"getSetShowLabel",gmf.FeaturestyleController.prototype.getSetShowLabel);
gmf.FeaturestyleController.prototype.getSetOpacity=function(a){return goog.asserts.assertNumber(this.getSetProperty_(ngeo.FeatureProperties.OPACITY,a))};goog.exportProperty(gmf.FeaturestyleController.prototype,"getSetOpacity",gmf.FeaturestyleController.prototype.getSetOpacity);gmf.FeaturestyleController.prototype.getSetShowMeasure=function(a){return goog.asserts.assertBoolean(this.getSetProperty_(ngeo.FeatureProperties.SHOW_MEASURE,a))};
goog.exportProperty(gmf.FeaturestyleController.prototype,"getSetShowMeasure",gmf.FeaturestyleController.prototype.getSetShowMeasure);gmf.FeaturestyleController.prototype.getSetSize=function(a){return goog.asserts.assertNumber(this.getSetProperty_(ngeo.FeatureProperties.SIZE,a))};goog.exportProperty(gmf.FeaturestyleController.prototype,"getSetSize",gmf.FeaturestyleController.prototype.getSetSize);
gmf.FeaturestyleController.prototype.getSetStroke=function(a){return goog.asserts.assertNumber(this.getSetProperty_(ngeo.FeatureProperties.STROKE,a))};goog.exportProperty(gmf.FeaturestyleController.prototype,"getSetStroke",gmf.FeaturestyleController.prototype.getSetStroke);gmf.FeaturestyleController.prototype.getSetProperty_=function(a,b){void 0!==b&&this.feature.set(a,b);return this.feature.get(a)};
gmf.FeaturestyleController.prototype.handleFeatureChange_=function(){var a=this.feature;a&&this.featureHelper_.setStyle(a,!0)};gmf.FeaturestyleController.prototype.handleGeometryChange_=function(){goog.asserts.assert(this.feature);this.measure=this.featureHelper_.getMeasure(this.feature);this.featureHelper_.getShowMeasureProperty(this.feature)&&this.handleFeatureChange_();this.scope_.$apply()};gmf.module.controller("GmfFeaturestyleController",gmf.FeaturestyleController);ngeo.MenuEventType={ACTION_CLICK:"actionclick"};ngeo.MenuEvent=function(a,b){ol.events.Event.call(this,a);this.action=b};ol.inherits(ngeo.MenuEvent,ol.events.Event);
ngeo.Menu=function(a,b){var c=this;b=void 0!==b?b:{};b.positioning=ol.OverlayPositioning.TOP_LEFT;this.listenerKeys_=[];this.clickOutListenerKey_=null;this.olListenerKeys_=[];var d=$("<div/>",{"class":"panel panel-default"});this.autoClose_=void 0!==a.autoClose?a.autoClose:!0;if(a.title){var e=$("<div>",{"class":"panel-heading"}).appendTo(d);$("<span>",{text:a.title}).appendTo(e)}var f=$("<div>",{"class":"list-group"}).appendTo(d);this.actions_=[];a.actions.forEach(function(a){c.actions_.push($("<button>",
{"class":"list-group-item","data-name":a.name,text:[" ",void 0!==a.label?a.label:a.name].join("")}).appendTo(f).prepend($("<span>",{"class":void 0!==a.cls?a.cls:""})))});b.element=d[0];ol.Overlay.call(this,b)};ol.inherits(ngeo.Menu,ol.Overlay);
ngeo.Menu.prototype.setMap=function(a){var b=this,c=this.listenerKeys_,d=this.olListenerKeys_;this.getMap()&&(c.forEach(function(a){goog.events.unlistenByKey(a)},this),c.length=0,d.forEach(function(a){ol.events.unlistenByKey(a)},this),d.length=0);ol.Overlay.prototype.setMap.call(this,a);a&&(this.actions_.forEach(function(a){var d=a.data();c.push(goog.events.listen(a[0],goog.events.EventType.CLICK,b.handleActionClick_.bind(b,d.name),!1,b))}),d.push(ol.events.listen(a,ol.MapBrowserEventType.POINTERMOVE,
this.handleMapPointerMove_,this)))};goog.exportProperty(ngeo.Menu.prototype,"setMap",ngeo.Menu.prototype.setMap);ngeo.Menu.prototype.open=function(a){this.setPosition(a);this.autoClose_&&(this.clickOutListenerKey_=goog.events.listen(document.documentElement,goog.events.EventType.MOUSEDOWN,this.handleClickOut_,!1,this))};goog.exportProperty(ngeo.Menu.prototype,"open",ngeo.Menu.prototype.open);ngeo.Menu.prototype.close=function(){this.setPosition(void 0);null!==this.clickOutListenerKey_&&goog.events.unlistenByKey(this.clickOutListenerKey_)};
goog.exportProperty(ngeo.Menu.prototype,"close",ngeo.Menu.prototype.close);ngeo.Menu.prototype.handleActionClick_=function(a,b){this.dispatchEvent(new ngeo.MenuEvent(ngeo.MenuEventType.ACTION_CLICK,a));this.autoClose_&&this.close();b.stopPropagation()};ngeo.Menu.prototype.handleClickOut_=function(a){var b=this.getElement();b&&0===$(a.target).closest(b).length&&this.close()};
ngeo.Menu.prototype.handleMapPointerMove_=function(a){var b=a.originalEvent.target;goog.asserts.assertInstanceof(b,Element);var c=this.getElement();goog.asserts.assertInstanceof(c,Element);c.contains(b)&&(a.coordinate=[Infinity,Infinity],a.pixel=[Infinity,Infinity])};ngeo.btngroupDirective=function(a){return{restrict:"A",controller:"ngeoBtnGroupController",link:function(b,c,d,e){var f=a(d.ngeoBtnGroupActive).assign;f&&b.$watch(function(){return e.buttons_.some(function(a){return!0===a(b)})},function(a){f(b,a)})}}};ngeo.btngroupDirective.$inject=["$parse"];ngeo.module.directive("ngeoBtnGroup",ngeo.btngroupDirective);ngeo.BtnGroupController=function(a){this.buttons_=[];this.scope_=a};ngeo.BtnGroupController.$inject=["$scope"];
ngeo.BtnGroupController.prototype.activate=function(a){this.buttons_.forEach(function(b,c){c!=a&&b.assign(this.scope_,!1)},this)};ngeo.BtnGroupController.prototype.addButton=function(a){this.buttons_.push(a);return this.buttons_.length-1};ngeo.module.controller("ngeoBtnGroupController",ngeo.BtnGroupController);
ngeo.btnDirective=function(a){return{require:["?^ngeoBtnGroup","ngModel"],restrict:"A",link:function(b,c,d,e){var f=e[0],g=e[1],h=-1;d=a(d.ngModel);e=d.assign;void 0===d(b)&&e(b,!1);null!==f&&(h=f.addButton(d));c.on("click",function(){b.$apply(function(){g.$setViewValue(!g.$viewValue);g.$render()})});g.$render=function(){g.$viewValue&&null!==f&&f.activate(h);c.toggleClass("active",g.$viewValue)}}}};ngeo.btnDirective.$inject=["$parse"];ngeo.module.directive("ngeoBtn",ngeo.btnDirective);ngeo.decorateInteraction=function(a){goog.asserts.assertInstanceof(a,ol.interaction.Interaction);Object.defineProperty(a,"active",{get:function(){return a.getActive()},set:function(b){a.setActive(b)}})};ngeo.module.value("ngeoDecorateInteraction",ngeo.decorateInteraction);ngeo.drawpointDirective=function(){return{restrict:"A",require:"^^ngeoDrawfeature",link:function(a,b,c,d){a=new ol.interaction.Draw({type:ol.geom.GeometryType.POINT});d.registerInteraction(a);d.drawPoint=a;ol.events.listen(a,ol.interaction.DrawEventType.DRAWEND,d.handleDrawEnd.bind(d,ngeo.GeometryType.POINT),d);ol.events.listen(a,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),d.handleActiveChange,d)}}};ngeo.module.directive("ngeoDrawpoint",ngeo.drawpointDirective);ngeo.drawrectangleDirective=function(){return{restrict:"A",require:"^^ngeoDrawfeature",link:function(a,b,c,d){a=new ol.interaction.Draw({type:ol.geom.GeometryType.LINE_STRING,geometryFunction:function(a,b){b||(b=new ol.geom.Polygon(null));var c=a[0];a=a[1];b.setCoordinates([[c,[c[0],a[1]],a,[a[0],c[1]],c]]);return b},maxPoints:2});d.registerInteraction(a);d.drawRectangle=a;ol.events.listen(a,ol.interaction.DrawEventType.DRAWEND,d.handleDrawEnd.bind(d,ngeo.GeometryType.RECTANGLE),d);ol.events.listen(a,
ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),d.handleActiveChange,d)}}};ngeo.module.directive("ngeoDrawrectangle",ngeo.drawrectangleDirective);ngeo.drawtextDirective=function(){return{restrict:"A",require:"^^ngeoDrawfeature",link:function(a,b,c,d){a=new ol.interaction.Draw({type:ol.geom.GeometryType.POINT});d.registerInteraction(a);d.drawText=a;ol.events.listen(a,ol.interaction.DrawEventType.DRAWEND,d.handleDrawEnd.bind(d,ngeo.GeometryType.TEXT),d);ol.events.listen(a,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),d.handleActiveChange,d)}}};ngeo.module.directive("ngeoDrawtext",ngeo.drawtextDirective);ngeo.interaction.MeasureArea=function(a,b){b=void 0!==b?b:{};ngeo.interaction.Measure.call(this,b);void 0!==b.continueMsg?this.continueMsg=b.continueMsg:(this.continueMsg=document.createElement("span"),this.continueMsg.textContent="Click to continue drawing the polygon.",b=document.createElement("br"),b.textContent="Double-click or click starting point to finish.",this.continueMsg.appendChild(b));this.format=a};ol.inherits(ngeo.interaction.MeasureArea,ngeo.interaction.Measure);
goog.exportSymbol("ngeo.interaction.MeasureArea",ngeo.interaction.MeasureArea);ngeo.interaction.MeasureArea.prototype.createDrawInteraction=function(a,b){return new ol.interaction.Draw({type:"Polygon",source:b,style:a})};
ngeo.interaction.MeasureArea.prototype.handleMeasure=function(a){var b=goog.asserts.assertInstanceof(this.sketchFeature.getGeometry(),ol.geom.Polygon),c=this.getMap().getView().getProjection();goog.asserts.assert(c);c=ngeo.interaction.Measure.getFormattedArea(b,c,this.precision,this.format);var d=null;3<b.getCoordinates()[0].length&&(d=b.getInteriorPoint().getCoordinates());a(c,d)};ngeo.measureareaDirective=function(a,b,c,d){return{restrict:"A",require:"^^ngeoDrawfeature",link:function(e,f,g,h){f=b.getString("Click to start drawing polygon");g=b.getString("Click to continue drawing<br/>Double-click or click starting point to finish");e=new ngeo.interaction.MeasureArea(c("ngeoUnitPrefix"),{style:new ol.style.Style,startMsg:a("<div translate>"+f+"</div>")(e)[0],continueMsg:a("<div translate>"+g+"</div>")(e)[0],precision:d.has("ngeoMeasurePrecision")?d.get("ngeoMeasurePrecision"):
void 0});h.registerInteraction(e);h.measureArea=e;ol.events.listen(e,ngeo.MeasureEventType.MEASUREEND,h.handleDrawEnd.bind(h,ngeo.GeometryType.POLYGON),h);ol.events.listen(e,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),h.handleActiveChange,h)}}};ngeo.measureareaDirective.$inject=["$compile","gettextCatalog","$filter","$injector"];ngeo.module.directive("ngeoMeasurearea",ngeo.measureareaDirective);ngeo.measureazimutDirective=function(a,b,c,d){return{restrict:"A",require:"^^ngeoDrawfeature",link:function(e,f,g,h){f=b.getString("Click to start drawing circle");g=b.getString("Click to finish");e=new ngeo.interaction.MeasureAzimut(c("ngeoUnitPrefix"),c("number"),{style:new ol.style.Style,startMsg:a("<div translate>"+f+"</div>")(e)[0],continueMsg:a("<div translate>"+g+"</div>")(e)[0],precision:d.has("ngeoMeasurePrecision")?d.get("ngeoMeasurePrecision"):void 0,decimals:d.has("ngeoMeasureDecimals")?
d.get("ngeoMeasureDecimals"):void 0});h.registerInteraction(e);h.measureAzimut=e;ol.events.listen(e,ngeo.MeasureEventType.MEASUREEND,function(a){var b=a.feature.getGeometry(),c=b.getGeometries()[1];c=ol.geom.Polygon.fromCircle(c,64);a.feature=new ol.Feature(c);b=ngeo.interaction.MeasureAzimut.getAzimut(b.getGeometries()[0]);a.feature.set("azimut",b);h.handleDrawEnd(ngeo.GeometryType.CIRCLE,a)},h);ol.events.listen(e,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),h.handleActiveChange,
h)}}};ngeo.measureazimutDirective.$inject=["$compile","gettextCatalog","$filter","$injector"];ngeo.module.directive("ngeoMeasureazimut",ngeo.measureazimutDirective);ngeo.interaction.MeasureLength=function(a,b){b=void 0!==b?b:{};ngeo.interaction.Measure.call(this,b);void 0!==b.continueMsg?this.continueMsg=b.continueMsg:(this.continueMsg=document.createElement("span"),this.continueMsg.textContent="Click to continue drawing the line.",b=document.createElement("br"),b.textContent="Double-click or click last point to finish.",this.continueMsg.appendChild(b));this.format=a};ol.inherits(ngeo.interaction.MeasureLength,ngeo.interaction.Measure);
goog.exportSymbol("ngeo.interaction.MeasureLength",ngeo.interaction.MeasureLength);ngeo.interaction.MeasureLength.prototype.createDrawInteraction=function(a,b){return new ol.interaction.Draw({type:"LineString",source:b,style:a})};
ngeo.interaction.MeasureLength.prototype.handleMeasure=function(a){var b=goog.asserts.assertInstanceof(this.sketchFeature.getGeometry(),ol.geom.LineString),c=this.getMap().getView().getProjection();goog.asserts.assert(c);c=ngeo.interaction.Measure.getFormattedLength(b,c,this.precision,this.format);b=b.getLastCoordinate();a(c,b)};ngeo.measurelengthDirective=function(a,b,c,d){return{restrict:"A",require:"^^ngeoDrawfeature",link:function(e,f,g,h){f=b.getString("Click to start drawing line");g=b.getString("Click to continue drawing<br/>Double-click or click last point to finish");e=new ngeo.interaction.MeasureLength(c("ngeoUnitPrefix"),{style:new ol.style.Style,startMsg:a("<div translate>"+f+"</div>")(e)[0],continueMsg:a("<div translate>"+g+"</div>")(e)[0],precision:d.has("ngeoMeasurePrecision")?d.get("ngeoMeasurePrecision"):
void 0});h.registerInteraction(e);h.measureLength=e;ol.events.listen(e,ngeo.MeasureEventType.MEASUREEND,h.handleDrawEnd.bind(h,ngeo.GeometryType.LINE_STRING),h);ol.events.listen(e,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),h.handleActiveChange,h)}}};ngeo.measurelengthDirective.$inject=["$compile","gettextCatalog","$filter","$injector"];ngeo.module.directive("ngeoMeasurelength",ngeo.measurelengthDirective);ngeo.drawfeatureDirective=function(){return{controller:"ngeoDrawfeatureController as dfCtrl",scope:!0,bindToController:{active:"=ngeoDrawfeatureActive",features:"=?ngeoDrawfeatureFeatures",map:"=ngeoDrawfeatureMap",showMeasure:"=?ngeoDrawfeatureShowmeasure"}}};ngeo.module.directive("ngeoDrawfeature",ngeo.drawfeatureDirective);
ngeo.DrawfeatureController=function(a,b,c,d,e,f,g){var h=this;void 0===this.active&&(this.active=!1);this.gettextCatalog_=d;d.getString("Point");d.getString("LineString");d.getString("Polygon");d.getString("Circle");d.getString("Rectangle");d.getString("Text");this.ngeoDecorateInteraction_=e;this.featureHelper_=f;this.ngeoFeatures_=g;this.interactions_=[];a.$watch(function(){return h.active},function(a){!1===a&&h.interactions_.forEach(function(a){a.setActive(!1)},h)})};
ngeo.DrawfeatureController.$inject="$scope $compile $sce gettextCatalog ngeoDecorateInteraction ngeoFeatureHelper ngeoFeatures".split(" ");ngeo.DrawfeatureController.prototype.registerInteraction=function(a){this.interactions_.push(a);a.setActive(!1);this.ngeoDecorateInteraction_(a);this.map.addInteraction(a)};goog.exportProperty(ngeo.DrawfeatureController.prototype,"registerInteraction",ngeo.DrawfeatureController.prototype.registerInteraction);
ngeo.DrawfeatureController.prototype.handleActiveChange=function(a){this.active=this.interactions_.some(function(a){return a.getActive()},this)};goog.exportProperty(ngeo.DrawfeatureController.prototype,"handleActiveChange",ngeo.DrawfeatureController.prototype.handleActiveChange);
ngeo.DrawfeatureController.prototype.handleDrawEnd=function(a,b){var c=this.features||this.ngeoFeatures_,d=new ol.Feature(b.feature.getGeometry()),e=ngeo.FeatureProperties;switch(a){case ngeo.GeometryType.CIRCLE:d.set(e.IS_CIRCLE,!0);void 0!==b.feature.get("azimut")&&d.set(e.AZIMUT,b.feature.get("azimut"));break;case ngeo.GeometryType.TEXT:d.set(e.IS_TEXT,!0);break;case ngeo.GeometryType.RECTANGLE:d.set(e.IS_RECTANGLE,!0)}b=this.gettextCatalog_.getString(a);d.set(e.NAME,b+" "+(c.getLength()+1));d.set(e.COLOR,
a!==ngeo.GeometryType.TEXT?"#DB4436":"#000000");d.set(e.ANGLE,0);d.set(e.OPACITY,.2);d.set(e.SHOW_MEASURE,this.showMeasure?!0:!1);d.set(e.SHOW_LABEL,!1);d.set(e.SIZE,10);d.set(e.STROKE,2);this.featureHelper_.setStyle(d);c.push(d)};goog.exportProperty(ngeo.DrawfeatureController.prototype,"handleDrawEnd",ngeo.DrawfeatureController.prototype.handleDrawEnd);ngeo.module.controller("ngeoDrawfeatureController",ngeo.DrawfeatureController);ngeo.exportfeaturesDirective=function(){return{controller:"ngeoExportfeaturesController as efCtrl",scope:!0,bindToController:{features:"=ngeoExportfeaturesFeatures"}}};ngeo.module.directive("ngeoExportfeatures",ngeo.exportfeaturesDirective);
ngeo.ExportfeaturesController=function(a,b,c,d){var e=this;this.element_=a;var f=["ngeo-exportfeature",ol.getUid(this)].join("-");this.id_=f;this.featureHelper_=d;b=b.has("ngeoExportFeatureFormats")?b.get("ngeoExportFeatureFormats"):[ngeo.FeatureHelper.FormatType.KML];this.menu_=null;this.items_=[];if(1<b.length){a.attr("id",f);var g=$("<ul />",{"class":"dropdown-menu","aria-labelledby":f}).appendTo(a.parent()[0]);this.menu_=g;var h;b.forEach(function(a){h=$("<li />").appendTo(g).append($("<a />",
{href:"#",text:a}).on(["click",f].join("."),e.handleMenuItemClick_.bind(e,a)));e.items_.push(h)})}this.formats_=b;a.on(["click",f].join("."),this.handleElementClick_.bind(this));c.$on("$destroy",this.handleDestroy_.bind(this))};ngeo.ExportfeaturesController.$inject=["$element","$injector","$scope","ngeoFeatureHelper"];
ngeo.ExportfeaturesController.prototype.handleElementClick_=function(){var a=this,b=this.features.getArray();if(1===this.formats_.length)this.featureHelper_.export(b,this.formats_[0]);else if(1===b.length){var c=b[0].getGeometry(),d;this.formats_.forEach(function(b,f){d=a.items_[f];b===ngeo.FeatureHelper.FormatType.GPX&&(c instanceof ol.geom.Point||c instanceof ol.geom.LineString?d.removeClass("disabled"):d.addClass("disabled"))})}};
ngeo.ExportfeaturesController.prototype.handleMenuItemClick_=function(a,b){$(b.target.parentElement).hasClass("disabled")||(b=this.features.getArray(),this.featureHelper_.export(b,a))};ngeo.ExportfeaturesController.prototype.handleDestroy_=function(){var a=this.id_;this.element_.off(["click",a].join("."));this.menu_&&(this.menu_.remove(),this.items_.forEach(function(b){b.off(["click",a].join("."))},this),this.items_.length=0,this.menu_=null)};
ngeo.module.controller("ngeoExportfeaturesController",ngeo.ExportfeaturesController);ol.interaction.ModifyEventType={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};ol.interaction.Modify=function(a){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.Modify.handleDownEvent_,handleDragEvent:ol.interaction.Modify.handleDragEvent_,handleEvent:ol.interaction.Modify.handleEvent,handleUpEvent:ol.interaction.Modify.handleUpEvent_});this.condition_=a.condition?a.condition:ol.events.condition.primaryAction;this.defaultDeleteCondition_=function(a){return ol.events.condition.altKeyOnly(a)&&ol.events.condition.singleClick(a)};this.deleteCondition_=a.deleteCondition?
a.deleteCondition:this.defaultDeleteCondition_;this.insertVertexCondition_=a.insertVertexCondition?a.insertVertexCondition:ol.events.condition.always;this.vertexSegments_=this.vertexFeature_=null;this.lastPixel_=[0,0];this.modified_=this.ignoreNextSingleClick_=!1;this.rBush_=new ol.structs.RBush;this.pixelTolerance_=void 0!==a.pixelTolerance?a.pixelTolerance:10;this.changingFeature_=this.snappedToVertex_=!1;this.dragSegments_=[];this.overlay_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,
wrapX:!!a.wrapX}),style:a.style?a.style:ol.interaction.Modify.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0});this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_};
this.source_=null;a.source?(this.source_=a.source,a=new ol.Collection(this.source_.getFeatures()),ol.events.listen(this.source_,ol.source.VectorEventType.ADDFEATURE,this.handleSourceAdd_,this),ol.events.listen(this.source_,ol.source.VectorEventType.REMOVEFEATURE,this.handleSourceRemove_,this)):a=a.features;if(!a)throw Error("The modify interaction requires features or a source");this.features_=a;this.features_.forEach(this.addFeature_,this);ol.events.listen(this.features_,ol.CollectionEventType.ADD,
this.handleFeatureAdd_,this);ol.events.listen(this.features_,ol.CollectionEventType.REMOVE,this.handleFeatureRemove_,this);this.lastPointerEvent_=null};ol.inherits(ol.interaction.Modify,ol.interaction.Pointer);ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX=0;ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX=1;
ol.interaction.Modify.prototype.addFeature_=function(a){var b=a.getGeometry();b&&b.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[b.getType()].call(this,a,b);(b=this.getMap())&&b.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,b);ol.events.listen(a,ol.events.EventType.CHANGE,this.handleFeatureChange_,this)};
ol.interaction.Modify.prototype.willModifyFeatures_=function(a){this.modified_||(this.modified_=!0,this.dispatchEvent(new ol.interaction.Modify.Event(ol.interaction.ModifyEventType.MODIFYSTART,this.features_,a)))};
ol.interaction.Modify.prototype.removeFeature_=function(a){this.removeFeatureSegmentData_(a);this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);ol.events.unlisten(a,ol.events.EventType.CHANGE,this.handleFeatureChange_,this)};ol.interaction.Modify.prototype.removeFeatureSegmentData_=function(a){var b=this.rBush_,c=[];b.forEach(function(b){a===b.feature&&c.push(b)});for(var d=c.length-1;0<=d;--d)b.remove(c[d])};
ol.interaction.Modify.prototype.setActive=function(a){this.vertexFeature_&&!a&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);ol.interaction.Pointer.prototype.setActive.call(this,a)};ol.interaction.Modify.prototype.setMap=function(a){this.overlay_.setMap(a);ol.interaction.Pointer.prototype.setMap.call(this,a)};ol.interaction.Modify.prototype.handleSourceAdd_=function(a){a.feature&&this.features_.push(a.feature)};
ol.interaction.Modify.prototype.handleSourceRemove_=function(a){a.feature&&this.features_.remove(a.feature)};ol.interaction.Modify.prototype.handleFeatureAdd_=function(a){this.addFeature_(a.element)};ol.interaction.Modify.prototype.handleFeatureChange_=function(a){this.changingFeature_||(a=a.target,this.removeFeature_(a),this.addFeature_(a))};ol.interaction.Modify.prototype.handleFeatureRemove_=function(a){this.removeFeature_(a.element)};
ol.interaction.Modify.prototype.writePointGeometry_=function(a,b){var c=b.getCoordinates();a={feature:a,geometry:b,segment:[c,c]};this.rBush_.insert(b.getExtent(),a)};ol.interaction.Modify.prototype.writeMultiPointGeometry_=function(a,b){var c=b.getCoordinates(),d;var e=0;for(d=c.length;e<d;++e){var f=c[e];f={feature:a,geometry:b,depth:[e],index:e,segment:[f,f]};this.rBush_.insert(b.getExtent(),f)}};
ol.interaction.Modify.prototype.writeLineStringGeometry_=function(a,b){var c=b.getCoordinates(),d;var e=0;for(d=c.length-1;e<d;++e){var f=c.slice(e,e+2);var g={feature:a,geometry:b,index:e,segment:f};this.rBush_.insert(ol.extent.boundingExtent(f),g)}};
ol.interaction.Modify.prototype.writeMultiLineStringGeometry_=function(a,b){var c=b.getCoordinates(),d,e;var f=0;for(e=c.length;f<e;++f){var g=c[f];var h=0;for(d=g.length-1;h<d;++h){var k=g.slice(h,h+2);var l={feature:a,geometry:b,depth:[f],index:h,segment:k};this.rBush_.insert(ol.extent.boundingExtent(k),l)}}};
ol.interaction.Modify.prototype.writePolygonGeometry_=function(a,b){var c=b.getCoordinates(),d,e;var f=0;for(e=c.length;f<e;++f){var g=c[f];var h=0;for(d=g.length-1;h<d;++h){var k=g.slice(h,h+2);var l={feature:a,geometry:b,depth:[f],index:h,segment:k};this.rBush_.insert(ol.extent.boundingExtent(k),l)}}};
ol.interaction.Modify.prototype.writeMultiPolygonGeometry_=function(a,b){var c=b.getCoordinates(),d,e,f;var g=0;for(f=c.length;g<f;++g){var h=c[g];var k=0;for(e=h.length;k<e;++k){var l=h[k];var m=0;for(d=l.length-1;m<d;++m){var n=l.slice(m,m+2);var p={feature:a,geometry:b,depth:[k,g],index:m,segment:n};this.rBush_.insert(ol.extent.boundingExtent(n),p)}}}};
ol.interaction.Modify.prototype.writeCircleGeometry_=function(a,b){var c=b.getCenter(),d={feature:a,geometry:b,index:ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX,segment:[c,c]};a={feature:a,geometry:b,index:ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX,segment:[c,c]};d.featureSegments=a.featureSegments=[d,a];this.rBush_.insert(ol.extent.createOrUpdateFromCoordinate(c),d);this.rBush_.insert(b.getExtent(),a)};
ol.interaction.Modify.prototype.writeGeometryCollectionGeometry_=function(a,b){var c=b.getGeometriesArray();for(b=0;b<c.length;++b)this.SEGMENT_WRITERS_[c[b].getType()].call(this,a,c[b])};ol.interaction.Modify.prototype.createOrUpdateVertexFeature_=function(a){var b=this.vertexFeature_;b?b.getGeometry().setCoordinates(a):(this.vertexFeature_=b=new ol.Feature(new ol.geom.Point(a)),this.overlay_.getSource().addFeature(b));return b};
ol.interaction.Modify.compareIndexes_=function(a,b){return a.index-b.index};
ol.interaction.Modify.handleDownEvent_=function(a){if(!this.condition_(a))return!1;this.handlePointerAtPixel_(a.pixel,a.map);var b=a.map.getCoordinateFromPixel(a.pixel);this.dragSegments_.length=0;this.modified_=!1;var c=this.vertexFeature_;if(c){var d=[];c=c.getGeometry().getCoordinates();var e=ol.extent.boundingExtent([c]);e=this.rBush_.getInExtent(e);var f={};e.sort(ol.interaction.Modify.compareIndexes_);for(var g=0,h=e.length;g<h;++g){var k=e[g],l=k.segment,m=ol.getUid(k.feature),n=k.depth;n&&
(m+="-"+n.join("-"));f[m]||(f[m]=Array(2));if(k.geometry.getType()===ol.geom.GeometryType.CIRCLE&&k.index===ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX)l=ol.interaction.Modify.closestOnSegmentData_(b,k),ol.coordinate.equals(l,c)&&!f[m][0]&&(this.dragSegments_.push([k,0]),f[m][0]=k);else if(ol.coordinate.equals(l[0],c)&&!f[m][0])this.dragSegments_.push([k,0]),f[m][0]=k;else if(ol.coordinate.equals(l[1],c)&&!f[m][1]){if(k.geometry.getType()!==ol.geom.GeometryType.LINE_STRING&&k.geometry.getType()!==
ol.geom.GeometryType.MULTI_LINE_STRING||!f[m][0]||0!==f[m][0].index)this.dragSegments_.push([k,1]),f[m][1]=k}else this.insertVertexCondition_(a)&&ol.getUid(l)in this.vertexSegments_&&!f[m][0]&&!f[m][1]&&d.push([k,c])}d.length&&this.willModifyFeatures_(a);for(a=d.length-1;0<=a;--a)this.insertVertex_.apply(this,d[a])}return!!this.vertexFeature_};
ol.interaction.Modify.handleDragEvent_=function(a){this.ignoreNextSingleClick_=!1;this.willModifyFeatures_(a);a=a.coordinate;for(var b=0,c=this.dragSegments_.length;b<c;++b){var d=this.dragSegments_[b],e=d[0],f=e.depth,g=e.geometry,h=e.segment;for(d=d[1];a.length<g.getStride();)a.push(h[d][a.length]);switch(g.getType()){case ol.geom.GeometryType.POINT:var k=a;h[0]=h[1]=a;break;case ol.geom.GeometryType.MULTI_POINT:k=g.getCoordinates();k[e.index]=a;h[0]=h[1]=a;break;case ol.geom.GeometryType.LINE_STRING:k=
g.getCoordinates();k[e.index+d]=a;h[d]=a;break;case ol.geom.GeometryType.MULTI_LINE_STRING:k=g.getCoordinates();k[f[0]][e.index+d]=a;h[d]=a;break;case ol.geom.GeometryType.POLYGON:k=g.getCoordinates();k[f[0]][e.index+d]=a;h[d]=a;break;case ol.geom.GeometryType.MULTI_POLYGON:k=g.getCoordinates();k[f[1]][f[0]][e.index+d]=a;h[d]=a;break;case ol.geom.GeometryType.CIRCLE:h[0]=h[1]=a,e.index===ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CENTER_INDEX?(this.changingFeature_=!0,g.setCenter(a)):(this.changingFeature_=
!0,g.setRadius(ol.coordinate.distance(g.getCenter(),a))),this.changingFeature_=!1}k&&this.setGeometryCoordinates_(g,k)}this.createOrUpdateVertexFeature_(a)};
ol.interaction.Modify.handleUpEvent_=function(a){for(var b,c,d=this.dragSegments_.length-1;0<=d;--d)if(b=this.dragSegments_[d][0],c=b.geometry,c.getType()===ol.geom.GeometryType.CIRCLE){var e=c.getCenter(),f=b.featureSegments[0];b=b.featureSegments[1];f.segment[0]=f.segment[1]=e;b.segment[0]=b.segment[1]=e;this.rBush_.update(ol.extent.createOrUpdateFromCoordinate(e),f);this.rBush_.update(c.getExtent(),b)}else this.rBush_.update(ol.extent.boundingExtent(b.segment),b);this.modified_&&(this.dispatchEvent(new ol.interaction.Modify.Event(ol.interaction.ModifyEventType.MODIFYEND,
this.features_,a)),this.modified_=!1);return!1};
ol.interaction.Modify.handleEvent=function(a){if(!(a instanceof ol.MapBrowserPointerEvent))return!0;this.lastPointerEvent_=a;var b;a.map.getView().getInteracting()||a.type!=ol.MapBrowserEventType.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(a);this.vertexFeature_&&this.deleteCondition_(a)&&(b=a.type==ol.MapBrowserEventType.SINGLECLICK&&this.ignoreNextSingleClick_?!0:this.removePoint());a.type==ol.MapBrowserEventType.SINGLECLICK&&(this.ignoreNextSingleClick_=!1);return ol.interaction.Pointer.handleEvent.call(this,
a)&&!b};ol.interaction.Modify.prototype.handlePointerMove_=function(a){this.lastPixel_=a.pixel;this.handlePointerAtPixel_(a.pixel,a.map)};
ol.interaction.Modify.prototype.handlePointerAtPixel_=function(a,b){var c=b.getCoordinateFromPixel(a),d=function(a,b){return ol.interaction.Modify.pointDistanceToSegmentDataSquared_(c,a)-ol.interaction.Modify.pointDistanceToSegmentDataSquared_(c,b)},e=ol.extent.buffer(ol.extent.createOrUpdateFromCoordinate(c),b.getView().getResolution()*this.pixelTolerance_);e=this.rBush_.getInExtent(e);if(0<e.length){e.sort(d);var f=e[0];d=f.segment;var g=ol.interaction.Modify.closestOnSegmentData_(c,f),h=b.getPixelFromCoordinate(g),
k=ol.coordinate.distance(a,h);if(k<=this.pixelTolerance_){a={};if(f.geometry.getType()===ol.geom.GeometryType.CIRCLE&&f.index===ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(g);else for(k=b.getPixelFromCoordinate(d[0]),f=b.getPixelFromCoordinate(d[1]),b=ol.coordinate.squaredDistance(h,k),h=ol.coordinate.squaredDistance(h,f),k=Math.sqrt(Math.min(b,h)),(this.snappedToVertex_=k<=this.pixelTolerance_)&&(g=b>h?d[1]:d[0]),this.createOrUpdateVertexFeature_(g),
b=1,h=e.length;b<h;++b)if(g=e[b].segment,ol.coordinate.equals(d[0],g[0])&&ol.coordinate.equals(d[1],g[1])||ol.coordinate.equals(d[0],g[1])&&ol.coordinate.equals(d[1],g[0]))a[ol.getUid(g)]=!0;else break;a[ol.getUid(d)]=!0;this.vertexSegments_=a;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)};
ol.interaction.Modify.pointDistanceToSegmentDataSquared_=function(a,b){var c=b.geometry;return c.getType()===ol.geom.GeometryType.CIRCLE&&b.index===ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX?(a=ol.coordinate.squaredDistance(c.getCenter(),a),c=Math.sqrt(a)-c.getRadius(),c*c):ol.coordinate.squaredDistanceToSegment(a,b.segment)};
ol.interaction.Modify.closestOnSegmentData_=function(a,b){var c=b.geometry;return c.getType()===ol.geom.GeometryType.CIRCLE&&b.index===ol.interaction.Modify.MODIFY_SEGMENT_CIRCLE_CIRCUMFERENCE_INDEX?c.getClosestPoint(a):ol.coordinate.closestOnSegment(a,b.segment)};
ol.interaction.Modify.prototype.insertVertex_=function(a,b){for(var c=a.segment,d=a.feature,e=a.geometry,f=a.depth,g=a.index,h;b.length<e.getStride();)b.push(0);switch(e.getType()){case ol.geom.GeometryType.MULTI_LINE_STRING:h=e.getCoordinates();h[f[0]].splice(g+1,0,b);break;case ol.geom.GeometryType.POLYGON:h=e.getCoordinates();h[f[0]].splice(g+1,0,b);break;case ol.geom.GeometryType.MULTI_POLYGON:h=e.getCoordinates();h[f[1]][f[0]].splice(g+1,0,b);break;case ol.geom.GeometryType.LINE_STRING:h=e.getCoordinates();
h.splice(g+1,0,b);break;default:return}this.setGeometryCoordinates_(e,h);h=this.rBush_;h.remove(a);this.updateSegmentIndices_(e,g,f,1);a={segment:[c[0],b],feature:d,geometry:e,depth:f,index:g};h.insert(ol.extent.boundingExtent(a.segment),a);this.dragSegments_.push([a,1]);b={segment:[b,c[1]],feature:d,geometry:e,depth:f,index:g+1};h.insert(ol.extent.boundingExtent(b.segment),b);this.dragSegments_.push([b,0]);this.ignoreNextSingleClick_=!0};
ol.interaction.Modify.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=ol.MapBrowserEventType.POINTERDRAG){var a=this.lastPointerEvent_;this.willModifyFeatures_(a);this.removeVertex_();this.dispatchEvent(new ol.interaction.Modify.Event(ol.interaction.ModifyEventType.MODIFYEND,this.features_,a));this.modified_=!1;return!0}return!1};
ol.interaction.Modify.prototype.removeVertex_=function(){var a=this.dragSegments_,b={},c=!1,d,e;for(e=a.length-1;0<=e;--e){var f=a[e];var g=f[0];var h=ol.getUid(g.feature);g.depth&&(h+="-"+g.depth.join("-"));h in b||(b[h]={});0===f[1]?(b[h].right=g,b[h].index=g.index):1==f[1]&&(b[h].left=g,b[h].index=g.index+1)}for(h in b){var k=b[h].right;var l=b[h].left;e=b[h].index;var m=e-1;g=void 0!==l?l:k;0>m&&(m=0);f=g.geometry;var n=d=f.getCoordinates();c=!1;switch(f.getType()){case ol.geom.GeometryType.MULTI_LINE_STRING:2<
d[g.depth[0]].length&&(d[g.depth[0]].splice(e,1),c=!0);break;case ol.geom.GeometryType.LINE_STRING:2<d.length&&(d.splice(e,1),c=!0);break;case ol.geom.GeometryType.MULTI_POLYGON:n=n[g.depth[1]];case ol.geom.GeometryType.POLYGON:n=n[g.depth[0]],4<n.length&&(e==n.length-1&&(e=0),n.splice(e,1),c=!0,0===e&&(n.pop(),n.push(n[0]),m=n.length-1))}c&&(this.setGeometryCoordinates_(f,d),n=[],void 0!==l&&(this.rBush_.remove(l),n.push(l.segment[0])),void 0!==k&&(this.rBush_.remove(k),n.push(k.segment[1])),void 0!==
l&&void 0!==k&&(l={depth:g.depth,feature:g.feature,geometry:g.geometry,index:m,segment:n},this.rBush_.insert(ol.extent.boundingExtent(l.segment),l)),this.updateSegmentIndices_(f,e,g.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),a.length=0)}return c};ol.interaction.Modify.prototype.setGeometryCoordinates_=function(a,b){this.changingFeature_=!0;a.setCoordinates(b);this.changingFeature_=!1};
ol.interaction.Modify.prototype.updateSegmentIndices_=function(a,b,c,d){this.rBush_.forEachInExtent(a.getExtent(),function(e){e.geometry===a&&(void 0===c||void 0===e.depth||ol.array.equals(e.depth,c))&&e.index>b&&(e.index+=d)})};ol.interaction.Modify.getDefaultStyleFunction=function(){var a=ol.style.Style.createDefaultEditing();return function(b,c){return a[ol.geom.GeometryType.POINT]}};ol.interaction.Modify.Event=function(a,b,c){ol.events.Event.call(this,a);this.features=b;this.mapBrowserEvent=c};
ol.inherits(ol.interaction.Modify.Event,ol.events.Event);ngeo.interaction.ModifyCircle=function(a){goog.asserts.assert(a.features);ol.interaction.Pointer.call(this,{handleDownEvent:ngeo.interaction.ModifyCircle.handleDownEvent_,handleDragEvent:ngeo.interaction.ModifyCircle.handleDragEvent_,handleEvent:ngeo.interaction.ModifyCircle.handleEvent,handleUpEvent:ngeo.interaction.ModifyCircle.handleUpEvent_});this.vertexFeature_=null;this.lastPixel_=[0,0];this.modified_=!1;this.rBush_=new ol.structs.RBush;this.pixelTolerance_=void 0!==a.pixelTolerance?a.pixelTolerance:
10;this.changingFeature_=this.snappedToVertex_=!1;this.dragSegments_=null;this.overlay_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,wrapX:!!a.wrapX}),style:a.style?a.style:ngeo.interaction.ModifyCircle.getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0});this.features_=a.features;this.features_.forEach(this.addFeature_,this);ol.events.listen(this.features_,ol.CollectionEventType.ADD,this.handleFeatureAdd_,this);ol.events.listen(this.features_,ol.CollectionEventType.REMOVE,
this.handleFeatureRemove_,this)};ol.inherits(ngeo.interaction.ModifyCircle,ol.interaction.Pointer);goog.exportSymbol("ngeo.interaction.ModifyCircle",ngeo.interaction.ModifyCircle);ngeo.interaction.ModifyCircle.prototype.addFeature_=function(a){if(a.getGeometry().getType()===ol.geom.GeometryType.POLYGON&&a.get(ngeo.FeatureProperties.IS_CIRCLE)){var b=a.getGeometry();this.writeCircleGeometry_(a,b);(a=this.getMap())&&this.handlePointerAtPixel_(this.lastPixel_,a)}};
ngeo.interaction.ModifyCircle.prototype.willModifyFeatures_=function(a){this.modified_||(this.modified_=!0,this.dispatchEvent(new ol.interaction.Modify.Event(ol.interaction.ModifyEventType.MODIFYSTART,this.features_,a)))};ngeo.interaction.ModifyCircle.prototype.removeFeature_=function(a){this.removeFeatureSegmentData_(a);this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)};
ngeo.interaction.ModifyCircle.prototype.removeFeatureSegmentData_=function(a){var b=this.rBush_,c=[];b.forEach(function(b){a===b.feature&&c.push(b)});for(var d=c.length-1;0<=d;--d)b.remove(c[d])};ngeo.interaction.ModifyCircle.prototype.setMap=function(a){this.overlay_.setMap(a);ol.interaction.Pointer.prototype.setMap.call(this,a)};ngeo.interaction.ModifyCircle.prototype.handleFeatureAdd_=function(a){a=a.element;goog.asserts.assertInstanceof(a,ol.Feature,"feature should be an ol.Feature");this.addFeature_(a)};
ngeo.interaction.ModifyCircle.prototype.handleFeatureRemove_=function(a){this.removeFeature_(a.element)};ngeo.interaction.ModifyCircle.prototype.writeCircleGeometry_=function(a,b){var c=b.getCoordinates(),d,e;var f=0;for(e=c.length;f<e;++f){var g=c[f];var h=0;for(d=g.length-1;h<d;++h){var k=g.slice(h,h+2);var l={feature:a,geometry:b,depth:[f],index:h,segment:k};this.rBush_.insert(ol.extent.boundingExtent(k),l)}}};
ngeo.interaction.ModifyCircle.prototype.createOrUpdateVertexFeature_=function(a){var b=this.vertexFeature_;b?b.getGeometry().setCoordinates(a):(this.vertexFeature_=b=new ol.Feature(new ol.geom.Point(a)),this.overlay_.getSource().addFeature(b));return b};ngeo.interaction.ModifyCircle.compareIndexes_=function(a,b){return a.index-b.index};
ngeo.interaction.ModifyCircle.handleDownEvent_=function(a){this.handlePointerAtPixel_(a.pixel,a.map);this.dragSegments_=[];this.modified_=!1;if(a=this.vertexFeature_){a=a.getGeometry().getCoordinates();var b=ol.extent.boundingExtent([a]);b=this.rBush_.getInExtent(b);var c={};b.sort(ngeo.interaction.ModifyCircle.compareIndexes_);for(var d=0,e=b.length;d<e;++d){var f=b[d],g=f.segment,h=ol.getUid(f.feature),k=f.depth;k&&(h+="-"+k.join("-"));c[h]||(c[h]=Array(2));ol.coordinate.equals(g[0],a)&&!c[h][0]?
(this.dragSegments_.push([f,0]),c[h][0]=f):ol.coordinate.equals(g[1],a)&&!c[h][1]&&(this.dragSegments_.push([f,1]),c[h][1]=f)}}return!!this.vertexFeature_};
ngeo.interaction.ModifyCircle.handleDragEvent_=function(a){this.willModifyFeatures_(a);a=a.coordinate;var b=this.dragSegments_[0][0].geometry,c=ol.extent.getCenter(b.getExtent()),d=new ol.geom.LineString([c,a]);c=new ol.geom.Circle(c,d.getLength());c=ol.geom.Polygon.fromCircle(c,64).getCoordinates();this.setGeometryCoordinates_(b,c);b=ngeo.interaction.MeasureAzimut.getAzimut(d);this.features_.getArray()[0].set(ngeo.FeatureProperties.AZIMUT,b);this.createOrUpdateVertexFeature_(a)};
ngeo.interaction.ModifyCircle.handleUpEvent_=function(a){this.rBush_.clear();this.writeCircleGeometry_(this.dragSegments_[0][0].feature,this.dragSegments_[0][0].geometry);this.modified_&&(this.dispatchEvent(new ol.interaction.Modify.Event(ol.interaction.ModifyEventType.MODIFYEND,this.features_,a)),this.modified_=!1);return!1};
ngeo.interaction.ModifyCircle.handleEvent=function(a){if(!(a instanceof ol.MapBrowserPointerEvent))return!0;a.map.getView().getHints()[ol.ViewHint.INTERACTING]||a.type!=ol.MapBrowserEventType.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(a);return ol.interaction.Pointer.handleEvent.call(this,a)&&!0};ngeo.interaction.ModifyCircle.prototype.handlePointerMove_=function(a){this.lastPixel_=a.pixel;this.handlePointerAtPixel_(a.pixel,a.map)};
ngeo.interaction.ModifyCircle.prototype.handlePointerAtPixel_=function(a,b){var c=b.getCoordinateFromPixel(a),d=function(a,b){return ol.coordinate.squaredDistanceToSegment(c,a.segment)-ol.coordinate.squaredDistanceToSegment(c,b.segment)},e=b.getCoordinateFromPixel([a[0]-this.pixelTolerance_,a[1]+this.pixelTolerance_]),f=b.getCoordinateFromPixel([a[0]+this.pixelTolerance_,a[1]-this.pixelTolerance_]);e=ol.extent.boundingExtent([e,f]);e=this.rBush_.getInExtent(e);if(0<e.length&&(e.sort(d),d=e[0].segment,
f=ol.coordinate.closestOnSegment(c,d),f=b.getPixelFromCoordinate(f),Math.sqrt(ol.coordinate.squaredDistance(a,f))<=this.pixelTolerance_&&(a=b.getPixelFromCoordinate(d[0]),b=b.getPixelFromCoordinate(d[1]),a=ol.coordinate.squaredDistance(f,a),b=ol.coordinate.squaredDistance(f,b),this.snappedToVertex_=Math.sqrt(Math.min(a,b))<=this.pixelTolerance_))){f=a>b?d[1]:d[0];this.createOrUpdateVertexFeature_(f);ol.getUid(d);a=1;for(f=e.length;a<f;++a)if(b=e[a].segment,ol.coordinate.equals(d[0],b[0])&&ol.coordinate.equals(d[1],
b[1])||ol.coordinate.equals(d[0],b[1])&&ol.coordinate.equals(d[1],b[0]))ol.getUid(b);else break;return}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)};ngeo.interaction.ModifyCircle.prototype.setGeometryCoordinates_=function(a,b){this.changingFeature_=!0;a.setCoordinates(b);this.changingFeature_=!1};ngeo.interaction.ModifyCircle.getDefaultStyleFunction=function(){var a=ol.style.Style.createDefaultEditing();return function(b,c){return a[ol.geom.GeometryType.POINT]}};ngeo.interaction.ModifyRectangle=function(a){goog.asserts.assert(a.features);ol.interaction.Pointer.call(this,{handleDownEvent:this.handleDown_,handleDragEvent:this.handleDrag_,handleUpEvent:this.handleUp_});this.modified_=!1;var b=a.style?a.style:ol.interaction.Modify.getDefaultStyleFunction();this.vectorPoints_=new ol.layer.Vector({source:new ol.source.Vector({wrapX:!!a.wrapX}),visible:this.getActive(),style:b,updateWhileAnimating:!0,updateWhileInteracting:!0});this.features_=a.features;this.feature_=
null;this.cache_={};this.params_=null;ol.events.listen(this.features_,ol.CollectionEventType.ADD,this.handleFeatureAdd_,this);ol.events.listen(this.features_,ol.CollectionEventType.REMOVE,this.handleFeatureRemove_,this);this.features_.forEach(this.addFeature_,this)};ol.inherits(ngeo.interaction.ModifyRectangle,ol.interaction.Pointer);goog.exportSymbol("ngeo.interaction.ModifyRectangle",ngeo.interaction.ModifyRectangle);
ngeo.interaction.ModifyRectangle.prototype.setActive=function(a){ol.interaction.Pointer.prototype.setActive.call(this,a);this.vectorPoints_&&this.vectorPoints_.setVisible(a)};
ngeo.interaction.ModifyRectangle.prototype.addFeature_=function(a){var b=a.getGeometry();if(b instanceof ol.geom.Polygon){var c=ol.getUid(a),d=this.cache_[c];if(!d){var e=this.vectorPoints_.getSource();for(b=b.getCoordinates()[0];4<b.length;)b[0][0]<b[1][0]&&b[0][1]<=b[1][1]?b.pop():b.shift();var f=[],g,h;b.forEach(function(b){g=new ol.geom.Point(b);h=new ol.Feature({corner:!0,geometry:g,siblingX:null,siblingY:null,boxFeature:a});f.push(h)},this);d={corners:f};this.cache_[c]=d;var k,l;f.forEach(function(a,
b){(k=f[b-1])||(k=f[f.length-1]);(l=f[b+1])||(l=f[0]);0===b%2?(a.set("siblingX",l),a.set("siblingY",k)):(a.set("siblingX",k),a.set("siblingY",l))},this);e.addFeatures(f)}}};ngeo.interaction.ModifyRectangle.prototype.willModifyFeatures_=function(a){this.modified_||(this.modified_=!0,this.dispatchEvent(new ol.interaction.Modify.Event(ol.interaction.ModifyEventType.MODIFYSTART,this.features_,a)),this.params_=this.initializeParams_())};
ngeo.interaction.ModifyRectangle.prototype.initializeParams_=function(){var a=this.feature_.get("siblingX");goog.asserts.assertInstanceof(a,ol.Feature);var b=a.get("siblingY");goog.asserts.assertInstanceof(b,ol.Feature);var c=b.getGeometry();goog.asserts.assertInstanceof(c,ol.geom.Point);c=c.getCoordinates();var d=this.getMap().getPixelFromCoordinate(c);b=b.get("siblingX");goog.asserts.assertInstanceof(b,ol.Feature);b=b.getGeometry();goog.asserts.assertInstanceof(b,ol.geom.Point);var e=b.getCoordinates();
e=this.getMap().getPixelFromCoordinate(e);e=[e[0]-d[0],e[1]-d[1]];var f=Math.sqrt(e[0]*e[0]+e[1]*e[1]);e[0]/=f;e[1]/=f;a=a.getGeometry();goog.asserts.assertInstanceof(a,ol.geom.Point);f=a.getCoordinates();f=this.getMap().getPixelFromCoordinate(f);f=[f[0]-d[0],f[1]-d[1]];var g=Math.sqrt(f[0]*f[0]+f[1]*f[1]);f[0]/=g;f[1]/=g;isNaN(e[0])&&isNaN(f[0])?(e=[0,1],f=[1,0]):isNaN(e[0])?e=[f[1],-f[0]]:isNaN(f[0])&&(f=[e[1],-e[0]]);return{originCoordinate:c,originPixel:d,siblingXPoint:b,siblingYPoint:a,vectorX:e,
vectorY:f}};ngeo.interaction.ModifyRectangle.prototype.removeFeature_=function(a){a=ol.getUid(a);for(var b=this.cache_[a].corners,c=0;c<b.length;c++)this.vectorPoints_.getSource().removeFeature(b[c]);this.feature_=null;b.length=0;delete this.cache_[a]};ngeo.interaction.ModifyRectangle.prototype.setMap=function(a){this.vectorPoints_.setMap(a);ol.interaction.Pointer.prototype.setMap.call(this,a)};
ngeo.interaction.ModifyRectangle.prototype.handleFeatureAdd_=function(a){a=a.element;goog.asserts.assertInstanceof(a,ol.Feature,"feature should be an ol.Feature");this.addFeature_(a)};ngeo.interaction.ModifyRectangle.prototype.handleFeatureRemove_=function(a){this.removeFeature_(a.element)};ngeo.interaction.ModifyRectangle.prototype.handleDown_=function(a){return(a=a.map.forEachFeatureAtPixel(a.pixel,function(a){return a.get("siblingX")&&a.get("siblingY")?a:void 0}))?(this.feature_=a,!0):!1};
ngeo.interaction.ModifyRectangle.prototype.handleDrag_=function(a){this.willModifyFeatures_(a);var b=this.feature_,c=b.getGeometry();if(c instanceof ol.geom.Point){c.setCoordinates(a.coordinate);var d=a.pixel,e=this.params_.originPixel,f=this.params_.siblingXPoint,g=this.params_.siblingYPoint,h=this.params_.vectorY;c=this.params_.originCoordinate;var k=this.calculateNewPixel_(e,d,this.params_.vectorX);k=this.getMap().getCoordinateFromPixel(k);f.setCoordinates(k);d=this.calculateNewPixel_(e,d,h);d=
this.getMap().getCoordinateFromPixel(d);g.setCoordinates(d);b=b.get("boxFeature").getGeometry();goog.asserts.assertInstanceof(b,ol.geom.Polygon);b.setCoordinates([[a.coordinate,k,c,d,a.coordinate]])}};ngeo.interaction.ModifyRectangle.prototype.calculateNewPixel_=function(a,b,c){b=[b[0]-a[0],b[1]-a[1]];b=b[0]*c[0]+b[1]*c[1];c=[c[0]*b,c[1]*b];return[c[0]+a[0],c[1]+a[1]]};
ngeo.interaction.ModifyRectangle.prototype.handleUp_=function(a){this.modified_&&(this.dispatchEvent(new ol.interaction.Modify.Event(ol.interaction.ModifyEventType.MODIFYEND,this.features_,a)),this.params_=null,this.modified_=!1);return!1};ngeo.interaction.Modify=function(a){goog.asserts.assert(a.features);this.features_=a.features;this.listenerKeys_=[];this.interactions_=[];this.otherFeatures_=new ol.Collection;this.interactions_.push(new ol.interaction.Modify({deleteCondition:ngeo.utils.deleteCondition,features:this.otherFeatures_,pixelTolerance:a.pixelTolerance,style:a.style,wrapX:a.wrapX}));this.circleFeatures_=new ol.Collection;this.interactions_.push(new ngeo.interaction.ModifyCircle({features:this.circleFeatures_,pixelTolerance:a.pixelTolerance,
style:a.style,wrapX:a.wrapX}));this.rectangleFeatures_=new ol.Collection;this.interactions_.push(new ngeo.interaction.ModifyRectangle({features:this.rectangleFeatures_,pixelTolerance:a.pixelTolerance,style:a.style,wrapX:a.wrapX}));ol.interaction.Interaction.call(this,{handleEvent:ol.functions.TRUE})};ol.inherits(ngeo.interaction.Modify,ol.interaction.Interaction);goog.exportSymbol("ngeo.interaction.Modify",ngeo.interaction.Modify);
ngeo.interaction.Modify.prototype.setActive=function(a){ol.interaction.Interaction.prototype.setActive.call(this,a);this.setState_()};goog.exportProperty(ngeo.interaction.Modify.prototype,"setActive",ngeo.interaction.Modify.prototype.setActive);
ngeo.interaction.Modify.prototype.setMap=function(a){var b=this.interactions_,c=this.getMap();c&&b.forEach(function(a){c.removeInteraction(a)},this);ol.interaction.Interaction.prototype.setMap.call(this,a);a&&b.forEach(function(b){a.addInteraction(b)},this);this.setState_()};
ngeo.interaction.Modify.prototype.setState_=function(){var a=this.getMap(),b=this.getActive(),c=this.listenerKeys_;this.interactions_.forEach(function(c){c.setActive(b&&!!a)},this);b&&a?(this.features_.forEach(this.addFeature_,this),c.push(ol.events.listen(this.features_,ol.CollectionEventType.ADD,this.handleFeaturesAdd_,this)),c.push(ol.events.listen(this.features_,ol.CollectionEventType.REMOVE,this.handleFeaturesRemove_,this))):(c.forEach(function(a){ol.events.unlistenByKey(a)},this),this.features_.forEach(this.removeFeature_,
this))};ngeo.interaction.Modify.prototype.handleFeaturesAdd_=function(a){a=a.element;goog.asserts.assertInstanceof(a,ol.Feature,"feature should be an ol.Feature");this.addFeature_(a)};ngeo.interaction.Modify.prototype.handleFeaturesRemove_=function(a){this.removeFeature_(a.element)};ngeo.interaction.Modify.prototype.addFeature_=function(a){this.getFeatureCollection_(a).push(a)};ngeo.interaction.Modify.prototype.removeFeature_=function(a){this.getFeatureCollection_(a).remove(a)};
ngeo.interaction.Modify.prototype.getFeatureCollection_=function(a){var b=a.get(ngeo.FeatureProperties.IS_CIRCLE);a=a.get(ngeo.FeatureProperties.IS_RECTANGLE);return!0===b||"true"===b?this.circleFeatures_:!0===a||"true"===a?this.rectangleFeatures_:this.otherFeatures_};goog.events.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,
Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,
SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255};
goog.events.KeyCodes.isTextModifyingKeyEvent=function(a){if(a.altKey&&!a.ctrlKey||a.metaKey||a.keyCode>=goog.events.KeyCodes.F1&&a.keyCode<=goog.events.KeyCodes.F12)return!1;switch(a.keyCode){case goog.events.KeyCodes.ALT:case goog.events.KeyCodes.CAPS_LOCK:case goog.events.KeyCodes.CONTEXT_MENU:case goog.events.KeyCodes.CTRL:case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.END:case goog.events.KeyCodes.ESC:case goog.events.KeyCodes.HOME:case goog.events.KeyCodes.INSERT:case goog.events.KeyCodes.LEFT:case goog.events.KeyCodes.MAC_FF_META:case goog.events.KeyCodes.META:case goog.events.KeyCodes.NUMLOCK:case goog.events.KeyCodes.NUM_CENTER:case goog.events.KeyCodes.PAGE_DOWN:case goog.events.KeyCodes.PAGE_UP:case goog.events.KeyCodes.PAUSE:case goog.events.KeyCodes.PHANTOM:case goog.events.KeyCodes.PRINT_SCREEN:case goog.events.KeyCodes.RIGHT:case goog.events.KeyCodes.SCROLL_LOCK:case goog.events.KeyCodes.SHIFT:case goog.events.KeyCodes.UP:case goog.events.KeyCodes.VK_NONAME:case goog.events.KeyCodes.WIN_KEY:case goog.events.KeyCodes.WIN_KEY_RIGHT:return!1;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return!goog.userAgent.GECKO;
default:return a.keyCode<goog.events.KeyCodes.FIRST_MEDIA_KEY||a.keyCode>goog.events.KeyCodes.LAST_MEDIA_KEY}};
goog.events.KeyCodes.firesKeyPressEvent=function(a,b,c,d,e,f){if(!(goog.userAgent.IE||goog.userAgent.EDGE||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525")))return!0;if(goog.userAgent.MAC&&e)return goog.events.KeyCodes.isCharacterKey(a);if(e&&!d)return!1;goog.isNumber(b)&&(b=goog.events.KeyCodes.normalizeKeyCode(b));e=b==goog.events.KeyCodes.CTRL||b==goog.events.KeyCodes.ALT||goog.userAgent.MAC&&b==goog.events.KeyCodes.META;f=b==goog.events.KeyCodes.SHIFT&&(d||f);if((!c||goog.userAgent.MAC)&&
e||goog.userAgent.MAC&&f)return!1;if((goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&d&&c)switch(a){case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:case goog.events.KeyCodes.TILDE:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:return!1}if(goog.userAgent.IE&&
d&&b==a)return!1;switch(a){case goog.events.KeyCodes.ENTER:return!0;case goog.events.KeyCodes.ESC:return!(goog.userAgent.WEBKIT||goog.userAgent.EDGE)}return goog.events.KeyCodes.isCharacterKey(a)};
goog.events.KeyCodes.isCharacterKey=function(a){if(a>=goog.events.KeyCodes.ZERO&&a<=goog.events.KeyCodes.NINE||a>=goog.events.KeyCodes.NUM_ZERO&&a<=goog.events.KeyCodes.NUM_MULTIPLY||a>=goog.events.KeyCodes.A&&a<=goog.events.KeyCodes.Z||(goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&0==a)return!0;switch(a){case goog.events.KeyCodes.SPACE:case goog.events.KeyCodes.PLUS_SIGN:case goog.events.KeyCodes.QUESTION_MARK:case goog.events.KeyCodes.AT_SIGN:case goog.events.KeyCodes.NUM_PLUS:case goog.events.KeyCodes.NUM_MINUS:case goog.events.KeyCodes.NUM_PERIOD:case goog.events.KeyCodes.NUM_DIVISION:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.FF_SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.FF_EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:return!0;default:return!1}};
goog.events.KeyCodes.normalizeKeyCode=function(a){return goog.userAgent.GECKO?goog.events.KeyCodes.normalizeGeckoKeyCode(a):goog.userAgent.MAC&&goog.userAgent.WEBKIT?goog.events.KeyCodes.normalizeMacWebKitKeyCode(a):a};
goog.events.KeyCodes.normalizeGeckoKeyCode=function(a){switch(a){case goog.events.KeyCodes.FF_EQUALS:return goog.events.KeyCodes.EQUALS;case goog.events.KeyCodes.FF_SEMICOLON:return goog.events.KeyCodes.SEMICOLON;case goog.events.KeyCodes.FF_DASH:return goog.events.KeyCodes.DASH;case goog.events.KeyCodes.MAC_FF_META:return goog.events.KeyCodes.META;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return goog.events.KeyCodes.WIN_KEY;default:return a}};
goog.events.KeyCodes.normalizeMacWebKitKeyCode=function(a){switch(a){case goog.events.KeyCodes.MAC_WK_CMD_RIGHT:return goog.events.KeyCodes.META;default:return a}};ngeo.RotateEventType={ROTATEEND:"rotateend"};ngeo.RotateEvent=function(a,b){ol.events.Event.call(this,a);this.feature=b};ol.inherits(ngeo.RotateEvent,ol.events.Event);
ngeo.interaction.Rotate=function(a){goog.asserts.assert(a.features);this.listenerKeys_=[];this.modified_=!1;this.keyPressListenerKey_=null;this.changingFeature_=!1;this.pixelTolerance_=void 0!==a.pixelTolerance?a.pixelTolerance:10;this.features_=a.features;this.centerCoordinate_=this.coordinate_=this.feature_=null;var b=a.style?a.style:ol.interaction.Modify.getDefaultStyleFunction();this.overlay_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1,wrapX:!!a.wrapX}),style:b,updateWhileAnimating:!0,
updateWhileInteracting:!0});this.centerFeatures_={};ol.interaction.Pointer.call(this,{handleDownEvent:this.handleDown_,handleDragEvent:this.handleDrag_,handleUpEvent:this.handleUp_})};ol.inherits(ngeo.interaction.Rotate,ol.interaction.Pointer);goog.exportSymbol("ngeo.interaction.Rotate",ngeo.interaction.Rotate);
ngeo.interaction.Rotate.prototype.setActive=function(a){this.keyPressListenerKey_&&(goog.events.unlistenByKey(this.keyPressListenerKey_),this.keyPressListenerKey_=null);ol.interaction.Pointer.prototype.setActive.call(this,a);a?(this.keyPressListenerKey_=goog.events.listen(document,goog.events.EventType.KEYUP,this.handleKeyUp_,!1,this),this.features_.forEach(this.addFeature_,this),this.listenerKeys_.push(ol.events.listen(this.features_,ol.CollectionEventType.ADD,this.handleFeatureAdd_,this)),this.listenerKeys_.push(ol.events.listen(this.features_,
ol.CollectionEventType.REMOVE,this.handleFeatureRemove_,this))):(this.listenerKeys_.forEach(function(a){ol.events.unlistenByKey(a)},this),this.features_.forEach(this.removeFeature_,this))};goog.exportProperty(ngeo.interaction.Rotate.prototype,"setActive",ngeo.interaction.Rotate.prototype.setActive);
ngeo.interaction.Rotate.prototype.addFeature_=function(a){var b=a.getGeometry();goog.asserts.assertInstanceof(b,ol.geom.Geometry);a.set("angle",0);a=ol.getUid(a);b=new ol.geom.Point(this.getCenterCoordinate_(b));b=new ol.Feature(b);this.centerFeatures_[a]=b;this.overlay_.getSource().addFeature(b)};
ngeo.interaction.Rotate.prototype.willModifyFeatures_=function(a){this.modified_||(this.modified_=!0,this.dispatchEvent(new ol.interaction.Modify.Event(ol.interaction.ModifyEventType.MODIFYSTART,this.features_,a)))};ngeo.interaction.Rotate.prototype.removeFeature_=function(a){this.feature_=null;a&&(a=ol.getUid(a),this.centerFeatures_[a]&&(this.overlay_.getSource().removeFeature(this.centerFeatures_[a]),delete this.centerFeatures_[a]))};
ngeo.interaction.Rotate.prototype.setMap=function(a){this.overlay_.setMap(a);ol.interaction.Pointer.prototype.setMap.call(this,a)};ngeo.interaction.Rotate.prototype.handleFeatureAdd_=function(a){a=a.element;goog.asserts.assertInstanceof(a,ol.Feature,"feature should be an ol.Feature");this.addFeature_(a)};ngeo.interaction.Rotate.prototype.handleFeatureRemove_=function(a){this.removeFeature_(a.element)};
ngeo.interaction.Rotate.prototype.handleDown_=function(a){var b=a.map.forEachFeatureAtPixel(a.pixel,function(a,b){return a},void 0);if(b){var c=!1;this.features_.forEach(function(a){ol.getUid(a)==ol.getUid(b)&&(c=!0)});c||(b=null)}return b?(this.coordinate_=a.coordinate,this.feature_=b,a=this.feature_.getGeometry(),void 0!==a&&(this.centerCoordinate_=this.getCenterCoordinate_(a)),!0):!1};
ngeo.interaction.Rotate.prototype.getCenterCoordinate_=function(a){a instanceof ol.geom.LineString?a=a.getFlatMidpoint():a instanceof ol.geom.Polygon?a=a.getFlatInteriorPoint():(a=a.getExtent(),a=ol.extent.getCenter(a));return a};
ngeo.interaction.Rotate.prototype.handleDrag_=function(a){this.willModifyFeatures_(a);var b=this.feature_.getGeometry(),c=this.coordinate_[0],d=this.coordinate_[1],e=this.centerCoordinate_[0],f=this.centerCoordinate_[1],g=a.coordinate[0]-e,h=a.coordinate[1]-f;this.coordinate_[0]=a.coordinate[0];this.coordinate_[1]=a.coordinate[1];b.rotate(-(Math.atan2(d-f,c-e)-Math.atan2(h,g)),[e,f])};
ngeo.interaction.Rotate.prototype.handleUp_=function(a){this.modified_&&(this.dispatchEvent(new ngeo.RotateEvent(ngeo.RotateEventType.ROTATEEND,this.feature_)),this.modified_=!1,this.setActive(!1));return!1};ngeo.interaction.Rotate.prototype.handleKeyUp_=function(a){a.keyCode===goog.events.KeyCodes.ESC&&this.setActive(!1)};ol.interaction.TranslateEventType={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"};ol.interaction.Translate=function(a){ol.interaction.Pointer.call(this,{handleDownEvent:ol.interaction.Translate.handleDownEvent_,handleDragEvent:ol.interaction.Translate.handleDragEvent_,handleMoveEvent:ol.interaction.Translate.handleMoveEvent_,handleUpEvent:ol.interaction.Translate.handleUpEvent_});a=a?a:{};this.lastCoordinate_=null;this.features_=void 0!==a.features?a.features:null;if(a.layers)if("function"===typeof a.layers)var b=a.layers;else{var c=a.layers;b=function(a){return ol.array.includes(c,
a)}}else b=ol.functions.TRUE;this.layerFilter_=b;this.hitTolerance_=a.hitTolerance?a.hitTolerance:0;this.lastFeature_=null;ol.events.listen(this,ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),this.handleActiveChanged_,this)};ol.inherits(ol.interaction.Translate,ol.interaction.Pointer);
ol.interaction.Translate.handleDownEvent_=function(a){this.lastFeature_=this.featuresAtPixel_(a.pixel,a.map);if(!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=a.coordinate;ol.interaction.Translate.handleMoveEvent_.call(this,a);var b=this.features_||new ol.Collection([this.lastFeature_]);this.dispatchEvent(new ol.interaction.Translate.Event(ol.interaction.TranslateEventType.TRANSLATESTART,b,a.coordinate));return!0}return!1};
ol.interaction.Translate.handleUpEvent_=function(a){if(this.lastCoordinate_){this.lastCoordinate_=null;ol.interaction.Translate.handleMoveEvent_.call(this,a);var b=this.features_||new ol.Collection([this.lastFeature_]);this.dispatchEvent(new ol.interaction.Translate.Event(ol.interaction.TranslateEventType.TRANSLATEEND,b,a.coordinate));return!0}return!1};
ol.interaction.Translate.handleDragEvent_=function(a){if(this.lastCoordinate_){a=a.coordinate;var b=a[0]-this.lastCoordinate_[0],c=a[1]-this.lastCoordinate_[1],d=this.features_||new ol.Collection([this.lastFeature_]);d.forEach(function(a){var d=a.getGeometry();d.translate(b,c);a.setGeometry(d)});this.lastCoordinate_=a;this.dispatchEvent(new ol.interaction.Translate.Event(ol.interaction.TranslateEventType.TRANSLATING,d,a))}};
ol.interaction.Translate.handleMoveEvent_=function(a){var b=a.map.getViewport();this.featuresAtPixel_(a.pixel,a.map)?(b.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),b.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):b.classList.remove("ol-grab","ol-grabbing")};
ol.interaction.Translate.prototype.featuresAtPixel_=function(a,b){return b.forEachFeatureAtPixel(a,function(a){if(!this.features_||ol.array.includes(this.features_.getArray(),a))return a}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})};ol.interaction.Translate.prototype.getHitTolerance=function(){return this.hitTolerance_};ol.interaction.Translate.prototype.setHitTolerance=function(a){this.hitTolerance_=a};
ol.interaction.Translate.prototype.setMap=function(a){var b=this.getMap();ol.interaction.Pointer.prototype.setMap.call(this,a);this.updateState_(b)};ol.interaction.Translate.prototype.handleActiveChanged_=function(){this.updateState_(null)};ol.interaction.Translate.prototype.updateState_=function(a){var b=this.getMap(),c=this.getActive();b&&c||(b=b||a)&&b.getViewport().classList.remove("ol-grab","ol-grabbing")};
ol.interaction.Translate.Event=function(a,b,c){ol.events.Event.call(this,a);this.features=b;this.coordinate=c};ol.inherits(ol.interaction.Translate.Event,ol.events.Event);ngeo.interaction.Translate=function(a){this.listenerKeys_=[];this.featureListenerKeys_={};this.keyPressListenerKey_=null;this.myFeatures_=void 0!==a.features?a.features:null;this.vectorSource_=new ol.source.Vector({useSpatialIndex:!1});this.vectorLayer_=new ol.layer.Vector({source:this.vectorSource_,style:a.style,updateWhileAnimating:!0,updateWhileInteracting:!0});this.centerFeatures_={};ol.interaction.Translate.call(this,a)};ol.inherits(ngeo.interaction.Translate,ol.interaction.Translate);
goog.exportSymbol("ngeo.interaction.Translate",ngeo.interaction.Translate);ngeo.interaction.Translate.prototype.setActive=function(a){this.keyPressListenerKey_&&(goog.events.unlistenByKey(this.keyPressListenerKey_),this.keyPressListenerKey_=null);ol.interaction.Translate.prototype.setActive.call(this,a);a&&(this.keyPressListenerKey_=goog.events.listen(document,goog.events.EventType.KEYUP,this.handleKeyUp_,!1,this));this.setState_()};
goog.exportProperty(ngeo.interaction.Translate.prototype,"setActive",ngeo.interaction.Translate.prototype.setActive);ngeo.interaction.Translate.prototype.setMap=function(a){this.getMap()&&this.vectorLayer_.setMap(null);ol.interaction.Translate.prototype.setMap.call(this,a);a&&this.vectorLayer_.setMap(a);this.setState_()};
ngeo.interaction.Translate.prototype.setState_=function(){var a=this.getMap(),b=this.getActive(),c=this.myFeatures_,d=this.listenerKeys_;a&&b&&c?(c.forEach(this.addFeature_,this),d.push(ol.events.listen(c,ol.CollectionEventType.ADD,this.handleFeaturesAdd_,this)),d.push(ol.events.listen(c,ol.CollectionEventType.REMOVE,this.handleFeaturesRemove_,this))):(a&&(a.getTargetElement().style.cursor="default"),d.forEach(function(a){ol.events.unlistenByKey(a)},this),c.forEach(this.removeFeature_,this))};
ngeo.interaction.Translate.prototype.handleFeaturesAdd_=function(a){a=a.element;goog.asserts.assertInstanceof(a,ol.Feature,"feature should be an ol.Feature");this.addFeature_(a)};ngeo.interaction.Translate.prototype.handleFeaturesRemove_=function(a){this.removeFeature_(a.element)};
ngeo.interaction.Translate.prototype.addFeature_=function(a){var b=ol.getUid(a),c=a.getGeometry();goog.asserts.assertInstanceof(c,ol.geom.Geometry);this.featureListenerKeys_[b]=ol.events.listen(c,ol.events.EventType.CHANGE,this.handleGeometryChange_.bind(this,a),this);a=this.getGeometryCenterPoint_(c);a=new ol.Feature(a);this.centerFeatures_[b]=a;this.vectorSource_.addFeature(a)};
ngeo.interaction.Translate.prototype.removeFeature_=function(a){a=ol.getUid(a);this.featureListenerKeys_[a]&&(ol.events.unlistenByKey(this.featureListenerKeys_[a]),delete this.featureListenerKeys_[a],this.vectorSource_.removeFeature(this.centerFeatures_[a]),delete this.centerFeatures_[a])};ngeo.interaction.Translate.prototype.handleGeometryChange_=function(a,b){b=b.target;goog.asserts.assertInstanceof(b,ol.geom.Geometry);b=this.getGeometryCenterPoint_(b);a=ol.getUid(a);this.centerFeatures_[a].setGeometry(b)};
ngeo.interaction.Translate.prototype.getGeometryCenterPoint_=function(a){if(a instanceof ol.geom.Polygon)var b=a.getInteriorPoint();else if(a instanceof ol.geom.LineString)var c=a.getCoordinateAt(.5);else a=a.getExtent(),c=ol.extent.getCenter(a);!b&&c&&(b=new ol.geom.Point(c));goog.asserts.assert(b,"Point should be thruthy");return b};ngeo.interaction.Translate.prototype.handleKeyUp_=function(a){a.keyCode===goog.events.KeyCodes.ESC&&this.setActive(!1)};gmf.drawfeatureDirective=function(){return{controller:"GmfDrawfeatureController as efCtrl",scope:{active:"=gmfDrawfeatureActive",map:"<gmfDrawfeatureMap",showMeasure:"=?gmfDrawfeatureShowmeasure"},bindToController:!0,templateUrl:gmf.baseTemplateUrl+"/drawfeature.html"}};gmf.module.directive("gmfDrawfeature",gmf.drawfeatureDirective);
gmf.DrawfeatureController=function(a,b,c,d,e,f,g){var h=this;void 0===this.active&&(this.active=!1);this.drawActive=!1;this.drawToolActivate=new ngeo.ToolActivate(this,"drawActive");this.mapSelectActive=!0;this.longPressTimeout_=null;this.mapSelectToolActivate=new ngeo.ToolActivate(this,"mapSelectActive");this.scope_=a;this.timeout_=b;this.ngeoDecorateInteraction_=d;this.featureHelper_=e;this.features=f;this.ngeoToolActivateMgr_=g;this.selectedFeature=null;this.selectedFeatures=new ol.Collection;
this.interactions_=new ol.Collection;this.modify_=new ngeo.interaction.Modify({features:this.selectedFeatures,style:e.getVertexStyle(!1)});this.interactions_.push(this.modify_);this.menu_=null;this.modifyToolActivate=new ngeo.ToolActivate(this.modify_,"active");this.translate_=new ngeo.interaction.Translate({features:this.selectedFeatures,style:new ol.style.Style({text:new ol.style.Text({text:"\uf047",font:"normal 18px FontAwesome",fill:new ol.style.Fill({color:"#7a7a7a"})})})});this.interactions_.push(this.translate_);
this.rotate_=new ngeo.interaction.Rotate({features:this.selectedFeatures,style:new ol.style.Style({text:new ol.style.Text({text:"\uf01e",font:"normal 18px FontAwesome",fill:new ol.style.Fill({color:"#7a7a7a"})})})});this.interactions_.push(this.rotate_);this.initializeInteractions_();this.rotateToolActivate=new ngeo.ToolActivate(this.rotate_,"active");this.translateToolActivate=new ngeo.ToolActivate(this.translate_,"active");this.listenerKeys_=[];this.listSelectionInProgress_=!1;a.$watch(function(){return h.active},
this.handleActiveChange_.bind(this));a.$watch(function(){return h.drawActive},function(a){a&&(h.selectedFeature=null)});a.$watch(function(){return h.selectedFeature},function(a,b){h.selectedFeatures.clear();b&&(h.featureHelper_.setStyle(b),h.unregisterInteractions_());a?(h.featureHelper_.setStyle(a,!0),h.selectedFeatures.push(a),h.registerInteractions_(),h.listSelectionInProgress_&&(h.featureHelper_.panMapToFeature(a,h.map),h.listSelectionInProgress_=!1)):h.menu_&&(h.map.removeOverlay(h.menu_),h.menu_=
null)});a.$watch(function(){return h.mapSelectActive},this.handleMapSelectActiveChange_.bind(this));this.nameProperty=ngeo.FeatureProperties.NAME;this.gettextCatalog_=c};gmf.DrawfeatureController.$inject="$scope $timeout gettextCatalog ngeoDecorateInteraction ngeoFeatureHelper ngeoFeatures ngeoToolActivateMgr".split(" ");gmf.DrawfeatureController.MenuActionType={DELETE:"delete",MOVE:"move",ROTATE:"rotate"};
gmf.DrawfeatureController.prototype.initializeInteractions_=function(){this.interactions_.forEach(function(a){a.setActive(!1);this.ngeoDecorateInteraction_(a)},this)};gmf.DrawfeatureController.prototype.registerInteractions_=function(){this.interactions_.forEach(function(a){this.map.addInteraction(a)},this)};gmf.DrawfeatureController.prototype.unregisterInteractions_=function(){this.interactions_.forEach(function(a){this.map.removeInteraction(a)},this)};
gmf.DrawfeatureController.prototype.handleActiveChange_=function(a){var b=this.listenerKeys_,c=["draw-",ol.getUid(this)].join("-"),d=["other-",ol.getUid(this)].join("-"),e=this.ngeoToolActivateMgr_;a?(b.push(ol.events.listen(this.features,ol.CollectionEventType.ADD,this.handleFeaturesAdd_,this)),b.push(ol.events.listen(this.features,ol.CollectionEventType.REMOVE,this.handleFeaturesRemove_,this)),b.push(ol.events.listen(this.translate_,ol.interaction.TranslateEventType.TRANSLATEEND,this.handleTranslateEnd_,
this)),b.push(ol.events.listen(this.rotate_,ngeo.RotateEventType.ROTATEEND,this.handleRotateEnd_,this)),e.registerTool(c,this.drawToolActivate,!1),e.registerTool(c,this.mapSelectToolActivate,!0),e.registerTool(d,this.drawToolActivate,!1),e.registerTool(d,this.modifyToolActivate,!0),e.registerTool(d,this.translateToolActivate,!1),e.registerTool(d,this.rotateToolActivate,!1),this.mapSelectActive=!0,this.modify_.setActive(!0)):(b.forEach(function(a){ol.events.unlistenByKey(a)},this),e.unregisterTool(c,
this.drawToolActivate),e.unregisterTool(c,this.mapSelectToolActivate),e.unregisterTool(d,this.drawToolActivate),e.unregisterTool(d,this.modifyToolActivate),e.unregisterTool(d,this.translateToolActivate),e.unregisterTool(d,this.rotateToolActivate),this.drawActive=!1,this.modify_.setActive(!1),this.mapSelectActive=!1,this.selectedFeature=null,this.menu_&&(this.map.removeOverlay(this.menu_),this.menu_=null))};
gmf.DrawfeatureController.prototype.selectFeatureFromList=function(a){this.listSelectionInProgress_=!0;this.selectedFeature=a;this.drawActive=!1};goog.exportProperty(gmf.DrawfeatureController.prototype,"selectFeatureFromList",gmf.DrawfeatureController.prototype.selectFeatureFromList);gmf.DrawfeatureController.prototype.getFeaturesArray=function(){return this.features.getArray()};goog.exportProperty(gmf.DrawfeatureController.prototype,"getFeaturesArray",gmf.DrawfeatureController.prototype.getFeaturesArray);
gmf.DrawfeatureController.prototype.clearFeatures=function(){var a=this.gettextCatalog_.getString("Do you really want to delete all the features?");confirm(a)&&this.features.clear()};goog.exportProperty(gmf.DrawfeatureController.prototype,"clearFeatures",gmf.DrawfeatureController.prototype.clearFeatures);gmf.DrawfeatureController.prototype.removeFeature=function(a){var b=this.gettextCatalog_.getString("Do you really want to delete the selected feature?");confirm(b)&&this.features.remove(a)};
goog.exportProperty(gmf.DrawfeatureController.prototype,"removeFeature",gmf.DrawfeatureController.prototype.removeFeature);gmf.DrawfeatureController.prototype.handleFeaturesAdd_=function(a){var b=this;this.timeout_(function(){b.selectedFeature=a.element;b.drawActive=!1;b.scope_.$apply()})};gmf.DrawfeatureController.prototype.handleFeaturesRemove_=function(a){this.selectedFeature=null};
gmf.DrawfeatureController.prototype.handleMapSelectActiveChange_=function(a){var b=this.map.getViewport();goog.asserts.assertElement(b);a?(ol.events.listen(this.map,ol.MapBrowserEventType.CLICK,this.handleMapClick_,this),goog.events.listen(b,goog.events.EventType.CONTEXTMENU,this.handleMapContextMenu_,!1,this),goog.events.listen(b,goog.events.EventType.TOUCHSTART,this.handleMapTouchStart_,!1,this),goog.events.listen(b,goog.events.EventType.TOUCHMOVE,this.handleMapTouchEnd_,!1,this),goog.events.listen(b,
goog.events.EventType.TOUCHEND,this.handleMapTouchEnd_,!1,this)):(ol.events.unlisten(this.map,ol.MapBrowserEventType.CLICK,this.handleMapClick_,this),goog.events.unlisten(b,goog.events.EventType.CONTEXTMENU,this.handleMapContextMenu_,!1,this),goog.events.unlisten(b,goog.events.EventType.TOUCHSTART,this.handleMapTouchStart_,!1,this),goog.events.unlisten(b,goog.events.EventType.TOUCHMOVE,this.handleMapTouchEnd_,!1,this),goog.events.unlisten(b,goog.events.EventType.TOUCHEND,this.handleMapTouchEnd_,!1,
this))};gmf.DrawfeatureController.prototype.handleMapClick_=function(a){var b=this;a=(a=this.map.forEachFeatureAtPixel(a.pixel,function(a){var c=!1;ol.array.includes(b.features.getArray(),a)&&(c=a);return c},{hitTolerance:5}))?a:null;a!==this.selectedFeature&&(this.selectedFeature=a,this.scope_.$apply())};gmf.DrawfeatureController.prototype.handleMapTouchStart_=function(a){var b=this;this.longPressTimeout_=setTimeout(function(){b.handleMapContextMenu_(a)},500)};
gmf.DrawfeatureController.prototype.handleMapTouchEnd_=function(a){clearTimeout(this.longPressTimeout_)};
gmf.DrawfeatureController.prototype.handleMapContextMenu_=function(a){var b=this,c=this.gettextCatalog_,d=this.map.getEventPixel(a),e=this.map.getCoordinateFromPixel(d);if(d=(d=this.map.forEachFeatureAtPixel(d,function(a){var c=!1;ol.array.includes(b.features.getArray(),a)&&(c=a);return c},{hitTolerance:7}))?d:null){var f=[],g=this.featureHelper_.getType(d);if(g==ngeo.GeometryType.CIRCLE||g==ngeo.GeometryType.LINE_STRING||g==ngeo.GeometryType.POLYGON||g==ngeo.GeometryType.RECTANGLE)f=f.concat([{cls:"fa fa-arrows",
label:c.getString("Move"),name:gmf.DrawfeatureController.MenuActionType.MOVE},{cls:"fa fa-rotate-right",label:c.getString("Rotate"),name:gmf.DrawfeatureController.MenuActionType.ROTATE}]);f=f.concat([{cls:"fa fa-trash-o",label:c.getString("Delete"),name:gmf.DrawfeatureController.MenuActionType.DELETE}]);this.menu_=new ngeo.Menu({actions:f});ol.events.listen(this.menu_,ngeo.MenuEventType.ACTION_CLICK,this.handleMenuActionClick_,this);this.map.addOverlay(this.menu_);this.menu_.open(e);a.preventDefault();
a.stopPropagation()}d!==this.selectedFeature&&(this.modify_.setActive(!0),this.selectedFeature=d,this.scope_.$apply())};
gmf.DrawfeatureController.prototype.handleMenuActionClick_=function(a){a=a.action;switch(a){case gmf.DrawfeatureController.MenuActionType.DELETE:goog.asserts.assert(this.selectedFeature,"Selected feature should be truthy");this.removeFeature(this.selectedFeature);this.scope_.$apply();break;case gmf.DrawfeatureController.MenuActionType.MOVE:this.translate_.setActive(!0);this.scope_.$apply();break;case gmf.DrawfeatureController.MenuActionType.ROTATE:this.rotate_.setActive(!0);this.scope_.$apply();break;
default:console.log("FIXME - support: "+a)}};gmf.DrawfeatureController.prototype.handleTranslateEnd_=function(a){this.translate_.setActive(!1);this.scope_.$apply()};gmf.DrawfeatureController.prototype.handleRotateEnd_=function(a){this.rotate_.setActive(!1);this.scope_.$apply()};gmf.module.controller("GmfDrawfeatureController",gmf.DrawfeatureController);gmf.EditFeature=function(a,b){this.http_=a;this.baseUrl_=b};gmf.EditFeature.$inject=["$http","gmfLayersUrl"];gmf.EditFeature.prototype.getFeaturesInExtent=function(a,b){a=ol.uri.appendParams(this.baseUrl_+"/"+a.join(","),{bbox:b.join(",")});return this.http_.get(a).then(this.handleGetFeatures_.bind(this))};goog.exportProperty(gmf.EditFeature.prototype,"getFeaturesInExtent",gmf.EditFeature.prototype.getFeaturesInExtent);
gmf.EditFeature.prototype.getFeaturesWithComparisonFilters=function(a,b){var c=[],d={};b=$jscomp.makeIterator(b);for(var e=b.next();!e.done;e=b.next())e=e.value,d[e.property+"__"+e.operator]=e.value,c.push(e.property);d.queryable=c.join(",");a=ol.uri.appendParams(this.baseUrl_+"/"+a.join(","),d);return this.http_.get(a).then(this.handleGetFeatures_.bind(this))};gmf.EditFeature.prototype.handleGetFeatures_=function(a){return(new ol.format.GeoJSON).readFeatures(a.data)};
gmf.EditFeature.prototype.insertFeatures=function(a,b){a=this.baseUrl_+"/"+a;b=(new ol.format.GeoJSON).writeFeatures(b);return this.http_.post(a,b,{headers:{"Content-Type":"application/json"},withCredentials:!0})};goog.exportProperty(gmf.EditFeature.prototype,"insertFeatures",gmf.EditFeature.prototype.insertFeatures);
gmf.EditFeature.prototype.updateFeature=function(a,b){a=this.baseUrl_+"/"+a.toString()+"/"+b.getId();b=(new ol.format.GeoJSON).writeFeature(b);return this.http_.put(a,b,{headers:{"Content-Type":"application/json"},withCredentials:!0})};goog.exportProperty(gmf.EditFeature.prototype,"updateFeature",gmf.EditFeature.prototype.updateFeature);
gmf.EditFeature.prototype.deleteFeature=function(a,b){a=this.baseUrl_+"/"+a.toString()+"/"+b.getId();return this.http_.delete(a,{headers:{"Content-Type":"application/json"},withCredentials:!0})};goog.exportProperty(gmf.EditFeature.prototype,"deleteFeature",gmf.EditFeature.prototype.deleteFeature);gmf.module.service("gmfEditFeature",gmf.EditFeature);ngeo.format.XSDAttribute=function(){ol.format.XML.call(this)};ol.inherits(ngeo.format.XSDAttribute,ol.format.XML);goog.exportSymbol("ngeo.format.XSDAttribute",ngeo.format.XSDAttribute);ngeo.format.XSDAttribute.prototype.read=function(a){return ol.format.XML.prototype.read.call(this,a)};
ngeo.format.XSDAttribute.prototype.readFromDocument=function(a){goog.asserts.assert(a.nodeType==Node.DOCUMENT_NODE,"doc.nodeType should be DOCUMENT");for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType==Node.ELEMENT_NODE)return this.readFromNode(a);return null};
ngeo.format.XSDAttribute.prototype.readFromNode=function(a){goog.asserts.assert(a.nodeType==Node.ELEMENT_NODE,"node.nodeType should be ELEMENT");goog.asserts.assert("schema"==a.localName,"localName should be schema");var b=a.getElementsByTagName("element");b.length||(b=a.getElementsByTagName("xsd:element"));a=[];for(var c,d=0,e=b.length;d<e;d++)(c=this.readFromElementNode_(b[d]))&&a.push(c);return a};
ngeo.format.XSDAttribute.prototype.readFromElementNode_=function(a){var b=a.getAttribute("name");goog.asserts.assertString(b,"name should be defined in element node.");var c=a.getAttribute("nillable");b={name:b,required:!(!0===c||"true"===c)};if(c=a.getAttribute("type"))ngeo.Attribute.setGeometryType(b,c)||this.setAttributeByXsdType_(b,c);else if(c=a.getElementsByTagName("enumeration"),c.length||(c=a.getElementsByTagName("xsd:enumeration")),c.length){b.type=ngeo.AttributeType.SELECT;a=[];for(var d=
0,e=c.length;d<e;d++)a.push(c[d].getAttribute("value"));b.choices=a}else c=a.getElementsByTagName("restriction"),c.length||(c=a.getElementsByTagName("xsd:restriction")),c.length&&c[0]&&(this.setAttributeByXsdType_(b,c[0].getAttribute("base")),c=a.getElementsByTagName("maxLength"),c.length||(c=a.getElementsByTagName("xsd:maxLength")),c.length&&c[0]&&(b.maxLength=Number(c[0].getAttribute("value"))));if(!b.type)return null;goog.asserts.assert(b.type);return b};
ngeo.format.XSDAttribute.prototype.setAttributeByXsdType_=function(a,b){"xsd:boolean"===b?a.type=ngeo.AttributeType.BOOLEAN:"xsd:date"===b?a.type=ngeo.AttributeType.DATE:"xsd:dateTime"===b?a.type=ngeo.AttributeType.DATETIME:"xsd:time"===b?a.type=ngeo.AttributeType.TIME:"xsd:decimal"===b||"xsd:double"===b?(a.type=ngeo.AttributeType.NUMBER,a.numType=ngeo.NumberType.FLOAT):"xsd:integer"===b?(a.type=ngeo.AttributeType.NUMBER,a.numType=ngeo.NumberType.INTEGER):"xsd:string"===b&&(a.type=ngeo.AttributeType.TEXT)};
ngeo.format.XSDAttribute.getGeometryAttribute=function(a){for(var b=null,c=0,d=a.length;c<d;c++)if(a[c].type===ngeo.AttributeType.GEOMETRY){b=a[c];break}return b};goog.exportProperty(ngeo.format.XSDAttribute,"getGeometryAttribute",ngeo.format.XSDAttribute.getGeometryAttribute);gmf.XSDAttributes=function(a,b){this.http_=a;this.baseUrl_=b;this.promises_={}};gmf.XSDAttributes.$inject=["$http","gmfLayersUrl"];gmf.XSDAttributes.prototype.getAttributes=function(a){this.promises_[a]||(this.promises_[a]=this.http_.get(this.baseUrl_+"/"+a+"/md.xsd").then(this.handleGetAttributes_.bind(this)));return this.promises_[a]};goog.exportProperty(gmf.XSDAttributes.prototype,"getAttributes",gmf.XSDAttributes.prototype.getAttributes);gmf.XSDAttributes.prototype.handleGetAttributes_=function(a){return(new ngeo.format.XSDAttribute).read(a.data)};
goog.exportProperty(gmf.XSDAttributes.prototype,"handleGetAttributes_",gmf.XSDAttributes.prototype.handleGetAttributes_);gmf.module.service("gmfXSDAttributes",gmf.XSDAttributes);ngeo.datetimepickerDirective=function(){return{restrict:"A",controller:ngeo.DatetimepickerController,bindToController:!0,scope:{options:"<ngeoDatetimepickerOptions"}}};ngeo.module.directive("ngeoDatetimepicker",ngeo.datetimepickerDirective);ngeo.DatetimepickerController=function(a,b){this.element_=a;this.gettextCatalog_=b};ngeo.DatetimepickerController.$inject=["$element","gettextCatalog"];
ngeo.DatetimepickerController.prototype.$onInit=function(){var a=this.gettextCatalog_.getCurrentLanguage();$.datetimepicker.setLocale(a);"string"===typeof this.options&&(this.options=angular.fromJson(this.options));this.element_.datetimepicker(this.options)};ngeo.attributesComponent={controller:"ngeoAttributesController as attrCtrl",bindings:{attributes:"=ngeoAttributesAttributes",disabled:"<ngeoAttributesDisabled",feature:"=ngeoAttributesFeature"},require:{form:"^"},templateUrl:function(){return ngeo.baseTemplateUrl+"/attributes.html"}};ngeo.module.component("ngeoAttributes",ngeo.attributesComponent);ngeo.AttributesController=function(a,b){this.disabled=!1;this.scope_=a;this.ngeoEventHelper_=b;this.updating_=!1};
ngeo.AttributesController.$inject=["$scope","ngeoEventHelper"];ngeo.AttributesController.prototype.$onInit=function(){this.properties=this.feature.getProperties();var a=ol.getUid(this);this.ngeoEventHelper_.addListenerKey(a,ol.events.listen(this.feature,ol.ObjectEventType.PROPERTYCHANGE,this.handleFeaturePropertyChange_,this),!0)};ngeo.AttributesController.prototype.handleInputChange=function(a){this.updating_=!0;this.feature.set(a,this.properties[a]);this.updating_=!1};
goog.exportProperty(ngeo.AttributesController.prototype,"handleInputChange",ngeo.AttributesController.prototype.handleInputChange);ngeo.AttributesController.prototype.$onDestroy=function(){var a=ol.getUid(this);this.ngeoEventHelper_.clearListenerKey(a)};ngeo.AttributesController.prototype.handleFeaturePropertyChange_=function(a){this.updating_||(this.properties[a.key]=a.target.get(a.key),this.scope_.$apply())};ngeo.module.controller("ngeoAttributesController",ngeo.AttributesController);ngeo.createfeatureDirective=function(){return{controller:"ngeoCreatefeatureController as cfCtrl",bindToController:!0,scope:{active:"=ngeoCreatefeatureActive",features:"=ngeoCreatefeatureFeatures",geomType:"=ngeoCreatefeatureGeomType",map:"=ngeoCreatefeatureMap"}}};ngeo.module.directive("ngeoCreatefeature",ngeo.createfeatureDirective);
ngeo.CreatefeatureController=function(a,b,c,d,e,f){var g=this;this.gettextCatalog_=a;this.compile_=b;this.filter_=c;this.scope_=d;this.timeout_=e;this.ngeoEventHelper_=f;d.$watch(function(){return g.active},function(a){g.interaction_.setActive(a)})};ngeo.CreatefeatureController.$inject="gettextCatalog $compile $filter $scope $timeout ngeoEventHelper".split(" ");
ngeo.CreatefeatureController.prototype.$onInit=function(){this.active=!0===this.active;var a=this.gettextCatalog_;if(this.geomType===ngeo.GeometryType.POINT||this.geomType===ngeo.GeometryType.MULTI_POINT)var b=new ol.interaction.Draw({type:ol.geom.GeometryType.POINT});else if(this.geomType===ngeo.GeometryType.LINE_STRING||this.geomType===ngeo.GeometryType.MULTI_LINE_STRING)b=a.getString("Click to start drawing length"),a=a.getString("Click to continue drawing<br/>Double-click or click last point to finish"),
b=new ngeo.interaction.MeasureLength(this.filter_("ngeoUnitPrefix"),{style:new ol.style.Style,startMsg:this.compile_("<div translate>"+b+"</div>")(this.scope_)[0],continueMsg:this.compile_("<div translate>"+a+"</div>")(this.scope_)[0]});else if(this.geomType===ngeo.GeometryType.POLYGON||this.geomType===ngeo.GeometryType.MULTI_POLYGON)b=a.getString("Click to start drawing area"),a=a.getString("Click to continue drawing<br/>Double-click or click starting point to finish"),b=new ngeo.interaction.MeasureArea(this.filter_("ngeoUnitPrefix"),
{style:new ol.style.Style,startMsg:this.compile_("<div translate>"+b+"</div>")(this.scope_)[0],continueMsg:this.compile_("<div translate>"+a+"</div>")(this.scope_)[0]});goog.asserts.assert(b);b.setActive(this.active);this.interaction_=b;this.map.addInteraction(b);a=ol.getUid(this);b instanceof ol.interaction.Draw?this.ngeoEventHelper_.addListenerKey(a,ol.events.listen(b,ol.interaction.DrawEventType.DRAWEND,this.handleDrawEnd_,this),!0):(b instanceof ngeo.interaction.MeasureLength||b instanceof ngeo.interaction.MeasureArea)&&
this.ngeoEventHelper_.addListenerKey(a,ol.events.listen(b,ngeo.MeasureEventType.MEASUREEND,this.handleDrawEnd_,this),!0)};ngeo.CreatefeatureController.prototype.handleDrawEnd_=function(a){a=a.feature.getGeometry();var b=a.getType();this.geomType.indexOf("Multi")!=b.indexOf("Multi")&&(a=ngeo.utils.toMulti(a));a=new ol.Feature(a);this.features instanceof ol.Collection?this.features.push(a):this.features.addFeature(a)};goog.exportProperty(ngeo.CreatefeatureController.prototype,"handleDrawEnd_",ngeo.CreatefeatureController.prototype.handleDrawEnd_);
ngeo.CreatefeatureController.prototype.$onDestroy=function(){var a=this;this.timeout_(function(){var b=ol.getUid(a);a.ngeoEventHelper_.clearListenerKey(b);a.interaction_.setActive(!1);a.map.removeInteraction(a.interaction_)},0)};ngeo.module.controller("ngeoCreatefeatureController",ngeo.CreatefeatureController);gmf.editfeatureDirective=function(){return{controller:"GmfEditfeatureController as efCtrl",scope:{dirty:"=gmfEditfeatureDirty",editableTreeCtrl:"=gmfEditfeatureEditabletreectrl",map:"<gmfEditfeatureMap",state:"=gmfEditfeatureState",tolerance:"<?gmfEditfeatureTolerance",vectorLayer:"<gmfEditfeatureVector"},bindToController:!0,templateUrl:gmf.baseTemplateUrl+"/editfeature.html"}};gmf.module.directive("gmfEditfeature",gmf.editfeatureDirective);
gmf.EditfeatureController=function(a,b,c,d,e,f,g,h,k,l,m,n,p){var q=this;this.element_=a;this.q_=b;this.scope_=c;this.timeout_=d;this.gettextCatalog_=e;this.gmfEditFeature_=f;this.gmfSnapping_=g;this.gmfXSDAttributes_=h;this.ngeoDecorateInteraction_=k;this.ngeoEventHelper_=l;this.ngeoFeatureHelper_=m;this.ngeoLayerHelper_=n;this.ngeoToolActivateMgr_=p;this.confirmDeferred_=null;this.pending=this.unsavedModificationsModalShown=!1;this.active=!0;this.createActive=!1;this.createToolActivate=new ngeo.ToolActivate(this,
"createActive");this.mapSelectActive=!0;this.mapSelectToolActivate=new ngeo.ToolActivate(this,"mapSelectActive");this.feature=null;this.scope_.$watch(function(){return q.feature},this.handleFeatureChange_.bind(this));this.featureId=void 0;this.interactions_=new ol.Collection;this.menu_=new ngeo.Menu({actions:[{cls:"fa fa-arrows",label:e.getString("Move"),name:gmf.EditfeatureController.MenuActionType.MOVE},{cls:"fa fa-rotate-right",label:e.getString("Rotate"),name:gmf.EditfeatureController.MenuActionType.ROTATE}]});
this.listenerKeys_=[];this.attributes=null;this.showServerError=!1};gmf.EditfeatureController.$inject="$element $q $scope $timeout gettextCatalog gmfEditFeature gmfSnapping gmfXSDAttributes ngeoDecorateInteraction ngeoEventHelper ngeoFeatureHelper ngeoLayerHelper ngeoToolActivateMgr".split(" ");gmf.EditfeatureController.MenuActionType={MOVE:"move",ROTATE:"rotate"};
gmf.EditfeatureController.prototype.$onInit=function(){var a=this;this.dirty=!0===this.dirty;this.editableNode_=this.editableTreeCtrl.node;this.features=this.vectorLayer.getSource().getFeaturesCollection();this.tolerance=void 0!==this.tolerance?this.tolerance:10;var b=gmf.SyncLayertreeMap.getLayer(this.editableTreeCtrl);goog.asserts.assert(b instanceof ol.layer.Image||b instanceof ol.layer.Tile);this.editableWMSLayer_=b;this.modify_=new ol.interaction.Modify({deleteCondition:ngeo.utils.deleteCondition,
features:this.features,style:this.ngeoFeatureHelper_.getVertexStyle(!1)});this.interactions_.push(this.modify_);this.rotate_=new ngeo.interaction.Rotate({features:this.features,style:new ol.style.Style({text:new ol.style.Text({text:"\uf01e",font:"normal 18px FontAwesome",fill:new ol.style.Fill({color:"#7a7a7a"})})})});this.interactions_.push(this.rotate_);this.translate_=new ngeo.interaction.Translate({features:this.features,style:new ol.style.Style({text:new ol.style.Text({text:"\uf047",font:"normal 18px FontAwesome",
fill:new ol.style.Fill({color:"#7a7a7a"})})})});this.interactions_.push(this.translate_);this.initializeInteractions_();this.modifyToolActivate=new ngeo.ToolActivate(this.modify_,"active");this.rotateToolActivate=new ngeo.ToolActivate(this.rotate_,"active");this.translateToolActivate=new ngeo.ToolActivate(this.translate_,"active");this.map.addOverlay(this.menu_);this.scope_.$watch(function(){return a.createActive},function(b,d){b&&a.gmfSnapping_.ensureSnapInteractionsOnTop()});this.scope_.$on("$destroy",
this.handleDestroy_.bind(this));b=ol.getUid(this);this.ngeoEventHelper_.addListenerKey(b,ol.events.listen(this.features,ol.CollectionEventType.ADD,this.handleFeatureAdd_,this));this.scope_.$watch(function(){return a.mapSelectActive},this.handleMapSelectActiveChange_.bind(this));this.scope_.$watch(function(){return a.state},function(b,d){var c=gmf.EditfeatureController.State;b===c.STOP_EDITING_PENDING?a.confirmCancel().then(function(){a.state=c.STOP_EDITING_EXECUTE}):b===c.DEACTIVATE_PENDING&&a.confirmCancel().then(function(){a.state=
c.DEACTIVATE_EXECUTE})});this.scope_.$watch(function(){return a.unsavedModificationsModalShown},function(b,d){d&&!b&&(a.state=gmf.EditfeatureController.State.IDLE)});this.gmfXSDAttributes_.getAttributes(this.editableNode_.id).then(this.setAttributes_.bind(this));this.toggle_(!0)};
gmf.EditfeatureController.prototype.save=function(){var a=this;goog.asserts.assert(this.attributes);var b=this.feature.clone();b.setId(this.feature.getId());var c=this.featureId;this.pending=!0;for(var d=new DateFormatter,e=$jscomp.makeIterator(this.attributes),f=e.next();!f.done;f=e.next())if(f=f.value,f.format)if(this.feature.get(f.name)){var g=this.feature.get(f.name);goog.asserts.assertString(g);g=d.parseDate(g,f.format);var h="Y-m-d\\TH:i:s";"date"===f.type?h="Y-m-d":"time"===f.type?h="H:i:s":
"datetime"===f.type&&g.setMinutes(g.getMinutes()+g.getTimezoneOffset());b.set(f.name,d.formatDate(g,h))}else b.set(f.name,null);(c?this.gmfEditFeature_.updateFeature(this.editableNode_.id,b):this.gmfEditFeature_.insertFeatures(this.editableNode_.id,[b])).then(function(b){a.dirty=!1;a.pending=!1;a.handleEditFeature_(b)},function(){a.showServerError=!0;a.pending=!1})};goog.exportProperty(gmf.EditfeatureController.prototype,"save",gmf.EditfeatureController.prototype.save);
gmf.EditfeatureController.prototype.cancel=function(){this.dirty=!1;this.feature=null;this.features.clear();this.menu_.close();this.unsavedModificationsModalShown=!1};goog.exportProperty(gmf.EditfeatureController.prototype,"cancel",gmf.EditfeatureController.prototype.cancel);gmf.EditfeatureController.prototype.confirmCancel=function(){var a=this;return this.checkForModifications_().then(function(){a.cancel()})};goog.exportProperty(gmf.EditfeatureController.prototype,"confirmCancel",gmf.EditfeatureController.prototype.confirmCancel);
gmf.EditfeatureController.prototype.checkForModifications_=function(a){this.confirmDeferred_=this.q_.defer();this.feature&&this.dirty?(this.unsavedModificationsModalShown=!0,a&&this.scope_.$apply()):this.confirmDeferred_.resolve();return this.confirmDeferred_.promise};gmf.EditfeatureController.prototype.continueWithoutSaving=function(){this.cancel();this.confirmDeferred_.resolve()};goog.exportProperty(gmf.EditfeatureController.prototype,"continueWithoutSaving",gmf.EditfeatureController.prototype.continueWithoutSaving);
gmf.EditfeatureController.prototype.delete=function(){var a=this,b=this.gettextCatalog_.getString("Do you really want to delete the selected feature?");confirm(b)&&(this.pending=!0,this.gmfEditFeature_.deleteFeature(this.editableNode_.id,this.feature).then(function(b){a.dirty=!1;a.pending=!1;a.ngeoLayerHelper_.refreshWMSLayer(a.editableWMSLayer_);a.cancel()},function(){a.showServerError=!0;a.pending=!1}))};goog.exportProperty(gmf.EditfeatureController.prototype,"delete",gmf.EditfeatureController.prototype.delete);
gmf.EditfeatureController.prototype.submit=function(){var a=this;this.timeout_(function(){a.element_.find('input[type="submit"]').click()},0)};goog.exportProperty(gmf.EditfeatureController.prototype,"submit",gmf.EditfeatureController.prototype.submit);gmf.EditfeatureController.prototype.handleEditFeature_=function(a){a=(new ol.format.GeoJSON).readFeatures(a.data);a.length&&(this.feature.setId(a[0].getId()),this.ngeoLayerHelper_.refreshWMSLayer(this.editableWMSLayer_));this.confirmDeferred_&&this.confirmDeferred_.resolve()};
gmf.EditfeatureController.prototype.setAttributes_=function(a){this.attributes=a;a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())b=b.value,"date"==b.type?(b.format="Y-m-d",b.mask="9999-19-39"):"time"==b.type?(b.format="H:i",b.mask="29:59"):"datetime"==b.type&&(b.format="Y-m-d H:i",b.mask="9999-19-39 29:59");(a=ngeo.format.XSDAttribute.getGeometryAttribute(this.attributes))&&a.geomType&&(this.geomType=a.geomType)};
gmf.EditfeatureController.prototype.handleFeatureAdd_=function(a){var b=this;this.feature=null;this.timeout_(function(){goog.asserts.assert(b.attributes);var c=a.element;goog.asserts.assertInstanceof(c,ol.Feature);for(var d=new DateFormatter,e=$jscomp.makeIterator(b.attributes),f=e.next();!f.done;f=e.next())if(f=f.value,f.format)if(c.get(f.name)){if("datetime"===f.type){var g=new Date(c.get(f.name));g.setMinutes(g.getMinutes()-g.getTimezoneOffset())}else{g="";"date"===f.type?g="Y-m-d":"time"===f.type&&
(g="H:i:s");var h=c.get(f.name);goog.asserts.assertString(h);g=d.parseDate(h,g)}c.set(f.name,d.formatDate(g,f.format))}else c.set(f.name,null);b.feature=c;b.createActive=!1;c.getId()||(b.dirty=!0);b.scope_.$apply()},0)};
gmf.EditfeatureController.prototype.toggle_=function(a){var b=this.listenerKeys_,c=["create-",ol.getUid(this)].join("-"),d=["other-",ol.getUid(this)].join("-"),e=this.ngeoToolActivateMgr_;a?(b.push(ol.events.listen(this.menu_,ngeo.MenuEventType.ACTION_CLICK,this.handleMenuActionClick_,this)),b.push(ol.events.listen(this.translate_,ol.interaction.TranslateEventType.TRANSLATEEND,this.handleTranslateEnd_,this)),b.push(ol.events.listen(this.rotate_,ngeo.RotateEventType.ROTATEEND,this.handleRotateEnd_,
this)),e.registerTool(c,this.createToolActivate,!1),e.registerTool(c,this.mapSelectToolActivate,!0),e.registerTool(d,this.createToolActivate,!1),e.registerTool(d,this.modifyToolActivate,!0),e.registerTool(d,this.translateToolActivate,!1),e.registerTool(d,this.rotateToolActivate,!1)):(b.forEach(function(a){ol.events.unlistenByKey(a)},this),e.unregisterTool(c,this.createToolActivate),e.unregisterTool(c,this.mapSelectToolActivate),e.unregisterTool(d,this.createToolActivate),e.unregisterTool(d,this.modifyToolActivate),
e.unregisterTool(d,this.translateToolActivate),e.unregisterTool(d,this.rotateToolActivate),this.createActive=!1,this.cancel());this.modify_.setActive(a);this.mapSelectActive=a;this.editableTreeCtrl.properties.editing=a};
gmf.EditfeatureController.prototype.handleMapSelectActiveChange_=function(a){var b=this.map.getViewport();goog.asserts.assertElement(b);a?(ol.events.listen(this.map,ol.MapBrowserEventType.CLICK,this.handleMapClick_,this),goog.events.listen(b,goog.events.EventType.CONTEXTMENU,this.handleMapContextMenu_,!1,this)):(ol.events.unlisten(this.map,ol.MapBrowserEventType.CLICK,this.handleMapClick_,this),goog.events.unlisten(b,goog.events.EventType.CONTEXTMENU,this.handleMapContextMenu_,!1,this))};
gmf.EditfeatureController.prototype.handleMapClick_=function(a){var b=this,c=a.coordinate;this.map.forEachFeatureAtPixel(a.pixel,function(a){var c=!1;ol.array.includes(b.features.getArray(),a)&&(c=a);return c},{hitTolerance:5})||this.checkForModifications_(!0).then(function(){var a=b.map.getView().getResolution()*b.tolerance;a=ol.extent.buffer([c[0],c[1],c[0],c[1]],a);b.gmfEditFeature_.getFeaturesInExtent([b.editableNode_.id],a).then(b.handleGetFeatures_.bind(b));b.cancel();b.pending=!0})};
gmf.EditfeatureController.prototype.handleMapContextMenu_=function(a){var b=this,c=this.map.getEventPixel(a),d=this.map.getCoordinateFromPixel(c);if(c=(c=this.map.forEachFeatureAtPixel(c,function(a){var c=!1;ol.array.includes(b.features.getArray(),a)&&(c=a);return c},{hitTolerance:7}))?c:null)c=this.ngeoFeatureHelper_.getType(c),c!==ngeo.GeometryType.POLYGON&&c!==ngeo.GeometryType.MULTI_POLYGON&&c!==ngeo.GeometryType.LINE_STRING&&c!==ngeo.GeometryType.MULTI_LINE_STRING||this.menu_.open(d),a.preventDefault(),
a.stopPropagation()};gmf.EditfeatureController.prototype.handleGetFeatures_=function(a){var b=this;this.pending=!1;this.timeout_(function(){if(a.length){var c=a[0];b.feature=c;b.features.push(c)}},0)};gmf.EditfeatureController.prototype.initializeInteractions_=function(){this.interactions_.forEach(function(a){a.setActive(!1);this.ngeoDecorateInteraction_(a)},this)};
gmf.EditfeatureController.prototype.registerInteractions_=function(){this.interactions_.forEach(function(a){this.map.addInteraction(a)},this)};gmf.EditfeatureController.prototype.unregisterInteractions_=function(){this.interactions_.forEach(function(a){this.map.removeInteraction(a)},this)};
gmf.EditfeatureController.prototype.handleFeatureChange_=function(a,b){var c=this;b&&(ol.events.unlisten(b,ol.ObjectEventType.PROPERTYCHANGE,this.handleFeaturePropertyChange_,this),b=b.getGeometry(),goog.asserts.assert(b),ol.events.unlisten(b,ol.events.EventType.CHANGE,this.handleFeatureGeometryChange_,this),this.unregisterInteractions_());a?(this.featureId=a.getId(),ol.events.listen(a,ol.ObjectEventType.PROPERTYCHANGE,this.handleFeaturePropertyChange_,this),b=a.getGeometry(),goog.asserts.assert(b),
ol.events.listen(b,ol.events.EventType.CHANGE,this.handleFeatureGeometryChange_,this),this.registerInteractions_(),this.gmfSnapping_.ensureSnapInteractionsOnTop(),this.featureId&&this.timeout_(function(){c.dirty=!1;c.scope_.$apply()},0)):this.featureId=void 0};gmf.EditfeatureController.prototype.handleFeaturePropertyChange_=function(){this.dirty=!0};gmf.EditfeatureController.prototype.handleFeatureGeometryChange_=function(){this.dirty=!0;this.scope_.$apply()};
gmf.EditfeatureController.prototype.handleMenuActionClick_=function(a){switch(a.action){case gmf.EditfeatureController.MenuActionType.MOVE:this.translate_.setActive(!0);this.scope_.$apply();break;case gmf.EditfeatureController.MenuActionType.ROTATE:this.rotate_.setActive(!0),this.scope_.$apply()}};gmf.EditfeatureController.prototype.handleTranslateEnd_=function(a){this.translate_.setActive(!1);this.scope_.$apply()};
gmf.EditfeatureController.prototype.handleRotateEnd_=function(a){this.rotate_.setActive(!1);this.scope_.$apply()};gmf.EditfeatureController.prototype.handleDestroy_=function(){this.features.clear();this.handleFeatureChange_(null,this.feature);this.feature=null;var a=ol.getUid(this);this.ngeoEventHelper_.clearListenerKey(a);this.toggle_(!1);this.handleMapSelectActiveChange_(!1);this.unregisterInteractions_()};gmf.module.controller("GmfEditfeatureController",gmf.EditfeatureController);
gmf.EditfeatureController.State={IDLE:"idle",DEACTIVATE_EXECUTE:"deactivate_execute",DEACTIVATE_PENDING:"deactivate_pending",STOP_EDITING_EXECUTE:"stop_editing_execute",STOP_EDITING_PENDING:"stop_editing_pending"};gmf.editfeatureselectorDirective=function(){return{controller:"GmfEditfeatureselectorController as efsCtrl",scope:{active:"=gmfEditfeatureselectorActive",map:"<gmfEditfeatureselectorMap",tolerance:"<?gmfEditfeatureselectorTolerance",vectorLayer:"<gmfEditfeatureselectorVector"},bindToController:!0,templateUrl:gmf.baseTemplateUrl+"/editfeatureselector.html"}};gmf.module.directive("gmfEditfeatureselector",gmf.editfeatureselectorDirective);
gmf.EditfeatureselectorController=function(a,b,c,d){var e=this;this.active=!0===this.active;a.$watch(function(){return e.active},this.handleActiveChange_.bind(this));this.scope_=a;this.$timeout_=b;this.gmfThemes_=c;this.gmfTreeManager_=d;this.treeCtrlsWatcherUnregister_=a.$watchCollection(function(){if(d.rootCtrl)return d.rootCtrl.children},function(a){var b=this;this.$timeout_(function(){if(a){var c=b.editableTreeCtrls;c.length=0;b.gmfTreeManager_.rootCtrl.traverseDepthFirst(function(a){a.node.editable&&
(goog.asserts.assert(0===a.children.length),c.push(a))})}},0)}.bind(this));this.dirty=!1;this.editableTreeCtrls=[];this.selectedEditableTreeCtrl=null;a.$watch(function(){return e.selectedEditableTreeCtrl},function(a,b){e.dirty=!1;e.state=gmf.EditfeatureController.State.IDLE});this.state=gmf.EditfeatureController.State.IDLE;a.$watch(function(){return e.state},function(a,b){if(a===gmf.EditfeatureController.State.STOP_EDITING_EXECUTE||a===gmf.EditfeatureController.State.DEACTIVATE_EXECUTE)e.selectedEditableTreeCtrl=
null;a===gmf.EditfeatureController.State.DEACTIVATE_EXECUTE&&(e.active=!1)});a.$on("$destroy",this.handleDestroy_.bind(this))};gmf.EditfeatureselectorController.$inject=["$scope","$timeout","gmfThemes","gmfTreeManager"];gmf.EditfeatureselectorController.prototype.stopEditing=function(){this.state=gmf.EditfeatureController.State.STOP_EDITING_PENDING};goog.exportProperty(gmf.EditfeatureselectorController.prototype,"stopEditing",gmf.EditfeatureselectorController.prototype.stopEditing);
gmf.EditfeatureselectorController.prototype.handleActiveChange_=function(a){var b=this;a||(this.dirty?this.$timeout_(function(){b.active=!0;b.stopEditing()}):this.selectedEditableNode=null)};gmf.EditfeatureselectorController.prototype.handleDestroy_=function(){this.treeCtrlsWatcherUnregister_()};gmf.module.controller("GmfEditfeatureselectorController",gmf.EditfeatureselectorController);gmf.elevationWidgetDirective={};gmf.elevationDirective=function(){return{restrict:"A",controller:"GmfElevationController as ctrl",bindToController:!0,scope:{active:"<gmfElevationActive",elevation:"=gmfElevationElevation",loading:"=?gmfElevationLoading",layer:"<gmfElevationLayer",map:"=gmfElevationMap"},link:function(a,b,c){var d=a.ctrl;a.$watch(function(){return d.active},function(a){this.toggleActive_(a)}.bind(d));a.$watch(function(){return d.layer},function(a){this.layer=a;this.elevation=null}.bind(d))}}};
gmf.module.directive("gmfElevation",gmf.elevationDirective);gmf.ElevationController=function(a,b,c){this.ngeoDebounce_=b;this.gmfRaster_=c;this.listenerKeys_=[];this.scope_=a;this.loading=this.inViewport_=!1};goog.exportSymbol("gmf.ElevationController",gmf.ElevationController);gmf.ElevationController.$inject=["$scope","ngeoDebounce","gmfRaster"];
gmf.ElevationController.prototype.toggleActive_=function(a){this.elevation=void 0;a?(goog.asserts.assert(0===this.listenerKeys_.length),this.listenerKeys_.push(ol.events.listen(this.map,"pointermove",function(a){var b=this;this.scope_.$apply(function(){b.inViewport_=!0;b.elevation=void 0;b.loading=!1})},this)),this.listenerKeys_.push(ol.events.listen(this.map,"pointermove",this.ngeoDebounce_(this.pointerStop_.bind(this),500,!0))),this.listenerKeys_.push(ol.events.listen(this.map.getViewport(),ol.events.EventType.MOUSEOUT,
function(a){var b=this;this.scope_.$apply(function(){b.elevation=void 0;b.inViewport_=!1;b.loading=!1})},this))):(this.elevation=void 0,this.listenerKeys_.forEach(ol.events.unlistenByKey),this.listenerKeys_.length=0)};gmf.ElevationController.prototype.pointerStop_=function(a){this.inViewport_&&(this.loading=!0,this.gmfRaster_.getRaster(a.coordinate,{layers:this.layer}).then(this.getRasterSuccess_.bind(this),this.getRasterError_.bind(this)))};
gmf.ElevationController.prototype.getRasterSuccess_=function(a){goog.asserts.assert(this.layer,"A layer should be selected");this.elevation=a[this.layer];this.loading=!1};gmf.ElevationController.prototype.getRasterError_=function(){console.error("Error on getting the raster.");this.elevation=void 0;this.loading=!1};gmf.module.controller("GmfElevationController",gmf.ElevationController);
gmf.elevationwidgetComponent={controller:"gmfElevationwidgetController as ctrl",bindings:{map:"<gmfElevationwidgetMap",layers:"<gmfElevationwidgetLayers",active:"<gmfElevationwidgetActive"},templateUrl:function(){return gmf.baseTemplateUrl+"/elevationwidget.html"}};gmf.module.component("gmfElevationwidget",gmf.elevationwidgetComponent);gmf.ElevationwidgetController=function(){};goog.exportSymbol("gmf.ElevationwidgetController",gmf.ElevationwidgetController);
gmf.module.controller("gmfElevationwidgetController",gmf.ElevationwidgetController);gmf.ElevationwidgetController.prototype.$onInit=function(){this.selectedElevationLayer=this.layers[0]};gmf.EnumerateAttribute=function(a,b){this.http_=a;this.baseUrl_=b;this.promises_={}};gmf.EnumerateAttribute.prototype.getAttributeValues=function(a,b){var c=a.id+"_"+b;a=a.name;this.promises_[c]||(this.promises_[c]=this.http_.get(this.baseUrl_+"/"+a+"/values/"+b).then(this.handleGetAttributeValues_.bind(this)));return this.promises_[c]};gmf.EnumerateAttribute.prototype.handleGetAttributeValues_=function(a){return a.data.items};
goog.exportProperty(gmf.EnumerateAttribute.prototype,"handleGetAttributeValues_",gmf.EnumerateAttribute.prototype.handleGetAttributeValues_);gmf.EnumerateAttribute.$inject=["$http","gmfLayersUrl"];gmf.module.service("gmfEnumerateAttribute",gmf.EnumerateAttribute);gmf.DataSourcesHelper=function(a,b,c){this.q_=a;this.gmfEnumerateAttribute_=b;this.ngeoDataSourcesHelper_=c};gmf.DataSourcesHelper.prototype.getDataSource=function(a){return this.ngeoDataSourcesHelper_.getDataSource(a)};goog.exportProperty(gmf.DataSourcesHelper.prototype,"getDataSource",gmf.DataSourcesHelper.prototype.getDataSource);
gmf.DataSourcesHelper.prototype.prepareFiltrableDataSource=function(a){var b=this,c=this.q_.defer();this.ngeoDataSourcesHelper_.getDataSourceAttributes(a).then(function(d){var e=(a.gmfLayer.metadata||{}).enumeratedAttributes;if(e&&e.length){var f=[],g={};d=$jscomp.makeIterator(d);for(var h=d.next();!h.done;g={attribute:g.attribute},h=d.next())g.attribute=h.value,!ol.array.includes(e,g.attribute.name)||g.attribute.type===ngeo.AttributeType.SELECT||g.attribute.choices&&g.attribute.choices.length||f.push(b.gmfEnumerateAttribute_.getAttributeValues(a,
g.attribute.name).then(function(a){return function(b){b=b.map(function(a){return a.value});a.attribute.type=ngeo.AttributeType.SELECT;a.attribute.choices=b}}(g)));return b.q_.all(f).then(c.resolve(a))}c.resolve(a)});return c.promise};goog.exportProperty(gmf.DataSourcesHelper.prototype,"prepareFiltrableDataSource",gmf.DataSourcesHelper.prototype.prepareFiltrableDataSource);$jscomp.global.Object.defineProperties(gmf.DataSourcesHelper.prototype,{collection:{configurable:!0,enumerable:!0,get:function(){return this.ngeoDataSourcesHelper_.collection}}});
gmf.DataSourcesHelper.$inject=["$q","gmfEnumerateAttribute","ngeoDataSourcesHelper"];gmf.module.service("gmfDataSourcesHelper",gmf.DataSourcesHelper);gmf.SavedFilters=function(a){var b=this;this.rootScope_=a;this.currentDataSourceId_=null;this.currentDataSourceItems_=[];this.localStorageKey_="gmf_savedfilters";this.useLocalStorage_=!0;try{"localStorage"in window?(window.localStorage.test="",delete window.localStorage.test):this.useLocalStorage_=!1}catch(c){console.error(c),this.useLocalStorage_=!1}this.items_=[];this.rootScope_.$watchCollection(function(){return b.items},function(){b.rePopulateCurrentDataSourceItems_()});this.useLocalStorage_&&
this.loadItemsFromLocalStorage_()};gmf.SavedFilters.prototype.loadItemsFromLocalStorage_=function(){if(window.localStorage[this.localStorageKey_]){var a=JSON.parse(window.localStorage[this.localStorageKey_]);goog.asserts.assertArray(a);this.items_=a}};gmf.SavedFilters.prototype.indexOfItem=function(a,b){for(var c,d=-1,e=0,f=this.items_.length;e<f;e++)if(c=this.items[e],c.dataSourceId===b&&c.name===a){d=e;break}return d};goog.exportProperty(gmf.SavedFilters.prototype,"indexOfItem",gmf.SavedFilters.prototype.indexOfItem);
gmf.SavedFilters.prototype.save=function(a){var b=this.indexOfItem(a.name,a.dataSourceId);-1!==b?this.items[b]=a:this.items.push(a);this.useLocalStorage_&&this.saveItemsInLocalStorage_()};goog.exportProperty(gmf.SavedFilters.prototype,"save",gmf.SavedFilters.prototype.save);gmf.SavedFilters.prototype.remove=function(a){ol.array.remove(this.items,a)&&this.useLocalStorage_&&this.saveItemsInLocalStorage_()};goog.exportProperty(gmf.SavedFilters.prototype,"remove",gmf.SavedFilters.prototype.remove);
gmf.SavedFilters.prototype.saveItemsInLocalStorage_=function(){window.localStorage[this.localStorageKey_]=JSON.stringify(this.items)};gmf.SavedFilters.prototype.rePopulateCurrentDataSourceItems_=function(){this.currentDataSourceItems_.length=0;if(null!==this.currentDataSourceId_)for(var a=$jscomp.makeIterator(this.items),b=a.next();!b.done;b=a.next())b=b.value,b.dataSourceId===this.currentDataSourceId_&&this.currentDataSourceItems_.push(b)};
$jscomp.global.Object.defineProperties(gmf.SavedFilters.prototype,{currentDataSourceItems:{configurable:!0,enumerable:!0,get:function(){return this.currentDataSourceItems_}},currentDataSourceId:{configurable:!0,enumerable:!0,set:function(a){this.currentDataSourceId_=a;this.rePopulateCurrentDataSourceItems_()}},items:{configurable:!0,enumerable:!0,get:function(){return this.items_}}});gmf.SavedFilters.$inject=["$rootScope"];gmf.module.service("gmfSavedFilters",gmf.SavedFilters);
gmf.SavedFilters.FilterItem=function(){};goog.exportSymbol("gmf.SavedFilters.FilterItem",gmf.SavedFilters.FilterItem);ngeo.DatePickerDirective={};ngeo.module.value("ngeoDatePickerTemplateUrl",function(a,b){a=b.ngeoDatePickerTemplateUrl;return void 0!==a?a:ngeo.baseTemplateUrl+"/datepicker.html"});
ngeo.DatePicker=function(a,b){return{scope:{onDateSelected:"&",time:"="},bindToController:!0,controller:"ngeoDatePickerController as datepickerCtrl",restrict:"AE",templateUrl:a,link:function(a,d,e,f){f.init();a=f.gettextCatalog_.getCurrentLanguage();$.datepicker.setDefaults($.datepicker.regional[a]);f.sdateOptions=angular.extend({},f.sdateOptions,{minDate:f.initialMinDate,maxDate:f.initialMaxDate,onClose:function(a){a&&$(d[0]).find('input[name="edate"]').datepicker("option","minDate",a)}});f.edateOptions=
angular.extend({},f.edateOptions,{minDate:f.initialMinDate,maxDate:f.initialMaxDate,onClose:function(a){a&&$(d[0]).find('input[name="sdate"]').datepicker("option","maxDate",a)}});angular.element("body").on("hidden.bs.popover",function(){var a=angular.element("#ui-datepicker-div");a&&"block"===a.css("display")&&$(d[0]).find('input[name$="date"]').datepicker("hide")});b(function(){angular.element("#ui-datepicker-div").on("mousedown",function(a){a.stopPropagation()})})}}};
ngeo.DatePicker.$inject=["ngeoDatePickerTemplateUrl","$timeout"];ngeo.module.directive("ngeoDatePicker",ngeo.DatePicker);
ngeo.DatePickerController=function(a,b,c,d){var e=this;this.ngeoTime_=c;this.gettextCatalog_=d;this.edateOptions={changeMonth:!0,changeYear:!0};this.sdateOptions={changeMonth:!0,changeYear:!0};a.$watchGroup(["datepickerCtrl.sdate","datepickerCtrl.edate"],function(a,b){b=a[0];a=a[1];if(angular.isDate(b)&&(!e.isModeRange||angular.isDate(a)))e.onDateSelected({time:{start:b.getTime(),end:a?a.getTime():null}})})};ngeo.DatePickerController.$inject=["$scope","$injector","ngeoTime","gettextCatalog"];
ngeo.DatePickerController.prototype.init=function(){var a=this.ngeoTime_.getOptions(this.time);this.initialMinDate=new Date(a.minDate);this.initialMaxDate=new Date(a.maxDate);(this.isModeRange="range"===this.time.mode)?(goog.asserts.assertArray(a.values),this.sdate=new Date(a.values[0]),this.edate=new Date(a.values[1])):(goog.asserts.assertNumber(a.values),this.sdate=new Date(a.values))};ngeo.module.controller("ngeoDatePickerController",ngeo.DatePickerController);ngeo.ruleComponent={};
ngeo.RuleController=function(a,b,c,d,e,f,g){this.gettextCatalog_=a;this.scope_=b;this.timeout_=c;this.ngeoDecorateInteraction_=d;this.ngeoFeatureHelper_=e;this.ngeoRuleHelper_=f;this.ngeoToolActivateMgr_=g;b=ngeo.rule.Rule.OperatorType;d=ngeo.rule.Rule.SpatialOperatorType;c=ngeo.rule.Rule.TemporalOperatorType;f={};this.operators=(f[b.EQUAL_TO]=a.getString("Is equal to"),f[b.GREATER_THAN]=a.getString("Is greater than"),f[b.GREATER_THAN_OR_EQUAL_TO]=a.getString("Is greater than or equal to"),f[b.LESSER_THAN]=
a.getString("Is lesser than"),f[b.LESSER_THAN_OR_EQUAL_TO]=a.getString("Is lesser than or equal to"),f[b.NOT_EQUAL_TO]=a.getString("Is not equal to"),f[b.LIKE]=a.getString("Contains"),f[d.CONTAINS]=a.getString("Contains"),f[d.INTERSECTS]=a.getString("Intersects"),f[d.WITHIN]=a.getString("Is inside of"),f[c.BEGINS]=a.getString("Begins at"),f[c.DURING]=a.getString("During"),f[c.ENDS]=a.getString("Ends at"),f[c.EQUALS]=a.getString("Is equal to"),f);a={};this.operatorsShortFormat=(a[b.EQUAL_TO]="=",a[b.GREATER_THAN]=
">",a[b.GREATER_THAN_OR_EQUAL_TO]=">=",a[b.LESSER_THAN]="<",a[b.LESSER_THAN_OR_EQUAL_TO]="<=",a[b.NOT_EQUAL_TO]="!=",a[b.LIKE]="~",a[c.BEGINS]=">=",a[c.ENDS]="<=",a[c.EQUALS]="=",a);this.timeRangeMode={widget:"datepicker",maxValue:this.createDate_(),minValue:this.createWeekAgoDate_(),maxDefValue:null,minDefValue:null,mode:"range",interval:[0,1,0,0]};this.timeValueMode={widget:"datepicker",maxValue:this.createDate_(),minValue:this.createDate_(),maxDefValue:null,minDefValue:null,mode:"value",interval:[0,
1,0,0]};this.unlisteners_=[];this.drawActive=!1;this.drawToolActivate=new ngeo.ToolActivate(this,"drawActive");this.drawnFeatures=new ol.Collection;this.menu_=null;this.selectedFeatures=new ol.Collection;this.interactions_=new ol.Collection;this.modify_=new ngeo.interaction.Modify({features:this.selectedFeatures,style:e.getVertexStyle(!1)});this.interactions_.push(this.modify_);this.rotate_=new ngeo.interaction.Rotate({features:this.selectedFeatures,style:new ol.style.Style({text:new ol.style.Text({text:"\uf01e",
font:"normal 18px FontAwesome",fill:new ol.style.Fill({color:"#7a7a7a"})})})});this.interactions_.push(this.rotate_);this.translate_=new ngeo.interaction.Translate({features:this.selectedFeatures,style:new ol.style.Style({text:new ol.style.Text({text:"\uf047",font:"normal 18px FontAwesome",fill:new ol.style.Fill({color:"#7a7a7a"})})})});this.interactions_.push(this.translate_);this.listenerKeys_=[];this.initializeInteractions_();this.modifyToolActivate=new ngeo.ToolActivate(this.modify_,"active");
this.rotateToolActivate=new ngeo.ToolActivate(this.rotate_,"active");this.translateToolActivate=new ngeo.ToolActivate(this.translate_,"active");this.geomType=null};
ngeo.RuleController.prototype.$onInit=function(){var a=this;this.clone=this.ngeoRuleHelper_.cloneRule(this.rule);this.toolActivate_=new ngeo.ToolActivate(this.rule,"active");this.ngeoToolActivateMgr_.registerTool(this.toolGroup,this.toolActivate_);this.scope_.$watch(function(){return a.rule.active},this.handleActiveChange_.bind(this));this.clone.type===ngeo.AttributeType.DATE||this.clone.type===ngeo.AttributeType.DATETIME?(this.unlisteners_.push(this.scope_.$watch(function(){return a.clone.getExpression()},
function(b){b=null===b?a.createDate_():b;a.timeValueMode.minValue=b})),this.unlisteners_.push(this.scope_.$watch(function(){return a.clone.lowerBoundary},function(b){b=null===b?a.createWeekAgoDate_():b;a.timeRangeMode.minValue=b})),this.unlisteners_.push(this.scope_.$watch(function(){return a.clone.upperBoundary},function(b){b=null===b?a.createDate_():b;a.timeRangeMode.maxValue=b}))):this.clone.type===ngeo.AttributeType.GEOMETRY&&(this.unlisteners_.push(this.scope_.$watch(function(){return a.clone.operator},
function(b){b&&b===ngeo.rule.Rule.SpatialOperatorType.CONTAINS&&(b=goog.asserts.assertInstanceof(a.clone,ngeo.rule.Geometry),b.feature.getGeometry()&&(b=a.ngeoFeatureHelper_.getType(b.feature),ol.array.includes([ngeo.GeometryType.CIRCLE,ngeo.GeometryType.POLYGON,ngeo.GeometryType.RECTANGLE],b)||a.clone.setExpression(null)))})),this.unlisteners_.push(this.scope_.$watch(function(){return a.clone.expression},function(b){b?(b=goog.asserts.assertInstanceof(a.clone,ngeo.rule.Geometry),a.geomType=a.ngeoFeatureHelper_.getType(b.feature)):
a.geomType=null})),this.unlisteners_.push(this.scope_.$watch(function(){var b=null!==a.clone.getExpression(),c=!0===a.rule.active,d=a.modify_.getActive()||a.rotate_.getActive()||a.translate_.getActive();return b&&c&&d},function(b){b?(b=goog.asserts.assertInstanceof(a.clone,ngeo.rule.Geometry),a.selectedFeatures.push(b.feature)):a.selectedFeatures.clear()})))};
ngeo.RuleController.prototype.$onDestroy=function(){this.rule.active&&(this.rule.active=!1,this.handleActiveChange_(!1,!0));this.ngeoToolActivateMgr_.unregisterTool(this.toolGroup,this.toolActivate_);for(var a=0,b=this.unlisteners_.length;a<b;a++)this.unlisteners_[a]();this.unlisteners_.length=0;this.clone.destroy()};ngeo.RuleController.prototype.toggle=function(){this.rule.active?this.cancel():this.rule.active=!0};goog.exportProperty(ngeo.RuleController.prototype,"toggle",ngeo.RuleController.prototype.toggle);
ngeo.RuleController.prototype.apply=function(){this.ngeoRuleHelper_.extendRule(this.clone,this.rule);this.rule.active=!1};goog.exportProperty(ngeo.RuleController.prototype,"apply",ngeo.RuleController.prototype.apply);ngeo.RuleController.prototype.cancel=function(){this.ngeoRuleHelper_.extendRule(this.rule,this.clone);this.rule.active=!1};goog.exportProperty(ngeo.RuleController.prototype,"cancel",ngeo.RuleController.prototype.cancel);
ngeo.RuleController.prototype.reset=function(){this.clone.reset();this.rule.reset()};goog.exportProperty(ngeo.RuleController.prototype,"reset",ngeo.RuleController.prototype.reset);ngeo.RuleController.prototype.toggleChoiceSelection=function(a){var b=goog.asserts.assertInstanceof(this.clone,ngeo.rule.Select),c=b.getExpression()?b.getExpression().split(","):[],d=c.indexOf(a);-1<d?c.splice(d,1):c.push(a);b.setExpression(c.length?c.join(","):null)};
goog.exportProperty(ngeo.RuleController.prototype,"toggleChoiceSelection",ngeo.RuleController.prototype.toggleChoiceSelection);ngeo.RuleController.prototype.onDateSelected=function(a){this.clone.setExpression(a.start)};goog.exportProperty(ngeo.RuleController.prototype,"onDateSelected",ngeo.RuleController.prototype.onDateSelected);ngeo.RuleController.prototype.onDateRangeSelected=function(a){this.clone.lowerBoundary=a.start;this.clone.upperBoundary=a.end};
goog.exportProperty(ngeo.RuleController.prototype,"onDateRangeSelected",ngeo.RuleController.prototype.onDateRangeSelected);ngeo.RuleController.prototype.createDate_=function(a){var b=new Date;void 0!==a&&(a=b.getTime()-a,b.setTime(a));return b.toISOString()};ngeo.RuleController.prototype.createWeekAgoDate_=function(){return this.createDate_(6048E5)};ngeo.RuleController.prototype.timeToDate=function(a){return(new Date(a)).toLocaleDateString()};
goog.exportProperty(ngeo.RuleController.prototype,"timeToDate",ngeo.RuleController.prototype.timeToDate);
ngeo.RuleController.prototype.handleActiveChange_=function(a,b){if(this.rule instanceof ngeo.rule.Geometry&&this.clone instanceof ngeo.rule.Geometry&&a!==b){b=this.listenerKeys_;var c=["ngeo-rule-",ol.getUid(this)].join("-"),d=this.ngeoToolActivateMgr_,e=this.rule.feature,f=this.clone.feature,g=this.map.getViewport();goog.asserts.assertElement(g);a?(b.push(ol.events.listen(this.drawnFeatures,ol.CollectionEventType.ADD,this.handleFeaturesAdd_,this)),b.push(ol.events.listen(g,"contextmenu",this.handleMapContextMenu_,
this)),b.push(ol.events.listen(this.translate_,ol.interaction.TranslateEventType.TRANSLATEEND,this.handleTranslateEnd_,this)),b.push(ol.events.listen(this.rotate_,ngeo.RotateEventType.ROTATEEND,this.handleRotateEnd_,this)),this.featureOverlay.removeFeature(e),this.featureOverlay.addFeature(f),this.registerInteractions_(),d.registerTool(c,this.drawToolActivate,!1),d.registerTool(c,this.modifyToolActivate,!0),d.registerTool(c,this.rotateToolActivate,!1),d.registerTool(c,this.translateToolActivate,!1),
this.modify_.setActive(!0),f.getGeometry()&&this.ngeoFeatureHelper_.setStyle(f,!0)):(f.setStyle(null),ol.Observable.unByKey(b),this.drawActive=!1,d.unregisterTool(c,this.drawToolActivate),d.unregisterTool(c,this.modifyToolActivate),d.unregisterTool(c,this.rotateToolActivate),d.unregisterTool(c,this.translateToolActivate),this.modify_.setActive(!1),this.unregisterInteractions_(),this.selectedFeatures.getLength()&&this.featureOverlay.removeFeature(f),this.featureOverlay.addFeature(e),this.selectedFeatures.clear())}};
ngeo.RuleController.prototype.initializeInteractions_=function(){var a=this;this.interactions_.forEach(function(b){b.setActive(!1);a.ngeoDecorateInteraction_(b)})};ngeo.RuleController.prototype.registerInteractions_=function(){var a=this;this.interactions_.forEach(function(b){a.map.addInteraction(b)})};ngeo.RuleController.prototype.unregisterInteractions_=function(){var a=this;this.interactions_.forEach(function(b){a.map.removeInteraction(b)})};
ngeo.RuleController.prototype.handleFeaturesAdd_=function(a){var b=this;this.timeout_(function(){var c=goog.asserts.assertInstanceof(b.clone,ngeo.rule.Geometry),d=c.feature,e=goog.asserts.assertInstanceof(a.element,ol.Feature),f=goog.asserts.assertInstanceof(e.getGeometry(),ol.geom.Geometry);c.geometry=f;b.drawActive=!1;c=b.ngeoFeatureHelper_.getNonSpatialProperties(e);b.ngeoFeatureHelper_.clearNonSpatialProperties(d);d.setProperties(c);b.ngeoFeatureHelper_.setStyle(d,!0);b.scope_.$apply()})};
ngeo.RuleController.prototype.getRuleGeometryType=function(){var a=goog.asserts.assertInstanceof(this.rule,ngeo.rule.Geometry);return this.ngeoFeatureHelper_.getType(a.feature)};goog.exportProperty(ngeo.RuleController.prototype,"getRuleGeometryType",ngeo.RuleController.prototype.getRuleGeometryType);
ngeo.RuleController.prototype.handleMapContextMenu_=function(a){var b=this;this.removeMenu_();var c=this.map.getEventPixel(a),d=this.map.getCoordinateFromPixel(c),e=this.map.forEachFeatureAtPixel(c,function(a){var c=!1;ol.array.includes(b.selectedFeatures.getArray(),a)&&(c=a);return c});e=e?e:null;c=[];e&&(e=this.ngeoFeatureHelper_.getType(e),e!=ngeo.GeometryType.CIRCLE&&e!=ngeo.GeometryType.LINE_STRING&&e!=ngeo.GeometryType.POLYGON&&e!=ngeo.GeometryType.RECTANGLE||c.push({cls:"fa fa-arrows",label:this.gettextCatalog_.getString("Move"),
name:ngeo.RuleController.MenuActionType.MOVE}),e!=ngeo.GeometryType.LINE_STRING&&e!=ngeo.GeometryType.POLYGON&&e!=ngeo.GeometryType.RECTANGLE||c.push({cls:"fa fa-rotate-right",label:this.gettextCatalog_.getString("Rotate"),name:ngeo.RuleController.MenuActionType.ROTATE}));c.length&&(this.menu_=new ngeo.Menu({actions:c}),ol.events.listen(this.menu_,ngeo.MenuEventType.ACTION_CLICK,this.handleMenuActionClick_,this),this.map.addOverlay(this.menu_),this.menu_.open(d),a.preventDefault(),a.stopPropagation(),
this.scope_.$apply())};ngeo.RuleController.prototype.removeMenu_=function(){this.menu_&&(ol.events.unlisten(this.menu_,ngeo.MenuEventType.ACTION_CLICK,this.handleMenuActionClick_,this),this.map.removeOverlay(this.menu_),this.menu_=null)};
ngeo.RuleController.prototype.handleMenuActionClick_=function(a){a=a.action;switch(a){case ngeo.RuleController.MenuActionType.MOVE:this.translate_.setActive(!0);this.scope_.$apply();break;case ngeo.RuleController.MenuActionType.ROTATE:this.rotate_.setActive(!0);this.scope_.$apply();break;default:console.log("FIXME - support: "+a)}};ngeo.RuleController.prototype.handleRotateEnd_=function(a){this.rotate_.setActive(!1);this.scope_.$apply()};
ngeo.RuleController.prototype.handleTranslateEnd_=function(a){this.translate_.setActive(!1);this.scope_.$apply()};ngeo.RuleController.$inject="gettextCatalog $scope $timeout ngeoDecorateInteraction ngeoFeatureHelper ngeoRuleHelper ngeoToolActivateMgr".split(" ");ngeo.RuleController.MenuActionType={MOVE:"move",ROTATE:"rotate"};
ngeo.module.component("ngeoRule",{bindings:{featureOverlay:"<",map:"<",rule:"<",toolGroup:"<"},controller:ngeo.RuleController,controllerAs:"ruleCtrl",templateUrl:function(){return ngeo.baseTemplateUrl+"/rule.html"}});ngeo.filterComponent={};ngeo.FilterController=function(a,b,c,d,e){this.gettextCatalog_=a;this.scope_=b;this.timeout_=c;this.ngeoMapQuerent_=d;this.ngeoRuleHelper_=e;this.conditions=[{text:a.getString("All"),value:ngeo.FilterCondition.AND},{text:a.getString("At least one"),value:ngeo.FilterCondition.OR},{text:a.getString("None"),value:ngeo.FilterCondition.NOT}];this.geometryAttributes=[];this.otherAttributes=[];this.ruleUnlisteners_={}};
ngeo.FilterController.prototype.$onInit=function(){var a=this;this.scope_.$watch(function(){return a.aRuleIsActive},this.handleARuleIsActiveChange_.bind(this));var b=goog.asserts.assert(this.datasource.attributes);b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next())c=c.value,c.type===ngeo.AttributeType.GEOMETRY?this.geometryAttributes.push(c):this.otherAttributes.push(c);b=[].concat(this.customRules,this.directedRules);b=$jscomp.makeIterator(b);for(c=b.next();!c.done;c=b.next())this.registerRule_(c.value);
this.apply()};ngeo.FilterController.prototype.$onDestroy=function(){null!==this.datasource.filterRules&&(this.datasource.filterRules=null);this.featureOverlay.clear()};ngeo.FilterController.prototype.hasARule=function(){return 0<[].concat(this.customRules,this.directedRules).length};goog.exportProperty(ngeo.FilterController.prototype,"hasARule",ngeo.FilterController.prototype.hasARule);
ngeo.FilterController.prototype.apply=function(){var a=this;this.datasource.filterRules=null;this.timeout_(function(){var b=a.getRulesWithValue_();b.length&&(a.datasource.filterRules=b,a.ngeoMapQuerent_.clear())})};goog.exportProperty(ngeo.FilterController.prototype,"apply",ngeo.FilterController.prototype.apply);
ngeo.FilterController.prototype.getData=function(){var a=this.getRulesWithValue_();if(a.length){var b=this.datasource,c=this.map,d=c.getView().getProjection().getCode();a=this.ngeoRuleHelper_.createFilter({dataSource:b,filterRules:a,srsName:d});goog.asserts.assert(a);this.ngeoMapQuerent_.issue({dataSources:[b],filter:a,limit:1E3,map:c})}};goog.exportProperty(ngeo.FilterController.prototype,"getData",ngeo.FilterController.prototype.getData);
ngeo.FilterController.prototype.getRulesWithValue_=function(){var a=[],b=[].concat(this.customRules,this.directedRules);b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next())c=c.value,c.value&&a.push(c);return a};ngeo.FilterController.prototype.createAndAddCustomRule=function(a){var b=this.ngeoRuleHelper_.createRuleFromAttribute(a,!0);this.registerRule_(b);this.customRules.push(b);this.timeout_(function(){b.active=!0},1)};
goog.exportProperty(ngeo.FilterController.prototype,"createAndAddCustomRule",ngeo.FilterController.prototype.createAndAddCustomRule);ngeo.FilterController.prototype.setCondition=function(a){this.datasource.filterCondition!==a.value&&(this.datasource.filterCondition=a.value)};goog.exportProperty(ngeo.FilterController.prototype,"setCondition",ngeo.FilterController.prototype.setCondition);
ngeo.FilterController.prototype.removeCustomRule=function(a){var b=this;a.active=!1;this.timeout_(function(){ol.array.remove(b.customRules,a);b.unregisterRule_(a);a.destroy()})};goog.exportProperty(ngeo.FilterController.prototype,"removeCustomRule",ngeo.FilterController.prototype.removeCustomRule);
ngeo.FilterController.prototype.registerRule_=function(a){var b=ol.getUid(a);this.ruleUnlisteners_[b]=this.scope_.$watch(function(){return a.active},this.handleRuleActiveChange_.bind(this));a instanceof ngeo.rule.Geometry&&this.featureOverlay.addFeature(a.feature)};goog.exportProperty(ngeo.FilterController.prototype,"registerRule_",ngeo.FilterController.prototype.registerRule_);
ngeo.FilterController.prototype.unregisterRule_=function(a){var b=ol.getUid(a),c=this.ruleUnlisteners_[b];goog.asserts.assert(c);c();delete this.ruleUnlisteners_[b];a instanceof ngeo.rule.Geometry&&this.featureOverlay.removeFeature(a.feature)};goog.exportProperty(ngeo.FilterController.prototype,"unregisterRule_",ngeo.FilterController.prototype.unregisterRule_);
ngeo.FilterController.prototype.handleRuleActiveChange_=function(){var a=!1,b=[].concat(this.customRules,this.directedRules);b=$jscomp.makeIterator(b);for(var c=b.next();!c.done;c=b.next())if(c.value.active){a=!0;break}this.aRuleIsActive=a};ngeo.FilterController.prototype.handleARuleIsActiveChange_=function(){if(!this.aRuleIsActive){var a=[].concat(this.customRules,this.directedRules);a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())if(b=b.value,b.active){b.active=!1;break}}};
ngeo.FilterController.$inject=["gettextCatalog","$scope","$timeout","ngeoMapQuerent","ngeoRuleHelper"];ngeo.module.component("ngeoFilter",{bindings:{aRuleIsActive:"=",customRules:"<",datasource:"<",directedRules:"<",featureOverlay:"<",map:"<",toolGroup:"<"},controller:ngeo.FilterController,controllerAs:"filterCtrl",templateUrl:function(){return ngeo.baseTemplateUrl+"/filter.html"}});gmf.filterselectorComponent={};
gmf.FilterselectorController=function(a,b,c,d,e,f,g,h,k,l){var m=this;a.$watch(function(){return m.active},this.handleActiveChange_.bind(this));this.timeout_=b;this.gettextCatalog_=c;this.gmfDataSourceBeingFiltered=d;a.$watch(function(){return m.gmfDataSourceBeingFiltered.dataSource},this.handleSelectedDataSourceChange_.bind(this));this.gmfDataSourcesHelper_=e;this.gmfSavedFilters=f;a.$watchCollection(function(){return m.gmfSavedFilters.currentDataSourceItems},function(){0===m.gmfSavedFilters.currentDataSourceItems.length&&
m.saveFilterManageModalShown&&(m.saveFilterManageModalShown=!1)});this.gmfUser_=g;a.$watch(function(){return m.gmfUser_.functionalities},this.handleGmfUserFunctionalitiesChange_.bind(this));this.ngeoNotification_=h;this.featureOverlay=goog.asserts.assert(k.getFeatureOverlay());this.ngeoRuleHelper_=l;this.aRuleIsActive=!1;this.directedRules=this.customRules=null;this.filtrableDataSources=[];this.filtrableLayerNodeNames_=null;this.gmfDataSources_=e.collection;this.listenerKeys_=[];this.readyDataSource=
null;this.ruleCache_={};this.saveFilterSaveModalShown=!1;a.$watch(function(){return m.saveFilterSaveModalShown},function(){m.saveFilterName=""});this.saveFilterName="";this.enableDataSourceRegistration_=this.saveFilterManageModalShown=!1;a.$watch(function(){return m.enableDataSourceRegistration_},this.handleEnableDataSourceRegistrationChange_.bind(this));this.toggleDataSourceRegistration_()};
gmf.FilterselectorController.prototype.handleGmfUserFunctionalitiesChange_=function(){var a=this.gmfUser_.functionalities;this.filtrableLayerNodeNames_=a&&a.filterable_layers?a.filterable_layers:null;this.defaultFiltrableDataSourceName_=a&&a.preset_layer_filter&&a.preset_layer_filter[0]?a.preset_layer_filter[0]:void 0;this.toggleDataSourceRegistration_()};
gmf.FilterselectorController.prototype.toggleDataSourceRegistration_=function(){var a=!!this.filtrableLayerNodeNames_;this.enableDataSourceRegistration_!==a&&(this.enableDataSourceRegistration_=a)};gmf.FilterselectorController.prototype.handleActiveChange_=function(a){var b=this;a||(this.aRuleIsActive=!1,this.timeout_(function(){b.gmfDataSourceBeingFiltered.dataSource=null}))};
gmf.FilterselectorController.prototype.handleEnableDataSourceRegistrationChange_=function(a){var b=this.listenerKeys_;a?(b.push(ol.events.listen(this.gmfDataSources_,ol.CollectionEventType.ADD,this.handleDataSourcesAdd_,this)),b.push(ol.events.listen(this.gmfDataSources_,ol.CollectionEventType.REMOVE,this.handleDataSourcesRemove_,this)),this.gmfDataSources_.forEach(this.registerDataSource_,this)):(ol.Observable.unByKey(b),b.length=0,this.filtrableDataSources.length=0)};
gmf.FilterselectorController.prototype.handleDataSourcesAdd_=function(a){a=a.element;goog.asserts.assertInstanceof(a,gmf.DataSource);this.registerDataSource_(a)};gmf.FilterselectorController.prototype.handleDataSourcesRemove_=function(a){a=a.element;goog.asserts.assertInstanceof(a,gmf.DataSource);this.unregisterDataSource_(a)};
gmf.FilterselectorController.prototype.registerDataSource_=function(a){null===a.filtrable&&(a.filtrable=this.isDataSourceFiltrable_(a));a.filtrable&&(this.filtrableDataSources.push(a),void 0!==this.defaultFiltrableDataSourceName_&&a.name===this.defaultFiltrableDataSourceName_&&(this.gmfDataSourceBeingFiltered.dataSource=a))};
gmf.FilterselectorController.prototype.unregisterDataSource_=function(a){a.filtrable&&(ol.array.remove(this.filtrableDataSources,a),this.gmfDataSourceBeingFiltered.dataSource===a&&(this.gmfDataSourceBeingFiltered.dataSource=null))};
gmf.FilterselectorController.prototype.isDataSourceFiltrable_=function(a,b){var c=this.gettextCatalog_,d=!1!==b;var e=goog.asserts.assert(this.filtrableLayerNodeNames_);b=[];ol.array.includes(e,a.name)?(a.supportsWFS||b.push(c.getString("The data source doesn't support WFS, which is required to fetch the attributes to build the filter rules.")),a.ogcLayers&&a.ogcLayers.length?a.ogcLayers[0].queryable||b.push(c.getString("The ogcLayer within the data source must be queryable.")):b.push(c.getString("The data source must have only 1 ogcLayer defined.")),
e=!b.length,d&&!e&&(d=c.getString("The following data source is marked as being filtrable,\n          but is missing some requirements: "),a=a.name+" ("+a.id+").",c=c.getString("Please, contact your administrator about this.\n          Here are the reasons: "),b.unshift(d+" "+a+" "+c),console.warn(b.join(" ")),this.ngeoNotification_.notify({msg:b.join(" "),type:ngeo.MessageType.WARNING}))):e=!1;return e};
gmf.FilterselectorController.prototype.handleSelectedDataSourceChange_=function(a){var b=this;this.aRuleIsActive=!1;this.readyDataSource=this.directedRules=this.customRules=null;this.gmfSavedFilters.currentDataSourceId=null;a&&(this.active||(this.active=!0),this.gmfDataSourcesHelper_.prepareFiltrableDataSource(a).then(function(a){var c=b.getRuleCacheItem_(a);if(!c&&(c={customRules:[],directedRules:[]},b.setRuleCacheItem_(a,c),a.gmfLayer.metadata&&a.gmfLayer.metadata.directedFilterAttributes&&a.gmfLayer.metadata.directedFilterAttributes.length)){var e=
a.gmfLayer.metadata.directedFilterAttributes,f=goog.asserts.assert(a.attributes);f=$jscomp.makeIterator(f);for(var g=f.next();!g.done;g=f.next())g=g.value,ol.array.includes(e,g.name)&&c.directedRules.push(b.ngeoRuleHelper_.createRuleFromAttribute(g))}b.customRules=c.customRules;b.directedRules=c.directedRules;b.readyDataSource=a;b.gmfSavedFilters.currentDataSourceId=a.id}))};gmf.FilterselectorController.prototype.getRuleCacheItem_=function(a){return this.ruleCache_[a.id]||null};
gmf.FilterselectorController.prototype.setRuleCacheItem_=function(a,b){this.ruleCache_[a.id]=b};gmf.FilterselectorController.prototype.saveFilterShowModal=function(){this.saveFilterSaveModalShown=!0};goog.exportProperty(gmf.FilterselectorController.prototype,"saveFilterShowModal",gmf.FilterselectorController.prototype.saveFilterShowModal);
gmf.FilterselectorController.prototype.saveFilterSave=function(){var a=this.saveFilterName,b=goog.asserts.assert(this.readyDataSource),c=b.id,d=-1!==this.gmfSavedFilters.indexOfItem(a,c);b=b.filterCondition;var e=this.gettextCatalog_.getString("A filter with the same name already exists.\n      Do you want to overwrite it?");if(!d||confirm(e))d=this.customRules?this.ngeoRuleHelper_.serializeRules(this.customRules):[],e=this.directedRules?this.ngeoRuleHelper_.serializeRules(this.directedRules):[],
this.gmfSavedFilters.save({condition:b,customRules:d,dataSourceId:c,directedRules:e,name:a}),this.saveFilterSaveModalShown=!1};goog.exportProperty(gmf.FilterselectorController.prototype,"saveFilterSave",gmf.FilterselectorController.prototype.saveFilterSave);
gmf.FilterselectorController.prototype.saveFilterLoadItem=function(a){var b=this,c=goog.asserts.assert(this.readyDataSource);this.directedRules=this.customRules=null;var d=this.ngeoRuleHelper_.createRules(a.customRules),e=this.ngeoRuleHelper_.createRules(a.directedRules);this.timeout_(function(){b.customRules=d;b.directedRules=e;c.filterCondition=a.condition;var f=goog.asserts.assert(b.getRuleCacheItem_(c));f.customRules=d;f.directedRules=e})};
goog.exportProperty(gmf.FilterselectorController.prototype,"saveFilterLoadItem",gmf.FilterselectorController.prototype.saveFilterLoadItem);gmf.FilterselectorController.prototype.saveFilterManage=function(){this.saveFilterManageModalShown=!0};goog.exportProperty(gmf.FilterselectorController.prototype,"saveFilterManage",gmf.FilterselectorController.prototype.saveFilterManage);gmf.FilterselectorController.prototype.saveFilterRemoveItem=function(a){this.gmfSavedFilters.remove(a)};
goog.exportProperty(gmf.FilterselectorController.prototype,"saveFilterRemoveItem",gmf.FilterselectorController.prototype.saveFilterRemoveItem);gmf.FilterselectorController.$inject="$scope $timeout gettextCatalog gmfDataSourceBeingFiltered gmfDataSourcesHelper gmfSavedFilters gmfUser ngeoNotification ngeoFeatureOverlayMgr ngeoRuleHelper".split(" ");
gmf.module.component("gmfFilterselector",{bindings:{active:"=",map:"<",toolGroup:"<"},controller:gmf.FilterselectorController,controllerAs:"fsCtrl",templateUrl:function(){return gmf.baseTemplateUrl+"/filterselector.html"}});ol.control.MousePosition=function(a){a=a?a:{};var b=document.createElement("DIV");b.className=void 0!==a.className?a.className:"ol-mouse-position";ol.control.Control.call(this,{element:b,render:a.render?a.render:ol.control.MousePosition.render,target:a.target});ol.events.listen(this,ol.Object.getChangeEventType(ol.control.MousePosition.Property_.PROJECTION),this.handleProjectionChanged_,this);a.coordinateFormat&&this.setCoordinateFormat(a.coordinateFormat);a.projection&&this.setProjection(a.projection);
this.undefinedHTML_=void 0!==a.undefinedHTML?a.undefinedHTML:"";this.renderedHTML_=b.innerHTML;this.lastMouseMovePixel_=this.transform_=this.mapProjection_=null};ol.inherits(ol.control.MousePosition,ol.control.Control);ol.control.MousePosition.render=function(a){a=a.frameState;a?this.mapProjection_!=a.viewState.projection&&(this.mapProjection_=a.viewState.projection,this.transform_=null):this.mapProjection_=null;this.updateHTML_(this.lastMouseMovePixel_)};
ol.control.MousePosition.prototype.handleProjectionChanged_=function(){this.transform_=null};ol.control.MousePosition.prototype.getCoordinateFormat=function(){return this.get(ol.control.MousePosition.Property_.COORDINATE_FORMAT)};ol.control.MousePosition.prototype.getProjection=function(){return this.get(ol.control.MousePosition.Property_.PROJECTION)};ol.control.MousePosition.prototype.handleMouseMove=function(a){this.lastMouseMovePixel_=this.getMap().getEventPixel(a);this.updateHTML_(this.lastMouseMovePixel_)};
ol.control.MousePosition.prototype.handleMouseOut=function(a){this.updateHTML_(null);this.lastMouseMovePixel_=null};ol.control.MousePosition.prototype.setMap=function(a){ol.control.Control.prototype.setMap.call(this,a);a&&(a=a.getViewport(),this.listenerKeys.push(ol.events.listen(a,ol.events.EventType.MOUSEMOVE,this.handleMouseMove,this),ol.events.listen(a,ol.events.EventType.MOUSEOUT,this.handleMouseOut,this)))};
ol.control.MousePosition.prototype.setCoordinateFormat=function(a){this.set(ol.control.MousePosition.Property_.COORDINATE_FORMAT,a)};ol.control.MousePosition.prototype.setProjection=function(a){this.set(ol.control.MousePosition.Property_.PROJECTION,ol.proj.get(a))};
ol.control.MousePosition.prototype.updateHTML_=function(a){var b=this.undefinedHTML_;if(a&&this.mapProjection_){if(!this.transform_){var c=this.getProjection();this.transform_=c?ol.proj.getTransformFromProjections(this.mapProjection_,c):ol.proj.identityTransform}if(a=this.getMap().getCoordinateFromPixel(a))this.transform_(a,a),b=(b=this.getCoordinateFormat())?b(a):a.toString()}this.renderedHTML_&&b==this.renderedHTML_||(this.renderedHTML_=this.element.innerHTML=b)};
ol.control.MousePosition.Property_={PROJECTION:"projection",COORDINATE_FORMAT:"coordinateFormat"};gmf.mousepositionComponent={controller:"gmfMousepositionController as ctrl",bindings:{map:"<gmfMousepositionMap",projections:"<gmfMousepositionProjections"},templateUrl:function(){return gmf.baseTemplateUrl+"/mouseposition.html"}};gmf.module.component("gmfMouseposition",gmf.mousepositionComponent);gmf.MousepositionController=function(a,b,c,d){this.$scope_=c;this.gettextCatalog_=d;this.$element_=a;this.$filter_=b;this.control_=null};
gmf.MousepositionController.$inject=["$element","$filter","$scope","gettextCatalog"];gmf.MousepositionController.prototype.$onInit=function(){var a=this;this.$scope_.$on("gettextLanguageChanged",function(){a.initOlControl_()});this.initOlControl_()};
gmf.MousepositionController.prototype.initOlControl_=function(){null!==this.control_&&this.map.removeControl(this.control_);var a=this.gettextCatalog_;this.control_=new ol.control.MousePosition({className:"gmf-mouseposition-control",coordinateFormat:function(a){var b=this.projection.filter.split(":"),d=this.$filter_(b.shift());goog.asserts.assertFunction(d);b.unshift(a);return d.apply(this,b)}.bind(this),target:angular.element(".gmf-mouseposition-control-target",this.$element_)[0],undefinedHTML:a.getString("Coordinates")});
this.setProjection(this.projections[0]);this.map.addControl(this.control_)};gmf.MousepositionController.prototype.setProjection=function(a){this.control_.setProjection(ol.proj.get(a.code));this.projection=a};goog.exportProperty(gmf.MousepositionController.prototype,"setProjection",gmf.MousepositionController.prototype.setProjection);gmf.module.controller("gmfMousepositionController",gmf.MousepositionController);goog.color={};
goog.color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};goog.math={};goog.math.randomInt=function(a){return Math.floor(Math.random()*a)};goog.math.uniformRandom=function(a,b){return a+Math.random()*(b-a)};goog.math.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};goog.math.modulo=function(a,b){a%=b;return 0>a*b?a+b:a};goog.math.lerp=function(a,b,c){return a+c*(b-a)};goog.math.nearlyEquals=function(a,b,c){return Math.abs(a-b)<=(c||1E-6)};goog.math.standardAngle=function(a){return goog.math.modulo(a,360)};
goog.math.standardAngleInRadians=function(a){return goog.math.modulo(a,2*Math.PI)};goog.math.toRadians=function(a){return a*Math.PI/180};goog.math.toDegrees=function(a){return 180*a/Math.PI};goog.math.angleDx=function(a,b){return b*Math.cos(goog.math.toRadians(a))};goog.math.angleDy=function(a,b){return b*Math.sin(goog.math.toRadians(a))};goog.math.angle=function(a,b,c,d){return goog.math.standardAngle(goog.math.toDegrees(Math.atan2(d-b,c-a)))};
goog.math.angleDifference=function(a,b){a=goog.math.standardAngle(b)-goog.math.standardAngle(a);180<a?a-=360:-180>=a&&(a=360+a);return a};goog.math.sign=function(a){return 0<a?1:0>a?-1:a};
goog.math.longestCommonSubsequence=function(a,b,c,d){c=c||function(a,b){return a==b};d=d||function(b,c){return a[b]};for(var e=a.length,f=b.length,g=[],h=0;h<e+1;h++)g[h]=[],g[h][0]=0;for(var k=0;k<f+1;k++)g[0][k]=0;for(h=1;h<=e;h++)for(k=1;k<=f;k++)c(a[h-1],b[k-1])?g[h][k]=g[h-1][k-1]+1:g[h][k]=Math.max(g[h-1][k],g[h][k-1]);var l=[];h=e;for(k=f;0<h&&0<k;)c(a[h-1],b[k-1])?(l.unshift(d(h-1,k-1)),h--,k--):g[h-1][k]>g[h][k-1]?h--:k--;return l};
goog.math.sum=function(a){return goog.array.reduce(arguments,function(a,c){return a+c},0)};goog.math.average=function(a){return goog.math.sum.apply(null,arguments)/arguments.length};goog.math.sampleVariance=function(a){var b=arguments.length;if(2>b)return 0;var c=goog.math.average.apply(null,arguments);return goog.math.sum.apply(null,goog.array.map(arguments,function(a){return Math.pow(a-c,2)}))/(b-1)};goog.math.standardDeviation=function(a){return Math.sqrt(goog.math.sampleVariance.apply(null,arguments))};
goog.math.isInt=function(a){return isFinite(a)&&0==a%1};goog.math.isFiniteNumber=function(a){return isFinite(a)};goog.math.isNegativeZero=function(a){return 0==a&&0>1/a};goog.math.log10Floor=function(a){if(0<a){var b=Math.round(Math.log(a)*Math.LOG10E);return b-(parseFloat("1e"+b)>a?1:0)}return 0==a?-Infinity:NaN};goog.math.safeFloor=function(a,b){goog.asserts.assert(!goog.isDef(b)||0<b);return Math.floor(a+(b||2E-15))};
goog.math.safeCeil=function(a,b){goog.asserts.assert(!goog.isDef(b)||0<b);return Math.ceil(a-(b||2E-15))};goog.color.parse=function(a){var b={};a=String(a);var c=goog.color.prependHashIfNecessaryHelper(a);if(goog.color.isValidHexColor_(c))return b.hex=goog.color.normalizeHex(c),b.type="hex",b;c=goog.color.isValidRgbColor_(a);if(c.length)return b.hex=goog.color.rgbArrayToHex(c),b.type="rgb",b;if(goog.color.names&&(c=goog.color.names[a.toLowerCase()]))return b.hex=c,b.type="named",b;throw Error(a+" is not a valid color string");};
goog.color.isValidColor=function(a){var b=goog.color.prependHashIfNecessaryHelper(a);return!!(goog.color.isValidHexColor_(b)||goog.color.isValidRgbColor_(a).length||goog.color.names&&goog.color.names[a.toLowerCase()])};goog.color.parseRgb=function(a){var b=goog.color.isValidRgbColor_(a);if(!b.length)throw Error(a+" is not a valid RGB color");return b};goog.color.hexToRgbStyle=function(a){return goog.color.rgbStyle_(goog.color.hexToRgb(a))};goog.color.hexTripletRe_=/#(.)(.)(.)/;
goog.color.normalizeHex=function(a){if(!goog.color.isValidHexColor_(a))throw Error("'"+a+"' is not a valid hex color");4==a.length&&(a=a.replace(goog.color.hexTripletRe_,"#$1$1$2$2$3$3"));return a.toLowerCase()};goog.color.hexToRgb=function(a){a=goog.color.normalizeHex(a);var b=parseInt(a.substr(1,2),16),c=parseInt(a.substr(3,2),16);a=parseInt(a.substr(5,2),16);return[b,c,a]};
goog.color.rgbToHex=function(a,b,c){a=Number(a);b=Number(b);c=Number(c);if(a!=(a&255)||b!=(b&255)||c!=(c&255))throw Error('"('+a+","+b+","+c+'") is not a valid RGB color');a=goog.color.prependZeroIfNecessaryHelper(a.toString(16));b=goog.color.prependZeroIfNecessaryHelper(b.toString(16));c=goog.color.prependZeroIfNecessaryHelper(c.toString(16));return"#"+a+b+c};goog.color.rgbArrayToHex=function(a){return goog.color.rgbToHex(a[0],a[1],a[2])};
goog.color.rgbToHsl=function(a,b,c){a/=255;b/=255;c/=255;var d=Math.max(a,b,c),e=Math.min(a,b,c),f=0,g=0,h=.5*(d+e);d!=e&&(d==a?f=60*(b-c)/(d-e):d==b?f=60*(c-a)/(d-e)+120:d==c&&(f=60*(a-b)/(d-e)+240),g=0<h&&.5>=h?(d-e)/(2*h):(d-e)/(2-2*h));return[Math.round(f+360)%360,g,h]};goog.color.rgbArrayToHsl=function(a){return goog.color.rgbToHsl(a[0],a[1],a[2])};goog.color.hueToRgb_=function(a,b,c){0>c?c+=1:1<c&&--c;return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a};
goog.color.hslToRgb=function(a,b,c){a/=360;if(0==b)c=b=a=255*c;else{var d=.5>c?c*(1+b):c+b-b*c;var e=2*c-d;c=255*goog.color.hueToRgb_(e,d,a+1/3);b=255*goog.color.hueToRgb_(e,d,a);a=255*goog.color.hueToRgb_(e,d,a-1/3)}return[Math.round(c),Math.round(b),Math.round(a)]};goog.color.hslArrayToRgb=function(a){return goog.color.hslToRgb(a[0],a[1],a[2])};goog.color.validHexColorRe_=/^#(?:[0-9a-f]{3}){1,2}$/i;goog.color.isValidHexColor_=function(a){return goog.color.validHexColorRe_.test(a)};
goog.color.normalizedHexColorRe_=/^#[0-9a-f]{6}$/;goog.color.isNormalizedHexColor_=function(a){return goog.color.normalizedHexColorRe_.test(a)};goog.color.rgbColorRe_=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i;goog.color.isValidRgbColor_=function(a){var b=a.match(goog.color.rgbColorRe_);if(b){a=Number(b[1]);var c=Number(b[2]);b=Number(b[3]);if(0<=a&&255>=a&&0<=c&&255>=c&&0<=b&&255>=b)return[a,c,b]}return[]};
goog.color.prependZeroIfNecessaryHelper=function(a){return 1==a.length?"0"+a:a};goog.color.prependHashIfNecessaryHelper=function(a){return"#"==a.charAt(0)?a:"#"+a};goog.color.rgbStyle_=function(a){return"rgb("+a.join(",")+")"};
goog.color.hsvToRgb=function(a,b,c){var d=0,e=0,f=0;if(0==b)f=e=d=c;else{var g=Math.floor(a/60),h=a/60-g;a=c*(1-b);var k=c*(1-b*h);b=c*(1-b*(1-h));switch(g){case 1:d=k;e=c;f=a;break;case 2:d=a;e=c;f=b;break;case 3:d=a;e=k;f=c;break;case 4:d=b;e=a;f=c;break;case 5:d=c;e=a;f=k;break;case 6:case 0:d=c,e=b,f=a}}return[Math.floor(d),Math.floor(e),Math.floor(f)]};
goog.color.rgbToHsv=function(a,b,c){var d=Math.max(Math.max(a,b),c),e=Math.min(Math.min(a,b),c);if(e==d)e=a=0;else{var f=d-e;e=f/d;a=60*(a==d?(b-c)/f:b==d?2+(c-a)/f:4+(a-b)/f);0>a&&(a+=360);360<a&&(a-=360)}return[a,e,d]};goog.color.rgbArrayToHsv=function(a){return goog.color.rgbToHsv(a[0],a[1],a[2])};goog.color.hsvArrayToRgb=function(a){return goog.color.hsvToRgb(a[0],a[1],a[2])};goog.color.hexToHsl=function(a){a=goog.color.hexToRgb(a);return goog.color.rgbToHsl(a[0],a[1],a[2])};
goog.color.hslToHex=function(a,b,c){return goog.color.rgbArrayToHex(goog.color.hslToRgb(a,b,c))};goog.color.hslArrayToHex=function(a){return goog.color.rgbArrayToHex(goog.color.hslToRgb(a[0],a[1],a[2]))};goog.color.hexToHsv=function(a){return goog.color.rgbArrayToHsv(goog.color.hexToRgb(a))};goog.color.hsvToHex=function(a,b,c){return goog.color.rgbArrayToHex(goog.color.hsvToRgb(a,b,c))};goog.color.hsvArrayToHex=function(a){return goog.color.hsvToHex(a[0],a[1],a[2])};
goog.color.hslDistance=function(a,b){var c=.5>=a[2]?a[1]*a[2]:a[1]*(1-a[2]);var d=.5>=b[2]?b[1]*b[2]:b[1]*(1-b[2]);return(a[2]-b[2])*(a[2]-b[2])+c*c+d*d-2*c*d*Math.cos(2*(a[0]/360-b[0]/360)*Math.PI)};goog.color.blend=function(a,b,c){c=goog.math.clamp(c,0,1);return[Math.round(c*a[0]+(1-c)*b[0]),Math.round(c*a[1]+(1-c)*b[1]),Math.round(c*a[2]+(1-c)*b[2])]};goog.color.darken=function(a,b){return goog.color.blend([0,0,0],a,b)};goog.color.lighten=function(a,b){return goog.color.blend([255,255,255],a,b)};
goog.color.highContrast=function(a,b){for(var c=[],d=0;d<b.length;d++)c.push({color:b[d],diff:goog.color.yiqBrightnessDiff_(b[d],a)+goog.color.colorDiff_(b[d],a)});c.sort(function(a,b){return b.diff-a.diff});return c[0].color};goog.color.yiqBrightness_=function(a){return Math.round((299*a[0]+587*a[1]+114*a[2])/1E3)};goog.color.yiqBrightnessDiff_=function(a,b){return Math.abs(goog.color.yiqBrightness_(a)-goog.color.yiqBrightness_(b))};
goog.color.colorDiff_=function(a,b){return Math.abs(a[0]-b[0])+Math.abs(a[1]-b[1])+Math.abs(a[2]-b[2])};goog.color.alpha={};
goog.color.alpha.parse=function(a){var b={};a=String(a);var c=goog.color.prependHashIfNecessaryHelper(a);if(goog.color.alpha.isValidAlphaHexColor_(c))return b.hex=goog.color.alpha.normalizeAlphaHex_(c),b.type="hex",b;c=goog.color.alpha.isValidRgbaColor_(a);if(c.length)return b.hex=goog.color.alpha.rgbaArrayToHex(c),b.type="rgba",b;c=goog.color.alpha.isValidHslaColor_(a);if(c.length)return b.hex=goog.color.alpha.hslaArrayToHex(c),b.type="hsla",b;throw Error(a+" is not a valid color string");};
goog.color.alpha.hexToRgbaStyle=function(a){return goog.color.alpha.rgbaStyle_(goog.color.alpha.hexToRgba(a))};goog.color.alpha.extractColor_=function(a,b,c){if(goog.color.alpha.isValidAlphaHexColor_(a))return a=goog.color.prependHashIfNecessaryHelper(a),goog.color.alpha.normalizeAlphaHex_(a).substring(b,c);throw Error(a+" is not a valid 8-hex color string");};goog.color.alpha.extractHexColor=function(a){return goog.color.alpha.extractColor_(a,0,7)};
goog.color.alpha.extractAlpha=function(a){return goog.color.alpha.extractColor_(a,7,9)};goog.color.alpha.hexQuadrupletRe_=/#(.)(.)(.)(.)/;goog.color.alpha.normalizeAlphaHex_=function(a){if(!goog.color.alpha.isValidAlphaHexColor_(a))throw Error("'"+a+"' is not a valid alpha hex color");5==a.length&&(a=a.replace(goog.color.alpha.hexQuadrupletRe_,"#$1$1$2$2$3$3$4$4"));return a.toLowerCase()};
goog.color.alpha.hexToRgba=function(a){a=goog.color.alpha.normalizeAlphaHex_(a);var b=parseInt(a.substr(1,2),16),c=parseInt(a.substr(3,2),16),d=parseInt(a.substr(5,2),16);a=parseInt(a.substr(7,2),16);return[b,c,d,a/255]};goog.color.alpha.rgbaToHex=function(a,b,c,d){var e=Math.floor(255*d);if(isNaN(e)||0>e||255<e)throw Error('"('+a+","+b+","+c+","+d+'") is not a valid RGBA color');d=goog.color.prependZeroIfNecessaryHelper(e.toString(16));return goog.color.rgbToHex(a,b,c)+d};
goog.color.alpha.hslaToHex=function(a,b,c,d){var e=Math.floor(255*d);if(isNaN(e)||0>e||255<e)throw Error('"('+a+","+b+","+c+","+d+'") is not a valid HSLA color');d=goog.color.prependZeroIfNecessaryHelper(e.toString(16));return goog.color.hslToHex(a,b/100,c/100)+d};goog.color.alpha.rgbaArrayToHex=function(a){return goog.color.alpha.rgbaToHex(a[0],a[1],a[2],a[3])};
goog.color.alpha.rgbaToRgbaStyle=function(a,b,c,d){if(isNaN(a)||0>a||255<a||isNaN(b)||0>b||255<b||isNaN(c)||0>c||255<c||isNaN(d)||0>d||1<d)throw Error('"('+a+","+b+","+c+","+d+')" is not a valid RGBA color');return goog.color.alpha.rgbaStyle_([a,b,c,d])};goog.color.alpha.rgbaArrayToRgbaStyle=function(a){return goog.color.alpha.rgbaToRgbaStyle(a[0],a[1],a[2],a[3])};goog.color.alpha.hslaArrayToHex=function(a){return goog.color.alpha.hslaToHex(a[0],a[1],a[2],a[3])};
goog.color.alpha.hslaArrayToRgbaStyle=function(a){return goog.color.alpha.hslaToRgbaStyle(a[0],a[1],a[2],a[3])};goog.color.alpha.hslaToRgbaStyle=function(a,b,c,d){return goog.color.alpha.rgbaStyle_(goog.color.alpha.hslaToRgba(a,b,c,d))};goog.color.alpha.hslaToRgba=function(a,b,c,d){return goog.color.hslToRgb(a,b/100,c/100).concat(d)};goog.color.alpha.rgbaToHsla=function(a,b,c,d){return goog.color.rgbToHsl(a,b,c).concat(d)};
goog.color.alpha.rgbaArrayToHsla=function(a){return goog.color.alpha.rgbaToHsla(a[0],a[1],a[2],a[3])};goog.color.alpha.validAlphaHexColorRe_=/^#(?:[0-9a-f]{4}){1,2}$/i;goog.color.alpha.isValidAlphaHexColor_=function(a){return goog.color.alpha.validAlphaHexColorRe_.test(a)};goog.color.alpha.normalizedAlphaHexColorRe_=/^#[0-9a-f]{8}$/;goog.color.alpha.isNormalizedAlphaHexColor_=function(a){return goog.color.alpha.normalizedAlphaHexColorRe_.test(a)};goog.color.alpha.rgbaColorRe_=/^(?:rgba)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|1|0\.\d{0,10})\)$/i;
goog.color.alpha.hslaColorRe_=/^(?:hsla)\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\%,\s?(0|[1-9]\d{0,2})\%,\s?(0|1|0\.\d{0,10})\)$/i;goog.color.alpha.isValidRgbaColor_=function(a){var b=a.match(goog.color.alpha.rgbaColorRe_);if(b){a=Number(b[1]);var c=Number(b[2]),d=Number(b[3]);b=Number(b[4]);if(0<=a&&255>=a&&0<=c&&255>=c&&0<=d&&255>=d&&0<=b&&1>=b)return[a,c,d,b]}return[]};
goog.color.alpha.isValidHslaColor_=function(a){var b=a.match(goog.color.alpha.hslaColorRe_);if(b){a=Number(b[1]);var c=Number(b[2]),d=Number(b[3]);b=Number(b[4]);if(0<=a&&360>=a&&0<=c&&100>=c&&0<=d&&100>=d&&0<=b&&1>=b)return[a,c,d,b]}return[]};goog.color.alpha.rgbaStyle_=function(a){var b=a.slice(0);b[3]=Math.round(1E3*a[3])/1E3;return"rgba("+b.join(",")+")"};goog.color.alpha.hsvaToHex=function(a,b,c,d){d=Math.floor(255*d);return goog.color.hsvArrayToHex([a,b,c])+goog.color.prependZeroIfNecessaryHelper(d.toString(16))};
goog.color.alpha.hsvaArrayToHex=function(a){return goog.color.alpha.hsvaToHex(a[0],a[1],a[2],a[3])};ngeo.PrintStyleType={LINE_STRING:"LineString",POINT:"Point",POLYGON:"Polygon"};ngeo.PrintStyleTypes_={};ngeo.PrintStyleTypes_[ol.geom.GeometryType.LINE_STRING]=ngeo.PrintStyleType.LINE_STRING;ngeo.PrintStyleTypes_[ol.geom.GeometryType.POINT]=ngeo.PrintStyleType.POINT;ngeo.PrintStyleTypes_[ol.geom.GeometryType.POLYGON]=ngeo.PrintStyleType.POLYGON;ngeo.PrintStyleTypes_[ol.geom.GeometryType.MULTI_LINE_STRING]=ngeo.PrintStyleType.LINE_STRING;ngeo.PrintStyleTypes_[ol.geom.GeometryType.MULTI_POINT]=ngeo.PrintStyleType.POINT;
ngeo.PrintStyleTypes_[ol.geom.GeometryType.MULTI_POLYGON]=ngeo.PrintStyleType.POLYGON;ngeo.Print=function(a,b,c){this.url_=a;this.$http_=b;this.ngeoLayerHelper_=c;this.printNativeAngle_=!0;this.isMs="+"==(new URL("http://_/?a=+")).searchParams.get("a")};ngeo.Print.FEAT_STYLE_PROP_PREFIX_="_ngeo_style_";ngeo.Print.prototype.cancel=function(a,b){return this.$http_["delete"](this.url_+"/cancel/"+a,void 0!==b?b:{})};goog.exportProperty(ngeo.Print.prototype,"cancel",ngeo.Print.prototype.cancel);
ngeo.Print.prototype.createSpec=function(a,b,c,d,e,f){c={dpi:c,rotation:f.rotation};this.encodeMap_(a,b,c);a={map:c};ol.obj.assign(a,f);return{attributes:a,format:e,layout:d}};goog.exportProperty(ngeo.Print.prototype,"createSpec",ngeo.Print.prototype.createSpec);
ngeo.Print.prototype.encodeMap_=function(a,b,c){var d=this,e=a.getView(),f=e.getCenter(),g=e.getProjection(),h=e.getResolution();e=c.rotation||ol.math.toDegrees(e.getRotation());goog.asserts.assert(void 0!==f);goog.asserts.assert(void 0!==g);c.center=f;c.projection=g.getCode();c.rotation=e;c.scale=b;c.layers=[];a=a.getLayerGroup();goog.asserts.assert(a);this.printNativeAngle_=!1!==a.get("printNativeAngle");a=this.ngeoLayerHelper_.getFlatLayers(a);ol.array.stableSort(a,function(a,b){return a.getZIndex()-
b.getZIndex()});a=a.slice().reverse();a.forEach(function(a){a.getVisible()&&(goog.asserts.assert(void 0!==h),d.encodeLayer(c.layers,a,h))})};ngeo.Print.prototype.encodeLayer=function(a,b,c){b instanceof ol.layer.Image?this.encodeImageLayer_(a,b):b instanceof ol.layer.Tile?this.encodeTileLayer_(a,b):b instanceof ol.layer.Vector&&this.encodeVectorLayer_(a,b,c)};
ngeo.Print.prototype.encodeImageLayer_=function(a,b){goog.asserts.assertInstanceof(b,ol.layer.Image);b.getSource()instanceof ol.source.ImageWMS&&this.encodeImageWmsLayer_(a,b)};ngeo.Print.prototype.encodeImageWmsLayer_=function(a,b){var c=b.getSource();goog.asserts.assertInstanceof(b,ol.layer.Image);goog.asserts.assertInstanceof(c,ol.source.ImageWMS);var d=c.getUrl();void 0!==d&&this.encodeWmsLayer_(a,b.getOpacity(),d,c.getParams())};
ngeo.Print.prototype.encodeWmsLayer_=function(a,b,c,d){c=new URL(c);this.isMs&&c.search.indexOf("+")&&(c=new URL(c.origin+c.pathname+c.search.replace(/\+/g,"%20")));var e={TRANSPARENT:!0};if(c.searchParams)for(var f=$jscomp.makeIterator(c.searchParams),g=f.next();!g.done;g=f.next())g=g.value,e[g[0]]=g[1];for(var h in d)f=d[h],null!==f&&void 0!==f&&(e[h]=f);delete e.LAYERS;delete e.FORMAT;delete e.SERVERTYPE;delete e.VERSION;b={baseURL:ngeo.Print.getAbsoluteUrl_(c.origin+c.pathname),imageFormat:"FORMAT"in
d?d.FORMAT:"image/png",layers:d.LAYERS.split(","),customParams:e,serverType:d.SERVERTYPE,type:"wms",opacity:b,version:d.VERSION,useNativeAngle:this.printNativeAngle_};a.push(b)};ngeo.Print.getAbsoluteUrl_=function(a){var b=document.createElement("a");b.href=encodeURI(a);return decodeURI(b.href)};
ngeo.Print.prototype.encodeTileLayer_=function(a,b){goog.asserts.assertInstanceof(b,ol.layer.Tile);var c=b.getSource();c instanceof ol.source.WMTS?this.encodeTileWmtsLayer_(a,b):c instanceof ol.source.TileWMS&&this.encodeTileWmsLayer_(a,b)};
ngeo.Print.prototype.encodeTileWmtsLayer_=function(a,b){goog.asserts.assertInstanceof(b,ol.layer.Tile);var c=b.getSource();goog.asserts.assertInstanceof(c,ol.source.WMTS);var d=c.getProjection(),e=c.getTileGrid();goog.asserts.assertInstanceof(e,ol.tilegrid.WMTS);for(var f=e.getMatrixIds(),g=[],h=0,k=f.length;h<k;++h){var l=e.getFullTileRange(h);g.push({identifier:f[h],scaleDenominator:e.getResolution(h)*d.getMetersPerUnit()/2.8E-4,tileSize:ol.size.toSize(e.getTileSize(h)),topLeftCorner:e.getOrigin(h),
matrixSize:[l.maxX-l.minX,l.maxY-l.minY]})}d=c.getDimensions();e=Object.keys(d);b={baseURL:this.getWmtsUrl_(c),dimensions:e,dimensionParams:d,imageFormat:c.getFormat(),layer:c.getLayer(),matrices:g,matrixSet:c.getMatrixSet(),opacity:b.getOpacity(),requestEncoding:c.getRequestEncoding(),style:c.getStyle(),type:"WMTS",version:c.getVersion()};a.push(b)};
ngeo.Print.prototype.encodeTileWmsLayer_=function(a,b){var c=b.getSource();goog.asserts.assertInstanceof(b,ol.layer.Tile);goog.asserts.assertInstanceof(c,ol.source.TileWMS);this.encodeWmsLayer_(a,b.getOpacity(),c.getUrls()[0],c.getParams())};
ngeo.Print.prototype.encodeVectorLayer_=function(a,b,c){var d=b.getSource();goog.asserts.assertInstanceof(d,ol.source.Vector);d=d.getFeatures();for(var e=new ol.format.GeoJSON,f=[],g={version:2},h=0,k=d.length;h<k;++h){var l=d[h],m=null,n=l.getStyleFunction();void 0!==n?m=n.call(l,c):(n=b.getStyleFunction(),void 0!==n&&(m=n.call(b,l,c)));n=e.writeFeatureObject(l);m=null===m||Array.isArray(m)?m:[m];goog.asserts.assert(Array.isArray(m));if(null!==m&&0<m.length)for(var p=!1,q=0,r=m.length;q<r;++q){var u=
m[q],v=ol.getUid(u).toString(),t=u.getGeometry();if(t){var w=l.clone();w.setGeometry(t);var x=e.writeFeatureObject(w);t=w.getGeometry();f.push(x)}else{x=n;t=l.getGeometry();if(!t)continue;p||(f.push(x),p=!0)}t=t.getType();null===x.properties&&(x.properties={});w=ngeo.Print.FEAT_STYLE_PROP_PREFIX_+q;this.encodeVectorStyle_(g,t,u,v,w);x.properties[w]=v}}0<f.length&&(b={geoJson:{type:"FeatureCollection",features:f},opacity:b.getOpacity(),style:g,type:"geojson"},a.push(b))};
ngeo.Print.prototype.encodeVectorStyle_=function(a,b,c,d,e){if(b in ngeo.PrintStyleTypes_&&(b=ngeo.PrintStyleTypes_[b],e="["+e+" = '"+d+"']",!(e in a))){d={symbolizers:[]};a[e]=d;a=c.getFill();e=c.getImage();var f=c.getStroke();c=c.getText();b==ngeo.PrintStyleType.POLYGON?null!==a&&this.encodeVectorStylePolygon_(d.symbolizers,a,f):b==ngeo.PrintStyleType.LINE_STRING?null!==f&&this.encodeVectorStyleLine_(d.symbolizers,f):b==ngeo.PrintStyleType.POINT&&null!==e&&this.encodeVectorStylePoint_(d.symbolizers,
e);null!==c&&this.encodeTextStyle_(d.symbolizers,c)}};ngeo.Print.prototype.encodeVectorStyleFill_=function(a,b){b=b.getColor();null!==b&&("string"===typeof b&&(b=goog.color.alpha.parse(b).hex,b=goog.color.alpha.hexToRgba(b)),goog.asserts.assert(Array.isArray(b),"only supporting fill colors"),a.fillColor=ngeo.utils.rgbArrayToHex(b),a.fillOpacity=b[3])};ngeo.Print.prototype.encodeVectorStyleLine_=function(a,b){var c={type:"line"};this.encodeVectorStyleStroke_(c,b);a.push(c)};
ngeo.Print.prototype.encodeVectorStylePoint_=function(a,b){if(b instanceof ol.style.Circle){var c={type:"point"};c.pointRadius=b.getRadius();var d=b.getFill();null!==d&&this.encodeVectorStyleFill_(c,d);b=b.getStroke();null!==b&&this.encodeVectorStyleStroke_(c,b)}else if(b instanceof ol.style.Icon){if(d=b.getSrc(),void 0!==d){c={type:"point",externalGraphic:d};d=b.getOpacity();null!==d&&(c.graphicOpacity=d);d=b.getSize();if(null!==d){var e=b.getScale();isNaN(e)&&(e=1);c.graphicWidth=d[0]*e;c.graphicHeight=
d[1]*e}b=b.getRotation();isNaN(b)&&(b=0);c.rotation=ol.math.toDegrees(b)}}else b instanceof ol.style.RegularShape&&(d=b.getPoints(),null!==d&&(c={type:"point"},4===d?c.graphicName="square":3===d?c.graphicName="triangle":5===d?c.graphicName="star":8===d&&(c.graphicName="cross"),d=b.getSize(),null!==d&&(c.graphicWidth=d[0],c.graphicHeight=d[1]),d=b.getRotation(),isNaN(d)||0===d||(c.rotation=ol.math.toDegrees(d)),d=b.getOpacity(),null!==d&&(c.graphicOpacity=d),d=b.getStroke(),null!==d&&this.encodeVectorStyleStroke_(c,
d),b=b.getFill(),null!==b&&this.encodeVectorStyleFill_(c,b)));void 0!==c&&a.push(c)};ngeo.Print.prototype.encodeVectorStylePolygon_=function(a,b,c){var d={type:"polygon"};this.encodeVectorStyleFill_(d,b);null!==c&&this.encodeVectorStyleStroke_(d,c);a.push(d)};
ngeo.Print.prototype.encodeVectorStyleStroke_=function(a,b){var c=b.getColor();null!==c&&(goog.asserts.assert(Array.isArray(c)),c=ol.color.asArray(c),goog.asserts.assert(Array.isArray(c),"only supporting stroke colors"),a.strokeColor=ngeo.utils.rgbArrayToHex(c),a.strokeOpacity=c[3]);c=b.getLineDash();null!==c&&(a.strokeDashstyle=c.join(" "));b=b.getWidth();void 0!==b&&(a.strokeWidth=b)};
ngeo.Print.prototype.encodeTextStyle_=function(a,b){var c={type:"Text"},d=b.getText();if(void 0!==d){c.label=d;d="c";var e="m",f=b.getTextAlign();if("left"===f||"start"===f)d="l";else if("right"===f||"end"===f)d="r";f=b.getTextBaseline();"bottom"===f?e="l":"top"===f&&(e="t");c.labelAlign=""+d+e;d=b.getRotation();void 0!==d&&(c.labelRotation=(180*d/Math.PI).toString(),c.labelAlign="cm");d=b.getFont();void 0!==d&&(d=d.split(" "),3<=d.length&&(c.fontWeight=d[0],c.fontSize=d[1],c.fontFamily=d.splice(2).join(" ")));
d=b.getStroke();null!==d&&(e=d.getColor(),goog.asserts.assert(Array.isArray(e)),e=ol.color.asArray(e),goog.asserts.assert(Array.isArray(e),"only supporting stroke colors"),c.haloColor=ngeo.utils.rgbArrayToHex(e),c.haloOpacity=e[3],d=d.getWidth(),void 0!==d&&(c.haloRadius=d/2));d=b.getFill();null!==d&&(d=d.getColor(),goog.asserts.assert(Array.isArray(d),"only supporting fill colors"),d=ol.color.asArray(d),goog.asserts.assert(Array.isArray(d),"only supporting fill colors"),c.fontColor=ngeo.utils.rgbArrayToHex(d));
void 0!==c.labelAlign&&(c.labelXOffset=b.getOffsetX(),c.labelYOffset=-b.getOffsetY());a.push(c)}};ngeo.Print.prototype.getWmtsUrl_=function(a){var b=a.getUrls();goog.asserts.assert(0<b.length);b=b[0];a=a.getLayer();0<=b.indexOf("{Layer}")&&(b=b.replace("{Layer}",a));return ngeo.Print.getAbsoluteUrl_(b)};
ngeo.Print.prototype.createReport=function(a,b){var c=this.url_+"/report."+(a.format||"pdf"),d={headers:{"Content-Type":"application/json; charset=UTF-8"}};ol.obj.assign(d,void 0!==b?b:{});return this.$http_.post(c,a,d)};goog.exportProperty(ngeo.Print.prototype,"createReport",ngeo.Print.prototype.createReport);ngeo.Print.prototype.getStatus=function(a,b){return this.$http_.get(this.url_+"/status/"+a+".json",void 0!==b?b:{})};goog.exportProperty(ngeo.Print.prototype,"getStatus",ngeo.Print.prototype.getStatus);
ngeo.Print.prototype.getReportUrl=function(a){return this.url_+"/report/"+a};goog.exportProperty(ngeo.Print.prototype,"getReportUrl",ngeo.Print.prototype.getReportUrl);ngeo.Print.prototype.getCapabilities=function(a){return this.$http_.get(this.url_+"/capabilities.json",void 0!==a?a:{withCredentials:!0})};ngeo.createPrintServiceFactory=function(a,b){return function(c){return new ngeo.Print(c,a,b)}};ngeo.createPrintServiceFactory.$inject=["$http","ngeoLayerHelper"];
ngeo.module.factory("ngeoCreatePrint",ngeo.createPrintServiceFactory);ngeo.PrintUtils=function(){};ngeo.PrintUtils.INCHES_PER_METER_=39.37;ngeo.PrintUtils.DOTS_PER_INCH_=72;
ngeo.PrintUtils.prototype.createPrintMaskPostcompose=function(a,b,c){var d=this;return function(e){var f=e.context,g=e.frameState,h=g.viewState.resolution,k=g.size[0]*g.pixelRatio,l=g.size[1]*g.pixelRatio;e=[k/2,l/2];var m=a(),n=m[1]*ol.has.DEVICE_PIXEL_RATIO,p=m[0]*ol.has.DEVICE_PIXEL_RATIO;g=b(g);var q=ngeo.PrintUtils.DOTS_PER_INCH_,r=ngeo.PrintUtils.INCHES_PER_METER_;p=p/q/r*g/h/2;d.extentHalfHorizontalDistance_=m[0]/q/r*g/2;h=n/q/r*g/h/2;d.extentHalfVerticalDistance_=m[1]/q/r*g/2;f.beginPath();
f.moveTo(0,0);f.lineTo(k,0);f.lineTo(k,l);f.lineTo(0,l);f.lineTo(0,0);f.closePath();c?(k=ol.math.toRadians(c()),d.drawPrintZoneWithRotation_(f,e,p,h,k)):d.drawPrintZone_(f,e,p,h);f.fillStyle="rgba(0, 5, 25, 0.5)";f.fill()}};goog.exportProperty(ngeo.PrintUtils.prototype,"createPrintMaskPostcompose",ngeo.PrintUtils.prototype.createPrintMaskPostcompose);
ngeo.PrintUtils.prototype.drawPrintZone_=function(a,b,c,d){var e=b[0]-c,f=b[1]-d;c=b[0]+c;b=b[1]+d;a.moveTo(e,f);a.lineTo(e,b);a.lineTo(c,b);a.lineTo(c,f);a.lineTo(e,f);a.closePath()};
ngeo.PrintUtils.prototype.drawPrintZoneWithRotation_=function(a,b,c,d,e){var f=Math.sqrt(Math.pow(c,2)+Math.pow(d,2)),g=Math.atan(d/c)-e,h=Math.atan(c/d)-e;c=b[0]-Math.cos(g)*f;d=b[1]+Math.sin(g)*f;e=b[0]+Math.sin(h)*f;var k=b[1]+Math.cos(h)*f,l=b[0]+Math.cos(g)*f;g=b[1]-Math.sin(g)*f;var m=b[0]-Math.sin(h)*f;b=b[1]-Math.cos(h)*f;a.moveTo(c,d);a.lineTo(e,k);a.lineTo(l,g);a.lineTo(m,b);a.lineTo(c,d);a.closePath()};
ngeo.PrintUtils.prototype.getOptimalScale=function(a,b,c,d){a=Math.min(a[0]*b*ngeo.PrintUtils.INCHES_PER_METER_*ngeo.PrintUtils.DOTS_PER_INCH_/c[0],a[1]*b*ngeo.PrintUtils.INCHES_PER_METER_*ngeo.PrintUtils.DOTS_PER_INCH_/c[1]);b=-1;c=0;for(var e=d.length;c<e;++c)a>d[c]&&(b=d[c]);return b};goog.exportProperty(ngeo.PrintUtils.prototype,"getOptimalScale",ngeo.PrintUtils.prototype.getOptimalScale);
ngeo.PrintUtils.prototype.getOptimalResolution=function(a,b,c){var d=ngeo.PrintUtils.DOTS_PER_INCH_*ngeo.PrintUtils.INCHES_PER_METER_;return Math.max(b[0]*c/(d*a[0]),b[1]*c/(d*a[1]))};goog.exportProperty(ngeo.PrintUtils.prototype,"getOptimalResolution",ngeo.PrintUtils.prototype.getOptimalResolution);ngeo.PrintUtils.prototype.getBottomLeftCorner=function(a){return[a[0]-this.extentHalfHorizontalDistance_,a[1]-this.extentHalfVerticalDistance_]};
ngeo.PrintUtils.prototype.getBottomRightCorner=function(a){return[a[0]+this.extentHalfHorizontalDistance_,a[1]-this.extentHalfVerticalDistance_]};ngeo.PrintUtils.prototype.getUpLeftCorner=function(a){return[a[0]-this.extentHalfHorizontalDistance_,a[1]+this.extentHalfVerticalDistance_]};ngeo.PrintUtils.prototype.getUpRightCorner=function(a){return[a[0]+this.extentHalfHorizontalDistance_,a[1]+this.extentHalfVerticalDistance_]};ngeo.module.service("ngeoPrintUtils",ngeo.PrintUtils);gmf.PrintStateEnum={NOT_IN_USE:"notInUse",PRINTING:"printing",ERROR_ON_REPORT:"errorOnReport",CAPABILITIES_NOT_LOADED:"capabilitiesNotLoaded",ERROR_ON_GETCAPABILITIES:"errorOnGetCapabilities"};goog.exportSymbol("gmf.PrintStateEnum",gmf.PrintStateEnum);gmf.module.value("gmfPrintState",{state:gmf.PrintStateEnum.CAPABILITIES_NOT_LOADED});gmf.module.value("gmfPrintTemplateUrl",function(a,b){a=b.gmfPrintTemplateurl;return void 0!==a?a:gmf.baseTemplateUrl+"/print.html"});
gmf.printDirective=function(a){return{bindToController:!0,controller:"GmfPrintController as ctrl",templateUrl:a,replace:!0,restrict:"E",transclude:!0,scope:{map:"=gmfPrintMap",active:"=gmfPrintActive",rotateMask:"&?gmfPrintRotatemask",fieldValues:"&?gmfPrintFieldvalues",hiddenAttributeNames:"=?gmfPrintHiddenattributes",attributesOut:"=?gmfPrintAttributesOut"},link:function(a,c,d){var b=a.ctrl;a.$watch(function(){return b.active},function(a){this.togglePrintPanel_(a)}.bind(b))}}};
gmf.printDirective.$inject=["gmfPrintTemplateUrl"];gmf.module.directive("gmfPrint",gmf.printDirective);
gmf.PrintController=function(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,u,v){var t=this;this.gmfPrintState_=u;this.translate_=r("translate");this.rotateMask_=this.rotateMask?this.rotateMask():!1;this.fieldValues_=this.fieldValues?this.fieldValues():{};this.$scope_=c;this.$timeout_=d;this.$q_=e;this.gettextCatalog_=g;this.ngeoLayerHelper_=h;this.featureOverlayLayer_=k.getLayer();this.ngeoPrintUtils_=l;this.ngeoPrint_=m(n);this.ngeoQueryResult_=q;this.cacheVersion_="0";f.has("cacheVersion")&&(this.cacheVersion_=
f.get("cacheVersion"));this.scaleInput=!1;f.has("gmfPrintOptions")&&(this.scaleInput=f.get("gmfPrintOptions").scaleInput);this.rotationTimeoutPromise_=this.onDragPreviousMousePosition_=this.statusTimeoutPromise_=this.requestCanceler_=null;this.curRef_="";this.formats_=[];this.layouts_=[];this.layout_={};this.paperSize_=[];this.layoutInfo={};this.rotation=0;this.scaleManuallySelected_=!1;this.rotationInput_=a.find(".gmf-print-rotation-input");this.rotationInput_.on("input",function(a){a=$(a.target).val();
""!==a&&t.setRotation(a)});var w;this.rotateMask_&&(w=function(){return t.rotation});this.postcomposeListener_=l.createPrintMaskPostcompose(function(){return t.paperSize_},function(a){goog.asserts.assert(t.layoutInfo.scales);goog.asserts.assert(void 0!==t.layoutInfo.scale);t.scaleManuallySelected_||-1!==t.layoutInfo.scale&&!ol.array.includes(t.layoutInfo.scales,t.layoutInfo.scale)||(t.layoutInfo.scale=t.getOptimalScale_(a.size,a.viewState.resolution));return t.layoutInfo.scale},w);c.$watch(function(){return p.getRoleId()},
function(){t.gmfPrintState_.state=gmf.PrintStateEnum.CAPABILITIES_NOT_LOADED;t.capabilities_=null});b.$on("gmfStartPrint",function(a,b){t.print(""+b)});b.$on("gmfCancelPrint",function(){t.cancel()});v.getOgcServersObject().then(function(a){t.ogcServers_=a});v.getThemesObject().then(function(a){t.currentThemes_=a})};gmf.PrintController.$inject="$element $rootScope $scope $timeout $q $injector gettextCatalog ngeoLayerHelper ngeoFeatureOverlayMgr ngeoPrintUtils ngeoCreatePrint gmfPrintUrl gmfAuthentication ngeoQueryResult $filter gmfPrintState gmfThemes".split(" ");
gmf.PrintController.prototype.togglePrintPanel_=function(a){var b=this;a?(this.capabilities_||this.getCapabilities_(),this.capabilities_.then(function(a){b.active&&(b.gmfPrintState_.state=gmf.PrintStateEnum.NOT_IN_USE,b.parseCapabilities_(a),b.postComposeListenerKey_=b.map.on("postcompose",b.postcomposeListener_),b.pointerDragListenerKey_=b.map.on("pointerdrag",b.onPointerDrag_.bind(b)),b.mapViewResolutionChangeKey_=b.map.getView().on("change:resolution",function(){b.scaleManuallySelected_=!1}),b.map.render())},
function(a){b.gmfPrintState_.state=gmf.PrintStateEnum.ERROR_ON_GETCAPABILITIES;b.capabilities_=null})):(ol.Observable.unByKey(this.postComposeListenerKey_),ol.Observable.unByKey(this.pointerDragListenerKey_),ol.Observable.unByKey(this.mapViewResolutionChangeKey_),this.setRotation(0),this.map.render())};gmf.PrintController.prototype.getCapabilities_=function(a){this.capabilities_=this.ngeoPrint_.getCapabilities({withCredentials:!0,params:a?{role:a,cache_version:this.cacheVersion_}:{cache_version:this.cacheVersion_}})};
gmf.PrintController.prototype.parseCapabilities_=function(a){var b=this;a=a.data;this.formats_=a.formats||[];this.layouts_=a.layouts;this.layout_=a.layouts[0];this.layoutInfo.layouts=[];this.layouts_.forEach(function(a){b.layoutInfo.layouts.push(a.name)});this.updateFields_()};
gmf.PrintController.prototype.updateFields_=function(){var a=this;this.layoutInfo.layout=this.layout_.name;var b=this.isAttributeInCurrentLayout_("map");goog.asserts.assertObject(b);b=b.clientInfo;goog.asserts.assertObject(b);this.paperSize_=[b.width,b.height];this.updateCustomFields_();var c=this.isAttributeInCurrentLayout_("legend");void 0===this.layoutInfo.legend&&(this.layoutInfo.legend=!(void 0!==c?!c:!this.fieldValues_.legend));this.layoutInfo.scales=b.scales||[];this.layoutInfo.dpis=b.dpiSuggestions||
[];b=this.map.getSize();c=this.map.getView().getResolution();this.layoutInfo.scale=this.getOptimalScale_(b,c);this.layoutInfo.dpi=this.layoutInfo.dpi&&0<this.layoutInfo.dpis.indexOf(this.layoutInfo.dpi)?this.layoutInfo.dpi:this.layoutInfo.dpis[0];this.layoutInfo.formats={};this.formats_.forEach(function(b){a.layoutInfo.formats[b]=!0});this.attributesOut=this.layoutInfo.simpleAttributes;this.map.render()};
gmf.PrintController.prototype.updateCustomFields_=function(){var a=this,b,c,d,e;this.layoutInfo.simpleAttributes||(this.layoutInfo.simpleAttributes=[]);var f=this.layoutInfo.simpleAttributes,g=f.splice(0,f.length);this.layout_.attributes.forEach(function(f){if(!f.clientParams){b=""+f.name;var h=f.default;d=void 0!==h&&""!==h?h:a.fieldValues_[b];c=""+f.type;switch(c){case "String":e="comments"===b?"textarea":"text";break;case "Boolean":e="checkbox";break;case "Number":e="number";d=parseFloat(d);d=
isNaN(d)?0:d;break;default:e=c}g.forEach(function(a){if(a.name===b&&a.type===e)return d=a.value});a.layoutInfo.simpleAttributes.push({name:b,type:e,value:d})}})};gmf.PrintController.prototype.isAttributeInCurrentLayout_=function(a){var b=null;this.layout_.attributes.forEach(function(c){if(c.name===a)return b=c});return b};
gmf.PrintController.prototype.setRotation=function(a){this.rotation=ol.math.clamp(a,-180,180);this.rotationInput_.val(this.rotation.toString());this.rotateMask_?this.map.render():this.map.getView().setRotation(ol.math.toRadians(this.rotation))};
gmf.PrintController.prototype.onPointerDrag_=function(a){var b=this,c=a.originalEvent;if(this.active&&c.altKey&&c.shiftKey){var d=this.map.getPixelFromCoordinate(this.map.getView().getCenter());a=a.pixel;if(null===this.rotationTimeoutPromise_)this.onDragPreviousMousePosition_=null;else{this.$timeout_.cancel(this.rotationTimeoutPromise_);c=this.onDragPreviousMousePosition_[0]-d[0];var e=this.onDragPreviousMousePosition_[1]-d[1],f=a[0]-d[0],g=a[1]-d[1],h=Math.sqrt(Math.pow(f,2)+Math.pow(g,2));d=(c*
f+e*g)/(Math.sqrt(Math.pow(c,2)+Math.pow(e,2))*h);d=1>=d?(0<c*g-e*f?1:-1)*Math.acos(d):0;c=h/200;c=Math.round(ol.math.toDegrees(d)*c);this.setRotation(this.rotation+c);this.$scope_.$digest()}this.rotationTimeoutPromise_=this.$timeout_(function(){b.rotationTimeoutPromise_=null},500);this.onDragPreviousMousePosition_=a}};
gmf.PrintController.prototype.print=function(a){if(this.gmfPrintState_.state!==gmf.PrintStateEnum.PRINTING){this.requestCanceler_=this.$q_.defer();this.gmfPrintState_.state=gmf.PrintStateEnum.PRINTING;var b=this.map.getSize(),c=this.map.getView().getResolution(),d=this.layoutInfo.scale||this.getOptimalScale_(b,c);b=this.rotateMask_?-this.rotation:this.rotation;var e={datasource:this.getDataSource_(),lang:this.gettextCatalog_.currentLanguage,rotation:b,scale:d};this.layoutInfo.simpleAttributes&&this.layoutInfo.simpleAttributes.forEach(function(a){e[a.name]=
a.value});this.layoutInfo.legend&&null!==this.getLegend_(d)&&(e.legend=this.getLegend_(d));goog.asserts.assertNumber(this.layoutInfo.dpi);goog.asserts.assertString(this.layoutInfo.layout);b=new ol.Map({});b.setView(this.map.getView());for(var f=this.ngeoLayerHelper_.getFlatLayers(this.map.getLayerGroup()),g=[],h=!0,k=0,l=f.length;k<l;k++){var m=f[k],n=m.get("metadata");if(n){var p=n.ogcServer;n=n.printLayers||n.layers;if(p&&n){var q=this.ogcServers_[p];q?m=this.ngeoLayerHelper_.createBasicWMSLayer(q.url,
n,q.imageType,q.type):console.error("Missing ogcServer:",p)}}m instanceof ol.layer.Image&&!1===m.get("printNativeAngle")&&(h=!1);g.push(m)}b.setLayerGroup(new ol.layer.Group({layers:g,printNativeAngle:h}));a=this.ngeoPrint_.createSpec(b,d,this.layoutInfo.dpi,this.layoutInfo.layout,a,e);d=[];this.ngeoPrint_.encodeLayer(d,this.featureOverlayLayer_,c);0<d.length&&a.attributes.map.layers.unshift(d[0]);this.ngeoPrint_.createReport(a,{timeout:this.requestCanceler_.promise}).then(this.handleCreateReportSuccess_.bind(this),
this.handleCreateReportError_.bind(this));b.setTarget(null)}};goog.exportProperty(gmf.PrintController.prototype,"print",gmf.PrintController.prototype.print);gmf.PrintController.prototype.cancel=function(){null!==this.requestCanceler_&&this.requestCanceler_.resolve();null!==this.statusTimeoutPromise_&&this.$timeout_.cancel(this.statusTimeoutPromise_);0<this.curRef_.length&&this.ngeoPrint_.cancel(this.curRef_);this.resetPrintStates_()};goog.exportProperty(gmf.PrintController.prototype,"cancel",gmf.PrintController.prototype.cancel);
gmf.PrintController.prototype.resetPrintStates_=function(a){this.gmfPrintState_.state=a||gmf.PrintStateEnum.NOT_IN_USE;this.curRef_=""};
gmf.PrintController.prototype.getDataSource_=function(){var a,b,c,d=[];this.ngeoQueryResult_.sources.forEach(function(e){b=[];c=[];e.features.forEach(function(a,d){goog.asserts.assert(a);var e=ngeo.FeatureHelper.getFilteredFeatureValues(a);0===d&&(c=Object.keys(e).map(function(a){return this.translate_(a)},this));b.push(Object.keys(e).map(function(a){return e[a]}))},this);c.length&&(a={title:this.translate_(e.label),table:{columns:c,data:b}},d.push(a))},this);return d};
gmf.PrintController.prototype.getOptimalScale_=function(a,b){var c=this.layoutInfo.scales.slice();return void 0!==a&&void 0!==b?this.ngeoPrintUtils_.getOptimalScale(a,b,this.paperSize_,c.reverse()):this.layoutInfo.scales[0]};gmf.PrintController.prototype.handleCreateReportSuccess_=function(a){a=a.data.ref;goog.asserts.assert(0<a.length);this.curRef_=a;this.getStatus_(a)};
gmf.PrintController.prototype.getStatus_=function(a){this.requestCanceler_=this.$q_.defer();this.ngeoPrint_.getStatus(a,{timeout:this.requestCanceler_.promise}).then(this.handleGetStatusSuccess_.bind(this,a),this.handleCreateReportError_.bind(this))};
gmf.PrintController.prototype.handleGetStatusSuccess_=function(a,b){var c=this;b=b.data;b.done?"error"!=b.status?(window.location.href=this.ngeoPrint_.getReportUrl(a),this.resetPrintStates_()):(console.error(b.error),this.handleCreateReportError_()):this.statusTimeoutPromise_=this.$timeout_(function(){c.getStatus_(a)},1E3,!1)};gmf.PrintController.prototype.handleCreateReportError_=function(){this.resetPrintStates_(gmf.PrintStateEnum.ERROR_ON_REPORT)};
gmf.PrintController.prototype.getLegend_=function(a){var b=this,c={classes:[]},d,e,f,g,h=this.gettextCatalog_,k=this.ngeoLayerHelper_.getGroupFromMap(this.map,gmf.DATALAYERGROUP_NAME);this.ngeoLayerHelper_.getFlatLayers(k).reverse().forEach(function(k){d=[];if(k.getVisible()&&k.getSource())if(k instanceof ol.layer.Tile)f=""+k.get("layerNodeName"),(g=b.getMetadataLegendImage_(f))||(g=b.ngeoLayerHelper_.getWMTSLegendURL(k)),g&&d.push({name:h.getString(f),icons:[g]});else{var l=k.getSource();e=l.getParams().LAYERS.split(",");
e.forEach(function(c){(g=b.getMetadataLegendImage_(c))||(g=b.ngeoLayerHelper_.getWMSLegendURL(l.getUrl(),c,a));g&&0!==c.length&&d.push({name:h.getString(c),icons:[g]})})}0<d.length&&c.classes.push({classes:d})});return 0<c.classes.length?c:null};gmf.PrintController.prototype.getMetadataLegendImage_=function(a){var b=gmf.Themes.findGroupByLayerNodeName(this.currentThemes_,a),c;b&&b.children&&(c=gmf.Themes.findObjectByName(b.children,a));if(c&&c.metadata)var d=c.metadata.legendImage;return d};
gmf.PrintController.prototype.setLayout=function(a){var b;this.layouts_.forEach(function(c){if(c.name===a)return b=c,!0});this.layout_=b;this.updateFields_()};goog.exportProperty(gmf.PrintController.prototype,"setLayout",gmf.PrintController.prototype.setLayout);
gmf.PrintController.prototype.getSetScale=function(a){if(void 0!==a){var b=this.map.getSize();this.layoutInfo.scale=a;a=this.ngeoPrintUtils_.getOptimalResolution(b,this.paperSize_,a);a=this.map.getView().constrainResolution(a,0,1);this.map.getView().setResolution(a);this.map.render();this.scaleManuallySelected_=!0}return this.layoutInfo.scale};goog.exportProperty(gmf.PrintController.prototype,"getSetScale",gmf.PrintController.prototype.getSetScale);
gmf.PrintController.prototype.setDpi=function(a){this.layoutInfo.dpi=a};goog.exportProperty(gmf.PrintController.prototype,"setDpi",gmf.PrintController.prototype.setDpi);gmf.PrintController.prototype.isState=function(a){return this.gmfPrintState_.state===gmf.PrintStateEnum[a]};goog.exportProperty(gmf.PrintController.prototype,"isState",gmf.PrintController.prototype.isState);gmf.module.controller("GmfPrintController",gmf.PrintController);ngeo.profile=function(a){var b=void 0!==a.light?a.light:!1,c=b?{top:0,right:0,bottom:0,left:0}:{top:10,right:20,bottom:30,left:40},d=void 0!==a.hoverCallback?a.hoverCallback:ol.nullFunction,e=void 0!==a.outCallback?a.outCallback:ol.nullFunction,f=a.distanceExtractor,g=a.linesConfiguration,h=Object.keys(g).length,k=d3.bisector(function(a){return f(a)}).left,l=a.poiExtractor,m=a.styleDefs,n=void 0!==a.poiLabelAngle?a.poiLabelAngle:-60,p=a.i18n||{},q=p.xAxis||"Distance",r=p.yAxis||"Elevation",u={xhover:function(a,
b){return parseFloat(a.toPrecision(3))+" "+b},yhover:function(a,b){return Math.round(a)+" m"},xtick:function(a,b){return a},ytick:function(a,b){return a}};void 0!==a.formatter&&ol.obj.assign(u,a.formatter);var v=void 0!==a.lightXAxis?a.lightXAxis:!1,t,w,x,z=a.scaleModifier,y,A,C,B,D,E,G=function(a){a.each(function(a){d3.select(this).selectAll("svg").remove();if(void 0!==a){C=Math.max(this.clientWidth-c.right-c.left,0);w=d3.scaleLinear().range([0,C]);A=Math.max(this.clientHeight-c.top-c.bottom,0);
x=d3.scaleLinear().range([A,0]);var d=d3.axisBottom(w),e=d3.axisLeft(x),k;1===h&&(k=d3.area().x(function(a){return w(f(a))}).y0(A).y1(function(a){var b=Object.keys(g)[0];return x(g[b].zExtractor(a))}));t=d3.select(this).selectAll("svg").data([a]);var l=t.enter().append("svg");t=d3.select(this).selectAll("svg").data([a]);void 0!==m&&l.append("defs").append("style").attr("type","text/css").text(m);l=l.append("g");G.showPois([]);l.style("font","11px Arial");1===h&&l.append("path").attr("class","area").style("fill",
"rgba(222, 222, 222, 0.5)");l.insert("g",":first-child").attr("class","grid-y");b||(l.append("g").attr("class","x axis").attr("transform","translate(0,"+A+")"),l.append("text").attr("class","x label").attr("text-anchor","end").attr("x",C-4).attr("y",A-4),l.append("g").attr("class","y axis"),l.append("text").attr("class","y label").attr("text-anchor","end").attr("y",6).attr("dy",".75em").attr("transform","rotate(-90)").style("fill","grey").text(r+" [m]"),l.append("g").attr("class","metas").attr("transform",
"translate("+(C+3)+", 0)"));l.append("g").attr("class","pois");var n=l.append("g").attr("class","x grid-hover");n.append("svg:line").attr("stroke-dasharray","5,5");n.append("text");l.append("rect").attr("class","overlay").attr("width",C).attr("height",A).style("fill","none").style("pointer-events","all");t.attr("width",C+c.left+c.right).attr("height",A+c.top+c.bottom);y=t.select("g").attr("transform","translate("+c.left+","+c.top+")");E=d3.extent(a,function(a){return f(a)});w.domain(E);n=function(){var b=
[],c;for(c in g){var d=d3.extent(a,function(a){return g[c].zExtractor(a)});b=b.concat(d)}return[Math.min.apply(null,b),Math.max.apply(null,b)]}();x.domain(n);if(void 0!==z)z(w,x,C,A);else{var p=.1*(n[1]-n[0]);x.domain([n[0]-p,n[1]+p])}1===h&&y.select(".area").transition().attr("d",k);for(var F in g)l.append("path").attr("class","line "+F).style("stroke",g[F].color||"#F00").style("fill","none"),k=l.append("g").attr("class","y grid-hover "+F),k.append("svg:line").attr("stroke-dasharray","5,5"),k.append("text"),
k=d3.line().x(function(a){return w(f(a))}).y(function(a){return x(g[F].zExtractor(a))}),y.select(".line."+F).transition().attr("d",k);2E3<E[1]?(B=1E3,D="km"):(B=1,D="m");b||(d.tickFormat(function(a){return u.xtick(a/B,D)}),v&&d.tickValues([0,w.domain()[1]]),e.tickFormat(function(a){return u.ytick(a,"m")}),y.select(".x.axis").transition().call(d),y.select(".x.label").text(q+" ["+D+"]").style("fill","grey").style("shape-rendering","crispEdges"),10>A/15&&e.ticks(A/15),y.select(".y.axis").transition().call(e));
y.select(".grid-y").transition().call(e.tickSize(-C,0).tickFormat("")).selectAll(".tick line").style("stroke","#ccc").style("opacity",.7);y.selectAll(".axis").selectAll("path, line").style("fill","none").style("stroke","#000").style("shape-rendering","crispEdges");y.select(".grid-y").select("path").style("stroke","none");y.selectAll(".grid-hover line").style("stroke","#222").style("opacity",.8);y.select(".overlay").on("mouseout",function(){G.clearHighlight()}).on("mousemove",function(){var a=d3.mouse(this)[0];
a=w.invert(a);G.highlight(a)})}})};G.clearHighlight=function(){y.selectAll(".grid-hover").style("display","none");e.call(null)};G.highlight=function(a){var b=t.datum();a=k(b,a);if(!(a>=b.length)){b=b[a];a=f(b);var c=[],e={};for(m in g){var l=g[m].zExtractor(b);c.push(l);e[m]=l;y.select(".y.grid-hover."+m).style("display","inline").select("line").attr("x1",w(0)).attr("y1",x(l)).attr("x2",C).attr("y2",x(l))}y.select(".x.grid-hover").style("display","inline").select("line").attr("x1",w(a)).attr("y1",
A).attr("x2",w(a)).attr("y2",x(Math.max.apply(null,c)));var m=a>E[1]/2;l=w(a);l+=m?-10:10;y.select(".x.grid-hover text").text(u.xhover(a/B,D)).style("text-anchor",m?"end":"start").attr("transform","translate("+l+","+(A-10)+")");1===h&&y.select(".y.grid-hover text").text(u.yhover(c[0],"m")).style("text-anchor",m?"end":"start").attr("transform","translate("+l+","+(x(c[0])-10)+")");d.call(null,b,a/B,D,e,"m")}};G.showPois=function(a){a=void 0!==a?a:[];goog.asserts.assert(0===a.length||void 0!==l);var c=
t.select("g"),d=t.datum();a=c.select(".pois").selectAll(".poi").data(a,function(a){var b=k(d,Math.round(10*l.dist(a))/10,1);if(b=d[b]){var c=[];for(e in g)c.push(g[e].zExtractor(b));var e=Math.max.apply(null,c);l.z(a,e)}return l.id(a)}).enter().append("g").attr("class","poi");a.append("text").attr("x",b?0:9).attr("dy",".35em").attr("text-anchor",b?"middle":"start");a.append("line").style("shape-rendering","crispEdges");a.style("opacity",0).transition().duration(1E3).delay(100).style("opacity",1);
a.selectAll("text").attr("transform",function(a){return b?["translate(",w(l.dist(a)),",",x(l.z(a))-10,")"].join(""):["translate(",w(l.dist(a)),",",x(l.z(a))-20,") rotate(",n,")"].join("")}).text(function(a){return l.sort(a)+(b?"":" - "+l.title(a))});a.selectAll("line").style("stroke","grey").attr("x1",function(a){return w(l.dist(a))}).attr("y1",function(a){return x(x.domain()[0])}).attr("x2",function(a){return w(l.dist(a))}).attr("y2",function(a){return x(l.z(a))});a.exit().remove()};return G};
goog.exportSymbol("ngeo.profile",ngeo.profile);ngeo.profileDirective=function(a){return{restrict:"A",link:function(b,c,d){function e(){void 0!==h&&(g.datum(k).call(h),void 0!==k&&h.showPois(l))}var f=d.ngeoProfileOptions;goog.asserts.assert(void 0!==f);var g=d3.select(c[0]),h,k,l;b.$watchCollection(f,function(a){a=ol.obj.assign({},a);if(void 0!==a){if(void 0!==a.hoverCallback){var c=a.hoverCallback;a.hoverCallback=function(a){for(var d=[],e=0;e<arguments.length;++e)d[e-0]=arguments[e];c.apply(null,[].concat($jscomp.arrayFromIterable(d)));b.$applyAsync()}}if(void 0!==
a.outCallback){var d=a.outCallback;a.outCallback=function(){d();b.$applyAsync()}}h=ngeo.profile(a);e()}});b.$watch(d.ngeoProfile,function(a,b){k=a;e()});b.$watch(d.ngeoProfilePois,function(a,b){l=a;e()});b.$watch(d.ngeoProfileHighlight,function(a,b){void 0!==a&&(0<a?h.highlight(a):h.clearHighlight())});goog.events.listen(window,goog.events.EventType.RESIZE,a(e,50,!0),!1,this)}}};ngeo.profileDirective.$inject=["ngeoDebounce"];ngeo.module.directive("ngeoProfile",ngeo.profileDirective);ngeo.module.value("gmfProfileTemplateUrl",function(a,b){a=b.gmfProfileTemplateurl;return void 0!==a?a:gmf.baseTemplateUrl+"/profile.html"});function gmfProfileTemplateUrl(a,b,c){return c(a,b)}gmfProfileTemplateUrl.$inject=["$element","$attrs","gmfProfileTemplateUrl"];
gmf.profileComponent={controller:"GmfProfileController as ctrl",bindings:{active:"=gmfProfileActive",line:"=gmfProfileLine",getMapFn:"&?gmfProfileMap",getLinesConfigurationFn:"&gmfProfileLinesconfiguration",getHoverPointStyleFn:"&?gmfProfileHoverpointstyle",getNbPointsFn:"&?gmfProfileNumberofpoints",getOptionsFn:"&?gmfProfileOptions"},templateUrl:gmfProfileTemplateUrl};gmf.module.component("gmfProfile",gmf.profileComponent);
gmf.ProfileController=function(a,b,c,d,e,f,g,h){var k=this;this.$scope_=a;this.$http_=b;this.$element_=c;this.$filter_=d;this.gettextCatalog_=e;this.pointHoverOverlay_=f.getFeatureOverlay();this.gmfProfileJsonUrl_=g;this.ngeoCsvDownload_=h;this.linesConfiguration_=this.map_=null;this.layersNames_=[];this.nbPoints_=100;this.profileData=[];this.currentPoint={coordinate:void 0,distance:void 0,elevations:{},xUnits:void 0,yUnits:void 0};this.profileHighlight=-1;this.measureTooltipElement_=this.measureTooltip_=
null;this.snappedPoint_=new ol.Feature;this.pointHoverOverlay_.addFeature(this.snappedPoint_);this.profileLabels_={xAxis:e.getString("Distance"),yAxis:e.getString("Elevation")};this.profileOptions=null;this.isErrored=this.active=!1;a.$watch(function(){return k.active},function(a,b){b!==a&&k.updateEventsListening_()});a.$watch(function(){return k.line},function(a,b){b!==a&&k.update_()});this.updateEventsListening_()};gmf.ProfileController.$inject="$scope $http $element $filter gettextCatalog ngeoFeatureOverlayMgr gmfProfileJsonUrl ngeoCsvDownload".split(" ");
gmf.ProfileController.prototype.$onInit=function(){this.map_=this.getMapFn?this.getMapFn():null;this.nbPoints_=this.getNbPointsFn?this.getNbPointsFn():100;var a;(a=this.getHoverPointStyleFn)?(a=a(),goog.asserts.assertInstanceof(a,ol.style.Style)):a=new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:"#ffffff"}),radius:3})});this.pointHoverOverlay_.setStyle(a);a=this.getLinesConfigurationFn();goog.asserts.assertInstanceof(a,Object);this.linesConfiguration_=a;for(var b in this.linesConfiguration_)this.layersNames_.push(b),
this.linesConfiguration_[b].zExtractor||(this.linesConfiguration_[b].zExtractor=this.getZFactory_(b));this.profileOptions={linesConfiguration:this.linesConfiguration_,distanceExtractor:this.getDist_,hoverCallback:this.hoverCallback_.bind(this),outCallback:this.outCallback_.bind(this),i18n:this.profileLabels_};if(b=this.getOptionsFn)b=b(),goog.asserts.assertObject(b),ol.obj.assign(this.profileOptions,b)};
gmf.ProfileController.prototype.update_=function(){this.isErrored=!1;this.line?this.getJsonProfile_():this.profileData=[];this.active=!!this.line};gmf.ProfileController.prototype.updateEventsListening_=function(){this.active&&null!==this.map_?this.pointerMoveKey_=ol.events.listen(this.map_,"pointermove",this.onPointerMove_.bind(this)):ol.Observable.unByKey(this.pointerMoveKey_)};
gmf.ProfileController.prototype.onPointerMove_=function(a){if(!a.dragging&&this.line){a=this.map_.getEventCoordinate(a.originalEvent);var b=this.line.getClosestPoint(a);16>(new ol.geom.LineString([b,a])).getLength()/this.map_.getView().getResolution()?this.profileHighlight=this.getDistanceOnALine_(b,this.line):this.profileHighlight=-1;this.$scope_.$apply()}};
gmf.ProfileController.prototype.getDistanceOnALine_=function(a,b){var c,d=0,e=[a[0]-.5,a[1]-.5,a[0]+.5,a[1]+.5];this.line.forEachSegment(function(b,g){c=new ol.geom.LineString([b,g]);if(c.intersectsExtent(e))return c.setCoordinates([b,a]),d+=c.getLength();d+=c.getLength()});return d};
gmf.ProfileController.prototype.hoverCallback_=function(a,b,c,d,e){var f;a=[a.x,a.y];for(f in d)this.currentPoint.elevations[f]=d[f];this.currentPoint.distance=b;this.currentPoint.xUnits=c;this.currentPoint.yUnits=e;this.currentPoint.coordinate=a;b=new ol.geom.Point(a);this.createMeasureTooltip_();this.measureTooltipElement_.innerHTML=this.getTooltipHTML_();this.measureTooltip_.setPosition(a);this.snappedPoint_.setGeometry(b)};
gmf.ProfileController.prototype.outCallback_=function(){this.currentPoint.coordinate=void 0;this.currentPoint.distance=void 0;this.currentPoint.elevations={};this.currentPoint.xUnits=void 0;this.currentPoint.yUnits=void 0;this.removeMeasureTooltip_();this.snappedPoint_.setGeometry(null)};
gmf.ProfileController.prototype.getTooltipHTML_=function(){var a,b=[],c=this.$filter_("number");b.push(this.profileLabels_.xAxis+" : "+c(this.currentPoint.distance,"m"===this.currentPoint.xUnits?0:2)+" "+this.currentPoint.xUnits);for(a in this.currentPoint.elevations){var d=this.gettextCatalog_.getString(a);b.push(d+" : "+c(this.currentPoint.elevations[a],0)+" "+this.currentPoint.yUnits)}return b.join("</br>")};
gmf.ProfileController.prototype.createMeasureTooltip_=function(){this.removeMeasureTooltip_();this.measureTooltipElement_=document.createElement("div");this.measureTooltipElement_.className+="tooltip ngeo-tooltip-measure";this.measureTooltip_=new ol.Overlay({element:this.measureTooltipElement_,offset:[0,-15],positioning:"bottom-center"});this.map_.addOverlay(this.measureTooltip_)};
gmf.ProfileController.prototype.removeMeasureTooltip_=function(){null!==this.measureTooltipElement_&&(this.measureTooltipElement_.parentNode.removeChild(this.measureTooltipElement_),this.measureTooltipElement_=null,this.map_.removeOverlay(this.measureTooltip_))};gmf.ProfileController.prototype.getColor=function(a){if(a=this.linesConfiguration_[a])return a.color};goog.exportProperty(gmf.ProfileController.prototype,"getColor",gmf.ProfileController.prototype.getColor);
gmf.ProfileController.prototype.getLayersNames=function(){return this.layersNames_.slice(0)};goog.exportProperty(gmf.ProfileController.prototype,"getLayersNames",gmf.ProfileController.prototype.getLayersNames);gmf.ProfileController.prototype.getZFactory_=function(a){return function(b){return"values"in b&&a in b.values?parseFloat(b.values[a]):0}};gmf.ProfileController.prototype.getDist_=function(a){return"dist"in a?a.dist:0};
gmf.ProfileController.prototype.getJsonProfile_=function(){var a={type:"LineString",coordinates:this.line.getCoordinates()};a={layers:this.layersNames_.join(","),geom:JSON.stringify(a),nbPoints:this.nbPoints_};this.$http_({url:this.gmfProfileJsonUrl_,method:"POST",params:a,paramSerializer:"$httpParamSerializerJQLike",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(this.getProfileDataSuccess_.bind(this),this.getProfileDataError_.bind(this))};
gmf.ProfileController.prototype.getProfileDataSuccess_=function(a){a=a.data.profile;a instanceof Array&&(this.profileData=a)};gmf.ProfileController.prototype.getProfileDataError_=function(a){this.isErrored=!0;console.error("Can not get JSON profile.")};
gmf.ProfileController.prototype.downloadCsv=function(){if(0!==this.profileData.length){var a=[],b=!1,c=this.profileData[0];"dist"in c&&(a.push({name:"distance"}),b=!0);var d=[],e;for(e in c.values)a.push({name:e}),d.push(e);a.push({name:"x"});a.push({name:"y"});c=this.profileData.map(function(a){var c={};b&&(c.distance=a.dist);d.forEach(function(b){c[b]=a.values[b]});c.x=a.x;c.y=a.y;return c});this.ngeoCsvDownload_.startDownload(c,a,"profile.csv")}};
goog.exportProperty(gmf.ProfileController.prototype,"downloadCsv",gmf.ProfileController.prototype.downloadCsv);gmf.module.controller("GmfProfileController",gmf.ProfileController);gmf.drawprofilelineDirective=function(){return{scope:!0,controller:"GmfDrawprofilelineController as ctrl",restrict:"A",bindToController:{getMapFn:"&gmfDrawprofilelineMap",line:"=gmfDrawprofilelineLine",active:"=gmfDrawprofilelineActive",getStyleFn:"&?gmfDrawprofilelineStyle"},link:function(a,b,c,d){d.init()}}};gmf.module.directive("gmfDrawprofileline",gmf.drawprofilelineDirective);
gmf.DrawprofilelineController=function(a,b,c,d,e){var f=this;this.map_=null;this.features_=new ol.Collection;b=d.getFeatureOverlay();b.setFeatures(this.features_);(d=this.getStyleFn)?(d=d(),goog.asserts.assertInstanceof(d,ol.style.Style)):d=new ol.style.Style({stroke:new ol.style.Stroke({color:"#ffcc33",width:2})});b.setStyle(d);this.interaction=new ol.interaction.Draw({type:"LineString",features:this.features_});e(this.interaction);this.interaction.on(ol.Object.getChangeEventType(ol.interaction.Property.ACTIVE),
function(){this.interaction.getActive()&&this.clear_()},this);this.interaction.on(ol.interaction.DrawEventType.DRAWEND,function(a){var b=this;this.line=a.feature.getGeometry();c(function(){b.interaction.setActive(!1)},0)},this);a.$watch(function(){return f.line},function(a,b){null===a&&f.clear_()});a.$watch(function(){return f.active},function(a){!1===a&&f.clear_();f.interaction.setActive(f.active)})};gmf.DrawprofilelineController.$inject=["$scope","$element","$timeout","ngeoFeatureOverlayMgr","ngeoDecorateInteraction"];
gmf.DrawprofilelineController.prototype.init=function(){var a=this.getMapFn();goog.asserts.assertInstanceof(a,ol.Map);this.map_=a;this.map_.addInteraction(this.interaction)};gmf.DrawprofilelineController.prototype.clear_=function(){this.features_.clear();this.line=null};gmf.module.controller("GmfDrawprofilelineController",gmf.DrawprofilelineController);gmf.TimeSliderDirective={};
gmf.timeSliderDirective=function(a,b){return{scope:{onDateSelected:"&gmfTimeSliderOnDateSelected",time:"=gmfTimeSliderTime"},bindToController:!0,controller:"gmfTimeSliderController as sliderCtrl",restrict:"AE",templateUrl:gmf.baseTemplateUrl+"/timeslider.html",link:{pre:function(a,b,e,f){function c(b,c){c.values?(b=new Date(f.getClosestValue_(c.values[0])),c=new Date(f.getClosestValue_(c.values[1])),f.dates=[b,c],c={start:b.getTime(),end:c.getTime()}):(b=new Date(f.getClosestValue_(c.value)),f.dates=
b,c={start:b.getTime()});a.$apply();return c}f.init();f.sliderOptions.stop=function(b,d){f.onDateSelected({time:c(b,d)});a.$apply()};f.sliderOptions.slide=c}}}};gmf.timeSliderDirective.$inject=["$timeout","$filter"];gmf.TimeSliderController=function(a,b){this.ngeoWMSTime_=b};gmf.TimeSliderController.$inject=["$scope","ngeoWMSTime"];
gmf.TimeSliderController.prototype.init=function(){this.timeValueList=this.getTimeValueList_();var a=this.ngeoWMSTime_.getOptions(this.time);this.isModeRange="range"===this.time.mode;this.minValue=a.minDate;this.maxValue=a.maxDate;this.dates=this.isModeRange?[a.values[0],a.values[1]]:a.values;this.sliderOptions={range:this.isModeRange,min:this.minValue,max:this.maxValue}};
gmf.TimeSliderController.prototype.getTimeValueList_=function(){var a=this.time,b=null,c=new Date(this.minValue),d=new Date(this.maxValue);if(a.values)b=[],a.values.forEach(function(a){b.push((new Date(a)).getTime())});else{var e=new Date(c.getTime());e.setFullYear(c.getFullYear()+1024*a.interval[0]);e.setMonth(c.getMonth()+1024*a.interval[1],c.getDate()+1024*a.interval[2]);e.setSeconds(c.getSeconds()+1024*a.interval[3]);if(e>d)for(b=[],e=0;;e++){var f=new Date(c.getTime());f.setFullYear(c.getFullYear()+
e*a.interval[0]);f.setMonth(c.getMonth()+e*a.interval[1],c.getDate()+e*a.interval[2]);f.setSeconds(c.getSeconds()+e*a.interval[3]);if(f<=d)b.push(f.getTime());else break}}return b};
gmf.TimeSliderController.prototype.getClosestValue_=function(a){if(a<=this.minValue)return this.minValue;if(a>=this.maxValue)return this.maxValue;if(this.timeValueList){for(var b,c=0,d=this.timeValueList.length-1;1<d-c;)b=Math.floor((c+d)/2),this.timeValueList[b]>=a?d=b:c=b;return this.timeValueList[Math.abs(this.timeValueList[c]-a)<Math.abs(this.timeValueList[d]-a)?c:d]}a=new Date(a);b=new Date(this.minValue);c=new Date(this.minValue);d=new Date(this.maxValue);for(var e=Math.abs(a-c),f=1;;f++){var g=
new Date(b.getTime());g.setFullYear(b.getFullYear()+f*this.time.interval[0]);g.setMonth(b.getMonth()+f*this.time.interval[1],b.getDate()+f*this.time.interval[2]);g.setSeconds(b.getSeconds()+f*this.time.interval[3]);if(g>d)break;var h=Math.abs(a-g);if(h<=e)c=g,e=h;else break}return c.getTime()};gmf.TimeSliderController.prototype.getLocalizedDate=function(a){return this.ngeoWMSTime_.formatTimeValue(a,this.time.resolution)};goog.exportProperty(gmf.TimeSliderController.prototype,"getLocalizedDate",gmf.TimeSliderController.prototype.getLocalizedDate);
gmf.module.controller("gmfTimeSliderController",gmf.TimeSliderController);gmf.module.directive("gmfTimeSlider",gmf.timeSliderDirective);gmf.ShareService=function(a,b){this.$http_=a;this.gmfShortenerCreateUrl_=b};goog.exportSymbol("gmf.ShareService",gmf.ShareService);gmf.ShareService.$inject=["$http","gmfShortenerCreateUrl"];gmf.ShareService.prototype.getShortUrl=function(a){return this.gmfShortenerCreateUrl_?this.postShortUrl_({url:a}):{data:{short_url:a},status:200}};gmf.ShareService.prototype.sendShortUrl=function(a,b,c){a={url:a,email:b};c&&(a.message=c);return this.postShortUrl_(a)};
gmf.ShareService.prototype.postShortUrl_=function(a){return this.$http_.post(this.gmfShortenerCreateUrl_,$.param(a),{headers:{"Content-Type":"application/x-www-form-urlencoded"}})};gmf.ShareService.URL_MAX_LEN=2083;gmf.ShareService.URL_PATH_MAX_LEN=2048;gmf.module.service("gmfShareService",gmf.ShareService);gmf.shareDirective=function(){return{restrict:"E",controller:"GmfShareController as shareCtrl",templateUrl:gmf.baseTemplateUrl+"/share.html"}};
gmf.ShareController=function(a,b,c,d,e){this.$scope_=a;this.gmfShareService_=c;this.$q_=d;this.ngeoLocation_=b;this.enableEmail="true"===e.gmfShareEmail;this.permalink=b.getUriString();this.showLenghtWarning=this.permalink.length>gmf.ShareService.URL_MAX_LEN||b.getPath()>gmf.ShareService.URL_PATH_MAX_LEN;this.errorOnGetShortUrl=this.errorOnsend=this.successfullySent=!1;this.getShortUrl()};gmf.ShareController.$inject=["$scope","ngeoLocation","gmfShareService","$q","$attrs"];
gmf.ShareController.prototype.getShortUrl=function(){this.$q_.when(this.gmfShareService_.getShortUrl(this.permalink)).then(function(a){this.shortLink=a.data.short_url;this.errorOnGetShortUrl=!1}.bind(this),function(a){this.shortLink=this.permalink;this.errorOnGetShortUrl=!0}.bind(this))};goog.exportProperty(gmf.ShareController.prototype,"getShortUrl",gmf.ShareController.prototype.getShortUrl);
gmf.ShareController.prototype.sendShortUrl=function(){function a(a){this.successfullySent=!0}function b(a){this.errorOnsend_=!0}this.$scope_.gmfShareForm.$valid&&this.$q_.when(this.gmfShareService_.sendShortUrl(this.permalink,this.email,this.message)).then(a.bind(this),b.bind(this))};goog.exportProperty(gmf.ShareController.prototype,"sendShortUrl",gmf.ShareController.prototype.sendShortUrl);gmf.module.directive("gmfShare",gmf.shareDirective);gmf.module.controller("GmfShareController",gmf.ShareController);ngeo.resizemapDirective=function(a){return{restrict:"A",link:function(b,c,d){var e=b.$eval(d.ngeoResizemap);goog.asserts.assertInstanceof(e,ol.Map);d=d.ngeoResizemapState;goog.asserts.assert(void 0!==d);var f,g,h=function(){e.updateSize();e.renderSync();1E3>Date.now()-f&&(g=a.requestAnimationFrame(h))};c.on("transitionend",function(){e.updateSize();e.renderSync()});b.$watch(d,function(b,c){b!=c&&(f=Date.now(),a.cancelAnimationFrame(g),g=a.requestAnimationFrame(h))})}}};
ngeo.resizemapDirective.$inject=["$window"];ngeo.module.directive("ngeoResizemap",ngeo.resizemapDirective);ngeo.module.value("ngeoScaleselectorTemplateUrl",function(a,b){a=b.ngeoScaleselectorTemplateurl;return void 0!==a?a:ngeo.baseTemplateUrl+"/scaleselector.html"});ngeo.scaleselectorDirective=function(a){return{restrict:"A",scope:!0,controller:"NgeoScaleselectorController",templateUrl:a}};ngeo.scaleselectorDirective.$inject=["ngeoScaleselectorTemplateUrl"];ngeo.module.directive("ngeoScaleselector",ngeo.scaleselectorDirective);
ngeo.ScaleselectorController=function(a,b,c){var d=this;this.scales=a.$eval(c.ngeoScaleselector);goog.asserts.assert(void 0!==this.scales);a.$watch(function(){return Object.keys(d.scales).length},function(a){d.zoomLevels=Object.keys(d.scales).map(Number);d.zoomLevels.sort(ol.array.numberSafeCompareFunction)});this.map_=a.$eval(c.ngeoScaleselectorMap);goog.asserts.assertInstanceof(this.map_,ol.Map);b=a.$eval(c.ngeoScaleselectorOptions);this.options=ngeo.ScaleselectorController.getOptions_(b);this.$scope_=
a;this.resolutionChangeKey_=null;this.currentScale=void 0;null!==this.map_.getView()&&(b=this.map_.getView().getZoom(),void 0!==b&&(this.currentScale=this.getScale(b)));ol.events.listen(this.map_,ol.Object.getChangeEventType("view"),this.handleViewChange_,this);this.registerResolutionChangeListener_();a.scaleselectorCtrl=this};ngeo.ScaleselectorController.$inject=["$scope","$element","$attrs"];
ngeo.ScaleselectorController.getOptions_=function(a){void 0===a?a={dropup:!1}:void 0===a.dropup&&(a.dropup=!1);return a};ngeo.ScaleselectorController.prototype.getScale=function(a){return this.scales[a]};goog.exportProperty(ngeo.ScaleselectorController.prototype,"getScale",ngeo.ScaleselectorController.prototype.getScale);ngeo.ScaleselectorController.prototype.changeZoom=function(a){this.map_.getView().setZoom(a)};goog.exportProperty(ngeo.ScaleselectorController.prototype,"changeZoom",ngeo.ScaleselectorController.prototype.changeZoom);
ngeo.ScaleselectorController.prototype.handleResolutionChange_=function(a){var b=this;a=this.map_.getView();var c=this.scales[a.getZoom()];this.$scope_.$applyAsync(function(){b.currentScale=c})};ngeo.ScaleselectorController.prototype.handleViewChange_=function(a){this.registerResolutionChangeListener_();this.handleResolutionChange_(null)};
ngeo.ScaleselectorController.prototype.registerResolutionChangeListener_=function(){null!==this.resolutionChangeKey_&&ol.events.unlistenByKey(this.resolutionChangeKey_);var a=this.map_.getView();this.resolutionChangeKey_=ol.events.listen(a,ol.Object.getChangeEventType("resolution"),this.handleResolutionChange_,this)};ngeo.module.controller("NgeoScaleselectorController",ngeo.ScaleselectorController);goog.dom.BrowserFeature={CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),CAN_USE_CHILDREN_ATTRIBUTE:!goog.userAgent.GECKO&&!goog.userAgent.IE||goog.userAgent.IE&&goog.userAgent.isDocumentModeOrHigher(9)||goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9.1"),CAN_USE_INNER_TEXT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),CAN_USE_PARENT_ELEMENT_PROPERTY:goog.userAgent.IE||goog.userAgent.OPERA||goog.userAgent.WEBKIT,INNER_HTML_NEEDS_SCOPED_ELEMENT:goog.userAgent.IE,
LEGACY_IE_RANGES:goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)};goog.dom.HtmlElement=function(){};goog.dom.TagName=function(a){this.tagName_=a};goog.dom.TagName.prototype.toString=function(){return this.tagName_};goog.dom.TagName.A=new goog.dom.TagName("A");goog.dom.TagName.ABBR=new goog.dom.TagName("ABBR");goog.dom.TagName.ACRONYM=new goog.dom.TagName("ACRONYM");goog.dom.TagName.ADDRESS=new goog.dom.TagName("ADDRESS");goog.dom.TagName.APPLET=new goog.dom.TagName("APPLET");goog.dom.TagName.AREA=new goog.dom.TagName("AREA");goog.dom.TagName.ARTICLE=new goog.dom.TagName("ARTICLE");
goog.dom.TagName.ASIDE=new goog.dom.TagName("ASIDE");goog.dom.TagName.AUDIO=new goog.dom.TagName("AUDIO");goog.dom.TagName.B=new goog.dom.TagName("B");goog.dom.TagName.BASE=new goog.dom.TagName("BASE");goog.dom.TagName.BASEFONT=new goog.dom.TagName("BASEFONT");goog.dom.TagName.BDI=new goog.dom.TagName("BDI");goog.dom.TagName.BDO=new goog.dom.TagName("BDO");goog.dom.TagName.BIG=new goog.dom.TagName("BIG");goog.dom.TagName.BLOCKQUOTE=new goog.dom.TagName("BLOCKQUOTE");goog.dom.TagName.BODY=new goog.dom.TagName("BODY");
goog.dom.TagName.BR=new goog.dom.TagName("BR");goog.dom.TagName.BUTTON=new goog.dom.TagName("BUTTON");goog.dom.TagName.CANVAS=new goog.dom.TagName("CANVAS");goog.dom.TagName.CAPTION=new goog.dom.TagName("CAPTION");goog.dom.TagName.CENTER=new goog.dom.TagName("CENTER");goog.dom.TagName.CITE=new goog.dom.TagName("CITE");goog.dom.TagName.CODE=new goog.dom.TagName("CODE");goog.dom.TagName.COL=new goog.dom.TagName("COL");goog.dom.TagName.COLGROUP=new goog.dom.TagName("COLGROUP");
goog.dom.TagName.COMMAND=new goog.dom.TagName("COMMAND");goog.dom.TagName.DATA=new goog.dom.TagName("DATA");goog.dom.TagName.DATALIST=new goog.dom.TagName("DATALIST");goog.dom.TagName.DD=new goog.dom.TagName("DD");goog.dom.TagName.DEL=new goog.dom.TagName("DEL");goog.dom.TagName.DETAILS=new goog.dom.TagName("DETAILS");goog.dom.TagName.DFN=new goog.dom.TagName("DFN");goog.dom.TagName.DIALOG=new goog.dom.TagName("DIALOG");goog.dom.TagName.DIR=new goog.dom.TagName("DIR");goog.dom.TagName.DIV=new goog.dom.TagName("DIV");
goog.dom.TagName.DL=new goog.dom.TagName("DL");goog.dom.TagName.DT=new goog.dom.TagName("DT");goog.dom.TagName.EM=new goog.dom.TagName("EM");goog.dom.TagName.EMBED=new goog.dom.TagName("EMBED");goog.dom.TagName.FIELDSET=new goog.dom.TagName("FIELDSET");goog.dom.TagName.FIGCAPTION=new goog.dom.TagName("FIGCAPTION");goog.dom.TagName.FIGURE=new goog.dom.TagName("FIGURE");goog.dom.TagName.FONT=new goog.dom.TagName("FONT");goog.dom.TagName.FOOTER=new goog.dom.TagName("FOOTER");goog.dom.TagName.FORM=new goog.dom.TagName("FORM");
goog.dom.TagName.FRAME=new goog.dom.TagName("FRAME");goog.dom.TagName.FRAMESET=new goog.dom.TagName("FRAMESET");goog.dom.TagName.H1=new goog.dom.TagName("H1");goog.dom.TagName.H2=new goog.dom.TagName("H2");goog.dom.TagName.H3=new goog.dom.TagName("H3");goog.dom.TagName.H4=new goog.dom.TagName("H4");goog.dom.TagName.H5=new goog.dom.TagName("H5");goog.dom.TagName.H6=new goog.dom.TagName("H6");goog.dom.TagName.HEAD=new goog.dom.TagName("HEAD");goog.dom.TagName.HEADER=new goog.dom.TagName("HEADER");
goog.dom.TagName.HGROUP=new goog.dom.TagName("HGROUP");goog.dom.TagName.HR=new goog.dom.TagName("HR");goog.dom.TagName.HTML=new goog.dom.TagName("HTML");goog.dom.TagName.I=new goog.dom.TagName("I");goog.dom.TagName.IFRAME=new goog.dom.TagName("IFRAME");goog.dom.TagName.IMG=new goog.dom.TagName("IMG");goog.dom.TagName.INPUT=new goog.dom.TagName("INPUT");goog.dom.TagName.INS=new goog.dom.TagName("INS");goog.dom.TagName.ISINDEX=new goog.dom.TagName("ISINDEX");goog.dom.TagName.KBD=new goog.dom.TagName("KBD");
goog.dom.TagName.KEYGEN=new goog.dom.TagName("KEYGEN");goog.dom.TagName.LABEL=new goog.dom.TagName("LABEL");goog.dom.TagName.LEGEND=new goog.dom.TagName("LEGEND");goog.dom.TagName.LI=new goog.dom.TagName("LI");goog.dom.TagName.LINK=new goog.dom.TagName("LINK");goog.dom.TagName.MAP=new goog.dom.TagName("MAP");goog.dom.TagName.MARK=new goog.dom.TagName("MARK");goog.dom.TagName.MATH=new goog.dom.TagName("MATH");goog.dom.TagName.MENU=new goog.dom.TagName("MENU");goog.dom.TagName.META=new goog.dom.TagName("META");
goog.dom.TagName.METER=new goog.dom.TagName("METER");goog.dom.TagName.NAV=new goog.dom.TagName("NAV");goog.dom.TagName.NOFRAMES=new goog.dom.TagName("NOFRAMES");goog.dom.TagName.NOSCRIPT=new goog.dom.TagName("NOSCRIPT");goog.dom.TagName.OBJECT=new goog.dom.TagName("OBJECT");goog.dom.TagName.OL=new goog.dom.TagName("OL");goog.dom.TagName.OPTGROUP=new goog.dom.TagName("OPTGROUP");goog.dom.TagName.OPTION=new goog.dom.TagName("OPTION");goog.dom.TagName.OUTPUT=new goog.dom.TagName("OUTPUT");
goog.dom.TagName.P=new goog.dom.TagName("P");goog.dom.TagName.PARAM=new goog.dom.TagName("PARAM");goog.dom.TagName.PRE=new goog.dom.TagName("PRE");goog.dom.TagName.PROGRESS=new goog.dom.TagName("PROGRESS");goog.dom.TagName.Q=new goog.dom.TagName("Q");goog.dom.TagName.RP=new goog.dom.TagName("RP");goog.dom.TagName.RT=new goog.dom.TagName("RT");goog.dom.TagName.RUBY=new goog.dom.TagName("RUBY");goog.dom.TagName.S=new goog.dom.TagName("S");goog.dom.TagName.SAMP=new goog.dom.TagName("SAMP");
goog.dom.TagName.SCRIPT=new goog.dom.TagName("SCRIPT");goog.dom.TagName.SECTION=new goog.dom.TagName("SECTION");goog.dom.TagName.SELECT=new goog.dom.TagName("SELECT");goog.dom.TagName.SMALL=new goog.dom.TagName("SMALL");goog.dom.TagName.SOURCE=new goog.dom.TagName("SOURCE");goog.dom.TagName.SPAN=new goog.dom.TagName("SPAN");goog.dom.TagName.STRIKE=new goog.dom.TagName("STRIKE");goog.dom.TagName.STRONG=new goog.dom.TagName("STRONG");goog.dom.TagName.STYLE=new goog.dom.TagName("STYLE");
goog.dom.TagName.SUB=new goog.dom.TagName("SUB");goog.dom.TagName.SUMMARY=new goog.dom.TagName("SUMMARY");goog.dom.TagName.SUP=new goog.dom.TagName("SUP");goog.dom.TagName.SVG=new goog.dom.TagName("SVG");goog.dom.TagName.TABLE=new goog.dom.TagName("TABLE");goog.dom.TagName.TBODY=new goog.dom.TagName("TBODY");goog.dom.TagName.TD=new goog.dom.TagName("TD");goog.dom.TagName.TEMPLATE=new goog.dom.TagName("TEMPLATE");goog.dom.TagName.TEXTAREA=new goog.dom.TagName("TEXTAREA");goog.dom.TagName.TFOOT=new goog.dom.TagName("TFOOT");
goog.dom.TagName.TH=new goog.dom.TagName("TH");goog.dom.TagName.THEAD=new goog.dom.TagName("THEAD");goog.dom.TagName.TIME=new goog.dom.TagName("TIME");goog.dom.TagName.TITLE=new goog.dom.TagName("TITLE");goog.dom.TagName.TR=new goog.dom.TagName("TR");goog.dom.TagName.TRACK=new goog.dom.TagName("TRACK");goog.dom.TagName.TT=new goog.dom.TagName("TT");goog.dom.TagName.U=new goog.dom.TagName("U");goog.dom.TagName.UL=new goog.dom.TagName("UL");goog.dom.TagName.VAR=new goog.dom.TagName("VAR");
goog.dom.TagName.VIDEO=new goog.dom.TagName("VIDEO");goog.dom.TagName.WBR=new goog.dom.TagName("WBR");goog.dom.asserts={};goog.dom.asserts.assertIsLocation=function(a){if(goog.asserts.ENABLE_ASSERTS){var b=goog.dom.asserts.getWindow_(a);"undefined"!=typeof b.Location&&"undefined"!=typeof b.Element&&goog.asserts.assert(a&&(a instanceof b.Location||!(a instanceof b.Element)),"Argument is not a Location (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(a))}return a};
goog.dom.asserts.assertIsHTMLAnchorElement=function(a){if(goog.asserts.ENABLE_ASSERTS){var b=goog.dom.asserts.getWindow_(a);"undefined"!=typeof b.HTMLAnchorElement&&"undefined"!=typeof b.Location&&"undefined"!=typeof b.Element&&goog.asserts.assert(a&&(a instanceof b.HTMLAnchorElement||!(a instanceof b.Location||a instanceof b.Element)),"Argument is not a HTMLAnchorElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(a))}return a};
goog.dom.asserts.assertIsHTMLLinkElement=function(a){if(goog.asserts.ENABLE_ASSERTS){var b=goog.dom.asserts.getWindow_(a);"undefined"!=typeof b.HTMLLinkElement&&"undefined"!=typeof b.Location&&"undefined"!=typeof b.Element&&goog.asserts.assert(a&&(a instanceof b.HTMLLinkElement||!(a instanceof b.Location||a instanceof b.Element)),"Argument is not a HTMLLinkElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(a))}return a};
goog.dom.asserts.assertIsHTMLImageElement=function(a){if(goog.asserts.ENABLE_ASSERTS){var b=goog.dom.asserts.getWindow_(a);"undefined"!=typeof b.HTMLImageElement&&"undefined"!=typeof b.Element&&goog.asserts.assert(a&&(a instanceof b.HTMLImageElement||!(a instanceof b.Element)),"Argument is not a HTMLImageElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(a))}return a};
goog.dom.asserts.assertIsHTMLEmbedElement=function(a){if(goog.asserts.ENABLE_ASSERTS){var b=goog.dom.asserts.getWindow_(a);"undefined"!=typeof b.HTMLEmbedElement&&"undefined"!=typeof b.Element&&goog.asserts.assert(a&&(a instanceof b.HTMLEmbedElement||!(a instanceof b.Element)),"Argument is not a HTMLEmbedElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(a))}return a};
goog.dom.asserts.assertIsHTMLFrameElement=function(a){if(goog.asserts.ENABLE_ASSERTS){var b=goog.dom.asserts.getWindow_(a);"undefined"!=typeof b.HTMLFrameElement&&"undefined"!=typeof b.Element&&goog.asserts.assert(a&&(a instanceof b.HTMLFrameElement||!(a instanceof b.Element)),"Argument is not a HTMLFrameElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(a))}return a};
goog.dom.asserts.assertIsHTMLIFrameElement=function(a){if(goog.asserts.ENABLE_ASSERTS){var b=goog.dom.asserts.getWindow_(a);"undefined"!=typeof b.HTMLIFrameElement&&"undefined"!=typeof b.Element&&goog.asserts.assert(a&&(a instanceof b.HTMLIFrameElement||!(a instanceof b.Element)),"Argument is not a HTMLIFrameElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(a))}return a};
goog.dom.asserts.assertIsHTMLObjectElement=function(a){if(goog.asserts.ENABLE_ASSERTS){var b=goog.dom.asserts.getWindow_(a);"undefined"!=typeof b.HTMLObjectElement&&"undefined"!=typeof b.Element&&goog.asserts.assert(a&&(a instanceof b.HTMLObjectElement||!(a instanceof b.Element)),"Argument is not a HTMLObjectElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(a))}return a};
goog.dom.asserts.assertIsHTMLScriptElement=function(a){if(goog.asserts.ENABLE_ASSERTS){var b=goog.dom.asserts.getWindow_(a);"undefined"!=typeof b.HTMLScriptElement&&"undefined"!=typeof b.Element&&goog.asserts.assert(a&&(a instanceof b.HTMLScriptElement||!(a instanceof b.Element)),"Argument is not a HTMLScriptElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(a))}return a};
goog.dom.asserts.debugStringForType_=function(a){return goog.isObject(a)?a.constructor.displayName||a.constructor.name||Object.prototype.toString.call(a):void 0===a?"undefined":null===a?"null":typeof a};goog.dom.asserts.getWindow_=function(a){return(a=a&&a.ownerDocument)&&(a.defaultView||a.parentWindow)||goog.global};goog.dom.tags={};goog.dom.tags.VOID_TAGS_={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};goog.dom.tags.isVoidTag=function(a){return!0===goog.dom.tags.VOID_TAGS_[a]};goog.string.TypedString=function(){};goog.string.Const=function(){this.stringConstValueWithSecurityContract__googStringSecurityPrivate_="";this.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_=goog.string.Const.TYPE_MARKER_};goog.string.Const.prototype.implementsGoogStringTypedString=!0;goog.string.Const.prototype.getTypedStringValue=function(){return this.stringConstValueWithSecurityContract__googStringSecurityPrivate_};
goog.string.Const.prototype.toString=function(){return"Const{"+this.stringConstValueWithSecurityContract__googStringSecurityPrivate_+"}"};goog.string.Const.unwrap=function(a){if(a instanceof goog.string.Const&&a.constructor===goog.string.Const&&a.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_===goog.string.Const.TYPE_MARKER_)return a.stringConstValueWithSecurityContract__googStringSecurityPrivate_;goog.asserts.fail("expected object of type Const, got '"+a+"'");return"type_error:Const"};
goog.string.Const.from=function(a){return goog.string.Const.create__googStringSecurityPrivate_(a)};goog.string.Const.TYPE_MARKER_={};goog.string.Const.create__googStringSecurityPrivate_=function(a){var b=new goog.string.Const;b.stringConstValueWithSecurityContract__googStringSecurityPrivate_=a;return b};goog.string.Const.EMPTY=goog.string.Const.from("");goog.html={};goog.html.SafeScript=function(){this.privateDoNotAccessOrElseSafeScriptWrappedValue_="";this.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeScript.prototype.implementsGoogStringTypedString=!0;goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeScript.fromConstant=function(a){a=goog.string.Const.unwrap(a);return 0===a.length?goog.html.SafeScript.EMPTY:goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(a)};
goog.html.SafeScript.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_};goog.DEBUG&&(goog.html.SafeScript.prototype.toString=function(){return"SafeScript{"+this.privateDoNotAccessOrElseSafeScriptWrappedValue_+"}"});
goog.html.SafeScript.unwrap=function(a){if(a instanceof goog.html.SafeScript&&a.constructor===goog.html.SafeScript&&a.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return a.privateDoNotAccessOrElseSafeScriptWrappedValue_;goog.asserts.fail("expected object of type SafeScript, got '"+a+"' of type "+goog.typeOf(a));return"type_error:SafeScript"};goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse=function(a){return(new goog.html.SafeScript).initSecurityPrivateDoNotAccessOrElse_(a)};
goog.html.SafeScript.prototype.initSecurityPrivateDoNotAccessOrElse_=function(a){this.privateDoNotAccessOrElseSafeScriptWrappedValue_=a;return this};goog.html.SafeScript.EMPTY=goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse("");goog.fs={};goog.fs.url={};goog.fs.url.createObjectUrl=function(a){return goog.fs.url.getUrlObject_().createObjectURL(a)};goog.fs.url.revokeObjectUrl=function(a){goog.fs.url.getUrlObject_().revokeObjectURL(a)};goog.fs.url.getUrlObject_=function(){var a=goog.fs.url.findUrlObject_();if(null!=a)return a;throw Error("This browser doesn't seem to support blob URLs");};
goog.fs.url.findUrlObject_=function(){return goog.isDef(goog.global.URL)&&goog.isDef(goog.global.URL.createObjectURL)?goog.global.URL:goog.isDef(goog.global.webkitURL)&&goog.isDef(goog.global.webkitURL.createObjectURL)?goog.global.webkitURL:goog.isDef(goog.global.createObjectURL)?goog.global:null};goog.fs.url.browserSupportsObjectUrls=function(){return null!=goog.fs.url.findUrlObject_()};goog.i18n={};goog.i18n.bidi={};goog.i18n.bidi.FORCE_RTL=!1;
goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||("ar"==goog.LOCALE.substring(0,2).toLowerCase()||"fa"==goog.LOCALE.substring(0,2).toLowerCase()||"he"==goog.LOCALE.substring(0,2).toLowerCase()||"iw"==goog.LOCALE.substring(0,2).toLowerCase()||"ps"==goog.LOCALE.substring(0,2).toLowerCase()||"sd"==goog.LOCALE.substring(0,2).toLowerCase()||"ug"==goog.LOCALE.substring(0,2).toLowerCase()||"ur"==goog.LOCALE.substring(0,2).toLowerCase()||"yi"==goog.LOCALE.substring(0,2).toLowerCase())&&(2==goog.LOCALE.length||
"-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3))||3<=goog.LOCALE.length&&"ckb"==goog.LOCALE.substring(0,3).toLowerCase()&&(3==goog.LOCALE.length||"-"==goog.LOCALE.substring(3,4)||"_"==goog.LOCALE.substring(3,4));goog.i18n.bidi.Format={LRE:"\u202a",RLE:"\u202b",PDF:"\u202c",LRM:"\u200e",RLM:"\u200f"};goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0};goog.i18n.bidi.RIGHT="right";goog.i18n.bidi.LEFT="left";goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT;
goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT;goog.i18n.bidi.toDir=function(a,b){return"number"==typeof a?0<a?goog.i18n.bidi.Dir.LTR:0>a?goog.i18n.bidi.Dir.RTL:b?null:goog.i18n.bidi.Dir.NEUTRAL:null==a?null:a?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};goog.i18n.bidi.ltrChars_="A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0800-\u1fff\u200e\u2c00-\ufb1c\ufe00-\ufe6f\ufefd-\uffff";goog.i18n.bidi.rtlChars_="\u0591-\u06ef\u06fa-\u07ff\u200f\ufb1d-\ufdff\ufe70-\ufefc";
goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g;goog.i18n.bidi.stripHtmlIfNeeded_=function(a,b){return b?a.replace(goog.i18n.bidi.htmlSkipReg_,""):a};goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.hasAnyRtl=function(a,b){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl;
goog.i18n.bidi.hasAnyLtr=function(a,b){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.isRtlChar=function(a){return goog.i18n.bidi.rtlRe_.test(a)};goog.i18n.bidi.isLtrChar=function(a){return goog.i18n.bidi.ltrRe_.test(a)};goog.i18n.bidi.isNeutralChar=function(a){return!goog.i18n.bidi.isLtrChar(a)&&!goog.i18n.bidi.isRtlChar(a)};
goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.startsWithRtl=function(a,b){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl;
goog.i18n.bidi.startsWithLtr=function(a,b){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr;goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/;goog.i18n.bidi.isNeutralText=function(a,b){a=goog.i18n.bidi.stripHtmlIfNeeded_(a,b);return goog.i18n.bidi.isRequiredLtrRe_.test(a)||!goog.i18n.bidi.hasAnyLtr(a)&&!goog.i18n.bidi.hasAnyRtl(a)};
goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$");goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$");goog.i18n.bidi.endsWithLtr=function(a,b){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr;
goog.i18n.bidi.endsWithRtl=function(a,b){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl;goog.i18n.bidi.rtlLocalesRe_=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Arab|Hebr|Thaa|Nkoo|Tfng))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;goog.i18n.bidi.isRtlLanguage=function(a){return goog.i18n.bidi.rtlLocalesRe_.test(a)};goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g;
goog.i18n.bidi.guardBracketInText=function(a,b){b=(void 0===b?goog.i18n.bidi.hasAnyRtl(a):b)?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM;return a.replace(goog.i18n.bidi.bracketGuardTextRe_,b+"$&"+b)};goog.i18n.bidi.enforceRtlInHtml=function(a){return"<"==a.charAt(0)?a.replace(/<\w+/,"$& dir=rtl"):"\n<span dir=rtl>"+a+"</span>"};goog.i18n.bidi.enforceRtlInText=function(a){return goog.i18n.bidi.Format.RLE+a+goog.i18n.bidi.Format.PDF};
goog.i18n.bidi.enforceLtrInHtml=function(a){return"<"==a.charAt(0)?a.replace(/<\w+/,"$& dir=ltr"):"\n<span dir=ltr>"+a+"</span>"};goog.i18n.bidi.enforceLtrInText=function(a){return goog.i18n.bidi.Format.LRE+a+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g;goog.i18n.bidi.leftRe_=/left/gi;goog.i18n.bidi.rightRe_=/right/gi;goog.i18n.bidi.tempRe_=/%%%%/g;
goog.i18n.bidi.mirrorCSS=function(a){return a.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)};goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g;goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g;
goog.i18n.bidi.normalizeHebrewQuote=function(a){return a.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1\u05f4").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1\u05f3")};goog.i18n.bidi.wordSeparatorRe_=/\s+/;goog.i18n.bidi.hasNumeralsRe_=/[\d\u06f0-\u06f9]/;goog.i18n.bidi.rtlDetectionThreshold_=.4;
goog.i18n.bidi.estimateDirection=function(a,b){var c=0,d=0,e=!1;a=goog.i18n.bidi.stripHtmlIfNeeded_(a,b).split(goog.i18n.bidi.wordSeparatorRe_);for(b=0;b<a.length;b++){var f=a[b];goog.i18n.bidi.startsWithRtl(f)?(c++,d++):goog.i18n.bidi.isRequiredLtrRe_.test(f)?e=!0:goog.i18n.bidi.hasAnyLtr(f)?d++:goog.i18n.bidi.hasNumeralsRe_.test(f)&&(e=!0)}return 0==d?e?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:c/d>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};
goog.i18n.bidi.detectRtlDirectionality=function(a,b){return goog.i18n.bidi.estimateDirection(a,b)==goog.i18n.bidi.Dir.RTL};goog.i18n.bidi.setElementDirAndAlign=function(a,b){a&&(b=goog.i18n.bidi.toDir(b))&&(a.style.textAlign=b==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,a.dir=b==goog.i18n.bidi.Dir.RTL?"rtl":"ltr")};
goog.i18n.bidi.setElementDirByTextDirectionality=function(a,b){switch(goog.i18n.bidi.estimateDirection(b)){case goog.i18n.bidi.Dir.LTR:a.dir="ltr";break;case goog.i18n.bidi.Dir.RTL:a.dir="rtl";break;default:a.removeAttribute("dir")}};goog.i18n.bidi.DirectionalString=function(){};goog.html.TrustedResourceUrl=function(){this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_="";this.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.TrustedResourceUrl.prototype.implementsGoogStringTypedString=!0;goog.html.TrustedResourceUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_};
goog.html.TrustedResourceUrl.prototype.implementsGoogI18nBidiDirectionalString=!0;goog.html.TrustedResourceUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR};goog.DEBUG&&(goog.html.TrustedResourceUrl.prototype.toString=function(){return"TrustedResourceUrl{"+this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_+"}"});
goog.html.TrustedResourceUrl.unwrap=function(a){if(a instanceof goog.html.TrustedResourceUrl&&a.constructor===goog.html.TrustedResourceUrl&&a.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return a.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_;goog.asserts.fail("expected object of type TrustedResourceUrl, got '"+a+"' of type "+goog.typeOf(a));return"type_error:TrustedResourceUrl"};
goog.html.TrustedResourceUrl.format=function(a,b){a=goog.html.TrustedResourceUrl.format_(a,b);return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(a)};
goog.html.TrustedResourceUrl.format_=function(a,b){var c=goog.string.Const.unwrap(a);if(!goog.html.TrustedResourceUrl.BASE_URL_.test(c))throw Error("Invalid TrustedResourceUrl format: "+c);return c.replace(goog.html.TrustedResourceUrl.FORMAT_MARKER_,function(a,e){if(!Object.prototype.hasOwnProperty.call(b,e))throw Error('Found marker, "'+e+'", in format string, "'+c+'", but no valid label mapping found in args: '+JSON.stringify(b));a=b[e];return a instanceof goog.string.Const?goog.string.Const.unwrap(a):
encodeURIComponent(String(a))})};goog.html.TrustedResourceUrl.FORMAT_MARKER_=/%{(\w+)}/g;goog.html.TrustedResourceUrl.BASE_URL_=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank(#|$)/i;goog.html.TrustedResourceUrl.formatWithParams=function(a,b,c){a=goog.html.TrustedResourceUrl.format_(a,b);b=/\?/.test(a)?"&":"?";for(var d in c)null!=c[d]&&(a+=b+encodeURIComponent(d)+"="+encodeURIComponent(String(c[d])),b="&");return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(a)};
goog.html.TrustedResourceUrl.fromConstant=function(a){return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(a))};goog.html.TrustedResourceUrl.fromConstants=function(a){for(var b="",c=0;c<a.length;c++)b+=goog.string.Const.unwrap(a[c]);return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(b)};goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};
goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse=function(a){var b=new goog.html.TrustedResourceUrl;b.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_=a;return b};goog.html.SafeUrl=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="";this.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeUrl.INNOCUOUS_STRING="about:invalid#zClosurez";goog.html.SafeUrl.prototype.implementsGoogStringTypedString=!0;goog.html.SafeUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_};
goog.html.SafeUrl.prototype.implementsGoogI18nBidiDirectionalString=!0;goog.html.SafeUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR};goog.DEBUG&&(goog.html.SafeUrl.prototype.toString=function(){return"SafeUrl{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"});
goog.html.SafeUrl.unwrap=function(a){if(a instanceof goog.html.SafeUrl&&a.constructor===goog.html.SafeUrl&&a.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return a.privateDoNotAccessOrElseSafeHtmlWrappedValue_;goog.asserts.fail("expected object of type SafeUrl, got '"+a+"' of type "+goog.typeOf(a));return"type_error:SafeUrl"};goog.html.SafeUrl.fromConstant=function(a){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(a))};
goog.html.SAFE_MIME_TYPE_PATTERN_=/^(?:audio\/(?:3gpp|3gpp2|aac|midi|mp4|mpeg|ogg|x-m4a|x-wav|webm)|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm))$/i;goog.html.SafeUrl.fromBlob=function(a){a=goog.html.SAFE_MIME_TYPE_PATTERN_.test(a.type)?goog.fs.url.createObjectUrl(a):goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(a)};goog.html.DATA_URL_PATTERN_=/^data:([^;,]*);base64,[a-z0-9+\/]+=*$/i;
goog.html.SafeUrl.fromDataUrl=function(a){var b=a.match(goog.html.DATA_URL_PATTERN_);b=b&&goog.html.SAFE_MIME_TYPE_PATTERN_.test(b[1]);return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(b?a:goog.html.SafeUrl.INNOCUOUS_STRING)};goog.html.SafeUrl.fromTelUrl=function(a){goog.string.caseInsensitiveStartsWith(a,"tel:")||(a=goog.html.SafeUrl.INNOCUOUS_STRING);return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(a)};goog.html.SafeUrl.fromTrustedResourceUrl=function(a){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.html.TrustedResourceUrl.unwrap(a))};
goog.html.SAFE_URL_PATTERN_=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;goog.html.SafeUrl.sanitize=function(a){if(a instanceof goog.html.SafeUrl)return a;a=a.implementsGoogStringTypedString?a.getTypedStringValue():String(a);goog.html.SAFE_URL_PATTERN_.test(a)||(a=goog.html.SafeUrl.INNOCUOUS_STRING);return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(a)};
goog.html.SafeUrl.sanitizeAssertUnchanged=function(a){if(a instanceof goog.html.SafeUrl)return a;a=a.implementsGoogStringTypedString?a.getTypedStringValue():String(a);goog.asserts.assert(goog.html.SAFE_URL_PATTERN_.test(a))||(a=goog.html.SafeUrl.INNOCUOUS_STRING);return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(a)};goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};
goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse=function(a){var b=new goog.html.SafeUrl;b.privateDoNotAccessOrElseSafeHtmlWrappedValue_=a;return b};goog.html.SafeUrl.ABOUT_BLANK=goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse("about:blank");goog.html.SafeStyle=function(){this.privateDoNotAccessOrElseSafeStyleWrappedValue_="";this.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeStyle.prototype.implementsGoogStringTypedString=!0;goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};
goog.html.SafeStyle.fromConstant=function(a){a=goog.string.Const.unwrap(a);if(0===a.length)return goog.html.SafeStyle.EMPTY;goog.html.SafeStyle.checkStyle_(a);goog.asserts.assert(goog.string.endsWith(a,";"),"Last character of style string is not ';': "+a);goog.asserts.assert(goog.string.contains(a,":"),"Style string must contain at least one ':', to specify a \"name: value\" pair: "+a);return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(a)};
goog.html.SafeStyle.checkStyle_=function(a){goog.asserts.assert(!/[<>]/.test(a),"Forbidden characters in style string: "+a)};goog.html.SafeStyle.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_};goog.DEBUG&&(goog.html.SafeStyle.prototype.toString=function(){return"SafeStyle{"+this.privateDoNotAccessOrElseSafeStyleWrappedValue_+"}"});
goog.html.SafeStyle.unwrap=function(a){if(a instanceof goog.html.SafeStyle&&a.constructor===goog.html.SafeStyle&&a.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return a.privateDoNotAccessOrElseSafeStyleWrappedValue_;goog.asserts.fail("expected object of type SafeStyle, got '"+a+"' of type "+goog.typeOf(a));return"type_error:SafeStyle"};goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse=function(a){return(new goog.html.SafeStyle).initSecurityPrivateDoNotAccessOrElse_(a)};
goog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_=function(a){this.privateDoNotAccessOrElseSafeStyleWrappedValue_=a;return this};goog.html.SafeStyle.EMPTY=goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse("");goog.html.SafeStyle.INNOCUOUS_STRING="zClosurez";
goog.html.SafeStyle.create=function(a){var b="",c;for(c in a){if(!/^[-_a-zA-Z0-9]+$/.test(c))throw Error("Name allows only [-_a-zA-Z0-9], got: "+c);var d=a[c];null!=d&&(d=goog.isArray(d)?goog.array.map(d,goog.html.SafeStyle.sanitizePropertyValue_).join(" "):goog.html.SafeStyle.sanitizePropertyValue_(d),b+=c+":"+d+";")}if(!b)return goog.html.SafeStyle.EMPTY;goog.html.SafeStyle.checkStyle_(b);return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(b)};
goog.html.SafeStyle.sanitizePropertyValue_=function(a){if(a instanceof goog.html.SafeUrl)return'url("'+goog.html.SafeUrl.unwrap(a).replace(/</g,"%3c").replace(/[\\"]/g,"\\$&")+'")';a=a instanceof goog.string.Const?goog.string.Const.unwrap(a):goog.html.SafeStyle.sanitizePropertyValueString_(String(a));goog.asserts.assert(!/[{;}]/.test(a),"Value does not allow [{;}].");return a};
goog.html.SafeStyle.sanitizePropertyValueString_=function(a){var b=a.replace(goog.html.SafeUrl.FUNCTIONS_RE_,"$1").replace(goog.html.SafeUrl.URL_RE_,"url");return goog.html.SafeStyle.VALUE_RE_.test(b)?goog.html.SafeStyle.hasBalancedQuotes_(a)?goog.html.SafeStyle.sanitizeUrl_(a):(goog.asserts.fail("String value requires balanced quotes, got: "+a),goog.html.SafeStyle.INNOCUOUS_STRING):(goog.asserts.fail("String value allows only "+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+" and simple functions, got: "+
a),goog.html.SafeStyle.INNOCUOUS_STRING)};goog.html.SafeStyle.hasBalancedQuotes_=function(a){for(var b=!0,c=!0,d=0;d<a.length;d++){var e=a.charAt(d);"'"==e&&c?b=!b:'"'==e&&b&&(c=!c)}return b&&c};goog.html.SafeStyle.VALUE_ALLOWED_CHARS_="[-,.\"'%_!# a-zA-Z0-9]";goog.html.SafeStyle.VALUE_RE_=new RegExp("^"+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+"+$");goog.html.SafeUrl.URL_RE_=/\b(url\([ \t\n]*)('[ -&(-\[\]-~]*'|"[ !#-\[\]-~]*"|[!#-&*-\[\]-~]*)([ \t\n]*\))/g;goog.html.SafeUrl.FUNCTIONS_RE_=/\b(hsl|hsla|rgb|rgba|(rotate|scale|translate)(X|Y|Z|3d)?)\([-0-9a-z.%, ]+\)/g;
goog.html.SafeStyle.sanitizeUrl_=function(a){return a.replace(goog.html.SafeUrl.URL_RE_,function(a,c,d,e){var b="";d=d.replace(/^(['"])(.*)\1$/,function(a,c,d){b=c;return d});a=goog.html.SafeUrl.sanitize(d).getTypedStringValue();return c+b+a+b+e})};goog.html.SafeStyle.concat=function(a){var b="",c=function(a){goog.isArray(a)?goog.array.forEach(a,c):b+=goog.html.SafeStyle.unwrap(a)};goog.array.forEach(arguments,c);return b?goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(b):goog.html.SafeStyle.EMPTY};goog.html.SafeStyleSheet=function(){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_="";this.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeStyleSheet.prototype.implementsGoogStringTypedString=!0;goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};
goog.html.SafeStyleSheet.createRule=function(a,b){if(goog.string.contains(a,"<"))throw Error("Selector does not allow '<', got: "+a);var c=a.replace(/('|")((?!\1)[^\r\n\f\\]|\\[\s\S])*\1/g,"");if(!/^[-_a-zA-Z0-9#.:* ,>+~[\]()=^$|]+$/.test(c))throw Error("Selector allows only [-_a-zA-Z0-9#.:* ,>+~[\\]()=^$|] and strings, got: "+a);if(!goog.html.SafeStyleSheet.hasBalancedBrackets_(c))throw Error("() and [] in selector must be balanced, got: "+a);b instanceof goog.html.SafeStyle||(b=goog.html.SafeStyle.create(b));
a=a+"{"+goog.html.SafeStyle.unwrap(b)+"}";return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(a)};goog.html.SafeStyleSheet.hasBalancedBrackets_=function(a){for(var b={"(":")","[":"]"},c=[],d=0;d<a.length;d++){var e=a[d];if(b[e])c.push(b[e]);else if(goog.object.contains(b,e)&&c.pop()!=e)return!1}return 0==c.length};
goog.html.SafeStyleSheet.concat=function(a){var b="",c=function(a){goog.isArray(a)?goog.array.forEach(a,c):b+=goog.html.SafeStyleSheet.unwrap(a)};goog.array.forEach(arguments,c);return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(b)};
goog.html.SafeStyleSheet.fromConstant=function(a){a=goog.string.Const.unwrap(a);if(0===a.length)return goog.html.SafeStyleSheet.EMPTY;goog.asserts.assert(!goog.string.contains(a,"<"),"Forbidden '<' character in style sheet string: "+a);return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(a)};goog.html.SafeStyleSheet.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_};
goog.DEBUG&&(goog.html.SafeStyleSheet.prototype.toString=function(){return"SafeStyleSheet{"+this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_+"}"});
goog.html.SafeStyleSheet.unwrap=function(a){if(a instanceof goog.html.SafeStyleSheet&&a.constructor===goog.html.SafeStyleSheet&&a.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return a.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_;goog.asserts.fail("expected object of type SafeStyleSheet, got '"+a+"' of type "+goog.typeOf(a));return"type_error:SafeStyleSheet"};
goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse=function(a){return(new goog.html.SafeStyleSheet).initSecurityPrivateDoNotAccessOrElse_(a)};goog.html.SafeStyleSheet.prototype.initSecurityPrivateDoNotAccessOrElse_=function(a){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_=a;return this};goog.html.SafeStyleSheet.EMPTY=goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse("");goog.html.SafeHtml=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="";this.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;this.dir_=null};goog.html.SafeHtml.prototype.implementsGoogI18nBidiDirectionalString=!0;goog.html.SafeHtml.prototype.getDirection=function(){return this.dir_};goog.html.SafeHtml.prototype.implementsGoogStringTypedString=!0;goog.html.SafeHtml.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_};
goog.DEBUG&&(goog.html.SafeHtml.prototype.toString=function(){return"SafeHtml{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"});
goog.html.SafeHtml.unwrap=function(a){if(a instanceof goog.html.SafeHtml&&a.constructor===goog.html.SafeHtml&&a.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return a.privateDoNotAccessOrElseSafeHtmlWrappedValue_;goog.asserts.fail("expected object of type SafeHtml, got '"+a+"' of type "+goog.typeOf(a));return"type_error:SafeHtml"};
goog.html.SafeHtml.htmlEscape=function(a){if(a instanceof goog.html.SafeHtml)return a;var b=null;a.implementsGoogI18nBidiDirectionalString&&(b=a.getDirection());a=a.implementsGoogStringTypedString?a.getTypedStringValue():String(a);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.htmlEscape(a),b)};
goog.html.SafeHtml.htmlEscapePreservingNewlines=function(a){if(a instanceof goog.html.SafeHtml)return a;a=goog.html.SafeHtml.htmlEscape(a);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.newLineToBr(goog.html.SafeHtml.unwrap(a)),a.getDirection())};
goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces=function(a){if(a instanceof goog.html.SafeHtml)return a;a=goog.html.SafeHtml.htmlEscape(a);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.whitespaceEscape(goog.html.SafeHtml.unwrap(a)),a.getDirection())};goog.html.SafeHtml.from=goog.html.SafeHtml.htmlEscape;goog.html.SafeHtml.VALID_NAMES_IN_TAG_=/^[a-zA-Z0-9-]+$/;
goog.html.SafeHtml.URL_ATTRIBUTES_={action:!0,cite:!0,data:!0,formaction:!0,href:!0,manifest:!0,poster:!0,src:!0};goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_={APPLET:!0,BASE:!0,EMBED:!0,IFRAME:!0,LINK:!0,MATH:!0,META:!0,OBJECT:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0};goog.html.SafeHtml.create=function(a,b,c){goog.html.SafeHtml.verifyTagName(String(a));return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(String(a),b,c)};
goog.html.SafeHtml.verifyTagName=function(a){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(a))throw Error("Invalid tag name <"+a+">.");if(a.toUpperCase()in goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_)throw Error("Tag name <"+a+"> is not allowed for SafeHtml.");};
goog.html.SafeHtml.createIframe=function(a,b,c,d){a&&goog.html.TrustedResourceUrl.unwrap(a);var e={};e.src=a||null;e.srcdoc=b&&goog.html.SafeHtml.unwrap(b);a=goog.html.SafeHtml.combineAttributes(e,{sandbox:""},c);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",a,d)};
goog.html.SafeHtml.createSandboxIframe=function(a,b,c,d){if(!goog.html.SafeHtml.canUseSandboxIframe())throw Error("The browser does not support sandboxed iframes.");var e={};e.src=a?goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(a)):null;e.srcdoc=b||null;e.sandbox="";a=goog.html.SafeHtml.combineAttributes(e,{},c);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",a,d)};
goog.html.SafeHtml.canUseSandboxIframe=function(){return goog.global.HTMLIFrameElement&&"sandbox"in goog.global.HTMLIFrameElement.prototype};goog.html.SafeHtml.createScriptSrc=function(a,b){goog.html.TrustedResourceUrl.unwrap(a);a=goog.html.SafeHtml.combineAttributes({src:a},{},b);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",a)};
goog.html.SafeHtml.createScript=function(a,b){for(var c in b){var d=c.toLowerCase();if("language"==d||"src"==d||"text"==d||"type"==d)throw Error('Cannot set "'+d+'" attribute');}c="";a=goog.array.concat(a);for(d=0;d<a.length;d++)c+=goog.html.SafeScript.unwrap(a[d]);a=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(c,goog.i18n.bidi.Dir.NEUTRAL);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",b,a)};
goog.html.SafeHtml.createStyle=function(a,b){b=goog.html.SafeHtml.combineAttributes({type:"text/css"},{},b);var c="";a=goog.array.concat(a);for(var d=0;d<a.length;d++)c+=goog.html.SafeStyleSheet.unwrap(a[d]);a=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(c,goog.i18n.bidi.Dir.NEUTRAL);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("style",b,a)};
goog.html.SafeHtml.createMetaRefresh=function(a,b){a=goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(a));(goog.labs.userAgent.browser.isIE()||goog.labs.userAgent.browser.isEdge())&&goog.string.contains(a,";")&&(a="'"+a.replace(/'/g,"%27")+"'");return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("meta",{"http-equiv":"refresh",content:(b||0)+"; url="+a})};
goog.html.SafeHtml.getAttrNameAndValue_=function(a,b,c){if(c instanceof goog.string.Const)c=goog.string.Const.unwrap(c);else if("style"==b.toLowerCase())c=goog.html.SafeHtml.getStyleValue_(c);else{if(/^on/i.test(b))throw Error('Attribute "'+b+'" requires goog.string.Const value, "'+c+'" given.');if(b.toLowerCase()in goog.html.SafeHtml.URL_ATTRIBUTES_)if(c instanceof goog.html.TrustedResourceUrl)c=goog.html.TrustedResourceUrl.unwrap(c);else if(c instanceof goog.html.SafeUrl)c=goog.html.SafeUrl.unwrap(c);
else if(goog.isString(c))c=goog.html.SafeUrl.sanitize(c).getTypedStringValue();else throw Error('Attribute "'+b+'" on tag "'+a+'" requires goog.html.SafeUrl, goog.string.Const, or string, value "'+c+'" given.');}c.implementsGoogStringTypedString&&(c=c.getTypedStringValue());goog.asserts.assert(goog.isString(c)||goog.isNumber(c),"String or number value expected, got "+typeof c+" with value: "+c);return b+'="'+goog.string.htmlEscape(String(c))+'"'};
goog.html.SafeHtml.getStyleValue_=function(a){if(!goog.isObject(a))throw Error('The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof a+" given: "+a);a instanceof goog.html.SafeStyle||(a=goog.html.SafeStyle.create(a));return goog.html.SafeStyle.unwrap(a)};goog.html.SafeHtml.createWithDir=function(a,b,c,d){b=goog.html.SafeHtml.create(b,c,d);b.dir_=a;return b};
goog.html.SafeHtml.concat=function(a){var b=goog.i18n.bidi.Dir.NEUTRAL,c="",d=function(a){goog.isArray(a)?goog.array.forEach(a,d):(a=goog.html.SafeHtml.htmlEscape(a),c+=goog.html.SafeHtml.unwrap(a),a=a.getDirection(),b==goog.i18n.bidi.Dir.NEUTRAL?b=a:a!=goog.i18n.bidi.Dir.NEUTRAL&&b!=a&&(b=null))};goog.array.forEach(arguments,d);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(c,b)};
goog.html.SafeHtml.concatWithDir=function(a,b){var c=goog.html.SafeHtml.concat(goog.array.slice(arguments,1));c.dir_=a;return c};goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse=function(a,b){return(new goog.html.SafeHtml).initSecurityPrivateDoNotAccessOrElse_(a,b)};goog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_=function(a,b){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_=a;this.dir_=b;return this};
goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse=function(a,b,c){var d=null;var e="<"+a+goog.html.SafeHtml.stringifyAttributes(a,b);goog.isDefAndNotNull(c)?goog.isArray(c)||(c=[c]):c=[];goog.dom.tags.isVoidTag(a.toLowerCase())?(goog.asserts.assert(!c.length,"Void tag <"+a+"> does not allow content."),e+=">"):(d=goog.html.SafeHtml.concat(c),e+=">"+goog.html.SafeHtml.unwrap(d)+"</"+a+">",d=d.getDirection());(a=b&&b.dir)&&(d=/^(ltr|rtl|auto)$/i.test(a)?goog.i18n.bidi.Dir.NEUTRAL:
null);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(e,d)};goog.html.SafeHtml.stringifyAttributes=function(a,b){var c="";if(b)for(var d in b){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(d))throw Error('Invalid attribute name "'+d+'".');var e=b[d];goog.isDefAndNotNull(e)&&(c+=" "+goog.html.SafeHtml.getAttrNameAndValue_(a,d,e))}return c};
goog.html.SafeHtml.combineAttributes=function(a,b,c){var d={},e;for(e in a)goog.asserts.assert(e.toLowerCase()==e,"Must be lower case"),d[e]=a[e];for(e in b)goog.asserts.assert(e.toLowerCase()==e,"Must be lower case"),d[e]=b[e];for(e in c){var f=e.toLowerCase();if(f in a)throw Error('Cannot override "'+f+'" attribute, got "'+e+'" with value "'+c[e]+'"');f in b&&delete d[f];d[e]=c[e]}return d};
goog.html.SafeHtml.DOCTYPE_HTML=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<!DOCTYPE html>",goog.i18n.bidi.Dir.NEUTRAL);goog.html.SafeHtml.EMPTY=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("",goog.i18n.bidi.Dir.NEUTRAL);goog.html.SafeHtml.BR=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<br>",goog.i18n.bidi.Dir.NEUTRAL);goog.dom.safe={};goog.dom.safe.InsertAdjacentHtmlPosition={AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREBEGIN:"beforebegin",BEFOREEND:"beforeend"};goog.dom.safe.insertAdjacentHtml=function(a,b,c){a.insertAdjacentHTML(b,goog.html.SafeHtml.unwrap(c))};goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_={MATH:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0};
goog.dom.safe.setInnerHtml=function(a,b){if(goog.asserts.ENABLE_ASSERTS){var c=a.tagName.toUpperCase();if(goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_[c])throw Error("goog.dom.safe.setInnerHtml cannot be used to set content of "+a.tagName+".");}a.innerHTML=goog.html.SafeHtml.unwrap(b)};goog.dom.safe.setOuterHtml=function(a,b){a.outerHTML=goog.html.SafeHtml.unwrap(b)};goog.dom.safe.setStyle=function(a,b){a.style.cssText=goog.html.SafeStyle.unwrap(b)};goog.dom.safe.documentWrite=function(a,b){a.write(goog.html.SafeHtml.unwrap(b))};
goog.dom.safe.setAnchorHref=function(a,b){goog.dom.asserts.assertIsHTMLAnchorElement(a);b=b instanceof goog.html.SafeUrl?b:goog.html.SafeUrl.sanitizeAssertUnchanged(b);a.href=goog.html.SafeUrl.unwrap(b)};goog.dom.safe.setImageSrc=function(a,b){goog.dom.asserts.assertIsHTMLImageElement(a);b=b instanceof goog.html.SafeUrl?b:goog.html.SafeUrl.sanitizeAssertUnchanged(b);a.src=goog.html.SafeUrl.unwrap(b)};goog.dom.safe.setEmbedSrc=function(a,b){goog.dom.asserts.assertIsHTMLEmbedElement(a);a.src=goog.html.TrustedResourceUrl.unwrap(b)};
goog.dom.safe.setFrameSrc=function(a,b){goog.dom.asserts.assertIsHTMLFrameElement(a);a.src=goog.html.TrustedResourceUrl.unwrap(b)};goog.dom.safe.setIframeSrc=function(a,b){goog.dom.asserts.assertIsHTMLIFrameElement(a);a.src=goog.html.TrustedResourceUrl.unwrap(b)};goog.dom.safe.setIframeSrcdoc=function(a,b){goog.dom.asserts.assertIsHTMLIFrameElement(a);a.srcdoc=goog.html.SafeHtml.unwrap(b)};
goog.dom.safe.setLinkHrefAndRel=function(a,b,c){goog.dom.asserts.assertIsHTMLLinkElement(a);a.rel=c;goog.string.caseInsensitiveContains(c,"stylesheet")?(goog.asserts.assert(b instanceof goog.html.TrustedResourceUrl,'URL must be TrustedResourceUrl because "rel" contains "stylesheet"'),a.href=goog.html.TrustedResourceUrl.unwrap(b)):a.href=b instanceof goog.html.TrustedResourceUrl?goog.html.TrustedResourceUrl.unwrap(b):b instanceof goog.html.SafeUrl?goog.html.SafeUrl.unwrap(b):goog.html.SafeUrl.sanitizeAssertUnchanged(b).getTypedStringValue()};
goog.dom.safe.setObjectData=function(a,b){goog.dom.asserts.assertIsHTMLObjectElement(a);a.data=goog.html.TrustedResourceUrl.unwrap(b)};goog.dom.safe.setScriptSrc=function(a,b){goog.dom.asserts.assertIsHTMLScriptElement(a);a.src=goog.html.TrustedResourceUrl.unwrap(b)};goog.dom.safe.setScriptContent=function(a,b){goog.dom.asserts.assertIsHTMLScriptElement(a);a.text=goog.html.SafeScript.unwrap(b)};
goog.dom.safe.setLocationHref=function(a,b){goog.dom.asserts.assertIsLocation(a);b=b instanceof goog.html.SafeUrl?b:goog.html.SafeUrl.sanitizeAssertUnchanged(b);a.href=goog.html.SafeUrl.unwrap(b)};goog.dom.safe.openInWindow=function(a,b,c,d,e){a=a instanceof goog.html.SafeUrl?a:goog.html.SafeUrl.sanitizeAssertUnchanged(a);return(b||window).open(goog.html.SafeUrl.unwrap(a),c?goog.string.Const.unwrap(c):"",d,e)};goog.html.uncheckedconversions={};goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract=function(a,b,c){goog.asserts.assertString(goog.string.Const.unwrap(a),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(a)),"must provide non-empty justification");return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(b,c||null)};
goog.html.uncheckedconversions.safeScriptFromStringKnownToSatisfyTypeContract=function(a,b){goog.asserts.assertString(goog.string.Const.unwrap(a),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(a)),"must provide non-empty justification");return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(b)};
goog.html.uncheckedconversions.safeStyleFromStringKnownToSatisfyTypeContract=function(a,b){goog.asserts.assertString(goog.string.Const.unwrap(a),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(a)),"must provide non-empty justification");return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(b)};
goog.html.uncheckedconversions.safeStyleSheetFromStringKnownToSatisfyTypeContract=function(a,b){goog.asserts.assertString(goog.string.Const.unwrap(a),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(a)),"must provide non-empty justification");return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(b)};
goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract=function(a,b){goog.asserts.assertString(goog.string.Const.unwrap(a),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(a)),"must provide non-empty justification");return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(b)};
goog.html.uncheckedconversions.trustedResourceUrlFromStringKnownToSatisfyTypeContract=function(a,b){goog.asserts.assertString(goog.string.Const.unwrap(a),"must provide justification");goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(a)),"must provide non-empty justification");return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(b)};goog.math.Coordinate=function(a,b){this.x=goog.isDef(a)?a:0;this.y=goog.isDef(b)?b:0};goog.math.Coordinate.prototype.clone=function(){return new goog.math.Coordinate(this.x,this.y)};goog.DEBUG&&(goog.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"});goog.math.Coordinate.prototype.equals=function(a){return a instanceof goog.math.Coordinate&&goog.math.Coordinate.equals(this,a)};goog.math.Coordinate.equals=function(a,b){return a==b?!0:a&&b?a.x==b.x&&a.y==b.y:!1};
goog.math.Coordinate.distance=function(a,b){var c=a.x-b.x;a=a.y-b.y;return Math.sqrt(c*c+a*a)};goog.math.Coordinate.magnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)};goog.math.Coordinate.azimuth=function(a){return goog.math.angle(0,0,a.x,a.y)};goog.math.Coordinate.squaredDistance=function(a,b){var c=a.x-b.x;a=a.y-b.y;return c*c+a*a};goog.math.Coordinate.difference=function(a,b){return new goog.math.Coordinate(a.x-b.x,a.y-b.y)};
goog.math.Coordinate.sum=function(a,b){return new goog.math.Coordinate(a.x+b.x,a.y+b.y)};goog.math.Coordinate.prototype.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};goog.math.Coordinate.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};goog.math.Coordinate.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};
goog.math.Coordinate.prototype.translate=function(a,b){a instanceof goog.math.Coordinate?(this.x+=a.x,this.y+=a.y):(this.x+=Number(a),goog.isNumber(b)&&(this.y+=b));return this};goog.math.Coordinate.prototype.scale=function(a,b){b=goog.isNumber(b)?b:a;this.x*=a;this.y*=b;return this};goog.math.Coordinate.prototype.rotateRadians=function(a,b){b=b||new goog.math.Coordinate(0,0);var c=this.x,d=this.y,e=Math.cos(a);a=Math.sin(a);this.x=(c-b.x)*e-(d-b.y)*a+b.x;this.y=(c-b.x)*a+(d-b.y)*e+b.y};
goog.math.Coordinate.prototype.rotateDegrees=function(a,b){this.rotateRadians(goog.math.toRadians(a),b)};goog.math.Size=function(a,b){this.width=a;this.height=b};goog.math.Size.equals=function(a,b){return a==b?!0:a&&b?a.width==b.width&&a.height==b.height:!1};goog.math.Size.prototype.clone=function(){return new goog.math.Size(this.width,this.height)};goog.DEBUG&&(goog.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"});goog.math.Size.prototype.getLongest=function(){return Math.max(this.width,this.height)};
goog.math.Size.prototype.getShortest=function(){return Math.min(this.width,this.height)};goog.math.Size.prototype.area=function(){return this.width*this.height};goog.math.Size.prototype.perimeter=function(){return 2*(this.width+this.height)};goog.math.Size.prototype.aspectRatio=function(){return this.width/this.height};goog.math.Size.prototype.isEmpty=function(){return!this.area()};goog.math.Size.prototype.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};
goog.math.Size.prototype.fitsInside=function(a){return this.width<=a.width&&this.height<=a.height};goog.math.Size.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};goog.math.Size.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Size.prototype.scale=function(a,b){b=goog.isNumber(b)?b:a;this.width*=a;this.height*=b;return this};
goog.math.Size.prototype.scaleToCover=function(a){a=this.aspectRatio()<=a.aspectRatio()?a.width/this.width:a.height/this.height;return this.scale(a)};goog.math.Size.prototype.scaleToFit=function(a){a=this.aspectRatio()>a.aspectRatio()?a.width/this.width:a.height/this.height;return this.scale(a)};goog.dom.ASSUME_QUIRKS_MODE=!1;goog.dom.ASSUME_STANDARDS_MODE=!1;goog.dom.COMPAT_MODE_KNOWN_=goog.dom.ASSUME_QUIRKS_MODE||goog.dom.ASSUME_STANDARDS_MODE;goog.dom.getDomHelper=function(a){return a?new goog.dom.DomHelper(goog.dom.getOwnerDocument(a)):goog.dom.defaultDomHelper_||(goog.dom.defaultDomHelper_=new goog.dom.DomHelper)};goog.dom.getDocument=function(){return document};goog.dom.getElement=function(a){return goog.dom.getElementHelper_(document,a)};
goog.dom.getElementHelper_=function(a,b){return goog.isString(b)?a.getElementById(b):b};goog.dom.getRequiredElement=function(a){return goog.dom.getRequiredElementHelper_(document,a)};goog.dom.getRequiredElementHelper_=function(a,b){goog.asserts.assertString(b);a=goog.dom.getElementHelper_(a,b);return a=goog.asserts.assertElement(a,"No element found with id: "+b)};goog.dom.$=goog.dom.getElement;goog.dom.getElementsByTagName=function(a,b){return(b||document).getElementsByTagName(String(a))};
goog.dom.getElementsByTagNameAndClass=function(a,b,c){return goog.dom.getElementsByTagNameAndClass_(document,a,b,c)};goog.dom.getElementByTagNameAndClass=function(a,b,c){return goog.dom.getElementByTagNameAndClass_(document,a,b,c)};goog.dom.getElementsByClass=function(a,b){var c=b||document;return goog.dom.canUseQuerySelector_(c)?c.querySelectorAll("."+a):goog.dom.getElementsByTagNameAndClass_(document,"*",a,b)};
goog.dom.getElementByClass=function(a,b){var c=b||document;return(c.getElementsByClassName?c.getElementsByClassName(a)[0]:goog.dom.getElementByTagNameAndClass_(document,"*",a,b))||null};goog.dom.getRequiredElementByClass=function(a,b){b=goog.dom.getElementByClass(a,b);return goog.asserts.assert(b,"No element found with className: "+a)};goog.dom.canUseQuerySelector_=function(a){return!(!a.querySelectorAll||!a.querySelector)};
goog.dom.getElementsByTagNameAndClass_=function(a,b,c,d){a=d||a;var e=b&&"*"!=b?String(b).toUpperCase():"";if(goog.dom.canUseQuerySelector_(a)&&(e||c))return a.querySelectorAll(e+(c?"."+c:""));if(c&&a.getElementsByClassName){d=a.getElementsByClassName(c);if(e){a={};for(var f=b=0,g;g=d[f];f++)e==g.nodeName&&(a[b++]=g);a.length=b;return a}return d}d=a.getElementsByTagName(e||"*");if(c){a={};for(f=b=0;g=d[f];f++)e=g.className,"function"==typeof e.split&&goog.array.contains(e.split(/\s+/),c)&&(a[b++]=
g);a.length=b;return a}return d};goog.dom.getElementByTagNameAndClass_=function(a,b,c,d){var e=d||a,f=b&&"*"!=b?String(b).toUpperCase():"";return goog.dom.canUseQuerySelector_(e)&&(f||c)?e.querySelector(f+(c?"."+c:"")):goog.dom.getElementsByTagNameAndClass_(a,b,c,d)[0]||null};goog.dom.$$=goog.dom.getElementsByTagNameAndClass;
goog.dom.setProperties=function(a,b){goog.object.forEach(b,function(b,d){b&&b.implementsGoogStringTypedString&&(b=b.getTypedStringValue());"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:goog.dom.DIRECT_ATTRIBUTE_MAP_.hasOwnProperty(d)?a.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[d],b):goog.string.startsWith(d,"aria-")||goog.string.startsWith(d,"data-")?a.setAttribute(d,b):a[d]=b})};
goog.dom.DIRECT_ATTRIBUTE_MAP_={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};goog.dom.getViewportSize=function(a){return goog.dom.getViewportSize_(a||window)};goog.dom.getViewportSize_=function(a){a=a.document;a=goog.dom.isCss1CompatMode_(a)?a.documentElement:a.body;return new goog.math.Size(a.clientWidth,a.clientHeight)};
goog.dom.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(window)};goog.dom.getDocumentHeightForWindow=function(a){return goog.dom.getDocumentHeight_(a)};
goog.dom.getDocumentHeight_=function(a){var b=a.document,c=0;if(b){c=b.body;var d=b.documentElement;if(!d||!c)return 0;a=goog.dom.getViewportSize_(a).height;if(goog.dom.isCss1CompatMode_(b)&&d.scrollHeight)c=d.scrollHeight!=a?d.scrollHeight:d.offsetHeight;else{b=d.scrollHeight;var e=d.offsetHeight;d.clientHeight!=e&&(b=c.scrollHeight,e=c.offsetHeight);c=b>a?b>e?b:e:b<e?b:e}}return c};goog.dom.getPageScroll=function(a){return goog.dom.getDomHelper((a||goog.global||window).document).getDocumentScroll()};
goog.dom.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(document)};goog.dom.getDocumentScroll_=function(a){var b=goog.dom.getDocumentScrollElement_(a);a=goog.dom.getWindow_(a);return goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("10")&&a.pageYOffset!=b.scrollTop?new goog.math.Coordinate(b.scrollLeft,b.scrollTop):new goog.math.Coordinate(a.pageXOffset||b.scrollLeft,a.pageYOffset||b.scrollTop)};goog.dom.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(document)};
goog.dom.getDocumentScrollElement_=function(a){return a.scrollingElement?a.scrollingElement:!goog.userAgent.WEBKIT&&goog.dom.isCss1CompatMode_(a)?a.documentElement:a.body||a.documentElement};goog.dom.getWindow=function(a){return a?goog.dom.getWindow_(a):window};goog.dom.getWindow_=function(a){return a.parentWindow||a.defaultView};goog.dom.createDom=function(a,b,c){return goog.dom.createDom_(document,arguments)};
goog.dom.createDom_=function(a,b){var c=String(b[0]),d=b[1];if(!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',goog.string.htmlEscape(d.name),'"');if(d.type){c.push(' type="',goog.string.htmlEscape(d.type),'"');var e={};goog.object.extend(e,d);delete e.type;d=e}c.push(">");c=c.join("")}c=a.createElement(c);d&&(goog.isString(d)?c.className=d:goog.isArray(d)?c.className=d.join(" "):goog.dom.setProperties(c,d));2<b.length&&goog.dom.append_(a,
c,b,2);return c};goog.dom.append_=function(a,b,c,d){function e(c){c&&b.appendChild(goog.isString(c)?a.createTextNode(c):c)}for(;d<c.length;d++){var f=c[d];goog.isArrayLike(f)&&!goog.dom.isNodeLike(f)?goog.array.forEach(goog.dom.isNodeList(f)?goog.array.toArray(f):f,e):e(f)}};goog.dom.$dom=goog.dom.createDom;goog.dom.createElement=function(a){return goog.dom.createElement_(document,a)};goog.dom.createElement_=function(a,b){return a.createElement(String(b))};goog.dom.createTextNode=function(a){return document.createTextNode(String(a))};
goog.dom.createTable=function(a,b,c){return goog.dom.createTable_(document,a,b,!!c)};goog.dom.createTable_=function(a,b,c,d){for(var e=goog.dom.createElement_(a,"TABLE"),f=e.appendChild(goog.dom.createElement_(a,"TBODY")),g=0;g<b;g++){for(var h=goog.dom.createElement_(a,"TR"),k=0;k<c;k++){var l=goog.dom.createElement_(a,"TD");d&&goog.dom.setTextContent(l,goog.string.Unicode.NBSP);h.appendChild(l)}f.appendChild(h)}return e};
goog.dom.constHtmlToNode=function(a){var b=goog.array.map(arguments,goog.string.Const.unwrap);b=goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Constant HTML string, that gets turned into a Node later, so it will be automatically balanced."),b.join(""));return goog.dom.safeHtmlToNode(b)};goog.dom.safeHtmlToNode=function(a){return goog.dom.safeHtmlToNode_(document,a)};
goog.dom.safeHtmlToNode_=function(a,b){var c=goog.dom.createElement_(a,"DIV");goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT?(goog.dom.safe.setInnerHtml(c,goog.html.SafeHtml.concat(goog.html.SafeHtml.BR,b)),c.removeChild(c.firstChild)):goog.dom.safe.setInnerHtml(c,b);return goog.dom.childrenToNode_(a,c)};goog.dom.childrenToNode_=function(a,b){if(1==b.childNodes.length)return b.removeChild(b.firstChild);for(a=a.createDocumentFragment();b.firstChild;)a.appendChild(b.firstChild);return a};
goog.dom.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(document)};goog.dom.isCss1CompatMode_=function(a){return goog.dom.COMPAT_MODE_KNOWN_?goog.dom.ASSUME_STANDARDS_MODE:"CSS1Compat"==a.compatMode};goog.dom.canHaveChildren=function(a){if(a.nodeType!=goog.dom.NodeType.ELEMENT)return!1;switch(a.tagName){case "APPLET":case "AREA":case "BASE":case "BR":case "COL":case "COMMAND":case "EMBED":case "FRAME":case "HR":case "IMG":case "INPUT":case "IFRAME":case "ISINDEX":case "KEYGEN":case "LINK":case "NOFRAMES":case "NOSCRIPT":case "META":case "OBJECT":case "PARAM":case "SCRIPT":case "SOURCE":case "STYLE":case "TRACK":case "WBR":return!1}return!0};
goog.dom.appendChild=function(a,b){a.appendChild(b)};goog.dom.append=function(a,b){goog.dom.append_(goog.dom.getOwnerDocument(a),a,arguments,1)};goog.dom.removeChildren=function(a){for(var b;b=a.firstChild;)a.removeChild(b)};goog.dom.insertSiblingBefore=function(a,b){b.parentNode&&b.parentNode.insertBefore(a,b)};goog.dom.insertSiblingAfter=function(a,b){b.parentNode&&b.parentNode.insertBefore(a,b.nextSibling)};goog.dom.insertChildAt=function(a,b,c){a.insertBefore(b,a.childNodes[c]||null)};
goog.dom.removeNode=function(a){return a&&a.parentNode?a.parentNode.removeChild(a):null};goog.dom.replaceNode=function(a,b){var c=b.parentNode;c&&c.replaceChild(a,b)};goog.dom.flattenElement=function(a){var b,c=a.parentNode;if(c&&c.nodeType!=goog.dom.NodeType.DOCUMENT_FRAGMENT){if(a.removeNode)return a.removeNode(!1);for(;b=a.firstChild;)c.insertBefore(b,a);return goog.dom.removeNode(a)}};
goog.dom.getChildren=function(a){return goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE&&void 0!=a.children?a.children:goog.array.filter(a.childNodes,function(a){return a.nodeType==goog.dom.NodeType.ELEMENT})};goog.dom.getFirstElementChild=function(a){return goog.isDef(a.firstElementChild)?a.firstElementChild:goog.dom.getNextElementNode_(a.firstChild,!0)};goog.dom.getLastElementChild=function(a){return goog.isDef(a.lastElementChild)?a.lastElementChild:goog.dom.getNextElementNode_(a.lastChild,!1)};
goog.dom.getNextElementSibling=function(a){return goog.isDef(a.nextElementSibling)?a.nextElementSibling:goog.dom.getNextElementNode_(a.nextSibling,!0)};goog.dom.getPreviousElementSibling=function(a){return goog.isDef(a.previousElementSibling)?a.previousElementSibling:goog.dom.getNextElementNode_(a.previousSibling,!1)};goog.dom.getNextElementNode_=function(a,b){for(;a&&a.nodeType!=goog.dom.NodeType.ELEMENT;)a=b?a.nextSibling:a.previousSibling;return a};
goog.dom.getNextNode=function(a){if(!a)return null;if(a.firstChild)return a.firstChild;for(;a&&!a.nextSibling;)a=a.parentNode;return a?a.nextSibling:null};goog.dom.getPreviousNode=function(a){if(!a)return null;if(!a.previousSibling)return a.parentNode;for(a=a.previousSibling;a&&a.lastChild;)a=a.lastChild;return a};goog.dom.isNodeLike=function(a){return goog.isObject(a)&&0<a.nodeType};goog.dom.isElement=function(a){return goog.isObject(a)&&a.nodeType==goog.dom.NodeType.ELEMENT};
goog.dom.isWindow=function(a){return goog.isObject(a)&&a.window==a};goog.dom.getParentElement=function(a){var b;if(goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY&&!(goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("9")&&!goog.userAgent.isVersionOrHigher("10")&&goog.global.SVGElement&&a instanceof goog.global.SVGElement)&&(b=a.parentElement))return b;b=a.parentNode;return goog.dom.isElement(b)?b:null};
goog.dom.contains=function(a,b){if(!a||!b)return!1;if(a.contains&&b.nodeType==goog.dom.NodeType.ELEMENT)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||!!(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};
goog.dom.compareNodeOrder=function(a,b){if(a==b)return 0;if(a.compareDocumentPosition)return a.compareDocumentPosition(b)&2?1:-1;if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){if(a.nodeType==goog.dom.NodeType.DOCUMENT)return-1;if(b.nodeType==goog.dom.NodeType.DOCUMENT)return 1}if("sourceIndex"in a||a.parentNode&&"sourceIndex"in a.parentNode){var c=a.nodeType==goog.dom.NodeType.ELEMENT,d=b.nodeType==goog.dom.NodeType.ELEMENT;if(c&&d)return a.sourceIndex-b.sourceIndex;var e=a.parentNode,
f=b.parentNode;return e==f?goog.dom.compareSiblingOrder_(a,b):!c&&goog.dom.contains(e,b)?-1*goog.dom.compareParentsDescendantNodeIe_(a,b):!d&&goog.dom.contains(f,a)?goog.dom.compareParentsDescendantNodeIe_(b,a):(c?a.sourceIndex:e.sourceIndex)-(d?b.sourceIndex:f.sourceIndex)}d=goog.dom.getOwnerDocument(a);c=d.createRange();c.selectNode(a);c.collapse(!0);a=d.createRange();a.selectNode(b);a.collapse(!0);return c.compareBoundaryPoints(goog.global.Range.START_TO_END,a)};
goog.dom.compareParentsDescendantNodeIe_=function(a,b){var c=a.parentNode;if(c==b)return-1;for(;b.parentNode!=c;)b=b.parentNode;return goog.dom.compareSiblingOrder_(b,a)};goog.dom.compareSiblingOrder_=function(a,b){for(;b=b.previousSibling;)if(b==a)return-1;return 1};
goog.dom.findCommonAncestor=function(a){var b,c=arguments.length;if(!c)return null;if(1==c)return arguments[0];var d=[],e=Infinity;for(b=0;b<c;b++){for(var f=[],g=arguments[b];g;)f.unshift(g),g=g.parentNode;d.push(f);e=Math.min(e,f.length)}f=null;for(b=0;b<e;b++){g=d[0][b];for(var h=1;h<c;h++)if(g!=d[h][b])return f;f=g}return f};goog.dom.getOwnerDocument=function(a){goog.asserts.assert(a,"Node cannot be null or undefined.");return a.nodeType==goog.dom.NodeType.DOCUMENT?a:a.ownerDocument||a.document};
goog.dom.getFrameContentDocument=function(a){return a.contentDocument||a.contentWindow.document};goog.dom.getFrameContentWindow=function(a){try{return a.contentWindow||(a.contentDocument?goog.dom.getWindow(a.contentDocument):null)}catch(b){}return null};
goog.dom.setTextContent=function(a,b){goog.asserts.assert(null!=a,"goog.dom.setTextContent expects a non-null value for node");if("textContent"in a)a.textContent=b;else if(a.nodeType==goog.dom.NodeType.TEXT)a.data=String(b);else if(a.firstChild&&a.firstChild.nodeType==goog.dom.NodeType.TEXT){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=String(b)}else{goog.dom.removeChildren(a);var c=goog.dom.getOwnerDocument(a);a.appendChild(c.createTextNode(String(b)))}};
goog.dom.getOuterHtml=function(a){goog.asserts.assert(null!==a,"goog.dom.getOuterHtml expects a non-null value for element");if("outerHTML"in a)return a.outerHTML;var b=goog.dom.getOwnerDocument(a);b=goog.dom.createElement_(b,"DIV");b.appendChild(a.cloneNode(!0));return b.innerHTML};goog.dom.findNode=function(a,b){var c=[];return goog.dom.findNodes_(a,b,c,!0)?c[0]:void 0};goog.dom.findNodes=function(a,b){var c=[];goog.dom.findNodes_(a,b,c,!1);return c};
goog.dom.findNodes_=function(a,b,c,d){if(null!=a)for(a=a.firstChild;a;){if(b(a)&&(c.push(a),d)||goog.dom.findNodes_(a,b,c,d))return!0;a=a.nextSibling}return!1};goog.dom.TAGS_TO_IGNORE_={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1};goog.dom.PREDEFINED_TAG_VALUES_={IMG:" ",BR:"\n"};goog.dom.isFocusableTabIndex=function(a){return goog.dom.hasSpecifiedTabIndex_(a)&&goog.dom.isTabIndexFocusable_(a)};goog.dom.setFocusableTabIndex=function(a,b){b?a.tabIndex=0:(a.tabIndex=-1,a.removeAttribute("tabIndex"))};
goog.dom.isFocusable=function(a){var b;return(b=goog.dom.nativelySupportsFocus_(a)?!a.disabled&&(!goog.dom.hasSpecifiedTabIndex_(a)||goog.dom.isTabIndexFocusable_(a)):goog.dom.isFocusableTabIndex(a))&&goog.userAgent.IE?goog.dom.hasNonZeroBoundingRect_(a):b};goog.dom.hasSpecifiedTabIndex_=function(a){return goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9")?(a=a.getAttributeNode("tabindex"),goog.isDefAndNotNull(a)&&a.specified):a.hasAttribute("tabindex")};
goog.dom.isTabIndexFocusable_=function(a){a=a.tabIndex;return goog.isNumber(a)&&0<=a&&32768>a};goog.dom.nativelySupportsFocus_=function(a){return"A"==a.tagName||"INPUT"==a.tagName||"TEXTAREA"==a.tagName||"SELECT"==a.tagName||"BUTTON"==a.tagName};goog.dom.hasNonZeroBoundingRect_=function(a){a=!goog.isFunction(a.getBoundingClientRect)||goog.userAgent.IE&&null==a.parentElement?{height:a.offsetHeight,width:a.offsetWidth}:a.getBoundingClientRect();return goog.isDefAndNotNull(a)&&0<a.height&&0<a.width};
goog.dom.getTextContent=function(a){if(goog.dom.BrowserFeature.CAN_USE_INNER_TEXT&&null!==a&&"innerText"in a)a=goog.string.canonicalizeNewlines(a.innerText);else{var b=[];goog.dom.getTextContent_(a,b,!0);a=b.join("")}a=a.replace(/ \xAD /g," ").replace(/\xAD/g,"");a=a.replace(/\u200B/g,"");goog.dom.BrowserFeature.CAN_USE_INNER_TEXT||(a=a.replace(/ +/g," "));" "!=a&&(a=a.replace(/^\s*/,""));return a};goog.dom.getRawTextContent=function(a){var b=[];goog.dom.getTextContent_(a,b,!1);return b.join("")};
goog.dom.getTextContent_=function(a,b,c){if(!(a.nodeName in goog.dom.TAGS_TO_IGNORE_))if(a.nodeType==goog.dom.NodeType.TEXT)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)b.push(goog.dom.PREDEFINED_TAG_VALUES_[a.nodeName]);else for(a=a.firstChild;a;)goog.dom.getTextContent_(a,b,c),a=a.nextSibling};goog.dom.getNodeTextLength=function(a){return goog.dom.getTextContent(a).length};
goog.dom.getNodeTextOffset=function(a,b){b=b||goog.dom.getOwnerDocument(a).body;for(var c=[];a&&a!=b;){for(var d=a;d=d.previousSibling;)c.unshift(goog.dom.getTextContent(d));a=a.parentNode}return goog.string.trimLeft(c.join("")).replace(/ +/g," ").length};
goog.dom.getNodeAtOffset=function(a,b,c){a=[a];for(var d=0,e=null;0<a.length&&d<b;)if(e=a.pop(),!(e.nodeName in goog.dom.TAGS_TO_IGNORE_))if(e.nodeType==goog.dom.NodeType.TEXT){var f=e.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," ");d+=f.length}else if(e.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)d+=goog.dom.PREDEFINED_TAG_VALUES_[e.nodeName].length;else for(f=e.childNodes.length-1;0<=f;f--)a.push(e.childNodes[f]);goog.isObject(c)&&(c.remainder=e?e.nodeValue.length+b-d-1:0,c.node=e);return e};
goog.dom.isNodeList=function(a){if(a&&"number"==typeof a.length){if(goog.isObject(a))return"function"==typeof a.item||"string"==typeof a.item;if(goog.isFunction(a))return"function"==typeof a.item}return!1};goog.dom.getAncestorByTagNameAndClass=function(a,b,c,d){if(!b&&!c)return null;var e=b?String(b).toUpperCase():null;return goog.dom.getAncestor(a,function(a){return(!e||a.nodeName==e)&&(!c||goog.isString(a.className)&&goog.array.contains(a.className.split(/\s+/),c))},!0,d)};
goog.dom.getAncestorByClass=function(a,b,c){return goog.dom.getAncestorByTagNameAndClass(a,null,b,c)};goog.dom.getAncestor=function(a,b,c,d){a&&!c&&(a=a.parentNode);for(c=0;a&&(null==d||c<=d);){goog.asserts.assert("parentNode"!=a.name);if(b(a))return a;a=a.parentNode;c++}return null};goog.dom.getActiveElement=function(a){try{return a&&a.activeElement}catch(b){}return null};
goog.dom.getPixelRatio=function(){var a=goog.dom.getWindow();return goog.isDef(a.devicePixelRatio)?a.devicePixelRatio:a.matchMedia?goog.dom.matchesPixelRatio_(3)||goog.dom.matchesPixelRatio_(2)||goog.dom.matchesPixelRatio_(1.5)||goog.dom.matchesPixelRatio_(1)||.75:1};goog.dom.matchesPixelRatio_=function(a){return goog.dom.getWindow().matchMedia("(min-resolution: "+a+"dppx),(min--moz-device-pixel-ratio: "+a+"),(min-resolution: "+96*a+"dpi)").matches?a:0};goog.dom.getCanvasContext2D=function(a){return a.getContext("2d")};
goog.dom.DomHelper=function(a){this.document_=a||goog.global.document||document};goog.dom.DomHelper.prototype.getDomHelper=goog.dom.getDomHelper;goog.dom.DomHelper.prototype.setDocument=function(a){this.document_=a};goog.dom.DomHelper.prototype.getDocument=function(){return this.document_};goog.dom.DomHelper.prototype.getElement=function(a){return goog.dom.getElementHelper_(this.document_,a)};
goog.dom.DomHelper.prototype.getRequiredElement=function(a){return goog.dom.getRequiredElementHelper_(this.document_,a)};goog.dom.DomHelper.prototype.$=goog.dom.DomHelper.prototype.getElement;goog.dom.DomHelper.prototype.getElementsByTagName=function(a,b){return(b||this.document_).getElementsByTagName(String(a))};goog.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(a,b,c){return goog.dom.getElementsByTagNameAndClass_(this.document_,a,b,c)};
goog.dom.DomHelper.prototype.getElementByTagNameAndClass=function(a,b,c){return goog.dom.getElementByTagNameAndClass_(this.document_,a,b,c)};goog.dom.DomHelper.prototype.getElementsByClass=function(a,b){return goog.dom.getElementsByClass(a,b||this.document_)};goog.dom.DomHelper.prototype.getElementByClass=function(a,b){return goog.dom.getElementByClass(a,b||this.document_)};goog.dom.DomHelper.prototype.getRequiredElementByClass=function(a,b){return goog.dom.getRequiredElementByClass(a,b||this.document_)};
goog.dom.DomHelper.prototype.$$=goog.dom.DomHelper.prototype.getElementsByTagNameAndClass;goog.dom.DomHelper.prototype.setProperties=goog.dom.setProperties;goog.dom.DomHelper.prototype.getViewportSize=function(a){return goog.dom.getViewportSize(a||this.getWindow())};goog.dom.DomHelper.prototype.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(this.getWindow())};goog.dom.DomHelper.prototype.createDom=function(a,b,c){return goog.dom.createDom_(this.document_,arguments)};
goog.dom.DomHelper.prototype.$dom=goog.dom.DomHelper.prototype.createDom;goog.dom.DomHelper.prototype.createElement=function(a){return goog.dom.createElement_(this.document_,a)};goog.dom.DomHelper.prototype.createTextNode=function(a){return this.document_.createTextNode(String(a))};goog.dom.DomHelper.prototype.createTable=function(a,b,c){return goog.dom.createTable_(this.document_,a,b,!!c)};goog.dom.DomHelper.prototype.safeHtmlToNode=function(a){return goog.dom.safeHtmlToNode_(this.document_,a)};
goog.dom.DomHelper.prototype.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(this.document_)};goog.dom.DomHelper.prototype.getWindow=function(){return goog.dom.getWindow_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(this.document_)};
goog.dom.DomHelper.prototype.getActiveElement=function(a){return goog.dom.getActiveElement(a||this.document_)};goog.dom.DomHelper.prototype.appendChild=goog.dom.appendChild;goog.dom.DomHelper.prototype.append=goog.dom.append;goog.dom.DomHelper.prototype.canHaveChildren=goog.dom.canHaveChildren;goog.dom.DomHelper.prototype.removeChildren=goog.dom.removeChildren;goog.dom.DomHelper.prototype.insertSiblingBefore=goog.dom.insertSiblingBefore;goog.dom.DomHelper.prototype.insertSiblingAfter=goog.dom.insertSiblingAfter;
goog.dom.DomHelper.prototype.insertChildAt=goog.dom.insertChildAt;goog.dom.DomHelper.prototype.removeNode=goog.dom.removeNode;goog.dom.DomHelper.prototype.replaceNode=goog.dom.replaceNode;goog.dom.DomHelper.prototype.flattenElement=goog.dom.flattenElement;goog.dom.DomHelper.prototype.getChildren=goog.dom.getChildren;goog.dom.DomHelper.prototype.getFirstElementChild=goog.dom.getFirstElementChild;goog.dom.DomHelper.prototype.getLastElementChild=goog.dom.getLastElementChild;
goog.dom.DomHelper.prototype.getNextElementSibling=goog.dom.getNextElementSibling;goog.dom.DomHelper.prototype.getPreviousElementSibling=goog.dom.getPreviousElementSibling;goog.dom.DomHelper.prototype.getNextNode=goog.dom.getNextNode;goog.dom.DomHelper.prototype.getPreviousNode=goog.dom.getPreviousNode;goog.dom.DomHelper.prototype.isNodeLike=goog.dom.isNodeLike;goog.dom.DomHelper.prototype.isElement=goog.dom.isElement;goog.dom.DomHelper.prototype.isWindow=goog.dom.isWindow;
goog.dom.DomHelper.prototype.getParentElement=goog.dom.getParentElement;goog.dom.DomHelper.prototype.contains=goog.dom.contains;goog.dom.DomHelper.prototype.compareNodeOrder=goog.dom.compareNodeOrder;goog.dom.DomHelper.prototype.findCommonAncestor=goog.dom.findCommonAncestor;goog.dom.DomHelper.prototype.getOwnerDocument=goog.dom.getOwnerDocument;goog.dom.DomHelper.prototype.getFrameContentDocument=goog.dom.getFrameContentDocument;goog.dom.DomHelper.prototype.getFrameContentWindow=goog.dom.getFrameContentWindow;
goog.dom.DomHelper.prototype.setTextContent=goog.dom.setTextContent;goog.dom.DomHelper.prototype.getOuterHtml=goog.dom.getOuterHtml;goog.dom.DomHelper.prototype.findNode=goog.dom.findNode;goog.dom.DomHelper.prototype.findNodes=goog.dom.findNodes;goog.dom.DomHelper.prototype.isFocusableTabIndex=goog.dom.isFocusableTabIndex;goog.dom.DomHelper.prototype.setFocusableTabIndex=goog.dom.setFocusableTabIndex;goog.dom.DomHelper.prototype.isFocusable=goog.dom.isFocusable;
goog.dom.DomHelper.prototype.getTextContent=goog.dom.getTextContent;goog.dom.DomHelper.prototype.getNodeTextLength=goog.dom.getNodeTextLength;goog.dom.DomHelper.prototype.getNodeTextOffset=goog.dom.getNodeTextOffset;goog.dom.DomHelper.prototype.getNodeAtOffset=goog.dom.getNodeAtOffset;goog.dom.DomHelper.prototype.isNodeList=goog.dom.isNodeList;goog.dom.DomHelper.prototype.getAncestorByTagNameAndClass=goog.dom.getAncestorByTagNameAndClass;goog.dom.DomHelper.prototype.getAncestorByClass=goog.dom.getAncestorByClass;
goog.dom.DomHelper.prototype.getAncestor=goog.dom.getAncestor;goog.dom.DomHelper.prototype.getCanvasContext2D=goog.dom.getCanvasContext2D;goog.dom.classlist={};goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST=!1;goog.dom.classlist.get=function(a){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||a.classList)return a.classList;a=a.className;return goog.isString(a)&&a.match(/\S+/g)||[]};goog.dom.classlist.set=function(a,b){a.className=b};goog.dom.classlist.contains=function(a,b){return goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||a.classList?a.classList.contains(b):goog.array.contains(goog.dom.classlist.get(a),b)};
goog.dom.classlist.add=function(a,b){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||a.classList?a.classList.add(b):goog.dom.classlist.contains(a,b)||(a.className+=0<a.className.length?" "+b:b)};
goog.dom.classlist.addAll=function(a,b){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||a.classList)goog.array.forEach(b,function(b){goog.dom.classlist.add(a,b)});else{var c={};goog.array.forEach(goog.dom.classlist.get(a),function(a){c[a]=!0});goog.array.forEach(b,function(a){c[a]=!0});a.className="";for(var d in c)a.className+=0<a.className.length?" "+d:d}};
goog.dom.classlist.remove=function(a,b){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||a.classList?a.classList.remove(b):goog.dom.classlist.contains(a,b)&&(a.className=goog.array.filter(goog.dom.classlist.get(a),function(a){return a!=b}).join(" "))};
goog.dom.classlist.removeAll=function(a,b){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||a.classList?goog.array.forEach(b,function(b){goog.dom.classlist.remove(a,b)}):a.className=goog.array.filter(goog.dom.classlist.get(a),function(a){return!goog.array.contains(b,a)}).join(" ")};goog.dom.classlist.enable=function(a,b,c){c?goog.dom.classlist.add(a,b):goog.dom.classlist.remove(a,b)};goog.dom.classlist.enableAll=function(a,b,c){(c?goog.dom.classlist.addAll:goog.dom.classlist.removeAll)(a,b)};
goog.dom.classlist.swap=function(a,b,c){return goog.dom.classlist.contains(a,b)?(goog.dom.classlist.remove(a,b),goog.dom.classlist.add(a,c),!0):!1};goog.dom.classlist.toggle=function(a,b){var c=!goog.dom.classlist.contains(a,b);goog.dom.classlist.enable(a,b,c);return c};goog.dom.classlist.addRemove=function(a,b,c){goog.dom.classlist.remove(a,b);goog.dom.classlist.add(a,c)};goog.events.EventHandler=function(a){goog.Disposable.call(this);this.handler_=a;this.keys_={}};goog.inherits(goog.events.EventHandler,goog.Disposable);goog.events.EventHandler.typeArray_=[];goog.events.EventHandler.prototype.listen=function(a,b,c,d){return this.listen_(a,b,c,d)};goog.events.EventHandler.prototype.listenWithScope=function(a,b,c,d,e){return this.listen_(a,b,c,d,e)};
goog.events.EventHandler.prototype.listen_=function(a,b,c,d,e){goog.isArray(b)||(b&&(goog.events.EventHandler.typeArray_[0]=b.toString()),b=goog.events.EventHandler.typeArray_);for(var f=0;f<b.length;f++){var g=goog.events.listen(a,b[f],c||this.handleEvent,d||!1,e||this.handler_||this);if(!g)break;this.keys_[g.key]=g}return this};goog.events.EventHandler.prototype.listenOnce=function(a,b,c,d){return this.listenOnce_(a,b,c,d)};
goog.events.EventHandler.prototype.listenOnceWithScope=function(a,b,c,d,e){return this.listenOnce_(a,b,c,d,e)};goog.events.EventHandler.prototype.listenOnce_=function(a,b,c,d,e){if(goog.isArray(b))for(var f=0;f<b.length;f++)this.listenOnce_(a,b[f],c,d,e);else{a=goog.events.listenOnce(a,b,c||this.handleEvent,d,e||this.handler_||this);if(!a)return this;this.keys_[a.key]=a}return this};goog.events.EventHandler.prototype.listenWithWrapper=function(a,b,c,d){return this.listenWithWrapper_(a,b,c,d)};
goog.events.EventHandler.prototype.listenWithWrapperAndScope=function(a,b,c,d,e){return this.listenWithWrapper_(a,b,c,d,e)};goog.events.EventHandler.prototype.listenWithWrapper_=function(a,b,c,d,e){b.listen(a,c,d,e||this.handler_||this,this);return this};goog.events.EventHandler.prototype.getListenerCount=function(){var a=0,b;for(b in this.keys_)Object.prototype.hasOwnProperty.call(this.keys_,b)&&a++;return a};
goog.events.EventHandler.prototype.unlisten=function(a,b,c,d,e){if(goog.isArray(b))for(var f=0;f<b.length;f++)this.unlisten(a,b[f],c,d,e);else if(d=goog.isObject(d)?!!d.capture:!!d,a=goog.events.getListener(a,b,c||this.handleEvent,d,e||this.handler_||this))goog.events.unlistenByKey(a),delete this.keys_[a.key];return this};goog.events.EventHandler.prototype.unlistenWithWrapper=function(a,b,c,d,e){b.unlisten(a,c,d,e||this.handler_||this,this);return this};
goog.events.EventHandler.prototype.removeAll=function(){goog.object.forEach(this.keys_,function(a,b){this.keys_.hasOwnProperty(b)&&goog.events.unlistenByKey(a)},this);this.keys_={}};goog.events.EventHandler.prototype.disposeInternal=function(){goog.events.EventHandler.superClass_.disposeInternal.call(this);this.removeAll()};goog.events.EventHandler.prototype.handleEvent=function(a){throw Error("EventHandler.handleEvent not implemented");};goog.events.EventTarget=function(){goog.Disposable.call(this);this.eventTargetListeners_=new goog.events.ListenerMap(this);this.actualEventTarget_=this;this.parentEventTarget_=null};goog.inherits(goog.events.EventTarget,goog.Disposable);goog.events.Listenable.addImplementation(goog.events.EventTarget);goog.events.EventTarget.MAX_ANCESTORS_=1E3;goog.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_};
goog.events.EventTarget.prototype.setParentEventTarget=function(a){this.parentEventTarget_=a};goog.events.EventTarget.prototype.addEventListener=function(a,b,c,d){goog.events.listen(this,a,b,c,d)};goog.events.EventTarget.prototype.removeEventListener=function(a,b,c,d){goog.events.unlisten(this,a,b,c,d)};
goog.events.EventTarget.prototype.dispatchEvent=function(a){this.assertInitialized_();var b=this.getParentEventTarget();if(b){var c=[];for(var d=1;b;b=b.getParentEventTarget())c.push(b),goog.asserts.assert(++d<goog.events.EventTarget.MAX_ANCESTORS_,"infinite loop")}return goog.events.EventTarget.dispatchEventInternal_(this.actualEventTarget_,a,c)};
goog.events.EventTarget.prototype.disposeInternal=function(){goog.events.EventTarget.superClass_.disposeInternal.call(this);this.removeAllListeners();this.parentEventTarget_=null};goog.events.EventTarget.prototype.listen=function(a,b,c,d){this.assertInitialized_();return this.eventTargetListeners_.add(String(a),b,!1,c,d)};goog.events.EventTarget.prototype.listenOnce=function(a,b,c,d){return this.eventTargetListeners_.add(String(a),b,!0,c,d)};
goog.events.EventTarget.prototype.unlisten=function(a,b,c,d){return this.eventTargetListeners_.remove(String(a),b,c,d)};goog.events.EventTarget.prototype.unlistenByKey=function(a){return this.eventTargetListeners_.removeByKey(a)};goog.events.EventTarget.prototype.removeAllListeners=function(a){return this.eventTargetListeners_?this.eventTargetListeners_.removeAll(a):0};
goog.events.EventTarget.prototype.fireListeners=function(a,b,c){a=this.eventTargetListeners_.listeners[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.removed&&f.capture==b){var g=f.listener,h=f.handler||f.src;f.callOnce&&this.unlistenByKey(f);d=!1!==g.call(h,c)&&d}}return d&&0!=c.returnValue_};goog.events.EventTarget.prototype.getListeners=function(a,b){return this.eventTargetListeners_.getListeners(String(a),b)};
goog.events.EventTarget.prototype.getListener=function(a,b,c,d){return this.eventTargetListeners_.getListener(String(a),b,c,d)};goog.events.EventTarget.prototype.hasListener=function(a,b){a=goog.isDef(a)?String(a):void 0;return this.eventTargetListeners_.hasListener(a,b)};goog.events.EventTarget.prototype.setTargetForTesting=function(a){this.actualEventTarget_=a};goog.events.EventTarget.prototype.assertInitialized_=function(){goog.asserts.assert(this.eventTargetListeners_,"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?")};
goog.events.EventTarget.dispatchEventInternal_=function(a,b,c){var d=b.type||b;if(goog.isString(b))b=new goog.events.Event(b,a);else if(b instanceof goog.events.Event)b.target=b.target||a;else{var e=b;b=new goog.events.Event(d,a);goog.object.extend(b,e)}e=!0;if(c)for(var f=c.length-1;!b.propagationStopped_&&0<=f;f--){var g=b.currentTarget=c[f];e=g.fireListeners(d,!0,b)&&e}b.propagationStopped_||(g=b.currentTarget=a,e=g.fireListeners(d,!0,b)&&e,b.propagationStopped_||(e=g.fireListeners(d,!1,b)&&e));
if(c)for(f=0;!b.propagationStopped_&&f<c.length;f++)g=b.currentTarget=c[f],e=g.fireListeners(d,!1,b)&&e;return e};goog.math.Box=function(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d};goog.math.Box.boundingBox=function(a){for(var b=new goog.math.Box(arguments[0].y,arguments[0].x,arguments[0].y,arguments[0].x),c=1;c<arguments.length;c++)b.expandToIncludeCoordinate(arguments[c]);return b};goog.math.Box.prototype.getWidth=function(){return this.right-this.left};goog.math.Box.prototype.getHeight=function(){return this.bottom-this.top};
goog.math.Box.prototype.clone=function(){return new goog.math.Box(this.top,this.right,this.bottom,this.left)};goog.DEBUG&&(goog.math.Box.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"});goog.math.Box.prototype.contains=function(a){return goog.math.Box.contains(this,a)};
goog.math.Box.prototype.expand=function(a,b,c,d){goog.isObject(a)?(this.top-=a.top,this.right+=a.right,this.bottom+=a.bottom,this.left-=a.left):(this.top-=a,this.right+=Number(b),this.bottom+=Number(c),this.left-=Number(d));return this};goog.math.Box.prototype.expandToInclude=function(a){this.left=Math.min(this.left,a.left);this.top=Math.min(this.top,a.top);this.right=Math.max(this.right,a.right);this.bottom=Math.max(this.bottom,a.bottom)};
goog.math.Box.prototype.expandToIncludeCoordinate=function(a){this.top=Math.min(this.top,a.y);this.right=Math.max(this.right,a.x);this.bottom=Math.max(this.bottom,a.y);this.left=Math.min(this.left,a.x)};goog.math.Box.equals=function(a,b){return a==b?!0:a&&b?a.top==b.top&&a.right==b.right&&a.bottom==b.bottom&&a.left==b.left:!1};
goog.math.Box.contains=function(a,b){return a&&b?b instanceof goog.math.Box?b.left>=a.left&&b.right<=a.right&&b.top>=a.top&&b.bottom<=a.bottom:b.x>=a.left&&b.x<=a.right&&b.y>=a.top&&b.y<=a.bottom:!1};goog.math.Box.relativePositionX=function(a,b){return b.x<a.left?b.x-a.left:b.x>a.right?b.x-a.right:0};goog.math.Box.relativePositionY=function(a,b){return b.y<a.top?b.y-a.top:b.y>a.bottom?b.y-a.bottom:0};
goog.math.Box.distance=function(a,b){var c=goog.math.Box.relativePositionX(a,b);a=goog.math.Box.relativePositionY(a,b);return Math.sqrt(c*c+a*a)};goog.math.Box.intersects=function(a,b){return a.left<=b.right&&b.left<=a.right&&a.top<=b.bottom&&b.top<=a.bottom};goog.math.Box.intersectsWithPadding=function(a,b,c){return a.left<=b.right+c&&b.left<=a.right+c&&a.top<=b.bottom+c&&b.top<=a.bottom+c};
goog.math.Box.prototype.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};goog.math.Box.prototype.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};
goog.math.Box.prototype.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};goog.math.Box.prototype.translate=function(a,b){a instanceof goog.math.Coordinate?(this.left+=a.x,this.right+=a.x,this.top+=a.y,this.bottom+=a.y):(goog.asserts.assertNumber(a),this.left+=a,this.right+=a,goog.isNumber(b)&&(this.top+=b,this.bottom+=b));return this};
goog.math.Box.prototype.scale=function(a,b){b=goog.isNumber(b)?b:a;this.left*=a;this.right*=a;this.top*=b;this.bottom*=b;return this};goog.math.IRect=function(){};goog.math.Rect=function(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d};goog.math.Rect.prototype.clone=function(){return new goog.math.Rect(this.left,this.top,this.width,this.height)};goog.math.Rect.prototype.toBox=function(){return new goog.math.Box(this.top,this.left+this.width,this.top+this.height,this.left)};goog.math.Rect.createFromPositionAndSize=function(a,b){return new goog.math.Rect(a.x,a.y,b.width,b.height)};
goog.math.Rect.createFromBox=function(a){return new goog.math.Rect(a.left,a.top,a.right-a.left,a.bottom-a.top)};goog.DEBUG&&(goog.math.Rect.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"});goog.math.Rect.equals=function(a,b){return a==b?!0:a&&b?a.left==b.left&&a.width==b.width&&a.top==b.top&&a.height==b.height:!1};
goog.math.Rect.prototype.intersection=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top);a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,!0}return!1};
goog.math.Rect.intersection=function(a,b){var c=Math.max(a.left,b.left),d=Math.min(a.left+a.width,b.left+b.width);if(c<=d){var e=Math.max(a.top,b.top);a=Math.min(a.top+a.height,b.top+b.height);if(e<=a)return new goog.math.Rect(c,e,d-c,a-e)}return null};goog.math.Rect.intersects=function(a,b){return a.left<=b.left+b.width&&b.left<=a.left+a.width&&a.top<=b.top+b.height&&b.top<=a.top+a.height};goog.math.Rect.prototype.intersects=function(a){return goog.math.Rect.intersects(this,a)};
goog.math.Rect.difference=function(a,b){var c=goog.math.Rect.intersection(a,b);if(!c||!c.height||!c.width)return[a.clone()];c=[];var d=a.top,e=a.height,f=a.left+a.width,g=a.top+a.height,h=b.left+b.width,k=b.top+b.height;b.top>a.top&&(c.push(new goog.math.Rect(a.left,a.top,a.width,b.top-a.top)),d=b.top,e-=b.top-a.top);k<g&&(c.push(new goog.math.Rect(a.left,k,a.width,g-k)),e=k-d);b.left>a.left&&c.push(new goog.math.Rect(a.left,d,b.left-a.left,e));h<f&&c.push(new goog.math.Rect(h,d,f-h,e));return c};
goog.math.Rect.prototype.difference=function(a){return goog.math.Rect.difference(this,a)};goog.math.Rect.prototype.boundingRect=function(a){var b=Math.max(this.left+this.width,a.left+a.width),c=Math.max(this.top+this.height,a.top+a.height);this.left=Math.min(this.left,a.left);this.top=Math.min(this.top,a.top);this.width=b-this.left;this.height=c-this.top};goog.math.Rect.boundingRect=function(a,b){if(!a||!b)return null;a=new goog.math.Rect(a.left,a.top,a.width,a.height);a.boundingRect(b);return a};
goog.math.Rect.prototype.contains=function(a){return a instanceof goog.math.Coordinate?a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height:this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height};goog.math.Rect.prototype.squaredDistance=function(a){var b=a.x<this.left?this.left-a.x:Math.max(a.x-(this.left+this.width),0);a=a.y<this.top?this.top-a.y:Math.max(a.y-(this.top+this.height),0);return b*b+a*a};
goog.math.Rect.prototype.distance=function(a){return Math.sqrt(this.squaredDistance(a))};goog.math.Rect.prototype.getSize=function(){return new goog.math.Size(this.width,this.height)};goog.math.Rect.prototype.getTopLeft=function(){return new goog.math.Coordinate(this.left,this.top)};goog.math.Rect.prototype.getCenter=function(){return new goog.math.Coordinate(this.left+this.width/2,this.top+this.height/2)};
goog.math.Rect.prototype.getBottomRight=function(){return new goog.math.Coordinate(this.left+this.width,this.top+this.height)};goog.math.Rect.prototype.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};goog.math.Rect.prototype.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
goog.math.Rect.prototype.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Rect.prototype.translate=function(a,b){a instanceof goog.math.Coordinate?(this.left+=a.x,this.top+=a.y):(this.left+=goog.asserts.assertNumber(a),goog.isNumber(b)&&(this.top+=b));return this};
goog.math.Rect.prototype.scale=function(a,b){b=goog.isNumber(b)?b:a;this.left*=a;this.width*=a;this.top*=b;this.height*=b;return this};goog.dom.vendor={};goog.dom.vendor.getVendorJsPrefix=function(){return goog.userAgent.WEBKIT?"Webkit":goog.userAgent.GECKO?"Moz":goog.userAgent.IE?"ms":goog.userAgent.OPERA?"O":null};goog.dom.vendor.getVendorPrefix=function(){return goog.userAgent.WEBKIT?"-webkit":goog.userAgent.GECKO?"-moz":goog.userAgent.IE?"-ms":goog.userAgent.OPERA?"-o":null};
goog.dom.vendor.getPrefixedPropertyName=function(a,b){if(b&&a in b)return a;var c=goog.dom.vendor.getVendorJsPrefix();return c?(c=c.toLowerCase(),a=c+goog.string.toTitleCase(a),!goog.isDef(b)||a in b?a:null):null};goog.dom.vendor.getPrefixedEventType=function(a){return((goog.dom.vendor.getVendorJsPrefix()||"")+a).toLowerCase()};goog.html.legacyconversions={};goog.html.legacyconversions.safeHtmlFromString=function(a){goog.html.legacyconversions.reportCallback_();return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(a,null)};goog.html.legacyconversions.safeScriptFromString=function(a){goog.html.legacyconversions.reportCallback_();return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(a)};
goog.html.legacyconversions.safeStyleFromString=function(a){goog.html.legacyconversions.reportCallback_();return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(a)};goog.html.legacyconversions.safeStyleSheetFromString=function(a){goog.html.legacyconversions.reportCallback_();return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(a)};goog.html.legacyconversions.safeUrlFromString=function(a){goog.html.legacyconversions.reportCallback_();return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(a)};
goog.html.legacyconversions.trustedResourceUrlFromString=function(a){goog.html.legacyconversions.reportCallback_();return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(a)};goog.html.legacyconversions.reportCallback_=goog.nullFunction;goog.html.legacyconversions.setReportCallback=function(a){goog.html.legacyconversions.reportCallback_=a};goog.style={};goog.style.setStyle=function(a,b,c){if(goog.isString(b))goog.style.setStyle_(a,c,b);else for(var d in b)goog.style.setStyle_(a,b[d],d)};goog.style.setStyle_=function(a,b,c){(c=goog.style.getVendorJsStyleName_(a,c))&&(a.style[c]=b)};goog.style.styleNameCache_={};
goog.style.getVendorJsStyleName_=function(a,b){var c=goog.style.styleNameCache_[b];if(!c){var d=goog.string.toCamelCase(b);c=d;void 0===a.style[d]&&(d=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(d),void 0!==a.style[d]&&(c=d));goog.style.styleNameCache_[b]=c}return c};
goog.style.getVendorStyleName_=function(a,b){var c=goog.string.toCamelCase(b);return void 0===a.style[c]&&(c=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(c),void 0!==a.style[c])?goog.dom.vendor.getVendorPrefix()+"-"+b:b};goog.style.getStyle=function(a,b){var c=a.style[goog.string.toCamelCase(b)];return"undefined"!==typeof c?c:a.style[goog.style.getVendorJsStyleName_(a,b)]||""};
goog.style.getComputedStyle=function(a,b){var c=goog.dom.getOwnerDocument(a);return c.defaultView&&c.defaultView.getComputedStyle&&(a=c.defaultView.getComputedStyle(a,null))?a[b]||a.getPropertyValue(b)||"":""};goog.style.getCascadedStyle=function(a,b){return a.currentStyle?a.currentStyle[b]:null};goog.style.getStyle_=function(a,b){return goog.style.getComputedStyle(a,b)||goog.style.getCascadedStyle(a,b)||a.style&&a.style[b]};
goog.style.getComputedBoxSizing=function(a){return goog.style.getStyle_(a,"boxSizing")||goog.style.getStyle_(a,"MozBoxSizing")||goog.style.getStyle_(a,"WebkitBoxSizing")||null};goog.style.getComputedPosition=function(a){return goog.style.getStyle_(a,"position")};goog.style.getBackgroundColor=function(a){return goog.style.getStyle_(a,"backgroundColor")};goog.style.getComputedOverflowX=function(a){return goog.style.getStyle_(a,"overflowX")};
goog.style.getComputedOverflowY=function(a){return goog.style.getStyle_(a,"overflowY")};goog.style.getComputedZIndex=function(a){return goog.style.getStyle_(a,"zIndex")};goog.style.getComputedTextAlign=function(a){return goog.style.getStyle_(a,"textAlign")};goog.style.getComputedCursor=function(a){return goog.style.getStyle_(a,"cursor")};goog.style.getComputedTransform=function(a){var b=goog.style.getVendorStyleName_(a,"transform");return goog.style.getStyle_(a,b)||goog.style.getStyle_(a,"transform")};
goog.style.setPosition=function(a,b,c){if(b instanceof goog.math.Coordinate){var d=b.x;b=b.y}else d=b,b=c;a.style.left=goog.style.getPixelStyleValue_(d,!1);a.style.top=goog.style.getPixelStyleValue_(b,!1)};goog.style.getPosition=function(a){return new goog.math.Coordinate(a.offsetLeft,a.offsetTop)};
goog.style.getClientViewportElement=function(a){a=a?goog.dom.getOwnerDocument(a):goog.dom.getDocument();return!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9)||goog.dom.getDomHelper(a).isCss1CompatMode()?a.documentElement:a.body};goog.style.getViewportPageOffset=function(a){var b=a.body;a=a.documentElement;return new goog.math.Coordinate(b.scrollLeft||a.scrollLeft,b.scrollTop||a.scrollTop)};
goog.style.getBoundingClientRect_=function(a){try{var b=a.getBoundingClientRect()}catch(c){return{left:0,top:0,right:0,bottom:0}}goog.userAgent.IE&&a.ownerDocument.body&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b};
goog.style.getOffsetParent=function(a){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(8))return goog.asserts.assert(a&&"offsetParent"in a),a.offsetParent;var b=goog.dom.getOwnerDocument(a),c=goog.style.getStyle_(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(a.nodeType==goog.dom.NodeType.DOCUMENT_FRAGMENT&&a.host&&(a=a.host),c=goog.style.getStyle_(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||
a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return null};
goog.style.getVisibleRectForElement=function(a){for(var b=new goog.math.Box(0,Infinity,Infinity,0),c=goog.dom.getDomHelper(a),d=c.getDocument().body,e=c.getDocument().documentElement,f=c.getDocumentScrollElement();a=goog.style.getOffsetParent(a);)if(!(goog.userAgent.IE&&0==a.clientWidth||goog.userAgent.WEBKIT&&0==a.clientHeight&&a==d)&&a!=d&&a!=e&&"visible"!=goog.style.getStyle_(a,"overflow")){var g=goog.style.getPageOffset(a),h=goog.style.getClientLeftTop(a);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,
g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.getViewportSize();b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:null};
goog.style.getContainerOffsetToScrollInto=function(a,b,c){var d=b||goog.dom.getDocumentScrollElement();var e=goog.style.getPageOffset(a);var f=goog.style.getPageOffset(d),g=goog.style.getBorderBox(d);d==goog.dom.getDocumentScrollElement()?(b=e.x-d.scrollLeft,e=e.y-d.scrollTop,goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(10)&&(b+=g.left,e+=g.top)):(b=e.x-f.x-g.left,e=e.y-f.y-g.top);g=goog.style.getSizeWithDisplay_(a);a=d.clientWidth-g.width;g=d.clientHeight-g.height;f=d.scrollLeft;d=d.scrollTop;
c?(f+=b-a/2,d+=e-g/2):(f+=Math.min(b,Math.max(b-a,0)),d+=Math.min(e,Math.max(e-g,0)));return new goog.math.Coordinate(f,d)};goog.style.scrollIntoContainerView=function(a,b,c){b=b||goog.dom.getDocumentScrollElement();a=goog.style.getContainerOffsetToScrollInto(a,b,c);b.scrollLeft=a.x;b.scrollTop=a.y};goog.style.getClientLeftTop=function(a){return new goog.math.Coordinate(a.clientLeft,a.clientTop)};
goog.style.getPageOffset=function(a){var b=goog.dom.getOwnerDocument(a);goog.asserts.assertObject(a,"Parameter is required");var c=new goog.math.Coordinate(0,0),d=goog.style.getClientViewportElement(b);if(a==d)return c;a=goog.style.getBoundingClientRect_(a);b=goog.dom.getDomHelper(b).getDocumentScroll();c.x=a.left+b.x;c.y=a.top+b.y;return c};goog.style.getPageOffsetLeft=function(a){return goog.style.getPageOffset(a).x};goog.style.getPageOffsetTop=function(a){return goog.style.getPageOffset(a).y};
goog.style.getFramedPageOffset=function(a,b){var c=new goog.math.Coordinate(0,0),d=goog.dom.getWindow(goog.dom.getOwnerDocument(a));if(!goog.reflect.canAccessProperty(d,"parent"))return c;do{var e=d==b?goog.style.getPageOffset(a):goog.style.getClientPositionForElement_(goog.asserts.assert(a));c.x+=e.x;c.y+=e.y}while(d&&d!=b&&d!=d.parent&&(a=d.frameElement)&&(d=d.parent));return c};
goog.style.translateRectForAnotherFrame=function(a,b,c){if(b.getDocument()!=c.getDocument()){var d=b.getDocument().body;c=goog.style.getFramedPageOffset(d,c.getWindow());c=goog.math.Coordinate.difference(c,goog.style.getPageOffset(d));!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9)||b.isCss1CompatMode()||(c=goog.math.Coordinate.difference(c,b.getDocumentScroll()));a.left+=c.x;a.top+=c.y}};
goog.style.getRelativePosition=function(a,b){a=goog.style.getClientPosition(a);b=goog.style.getClientPosition(b);return new goog.math.Coordinate(a.x-b.x,a.y-b.y)};goog.style.getClientPositionForElement_=function(a){a=goog.style.getBoundingClientRect_(a);return new goog.math.Coordinate(a.left,a.top)};
goog.style.getClientPosition=function(a){goog.asserts.assert(a);if(a.nodeType==goog.dom.NodeType.ELEMENT)return goog.style.getClientPositionForElement_(a);a=a.changedTouches?a.changedTouches[0]:a;return new goog.math.Coordinate(a.clientX,a.clientY)};goog.style.setPageOffset=function(a,b,c){var d=goog.style.getPageOffset(a);b instanceof goog.math.Coordinate&&(c=b.y,b=b.x);b=goog.asserts.assertNumber(b)-d.x;goog.style.setPosition(a,a.offsetLeft+b,a.offsetTop+(Number(c)-d.y))};
goog.style.setSize=function(a,b,c){if(b instanceof goog.math.Size)c=b.height,b=b.width;else if(void 0==c)throw Error("missing height argument");goog.style.setWidth(a,b);goog.style.setHeight(a,c)};goog.style.getPixelStyleValue_=function(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a};goog.style.setHeight=function(a,b){a.style.height=goog.style.getPixelStyleValue_(b,!0)};goog.style.setWidth=function(a,b){a.style.width=goog.style.getPixelStyleValue_(b,!0)};
goog.style.getSize=function(a){return goog.style.evaluateWithTemporaryDisplay_(goog.style.getSizeWithDisplay_,a)};goog.style.evaluateWithTemporaryDisplay_=function(a,b){if("none"!=goog.style.getStyle_(b,"display"))return a(b);var c=b.style,d=c.display,e=c.visibility,f=c.position;c.visibility="hidden";c.position="absolute";c.display="inline";a=a(b);c.display=d;c.position=f;c.visibility=e;return a};
goog.style.getSizeWithDisplay_=function(a){var b=a.offsetWidth,c=a.offsetHeight,d=goog.userAgent.WEBKIT&&!b&&!c;return goog.isDef(b)&&!d||!a.getBoundingClientRect?new goog.math.Size(b,c):(a=goog.style.getBoundingClientRect_(a),new goog.math.Size(a.right-a.left,a.bottom-a.top))};goog.style.getTransformedSize=function(a){if(!a.getBoundingClientRect)return null;a=goog.style.evaluateWithTemporaryDisplay_(goog.style.getBoundingClientRect_,a);return new goog.math.Size(a.right-a.left,a.bottom-a.top)};
goog.style.getBounds=function(a){var b=goog.style.getPageOffset(a);a=goog.style.getSize(a);return new goog.math.Rect(b.x,b.y,a.width,a.height)};goog.style.toCamelCase=function(a){return goog.string.toCamelCase(String(a))};goog.style.toSelectorCase=function(a){return goog.string.toSelectorCase(a)};
goog.style.getOpacity=function(a){goog.asserts.assert(a);var b=a.style;a="";"opacity"in b?a=b.opacity:"MozOpacity"in b?a=b.MozOpacity:"filter"in b&&(b=b.filter.match(/alpha\(opacity=([\d.]+)\)/))&&(a=String(b[1]/100));return""==a?a:Number(a)};goog.style.setOpacity=function(a,b){goog.asserts.assert(a);a=a.style;"opacity"in a?a.opacity=b:"MozOpacity"in a?a.MozOpacity=b:"filter"in a&&(a.filter=""===b?"":"alpha(opacity="+100*Number(b)+")")};
goog.style.setTransparentBackgroundImage=function(a,b){a=a.style;goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?a.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+b+'", sizingMethod="crop")':(a.backgroundImage="url("+b+")",a.backgroundPosition="top left",a.backgroundRepeat="no-repeat")};goog.style.clearTransparentBackgroundImage=function(a){a=a.style;"filter"in a?a.filter="":a.backgroundImage="none"};goog.style.showElement=function(a,b){goog.style.setElementShown(a,b)};
goog.style.setElementShown=function(a,b){a.style.display=b?"":"none"};goog.style.isElementShown=function(a){return"none"!=a.style.display};goog.style.installStyles=function(a,b){return goog.style.installSafeStyleSheet(goog.html.legacyconversions.safeStyleSheetFromString(a),b)};
goog.style.installSafeStyleSheet=function(a,b){b=goog.dom.getDomHelper(b);var c=b.getDocument();if(goog.userAgent.IE&&c.createStyleSheet){var d=c.createStyleSheet();goog.style.setSafeStyleSheet(d,a)}else c=b.getElementsByTagNameAndClass("HEAD")[0],c||(d=b.getElementsByTagNameAndClass("BODY")[0],c=b.createDom("HEAD"),d.parentNode.insertBefore(c,d)),d=b.createDom("STYLE"),goog.style.setSafeStyleSheet(d,a),b.appendChild(c,d);return d};
goog.style.uninstallStyles=function(a){goog.dom.removeNode(a.ownerNode||a.owningElement||a)};goog.style.setStyles=function(a,b){goog.style.setSafeStyleSheet(a,goog.html.legacyconversions.safeStyleSheetFromString(b))};goog.style.setSafeStyleSheet=function(a,b){b=goog.html.SafeStyleSheet.unwrap(b);goog.userAgent.IE&&goog.isDef(a.cssText)?a.cssText=b:a.innerHTML=b};
goog.style.setPreWrap=function(a){a=a.style;goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?(a.whiteSpace="pre",a.wordWrap="break-word"):a.whiteSpace=goog.userAgent.GECKO?"-moz-pre-wrap":"pre-wrap"};goog.style.setInlineBlock=function(a){a=a.style;a.position="relative";goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?(a.zoom="1",a.display="inline"):a.display="inline-block"};goog.style.isRightToLeft=function(a){return"rtl"==goog.style.getStyle_(a,"direction")};
goog.style.unselectableStyle_=goog.userAgent.GECKO?"MozUserSelect":goog.userAgent.WEBKIT||goog.userAgent.EDGE?"WebkitUserSelect":null;goog.style.isUnselectable=function(a){return goog.style.unselectableStyle_?"none"==a.style[goog.style.unselectableStyle_].toLowerCase():goog.userAgent.IE||goog.userAgent.OPERA?"on"==a.getAttribute("unselectable"):!1};
goog.style.setUnselectable=function(a,b,c){c=c?null:a.getElementsByTagName("*");var d=goog.style.unselectableStyle_;if(d){if(b=b?"none":"",a.style&&(a.style[d]=b),c){a=0;for(var e;e=c[a];a++)e.style&&(e.style[d]=b)}}else if(goog.userAgent.IE||goog.userAgent.OPERA)if(b=b?"on":"",a.setAttribute("unselectable",b),c)for(a=0;e=c[a];a++)e.setAttribute("unselectable",b)};goog.style.getBorderBoxSize=function(a){return new goog.math.Size(a.offsetWidth,a.offsetHeight)};
goog.style.setBorderBoxSize=function(a,b){var c=goog.dom.getOwnerDocument(a),d=goog.dom.getDomHelper(c).isCss1CompatMode();!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10")||d&&goog.userAgent.isVersionOrHigher("8")?goog.style.setBoxSizingSize_(a,b,"border-box"):(c=a.style,d?(d=goog.style.getPaddingBox(a),a=goog.style.getBorderBox(a),c.pixelWidth=b.width-a.left-d.left-d.right-a.right,c.pixelHeight=b.height-a.top-d.top-d.bottom-a.bottom):(c.pixelWidth=b.width,c.pixelHeight=b.height))};
goog.style.getContentBoxSize=function(a){var b=goog.dom.getOwnerDocument(a),c=goog.userAgent.IE&&a.currentStyle;if(c&&goog.dom.getDomHelper(b).isCss1CompatMode()&&"auto"!=c.width&&"auto"!=c.height&&!c.boxSizing)return b=goog.style.getIePixelValue_(a,c.width,"width","pixelWidth"),a=goog.style.getIePixelValue_(a,c.height,"height","pixelHeight"),new goog.math.Size(b,a);c=goog.style.getBorderBoxSize(a);b=goog.style.getPaddingBox(a);a=goog.style.getBorderBox(a);return new goog.math.Size(c.width-a.left-
b.left-b.right-a.right,c.height-a.top-b.top-b.bottom-a.bottom)};
goog.style.setContentBoxSize=function(a,b){var c=goog.dom.getOwnerDocument(a),d=goog.dom.getDomHelper(c).isCss1CompatMode();!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10")||d&&goog.userAgent.isVersionOrHigher("8")?goog.style.setBoxSizingSize_(a,b,"content-box"):(c=a.style,d?(c.pixelWidth=b.width,c.pixelHeight=b.height):(d=goog.style.getPaddingBox(a),a=goog.style.getBorderBox(a),c.pixelWidth=b.width+a.left+d.left+d.right+a.right,c.pixelHeight=b.height+a.top+d.top+d.bottom+a.bottom))};
goog.style.setBoxSizingSize_=function(a,b,c){a=a.style;goog.userAgent.GECKO?a.MozBoxSizing=c:goog.userAgent.WEBKIT?a.WebkitBoxSizing=c:a.boxSizing=c;a.width=Math.max(b.width,0)+"px";a.height=Math.max(b.height,0)+"px"};goog.style.getIePixelValue_=function(a,b,c,d){if(/^\d+px?$/.test(b))return parseInt(b,10);var e=a.style[c],f=a.runtimeStyle[c];a.runtimeStyle[c]=a.currentStyle[c];a.style[c]=b;b=a.style[d];a.style[c]=e;a.runtimeStyle[c]=f;return+b};
goog.style.getIePixelDistance_=function(a,b){return(b=goog.style.getCascadedStyle(a,b))?goog.style.getIePixelValue_(a,b,"left","pixelLeft"):0};
goog.style.getBox_=function(a,b){if(goog.userAgent.IE){var c=goog.style.getIePixelDistance_(a,b+"Left");var d=goog.style.getIePixelDistance_(a,b+"Right");var e=goog.style.getIePixelDistance_(a,b+"Top");a=goog.style.getIePixelDistance_(a,b+"Bottom");return new goog.math.Box(e,d,a,c)}c=goog.style.getComputedStyle(a,b+"Left");d=goog.style.getComputedStyle(a,b+"Right");e=goog.style.getComputedStyle(a,b+"Top");a=goog.style.getComputedStyle(a,b+"Bottom");return new goog.math.Box(parseFloat(e),parseFloat(d),
parseFloat(a),parseFloat(c))};goog.style.getPaddingBox=function(a){return goog.style.getBox_(a,"padding")};goog.style.getMarginBox=function(a){return goog.style.getBox_(a,"margin")};goog.style.ieBorderWidthKeywords_={thin:2,medium:4,thick:6};
goog.style.getIePixelBorder_=function(a,b){if("none"==goog.style.getCascadedStyle(a,b+"Style"))return 0;b=goog.style.getCascadedStyle(a,b+"Width");return b in goog.style.ieBorderWidthKeywords_?goog.style.ieBorderWidthKeywords_[b]:goog.style.getIePixelValue_(a,b,"left","pixelLeft")};
goog.style.getBorderBox=function(a){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){var b=goog.style.getIePixelBorder_(a,"borderLeft");var c=goog.style.getIePixelBorder_(a,"borderRight");var d=goog.style.getIePixelBorder_(a,"borderTop");a=goog.style.getIePixelBorder_(a,"borderBottom");return new goog.math.Box(d,c,a,b)}b=goog.style.getComputedStyle(a,"borderLeftWidth");c=goog.style.getComputedStyle(a,"borderRightWidth");d=goog.style.getComputedStyle(a,"borderTopWidth");a=goog.style.getComputedStyle(a,
"borderBottomWidth");return new goog.math.Box(parseFloat(d),parseFloat(c),parseFloat(a),parseFloat(b))};goog.style.getFontFamily=function(a){var b=goog.dom.getOwnerDocument(a),c="";if(b.body.createTextRange&&goog.dom.contains(b,a)){b=b.body.createTextRange();b.moveToElementText(a);try{c=b.queryCommandValue("FontName")}catch(d){c=""}}c||(c=goog.style.getStyle_(a,"fontFamily"));a=c.split(",");1<a.length&&(c=a[0]);return goog.string.stripQuotes(c,"\"'")};goog.style.lengthUnitRegex_=/[^\d]+$/;
goog.style.getLengthUnits=function(a){return(a=a.match(goog.style.lengthUnitRegex_))&&a[0]||null};goog.style.ABSOLUTE_CSS_LENGTH_UNITS_={cm:1,"in":1,mm:1,pc:1,pt:1};goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_={em:1,ex:1};
goog.style.getFontSize=function(a){var b=goog.style.getStyle_(a,"fontSize"),c=goog.style.getLengthUnits(b);if(b&&"px"==c)return parseInt(b,10);if(goog.userAgent.IE){if(String(c)in goog.style.ABSOLUTE_CSS_LENGTH_UNITS_)return goog.style.getIePixelValue_(a,b,"left","pixelLeft");if(a.parentNode&&a.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&String(c)in goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_)return a=a.parentNode,c=goog.style.getStyle_(a,"fontSize"),goog.style.getIePixelValue_(a,b==c?"1em":b,
"left","pixelLeft")}c=goog.dom.createDom("SPAN",{style:"visibility:hidden;position:absolute;line-height:0;padding:0;margin:0;border:0;height:1em;"});goog.dom.appendChild(a,c);b=c.offsetHeight;goog.dom.removeNode(c);return b};goog.style.parseStyleAttribute=function(a){var b={};goog.array.forEach(a.split(/\s*;\s*/),function(a){var c=a.match(/\s*([\w-]+)\s*\:(.+)/);c&&(a=c[1],c=goog.string.trim(c[2]),b[goog.string.toCamelCase(a.toLowerCase())]=c)});return b};
goog.style.toStyleAttribute=function(a){var b=[];goog.object.forEach(a,function(a,d){b.push(goog.string.toSelectorCase(d),":",a,";")});return b.join("")};goog.style.setFloat=function(a,b){a.style[goog.userAgent.IE?"styleFloat":"cssFloat"]=b};goog.style.getFloat=function(a){return a.style[goog.userAgent.IE?"styleFloat":"cssFloat"]||""};
goog.style.getScrollbarWidth=function(a){var b=goog.dom.createElement("DIV");a&&(b.className=a);b.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px";a=goog.dom.createElement("DIV");goog.style.setSize(a,"200px","200px");b.appendChild(a);goog.dom.appendChild(goog.dom.getDocument().body,b);a=b.offsetWidth-b.clientWidth;goog.dom.removeNode(b);return a};goog.style.MATRIX_TRANSLATION_REGEX_=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;
goog.style.getCssTranslation=function(a){a=goog.style.getComputedTransform(a);return a?(a=a.match(goog.style.MATRIX_TRANSLATION_REGEX_))?new goog.math.Coordinate(parseFloat(a[1]),parseFloat(a[2])):new goog.math.Coordinate(0,0):new goog.math.Coordinate(0,0)};goog.userAgent.platform={};
goog.userAgent.platform.determineVersion_=function(){if(goog.userAgent.WINDOWS){var a=/Windows NT ([0-9.]+)/;return(a=a.exec(goog.userAgent.getUserAgentString()))?a[1]:"0"}return goog.userAgent.MAC?(a=/10[_.][0-9_.]+/,(a=a.exec(goog.userAgent.getUserAgentString()))?a[0].replace(/_/g,"."):"10"):goog.userAgent.ANDROID?(a=/Android\s+([^\);]+)(\)|;)/,(a=a.exec(goog.userAgent.getUserAgentString()))?a[1]:""):goog.userAgent.IPHONE||goog.userAgent.IPAD||goog.userAgent.IPOD?(a=/(?:iPhone|CPU)\s+OS\s+(\S+)/,(a=
a.exec(goog.userAgent.getUserAgentString()))?a[1].replace(/_/g,"."):""):""};goog.userAgent.platform.VERSION=goog.userAgent.platform.determineVersion_();goog.userAgent.platform.isVersion=function(a){return 0<=goog.string.compareVersions(goog.userAgent.platform.VERSION,a)};goog.userAgent.product={};goog.userAgent.product.ASSUME_FIREFOX=!1;goog.userAgent.product.ASSUME_IPHONE=!1;goog.userAgent.product.ASSUME_IPAD=!1;goog.userAgent.product.ASSUME_ANDROID=!1;goog.userAgent.product.ASSUME_CHROME=!1;goog.userAgent.product.ASSUME_SAFARI=!1;
goog.userAgent.product.PRODUCT_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_OPERA||goog.userAgent.product.ASSUME_FIREFOX||goog.userAgent.product.ASSUME_IPHONE||goog.userAgent.product.ASSUME_IPAD||goog.userAgent.product.ASSUME_ANDROID||goog.userAgent.product.ASSUME_CHROME||goog.userAgent.product.ASSUME_SAFARI;goog.userAgent.product.OPERA=goog.userAgent.OPERA;goog.userAgent.product.IE=goog.userAgent.IE;goog.userAgent.product.EDGE=goog.userAgent.EDGE;
goog.userAgent.product.FIREFOX=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_FIREFOX:goog.labs.userAgent.browser.isFirefox();goog.userAgent.product.isIphoneOrIpod_=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpod()};goog.userAgent.product.IPHONE=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPHONE:goog.userAgent.product.isIphoneOrIpod_();
goog.userAgent.product.IPAD=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad();goog.userAgent.product.ANDROID=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_ANDROID:goog.labs.userAgent.browser.isAndroidBrowser();goog.userAgent.product.CHROME=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_CHROME:goog.labs.userAgent.browser.isChrome();
goog.userAgent.product.isSafariDesktop_=function(){return goog.labs.userAgent.browser.isSafari()&&!goog.labs.userAgent.platform.isIos()};goog.userAgent.product.SAFARI=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_SAFARI:goog.userAgent.product.isSafariDesktop_();goog.userAgent.product.determineVersion_=function(){if(goog.userAgent.product.FIREFOX)return goog.userAgent.product.getFirstRegExpGroup_(/Firefox\/([0-9.]+)/);if(goog.userAgent.product.IE||goog.userAgent.product.EDGE||goog.userAgent.product.OPERA)return goog.userAgent.VERSION;if(goog.userAgent.product.CHROME)return goog.labs.userAgent.platform.isIos()?goog.userAgent.product.getFirstRegExpGroup_(/CriOS\/([0-9.]+)/):goog.userAgent.product.getFirstRegExpGroup_(/Chrome\/([0-9.]+)/);if(goog.userAgent.product.SAFARI&&
!goog.labs.userAgent.platform.isIos())return goog.userAgent.product.getFirstRegExpGroup_(/Version\/([0-9.]+)/);if(goog.userAgent.product.IPHONE||goog.userAgent.product.IPAD){var a=goog.userAgent.product.execRegExp_(/Version\/(\S+).*Mobile\/(\S+)/);if(a)return a[1]+"."+a[2]}else if(goog.userAgent.product.ANDROID)return(a=goog.userAgent.product.getFirstRegExpGroup_(/Android\s+([0-9.]+)/))?a:goog.userAgent.product.getFirstRegExpGroup_(/Version\/([0-9.]+)/);return""};
goog.userAgent.product.getFirstRegExpGroup_=function(a){return(a=goog.userAgent.product.execRegExp_(a))?a[1]:""};goog.userAgent.product.execRegExp_=function(a){return a.exec(goog.userAgent.getUserAgentString())};goog.userAgent.product.VERSION=goog.userAgent.product.determineVersion_();goog.userAgent.product.isVersion=function(a){return 0<=goog.string.compareVersions(goog.userAgent.product.VERSION,a)};goog.style.bidi={};goog.style.bidi.getScrollLeft=function(a){var b=goog.style.isRightToLeft(a),c=goog.userAgent.product.SAFARI&&goog.userAgent.product.isVersion(10),d=goog.userAgent.IOS&&goog.userAgent.platform.isVersion(10);return b&&(goog.userAgent.GECKO||c||d)?-a.scrollLeft:!b||goog.userAgent.EDGE_OR_IE&&goog.userAgent.isVersionOrHigher("8")||"visible"==goog.style.getComputedOverflowX(a)?a.scrollLeft:a.scrollWidth-a.clientWidth-a.scrollLeft};
goog.style.bidi.getOffsetStart=function(a){var b=a.offsetLeft,c=a.offsetParent;c||"fixed"!=goog.style.getComputedPosition(a)||(c=goog.dom.getOwnerDocument(a).documentElement);if(!c)return b;if(goog.userAgent.GECKO){var d=goog.style.getBorderBox(c);b+=d.left}else goog.userAgent.isDocumentModeOrHigher(8)&&!goog.userAgent.isDocumentModeOrHigher(9)&&(d=goog.style.getBorderBox(c),b-=d.left);return goog.style.isRightToLeft(c)?c.clientWidth-(b+a.offsetWidth):b};
goog.style.bidi.setScrollOffset=function(a,b){b=Math.max(b,0);goog.style.isRightToLeft(a)?goog.userAgent.GECKO?a.scrollLeft=-b:goog.userAgent.EDGE_OR_IE&&goog.userAgent.isVersionOrHigher("8")?a.scrollLeft=b:a.scrollLeft=a.scrollWidth-b-a.clientWidth:a.scrollLeft=b};goog.style.bidi.setPosition=function(a,b,c,d){goog.isNull(c)||(a.style.top=c+"px");d?(a.style.right=b+"px",a.style.left=""):(a.style.left=b+"px",a.style.right="")};goog.fx={};
goog.fx.Dragger=function(a,b,c){goog.events.EventTarget.call(this);this.target=a;this.handle=b||a;this.limits=c||new goog.math.Rect(NaN,NaN,NaN,NaN);this.document_=goog.dom.getOwnerDocument(a);this.eventHandler_=new goog.events.EventHandler(this);this.registerDisposable(this.eventHandler_);this.deltaY=this.deltaX=this.startY=this.startX=this.screenY=this.screenX=this.clientY=this.clientX=0;this.enabled_=!0;this.dragging_=!1;this.preventMouseDown_=!0;this.hysteresisDistanceSquared_=0;this.useRightPositioningForRtl_=this.ieDragStartCancellingOn_=
!1;goog.events.listen(this.handle,[goog.events.EventType.TOUCHSTART,goog.events.EventType.MOUSEDOWN],this.startDrag,!1,this);this.useSetCapture_=goog.fx.Dragger.HAS_SET_CAPTURE_};goog.inherits(goog.fx.Dragger,goog.events.EventTarget);goog.tagUnsealableClass(goog.fx.Dragger);goog.fx.Dragger.HAS_SET_CAPTURE_=goog.global.document&&goog.global.document.documentElement&&!!goog.global.document.documentElement.setCapture&&!!goog.global.document.releaseCapture;
goog.fx.Dragger.cloneNode=function(a){for(var b=a.cloneNode(!0),c=goog.dom.getElementsByTagName("TEXTAREA",a),d=goog.dom.getElementsByTagName("TEXTAREA",b),e=0;e<c.length;e++)d[e].value=c[e].value;switch(a.tagName){case "TR":return goog.dom.createDom("TABLE",null,goog.dom.createDom("TBODY",null,b));case "TD":case "TH":return goog.dom.createDom("TABLE",null,goog.dom.createDom("TBODY",null,goog.dom.createDom("TR",null,b)));case "TEXTAREA":b.value=a.value;default:return b}};
goog.fx.Dragger.EventType={EARLY_CANCEL:"earlycancel",START:"start",BEFOREDRAG:"beforedrag",DRAG:"drag",END:"end"};goog.fx.Dragger.prototype.setAllowSetCapture=function(a){this.useSetCapture_=a&&goog.fx.Dragger.HAS_SET_CAPTURE_};goog.fx.Dragger.prototype.enableRightPositioningForRtl=function(a){this.useRightPositioningForRtl_=a};goog.fx.Dragger.prototype.getHandler=function(){return this.eventHandler_};goog.fx.Dragger.prototype.setLimits=function(a){this.limits=a||new goog.math.Rect(NaN,NaN,NaN,NaN)};
goog.fx.Dragger.prototype.setHysteresis=function(a){this.hysteresisDistanceSquared_=Math.pow(a,2)};goog.fx.Dragger.prototype.getHysteresis=function(){return Math.sqrt(this.hysteresisDistanceSquared_)};goog.fx.Dragger.prototype.setScrollTarget=function(a){this.scrollTarget_=a};goog.fx.Dragger.prototype.setCancelIeDragStart=function(a){this.ieDragStartCancellingOn_=a};goog.fx.Dragger.prototype.getEnabled=function(){return this.enabled_};
goog.fx.Dragger.prototype.setEnabled=function(a){this.enabled_=a};goog.fx.Dragger.prototype.setPreventMouseDown=function(a){this.preventMouseDown_=a};goog.fx.Dragger.prototype.disposeInternal=function(){goog.fx.Dragger.superClass_.disposeInternal.call(this);goog.events.unlisten(this.handle,[goog.events.EventType.TOUCHSTART,goog.events.EventType.MOUSEDOWN],this.startDrag,!1,this);this.cleanUpAfterDragging_();this.handle=this.target=null};
goog.fx.Dragger.prototype.isRightToLeft_=function(){goog.isDef(this.rightToLeft_)||(this.rightToLeft_=goog.style.isRightToLeft(this.target));return this.rightToLeft_};
goog.fx.Dragger.prototype.startDrag=function(a){var b=a.type==goog.events.EventType.MOUSEDOWN;if(!this.enabled_||this.dragging_||b&&!a.isMouseActionButton())this.dispatchEvent(goog.fx.Dragger.EventType.EARLY_CANCEL);else{if(0==this.hysteresisDistanceSquared_)if(this.fireDragStart_(a))this.dragging_=!0,this.preventMouseDown_&&b&&a.preventDefault();else return;else this.preventMouseDown_&&b&&a.preventDefault();this.setupDragHandlers();this.clientX=this.startX=a.clientX;this.clientY=this.startY=a.clientY;
this.screenX=a.screenX;this.screenY=a.screenY;this.computeInitialPosition();this.pageScroll=goog.dom.getDomHelper(this.document_).getDocumentScroll()}};
goog.fx.Dragger.prototype.setupDragHandlers=function(){var a=this.document_,b=a.documentElement,c=!this.useSetCapture_;this.eventHandler_.listen(a,[goog.events.EventType.TOUCHMOVE,goog.events.EventType.MOUSEMOVE],this.handleMove_,{capture:c,passive:!1});this.eventHandler_.listen(a,[goog.events.EventType.TOUCHEND,goog.events.EventType.MOUSEUP],this.endDrag,c);this.useSetCapture_?(b.setCapture(!1),this.eventHandler_.listen(b,goog.events.EventType.LOSECAPTURE,this.endDrag)):this.eventHandler_.listen(goog.dom.getWindow(a),
goog.events.EventType.BLUR,this.endDrag);goog.userAgent.IE&&this.ieDragStartCancellingOn_&&this.eventHandler_.listen(a,goog.events.EventType.DRAGSTART,goog.events.Event.preventDefault);this.scrollTarget_&&this.eventHandler_.listen(this.scrollTarget_,goog.events.EventType.SCROLL,this.onScroll_,c)};goog.fx.Dragger.prototype.fireDragStart_=function(a){return this.dispatchEvent(new goog.fx.DragEvent(goog.fx.Dragger.EventType.START,this,a.clientX,a.clientY,a))};
goog.fx.Dragger.prototype.cleanUpAfterDragging_=function(){this.eventHandler_.removeAll();this.useSetCapture_&&this.document_.releaseCapture()};goog.fx.Dragger.prototype.endDrag=function(a,b){this.cleanUpAfterDragging_();if(this.dragging_){this.dragging_=!1;var c=this.limitX(this.deltaX),d=this.limitY(this.deltaY);this.dispatchEvent(new goog.fx.DragEvent(goog.fx.Dragger.EventType.END,this,a.clientX,a.clientY,a,c,d,b||a.type==goog.events.EventType.TOUCHCANCEL))}else this.dispatchEvent(goog.fx.Dragger.EventType.EARLY_CANCEL)};
goog.fx.Dragger.prototype.endDragCancel=function(a){this.endDrag(a,!0)};
goog.fx.Dragger.prototype.handleMove_=function(a){if(this.enabled_){var b=(this.useRightPositioningForRtl_&&this.isRightToLeft_()?-1:1)*(a.clientX-this.clientX),c=a.clientY-this.clientY;this.clientX=a.clientX;this.clientY=a.clientY;this.screenX=a.screenX;this.screenY=a.screenY;if(!this.dragging_){var d=this.startX-this.clientX,e=this.startY-this.clientY;if(d*d+e*e>this.hysteresisDistanceSquared_)if(this.fireDragStart_(a))this.dragging_=!0;else{this.isDisposed()||this.endDrag(a);return}}c=this.calculatePosition_(b,
c);b=c.x;c=c.y;this.dragging_&&this.dispatchEvent(new goog.fx.DragEvent(goog.fx.Dragger.EventType.BEFOREDRAG,this,a.clientX,a.clientY,a,b,c))&&(this.doDrag(a,b,c,!1),a.preventDefault())}};goog.fx.Dragger.prototype.calculatePosition_=function(a,b){var c=goog.dom.getDomHelper(this.document_).getDocumentScroll();a+=c.x-this.pageScroll.x;b+=c.y-this.pageScroll.y;this.pageScroll=c;this.deltaX+=a;this.deltaY+=b;a=this.limitX(this.deltaX);b=this.limitY(this.deltaY);return new goog.math.Coordinate(a,b)};
goog.fx.Dragger.prototype.onScroll_=function(a){var b=this.calculatePosition_(0,0);a.clientX=this.clientX;a.clientY=this.clientY;this.doDrag(a,b.x,b.y,!0)};goog.fx.Dragger.prototype.doDrag=function(a,b,c,d){this.defaultAction(b,c);this.dispatchEvent(new goog.fx.DragEvent(goog.fx.Dragger.EventType.DRAG,this,a.clientX,a.clientY,a,b,c))};
goog.fx.Dragger.prototype.limitX=function(a){var b=this.limits,c=isNaN(b.left)?null:b.left;b=isNaN(b.width)?0:b.width;return Math.min(null!=c?c+b:Infinity,Math.max(null!=c?c:-Infinity,a))};goog.fx.Dragger.prototype.limitY=function(a){var b=this.limits,c=isNaN(b.top)?null:b.top;b=isNaN(b.height)?0:b.height;return Math.min(null!=c?c+b:Infinity,Math.max(null!=c?c:-Infinity,a))};
goog.fx.Dragger.prototype.computeInitialPosition=function(){this.deltaX=this.useRightPositioningForRtl_?goog.style.bidi.getOffsetStart(this.target):this.target.offsetLeft;this.deltaY=this.target.offsetTop};goog.fx.Dragger.prototype.defaultAction=function(a,b){this.useRightPositioningForRtl_&&this.isRightToLeft_()?this.target.style.right=a+"px":this.target.style.left=a+"px";this.target.style.top=b+"px"};goog.fx.Dragger.prototype.isDragging=function(){return this.dragging_};
goog.fx.DragEvent=function(a,b,c,d,e,f,g,h){goog.events.Event.call(this,a);this.clientX=c;this.clientY=d;this.browserEvent=e;this.left=goog.isDef(f)?f:b.deltaX;this.top=goog.isDef(g)?g:b.deltaY;this.dragger=b;this.dragCanceled=!!h};goog.inherits(goog.fx.DragEvent,goog.events.Event);goog.fx.DragListGroup=function(){goog.events.EventTarget.call(this);this.hysteresisDistance_=0;this.dragLists_=[];this.dragItems_=[];this.dragItemForHandle_={};this.eventHandler_=new goog.events.EventHandler(this);this.isCurrDragItemAlwaysDisplayed_=this.isInitialized_=!1;this.updateWhileDragging_=!0};goog.inherits(goog.fx.DragListGroup,goog.events.EventTarget);goog.fx.DragListDirection={DOWN:0,RIGHT:2,LEFT:3,RIGHT_2D:4,LEFT_2D:5};
goog.fx.DragListGroup.EventType={DRAGGERCREATED:new goog.events.EventId(goog.events.getUniqueId("draggercreated")),BEFOREDRAGSTART:new goog.events.EventId("beforedragstart"),DRAGSTART:new goog.events.EventId("dragstart"),BEFOREDRAGMOVE:new goog.events.EventId("beforedragmove"),DRAGMOVE:new goog.events.EventId("dragmove"),BEFOREDRAGEND:new goog.events.EventId("beforedragend"),DRAGEND:new goog.events.EventId("dragend"),DRAGGERREMOVED:new goog.events.EventId(goog.events.getUniqueId("draggerremoved"))};
goog.fx.DragListGroup.prototype.setIsCurrDragItemAlwaysDisplayed=function(){this.isCurrDragItemAlwaysDisplayed_=!0};goog.fx.DragListGroup.prototype.setNoUpdateWhileDragging=function(){this.updateWhileDragging_=!1};goog.fx.DragListGroup.prototype.setHysteresis=function(a){this.hysteresisDistance_=a};goog.fx.DragListGroup.prototype.getHysteresis=function(){return this.hysteresisDistance_};goog.fx.DragListGroup.prototype.isDragging=function(){return!!this.dragger_};
goog.fx.DragListGroup.prototype.addDragList=function(a,b,c,d){goog.asserts.assert(!this.isInitialized_);a.dlgGrowthDirection_=b;a.dlgDragHoverClass_=d;this.dragLists_.push(a)};goog.fx.DragListGroup.prototype.setFunctionToGetHandleForDragItem=function(a){goog.asserts.assert(!this.isInitialized_);this.getHandleForDragItem_=a};goog.fx.DragListGroup.prototype.setDragItemHoverClass=function(a){goog.asserts.assert(!this.isInitialized_);this.dragItemHoverClasses_=goog.array.slice(arguments,0)};
goog.fx.DragListGroup.prototype.setDragItemHandleHoverClass=function(a){goog.asserts.assert(!this.isInitialized_);this.dragItemHandleHoverClasses_=goog.array.slice(arguments,0)};goog.fx.DragListGroup.prototype.setCurrDragItemClass=function(a){goog.asserts.assert(!this.isInitialized_);this.currDragItemClasses_=goog.array.slice(arguments,0)};goog.fx.DragListGroup.prototype.setDraggerElClass=function(a){goog.asserts.assert(!this.isInitialized_);this.draggerElClasses_=goog.string.trim(a).split(" ")};
goog.fx.DragListGroup.prototype.init=function(){if(!this.isInitialized_){for(var a=0,b=this.dragLists_.length;a<b;a++)for(var c=goog.dom.getChildren(this.dragLists_[a]),d=0,e=c.length;d<e;++d)this.listenForDragEvents(c[d]);this.isInitialized_=!0}};goog.fx.DragListGroup.prototype.addItemToDragList=function(a,b,c){goog.isDef(c)?goog.dom.insertChildAt(a,b,c):goog.dom.appendChild(a,b);this.listenForDragEvents(b)};
goog.fx.DragListGroup.prototype.disposeInternal=function(){this.eventHandler_.dispose();for(var a=0,b=this.dragLists_.length;a<b;a++){var c=this.dragLists_[a];c.dlgGrowthDirection_=void 0;c.dlgDragHoverClass_=void 0}this.dragLists_.length=0;this.dragItems_.length=0;this.dragItemForHandle_=null;this.cleanupDragDom_();goog.fx.DragListGroup.superClass_.disposeInternal.call(this)};goog.fx.DragListGroup.prototype.recacheListAndItemBounds=function(){this.recacheListAndItemBounds_(this.currDragItem_)};
goog.fx.DragListGroup.prototype.recacheListAndItemBounds_=function(a){for(var b=0,c=this.dragLists_.length;b<c;b++){var d=this.dragLists_[b];d.dlgBounds_=goog.style.getBounds(d)}b=0;for(c=this.dragItems_.length;b<c;b++)d=this.dragItems_[b],d!=a&&(d.dlgBounds_=goog.style.getBounds(d))};
goog.fx.DragListGroup.prototype.listenForDragEvents=function(a){var b=this.getHandleForDragItem_(a),c=goog.getUid(b);this.dragItemForHandle_[c]=a;this.dragItemHoverClasses_&&(this.eventHandler_.listen(a,goog.events.EventType.MOUSEOVER,this.handleDragItemMouseover_),this.eventHandler_.listen(a,goog.events.EventType.MOUSEOUT,this.handleDragItemMouseout_));this.dragItemHandleHoverClasses_&&(this.eventHandler_.listen(b,goog.events.EventType.MOUSEOVER,this.handleDragItemHandleMouseover_),this.eventHandler_.listen(b,
goog.events.EventType.MOUSEOUT,this.handleDragItemHandleMouseout_));this.dragItems_.push(a);this.eventHandler_.listen(b,[goog.events.EventType.MOUSEDOWN,goog.events.EventType.TOUCHSTART],this.handlePotentialDragStart_)};
goog.fx.DragListGroup.prototype.handlePotentialDragStart_=function(a){var b=goog.getUid(a.currentTarget);this.currDragItem_=this.dragItemForHandle_[b];this.draggerEl_=this.createDragElementInternal(this.currDragItem_);this.draggerElClasses_&&goog.dom.classlist.addAll(goog.asserts.assert(this.draggerEl_),this.draggerElClasses_||[]);this.draggerEl_.style.margin="0";this.draggerEl_.style.position="absolute";this.draggerEl_.style.visibility="hidden";goog.dom.getOwnerDocument(this.currDragItem_).body.appendChild(this.draggerEl_);
b=goog.style.getPageOffset(this.currDragItem_);goog.style.setPageOffset(this.draggerEl_,b);this.dragger_=new goog.fx.Dragger(this.draggerEl_);this.dragger_.setHysteresis(this.hysteresisDistance_);goog.events.listen(this.dragger_,goog.fx.Dragger.EventType.START,this.handleDragStart_,!1,this);goog.events.listen(this.dragger_,goog.fx.Dragger.EventType.END,this.handleDragEnd_,!1,this);goog.events.listen(this.dragger_,goog.fx.Dragger.EventType.EARLY_CANCEL,this.cleanup_,!1,this);this.dispatchEvent(new goog.fx.DragListGroupEvent(goog.fx.DragListGroup.EventType.DRAGGERCREATED,
this,a,this.currDragItem_,this.draggerEl_,this.dragger_));this.dragger_.startDrag(a)};goog.fx.DragListGroup.prototype.cloneNode_=function(a){return goog.fx.Dragger.cloneNode(a)};goog.fx.DragListGroup.prototype.createDragElementInternal=function(a){return this.cloneNode_(a)};
goog.fx.DragListGroup.prototype.handleDragStart_=function(a){if(this.dispatchEvent(new goog.fx.DragListGroupEvent(goog.fx.DragListGroup.EventType.BEFOREDRAGSTART,this,a.browserEvent,this.currDragItem_,null,null))){this.origList_=this.currDragItem_.parentNode;this.currHoverItem_=this.origNextItem_=goog.dom.getNextElementSibling(this.currDragItem_);this.currHoverList_=this.origList_;this.currDragItemClasses_?goog.dom.classlist.addAll(goog.asserts.assert(this.currDragItem_),this.currDragItemClasses_||
[]):this.currDragItem_.style.visibility="hidden";var b=goog.style.getSize(this.draggerEl_);this.draggerEl_.halfWidth=b.width/2;this.draggerEl_.halfHeight=b.height/2;this.draggerEl_.style.visibility="";this.updateWhileDragging_&&(this.currDragItem_.style.display="none");this.recacheListAndItemBounds_(this.currDragItem_);this.currDragItem_.style.display="";goog.events.listen(this.dragger_,goog.fx.Dragger.EventType.DRAG,this.handleDragMove_,!1,this);this.dispatchEvent(new goog.fx.DragListGroupEvent(goog.fx.DragListGroup.EventType.DRAGSTART,
this,a.browserEvent,this.currDragItem_,this.draggerEl_,this.dragger_))}else a.preventDefault(),this.cleanup_()};
goog.fx.DragListGroup.prototype.handleDragMove_=function(a){var b=goog.style.getPageOffset(this.draggerEl_);b=new goog.math.Coordinate(b.x+this.draggerEl_.halfWidth,b.y+this.draggerEl_.halfHeight);var c=this.getHoverDragList_(b),d=c?this.getHoverNextItem_(c,b):null;if(!this.dispatchEvent(new goog.fx.DragListGroupEvent(goog.fx.DragListGroup.EventType.BEFOREDRAGMOVE,this,a,this.currDragItem_,this.draggerEl_,this.dragger_,b,c,d)))return!1;if(c)this.updateWhileDragging_?this.insertCurrDragItem_(c,d):
this.updateCurrHoverItem(d,b),this.currDragItem_.style.display="",c.dlgDragHoverClass_&&goog.dom.classlist.add(goog.asserts.assert(c),c.dlgDragHoverClass_);else{this.isCurrDragItemAlwaysDisplayed_||(this.currDragItem_.style.display="none");for(var e=0,f=this.dragLists_.length;e<f;e++){var g=this.dragLists_[e];g.dlgDragHoverClass_&&goog.dom.classlist.remove(goog.asserts.assert(g),g.dlgDragHoverClass_)}}c!=this.currHoverList_&&(this.currHoverList_=c,this.recacheListAndItemBounds_(this.currDragItem_));
this.dispatchEvent(new goog.fx.DragListGroupEvent(goog.fx.DragListGroup.EventType.DRAGMOVE,this,a,this.currDragItem_,this.draggerEl_,this.dragger_,b,c,d));return!1};goog.fx.DragListGroup.prototype.cleanup_=function(a){this.cleanupDragDom_();this.dragger_=this.draggerEl_=this.origNextItem_=this.origList_=this.currHoverList_=this.currDragItem_=null;a=0;for(var b=this.dragLists_.length;a<b;a++)this.dragLists_[a].dlgBounds_=null;a=0;for(b=this.dragItems_.length;a<b;a++)this.dragItems_[a].dlgBounds_=null};
goog.fx.DragListGroup.prototype.handleDragEnd_=function(a){if(!this.dispatchEvent(new goog.fx.DragListGroupEvent(goog.fx.DragListGroup.EventType.BEFOREDRAGEND,this,a,this.currDragItem_,this.draggerEl_,this.dragger_)))return!1;this.updateWhileDragging_||this.insertCurrHoverItem();this.cleanupDragDom_();this.dispatchEvent(new goog.fx.DragListGroupEvent(goog.fx.DragListGroup.EventType.DRAGEND,this,a,this.currDragItem_,this.draggerEl_,this.dragger_));this.cleanup_();return!0};
goog.fx.DragListGroup.prototype.cleanupDragDom_=function(){goog.dispose(this.dragger_);var a=this.draggerEl_&&this.draggerEl_.parentElement;this.draggerEl_&&goog.dom.removeNode(this.draggerEl_);this.currDragItem_&&"none"==this.currDragItem_.style.display&&(this.origList_.insertBefore(this.currDragItem_,this.origNextItem_),this.currDragItem_.style.display="");this.currDragItemClasses_&&this.currDragItem_?goog.dom.classlist.removeAll(goog.asserts.assert(this.currDragItem_),this.currDragItemClasses_||
[]):this.currDragItem_&&(this.currDragItem_.style.visibility="");for(var b=0,c=this.dragLists_.length;b<c;b++){var d=this.dragLists_[b];d.dlgDragHoverClass_&&goog.dom.classlist.remove(goog.asserts.assert(d),d.dlgDragHoverClass_)}a&&this.dispatchEvent(new goog.fx.DragListGroupEvent(goog.fx.DragListGroup.EventType.DRAGGERREMOVED,this,null,this.currDragItem_,this.draggerEl_,this.dragger_))};goog.fx.DragListGroup.prototype.getHandleForDragItem_=function(a){return a};
goog.fx.DragListGroup.prototype.handleDragItemMouseover_=function(a){a=goog.asserts.assertElement(a.currentTarget);goog.dom.classlist.addAll(a,this.dragItemHoverClasses_||[])};goog.fx.DragListGroup.prototype.handleDragItemMouseout_=function(a){a=goog.asserts.assertElement(a.currentTarget);goog.dom.classlist.removeAll(a,this.dragItemHoverClasses_||[])};
goog.fx.DragListGroup.prototype.handleDragItemHandleMouseover_=function(a){a=goog.asserts.assertElement(a.currentTarget);goog.dom.classlist.addAll(a,this.dragItemHandleHoverClasses_||[])};goog.fx.DragListGroup.prototype.handleDragItemHandleMouseout_=function(a){a=goog.asserts.assertElement(a.currentTarget);goog.dom.classlist.removeAll(a,this.dragItemHandleHoverClasses_||[])};
goog.fx.DragListGroup.prototype.getHoverDragList_=function(a){var b=null;if("none"!=this.currDragItem_.style.display){b=this.currDragItem_.parentNode;var c=goog.style.getBounds(b);if(this.isInRect_(a,c))return b}c=0;for(var d=this.dragLists_.length;c<d;c++){var e=this.dragLists_[c];if(e!=b&&this.isInRect_(a,e.dlgBounds_))return e}return null};goog.fx.DragListGroup.prototype.isInRect_=function(a,b){return a.x>b.left&&a.x<b.left+b.width&&a.y>b.top&&a.y<b.top+b.height};
goog.fx.DragListGroup.prototype.updateCurrHoverItem=function(a,b){a&&(this.currHoverItem_=a)};goog.fx.DragListGroup.prototype.insertCurrHoverItem=function(){this.origList_.insertBefore(this.currDragItem_,this.currHoverItem_)};
goog.fx.DragListGroup.prototype.getHoverNextItem_=function(a,b){if(null==a)throw Error("getHoverNextItem_ called with null hoverList.");var c=0,d=!1,e=void 0;switch(a.dlgGrowthDirection_){case goog.fx.DragListDirection.DOWN:c=b.y;var f=goog.fx.DragListGroup.getBottomBound_;var g=goog.fx.DragListGroup.isLessThan_;break;case goog.fx.DragListDirection.RIGHT_2D:d=!0;case goog.fx.DragListDirection.RIGHT:c=b.x;f=goog.fx.DragListGroup.getRightBound_;g=goog.fx.DragListGroup.isLessThan_;break;case goog.fx.DragListDirection.LEFT_2D:d=
!0;case goog.fx.DragListDirection.LEFT:c=b.x,f=goog.fx.DragListGroup.getLeftBound_,g=goog.fx.DragListGroup.isGreaterThan_}var h=null;a=goog.dom.getChildren(a);for(var k=0,l=a.length;k<l;k++){var m=a[k];if(m!=this.currDragItem_){var n=f(m.dlgBounds_);if(d){var p=goog.fx.DragListGroup.verticalDistanceFromItem_(m,b);goog.isDef(e)||(e=p);if(g(c,n)&&(void 0==q||p<e||p==e&&(g(n,q)||n==q))){h=m;var q=n}p<e&&(e=p)}else g(c,n)&&(void 0==q||g(n,q))&&(h=m,q=n)}}return!goog.isNull(h)&&goog.fx.DragListGroup.verticalDistanceFromItem_(h,
b)>e?null:h};goog.fx.DragListGroup.verticalDistanceFromItem_=function(a,b){a=a.dlgBounds_;return Math.abs(b.y-(a.top+(a.height-1)/2))};goog.fx.DragListGroup.getBottomBound_=function(a){return a.top+a.height-1};goog.fx.DragListGroup.getRightBound_=function(a){return a.left+a.width-1};goog.fx.DragListGroup.getLeftBound_=function(a){return a.left||0};goog.fx.DragListGroup.isLessThan_=function(a,b){return a<b};goog.fx.DragListGroup.isGreaterThan_=function(a,b){return a>b};
goog.fx.DragListGroup.prototype.insertCurrDragItem_=function(a,b){this.currDragItem_.parentNode==a&&goog.dom.getNextElementSibling(this.currDragItem_)==b||a.insertBefore(this.currDragItem_,b)};goog.fx.DragListGroupEvent=function(a,b,c,d,e,f,g,h,k){goog.events.Event.call(this,a);this.dragListGroup=b;this.event=c;this.currDragItem=d;this.draggerEl=e;this.dragger=f;this.draggerElCenter=g;this.hoverList=h;this.hoverNextItem=k};goog.inherits(goog.fx.DragListGroupEvent,goog.events.Event);ngeo.sortableDirective=function(a){return{restrict:"A",link:function(b,c,d){function e(){for(var a=c.contents(),d=c.children(),e=0;e<d.length;++e)angular.element(d[e]).data("idx",e);null!==l&&l.dispose();l=new goog.fx.DragListGroup;l.addDragList(c[0],goog.fx.DragListDirection.DOWN);l.setFunctionToGetHandleForDragItem(function(a){return a.getElementsByClassName(g.handleClassName)[0]});void 0!==g.draggerClassName&&l.setDraggerElClass(g.draggerClassName);void 0!==g.currDragItemClassName&&l.setCurrDragItemClass(g.currDragItemClassName);
var q=-1,r=null;goog.events.listen(l,"dragstart",function(a){q=-1;r=null;angular.element(a.draggerEl).css("width",a.currDragItem.offsetWidth)});goog.events.listen(l,"dragmove",function(a){var b=a.hoverNextItem;q=null===b?-1:angular.element(b).data("idx");r=a.hoverList});goog.events.listen(l,"dragend",function(d){var e=angular.element(d.currDragItem).data("idx");null===r||q==e+1||-1==q&&e==c.children().length-1?c.append(a):-1!=q?q!=e&&(q>e&&q--,b.$apply(function(){f.splice(q,0,f.splice(e,1)[0])})):
b.$apply(function(){f.push(f.splice(e,1)[0])});h instanceof Function&&h.apply(k,[c,f])});l.init()}var f=b.$eval(d.ngeoSortable)||[];goog.asserts.assert(Array.isArray(f));var g=function(a){void 0===a?a={handleClassName:"ngeo-sortable-handle"}:void 0===a.handleClassName&&(a.handleClassName="ngeo-sortable-handle");return a}(b.$eval(d.ngeoSortableOptions)),h=b.$eval(d.ngeoSortableCallback),k=b.$eval(d.ngeoSortableCallbackCtx),l=null;b.$watchCollection(function(){return f},function(){f.length&&a(e,0)})}}};
ngeo.sortableDirective.$inject=["$timeout"];ngeo.module.directive("ngeoSortable",ngeo.sortableDirective);gmf.module.value("isDesktop",!0);gmf.module.value("ngeoQueryOptions",{limit:20});gmf.module.value("ngeoMeasurePrecision",3);gmf.module.value("ngeoMeasureDecimals",0);
gmf.AbstractDesktopController=function(a,b,c){var d=this,e={projection:ol.proj.get("EPSG:"+(a.srid||21781))};ol.obj.assign(e,a.mapViewConfig||{});this.map=new ol.Map({pixelRatio:a.mapPixelRatio,layers:[],view:new ol.View(e),controls:a.mapControls||[new ol.control.ScaleLine({target:document.getElementById("scaleline")}),new ol.control.Zoom({zoomInTipLabel:"",zoomOutTipLabel:""})],interactions:a.mapInteractions||ol.interaction.defaults({pinchRotate:!1,altShiftDragRotate:!1}),loadTilesWhileAnimating:!0,
loadTilesWhileInteracting:!0});this.googleStreetViewActive=this.editFeatureActive=this.modalShareShown=this.toolsActive=this.loginActive=!1;this.googleStreetViewStyle=new ol.style.Style({text:new ol.style.Text({fill:new ol.style.Fill({color:"#279B61"}),font:"normal 30px FontAwesome",offsetY:-15,stroke:new ol.style.Stroke({color:"#ffffff",width:3}),text:"\uf041"})});var f=$("body");f.tooltip({container:"body",trigger:"hover",selector:'[data-toggle="tooltip"]'});f.on("touchstart.detectTouch",function(){f.tooltip("destroy");
f.off("touchstart.detectTouch")});e=c.get("ngeoFeatures");this.drawFeatureLayer=c.get("ngeoFeatureOverlayMgr").getFeatureOverlay();this.drawFeatureLayer.setFeatures(e);var g=c.get("ngeoFeatureHelper");this.editFeatureVectorLayer=new ol.layer.Vector({source:new ol.source.Vector({wrapX:!1,features:new ol.Collection}),style:function(a,b){return g.createEditingStyles(a)}});this.editFeatureVectorLayer.setMap(this.map);e=c.get("ngeoToolActivateMgr");var h=new ngeo.ToolActivate(this,"editFeatureActive");
e.registerTool("mapTools",h,!1);h=new ngeo.ToolActivate(this,"googleStreetViewActive");e.registerTool("mapTools",h,!1);this.scaleSelectorOptions={dropup:!0};this.profileLine=null;gmf.AbstractController.call(this,a,b,c);b.$watch(function(){return d.gmfUser.username},function(a){null!==a&&d.loginActive&&(d.loginActive=!1)})};ol.inherits(gmf.AbstractDesktopController,gmf.AbstractController);goog.exportSymbol("gmf.AbstractDesktopController",gmf.AbstractDesktopController);
gmf.AbstractDesktopController.$inject=["config","$scope","$injector"];gmf.module.controller("AbstractDesktopController",gmf.AbstractDesktopController);ngeo.googlestreetviewComponent={};
ngeo.GooglestreetviewController=function(a,b,c){var d=this;b.$watch(function(){return d.active},this.handleActiveChange_.bind(this));this.scope_=b;this.feature_=new ol.Feature;this.featureOverlay_=goog.asserts.assert(c.getFeatureOverlay());this.listenerKeys_=[];this.location=null;this.noDataAtLocation=!1;this.panorama_=new google.maps.StreetViewPanorama(a[0],{pov:{heading:0,pitch:0},visible:!1,zoom:1});this.panoramaListener_=null;this.point_=new ol.geom.Point([0,0]);this.feature_.setGeometry(this.point_);
this.streetViewService_=new google.maps.StreetViewService;this.panoramaPositionChanging_=!1};
ngeo.GooglestreetviewController.prototype.$onInit=function(){var a=this;this.scope_.$watch(function(){return a.location},this.handleLocationChange_.bind(this));this.scope_.$watch(function(){var b=null!==a.location;return a.active&&b},this.handleReadyChange_.bind(this));this.scope_.$watch(function(){var b=null!==a.location,c=!1===a.noDataAtLocation;return a.active&&b&&c},function(b,c){b!==c&&(a.panorama_.setVisible(b),b?a.panoramaListener_=google.maps.event.addListener(a.panorama_,"position_changed",
a.handlePanoramaPositionChange_.bind(a)):a.panoramaListener_&&(google.maps.event.removeListener(a.panoramaListener_),a.panoramaListener_=null))});this.featureStyle&&this.feature_.setStyle(this.featureStyle)};ngeo.GooglestreetviewController.prototype.handleActiveChange_=function(a){var b=this.listenerKeys_;a?b.push(ol.events.listen(this.map,ol.events.EventType.CLICK,this.handleMapClick_,this)):(ol.Observable.unByKey(b),b.length=0)};
ngeo.GooglestreetviewController.prototype.handleLocationChange_=function(a,b){a===b||Array.isArray(a)&&Array.isArray(b)&&ol.array.equals(a,b)||(this.point_.setCoordinates(a),a&&!this.panoramaPositionChanging_&&(a=this.toLonLat_(a),this.streetViewService_.getPanorama({location:{lat:a[1],lng:a[0]},radius:this.radius},this.handleStreetViewServiceGetPanorama_.bind(this))))};ngeo.GooglestreetviewController.prototype.handleMapClick_=function(a){this.location=a.coordinate;this.scope_.$apply()};
ngeo.GooglestreetviewController.prototype.handleReadyChange_=function(a,b){a!==b&&(a?this.featureOverlay_.addFeature(this.feature_):this.featureOverlay_.removeFeature(this.feature_))};ngeo.GooglestreetviewController.prototype.handleStreetViewServiceGetPanorama_=function(a,b){var c=this.panorama_;b===google.maps.StreetViewStatus.OK?(this.noDataAtLocation=!1,c.setPosition(a.location.latLng)):this.noDataAtLocation=!0;this.scope_.$apply()};
ngeo.GooglestreetviewController.prototype.handlePanoramaPositionChange_=function(){this.panoramaPositionChanging_=!0;var a=this.panorama_.getPosition();a=[a.lng(),a.lat()];this.location=this.fromLonLat_(a);this.scope_.$apply();this.panoramaPositionChanging_=!1};ngeo.GooglestreetviewController.prototype.fromLonLat_=function(a){return ol.proj.fromLonLat(a,this.map.getView().getProjection())};ngeo.GooglestreetviewController.prototype.toLonLat_=function(a){return ol.proj.toLonLat(a,this.map.getView().getProjection())};
ngeo.GooglestreetviewController.$inject=["$element","$scope","ngeoFeatureOverlayMgr"];ngeo.module.component("ngeoGooglestreetview",{bindings:{active:"<",featureStyle:"<?",map:"<",radius:"<?"},controller:ngeo.GooglestreetviewController,controllerAs:"gsvCtrl",templateUrl:function(){return ngeo.baseTemplateUrl+"/googlestreetview.html"}});"function"!==typeof ol.proj.proj4.get()&&"function"===typeof proj4&&ol.proj.setProj4(proj4);if("function"==typeof ol.proj.proj4.get()){var epsg2056def="+proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +k_0=1 +x_0=2600000 +y_0=1200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs",epsg2056extent=[242E4,103E4,29E5,135E4];ol.proj.proj4.get().defs("EPSG:2056",epsg2056def);ol.proj.get("EPSG:2056").setExtent(epsg2056extent)}ngeo.proj.EPSG2056="EPSG:2056";app.GmfImportHelper=function(a,b,c,d,e){this.map_=a;this.$scope_=b;b.map=a;this.ngeoFile_=d;this.$q_=e;this.gpxFormat_=new ol.format.GPX;this.kmlFormat_=new ol.format.KML;this.gettext_=c;this.urls=[{name:"geoadmin",url:"https://wms.geo.admin.ch/"},{name:"ASIT VD WMTS",url:"https://ows.asitvd.ch/wmts1.0.0/WMTSCapabilities.xml"},{name:"heig",url:"http://ogc.heig-vd.ch/mapserver/wms"}]};
app.GmfImportHelper.prototype.createWmsLayer=function(a,b){b=b||{};b.id="WMS||"+b.label+"||"+b.url+"||"+a.LAYERS;a.VERSION?(b.id+="||"+a.VERSION,b.useReprojection&&(b.projection="EPSG:4326",b.id+="||true")):a.VERSION="1.3.0";a=new ol.source.ImageWMS({params:a,url:b.url,ratio:b.ratio||1,projection:b.projection});return new ol.layer.Image({id:b.id,url:b.url,type:"WMS",opacity:b.opacity,visible:b.visible,attribution:b.attribution,extent:b.extent,source:a})};
app.GmfImportHelper.prototype.createWmtsLayer=function(a){var b=new ol.source.WMTS(a.sourceConfig);return new ol.layer.Tile({id:a.id,extent:a.extent,source:b})};app.GmfImportHelper.prototype.getOlLayerFromGetCapLayer=function(a){return a.capabilitiesUrl?this.createWmtsLayer(a):this.createWmsLayer({LAYERS:a.Name,VERSION:a.wmsVersion},{url:a.wmsUrl,label:a.Title,useReprojection:a.useReprojection})};
app.GmfImportHelper.prototype.addFeatures=function(a,b){b=new ol.source.Vector({features:b});var c=new ol.layer.Vector({source:b});a.addLayer(c);(c=a.getSize())&&a.getView().fit(b.getExtent(),{size:c,padding:[30,30,30,30]})};
app.GmfImportHelper.prototype.handleFileContent=function(a,b){b=this.map_;var c=this.$q_.defer(),d=this.$scope_,e=this.ngeoFile_;d.gpxContent=null;d.kmlContent=null;d.wmsGetCap=null;d.wmtsGetCap=null;e.isWmsGetCap(a)?(d.wmsGetCap=a,c.resolve({message:this.gettext_("Download succeeded")})):e.isWmtsGetCap(a)?(d.wmtsGetCap=a,c.resolve({message:this.gettext_("Download succeeded")})):e.isKml(a)?(a=this.kmlFormat_.readFeatures(a,{featureProjection:b.getView().getProjection()}),this.addFeatures(b,a),c.reject({message:this.gettext_("Parsing failed"),
reason:this.gettext_("Not implemented yet")})):e.isGpx(a)?(a=this.gpxFormat_.readFeatures(a,{featureProjection:b.getView().getProjection()}),this.addFeatures(b,a),c.resolve({message:this.gettext_("Parsing succeeded")})):(console.error("Unparseable content: ",a),c.reject({message:this.gettext_("Parsing failed"),reason:this.gettext_("unsupported format")}));return c.promise};
app.GmfImportHelper.prototype.createOptions=function(){var a=this;return{urls:this.urls,getOlLayerFromGetCapLayer:this.getOlLayerFromGetCapLayer.bind(this),addPreviewLayer:function(a,c){},removePreviewLayer:function(a,c){},transformUrl:function(b){/(wms|service\.svc|osm)/i.test(b)&&(b+="?SERVICE=WMS&REQUEST=GetCapabilities&VERSION=1.3.0");return a.$q_.when(b)},handleFileContent:this.handleFileContent.bind(this)}};var app_desktop_alt={};gmf.module.value("ngeoQueryOptions",{limit:20,queryCountFirst:!0,cursorHover:!0});gmf.module.value("gmfPrintOptions",{scaleInput:!0});gmf.module.value("ngeoMeasurePrecision",6);gmf.module.value("ngeoMeasureDecimals",2);
app.AlternativeDesktopController=function(a,b,c,d,e){gmf.AbstractDesktopController.call(this,{srid:21781,mapViewConfig:{center:[632464,185457],zoom:3,resolutions:[250,100,50,20,10,5,2,1,.5,.25,.1,.05]}},a,b);this.searchCoordinatesProjections=["EPSG:21781","EPSG:2056","EPSG:4326"];this.searchDelay=500;this.showInfobar=!0;this.scaleSelectorValues=[25E4,1E5,5E4,2E4,1E4,5E3,2E3,1E3,500,250,100,50];this.elevationLayers=["srtm"];this.profileLinesconfiguration={srtm:{}};this.mousePositionProjections=[{code:"EPSG:2056",
label:"CH1903+ / LV95",filter:"ngeoNumberCoordinates::{x}, {y} m"},{code:"EPSG:21781",label:"CH1903 / LV03",filter:"ngeoNumberCoordinates::{x}, {y} m"},{code:"EPSG:4326",label:"WGS84",filter:"ngeoDMSCoordinates:2"}];this.gridMergeTabs={OSM_time_merged:["osm_time","osm_time2"],"transport (merged)":["fuel","parking"],"Learning [merged]":["information","bus_stop"]};b=b.get("gettextCatalog");b.getString("OSM_time_merged");b.getString("OSM_time (merged)");b.getString("Learning [merged]");b.getString("Add a theme");
b.getString("Add a sub theme");b.getString("Add a layer");this.bgOpacityOptions="Test aus Olten";this.importOptions=(new app.GmfImportHelper(this.map,a,d,c,e)).createOptions()};ol.inherits(app.AlternativeDesktopController,gmf.AbstractDesktopController);goog.exportSymbol("app.AlternativeDesktopController",app.AlternativeDesktopController);app.AlternativeDesktopController.$inject=["$scope","$injector","ngeoFile","gettext","$q"];
app.AlternativeDesktopController.prototype.onKeydown=function(a){a.ctrlKey&&"p"===a.key&&(this.printPanelActive=!0,a.preventDefault())};goog.exportProperty(app.AlternativeDesktopController.prototype,"onKeydown",app.AlternativeDesktopController.prototype.onKeydown);app.module.controller("AlternativeDesktopController",app.AlternativeDesktopController);(function(){var a=function(a){a.put("ngeo/popup.html",'<h4 class="popover-title ngeo-popup-title"> <span ng-bind-html=title></span> <button type=button class=close ng-click="open = false"> &times;</button> </h4> <div class=popover-content ng-bind-html=content></div> ');a.put("gmf/objectediting.html",'<gmf-objecteditingtools gmf-objecteditingtools-active=oeCtrl.toolsActive gmf-objecteditingtools-copyfromactive=oeCtrl.copyFromActive gmf-objecteditingtools-deletefromactive=oeCtrl.deleteFromActive gmf-objecteditingtools-feature=oeCtrl.feature gmf-objecteditingtools-geomtype=::oeCtrl.geomType gmf-objecteditingtools-map=::oeCtrl.map gmf-objecteditingtools-process=oeCtrl.process gmf-objecteditingtools-queryablelayerinfo=oeCtrl.selectedQueryableLayerInfo gmf-objecteditingtools-requireslayer=oeCtrl.queryableLayerListShown gmf-objecteditingtools-sketchfeatures=::oeCtrl.sketchFeatures> </gmf-objecteditingtools> <div class=form-group ng-show=oeCtrl.queryableLayerListShown> <label ng-show="oeCtrl.copyFromActive === true" class=control-label>{{\'Copy from:\' | translate}}</label> <label ng-show="oeCtrl.deleteFromActive === true" class=control-label>{{\'Cut from:\' | translate}}</label> <select class=form-control ng-model=oeCtrl.selectedQueryableLayerInfo ng-options="layerInfo.layerNode.name | translate for layerInfo in oeCtrl.queryableLayersInfo"> </select> </div> <form novalidate name=form class="form gmf-objectediting-form"> <input type=submit value="{{\'Save\' | translate}}" class="btn btn-sm btn-default gmf-objectediting-btn-save" ng-click="form.$valid && oeCtrl.save()" ng-disabled="!oeCtrl.dirty || oeCtrl.pending || !oeCtrl.featureHasGeom" title="{{\'Save modifications\' | translate}}"> <a class="btn btn-sm btn-link gmf-objectediting-btn-undo" ng-click=oeCtrl.undo() ng-disabled="!oeCtrl.dirty || oeCtrl.pending" title="{{\'Undo latest modifications\' | translate}}" href>{{\'Undo\' | translate}}</a> <a class="btn btn-sm btn-link gmf-objectediting-btn-delete" ng-click=oeCtrl.delete() ng-disabled="oeCtrl.isStateInsert() || oeCtrl.pending" title="{{\'Delete the feature\' | translate}}" href>{{\'Delete\' | translate}}</a> </form> ');
a.put("ngeo/googlestreetview.html",'<div class=ngeo-googlestreetview-instructions ng-if="gsvCtrl.location === null" translate> Click on a road on the map to start StreetView. </div> <div class=ngeo-googlestreetview-nodata ng-if=gsvCtrl.noDataAtLocation translate> Street View data not found for this location. </div> ');a.put("gmf/mobilemeasurepoint.html",'<a class="btn btn-default" ng-if=ctrl.active ng-click=ctrl.deactivate()> <span class="fa fa-times"></span> {{\'Close\' | translate}} </a> ');a.put("gmf/map.html",
"<div ngeo-map=ctrl.map ngeo-map-manage-resize=ctrl.manageResize ngeo-map-resize-transition=ctrl.resizeTransition> </div> ");a.put("ngeo/datepicker.html","<div class=ngeo-datepicker> <form name=dateForm class=ngeo-datepicker-form novalidate> <div ng-if=\"::datepickerCtrl.time.widget === 'datepicker'\"> <div class=ngeo-datepicker-start-date> <span ng-if=\"::datepickerCtrl.time.mode === 'range'\" translate>From:</span> <span ng-if=\"::datepickerCtrl.time.mode !== 'range'\" translate>Date:</span> <input name=sdate ui-date=datepickerCtrl.sdateOptions ng-model=datepickerCtrl.sdate required> </div> <div class=ngeo-datepicker-end-date ng-if=\"::datepickerCtrl.time.mode === 'range'\"> <span translate>To:</span> <input name=edate ui-date=datepickerCtrl.edateOptions ng-model=datepickerCtrl.edate required> </div> </div> </form> </div> ");
a.put("gmf/drawfeature.html",'<ngeo-drawfeature ngeo-btn-group class=btn-group ngeo-drawfeature-active=efCtrl.drawActive ngeo-drawfeature-map=efCtrl.map ngeo-drawfeature-showmeasure=efCtrl.showMeasure> <a data-toggle=tooltip title="{{\'Draw a point on the map\' | translate}}" href ngeo-btn ngeo-drawpoint class="btn btn-default ngeo-drawfeature-point" ng-class="{active: dfCtrl.drawPoint.active}" ng-model=dfCtrl.drawPoint.active> <span class="gmf-icon gmf-icon-point"></span> </a> <a data-toggle=tooltip title="{{\'Draw a line on the map\' | translate}}" href ngeo-btn ngeo-measurelength class="btn btn-default ngeo-drawfeature-linestring" ng-class="{active: dfCtrl.measureLength.active}" ng-model=dfCtrl.measureLength.active> <span class="gmf-icon gmf-icon-line"></span> </a> <a data-toggle=tooltip title="{{\'Draw a polygon on the map\' | translate}}" href ngeo-btn ngeo-measurearea class="btn btn-default ngeo-drawfeature-polygon" ng-class="{active: dfCtrl.measureArea.active}" ng-model=dfCtrl.measureArea.active> <span class="gmf-icon gmf-icon-polygon"></span> </a> <a data-toggle=tooltip title="{{\'Draw a circle on the map\' | translate}}" href ngeo-btn ngeo-measureazimut class="btn btn-default ngeo-drawfeature-circle" ng-class="{active: dfCtrl.measureAzimut.active}" ng-model=dfCtrl.measureAzimut.active> <span class="gmf-icon gmf-icon-circle"></span> </a> <a data-toggle=tooltip title="{{\'Draw a rectangle on the map\' | translate}}" href ngeo-btn ngeo-drawrectangle class="btn btn-default ngeo-drawfeature-rectangle" ng-class="{active: dfCtrl.drawRectangle.active}" ng-model=dfCtrl.drawRectangle.active> <span class="gmf-icon gmf-icon-rectangle"></span> </a> <a data-toggle=tooltip title="{{\'Draw a text label on the map\' | translate}}" href ngeo-btn ngeo-drawtext class="btn btn-default ngeo-drawfeature-text" ng-class="{active: dfCtrl.drawText.active}" ng-model=dfCtrl.drawText.active> <span class="gmf-icon gmf-icon-text"></span> </a> </ngeo-drawfeature> <div ng-switch=efCtrl.selectedFeature> <hr class=gmf-drawfeature-separator ng-show="efCtrl.getFeaturesArray().length > 0"> <div ng-switch-when=null> <div ng-show="efCtrl.getFeaturesArray().length > 0"> <div class=ngeo-drawfeature-actionbuttons> <button type=button data-toggle=dropdown aria-haspopup=true aria-expanded=false ngeo-exportfeatures ngeo-exportfeatures-features=efCtrl.features class="btn btn-link btn-sm"> <span class="fa fa-mail-forward"></span> {{\'Export\' | translate}} <span class=caret></span> </button> <button ng-click=efCtrl.clearFeatures() class="btn btn-link btn-xs"> <span class="fa fa-trash"></span> {{\'Delete All\' | translate}} </button> </div> <div class=gmf-eol></div> <div class="gmf-drawfeature-featurelist list-group list-group-sm"> <button role=button class=list-group-item ng-repeat="feature in efCtrl.getFeaturesArray()" ng-click=efCtrl.selectFeatureFromList(feature);> {{ feature.get(efCtrl.nameProperty) }} </button> </div> </div> </div> <div ng-switch-default> <button ng-click="efCtrl.selectedFeature = null;" class="btn btn-link btn-xs"> <span class="fa fa-arrow-left"></span> {{\'List\' | translate}} </button> <div class=ngeo-drawfeature-actionbuttons> <button type=button data-toggle=dropdown aria-haspopup=true aria-expanded=false ngeo-exportfeatures ngeo-exportfeatures-features=efCtrl.selectedFeatures class="btn btn-link btn-xs"> <span class="fa fa-mail-forward"></span> {{\'Export\' | translate}} <span class=caret></span> </button> <button ng-click=efCtrl.removeFeature(efCtrl.selectedFeature); class="btn btn-link btn-xs"> <span class="fa fa-trash"></span> {{\'Delete\' | translate}} </button> </div> <div class=gmf-eol></div> <gmf-featurestyle gmf-featurestyle-feature=efCtrl.selectedFeature> </gmf-featurestyle> </div> </div> ');
a.put("gmf/authentication.html",'<div ng-if=authCtrl.gmfUser.username> <div class=form-group> <span>{{\'Logged in as\' | translate}}</span> <strong>{{ ::authCtrl.gmfUser.username }}</strong>. </div> <form name=logoutForm role=form ng-submit=authCtrl.logout() ng-controller=GmfAuthenticationController ng-class="{\'has-error\': authCtrl.error}" ng-if=!authCtrl.changingPassword> <div class=form-group> <input type=submit class="form-control btn btn-primary" value="{{\'Logout\' | translate}}"> </div> <span ng-show=authCtrl.error class="gmf-authentication-error help-block"></span> <div class=form-group> <input ng-show=authCtrl.allowPasswordChange type=button class="form-control btn btn-default" value="{{\'Change password\' | translate}}" ng-click="authCtrl.changingPassword = true"> </div> </form> <form name=changePasswordForm role=form ng-submit=authCtrl.changePassword() ng-controller=GmfAuthenticationController ng-class="{\'has-error\': authCtrl.error}" ng-if=authCtrl.changingPassword> <div class=form-group> <input type=password class=form-control name=oldpassword ng-model=authCtrl.oldPwdVal ng-attr-placeholder="{{\'Old password\' | translate}}"> </div> <div class=form-group> <input type=password class=form-control name=newpassword ng-model=authCtrl.newPwdVal ng-attr-placeholder="{{\'New password\' | translate}}"> </div> <div class=form-group> <input type=password class=form-control name=newpasswordconfirm ng-model=authCtrl.newPwdConfVal ng-attr-placeholder="{{\'Confirm new password\' | translate}}"> </div> <div class=form-group> <input type=submit class="form-control btn btn-primary" value="{{\'Change password\' | translate}}"> </div> <div class=form-group> <span ng-show=authCtrl.error class="gmf-authentication-error help-block"></span> <input type=button class="form-control btn btn-default" value="{{\'Cancel\' | translate}}" ng-click=authCtrl.changePasswordReset()> </div> </form> <ngeo-modal ngeo-modal-destroy-content-on-hide=true ng-model=authCtrl.changePasswordModalShown> <div class=modal-header> <button type=button class=close data-dismiss=modal aria-label="{{\'Close\' | translate}}"> <span aria-hidden=true>&times;</span> </button> <h4 class=modal-title> {{\'Password Changed\' | translate}} </h4> </div> <div class=modal-body> {{\'Your password has succesfully been changed.\' | translate}} </div> <div class=modal-footer> <button type=button class="btn btn-default" data-dismiss=modal>{{\'OK\' | translate}}</button> </div> </ngeo-modal> </div> <div ng-if=!authCtrl.gmfUser.username> <form name=loginForm role=form ng-submit=authCtrl.login() ng-controller=GmfAuthenticationController ng-class="{\'has-error\': authCtrl.error}"> <div class=form-group> <input type=text class=form-control name=login ng-model=authCtrl.loginVal ng-attr-placeholder="{{\'Username\' | translate}}"> </div> <div class=form-group> <input type=password class=form-control name=password ng-model=authCtrl.pwdVal ng-attr-placeholder="{{\'Password\' | translate}}"> </div> <div class=form-group> <input type=submit class="form-control btn btn-primary" value="{{\'Connect\' | translate}}"> </div> <span ng-show=authCtrl.error class="gmf-authentication-error help-block"></span> <div ng-show=authCtrl.allowPasswordReset class=form-group> <a ng-click=authCtrl.resetPassword() href>{{\'Password forgotten?\' | translate}}</a> </div> </form> <ngeo-modal ngeo-modal-destroy-content-on-hide=true ng-model=authCtrl.resetPasswordModalShown> <div class=modal-header> <button type=button class=close data-dismiss=modal aria-label="{{\'Close\' | translate}}"> <span aria-hidden=true>&times;</span> </button> <h4 class=modal-title> {{\'Password forgotten?\' | translate}} </h4> </div> <div class=modal-body translate> A new password has just been sent to you by e-mail. </div> <div class=modal-footer> <button type=button class="btn btn-default" data-dismiss=modal>{{\'OK\' | translate}}</button> </div> </ngeo-modal> </div> ');
a.put("ngeomodule/import/partials/import-dnd.html","<div translate>Drop file here</div> ");a.put("gmf/editfeature.html",'<div> <div ng-switch=efCtrl.feature> <a ng-switch-when=null ng-if=efCtrl.geomType href ngeo-btn ngeo-createfeature ngeo-createfeature-active=efCtrl.createActive ngeo-createfeature-features=::efCtrl.features ngeo-createfeature-geom-type=::efCtrl.geomType ngeo-createfeature-map=::efCtrl.map class="btn btn-default" ng-class="{active: efCtrl.createActive}" ng-model=efCtrl.createActive> <span ng-switch=::efCtrl.geomType> <span ng-switch-when=Point> <span class="gmf-icon gmf-icon-point"></span> {{\'Draw new point\' | translate}} </span> <span ng-switch-when=MultiPoint> <span class="gmf-icon gmf-icon-point"></span> {{\'Draw new point\' | translate}} </span> <span ng-switch-when=LineString> <span class="gmf-icon gmf-icon-line"></span> {{\'Draw new linestring\' | translate}} </span> <span ng-switch-when=MultiLineString> <span class="gmf-icon gmf-icon-line"></span> {{\'Draw new linestring\' | translate}} </span> <span ng-switch-when=Polygon> <span class="gmf-icon gmf-icon-polygon"></span> {{\'Draw new polygon\' | translate}} </span> <span ng-switch-when=MultiPolygon> <span class="gmf-icon gmf-icon-polygon"></span> {{\'Draw new polygon\' | translate}} </span> </span> </a> <div ng-switch-default> <ngeo-modal ng-model=efCtrl.unsavedModificationsModalShown ngeo-modal-destroy-content-on-hide=true> <div class=modal-header> <button type=button class=close data-dismiss=modal aria-label="{{\'Close\' | translate}}"> <span aria-hidden=true>&times;</span> </button> <h4 class=modal-title> {{\'Unsaved modifications!\' | translate}} </h4> </div> <div class=modal-body> {{\'There are unsaved changes.\' | translate}} </div> <div class=modal-footer> <button type=button class="btn btn-default" data-dismiss=modal ng-click=efCtrl.continueWithoutSaving()> {{\'Continue without saving\' | translate}} </button> <button type=button class="btn btn-primary" data-dismiss=modal> {{\'Cancel\' | translate}} </button> <button type=button class="btn btn-default" data-dismiss=modal ng-click=efCtrl.submit()> {{\'Save\' | translate}} </button> </div> </ngeo-modal> <form novalidate name=form class="form gmf-editfeature-attributes-container" ng-if=efCtrl.attributes> <div class=row> <div class=col-sm-12> <a class=close ng-click=efCtrl.cancel() ng-disabled=efCtrl.pending title="{{\'Cancel modifications\' | translate}}" href>&times;</a> </div> </div> <ngeo-attributes ngeo-attributes-attributes=::efCtrl.attributes ngeo-attributes-disabled=efCtrl.pending ngeo-attributes-feature=::efCtrl.feature> </ngeo-attributes> <input type=submit value="{{\'Save\' | translate}}" class="btn btn-sm btn-default gmf-editfeature-btn-save" ng-click="form.$valid && efCtrl.save()" ng-disabled="!efCtrl.dirty || efCtrl.pending" title="{{\'Save modifications\' | translate}}"> <a class="btn btn-sm btn-default gmf-editfeature-btn-cancel" ng-click=efCtrl.confirmCancel() ng-disabled=efCtrl.pending title="{{\'Cancel modifications\' | translate}}" href>{{\'Cancel\' | translate}}</a> <button class="btn btn-sm btn-link gmf-editfeature-btn-delete" ng-click=efCtrl.delete() ng-disabled=efCtrl.pending ng-show=efCtrl.featureId title="{{\'Delete this feature\' | translate}}"> <span class="fa fa-trash"></span> {{\'Delete\' | translate}} </button> </form> </div> </div> <ngeo-modal ng-model=efCtrl.showServerError ngeo-modal-destroy-content-on-hide=true> <div class=modal-header>{{\'Server error.\' | translate}}</div> <div class=modal-body>{{\'Unexpected server error.\' | translate}}</div> </ngeo-modal> </div> ');
a.put("gmf/layertree.html",'<div class=gmf-layertree-root-tools ng-if=layertreeCtrl.isRoot> <a href ng-if="gmfLayertreeCtrl.nodesCount() > 0" ng-click=gmfLayertreeCtrl.removeAllNodes()> <span class="fa fa-trash"></span> {{\'Clear all\' | translate}} </a> </div> <div ng-if=::!layertreeCtrl.isRoot id=gmf-layertree-node-{{::layertreeCtrl.uid}} ng-class="[layertreeCtrl.node.children ? \'gmf-layertree-group\' : \'gmf-layertree-leaf\', \'gmf-layertree-depth-\' + layertreeCtrl.depth, gmfLayertreeCtrl.getResolutionStyle(layertreeCtrl.node), gmfLayertreeCtrl.getNodeState(layertreeCtrl)]"> <div class=ngeo-sortable-handle ng-show="layertreeCtrl.depth === 1 && layertreeCtrl.parent.children.length > 1"> <i class="gmf-layertree-sortable-handle-icon fa fa-ellipsis-v"></i> </div> <a ng-if=::layertreeCtrl.node.children data-toggle=collapse href=#gmf-layertree-layer-group-{{::layertreeCtrl.uid}} aria-expanded={{::layertreeCtrl.node.metadata.isExpanded}} class="fa gmf-layertree-expand-node fa-fw"> </a> <a href ng-click=::gmfLayertreeCtrl.toggleActive(layertreeCtrl) ng-if=::!layertreeCtrl.node.children ng-class="::{\'gmf-layertree-no-layer-icon\' : !gmfLayertreeCtrl.getLegendIconURL(layertreeCtrl)}" class=gmf-layertree-layer-icon> <img ng-if=::(legendIconUrl=gmfLayertreeCtrl.getLegendIconURL(layertreeCtrl)) ng-src={{::legendIconUrl}}> </a> <a href ng-click=::gmfLayertreeCtrl.toggleActive(layertreeCtrl) ng-if=::layertreeCtrl.node.children ng-class="[\'fa fa-fw\', layertreeCtrl.node.children && !layertreeCtrl.layer.loading ? \'gmf-layertree-state\' : \'fa-refresh fa-spin\']"> </a> <a href ng-click=::gmfLayertreeCtrl.toggleActive(layertreeCtrl) class=gmf-layertree-name title="{{layertreeCtrl.node.name | translate}}"> {{layertreeCtrl.node.name | translate}} <i class="gmf-icon gmf-icon-search-go gmf-layertree-zoom" data-toggle=tooltip data-title="{{\'Not visible at current scale. Click to zoom.\'|translate}}" ng-click="::gmfLayertreeCtrl.zoomToResolution(layertreeCtrl); $event.preventDefault(); $event.stopPropagation();" ng-if="gmfLayertreeCtrl.getNodeState(layertreeCtrl) == \'on\'"> </i> <span ngeo-popover ngeo-popover-dismiss=.content ng-if="gmfLayertreeCtrl.getNodeState(layertreeCtrl) !== \'off\' && layertreeCtrl.node.time && layertreeCtrl.node.time.mode !== \'disabled\'"> <span ngeo-popover-anchor class="fa fa-clock-o" ng-click="$event.preventDefault(); $event.stopPropagation()"> </span> <div ngeo-popover-content> <ngeo-date-picker ng-if="::layertreeCtrl.node.time.widget === \'datepicker\'" time=layertreeCtrl.node.time on-date-selected="gmfLayertreeCtrl.updateWMSTimeLayerState(layertreeCtrl, time)"> </ngeo-date-picker> <gmf-time-slider ng-if="::layertreeCtrl.node.time.widget === \'slider\'" gmf-time-slider-time=layertreeCtrl.node.time gmf-time-slider-on-date-selected="gmfLayertreeCtrl.updateWMSTimeLayerState(layertreeCtrl, time)"> </gmf-time-slider> </div> </span> <span class="fa fa-pencil" title="{{\'Currently editing this layer\'|translate}}" ng-if=layertreeCtrl.properties.editing> </span> </a> <span class=gmf-layertree-right-buttons> <a href ng-if="::layertreeCtrl.depth == 1" ng-click=gmfLayertreeCtrl.removeNode(layertreeCtrl.node)> <span class="fa fa-trash"></span> </a> <span ngeo-popover ng-if="::(layertreeCtrl.depth === 1 && !layertreeCtrl.node.mixed) || (layertreeCtrl.depth > 1 && layertreeCtrl.parent.node.mixed && !layertreeCtrl.node.children) || (gmfLayertreeCtrl.getLegendsObject(layertreeCtrl) && layertreeCtrl.node.metadata.legend) || layertreeCtrl.getDataSource().filtrable" ngeo-popover-dismiss=.content> <span ngeo-popover-anchor class="extra-actions fa fa-cog"> </span> <div ngeo-popover-content> <ul> <li ng-if="::(layertreeCtrl.depth === 1 && !layertreeCtrl.node.mixed) || (layertreeCtrl.depth > 1 && layertreeCtrl.parent.node.mixed)"> <i class="fa fa-tint fa-fw"></i> <span for=layer-opactity>{{\'Opacity\'|translate}}</span> <input class=input-action name=layer-opactity type=range min=0 max=1 step=0.01 ng-model=layertreeCtrl.layer.opacity> </li> <li ng-if="::gmfLayertreeCtrl.getLegendsObject(layertreeCtrl) && layertreeCtrl.node.metadata.legend"> <i class="fa fa-th-list fa-fw"></i> <a title="{{\'Show/hide legend\'|translate}}" ng-click="::gmfLayertreeCtrl.toggleNodeLegend(\'#gmf-layertree-node-\' + layertreeCtrl.uid + \'-legend\'); popoverCtrl.dismissPopover()" data-toggle=collapse href> {{\'Show/hide legend\'|translate}} </a> </li> <li ng-if="layertreeCtrl.getDataSource() && layertreeCtrl.getDataSource().filtrable"> <i class="fa fa-filter fa-fw"></i> <a title="{{\'Filter\'|translate}}" ng-click=gmfLayertreeCtrl.toggleFiltrableDataSource(layertreeCtrl.getDataSource()) href> {{\'Filter\'|translate}} </a> </li> </ul> </div> </span> <span class=gmf-layertree-metadata ng-if=::layertreeCtrl.node.metadata.metadataUrl> <span ng-if="::gmfLayertreeCtrl.openLinksInNewWindow === true"> <a title="{{\'More informations\'|translate}}" href={{::layertreeCtrl.node.metadata.metadataUrl}} target=blank_> </a> </span> <span ng-if="::gmfLayertreeCtrl.openLinksInNewWindow !== true"> <a title="{{\'More informations\'|translate}}" href ng-click=gmfLayertreeCtrl.displayMetadata(layertreeCtrl)> </a> </span> </span> <a class="fa fa-align-left gmf-layertree-legend-button" ng-if="::gmfLayertreeCtrl.getLegendsObject(layertreeCtrl) && layertreeCtrl.node.metadata.legend" title="{{\'Show/hide legend\'|translate}}" data-toggle=collapse ng-click="::gmfLayertreeCtrl.toggleNodeLegend(\'#gmf-layertree-node-\' + layertreeCtrl.uid + \'-legend\')" href> </a> </span> </div> <div ng-if="::!layertreeCtrl.isRoot && gmfLayertreeCtrl.getLegendsObject(layertreeCtrl) && layertreeCtrl.node.metadata.legend" id=gmf-layertree-node-{{::layertreeCtrl.uid}}-legend class="collapse gmf-layertree-legend" ng-class="::[layertreeCtrl.node.metadata.isLegendExpanded ? \'in\' : \'\']"> <a title="{{\'Hide legend\'|translate}}" data-toggle=collapse ng-click="::gmfLayertreeCtrl.toggleNodeLegend(\'#gmf-layertree-node-\' + layertreeCtrl.uid + \'-legend\')" href> {{\'Hide legend\'|translate}} </a> <div ng-if="gmfLayertreeCtrl.isNodeLegendVisible(\'#gmf-layertree-node-\' + layertreeCtrl.uid + \'-legend\')"> <div ng-repeat="(title, url) in ::gmfLayertreeCtrl.getLegendsObject(layertreeCtrl)"> <p ng-if="::gmfLayertreeCtrl.getNumberOfLegendsObject(layertreeCtrl) > 1">{{title|translate}}</p> <img ng-src={{url}}> </div> </div> </div> <ul id=gmf-layertree-layer-group-{{::layertreeCtrl.uid}} ng-if=::layertreeCtrl.node.children ng-class="{collapse: !layertreeCtrl.isRoot, in : layertreeCtrl.node.metadata.isExpanded}" ngeo-sortable="::layertreeCtrl.isRoot && layertreeCtrl.node.children" ngeo-sortable-options="{handleClassName: \'ngeo-sortable-handle\', draggerClassName: \'gmf-layertree-dragger\', currDragItemClassName : \'gmf-layertree-curr-drag-item\'}" ngeo-sortable-callback=::gmfLayertreeCtrl.afterReorder ngeo-sortable-callback-ctx=::gmfLayertreeCtrl> <li class=gmf-layertree-node ng-repeat="node in layertreeCtrl.node.children" ng-class="\'gmf-layertree-depth-\' + layertreeCtrl.depth" ngeo-layertree=node ngeo-layertree-notroot ngeo-layertree-map=layertreeCtrl.map ngeo-layertree-nodelayerexpr=layertreeCtrl.nodelayerExpr ngeo-layertree-listenersexpr=layertreeCtrl.listenersExpr> </li> </ul> ');
a.put("ngeo/grid.html",'<div class=ngeo-grid-table-container> <table float-thead=ctrl.floatTheadConfig ng-model=ctrl.configuration.data class="table table-bordered table-striped table-hover"> <thead class=table-header> <tr> <th ng-repeat="columnDefs in ctrl.configuration.columnDefs" ng-click=ctrl.sort(columnDefs.name) ng-bind-html="columnDefs.name | ngeoTrustHtml | translate"> <i ng-show="ctrl.sortedBy !== columnDefs.name" class="fa fa-fw"></i> <i ng-show="ctrl.sortedBy === columnDefs.name && ctrl.sortAscending === true" class="fa fa-caret-up"></i> <i ng-show="ctrl.sortedBy === columnDefs.name && ctrl.sortAscending === false" class="fa fa-caret-down"></i> </th> </tr> </thead> <tbody> <tr ng-repeat="attributes in ctrl.configuration.data" ng-class="[\'row-\' + ctrl.configuration.getRowUid(attributes), ctrl.configuration.isRowSelected(attributes) ? \'ngeo-grid-active\': \'\']" ng-click="ctrl.clickRow(attributes, $event)" ng-mousedown=ctrl.preventTextSelection($event)> <td ng-repeat="columnDefs in ctrl.configuration.columnDefs" ng-bind-html="attributes[columnDefs.name] | ngeoTrustHtml"></td> </tr> </tbody> </table> </div> ');
a.put("ngeomodule/import/partials/wms-get-cap.html",'<div class=ngeo-message>{{limitations}}</div> <div class=ngeo-container> <div class=ngeo-header ng-click="reverse = !reverse"> <label translate>Layer</label> <button class="pull-right fa" ng-class="{\'fa-sort-by-alphabet\': !reverse, \'fa-sort-by-alphabet-alt\': reverse}"></button> </div> <div class=ngeo-content> <ul> <li ng-repeat="layer in layers | orderBy:\'Title\':reverse"> <div ngeo-wms-get-cap-item></div> </li> </ul> </div> <div class="modal-backdrop fade in" ng-show="progress > 0 && progress < 100"> <div class="progress progress-striped active"> <div class=progress-bar style="width: 100%;"></div> </div> </div> </div> <div class=ngeo-descr> <label translate>Description</label> <textarea placeholder="{{\'description instructions\' | translate}}" class=form-control readonly>{{getAbstract()}}</textarea> <button type=button class="btn btn-default btn-sm ngeo-add" ng-disabled="(!options.layerSelected || options.layerSelected.isInvalid)" ng-click=addLayerSelected() translate>Add layer</button> </div> ');
a.put("ngeomodule/import/partials/wmts-get-cap.html",'<div class=ngeo-container> <div class=ngeo-header ng-click="reverse = !reverse"> <label translate>Layer</label> <button class="pull-right fa" ng-class="{\'fa-sort-by-alphabet\': !reverse, \'fa-sort-by-alphabet-alt\': reverse}"></button> </div> <div class=ngeo-content> <ul> <li ng-repeat="layer in layers | orderBy:\'Title\':reverse"> <div ngeo-wmts-get-cap-item></div> </li> </ul> </div> <div class="modal-backdrop fade in" ng-show="progress > 0 && progress < 100"> <div class="progress progress-striped active"> <div class=progress-bar style="width: 100%;"></div> </div> </div> </div> <div class=ngeo-descr> <label translate>Description</label> <textarea placeholder="{{\'description instructions\' | translate}}" class=form-control readonly>{{getAbstract()}}</textarea> <button type=button class="btn btn-default btn-sm ngeo-add" ng-disabled="(!options.layerSelected || options.layerSelected.isInvalid)" ng-click=addLayerSelected() translate>Add layer</button> </div> ');
a.put("gmf/print.html",'<div class=gmf-print> <div ng-show="ctrl.isState(\'CAPABILITIES_NOT_LOADED\') !== true && ctrl.isState(\'ERROR_ON_GETCAPABILITIES\') !== true"> <div class="gmf-print-layout-selector form-horizontal"><ng-transclude/></div> <div ng-repeat="attribute in ctrl.layoutInfo.simpleAttributes" class="gmf-print-layoutinfo form-group"> <div ng-if="ctrl.hiddenAttributeNames === undefined || ctrl.hiddenAttributeNames.indexOf(attribute.name) < 0"> <input ng-if="attribute.type === \'number\'" ng-model=attribute.value class=form-control type=number ng-attr-placeholder="{{attribute.name | translate}}"> <input ng-if="attribute.type === \'text\'" ng-model=attribute.value class=form-control type=text ng-attr-placeholder="{{attribute.name | translate}}"> <textarea ng-if="attribute.type === \'textarea\'" ng-model=attribute.value class=form-control row=3 ng-attr-placeholder="{{attribute.name | translate}}"></textarea> <div ng-if="attribute.type === \'checkbox\'" class=checkbox> <label> <input ng-model=attribute.value type=checkbox> <span>{{attribute.name | translate}}</span> </label> </div> </div> </div> <div ng-show="ctrl.layoutInfo.legend !== undefined" class="gmf-print-legend checkbox"> <label> <input ng-model=ctrl.layoutInfo.legend type=checkbox> <span translate>Legend</span> </label> </div> <div class="gmf-print-layout-selector form-horizontal"> <div ng-show="ctrl.layoutInfo.layouts.length !== 1" class=form-group> <label class="control-label col-md-5" translate>Layout</label> <div class=col-md-7> <div class="btn-group btn-block"> <button type=button class="btn btn-default form-control" data-toggle=dropdown> <span>{{ctrl.layoutInfo.layout | translate}}&nbsp;</span> <i class="fa fa-caret-down"></i> </button> <ul class="dropdown-menu dropdown-menu-right btn-block" role=menu> <li ng-repeat="layout in ctrl.layoutInfo.layouts"> <a ng-click=ctrl.setLayout(layout) href>{{layout | translate}}</a> </li> </ul> </div> </div> </div> <div ng-show="ctrl.layoutInfo.scales.length !== 1" class="gmf-print-scale-selector form-group"> <label class="control-label col-md-5" translate>Scale</label> <div class=col-md-7> <div class="btn-group btn-block"> <button type=button class="btn btn-default form-control" data-toggle=dropdown aria-expanded=false> <span>{{ctrl.layoutInfo.scale | ngeoScalify}}&nbsp;</span> <i class="fa fa-caret-down"></i> </button> <ul class="dropdown-menu dropdown-menu-right btn-block" role=menu> <li ng-repeat="scale in ctrl.layoutInfo.scales"> <a ng-click=ctrl.getSetScale(scale) href>{{scale | ngeoScalify}}</a> </li> <span ng-if=ctrl.scaleInput> <li class=dropdown-header translate>Manual entry</li> <li> <div class=gmf-print-custom-scale> 1 : <input class=gmf-print-custom-scale-input type=number min=1 ng-model=ctrl.getSetScale ng-model-options="{getterSetter: true}"> </div> </li> </span> </ul> </div> </div> </div> <div ng-show="ctrl.layoutInfo.dpis.length !== 1" class="gmf-print-dpi-selector form-group"> <label class="control-label col-md-3" translate>DPI</label> <div class=col-md-5> <div class="btn-group btn-block"> <button type=button class="btn btn-default form-control" data-toggle=dropdown aria-expanded=false> <span>{{ctrl.layoutInfo.dpi}}&nbsp;</span> <i class="fa fa-caret-down"></i> </button> <ul class="dropdown-menu dropdown-menu-right btn-block" role=menu> <li ng-repeat="dpi in ctrl.layoutInfo.dpis"> <a href ng-click=ctrl.setDpi(dpi)>{{dpi}}</a> </li> </ul> </div> </div> </div> <div class="gmf-print-rotation-selector form-group"> <label class="control-label col-md-3" translate>Rotation</label> <div class=col-md-5> <input class="form-control gmf-print-rotation-input" type=range value=0 min=-180 max=180 data-toggle=tooltip title="{{\'You can also use Alt+Shift on the map\' | translate}}"> </div> <div class=col-md-4> <input class="form-control gmf-print-rotation-input" type=number min=-180 max=180 value=0> </div> </div> </div> <div class="gmf-print-actions form-group pull-right"> <span ng-show="ctrl.isState(\'PRINTING\')"> <i class="fa fa-refresh fa-spin"></i> </span> <a ng-show="ctrl.isState(\'PRINTING\')" class="gmf-print-cancel btn btn-link" href ng-click=ctrl.cancel() translate>Abort</a> <button ng-show=ctrl.layoutInfo.formats.png class="gmf-print-image btn btn-primary" ng-disabled="ctrl.isState(\'PRINTING\')" ng-click="ctrl.print(\'png\')" translate>Image</button> <button ng-show=ctrl.layoutInfo.formats.pdf class="gmf-print-pdf btn btn-primary" ng-disabled="ctrl.isState(\'PRINTING\')" ng-click="ctrl.print(\'pdf\')" translate>PDF</button> </div> <div ng-show="ctrl.isState(\'ERROR_ON_REPORT\')" class="gmf-print-error-report form-group pull-left text-danger"> <p>{{\'Error during the print, please try again.\' | translate}}</p> </div> </div> <div ng-show="ctrl.isState(\'CAPABILITIES_NOT_LOADED\')" class="gmf-print-wait form-group pull-left"> <p>{{\'Connecting to the print server, please wait.\' | translate}}</p> </div> <div ng-show="ctrl.isState(\'ERROR_ON_GETCAPABILITIES\')" class="gmf-print-error-capabilities form-group pull-left text-danger"> <p>{{\'The print server is unavailable. Please, try later.\' | translate}}</p> </div> </div> ');
a.put("gmf/filterselector.html",'<div class=form-group ng-switch=fsCtrl.filtrableDataSources.length> <span ng-switch-when=0 translate>No filtrable layer available!</span> <select class=form-control ng-disabled=fsCtrl.aRuleIsActive ng-switch-default ng-model=fsCtrl.gmfDataSourceBeingFiltered.dataSource ng-options="dataSource.name | translate for dataSource in fsCtrl.filtrableDataSources"> <option value translate>-- Layer to filter --</option> </select> <div ng-if="fsCtrl.customRules && fsCtrl.directedRules && fsCtrl.readyDataSource"> <hr class=gmf-filterselector-separator> <div class="dropdown gmf-filterselector-savedfilters"> <a class="btn btn-link dropdown-toggle ngeo-filter-condition-button" ng-class="{disabled: fsCtrl.aRuleIsActive || fsCtrl.gmfSavedFilters.currentDataSourceItems.length === 0}" type=button data-toggle=dropdown ng-disabled="fsCtrl.aRuleIsActive || fsCtrl.gmfSavedFilters.currentDataSourceItems.length === 0"> <span translate>Saved</span> <span class=caret></span> </a> <ul class=dropdown-menu> <li ng-repeat="item in fsCtrl.gmfSavedFilters.currentDataSourceItems"> <a href ng-click=fsCtrl.saveFilterLoadItem(item)> <span>{{::item.name}}</span> </a> </li> <li role=separator class=divider></li> <li> <a href ng-click=fsCtrl.saveFilterManage()> <span translate>Manage saved filters</span> </a> </li> </ul> </div> <ngeo-filter a-rule-is-active=fsCtrl.aRuleIsActive custom-rules=fsCtrl.customRules datasource=fsCtrl.readyDataSource directed-rules=fsCtrl.directedRules feature-overlay=fsCtrl.featureOverlay map=fsCtrl.map tool-group=fsCtrl.toolGroup> </ngeo-filter> <div> <a class="btn btn-link gmf-filterselector-savebtn" type=button data-toggle=dropdown ng-click="!fsCtrl.aRuleIsActive && fsCtrl.saveFilterShowModal()" ng-disabled=fsCtrl.aRuleIsActive> <span class="fa fa-save"></span> <span translate>Save</span> </a> </div> </div> <ngeo-modal ng-model=fsCtrl.saveFilterSaveModalShown> <div class=modal-header> <button type=button class=close data-dismiss=modal aria-label="{{\'Close\' | translate}}"> <span aria-hidden=true>&times;</span> </button> <h4 class=modal-title>{{\'Save filter\' | translate}}</h4> </div> <div class=modal-body> <p class=gmf-filterselector-savefilter-desc translate> You can save the filter that you created to re-load it later. </p> <input type=text class=form-control name=name ng-model=fsCtrl.saveFilterName placeholder="{{\'Filter name\' | translate}}"> </div> <div class=modal-footer> <button type=button class="btn btn-default" data-dismiss=modal>{{\'Cancel\' | translate}}</button> <button type=button ng-click=fsCtrl.saveFilterSave() ng-disabled="fsCtrl.saveFilterName === \'\'" class="btn btn-primary">{{\'Save\' | translate}}</button> </div> </ngeo-modal> <ngeo-modal ng-model=fsCtrl.saveFilterManageModalShown> <div class=gmf-filterselector-managefilter-modal> <div class=modal-header> <button type=button class=close data-dismiss=modal aria-label="{{\'Close\' | translate}}"> <span aria-hidden=true>&times;</span> </button> <h4 class=modal-title>{{\'Manage filters\' | translate}}</h4> </div> <div class=modal-body> <ul> <li ng-repeat="item in fsCtrl.gmfSavedFilters.currentDataSourceItems"> <span>{{::item.name}}</span> <a href ng-click=fsCtrl.saveFilterRemoveItem(item)> {{ \'Delete\' | translate }} </a> <div class=gmf-eol></div> </li> </ul> </div> <div class=modal-footer> <button type=button class="btn btn-default" data-dismiss=modal>{{\'Close\' | translate}}</button> </div> </div> </ngeo-modal> </div> ');
a.put("ngeomodule/import/partials/wmts-get-cap-item.html",'<div class=ngeo-header-group ng-class="{\'ngeo-odd\': $odd, \'ngeo-invalid\': layer.isInvalid, \'ngeo-selected\': (options.layerSelected === layer)}" ng-mouseenter="addPreviewLayer($event, layer)" ng-mouseleave=removePreviewLayer($event) ng-click="toggleLayerSelected($event, layer)"> <button class="fa fa-zoom-in ngeo-btn" ng-disabled=!(layer.extent)></button> {{layer.Title}} </div> ');a.put("ngeo/attributes.html",'<fieldset ng-disabled=attrCtrl.disabled> <div class=form-group ng-repeat="attribute in ::attrCtrl.attributes"> <div ng-if="attribute.type !== \'geometry\'"> <label ng-if="::attribute.type !== \'boolean\'" class=control-label>{{ ::attribute.name | translate }} <span class=text-muted>{{::attribute.required ? "*" : ""}}</span> </label> <div ng-switch=::attribute.type> <div ng-switch-when=boolean class=checkbox> <label> <input name={{::attribute.name}} ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); type=checkbox> <span> {{ ::attribute.name | translate }} <span class=text-muted>{{::attribute.required ? "*" : ""}}</span></span> </label> </div> <select name={{::attribute.name}} ng-required=attribute.required ng-switch-when=select ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); class=form-control type=text> <option ng-repeat="attribute in ::attribute.choices" value="{{ ::attribute }}"> {{ ::attribute }} </option> </select> <input name={{::attribute.name}} ng-required=attribute.required ng-switch-when=date ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); ngeo-datetimepicker ngeo-datetimepicker-options="\'{&#34;timepicker&#34;: false, &#34;format&#34;: &#34;\' + attribute.format + \'&#34;, &#34;allowBlank&#34;: true, &#34;todayButton&#34;: false, &#34;mask&#34;: &#34;\' + attribute.mask + \'&#34;}\'" class=form-control type=text> <input name={{::attribute.name}} id=time ng-required=attribute.required ng-switch-when=time ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); ngeo-datetimepicker ngeo-datetimepicker-options="\'{&#34;datepicker&#34;: false, &#34;format&#34;: &#34;\' + attribute.format + \'&#34;, &#34;todayButton&#34;: false, &#34;mask&#34;: &#34;\' + attribute.mask + \'&#34;, &#34;defaultTime&#34;: &#34;00:00&#34;}\'" class=form-control type=text> <input name={{::attribute.name}} ng-required=attribute.required ng-switch-when=datetime ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); ngeo-datetimepicker ngeo-datetimepicker-options="\'{&#34;scrollTime&#34;: false, &#34;format&#34;: &#34;\' + attribute.format + \'&#34;, &#34;allowBlank&#34;: true, &#34;todayButton&#34;: false, &#34;mask&#34;: &#34;\' + attribute.mask + \'&#34;, &#34;defaultTime&#34;: &#34;00:00&#34;}\'" class=form-control type=text> <div ng-switch-when=number ng-switch=::attribute.numType> <input name={{::attribute.name}} ng-required=attribute.required ng-switch-when=integer ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); class=form-control step=1 type=number> <input name={{::attribute.name}} ng-required=attribute.required ng-switch-default ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); class=form-control type=number> </div> <input name={{::attribute.name}} ng-required=attribute.required ng-switch-default ng-model=attrCtrl.properties[attribute.name] ng-change=attrCtrl.handleInputChange(attribute.name); ng-maxlength=attribute.maxLength class=form-control type=text> <div ng-show="attrCtrl.form.$submitted || attrCtrl.form[attribute.name].$touched"> <p class=text-danger ng-show=attrCtrl.form[attribute.name].$error.required> {{\'This field is required\' | translate}} </p> </div> </div> </div> </div> </fieldset> ');
a.put("gmf/share.html",'<div class=modal-header> <button type=button class=close data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button> <h4 class=modal-title translate>Share this map</h4> </div> <div class=modal-body> <form role=form name=gmfShareForm novalidate> <div class=form-group> <label for=gmfShareInputShortLink translate>Permalink</label> <input type=text class=form-control id=gmfShareInputShortLink onclick=this.select() ng-model=shareCtrl.shortLink readonly=True> <p class=help-block translate>Copy this link to share it.</p> <p class=text-danger ng-if=shareCtrl.showLenghtWarning> <span class="fa fa-exclamation-triangle"></span> {{\'You have a lot of drawn elements in this map. The above link may not be correctly supported by some browsers.\' | translate}} </p> <p class=text-danger ng-if=shareCtrl.errorOnGetShortUrl> <span class="fa fa-exclamation"></span> {{\'Error, cannot get the shortened URL.\' | translate}} </p> </div> <hr> <div class=gmf-share-email ng-if=::shareCtrl.enableEmail> <div class=form-group> <label for=gmfShareInputEmail translate>Send this link to</label> <input type=email class=form-control name=inputEmail id=gmfShareInputEmail placeholder=E-mail ng-model=shareCtrl.email required> <span ng-show="gmfShareForm.$submitted || gmfShareForm.inputEmail.$touched"> <span class=text-danger ng-show="gmfShareForm.inputEmail.$error.email || gmfShareForm.inputEmail.$error.required"> <i class="fa fa-exclamation-triangle" aria-hidden=true></i> {{\'Invalid email.\' | translate}}</span> </span> </div> <div class=form-group> <textarea class=form-control ng-attr-placeholder="{{\'Message (optional)\' |\u00a0translate }}" ng-model=shareCtrl.message></textarea> </div> <span class=text-success ng-if=shareCtrl.successfullySent> <i class="fa fa-check" aria-hidden=true></i> {{ \'Link successfully sent.\' | translate }} </span> <span class=text-danger ng-if=shareCtrl.errorOnsend> <i class="fa fa-exclamation" aria-hidden=true></i> {{ \'Error, the link has not been sent.\' | translate }} </span> </div> <div class=text-right> <button type=button class="btn btn-default" data-dismiss=modal translate>Close</button> <button ng-if=::shareCtrl.enableEmail type=submit class="btn btn-default btn-primary" ng-click=shareCtrl.sendShortUrl() ng-disabled=!gmfShareForm.$valid translate>Send </button> </div> </form> </div> ');
a.put("ngeo/filter.html",'<div class=dropdown> <a class="btn btn-link dropdown-toggle ngeo-filter-condition-button" ng-class="{disabled: filterCtrl.aRuleIsActive}" type=button data-toggle=dropdown ng-disabled=filterCtrl.aRuleIsActive> <span class="fa fa-cog"></span> <span class=caret></span> </a> <ul class=dropdown-menu> <li class=ngeo-filter-condition-criteria-header translate>Criteria taken into account</li> <li ng-repeat="condition in ::filterCtrl.conditions"> <a href ng-click=filterCtrl.setCondition(condition)> <span ng-class="{\'ngeo-filter-condition-criteria-active\': condition.value == filterCtrl.datasource.filterCondition}" class="fa fa-check ngeo-filter-condition-criteria"> </span> <span>{{::condition.text | translate}}</span> </a> </li> </ul> </div> <ngeo-rule ng-repeat="rule in filterCtrl.directedRules" feature-overlay=::filterCtrl.featureOverlay class=ngeo-filter-rule-directed map=filterCtrl.map rule=rule tool-group=filterCtrl.toolGroup> </ngeo-rule> <hr class=ngeo-filter-separator-rules> <div ng-repeat="rule in filterCtrl.customRules"> <a class="btn btn-xs btn-link ngeo-filter-rule-custom-rm-btn" ng-click="!filterCtrl.aRuleIsActive && filterCtrl.removeCustomRule(rule)" ng-disabled=filterCtrl.aRuleIsActive href> <span class="fa fa-remove"></span> </a> <ngeo-rule feature-overlay=::filterCtrl.featureOverlay class=ngeo-filter-rule-custom map=filterCtrl.map rule=rule tool-group=filterCtrl.toolGroup> </ngeo-rule> </div> <div class=dropdown> <a class="btn btn-link dropdown-toggle" ng-class="{disabled: filterCtrl.aRuleIsActive}" type=button data-toggle=dropdown ng-disabled=filterCtrl.aRuleIsActive> <span translate>+ Add a new criteria</span> <span class=caret></span> </a> <ul class=dropdown-menu> <li ng-repeat="attribute in ::filterCtrl.geometryAttributes"> <a href ng-click=filterCtrl.createAndAddCustomRule(attribute)> <span translate>Spatial filter</span> </a> </li> <li role=presentation class=divider></li> <li ng-repeat="attribute in ::filterCtrl.otherAttributes"> <a href ng-click=filterCtrl.createAndAddCustomRule(attribute)> <span>{{::attribute.name | translate}}</span> </a> </li> </ul> </div> <hr class=ngeo-filter-separator-criteria> <a class="btn btn-link" type=button ng-click=filterCtrl.apply() ng-disabled="filterCtrl.hasARule() === false || filterCtrl.datasource.visible === false"> <span class="fa fa-check"></span> <span translate>Apply filter</span> </a> <a class="btn btn-link" type=button ng-click=filterCtrl.getData() ng-disabled="filterCtrl.hasARule() === false || filterCtrl.datasource.visible === false"> <span class="fa fa-chevron-right"></span> <span translate>Get data</span> </a> ');
a.put("ngeo/scaleselector.html",'<div class="btn-group btn-block" ng-class="::{\'dropup\': scaleselectorCtrl.options.dropup}"> <button type=button class="btn btn-default dropdown-toggle" data-toggle=dropdown aria-expanded=false> <span ng-bind-html="scaleselectorCtrl.currentScale | ngeoScalify | ngeoTrustHtml"></span>&nbsp;<i class=caret></i> </button> <ul class="dropdown-menu btn-block" role=menu> <li ng-repeat="zoomLevel in ::scaleselectorCtrl.zoomLevels"> <a href ng-click=scaleselectorCtrl.changeZoom(zoomLevel) ng-bind-html="scaleselectorCtrl.getScale(zoomLevel) | ngeoScalify | ngeoTrustHtml"> </a> </li> </ul> </div> ');
a.put("gmf/mobilemeasurelength.html",'<a class="btn btn-default" ng-if="ctrl.drawing && (!ctrl.valid)" ng-click=ctrl.addPoint()> <span class="fa fa-check"></span> {{\'Set as starting point\' | translate}} </a> <a class="btn btn-default" ng-if=ctrl.dirty ng-click=ctrl.addPoint()> <span class="fa fa-plus"></span> {{\'Add new point\' | translate}} </a> <a class="btn btn-default" ng-if="ctrl.drawing && ctrl.valid && !ctrl.dirty" ng-click=ctrl.finish()> <span class="fa fa-check"></span> {{\'Terminate\' | translate}} </a> <a class="btn btn-default" ng-if=ctrl.valid ng-click=ctrl.clear()> <span class="fa fa-repeat"></span> {{\'Clear\' | translate}} </a> <a class="btn btn-default" ng-if=ctrl.active ng-click=ctrl.deactivate()> <span class="fa fa-times"></span> {{\'Close\' | translate}} </a> ');
a.put("ngeomodule/import/partials/wms-get-cap-item.html",'<div class=ngeo-header-group ng-class="{\'ngeo-odd\': $odd, \'ngeo-invalid\': layer.isInvalid, \'ngeo-selected\': (options.layerSelected === layer)}" ng-mouseenter="addPreviewLayer($event, layer)" ng-mouseleave=removePreviewLayer($event) ng-click="toggleLayerSelected($event, layer)"> <button class="fa fa-zoom-in ngeo-btn" ng-disabled=!(layer.extent)></button> <button class="fa fa-plus" ng-hide=!(layer.Layer)></button> {{layer.Title}} </div> <ul class=ngeo-child-group ng-if=!!(layer.Layer)> <li ng-repeat="layer in layer.Layer | orderBy:\'Title\'"> <div ngeo-wms-get-cap-item></div> </li> </ul> ');
a.put("gmf/profile.html",'<div class="gmf-profile-container panel" ng-show=ctrl.active> <div class=ngeo-profile ng-show=!ctrl.isErrored ngeo-profile=ctrl.profileData ngeo-profile-highlight=ctrl.profileHighlight ngeo-profile-options=::ctrl.profileOptions> </div> <ul class=gmf-profile-legend ng-show=!ctrl.isErrored> <li ng-repeat="name in ::ctrl.getLayersNames()"> <i class="fa fa-minus" style=color:{{::ctrl.getColor(name)}};></i> &nbsp;{{name | translate}}&nbsp;{{ctrl.currentPoint.elevations[name]}}&nbsp;{{ctrl.currentPoint.yUnits}} </li> </ul> <div class="gmf-profile-export btn-group dropup" ng-show=!ctrl.isErrored> <a class=dropdown-toggle href ng-show="ctrl.profileData.length !== 0" data-toggle=dropdown aria-expanded=false> {{\'Export\' | translate}}&nbsp;<i class="fa fa-caret-up"></i> </a> <ul class="dropdown-menu dropdown-menu-right" role=menu> <li> <a href ng-click=::ctrl.downloadCsv()> <i class="fa fa-table"></i>&nbsp;{{\'Download CSV\' | translate}}</a> </li> </ul> </div> <div class=gmf-profile-error ng-show=ctrl.isErrored> <p>{{\'The profile service does not respond, please try later.\' | translate}}</p> </div> <div class=close ng-click="ctrl.line = null">&times;</div> </div> ');
a.put("gmf/featurestyle.html",'<div ng-if="fsCtrl.feature && fsCtrl.type"> <div class=form-group> <input ng-model=fsCtrl.getSetName ng-model-options="{getterSetter: true}" ng-attr-placeholder="{{\'Name\' | translate}}" class=form-control> </div> <div ng-if="fsCtrl.type !== \'Text\'" class=form-group> <input id=gmf-featurestyle-showlabel type=checkbox ng-model=fsCtrl.getSetShowLabel ng-model-options="{getterSetter: true}"> <label ng-switch=fsCtrl.type for=gmf-featurestyle-showlabel class=control-label> {{\'Display label\' | translate}} </label> </div> <div ng-if="fsCtrl.type !== \'Text\'" class=form-group> <input id=gmf-featurestyle-showmeasure type=checkbox ng-model=fsCtrl.getSetShowMeasure ng-model-options="{getterSetter: true}"> <label ng-switch=fsCtrl.type for=gmf-featurestyle-showmeasure class=control-label> <span ng-switch-when=Circle> {{\'Display azimuth and radius\' | translate}} </span> <span ng-switch-when=Polygon> {{\'Display surface\' | translate}} </span> <span ng-switch-when=Rectangle> {{\'Display surface\' | translate}} </span> <span ng-switch-when=LineString> {{\'Display length\' | translate}} </span> <span ng-switch-when=Point> {{\'Display coordinates\' | translate}} </span> </label> <em class=text-muted> ({{ fsCtrl.measure }}) </em> </div> </div> <div ng-if="fsCtrl.feature && fsCtrl.type" class=form-horizontal> <div class=form-group> <div ngeo-colorpicker ngeo-colorpicker-color=fsCtrl.color class=col-md-12> </div> </div> <div ng-if="fsCtrl.type === \'Point\'" class="form-group form-group-nomargin"> <label class="control-label col-md-4">{{\'Size\' | translate}}</label> <div class=col-md-8> <input type=range class=form-control min=3 max=20 step=1 ng-model=fsCtrl.getSetSize ng-model-options="{getterSetter: true}"> </div> </div> <div ng-if="fsCtrl.type === \'Text\'" class="form-group form-group-nomargin"> <label class="control-label col-md-4">{{\'Size\' | translate}}</label> <div class=col-md-8> <input type=range class=form-control min=8 max=30 step=1 ng-model=fsCtrl.getSetSize ng-model-options="{getterSetter: true}"> </div> </div> <div ng-if="fsCtrl.type === \'Circle\' || fsCtrl.type === \'LineString\' || fsCtrl.type === \'Polygon\' || fsCtrl.type === \'Rectangle\'" class="form-group form-group-nomargin"> <label class="control-label col-md-4">{{\'Stroke\' | translate}}</label> <div class=col-md-8> <input type=range class=form-control min=0.5 max=5 step=0.5 ng-model=fsCtrl.getSetStroke ng-model-options="{getterSetter: true}"> </div> </div> <div ng-if="fsCtrl.type === \'Circle\' || fsCtrl.type === \'Polygon\' || fsCtrl.type === \'Rectangle\'" class="form-group form-group-nomargin"> <label class="control-label col-md-4">{{\'Opacity\' | translate}}</label> <div class=col-md-8> <input type=range class=form-control min=0 max=1 step=0.05 ng-model=fsCtrl.getSetOpacity ng-model-options="{getterSetter: true}"> </div> </div> <div ng-if="fsCtrl.type === \'Text\'" class="form-group form-group-nomargin"> <label class="control-label col-md-4">{{\'Angle\' | translate}}</label> <div class=col-md-8> <input type=range class=form-control min=-180 max=180 step=22.5 ng-model=fsCtrl.getSetAngle ng-model-options="{getterSetter: true}"> </div> </div> </div> ');
a.put("ngeo/rule.html",'<div class=dropdown ng-class="{open: ruleCtrl.rule.active}"> <a class="btn btn-default btn-sm dropdown-toggle" type=button ng-click=ruleCtrl.toggle()> <span>{{ ::ruleCtrl.clone.name | translate }}</span> <span class=caret></span> </a> <div class="dropdown-menu form-group"> <select class="form-control input-sm ngeo-rule-operators-list" ng-disabled=ruleCtrl.drawActive ng-if=::ruleCtrl.clone.operators ng-model=ruleCtrl.clone.operator ng-options="ruleCtrl.operators[operator] | translate for operator in ::ruleCtrl.clone.operators track by operator"> </select> <div ng-switch=::ruleCtrl.clone.type> <div class="ngeo-rule-type-date form-group" ng-if=ruleCtrl.rule.active ng-switch-when=date|datetime ng-switch-when-separator=|> <div ng-switch=ruleCtrl.clone.operator> <div ng-switch-when=..> <ngeo-date-picker time=ruleCtrl.timeRangeMode on-date-selected=ruleCtrl.onDateRangeSelected(time)> </ngeo-date-picker> </div> <div ng-switch-default> <ngeo-date-picker time=ruleCtrl.timeValueMode on-date-selected=ruleCtrl.onDateSelected(time)> </ngeo-date-picker> </div> </div> </div> <div class="ngeo-rule-type-geometry form-group" ng-switch-when=geometry> <div ng-switch=ruleCtrl.geomType> <span class="gmf-icon gmf-icon-point" ng-switch-when=Point> </span> <span class="gmf-icon gmf-icon-line" ng-switch-when=LineString> </span> <span class="gmf-icon gmf-icon-polygon" ng-switch-when=Polygon> </span> <span class="gmf-icon gmf-icon-circle" ng-switch-when=Circle> </span> <span class="gmf-icon gmf-icon-rectangle" ng-switch-when=Rectangle> </span> </div> <ngeo-drawfeature ngeo-drawfeature-active=ruleCtrl.drawActive ngeo-drawfeature-features=ruleCtrl.drawnFeatures ngeo-drawfeature-map=ruleCtrl.map> <div ngeo-btn-group class=btn-group> <a data-toggle=tooltip title="{{\'Draw a point on the map\' | translate}}" href ngeo-btn ngeo-drawpoint class="btn btn-sm btn-default ngeo-drawfeature-point" ng-show="[\'intersects\', \'within\'].indexOf(ruleCtrl.clone.operator) !== -1" ng-class="{active: dfCtrl.drawPoint.active}" ng-model=dfCtrl.drawPoint.active> <span class="gmf-icon gmf-icon-point"></span> </a> <a data-toggle=tooltip title="{{\'Draw a line on the map\' | translate}}" href ngeo-btn ngeo-measurelength class="btn btn-sm btn-default ngeo-drawfeature-linestring" ng-show="[\'intersects\', \'within\'].indexOf(ruleCtrl.clone.operator) !== -1" ng-class="{active: dfCtrl.measureLength.active}" ng-model=dfCtrl.measureLength.active> <span class="gmf-icon gmf-icon-line"></span> </a> <a data-toggle=tooltip title="{{\'Draw a polygon on the map\' | translate}}" href ngeo-btn ngeo-measurearea class="btn btn-sm btn-default ngeo-drawfeature-polygon" ng-class="{active: dfCtrl.measureArea.active}" ng-model=dfCtrl.measureArea.active> <span class="gmf-icon gmf-icon-polygon"></span> </a> <a data-toggle=tooltip title="{{\'Draw a circle on the map\' | translate}}" href ngeo-btn ngeo-measureazimut class="btn btn-sm btn-default ngeo-drawfeature-circle" ng-class="{active: dfCtrl.measureAzimut.active}" ng-model=dfCtrl.measureAzimut.active> <span class="gmf-icon gmf-icon-circle"></span> </a> <a data-toggle=tooltip title="{{\'Draw a rectangle on the map\' | translate}}" href ngeo-btn ngeo-drawrectangle class="btn btn-sm btn-default ngeo-drawfeature-rectangle" ng-class="{active: dfCtrl.drawRectangle.active}" ng-model=dfCtrl.drawRectangle.active> <span class="gmf-icon gmf-icon-rectangle"></span> </a> </div> <div class=ngeo-rule-type-geometry-instructions ng-if=ruleCtrl.drawActive> <span ng-if=dfCtrl.drawPoint.active> {{ \'Draw a point on the map.\' | translate }} </span> <span ng-if=dfCtrl.measureLength.active> {{ \'Draw a line string on the map.\' | translate }} </span> <span ng-if=dfCtrl.measureArea.active> {{ \'Draw a polygon on the map.\' | translate }} </span> <span ng-if=dfCtrl.measureAzimut.active> {{ \'Draw a circle on the map.\' | translate }} </span> <span ng-if=dfCtrl.drawRectangle.active> {{ \'Draw a rectangle on the map.\' | translate }} </span> </div> </ngeo-drawfeature> </div> <div class="checkbox ngeo-rule-type-select" ng-switch-when=select> <a ng-click=ruleCtrl.selectAllChoices() href>{{ All | translate}} </a> <label class="form-group ol-unselectable" ng-repeat="choice in ::ruleCtrl.clone.choices"> <input ng-checked="ruleCtrl.clone.getExpression() && ruleCtrl.clone.getExpression().split(\',\').indexOf(choice) > -1" ng-click=ruleCtrl.toggleChoiceSelection(choice) type=checkbox value=choice> <span>{{ choice | translate }}</span> </label> </div> <div class="form-group ngeo-rule-type-text" ng-switch-default> <div ng-switch=ruleCtrl.clone.operator> <div ng-switch-when=..> <input type=number class="form-control input-sm" ng-model=ruleCtrl.clone.lowerBoundary> <input type=number class="form-control input-sm" ng-model=ruleCtrl.clone.upperBoundary> </div> <div ng-switch-default> <input type=number class="form-control input-sm" ng-if="ruleCtrl.clone.type === \'number\'" ng-model=ruleCtrl.clone.expression> <input type=text class="form-control input-sm" ng-if="ruleCtrl.clone.type !== \'number\'" ng-model=ruleCtrl.clone.expression> </div> </div> </div> <div class=ngeo-rule-btns> <button class="btn btn-xs btn-default" ng-click=ruleCtrl.apply() type=button>{{\'Apply\' | translate}}</button> <button class="btn btn-xs btn-default" ng-click=ruleCtrl.cancel() type=button>{{\'Cancel\' | translate}}</button> </div> </div> </div> </div> <div class=ngeo-rule-value ng-if="ruleCtrl.rule.value !== null"> <a class="btn btn-xs btn-link" ng-click="!ruleCtrl.rule.active && ruleCtrl.reset()" ng-disabled=ruleCtrl.rule.active href> <span class="fa fa-remove"></span> </a> <div ng-switch=::ruleCtrl.rule.type> <div ng-switch-when=date|datetime ng-switch-when-separator=|> <div ng-switch=ruleCtrl.rule.operator> <div ng-switch-when=..> <span translate>From </span> <span>{{ ruleCtrl.timeToDate(ruleCtrl.rule.lowerBoundary) }}</span> <span translate> to </span> <span>{{ ruleCtrl.timeToDate(ruleCtrl.rule.upperBoundary) }}</span> </div> <div ng-switch-default> <span>{{ ruleCtrl.operatorsShortFormat[ruleCtrl.rule.operator] }}</span> <span>{{ ruleCtrl.timeToDate(ruleCtrl.rule.getExpression()) }}</span> </div> </div> </div> <div ng-switch-when=geometry> <span>{{ ruleCtrl.operators[ruleCtrl.rule.operator] }}</span> <span ng-switch=ruleCtrl.getRuleGeometryType()> <span class="gmf-icon gmf-icon-point" ng-switch-when=Point> </span> <span class="gmf-icon gmf-icon-line" ng-switch-when=LineString> </span> <span class="gmf-icon gmf-icon-polygon" ng-switch-when=Polygon> </span> <span class="gmf-icon gmf-icon-circle" ng-switch-when=Circle> </span> <span class="gmf-icon gmf-icon-rectangle" ng-switch-when=Rectangle> </span> </span> </div> <div ng-switch-when=select> <span ng-repeat="choice in ruleCtrl.rule.getExpression().split(\',\')"> {{ choice | translate }}{{ $last ? \'\' : \', \' }} </span> </div> <div ng-switch-default> <div ng-switch=ruleCtrl.rule.operator> <div ng-switch-when=..> <span translate>Between </span> <span>{{ ruleCtrl.rule.lowerBoundary }}</span> <span translate> and </span> <span>{{ ruleCtrl.rule.upperBoundary }}</span> </div> <div ng-switch-default> <span>{{ ruleCtrl.operatorsShortFormat[ruleCtrl.rule.operator] }}</span> <span>{{ ruleCtrl.rule.getExpression() }}</span> </div> </div> </div> </div> </div> ');
a.put("gmf/displayquerygrid.html",'<div class="gmf-displayquerygrid panel" ng-show=ctrl.active> <div class=close ng-click=ctrl.clear()> &times; </div> <ul class="nav nav-pills small" role=tablist> <li ng-repeat="gridSource in ctrl.getGridSources() track by gridSource.source.label" role=presentation ng-class="{\'active\' : ctrl.isSelected(gridSource)}" ng-click=ctrl.selectTab(gridSource)> <a href=#{{ctrl.escapeValue(gridSource.source.label)}} data-target=#{{ctrl.escapeValue(gridSource.source.label)}} aria-controls={{ctrl.escapeValue(gridSource.source.label)}} role=tab data-toggle=tab> <span ng-if="gridSource.source.tooManyResults !== true"> {{gridSource.source.label | translate}} ({{gridSource.source.features.length}}) </span> <span ng-if="gridSource.source.tooManyResults === true"> {{gridSource.source.label | translate}} ({{gridSource.source.totalFeatureCount}}*) </span> </a> </li> </ul> <div class=tab-content> <div ng-repeat="gridSource in ctrl.getGridSources() track by gridSource.source.label" role=tabpanel class=tab-pane ng-class="{\'active\' : ctrl.isSelected(gridSource)}" id={{ctrl.escapeValue(gridSource.source.label)}}> <ngeo-grid ngeo-grid-configuration=gridSource.configuration ng-if="gridSource.source.tooManyResults !== true"> </ngeo-grid> <div ng-if="gridSource.source.tooManyResults === true"> <div class="gmf-displayquerygrid-message alert alert-warning"> <p><span translate>The results can not be displayed because the maximum number has been reached</span> ({{gridSource.source.limit}}).</p> <p translate>Please refine your query.</p> </div> </div> </div> </div> <div class=navbar ng-show="!ctrl.pending && ctrl.getActiveGridSource() && ctrl.getActiveGridSource().configuration !== null"> <ul class="nav navbar-nav navbar-right"> <li class="small ng-hide" ng-show=ctrl.isOneSelected()> <p class="navbar-text ng-binding"> {{ctrl.getSelectedRowCount()}} <span translate>selected element(s)</span> </p> </li> <li ng-show=ctrl.isOneSelected() class=ng-hide> <button class="btn btn-link btn-xs" title="{{\'Zoom to selection\' | translate}}" ng-click=ctrl.zoomToSelection()> <i class="fa fa-search-plus"></i> <span translate>Zoom to</span> </button> </li> <li ng-show=ctrl.isOneSelected() class=ng-hide> <button class="btn btn-link btn-xs" title="{{\'Export selection as CSV\' | translate}}" ng-click=ctrl.downloadCsv()> <i class="fa fa-download"></i> <span translate>Export as CSV</span> </button> </li> <li class="dropdown navbar-link dropup"> <button type=button class="dropup btn btn-default btn-xs" data-toggle=dropdown aria-haspopup=true aria-expanded=false> <span translate>Select</span> <span class=caret></span> </button> <ul class=dropdown-menu aria-labelledby=dLabel> <li> <a href ng-click=ctrl.selectAll() translate>All</a> </li> <li> <a href ng-click=ctrl.unselectAll() translate>None</a> </li> <li> <a href ng-click=ctrl.invertSelection() translate>Reverse selection</a> </li> </ul> </li> </ul> </div> <div ng-show=ctrl.pending class=gmf-displayquerygrid-pending> <span class="fa fa-spinner fa-spin"></span> </div> </div> ');
a.put("gmf/mouseposition.html",'<div class="btn-group dropup"> <a type=button class="btn btn-default dropdown-toggle" data-toggle=dropdown aria-expanded=false> <span class=gmf-mouseposition-control-target></span> <span class=caret></span> </a> <ul class="dropdown-menu dropdown-menu-right" role=menu> <li class=dropdown-header translate>Coordinate systems</li> <li ng-repeat="projitem in ::ctrl.projections"> <a href ng-click=ctrl.setProjection(projitem)> <span class="fa fa-fw" ng-class="{\'fa-check\': ctrl.projection == projitem}"></span> {{::projitem.label}} </a> </li> </ul> </div> ');
a.put("gmf/editfeatureselector.html",'<div ng-switch=efsCtrl.selectedEditableTreeCtrl> <div ng-switch-when=null> <select class=form-control ng-model=efsCtrl.selectedEditableTreeCtrl ng-show="efsCtrl.editableTreeCtrls.length > 0" ng-options="treeCtrl.node.name | translate for treeCtrl in efsCtrl.editableTreeCtrls"> <option value translate>-- Choose a layer --</option> </select> <span ng-show="efsCtrl.editableTreeCtrls.length == 0" translate>No editable layer available!</span> </div> <div ng-switch-default> <div class=row> <div class=col-sm-12> <span translate>Currently editing: </span> <b>{{ efsCtrl.selectedEditableTreeCtrl.node.name | translate }}</b> <span class="fa fa-pencil"></span> <br> <button ng-click=efsCtrl.stopEditing() class="btn btn-link btn-xs pull-right"> <span class="fa fa-times"></span> {{\'Stop editing\' | translate}} </button> </div> </div> <gmf-editfeature gmf-editfeature-dirty=efsCtrl.dirty gmf-editfeature-editabletreectrl=::efsCtrl.selectedEditableTreeCtrl gmf-editfeature-map=::efsCtrl.map gmf-editfeature-state=efsCtrl.state gmf-editfeature-tolerance=::efsCtrl.tolerance gmf-editfeature-vector=::efsCtrl.vectorLayer> </gmf-editfeature> </div> </div> ');
a.put("gmf/objecteditingtools.html",'<div class=btn-group role=group aria-label> <a href ngeo-btn ngeo-createfeature ngeo-createfeature-active=oetCtrl.drawActive ngeo-createfeature-features=::oetCtrl.sketchFeatures ngeo-createfeature-geom-type=::oetCtrl.geomType ngeo-createfeature-map=::oetCtrl.map class="btn btn-sm btn-default" ng-class="{active: oetCtrl.drawActive}" ng-if="::(oetCtrl.geomType === \'MultiPoint\')" ng-model=oetCtrl.drawActive title="{{\'Add a point to the geometry\' | translate}}"> <span class="fa fa-plus-square-o gmf-icon-oe-draw"> </span> </a> <a href ngeo-btn ngeo-createfeature ngeo-createfeature-active=oetCtrl.drawActive ngeo-createfeature-features=::oetCtrl.sketchFeatures ngeo-createfeature-geom-type=::oetCtrl.geomType ngeo-createfeature-map=::oetCtrl.map class="btn btn-sm btn-default" ng-class="{active: oetCtrl.drawActive}" ng-if="::(oetCtrl.geomType === \'MultiLineString\')" ng-model=oetCtrl.drawActive title="{{\'Add a linestring to the geometry\' | translate}}"> <span class="fa fa-plus-square-o gmf-icon-oe-draw"> </span> </a> <a href ngeo-btn ngeo-createfeature ngeo-createfeature-active=oetCtrl.drawActive ngeo-createfeature-features=::oetCtrl.sketchFeatures ngeo-createfeature-geom-type=::oetCtrl.geomType ngeo-createfeature-map=::oetCtrl.map class="btn btn-sm btn-default" ng-class="{active: oetCtrl.drawActive}" ng-if="::(oetCtrl.geomType === \'MultiPolygon\')" ng-model=oetCtrl.drawActive title="{{\'Add a polygon to the geometry\' | translate}}"> <span class="fa fa-plus-square-o gmf-icon-oe-draw"> </span> </a> <a href ngeo-btn ngeo-createfeature ngeo-createfeature-active=oetCtrl.eraseActive ngeo-createfeature-features=::oetCtrl.sketchFeatures ngeo-createfeature-geom-type=::oetCtrl.geomTypePolygon ngeo-createfeature-map=::oetCtrl.map class="btn btn-sm btn-default" ng-class="{active: oetCtrl.eraseActive}" ng-model=oetCtrl.eraseActive title="{{\'Erase geometry\' | translate}}"> <span class="fa fa-minus-square-o gmf-icon-oe-erase"> </span> </a> <a href ng-if="::oetCtrl.geomType === \'MultiPolygon\'" ngeo-btn ngeo-createregularpolygonfromclick ngeo-createregularpolygonfromclick-active=oetCtrl.drawTriangleActive ngeo-createregularpolygonfromclick-angle=oetCtrl.triangleAngle ngeo-createregularpolygonfromclick-features=::oetCtrl.sketchFeatures ngeo-createregularpolygonfromclick-map=::oetCtrl.map ngeo-createregularpolygonfromclick-radius=::oetCtrl.triangleRadius class="btn btn-sm btn-default ngeo-createregularpolygonfromclick" ng-class="{active: oetCtrl.drawTriangleActive}" ng-model=oetCtrl.drawTriangleActive title="{{\'Draw a triangle\' | translate}}"> <span class="fa fa-play fa-rotate-270 gmf-icon-oe-triangle"> </span> </a> <a href ngeo-btn gmf-objecteditinggetwmsfeature gmf-objecteditinggetwmsfeature-active=oetCtrl.copyFromActive gmf-objecteditinggetwmsfeature-features=::oetCtrl.sketchFeatures gmf-objecteditinggetwmsfeature-layerinfo=oetCtrl.queryableLayerInfo gmf-objecteditinggetwmsfeature-map=::oetCtrl.map class="btn btn-sm btn-default gmf-objecteditinggetwmsfeature-add" ng-class="{active: oetCtrl.copyFromActive}" ng-model=oetCtrl.copyFromActive title="{{\'Copy from external WMS feature\' | translate}}"> <span class="fa fa-clone gmf-icon-oe-copyfrom"> </span> </a> <a href ngeo-btn gmf-objecteditinggetwmsfeature gmf-objecteditinggetwmsfeature-active=oetCtrl.deleteFromActive gmf-objecteditinggetwmsfeature-features=::oetCtrl.sketchFeatures gmf-objecteditinggetwmsfeature-layerinfo=oetCtrl.queryableLayerInfo gmf-objecteditinggetwmsfeature-map=::oetCtrl.map class="btn btn-sm btn-default gmf-objecteditinggetwmsfeature-delete" ng-class="{active: oetCtrl.deleteFromActive}" ng-model=oetCtrl.deleteFromActive title="{{\'Cut from external WMS feature\' | translate}}"> <span class="fa fa-scissors gmf-icon-oe-deletefrom"> </span> </a> </div> ');
a.put("ngeomodule/import/partials/import-online.html",'<form class="form-group form-group-sm"> <input type=url name=url autocomplete=off placeholder="{{\'Choose or enter online resource URL\' | translate}}" ng-model=fileUrl required class=form-control> <div class="ngeo-import-open fa fa-collapse"></div> </form> <div class=tabbable-footer> <button type=button class="btn btn-default btn-sm" ng-class="{\'btn-danger\': canceler}" ng-disabled="!fileUrl || !isValid(fileUrl) || (loading && !canceler)" ng-click="loading ? cancel() : handleFileUrl()"> <span>{{userMessage | translate}}</span> </button> </div> ');
a.put("ngeomodule/import/partials/import-local.html",'<div class="input-group input-group-sm"> <input type=file name=file> <input class=form-control type=text readonly value="{{(file.name) ? file.name + \', \' + file.size/1000 + \' ko\' : \'\'}}" placeholder="{{\'No file\' | translate}}"> <span class=input-group-btn> <button type=button class="btn btn-default ngeo-import-browse" translate>Browse</button> </span> </div> <div ng-hide=isValid(file) class=ngeo-error translate>File too large</div> <div class=tabbable-footer> <button type=button class="btn btn-default btn-sm ngeo-load" ng-class="{\'btn-danger\': loading}" ng-disabled="!isValid(file) || (loading && !fileReader)" ng-click="loading ? cancel() : handleFile()"> <span>{{userMessage | translate}}</span> </button> </div> ');
a.put("gmf/displayquerywindow.html",'<div class=gmf-displayquerywindow ng-class="{\'gmf-displayquerywindow-desktop\': ctrl.desktop, \'gmf-displayquerywindow-mobile\': !ctrl.desktop}" ng-show=ctrl.open ng-swipe-disable-mouse ng-swipe-left=ctrl.next() ng-swipe-right=ctrl.previous()> <button class=gmf-displayquerywindow-collapse-button type=button ng-show=::!ctrl.desktop ng-click="ctrl.collapsed = !ctrl.collapsed" ng-class="[ctrl.collapsed ? \'gmf-displayquerywindow-collapse-button-up\' : \'gmf-displayquerywindow-collapse-button-down\']"> </button> <div class=gmf-displayquerywindow-container> <button type=button class="btn fa-close close" ng-click=ctrl.close()> </button> <div class=gmf-displayquerywindow-animation-container ng-class="[ctrl.collapsed ? \'\' : \'gmf-displayquerywindow-animation-container-detailed\', ctrl.isNext ? \'gmf-displayquerywindow-next\' : \'gmf-displayquerywindow-previous\']"> <div ng-animate-swap=ctrl.animate class="gmf-displayquerywindow-slide-animation gmf-animatable"> <div class=gmf-displayquerywindow-header> <p class=gmf-displayquerywindow-title>{{ctrl.source.label | translate}}</p> <p class=gmf-displayquerywindow-subtitle>{{ctrl.getFeatureValues()[ctrl.source.identifierAttributeField]}}</p> </div> <div class=gmf-displayquerywindow-details> <table> <tr ng-repeat="(key, value) in ctrl.getFeatureValues()" ng-if="value !== undefined"> <td class=gmf-displayquerywindow-details-key ng-bind-html="key | translate | ngeoTrustHtml"></td> <td class=gmf-displayquerywindow-details-value ng-bind-html="value | ngeoTrustHtml"></td> </tr> </table> </div> </div> </div> <div class=gmf-displayquerywindow-navigate> <div class=gmf-displayquerywindow-placeholder> <button type=button class="gmf-displayquerywindow-previous btn" ng-disabled=ctrl.isFirst() ng-show="ctrl.getResultLength() > 1" ng-click=ctrl.previous()> <span ng-show=::ctrl.desktop>{{\'Prev.\' | translate}}</span> </button> </div> <div class=gmf-displayquerywindow-results> <span ng-show=::!ctrl.desktop>{{\'Result\' | translate}}</span> <span>{{ctrl.currentResult + 1}}</span> <span>/</span> <span>{{ctrl.getResultLength()}}</span> <div ng-show=::ctrl.desktop class=dropup> <button type=button class="btn btn-default dropdown-toggle" data-toggle=dropdown aria-expanded=false> <span class="fa fa-filter"></span> <span class="fa fa-caret-up"></span> </button> <ul class="dropdown-menu dropdown-menu-right" role=menu> <li> <a href=# ng-click=ctrl.setSelectedSource(null)> <i class="fa fa-fw" ng-class="{\'fa-check\': ctrl.selectedSource === null}"> </i> <span>{{\'All layers\' | translate}} ({{ctrl.ngeoQueryResult.total}})</span> </a> </li> <li role=separator class=divider> </li> <li ng-repeat-start="source in ctrl.ngeoQueryResult.sources | filter: ctrl.sourcesFilter" ng-repeat-end ng-class="{\'disabled\': source.features.length <= 0}"> <a href=# ng-click=ctrl.setSelectedSource(source)> <i class="fa fa-fw" ng-class="{\'fa-check\': ctrl.selectedSource === source}"> </i> <span>{{source.label | translate}} ({{source.features.length}})</span> </a> </li> </ul> </div> </div> <div class=gmf-displayquerywindow-placeholder> <button type=button class="gmf-displayquerywindow-next btn" ng-disabled=ctrl.isLast() ng-show="ctrl.getResultLength() > 1" ng-click=ctrl.next()> <span ng-show=::ctrl.desktop>{{\'Next\' | translate}}</span> </button> </div> </div> </div> </div> ');
a.put("gmf/elevationwidget.html",'<div class="text-center btn-group dropup" gmf-elevation gmf-elevation-active=ctrl.active gmf-elevation-elevation=ctrl.elevationValue gmf-elevation-loading=ctrl.elevationLoading gmf-elevation-layer=ctrl.selectedElevationLayer gmf-elevation-map=::ctrl.map> <a type=button class="btn btn-default" aria-expanded=false ng-class="::{\'dropdown-toggle\': ctrl.layers.length > 1}" ng-attr-data-toggle="{{::(ctrl.layers.length > 1) ? \'dropdown\' : \'\'}}"> <span class=gmf-elevationwidget-value> {{ctrl.elevationValue | number}}<span ng-show=ctrl.elevationValue> m</span> <span ng-show=ctrl.elevationLoading class="fa fa-spinner"></span> <span ng-show="!ctrl.elevationValue && !ctrl.elevationLoading" translate>Elevation\u2026</span> </span><span class=caret ng-if="::ctrl.layers.length > 1"></span> </a> <ul class="dropdown-menu dropdown-menu-right" role=menu ng-if="::ctrl.layers.length > 1"> <li class=dropdown-header translate>Elevation data sources</li> <li ng-repeat="elevationItem in ::ctrl.layers"> <a href ng-click="ctrl.selectedElevationLayer = elevationItem"> <span class="fa fa-fw" ng-class="{\'fa-check\': ctrl.selectedElevationLayer === elevationItem}"></span> {{::elevationItem | translate}} </a> </li> </ul> </div> ');
a.put("gmf/timeslider.html",'<div class=gmf-time-slider> <div ui-slider=sliderCtrl.sliderOptions ng-model=sliderCtrl.dates> <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex=0 data-toggle=tooltip title> </span> </div> <div class=gmf-time-slider-displayed-dates> <div class=gmf-time-slider-start-date ng-if="::sliderCtrl.time.mode === \'range\'"> <span>{{sliderCtrl.getLocalizedDate(sliderCtrl.dates[0])}}</span> </div> <div class=gmf-time-slider-start-date ng-if="::sliderCtrl.time.mode === \'value\'"> <span>{{sliderCtrl.getLocalizedDate(sliderCtrl.dates)}}</span> </div> <div class=gmf-time-slider-end-date ng-if="::sliderCtrl.time.mode === \'range\'"> <span>{{sliderCtrl.getLocalizedDate(sliderCtrl.dates[1])}}</span> </div> </div> </div> ');
a.put("gmf/backgroundlayerselector.html",'<ul class=gmf-backgroundlayerselector> <li ng-repeat="layer in ctrl.bgLayers" ng-click=ctrl.setLayer(layer) ng-class="{\'gmf-backgroundlayerselector-active\': ctrl.bgLayer == layer, \'gmf-backgroundlayerselector-disabled\': ctrl.opacityLayer == layer}"> <img class=gmf-thumb ng-src="{{::layer.get(\'metadata\')[\'thumbnail\']}}"> <span class=gmf-text>{{layer.get("label") | translate}}</span> <span ng-class="{\'gmf-backgroundlayerselector-opacity-check\': ctrl.opacityLayer == layer}"></span> </li> <input ng-if=ctrl.opacityLayer class="input-action gmf-backgroundlayerselector-opacity-slider" name=bg-layer-opacity type=range min=0 max=1 step=0.01 ng-model=ctrl.getSetBgLayerOpacity ng-model-options="{getterSetter: true}"> </ul> ');
a.put("ngeomodule/olcs/controls3d.html",'<div class=ngeo-tools> <div class=ngeo-angle><div class=ngeo-angle3d></div></div> <button class="ngeo-left ngeo-tilt-left" ng-click=$ctrl.tilt(5)></button> <button class="ngeo-right ngeo-tilt-right" ng-click=$ctrl.tilt(-5)></button> </div> <div class=ngeo-zoom> <button class=ol-zoom-in ng-click=$ctrl.zoom(1)></button> <button class=ol-zoom-out ng-click=$ctrl.zoom(-1)></button> </div> <div class=ngeo-tools> <div class=ngeo-rotation><div class=ngeo-rotation3d></div></div> <button class=ngeo-left ng-click=$ctrl.rotate(-15)></button> <button class=ngeo-right ng-click=$ctrl.rotate(15)></button> </div> ');
a.put("gmf/themeselector.html",'<ul class=gmf-theme-selector> <li ng-repeat="theme in tsCtrl.themes" ng-click=tsCtrl.setTheme(theme) ng-class="{\'gmf-theme-selector-active\': tsCtrl.gmfThemeManager.getThemeName() == theme.name}"> <img class=gmf-thumb ng-src={{::theme.icon}}> <span class=gmf-text>{{theme.name | translate}}</span> </li> </ul> ');a.put("ngeo/layertree.html",'<span ng-if=::!layertreeCtrl.isRoot>{{::layertreeCtrl.node.name}}</span> <input type=checkbox ng-if="::layertreeCtrl.node && !layertreeCtrl.node.children" ng-model=layertreeCtrl.getSetActive ng-model-options="{getterSetter: true}"> <ul ng-if=::layertreeCtrl.node.children> <li ng-repeat="node in ::layertreeCtrl.node.children" ngeo-layertree=::node ngeo-layertree-notroot ngeo-layertree-map=layertreeCtrl.map ngeo-layertree-nodelayerexpr=layertreeCtrl.nodelayerExpr ngeo-layertree-listenersexpr=layertreeCtrl.listenersExpr> </li> </ul> ');
a.put("ngeo/colorpicker.html",'<table class=ngeo-colorpicker-palette> <tr ng-repeat="colors in ::ctrl.colors"> <td ng-repeat="color in ::colors" ng-click=ctrl.setColor(color) ng-class="{\'ngeo-colorpicker-selected\': color == ctrl.color}"> <div ng-style="::{\'background-color\': color}"></div> </td> </tr> </table> ');a.put("gmf/search.html",'<div class=gmf-search> <input type=text ng-attr-placeholder={{ctrl.placeholder}} class=form-control ng-model=ctrl.inputValue ngeo-search=ctrl.options ngeo-search-datasets=ctrl.datasets ngeo-search-listeners=ctrl.listeners> <span class="gmf-clear-button ng-hide" ng-hide="!ctrl.clearButton || ctrl.inputValue == \'\'" ng-click=ctrl.onClearButton()> </span> </div> <span ng-if=ctrl.colorchooser> <span ng-show=ctrl.displayColorPicker ngeo-popover ngeo-popover-placement=bottom> <button class="gmf-color-button fa fa-tint" ngeo-popover-anchor data-original-title="{{\'Change the color of the search result\'|translate}}"></button> <div ngeo-popover-content> <div ngeo-colorpicker ngeo-colorpicker-color=ctrl.color></div> </div> </span> </span> ')};
a.$inject=["$templateCache"];gmf.module.run(a)})();var olx;}).call(window);
//# sourceMappingURL=desktop_alt.js.map
