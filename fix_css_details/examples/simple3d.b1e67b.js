!function(t){function e(e){for(var i,r,l=e[0],s=e[1],u=e[2],m=0,d=[];m<l.length;m++)r=l[m],o[r]&&d.push(o[r][0]),o[r]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i]);for(c&&c(e);d.length;)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,l=1;l<n.length;l++){var s=n[l];0!==o[s]&&(i=!1)}i&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var i={},o={41:0},a=[];function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=e,l=l.slice();for(var u=0;u<l.length;u++)e(l[u]);var c=s;a.push([519,0]),n()}({519:function(t,e,n){n(53),n(54),t.exports=n(526)},520:function(t,e){},521:function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="ngeo-tools">\n  <div class="ngeo-angle"><div class="ngeo-angle3d"></div></div>\n  <button class="ngeo-left ngeo-tilt-left" ng-click="$ctrl.tilt(5)"></button>\n  <button class="ngeo-right ngeo-tilt-right" ng-click="$ctrl.tilt(-5)"></button>\n</div>\n<div class="ngeo-zoom">\n  <button class="ol-zoom-in" ng-click="$ctrl.zoom(1)"></button>\n  <button class="ol-zoom-out" ng-click="$ctrl.zoom(-1)"></button>\n</div>\n<div class="ngeo-tools">\n  <div class="ngeo-rotation"><div class="ngeo-rotation3d"></div></div>\n  <button class="ngeo-left" ng-click="$ctrl.rotate(-15)"></button>\n  <button class="ngeo-right" ng-click="$ctrl.rotate(15)"></button>\n</div>\n';return __p}},526:function(t,e,n){"use strict";n.r(e);n(520);var i=n(18),o=n(25),a=n(17),r=n(31),l=n(1),s=n(138),u=n(220),c={Permalink3dParam:{ENABLED:"3d_enabled",LON:"3d_lon",LAT:"3d_lat",ELEVATION:"3d_elevation",HEADING:"3d_heading",PITCH:"3d_pitch",PREFIX:"3d_"}},m=c,d=n(278);var g=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.manager_,this.ngeoDebounce_=e,this.ngeoLocation_=n,this.ngeoStateManager_=i}return t.$inject=["ngeoDebounce","ngeoLocation","ngeoStateManager"],t.prototype.initialize=function(t){var e=this;this.manager_=t,this.manager_.on("load",function(){e.cameraToState_()}),this.ngeoStateManager_.getInitialBooleanValue("3d_enabled")&&this.initialStateToCamera_()},t.prototype.getManager=function(){return this.manager_},t.prototype.initialStateToCamera_=function(){var t=this.ngeoStateManager_,e=t.getInitialNumberValue(m.Permalink3dParam.LON),n=t.getInitialNumberValue(m.Permalink3dParam.LAT),i=t.getInitialNumberValue(m.Permalink3dParam.ELEVATION),o=t.getInitialNumberValue(m.Permalink3dParam.HEADING)||0,a=t.getInitialNumberValue(m.Permalink3dParam.PITCH)||0;return l.a.assert(void 0!==e),l.a.assert(void 0!==n),l.a.assert(void 0!==i),this.manager_.set3dWithView(e,n,i,o,a)},t.prototype.cameraToState_=function(){var t=this,e=this.manager_.getOl3d().getCesiumScene().camera;e.moveEnd.addEventListener(this.ngeoDebounce_(function(){var n,i=e.positionCartographic;t.ngeoStateManager_.updateState(((n={})[m.Permalink3dParam.ENABLED]=!0,n[m.Permalink3dParam.LON]=Cesium.Math.toDegrees(i.longitude).toFixed(5),n[m.Permalink3dParam.LAT]=Cesium.Math.toDegrees(i.latitude).toFixed(5),n[m.Permalink3dParam.ELEVATION]=i.height.toFixed(0),n[m.Permalink3dParam.HEADING]=Cesium.Math.toDegrees(e.heading).toFixed(3),n[m.Permalink3dParam.PITCH]=Cesium.Math.toDegrees(e.pitch).toFixed(3),n))},1e3,!0)),this.manager_.on("toggle",function(e){e.target.is3dEnabled()||t.remove3dState_()})},t.prototype.remove3dState_=function(){var t=this;this.ngeoLocation_.getParamKeysWithPrefix(m.Permalink3dParam.PREFIX).forEach(function(e){t.ngeoStateManager_.deleteParam(e)})},t}();g.module=angular.module("ngeoOlcsService",[s.a.name,u.a.module.name,d.a.module.name]).service("ngeoOlcsService",g);var h=g,f=n(72),p=n(65);b.$inject=["$attrs","ngeoOlcsControls3dTemplateUrl"];var _=angular.module("ngeoOlcsControls3d",[]);var v=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element_=e,this.ol3dm,this.minTilt,this.maxTilt,this.tiltRightEl_,this.tiltLeftEl_,this.rotation3dEl_,this.angle3dEl_,this.previousRotation_,this.previousViewMatrix_,this.animationFrameRequestId_,this.olcsService_=n}return t.$inject=["$element","ngeoOlcsService"],t.prototype.updateWidget_=function(){var t=this,e=this.ol3dm.getOl3d().getOlView().getRotation();(function(t,e){return Number.isFinite(e)&&(!Number.isFinite(t)||Math.abs(e-t)>.05)})(this.previousRotation_,e)&&(this.rotateElement_(this.rotation3dEl_,e),this.previousRotation_=e);var n=this.ol3dm.getCesiumViewMatrix();if(!Cesium.Matrix4.equalsEpsilon(this.previousViewMatrix_,n,1e-5)){var i=this.ol3dm.getTiltOnGlobe();if(Number.isFinite(i||0)){this.rotateElement_(this.angle3dEl_,i),this.previousViewMatrix_=Cesium.Matrix4.clone(n);i-this.minTilt<.01?this.tiltRightEl_.addClass("ngeo-right-inactive"):this.tiltRightEl_.hasClass("ngeo-right-inactive")&&this.tiltRightEl_.removeClass("ngeo-right-inactive"),this.maxTilt-i<.01?this.tiltLeftEl_.addClass("ngeo-left-inactive"):this.tiltLeftEl_.hasClass("ngeo-left-inactive")&&this.tiltLeftEl_.removeClass("ngeo-left-inactive")}}this.animationFrameRequestId_=requestAnimationFrame(function(){return t.updateWidget_()})},t.prototype.$onDestroy=function(){this.animationFrameRequestId_&&cancelAnimationFrame(this.animationFrameRequestId_)},t.prototype.$onInit=function(){void 0===this.minTilt&&(this.minTilt=0),void 0===this.maxTilt&&(this.maxTilt=7*Math.PI/16),this.ol3dm||(this.ol3dm=l.a.assert(this.olcsService_.getManager())),this.tiltRightEl_=this.element_.find(".ngeo-tilt-right"),this.tiltLeftEl_=this.element_.find(".ngeo-tilt-left"),this.rotation3dEl_=this.element_.find(".ngeo-rotation3d"),this.angle3dEl_=this.element_.find(".ngeo-angle3d"),this.updateWidget_()},t.prototype.rotateElement_=function(t,e){var n="rotate("+e+"rad)";t.css({"-moz-transform":n,"-webkit-transform":n,"-o-transform":n,"-ms-transform":n,transform:n})},t.prototype.rotate=function(t){t=Cesium.Math.toRadians(t),this.ol3dm.setHeading(t)},t.prototype.tilt=function(t){t=Cesium.Math.toRadians(t);var e=this.ol3dm.getTiltOnGlobe();e+t<this.minTilt?t=this.minTilt-e:e+t>this.maxTilt&&(t=this.maxTilt-e);var n=this.ol3dm.getCesiumScene();p.a.rotateAroundBottomCenter(n,t)},t.prototype.zoom=function(t){var e=this.ol3dm.getOlView(),n=e.getResolution(),i=e.constrainResolution(n,t);e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:i,duration:250,easing:f.b})},t}();function b(t,e){if(e)return e;var n=t.ngeoOlcsControls3dTemplateUrl;return n||"ngeo/olsc/controls3d"}_.run(["$templateCache",function(t){t.put("ngeo/olsc/controls3d",n(521))}]);var y={bindings:{minTilt:"<?",maxTilt:"<?",ol3dm:"<?"},controller:v,templateUrl:b};_.component("ngeoOlcsControls3d",y),_.value("ngeoOlcsControls3dTemplateUrl","");var E=_,P=angular.module("ngeoOlcsModule",[E.name,h.module.name]),C=n(22);var T=function(t){function e(n,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return a.rootScope_=i,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.toggle3d=function(){var e=this;return t.prototype.toggle3d.call(this).then(function(){e.rootScope_.$apply()})},e}(n(326).a),O={};O.module=angular.module("app",["gettext",C.a.name,P.name]),O.MainController=function(t,e){this.map=new i.a({layers:[new a.a({source:new r.b})],view:new o.a({center:[0,0],zoom:4})});this.ol3dm=new T("../node_modules/@camptocamp/cesium/Build/Cesium/Cesium.js",t,{map:this.map}),e.initialize(this.ol3dm)},O.MainController.$inject=["$rootScope","ngeoOlcsService"],O.module.controller("MainController",O.MainController);e.default=O}});
//# sourceMappingURL=simple3d.b1e67b.js.map