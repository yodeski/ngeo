{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./contribs/gmf/src/objectediting/toolsComponent.html","webpack:///./contribs/gmf/src/objectediting/component.html","webpack:///./contribs/gmf/apps/oeedit/contextualdata.html","webpack:///./contribs/gmf/src/objectediting/coordinate.js","webpack:///./contribs/gmf/src/objectediting/geom.js","webpack:///./contribs/gmf/src/objectediting/Query.js","webpack:///./contribs/gmf/src/objectediting/getWMSFeatureComponent.js","webpack:///./src/interaction/DrawRegularPolygonFromClick.js","webpack:///./src/editing/createregularpolygonfromclickComponent.js","webpack:///./contribs/gmf/src/objectediting/toolsComponent.js","webpack:///./contribs/gmf/src/objectediting/component.js","webpack:///./contribs/gmf/src/objectediting/Manager.js","webpack:///./contribs/gmf/src/objectediting/module.js","webpack:///./contribs/gmf/apps/oeedit/Controller.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","5","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","obj","__t","__p","coordinate_exports","toXY","coordinates","nesting","ii","objectediting_coordinate","geom_exports","isEmpty","geom","SimpleGeometry","getFlatCoordinates","Point","setCoordinates","getCoordinates","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","objectediting_geom","Query_exports","$http","$q","gmfThemes","this","http_","q_","gmfThemes_","getQueryableLayerNodesDefered_","getQueryableLayersInfo","_this","defer","getOgcServersObject","then","ogcServers","getThemesObject","themes","allQueryableLayersInfo","getQueryableLayersInfoFromThemes","queryableLayersInfo","layerNode","metadata","copyable","resolve","promise","theme","group","nodes","node","jj","children","ogcServer","Themes","getFlatNodes","k","kk","childLayers","queryable","getFeatureInfo","layerInfo","coordinate","map","view","getView","projCode","getProjection","getCode","resolution","getResolution","infoFormat","OGC","WMSInfoFormat","GML","layersParam","layers","split","format","WMSGetFeatureInfo","url","ImageWMS","params","getGetFeatureInfoUrl","INFO_FORMAT","FEATURE_COUNT","QUERY_LAYERS","response","features","readFeatures","angular","service","Query","getWMSFeatureComponent_exports","directive_","controller","scope","active","bindToController","directive","Controller_","$scope","gmfObjectEditingQuery","$watch","handleActiveChange_","gmfObjectEditingQuery_","events","handleMapClick_","evt","_this2","feature","getWMSFeatureComponent","DrawRegularPolygonFromClick_exports","options","angle_","undefined","angle","radius_","radius","sides_","sides","listenerKeys_","Interaction","handleEvent","functions","util","setActive","getMap","enable_","disable_","setMap","getActive","goog_asserts_prod","assert","forEach","center","geometry","fromCircle","Circle","makeRegular","event","CustomEvent","Feature","dispatchEvent","DrawRegularPolygonFromClick","createregularpolygonfromclickComponent_exports","newVal","interaction_","interactionListenerKey_","$on","handleDestroy_","$onInit","handleDrawEnd_","addInteraction","getGeometry","removeInteraction","createregularpolygonfromclickComponent","toolsComponent_exports","createfeatureComponent","btnComponent","ToolActivateMgr","run","$templateCache","put","copyFromActive","deleteFromActive","geomType","process","queryableLayerInfo","requiresLayer","sketchFeatures","templateUrl","$injector","ngeoToolActivateMgr","scope_","ngeoToolActivateMgr_","geomTypePolygon","GeometryType","POLYGON","toolActiveNames_","drawActive","registerTool_","ProcessType","ADD","eraseActive","DELETE","drawTriangleActive","triangleAngle","Math","PI","oeToolsOptions","triangleRadius","regularPolygonRadius","toolActiveName","opt_requiresLayer","handleToolActiveChange_","NAMESPACE_","toolActivate","ToolActivate","registerTool","toolsComponent","jsts","io","OL3Parser","component_exports","EditFeature","SyncLayertreeMap","TreeManager","LayerHelper","FeatureHelper","gmfObjecteditingTemplateUrl","$element","$attrs","component_","bindings","layerNodeId","component","Controller","$timeout","gettextCatalog","gmfEditFeature","gmfTreeManager","ngeoFeatureHelper","ngeoLayerHelper","timeout_","gettextCatalog_","gmfEditFeature_","selectedQueryableLayerInfo","queryableLayerListShown","featureHasGeom","ngeoLayerHelper_","gmfTreeManager_","ngeoFeatureHelper_","skipGeometryChange_","editableWMSLayer_","jstsOL3Parser_","state_","geometryChanges_","defaultStyles_","defaultStylesWoVertice_","dirtyStyles_","dirtyStylesWoVertice_","pending","dirty","features_","Collection","interactions_","modify_","Modify","deleteCondition","utils","style","getVertexStyle","modifyToolActivate_","toolsActive","toolsToolActivate_","handleGetQueryableLayersInfo_","$watchCollection","rootCtrl","unregisterAllTreeCtrl_","traverseDepthFirst","registerTreeCtrl_","State","UPDATE","INSERT","oldVal","defaultColor","dirtyColor","initializeStyles_","setFeatureStyle_","initializeInteractions_","registerInteractions_","toggle_","resetGeometryChanges_","delete","msg","getString","confirm","deleteFeature","handleDeleteFeature_","save","clone","setId","getId","insertFeatures","handleEditFeature_","updateFeature","undo","pop","cloneGeometry_","setGeometry","isStateInsert","resp","refreshWMSLayer_","GeoJSON","interaction","decorate","unregisterInteractions_","_this3","keys","uid","toolMgr","getGeometryName","handleFeatureGeometryChange_","handleModifyInteractionModifyEnd_","handleWindowBeforeUnload_","handleSketchFeaturesAdd_","undoAllChanges_","unregisterTool","jstsBuffered","read","buffer","toMulti","write","$apply","styles","color","opt_incVertice","incVertice","rgbaColor","image","style_Circle","stroke","Stroke","width","fill","Fill","Style","getType","modifyActive","setStyle","treeCtrl","id","layer","getLayer","Image","Tile","refreshWMSLayer","e","returnValue","sketchGeom","element","jstsProcessedGeom","jstsGeom","jstsSketchGeom","union","intersects","difference","processedGeom","multiGeom","clear","_this4","layersInfo","Manager_exports","ngeoLocation","ngeoLocation_","getFeatureDefered_","getFeature","getParam","Param","GEOM_TYPE","ID","LAYER","PROPERTY","THEME","getFeaturesWithComparisonFilters","operator","handleGetFeatures_","getGeomType","getLayerNodeId","getParamAsInt","featureProperties","Location","Manager","objectediting_module","requestAnimationFrame","alert","location","Controller_exports","oeEditActive","AbstractDesktopController","srid","mapViewConfig","zoom","resolutions","unregisterGroup","oeEditToolActivate","queryToolActivate","vectorSource_","source_Vector","wrapX","vectorLayer_","Vector","source","sketchLayer_","addLayer","gmfObjectEditingManager","oeGeomType","oeLayerNodeId","oeFeature","addFeature","searchCoordinatesProjections","EPSG21781","EPSG2056","scaleSelectorValues","elevationLayers","selectedElevationLayer","profileLinesconfiguration","aster","srtm","mousePositionProjections","code","label","filter","has","raven_default","a","config","addPlugin","angular_default","install","appmodule","__webpack_exports__"],"mappings":"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","file":"oeedit.e31aa3.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t5: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([506,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = function (obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<div class=\"btn-group\" role=\"group\" aria-label=\"\">\\n  <a\\n    href\\n    ngeo-btn\\n    ngeo-createfeature\\n    ngeo-createfeature-active=\"oetCtrl.drawActive\"\\n    ngeo-createfeature-features=\"::oetCtrl.sketchFeatures\"\\n    ngeo-createfeature-geom-type=\"::oetCtrl.geomType\"\\n    ngeo-createfeature-map=\"::oetCtrl.map\"\\n    class=\"btn btn-sm btn-default\"\\n    ng-class=\"{active: oetCtrl.drawActive}\"\\n    ng-if=\"::(oetCtrl.geomType === \\'MultiPoint\\')\"\\n    ng-model=\"oetCtrl.drawActive\"\\n    title=\"{{\\'Add a point to the geometry\\' | translate}}\">\\n    <span\\n      class=\"fa fa-plus-square-o gmf-icon-oe-draw\">\\n    </span>\\n  </a>\\n  <a\\n    href\\n    ngeo-btn\\n    ngeo-createfeature\\n    ngeo-createfeature-active=\"oetCtrl.drawActive\"\\n    ngeo-createfeature-features=\"::oetCtrl.sketchFeatures\"\\n    ngeo-createfeature-geom-type=\"::oetCtrl.geomType\"\\n    ngeo-createfeature-map=\"::oetCtrl.map\"\\n    class=\"btn btn-sm btn-default\"\\n    ng-class=\"{active: oetCtrl.drawActive}\"\\n    ng-if=\"::(oetCtrl.geomType === \\'MultiLineString\\')\"\\n    ng-model=\"oetCtrl.drawActive\"\\n    title=\"{{\\'Add a linestring to the geometry\\' | translate}}\">\\n    <span\\n      class=\"fa fa-plus-square-o gmf-icon-oe-draw\">\\n    </span>\\n  </a>\\n  <a\\n    href\\n    ngeo-btn\\n    ngeo-createfeature\\n    ngeo-createfeature-active=\"oetCtrl.drawActive\"\\n    ngeo-createfeature-features=\"::oetCtrl.sketchFeatures\"\\n    ngeo-createfeature-geom-type=\"::oetCtrl.geomType\"\\n    ngeo-createfeature-map=\"::oetCtrl.map\"\\n    class=\"btn btn-sm btn-default\"\\n    ng-class=\"{active: oetCtrl.drawActive}\"\\n    ng-if=\"::(oetCtrl.geomType === \\'MultiPolygon\\')\"\\n    ng-model=\"oetCtrl.drawActive\"\\n    title=\"{{\\'Add a polygon to the geometry\\' | translate}}\">\\n    <span\\n      class=\"fa fa-plus-square-o gmf-icon-oe-draw\">\\n    </span>\\n  </a>\\n\\n  <a\\n    href\\n    ngeo-btn\\n    ngeo-createfeature\\n    ngeo-createfeature-active=\"oetCtrl.eraseActive\"\\n    ngeo-createfeature-features=\"::oetCtrl.sketchFeatures\"\\n    ngeo-createfeature-geom-type=\"::oetCtrl.geomTypePolygon\"\\n    ngeo-createfeature-map=\"::oetCtrl.map\"\\n    class=\"btn btn-sm btn-default\"\\n    ng-class=\"{active: oetCtrl.eraseActive}\"\\n    ng-model=\"oetCtrl.eraseActive\"\\n    title=\"{{\\'Erase geometry\\' | translate}}\">\\n    <span\\n      class=\"fa fa-minus-square-o gmf-icon-oe-erase\">\\n    </span>\\n  </a>\\n\\n  <a\\n    href\\n    ng-if=\"::oetCtrl.geomType === \\'MultiPolygon\\'\"\\n    ngeo-btn\\n    ngeo-createregularpolygonfromclick\\n    ngeo-createregularpolygonfromclick-active=\"oetCtrl.drawTriangleActive\"\\n    ngeo-createregularpolygonfromclick-angle=\"oetCtrl.triangleAngle\"\\n    ngeo-createregularpolygonfromclick-features=\"::oetCtrl.sketchFeatures\"\\n    ngeo-createregularpolygonfromclick-map=\"::oetCtrl.map\"\\n    ngeo-createregularpolygonfromclick-radius=\"::oetCtrl.triangleRadius\"\\n    class=\"btn btn-sm btn-default ngeo-createregularpolygonfromclick\"\\n    ng-class=\"{active: oetCtrl.drawTriangleActive}\"\\n    ng-model=\"oetCtrl.drawTriangleActive\"\\n    title=\"{{\\'Draw a triangle\\' | translate}}\">\\n    <span\\n      class=\"fa fa-play fa-rotate-270 gmf-icon-oe-triangle\">\\n    </span>\\n  </a>\\n\\n  <a\\n    href\\n    ngeo-btn\\n    gmf-objecteditinggetwmsfeature\\n    gmf-objecteditinggetwmsfeature-active=\"oetCtrl.copyFromActive\"\\n    gmf-objecteditinggetwmsfeature-features=\"::oetCtrl.sketchFeatures\"\\n    gmf-objecteditinggetwmsfeature-layerinfo=\"oetCtrl.queryableLayerInfo\"\\n    gmf-objecteditinggetwmsfeature-map=\"::oetCtrl.map\"\\n    class=\"btn btn-sm btn-default gmf-objecteditinggetwmsfeature-add\"\\n    ng-class=\"{active: oetCtrl.copyFromActive}\"\\n    ng-model=\"oetCtrl.copyFromActive\"\\n    title=\"{{\\'Copy from external WMS feature\\' | translate}}\">\\n    <span\\n      class=\"fa fa-clone gmf-icon-oe-copyfrom\">\\n    </span>\\n  </a>\\n\\n  <a\\n    href\\n    ngeo-btn\\n    gmf-objecteditinggetwmsfeature\\n    gmf-objecteditinggetwmsfeature-active=\"oetCtrl.deleteFromActive\"\\n    gmf-objecteditinggetwmsfeature-features=\"::oetCtrl.sketchFeatures\"\\n    gmf-objecteditinggetwmsfeature-layerinfo=\"oetCtrl.queryableLayerInfo\"\\n    gmf-objecteditinggetwmsfeature-map=\"::oetCtrl.map\"\\n    class=\"btn btn-sm btn-default gmf-objecteditinggetwmsfeature-delete\"\\n    ng-class=\"{active: oetCtrl.deleteFromActive}\"\\n    ng-model=\"oetCtrl.deleteFromActive\"\\n    title=\"{{\\'Cut from external WMS feature\\' | translate}}\">\\n    <span\\n      class=\"fa fa-scissors gmf-icon-oe-deletefrom\">\\n    </span>\\n  </a>\\n\\n</div>\\n';\n\n}\nreturn __p\n}","module.exports = function (obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<gmf-objecteditingtools\\n  gmf-objecteditingtools-active=\"oeCtrl.toolsActive\"\\n  gmf-objecteditingtools-copyfromactive=\"oeCtrl.copyFromActive\"\\n  gmf-objecteditingtools-deletefromactive=\"oeCtrl.deleteFromActive\"\\n  gmf-objecteditingtools-feature=\"oeCtrl.feature\"\\n  gmf-objecteditingtools-geomtype=\"::oeCtrl.geomType\"\\n  gmf-objecteditingtools-map=\"::oeCtrl.map\"\\n  gmf-objecteditingtools-process=\"oeCtrl.process\"\\n  gmf-objecteditingtools-queryablelayerinfo=\"oeCtrl.selectedQueryableLayerInfo\"\\n  gmf-objecteditingtools-requireslayer=\"oeCtrl.queryableLayerListShown\"\\n  gmf-objecteditingtools-sketchfeatures=\"::oeCtrl.sketchFeatures\">\\n</gmf-objecteditingtools>\\n\\n<div\\n  class=\"form-group\"\\n  ng-show=\"oeCtrl.queryableLayerListShown\">\\n  <label\\n    ng-show=\"oeCtrl.copyFromActive === true\"\\n    class=\"col-form-label\">{{\\'Copy from:\\' | translate}}</label>\\n  <label\\n    ng-show=\"oeCtrl.deleteFromActive === true\"\\n    class=\"col-form-label\">{{\\'Cut from:\\' | translate}}</label>\\n  <select\\n    class=\"form-control\"\\n    ng-model=\"oeCtrl.selectedQueryableLayerInfo\"\\n    ng-options=\"layerInfo.layerNode.name | translate for layerInfo in oeCtrl.queryableLayersInfo\">\\n  </select>\\n</div>\\n\\n<form\\n  novalidate\\n  name=\"form\"\\n  class=\"form gmf-objectediting-form\">\\n  <input\\n    type=\"submit\"\\n    value=\"{{\\'Save\\' | translate}}\"\\n    class=\"btn btn-sm btn-default gmf-objectediting-btn-save\"\\n    ng-click=\"form.$valid && oeCtrl.save()\"\\n    ng-disabled=\"!oeCtrl.dirty || oeCtrl.pending || !oeCtrl.featureHasGeom\"\\n    title=\"{{\\'Save modifications\\' | translate}}\"></input>\\n  <a\\n    class=\"btn btn-sm btn-link gmf-objectediting-btn-undo\"\\n    ng-click=\"oeCtrl.undo()\"\\n    ng-disabled=\"!oeCtrl.dirty || oeCtrl.pending\"\\n    title=\"{{\\'Undo latest modifications\\' | translate}}\"\\n    href>{{\\'Undo\\' | translate}}</a>\\n  <a\\n    class=\"btn btn-sm btn-link gmf-objectediting-btn-delete\"\\n    ng-click=\"oeCtrl.delete()\"\\n    ng-disabled=\"oeCtrl.isStateInsert() || oeCtrl.pending\"\\n    title=\"{{\\'Delete the feature\\' | translate}}\"\\n    href>{{\\'Delete\\' | translate}}</a>\\n</form>\\n';\n\n}\nreturn __p\n}","module.exports = function (obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<table>\\n  <tr>\\n    <td translate>\\n      Swiss grid (LV03)\\n    </td>\\n    <td>\\n      {{coord_21781|ngeoNumberCoordinates:0:\\'{x} / {y}\\'}}\\n    </td>\\n  </tr>\\n  <tr>\\n    <td translate>\\n      Wgs Coord.\\n    </td>\\n    <td>\\n      {{coord_4326|ngeoNumberCoordinates:2:\\'{y} / {x}\\'}}\\n    </td>\\n  </tr>\\n  <tr>\\n    <td translate>\\n      Wgs Coord. DMS\\n    </td>\\n    <td>\\n      {{coord_4326|ngeoDMSCoordinates:0:\\'{y} {x}\\'}}\\n    </td>\\n  </tr>\\n  <tr>\\n    <td translate>\\n      Elevation (SRTM)\\n    </td>\\n    <td>\\n      {{srtm | number}} [m]\\n    </td>\\n  </tr>\\n  <tr>\\n    <td translate>\\n      Elevation (Aster)\\n    </td>\\n    <td>\\n      {{aster | number}} [m]\\n    </td>\\n  </tr>\\n</table>\\n<a ng-href=\"https://maps.google.ch/?ie=UTF8&ll={{coord_4326_northern}},{{coord_4326_eastern}}&layer=c&cbll={{coord_4326_northern}},{{coord_4326_eastern}}&cbp=12,57.78,,0,8.1\" target=\"_blank\">Google StreetView</a>\\n';\n\n}\nreturn __p\n}","/**\n * @module gmf.objectediting.coordinate\n */\nconst exports = {};\n\n\n/**\n * Convert a given coordinate or list of coordinates of any 'nesting' level\n * to XY, i.e. remove any extra dimensions to the coordinates and keep only 2.\n *\n * @param {Array.<ol.Coordinate>|ol.Coordinate} coordinates Coordinates\n * @param {number} nesting Nesting level.\n * @return {Array.<ol.Coordinate>|ol.Coordinate} Converted coordinates.\n */\nexports.toXY = function(coordinates, nesting) {\n  if (nesting === 0) {\n    if (coordinates.length > 2) {\n      coordinates = [coordinates[0], coordinates[1]];\n    }\n  } else {\n    for (let i = 0, ii = coordinates.length; i < ii; i++) {\n      coordinates[i] = exports.toXY(coordinates[i], nesting - 1);\n    }\n  }\n  return coordinates;\n};\n\n\nexport default exports;\n","/**\n * @module gmf.objectediting.geom\n */\nconst exports = {};\nimport gmfObjecteditingCoordinate from 'gmf/objectediting/coordinate.js';\nimport olGeomLineString from 'ol/geom/LineString.js';\nimport olGeomMultiLineString from 'ol/geom/MultiLineString.js';\nimport olGeomMultiPoint from 'ol/geom/MultiPoint.js';\nimport olGeomMultiPolygon from 'ol/geom/MultiPolygon.js';\nimport olGeomPoint from 'ol/geom/Point.js';\nimport olGeomPolygon from 'ol/geom/Polygon.js';\nimport olGeomSimpleGeometry from 'ol/geom/SimpleGeometry.js';\n\n\n/**\n * Determines whether a given geometry is empty or not. A null or undefined\n * value can be given for convenience, i.e. when using methods than can\n * return a geometry or not, for example:\n * `gmf.objectediting.geom.isEmpty(feature.getGeometry())`.\n *\n * @param {?ol.geom.Geometry|undefined} geom Geometry.\n * @return {boolean} Whether the given geometry is empty or not. A null or\n *     undefined geometry is considered empty.\n */\nexports.isEmpty = function(geom) {\n  let isEmpty = true;\n  if (geom && geom instanceof olGeomSimpleGeometry) {\n    isEmpty = geom.getFlatCoordinates().length === 0;\n  }\n  return isEmpty;\n};\n\n\n/**\n * Convert all coordinates within a geometry object to XY, i.e. remove any\n * extra dimension other than X and Y to the coordinates of a geometry.\n *\n * @param {ol.geom.Geometry} geom Geometry\n */\nexports.toXY = function(geom) {\n  if (geom instanceof olGeomPoint) {\n    geom.setCoordinates(\n      gmfObjecteditingCoordinate.toXY(geom.getCoordinates(), 0)\n    );\n  } else if (geom instanceof olGeomMultiPoint ||\n             geom instanceof olGeomLineString\n  ) {\n    geom.setCoordinates(\n      gmfObjecteditingCoordinate.toXY(geom.getCoordinates(), 1)\n    );\n  } else if (geom instanceof olGeomMultiLineString ||\n             geom instanceof olGeomPolygon\n  ) {\n    geom.setCoordinates(\n      gmfObjecteditingCoordinate.toXY(geom.getCoordinates(), 2)\n    );\n  } else if (geom instanceof olGeomMultiPolygon) {\n    geom.setCoordinates(\n      gmfObjecteditingCoordinate.toXY(geom.getCoordinates(), 3)\n    );\n  } else {\n    throw 'gmf.objectediting.geom.toXY - unsupported geometry type';\n  }\n};\n\n\nexport default exports;\n","/**\n * @module gmf.objectediting.Query\n */\nimport gmfThemeThemes from 'gmf/theme/Themes.js';\nimport ngeoDatasourceOGC from 'ngeo/datasource/OGC.js';\nimport olFormatWMSGetFeatureInfo from 'ol/format/WMSGetFeatureInfo.js';\nimport olSourceImageWMS from 'ol/source/ImageWMS.js';\n\n/**\n * A service that collects all queryable layer nodes from all themes, stores\n * them and use them to make WMS GetFeatureInfo queries. Queries can be made\n * regardless of the associated layer visibility. The layer nodes are also\n * loaded only once.\n *\n * @param {angular.$http} $http Angular $http service.\n * @param {angular.$q} $q Angular $q service.\n * @param {gmf.theme.Themes} gmfThemes The gmf themes service.\n * @constructor\n * @struct\n * @ngInject\n */\nconst exports = function($http, $q, gmfThemes) {\n\n  /**\n   * @type {angular.$http}\n   * @private\n   */\n  this.http_ = $http;\n\n  /**\n   * @type {angular.$q}\n   * @private\n   */\n  this.q_ = $q;\n\n  /**\n   * @type {gmf.theme.Themes}\n   * @private\n   */\n  this.gmfThemes_ = gmfThemes;\n\n  /**\n   * @type {?angular.$q.Deferred}\n   * @private\n   */\n  this.getQueryableLayerNodesDefered_ = null;\n\n};\n\n\n/**\n * @return {angular.$q.Promise} Promise.\n * @export\n */\nexports.prototype.getQueryableLayersInfo = function() {\n\n  if (!this.getQueryableLayerNodesDefered_) {\n    this.getQueryableLayerNodesDefered_ = this.q_.defer();\n    this.gmfThemes_.getOgcServersObject().then((ogcServers) => {\n      this.gmfThemes_.getThemesObject().then((themes) => {\n        if (!themes) {\n          return;\n        }\n\n        // Get all queryable nodes\n        const allQueryableLayersInfo =\n            exports.getQueryableLayersInfoFromThemes(\n              themes,\n              ogcServers\n            );\n\n        // Narrow down to only those that have the 'copyable' metadata set\n        const queryableLayersInfo = [];\n        for (let i = 0, ii = allQueryableLayersInfo.length; i < ii; i++) {\n          if (allQueryableLayersInfo[i].layerNode.metadata.copyable) {\n            queryableLayersInfo.push(allQueryableLayersInfo[i]);\n          }\n        }\n\n        this.getQueryableLayerNodesDefered_.resolve(queryableLayersInfo);\n      });\n    });\n  }\n\n  return this.getQueryableLayerNodesDefered_.promise;\n\n};\n\n\n/**\n * From a list of theme nodes, collect all WMS layer nodes that are queryable.\n * A list of OGC servers is given in order to bind each queryable layer node\n * to its associated server and be able to build requests.\n *\n * @param {Array.<gmfThemes.GmfTheme>} themes List of theme nodes.\n * @param {gmfThemes.GmfOgcServers} ogcServers List of ogc servers\n * @return {Array.<gmfx.ObjectEditingQueryableLayerInfo>} List of\n *     queryable layers information.\n * @export\n */\nexports.getQueryableLayersInfoFromThemes = function(\n  themes, ogcServers\n) {\n  const queryableLayersInfo = [];\n  let theme;\n  let group;\n  let nodes;\n  let node;\n\n  for (let i = 0, ii = themes.length; i < ii; i++) {\n    theme = /** @type {gmfThemes.GmfTheme} */ (themes[i]);\n    for (let j = 0, jj = theme.children.length; j < jj; j++) {\n      group = /** @type {gmfThemes.GmfGroup} */ (theme.children[j]);\n\n      // Skip groups that don't have an ogcServer set\n      if (!group.ogcServer) {\n        continue;\n      }\n\n      nodes = [];\n      gmfThemeThemes.getFlatNodes(group, nodes);\n\n      for (let k = 0, kk = nodes.length; k < kk; k++) {\n        node = /** @type {gmfThemes.GmfGroup|gmfThemes.GmfLayerWMS} */ (\n          nodes[k]);\n\n        // Skip groups within groups\n        if (node.children && node.children.length) {\n          continue;\n        }\n\n        if (node.childLayers &&\n          node.childLayers[0] &&\n          node.childLayers[0].queryable\n        ) {\n          queryableLayersInfo.push({\n            layerNode: node,\n            ogcServer: ogcServers[group.ogcServer]\n          });\n        }\n      }\n    }\n  }\n\n  return queryableLayersInfo;\n};\n\n\n/**\n * From a queryable layer (WMS layer node), use its associated OGC server\n * to issue a single WMS GetFeatureInfo request at a specific location on a\n * specific map to fetch a single feature. If no feature is found, a `null`\n * value is returned.\n *\n * @param {gmfx.ObjectEditingQueryableLayerInfo} layerInfo Queryable layer\n *     information.\n * @param {ol.Coordinate} coordinate Coordinate.\n * @param {ol.Map} map Map.\n * @return {angular.$q.Promise} Promise.\n * @export\n */\nexports.prototype.getFeatureInfo = function(layerInfo, coordinate, map) {\n  const view = map.getView();\n  const projCode = view.getProjection().getCode();\n  const resolution = /** @type {number} */(view.getResolution());\n  const infoFormat = ngeoDatasourceOGC.WMSInfoFormat.GML;\n  const layerNode = layerInfo.layerNode;\n  const layersParam = layerNode.layers.split(',');\n  const ogcServer = layerInfo.ogcServer;\n\n  const format = new olFormatWMSGetFeatureInfo({\n    layers: layersParam\n  });\n\n  const wmsSource = new olSourceImageWMS({\n    url: ogcServer.url,\n    params: {\n      layers: layersParam\n    }\n  });\n\n  const url = /** @type {string} */ (\n    wmsSource.getGetFeatureInfoUrl(coordinate, resolution, projCode, {\n      'INFO_FORMAT': infoFormat,\n      'FEATURE_COUNT': 1,\n      'QUERY_LAYERS': layersParam\n    })\n  );\n\n  return this.http_.get(url).then(\n    (response) => {\n      const features = format.readFeatures(response.data);\n      return (features && features[0]) ? features[0] : null;\n    }\n  );\n};\n\n\n/**\n * @type {!angular.Module}\n */\nexports.module = angular.module('gmfObjectEditingQuery', [\n  gmfThemeThemes.module.name,\n]);\nexports.module.service('gmfObjectEditingQuery', exports);\n\n\nexport default exports;\n","/**\n * @module gmf.objectediting.getWMSFeatureComponent\n */\nimport gmfObjecteditingQuery from 'gmf/objectediting/Query.js';\nimport * as olEvents from 'ol/events.js';\n\n/**\n * @type {!angular.Module}\n */\nconst exports = angular.module('gmfObjecteditingGetWMSFeatureComponent', [\n  gmfObjecteditingQuery.module.name,\n]);\n\n\n/**\n * When activated, this directive registers clicks on an OL3 map and use the\n * clicked coordinate to fetch a feature using the ObjectEditing query service.\n * A feature returned is pushed to a collection.\n *\n * Example:\n *\n *     <gmf-objecteditinggetwmsfeature\n *         gmf-objecteditinggetwmsfeature-active=\"ctrl.active\"\n *         gmf-objecteditinggetwmsfeature-features=\"ctrl.features\"\n *         gmf-objecteditinggetwmsfeature-layerinfo=\"ctrl.layerInfo\"\n *         gmf-objecteditinggetwmsfeature-map=\"::ctrl.map\">\n *     </gmf-objecteditinggetwmsfeature>\n *\n * @htmlAttribute {boolean} gmf-objecteditinggetwmsfeature-active Whether the\n *     directive is active or not.\n * @htmlAttribute {ol.Collection} gmf-objecteditinggetwmsfeature-features\n *     The collection of features where to add those created by this directive.\n * @htmlAttribute {gmfx.ObjectEditingQueryableLayerInfo} gmf-objecteditinggetwmsfeature-layerinfo Queryable layer info.\n * @htmlAttribute {ol.Map} gmf-objecteditinggetwmsfeature-map The map.\n * @return {angular.Directive} The directive specs.\n * @ngInject\n * @ngdoc directive\n * @ngname gmfObjecteditinggetwmsfeature\n */\nexports.directive_ = function() {\n  return {\n    controller: 'gmfObjecteditinggetwmsfeatureController',\n    scope: {\n      'active': '=gmfObjecteditinggetwmsfeatureActive',\n      'features': '<gmfObjecteditinggetwmsfeatureFeatures',\n      'layerInfo': '=gmfObjecteditinggetwmsfeatureLayerinfo',\n      'map': '<gmfObjecteditinggetwmsfeatureMap'\n    },\n    bindToController: true\n  };\n};\n\nexports.directive('gmfObjecteditinggetwmsfeature',\n  exports.directive_);\n\n\n/**\n * @param {!angular.Scope} $scope Scope.\n * @param {gmf.objectediting.Query} gmfObjectEditingQuery GMF ObjectEditing\n *     query service.\n * @constructor\n * @private\n * @ngInject\n * @ngdoc controller\n * @ngname GmfObjecteditinggetwmsfeatureController\n */\nexports.Controller_ = function($scope,\n  gmfObjectEditingQuery) {\n\n  // Scope properties\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.active;\n\n  $scope.$watch(\n    () => this.active,\n    this.handleActiveChange_.bind(this)\n  );\n\n  /**\n   * @type {ol.Collection}\n   * @export\n   */\n  this.features;\n\n  /**\n   * @type {gmfx.ObjectEditingQueryableLayerInfo}\n   * @export\n   */\n  this.layerInfo;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map;\n\n\n  // Injected properties\n\n  /**\n   * @type {gmf.objectediting.Query}\n   * @private\n   */\n  this.gmfObjectEditingQuery_ = gmfObjectEditingQuery;\n\n};\n\n\n/**\n * @param {boolean} active Active.\n * @private\n */\nexports.Controller_.prototype.handleActiveChange_ = function(active) {\n  if (active) {\n    olEvents.listen(\n      this.map,\n      'click',\n      this.handleMapClick_,\n      this\n    );\n  } else {\n    olEvents.unlisten(\n      this.map,\n      'click',\n      this.handleMapClick_,\n      this\n    );\n  }\n};\n\n\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n * @private\n */\nexports.Controller_.prototype.handleMapClick_ = function(evt) {\n  this.gmfObjectEditingQuery_.getFeatureInfo(\n    this.layerInfo,\n    evt.coordinate,\n    this.map\n  ).then((feature) => {\n    if (feature) {\n      this.features.push(feature);\n    }\n  });\n};\n\nexports.controller('gmfObjecteditinggetwmsfeatureController',\n  exports.Controller_);\n\n\nexport default exports;\n","/**\n * @module ngeo.interaction.DrawRegularPolygonFromClick\n */\nimport googAsserts from 'goog/asserts.js';\nimport ngeoCustomEvent from 'ngeo/CustomEvent.js';\nimport * as olBase from 'ol/index.js';\nimport * as olEvents from 'ol/events.js';\nimport olFeature from 'ol/Feature.js';\nimport * as olFunctions from 'ol/functions.js';\nimport olGeomCircle from 'ol/geom/Circle.js';\nimport olGeomPolygon from 'ol/geom/Polygon.js';\nimport olInteractionInteraction from 'ol/interaction/Interaction.js';\n\n/**\n * @classdesc\n * This interactions allows drawing regular polygons of a pre-determined number\n * of sides and size a a clicked location on the map.\n *\n * @constructor\n * @struct\n * @fires ngeox.DrawEvent\n * @extends {ol.interaction.Interaction}\n * @param {ngeox.interaction.DrawRegularPolygonFromClickOptions} options Options\n */\nconst exports = function(options) {\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.angle_ = options.angle !== undefined ? options.angle : 0;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.radius_ = options.radius;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.sides_ = options.sides !== undefined ? options.sides : 3;\n\n  /**\n   * @type {!Array.<ol.EventsKey>}\n   * @private\n   */\n  this.listenerKeys_ = [];\n\n  olInteractionInteraction.call(this, {\n    handleEvent: olFunctions.TRUE\n  });\n\n};\n\nolBase.inherits(\n  exports, olInteractionInteraction);\n\n\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @override\n */\nexports.prototype.setActive = function(active) {\n  olInteractionInteraction.prototype.setActive.call(this, active);\n\n  if (this.getMap()) {\n    if (active) {\n      this.enable_();\n    } else {\n      this.disable_();\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nexports.prototype.setMap = function(map) {\n\n  const active = this.getActive();\n\n  const currentMap = this.getMap();\n  if (currentMap && active) {\n    this.disable_();\n  }\n\n  olInteractionInteraction.prototype.setMap.call(this, map);\n\n  if (map && active) {\n    this.enable_();\n  }\n\n};\n\n\n/**\n * Enable the interaction. Called when added to a map AND active.\n * @private\n */\nexports.prototype.enable_ = function() {\n  const map = this.getMap();\n  googAsserts.assert(map, 'Map should be set.');\n  this.listenerKeys_.push(\n    olEvents.listen(map, 'click', this.handleMapClick_, this)\n  );\n};\n\n\n/**\n * Disable the interaction. Called when removed from a map or deactivated.\n * @private\n */\nexports.prototype.disable_ = function() {\n  const map = this.getMap();\n  googAsserts.assert(map, 'Map should be set.');\n  this.listenerKeys_.forEach(olEvents.unlistenByKey);\n  this.listenerKeys_.length = 0;\n};\n\n\n/**\n * Called the the map is clicked. Create a regular polygon at the clicked\n * location using the configuration\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @private\n */\nexports.prototype.handleMapClick_ = function(evt) {\n  const center = evt.coordinate;\n  const geometry = olGeomPolygon.fromCircle(\n    new olGeomCircle(center), this.sides_\n  );\n\n  olGeomPolygon.makeRegular(geometry, center, this.radius_, this.angle_);\n\n  /** @type {ngeox.DrawEvent} */\n  const event = new ngeoCustomEvent('drawend', {feature: new olFeature(geometry)});\n  this.dispatchEvent(event);\n};\n\n\nexport default exports;\n","/**\n * @module ngeo.editing.createregularpolygonfromclickComponent\n */\nimport ngeoInteractionDrawRegularPolygonFromClick from 'ngeo/interaction/DrawRegularPolygonFromClick.js';\nimport * as olEvents from 'ol/events.js';\nimport olFeature from 'ol/Feature.js';\n\nconst exports = angular.module('ngeoCreateregularpolygonfromclick', [\n]);\n\n\n/**\n * A directive used to draw vector features of a single geometry type using\n * either a 'draw' or 'measure' interaction. Once a feature is finished being\n * drawn, it is added to a collection of features.\n *\n * The geometry types supported are:\n *  - Point\n *  - LineString\n *  - Polygon\n *\n * Example:\n *\n *     <a\n *       href\n *       translate\n *       ngeo-btn\n *       ngeo-createregularpolygonfromclick\n *       ngeo-createregularpolygonfromclick-active=\"ctrl.active\"\n *       ngeo-createregularpolygonfromclick-angle=\"::ctrl.angle\"\n *       ngeo-createregularpolygonfromclick-features=\"ctrl.features\"\n *       ngeo-createregularpolygonfromclick-map=\"::ctrl.map\"\n *       ngeo-createregularpolygonfromclick-radius=\"::ctrl.radius\"\n *       ngeo-createregularpolygonfromclick-sides=\"::ctrl.sides\"\n *       class=\"btn btn-default ngeo-createregularpolygonfromclick\"\n *       ng-class=\"{active: ctrl.active}\"\n *       ng-model=\"ctrl.active\">\n *     </a>\n *\n * @htmlAttribute {boolean} ngeo-createregularpolygonfromclick-active Whether\n *     the directive is active or not.\n * @htmlAttribute {number|undefined} ngeo-createregularpolygonfromclick-angle\n *     Angle in radians. A value of 0 will have one of the shape's point\n *     facing up. Default value is 0.\n * @htmlAttribute {ol.Collection} ngeo-createregularpolygonfromclick-features\n *     The collection of features where to add those created by this directive.\n * @htmlAttribute {ol.Map} ngeo-createregularpolygonfromclick-map The map.\n * @htmlAttribute {number} ngeo-createregularpolygonfromclick-radius Radius\n *     size in map units.\n * @htmlAttribute {number|undefined} ngeo-createregularpolygonfromclick-sides\n *     The number of sides for the regular polygon. Default value is 3.\n *\n * @return {angular.Directive} The directive specs.\n * @ngdoc directive\n * @ngname ngeoCreateregularpolygonfromclick\n */\nexports.directive_ = function() {\n  return {\n    controller: 'ngeoCreateregularpolygonfromclickController',\n    bindToController: true,\n    scope: {\n      'active': '=ngeoCreateregularpolygonfromclickActive',\n      'angle': '<?ngeoCreateregularpolygonfromclickAngle',\n      'features': '=ngeoCreateregularpolygonfromclickFeatures',\n      'map': '=ngeoCreateregularpolygonfromclickMap',\n      'radius': '<ngeoCreateregularpolygonfromclickRadius',\n      'sides': '<?ngeoCreateregularpolygonfromclickSides'\n    }\n  };\n};\n\nexports.directive(\n  'ngeoCreateregularpolygonfromclick',\n  exports.directive_\n);\n\n\n/**\n * @param {!angular.Scope} $scope Scope.\n * @constructor\n * @private\n * @struct\n * @ngInject\n * @ngdoc controller\n * @ngname ngeoCreateregularpolygonfromclickController\n */\nexports.Controller_ = function($scope) {\n\n  // == Scope properties ==\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.active = false;\n\n  $scope.$watch(\n    () => this.active,\n    (newVal) => {\n      this.interaction_.setActive(newVal);\n    }\n  );\n\n  /**\n   * @type {number|undefined}\n   * @export\n   */\n  this.angle;\n\n  /**\n   * @type {ol.Collection.<ol.Feature>}\n   * @export\n   */\n  this.features;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map;\n\n  /**\n   * @type {number}\n   * @export\n   */\n  this.radius;\n\n  /**\n   * @type {number|undefined}\n   * @export\n   */\n  this.sides;\n\n\n  // == Other properties ==\n\n  /**\n   * @type {ngeo.interaction.DrawRegularPolygonFromClick}\n   * @private\n   */\n  this.interaction_;\n\n  /**\n   * @type {ol.EventsKey}\n   * @private\n   */\n  this.interactionListenerKey_;\n\n  $scope.$on('$destroy', this.handleDestroy_.bind(this));\n};\n\n\n/**\n * Initialize the directive.\n */\nexports.Controller_.prototype.$onInit = function() {\n\n  this.interaction_ = new ngeoInteractionDrawRegularPolygonFromClick({\n    angle: this.angle,\n    radius: this.radius,\n    sides: this.sides\n  });\n  this.interaction_.setActive(this.active);\n\n  this.interactionListenerKey_ = olEvents.listen(\n    this.interaction_,\n    'drawend',\n    this.handleDrawEnd_,\n    this\n  );\n\n  this.map.addInteraction(this.interaction_);\n};\n\n\n/**\n * Called when a feature is finished being drawn. Add the feature to the\n * collection.\n * @param {ol.interaction.Draw.Event} evt Event.\n * @private\n */\nexports.Controller_.prototype.handleDrawEnd_ = function(evt) {\n  const feature = new olFeature(evt.feature.getGeometry());\n  this.features.push(feature);\n};\n\n\n/**\n * Cleanup event listeners and remove the interaction from the map.\n * @private\n */\nexports.Controller_.prototype.handleDestroy_ = function() {\n  olEvents.unlistenByKey(this.interactionListenerKey_);\n  this.interaction_.setActive(false);\n  this.map.removeInteraction(this.interaction_);\n};\n\n\nexports.controller(\n  'ngeoCreateregularpolygonfromclickController',\n  exports.Controller_\n);\n\n\nexport default exports;\n","/**\n * @module gmf.objectediting.toolsComponent\n */\n\n/** @suppress {extraRequire} */\nimport gmfObjecteditingGetWMSFeatureComponent from 'gmf/objectediting/getWMSFeatureComponent.js';\n\n/** @suppress {extraRequire} */\nimport ngeoEditingCreatefeatureComponent from 'ngeo/editing/createfeatureComponent.js';\n\n/** @suppress {extraRequire} */\nimport ngeoEditingCreateregularpolygonfromclickComponent from 'ngeo/editing/createregularpolygonfromclickComponent.js';\n\nimport ngeoGeometryType from 'ngeo/GeometryType.js';\n\n/** @suppress {extraRequire} */\nimport ngeoMiscBtnComponent from 'ngeo/misc/btnComponent.js';\n\nimport ngeoMiscToolActivate from 'ngeo/misc/ToolActivate.js';\nimport ngeoMiscToolActivateMgr from 'ngeo/misc/ToolActivateMgr.js';\nimport * as olBase from 'ol/index.js';\n\n/**\n * @type {!angular.Module}\n */\nconst exports = angular.module('gmfObjecteditingToolsComponent', [\n  gmfObjecteditingGetWMSFeatureComponent.name,\n  ngeoEditingCreatefeatureComponent.name,\n  ngeoEditingCreateregularpolygonfromclickComponent.name,\n  ngeoMiscBtnComponent.name,\n  ngeoMiscToolActivateMgr.module.name,\n]);\n\n\nexports.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('gmf/objectediting/toolsComponent', require('./toolsComponent.html'));\n});\n\n\n/**\n * A list of additional options for this directive that are not defined as\n * html attributes. All keys of this hash are optional. For the complete list\n * of keys and their possible values, see in gmfx.js, under:\n * `gmfx.ObjectEditingToolsOptions`.\n */\nexports.value('gmfObjectEditingToolsOptions', {});\n\n\n/**\n * Directive used to edit the geometry of a single feature using advanced\n * tools.\n *\n * Example:\n *\n *     <gmf-objecteditingtools\n *         gmf-objecteditingtools-active=\"ctrl.objectEditingActive\"\n *         gmf-objecteditingtools-copyfromactive=\"ctrl.objectEditingCopyFromActive\"\n *         gmf-objecteditingtools-deletefromactive=\"ctrl.objectEditingDeleteFromActive\"\n *         gmf-objecteditingtools-feature=\"ctrl.objectEditingFeature\"\n *         gmf-objecteditingtools-geomtype=\"ctrl.objectEditingGeomType\"\n *         gmf-objecteditingtools-map=\"::ctrl.map\"\n *         gmf-objecteditingtools-process=\"::ctrl.process\"\n *         gmf-objecteditingtools-queryablelayerinfo=\"::ctrl.queryableLayerInfo\"\n *         gmf-objecteditingtools-requireslayer=\"ctrl.requiresLayer\"\n *         gmf-objecteditingtools-sketchfeatures=\"::ctrl.sketchFeatures\">\n *     </gmf-objecteditingtools>\n *\n * @htmlAttribute {boolean} gmf-objecteditingtools-active Whether the\n *     directive is active or not.\n * @htmlAttribute {boolean} gmf-objecteditingtools-copyfromactive Whether the\n *     'Copy from' tool is active or not.\n * @htmlAttribute {boolean} gmf-objecteditingtools-deletefromactive Whether the\n *     'Delete from' tool is active or not.\n * @htmlAttribute {ol.Feature} gmf-objecteditingtools-feature The feature to\n *     edit.\n * @htmlAttribute {string} gmf-objecteditingtools-geomtype The geometry type.\n * @htmlAttribute {ol.Map} gmf-objecteditingtools-map The map.\n * @htmlAttribute {string} gmf-objectediting-process Determines the\n *     behavior to adopt when sketch features are added.\n * @htmlAttribute {gmfx.ObjectEditingQueryableLayerInfo} gmf-objectediting-queryablelayerinfo\n *     Queryable layer information.\n * @htmlAttribute {boolean} gmf-objectediting-requireslayer Flag that determines\n *     if the currently active tool requires a queryable layer or not.\n * @htmlAttribute {ol.Collection.<ol.Feature>} gmf-objectediting-sketchfeatures\n *     Collection of temporary features being drawn by the tools.\n * @return {angular.Directive} The directive specs.\n * @ngInject\n * @ngdoc directive\n * @ngname gmfObjecteditingtools\n */\nexports.directive_ = function() {\n  return {\n    controller: 'GmfObjecteditingtoolsController as oetCtrl',\n    scope: {\n      'active': '=gmfObjecteditingtoolsActive',\n      'copyFromActive': '=gmfObjecteditingtoolsCopyfromactive',\n      'deleteFromActive': '=gmfObjecteditingtoolsDeletefromactive',\n      'feature': '<gmfObjecteditingtoolsFeature',\n      'geomType': '<gmfObjecteditingtoolsGeomtype',\n      'map': '<gmfObjecteditingtoolsMap',\n      'process': '=gmfObjecteditingtoolsProcess',\n      'queryableLayerInfo': '=gmfObjecteditingtoolsQueryablelayerinfo',\n      'requiresLayer': '=gmfObjecteditingtoolsRequireslayer',\n      'sketchFeatures': '<gmfObjecteditingtoolsSketchfeatures'\n    },\n    bindToController: true,\n    templateUrl: 'gmf/objectediting/toolsComponent'\n  };\n};\n\nexports.directive('gmfObjecteditingtools',\n  exports.directive_);\n\n\n/**\n * @param {angular.$injector} $injector Main injector.\n * @param {!angular.Scope} $scope Scope.\n * @param {ngeo.misc.ToolActivateMgr} ngeoToolActivateMgr Ngeo ToolActivate manager\n *     service.\n * @constructor\n * @private\n * @ngInject\n * @ngdoc controller\n * @ngname GmfObjecteditingtoolsController\n */\nexports.Controller_ = function($injector, $scope, ngeoToolActivateMgr) {\n\n  // == Scope properties ==\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.active;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.copyFromActive;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.deleteFromActive;\n\n  /**\n   * @type {ol.Feature}\n   * @export\n   */\n  this.feature;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.geomType;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map;\n\n  /**\n   * @type {gmfx.ObjectEditingQueryableLayerInfo}\n   * @export\n   */\n  this.queryableLayerInfo;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.process;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.requiresLayer;\n\n  /**\n   * @type {ol.Collection.<ol.Feature>}\n   * @export\n   */\n  this.sketchFeatures;\n\n\n  // == Injected properties ==\n\n  /**\n   * @type {!angular.Scope}\n   * @private\n   */\n  this.scope_ = $scope;\n\n  /**\n   * @type {ngeo.misc.ToolActivateMgr}\n   * @private\n   */\n  this.ngeoToolActivateMgr_ = ngeoToolActivateMgr;\n\n  // == Other properties ==\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.geomTypePolygon = ngeoGeometryType.POLYGON;\n\n  /**\n   * @type {Array.<string>}\n   * @private\n   */\n  this.toolActiveNames_ = [];\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.drawActive = false;\n\n  this.registerTool_('drawActive',\n    exports.ProcessType.ADD);\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.eraseActive = false;\n\n  this.registerTool_('eraseActive',\n    exports.ProcessType.DELETE);\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.drawTriangleActive = false;\n\n  /**\n   * @type {number}\n   * @export\n   */\n  this.triangleAngle = Math.PI / 180 * 90; // 90 degrees\n\n  const oeToolsOptions = /** @type {gmfx.ObjectEditingToolsOptions} */ (\n    $injector.get('gmfObjectEditingToolsOptions'));\n\n  /**\n   * @type {number}\n   * @export\n   */\n  this.triangleRadius = oeToolsOptions.regularPolygonRadius !== undefined ?\n    oeToolsOptions.regularPolygonRadius : 100;\n\n  this.registerTool_('drawTriangleActive',\n    exports.ProcessType.ADD);\n\n  this.registerTool_('copyFromActive',\n    exports.ProcessType.ADD, true);\n\n  this.registerTool_('deleteFromActive',\n    exports.ProcessType.DELETE, true);\n\n  $scope.$on('$destroy', this.handleDestroy_.bind(this));\n};\n\n\n/**\n * Register a tool using its `active` property name and what behavior it should\n * have when it is active and a sketch feature is added\n *\n * This method:\n *  - registers a watcher on the tool active property to manage this directive\n *    main active property, i.e the directive is considered active when one\n *    of the tools is active,  otherwise it's not active.\n *\n *  - creates a `ngeo.misc.ToolActivate` object and registers it in a group so\n *    that only one tool can be active at a time\n *\n * @param {string} toolActiveName The name of the active property for the tool.\n * @param {string} process The behavior the tool should use when active\n *     and when sketch features are added.\n * @param {boolean=} opt_requiresLayer Whether the tool requires the queryable\n *     layer or not. Defaults to `false`.\n * @private\n */\nexports.Controller_.prototype.registerTool_ = function(\n  toolActiveName, process, opt_requiresLayer\n) {\n\n  const requiresLayer = opt_requiresLayer === true;\n\n  this.scope_.$watch(\n    () => this[toolActiveName],\n    this.handleToolActiveChange_.bind(this, process, requiresLayer)\n  );\n\n  const group = `${exports.Controller_.NAMESPACE_}-${olBase.getUid(this)}`;\n  const toolActivate = new ngeoMiscToolActivate(this, toolActiveName);\n  this.ngeoToolActivateMgr_.registerTool(group, toolActivate, false);\n\n  this.toolActiveNames_.push(toolActiveName);\n\n};\n\n\n/**\n * Called when any of the tool 'active' property changes.\n * @param {string} process The behavior the tool should use when active.\n * @param {boolean} requiresLayer Whether the tool requires the queryable\n *     layer or not.\n * @param {boolean|undefined} newVal New value.\n * @private\n */\nexports.Controller_.prototype.handleToolActiveChange_ = function(\n  process, requiresLayer, newVal\n) {\n\n  // Update process if a tool was activated.\n  if (newVal) {\n    this.process = process;\n    this.requiresLayer = requiresLayer;\n  }\n\n  // Update active property\n  let active = false;\n  for (let i = 0, ii = this.toolActiveNames_.length; i < ii; i++) {\n    active = active || this[this.toolActiveNames_[i]];\n    if (active) {\n      break;\n    }\n  }\n  this.active = active;\n\n  if (!this.active) {\n    this.requiresLayer = false;\n  }\n};\n\n\n/**\n * @private\n */\nexports.Controller_.prototype.handleDestroy_ = function() {};\n\n\nexports.controller('GmfObjecteditingtoolsController',\n  exports.Controller_);\n\n\n/**\n * @const\n * @private\n */\nexports.Controller_.NAMESPACE_ = 'oet';\n\n\n/**\n * @enum {string}\n */\nexports.ProcessType = {\n  ADD: 'add',\n  DELETE: 'delete'\n};\n\n\nexport default exports;\n","/**\n * @module gmf.objectediting.component\n */\nimport gmfEditingEditFeature from 'gmf/editing/EditFeature.js';\nimport gmfLayertreeSyncLayertreeMap from 'gmf/layertree/SyncLayertreeMap.js';\nimport gmfLayertreeTreeManager from 'gmf/layertree/TreeManager.js';\nimport gmfObjecteditingGeom from 'gmf/objectediting/geom.js';\nimport gmfObjecteditingQuery from 'gmf/objectediting/Query.js';\n\n/** @suppress {extraRequire} */\nimport gmfObjecteditingToolsComponent from 'gmf/objectediting/toolsComponent.js';\n\nimport googAsserts from 'goog/asserts.js';\n\n\nimport ngeoMapLayerHelper from 'ngeo/map/LayerHelper.js';\nimport ngeoMiscDecorate from 'ngeo/misc/decorate.js';\nimport ngeoMiscFeatureHelper from 'ngeo/misc/FeatureHelper.js';\nimport ngeoMiscToolActivate from 'ngeo/misc/ToolActivate.js';\n\n/** @suppress {extraRequire} */\nimport ngeoMiscToolActivateMgr from 'ngeo/misc/ToolActivateMgr.js';\n\nimport ngeoUtils from 'ngeo/utils.js';\nimport * as olBase from 'ol/index.js';\nimport olCollection from 'ol/Collection.js';\nimport * as olEvents from 'ol/events.js';\nimport olFormatGeoJSON from 'ol/format/GeoJSON.js';\nimport olGeomMultiPolygon from 'ol/geom/MultiPolygon.js';\nimport olLayerImage from 'ol/layer/Image.js';\nimport olLayerTile from 'ol/layer/Tile.js';\nimport olInteractionModify from 'ol/interaction/Modify.js';\nimport olStyleCircle from 'ol/style/Circle.js';\nimport olStyleFill from 'ol/style/Fill.js';\nimport olStyleStroke from 'ol/style/Stroke.js';\nimport olStyleStyle from 'ol/style/Style.js';\n\nimport {OL3Parser} from 'jsts/io';\nconst jsts = {\n  io: {\n    OL3Parser,\n  },\n};\n\n\n/**\n * @type {!angular.Module}\n */\nconst exports = angular.module('gmfObjectEditingComponent', [\n  gmfEditingEditFeature.module.name,\n  gmfLayertreeSyncLayertreeMap.module.name,\n  gmfLayertreeTreeManager.module.name,\n  gmfObjecteditingQuery.module.name,\n  gmfObjecteditingToolsComponent.name,\n  ngeoMapLayerHelper.module.name,\n  ngeoMiscFeatureHelper.module.name,\n  ngeoMiscToolActivateMgr.module.name,\n]);\n\n\nexports.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('gmf/objectediting', require('./component.html'));\n});\n\n\nexports.value('gmfObjecteditingTemplateUrl',\n  /**\n   * @param {!angular.JQLite} $element Element.\n   * @param {!angular.Attributes} $attrs Attributes.\n   * @return {string} Template URL.\n   */\n  ($element, $attrs) => {\n    const templateUrl = $attrs['gmfObjecteditingTemplateurl'];\n    return templateUrl !== undefined ? templateUrl :\n      'gmf/objectediting';\n  }\n);\n\n\n/**\n * @param {!angular.JQLite} $element Element.\n * @param {!angular.Attributes} $attrs Attributes.\n * @param {!function(!angular.JQLite, !angular.Attributes): string} gmfObjecteditingTemplateUrl Template function.\n * @return {string} Template URL.\n * @ngInject\n */\nfunction gmfObjecteditingTemplateUrl($element, $attrs, gmfObjecteditingTemplateUrl) {\n  return gmfObjecteditingTemplateUrl($element, $attrs);\n}\n\n\n/**\n * Component used to edit the geometry of a single feature using advanced\n * tools. The geometry must be Multi.\n *\n * Example:\n *\n *     <gmf-objectediting\n *         gmf-objectediting-active=\"ctrl.objectEditingActive\"\n *         gmf-objectediting-feature=\"ctrl.objectEditingFeature\"\n *         gmf-objectediting-geomtype=\"ctrl.objectEditingGeomType\"\n *         gmf-objectediting-layernodeid=\"ctrl.objectEditingLayerNodeId\"\n *         gmf-objectediting-map=\"::ctrl.map\"\n *         gmf-objectediting-sketchfeatures=\"::ctrl.sketchFeatures\">\n *     </gmf-objectediting>\n *\n * @htmlAttribute {boolean} gmf-objectediting-active Whether the component is\n *     active or not.\n * @htmlAttribute {ol.Feature} gmf-objectediting-feature The feature to edit.\n * @htmlAttribute {string} gmf-objectediting-geomtype The geometry type.\n * @htmlAttribute {number} gmf-objectediting-layernodeid The GMF layer node id.\n * @htmlAttribute {ol.Map} gmf-objectediting-map The map.\n * @htmlAttribute {ol.Collection.<ol.Feature>} gmf-objectediting-sketchfeatures\n *     Collection of temporary features being drawn by the tools.\n * @ngdoc component\n * @ngname gmfObjectediting\n */\nexports.component_ = {\n  controller: 'GmfObjecteditingController as oeCtrl',\n  bindings: {\n    'active': '=gmfObjecteditingActive',\n    'feature': '<gmfObjecteditingFeature',\n    'geomType': '<gmfObjecteditingGeomtype',\n    'layerNodeId': '<gmfObjecteditingLayernodeid',\n    'map': '<gmfObjecteditingMap',\n    'sketchFeatures': '<gmfObjecteditingSketchfeatures'\n  },\n  templateUrl: gmfObjecteditingTemplateUrl\n};\n\nexports.component('gmfObjectediting', exports.component_);\n\n\n/**\n * @param {!angular.Scope} $scope Angular scope.\n * @param {!angular.$timeout} $timeout Angular timeout service.\n * @param {!angularGettext.Catalog} gettextCatalog Gettext catalog.\n * @param {!gmf.editing.EditFeature} gmfEditFeature Gmf edit feature service.\n * @param {!gmf.objectediting.Query} gmfObjectEditingQuery Gmf ObjectEditing\n *     query service.\n * @param {!gmf.layertree.TreeManager} gmfTreeManager The gmf TreeManager service.\n * @param {!ngeo.misc.FeatureHelper} ngeoFeatureHelper Ngeo feature helper service.\ngoog.require('ngeo.map.LayerHelper');\n * @param {!ngeo.map.LayerHelper} ngeoLayerHelper Ngeo Layer Helper.\n * @param {!ngeo.misc.ToolActivateMgr} ngeoToolActivateMgr Ngeo ToolActivate manager\n *     service.\n * @constructor\n * @private\n * @ngInject\n * @ngdoc controller\n * @ngname GmfObjecteditingController\n */\nexports.Controller = function($scope, $timeout, gettextCatalog,\n  gmfEditFeature, gmfObjectEditingQuery, gmfTreeManager,\n  ngeoFeatureHelper, ngeoLayerHelper, ngeoToolActivateMgr) {\n\n  // == Scope properties ==\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.active;\n\n  /**\n   * @type {ol.Feature}\n   * @export\n   */\n  this.feature;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.geomType;\n\n  /**\n   * @type {number}\n   * @export\n   */\n  this.layerNodeId;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map;\n\n  /**\n   * @type {ol.Collection.<ol.Feature>}\n   * @export\n   */\n  this.sketchFeatures;\n\n\n  // == Injected properties ==\n\n  /**\n   * @type {!angular.Scope}\n   * @private\n   */\n  this.scope_ = $scope;\n\n  /**\n   * @type {!angular.$timeout}\n   * @private\n   */\n  this.timeout_ = $timeout;\n\n  /**\n   * @type {!angularGettext.Catalog}\n   * @private\n   */\n  this.gettextCatalog_ = gettextCatalog;\n\n  /**\n   * @type {!gmf.editing.EditFeature}\n   * @private\n   */\n  this.gmfEditFeature_ = gmfEditFeature;\n\n  /**\n   * @type {!gmf.objectediting.Query}\n   * @private\n   */\n  this.gmfObjectEditingQuery_ = gmfObjectEditingQuery;\n\n  /**\n   * @type {Array.<!gmfx.ObjectEditingQueryableLayerInfo>}\n   * @export\n   */\n  this.queryableLayersInfo;\n\n  /**\n   * @type {gmfx.ObjectEditingQueryableLayerInfo}\n   * @export\n   */\n  this.selectedQueryableLayerInfo;\n\n  /**\n   * Whether to show or hide the queryable list of layers. It is shown only\n   * when a tool requires it, which is managed in the `gmf-objecteditingtools`\n   * component.\n   * @type {boolean}\n   * @export\n   */\n  this.queryableLayerListShown = false;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.copyFromActive = false;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.deleteFromActive = false;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.featureHasGeom;\n\n  /**\n   * @type {!ngeo.map.LayerHelper}\n   * @private\n   */\n  this.ngeoLayerHelper_ = ngeoLayerHelper;\n\n  /**\n   * @type {!gmf.layertree.TreeManager}\n   * @private\n   */\n  this.gmfTreeManager_ = gmfTreeManager;\n\n  /**\n   * @type {!ngeo.misc.FeatureHelper}\n   * @private\n   */\n  this.ngeoFeatureHelper_ = ngeoFeatureHelper;\n\n  /**\n   * @type {!ngeo.misc.ToolActivateMgr}\n   * @private\n   */\n  this.ngeoToolActivateMgr_ = ngeoToolActivateMgr;\n\n\n  // == Other properties ==\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.skipGeometryChange_ = false;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.process = gmfObjecteditingToolsComponent.ProcessType.ADD;\n\n  /**\n   * @type {?ol.layer.Image|ol.layer.Tile}\n   * @private\n   */\n  this.editableWMSLayer_ = null;\n\n  /**\n   * @type {!jsts.io.OL3Parser}\n   * @private\n   */\n  this.jstsOL3Parser_ = new jsts.io.OL3Parser();\n\n  /**\n   * The state of the feature determines whether the next 'save' request\n   * should be an 'insert' or 'update' one.\n   * @type {string|undefined}\n   * @private\n   */\n  this.state_;\n\n  /**\n   * @type {!Array.<?ol.geom.Geometry>}\n   * @private\n   */\n  this.geometryChanges_ = [];\n\n  /**\n   * @type {!gmfx.StylesObject}\n   * @private\n   */\n  this.defaultStyles_ = {};\n\n  /**\n   * @type {!gmfx.StylesObject}\n   * @private\n   */\n  this.defaultStylesWoVertice_ = {};\n\n  /**\n   * @type {!gmfx.StylesObject}\n   * @private\n   */\n  this.dirtyStyles_ = {};\n\n  /**\n   * @type {!gmfx.StylesObject}\n   * @private\n   */\n  this.dirtyStylesWoVertice_ = {};\n\n  /**\n   * Flag that is toggled while a request is pending.\n   * @type {boolean}\n   * @export\n   */\n  this.pending = false;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.dirty = false;\n\n  /**\n   * @type {!Array.<!ol.EventsKey>}\n   * @private\n   */\n  this.listenerKeys_ = [];\n\n  /**\n   * @type {!ol.Collection}\n   * @private\n   */\n  this.features_ = new olCollection();\n\n  /**\n   * @type {!ol.Collection}\n   * @private\n   */\n  this.interactions_ = new olCollection();\n\n  /**\n   * @type {!ol.interaction.Modify}\n   * @private\n   */\n  this.modify_ = new olInteractionModify({\n    deleteCondition: ngeoUtils.deleteCondition,\n    features: this.features_,\n    style: ngeoFeatureHelper.getVertexStyle(false)\n  });\n  this.interactions_.push(this.modify_);\n\n  /**\n   * @type {!ngeo.misc.ToolActivate}\n   * @private\n   */\n  this.modifyToolActivate_ = new ngeoMiscToolActivate(this.modify_, 'active');\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.toolsActive = false;\n\n  /**\n   * @type {!ngeo.misc.ToolActivate}\n   * @private\n   */\n  this.toolsToolActivate_ = new ngeoMiscToolActivate(this, 'toolsActive');\n};\n\n/**\n * Init the controller\n */\nexports.Controller.prototype.$onInit = function() {\n  this.gmfObjectEditingQuery_.getQueryableLayersInfo().then(\n    this.handleGetQueryableLayersInfo_.bind(this)\n  );\n\n  this.scope_.$watchCollection(\n    () => {\n      if (this.gmfTreeManager_.rootCtrl) {\n        return this.gmfTreeManager_.rootCtrl.children;\n      }\n    },\n    (value) => {\n      // Timeout required, because the collection event is fired before the\n      // leaf nodes are created and they are the ones we're looking for here.\n      this.timeout_(() => {\n        if (value) {\n          this.unregisterAllTreeCtrl_();\n          this.gmfTreeManager_.rootCtrl.traverseDepthFirst(\n            this.registerTreeCtrl_.bind(this)\n          );\n        }\n      });\n    }\n  );\n\n  const geometry = this.feature.getGeometry();\n  this.state_ = geometry ? exports.Controller.State.UPDATE :\n    exports.Controller.State.INSERT;\n\n  this.scope_.$watchCollection(\n    () => this.geometryChanges_,\n    (newVal, oldVal) => {\n      if (newVal.length) {\n        if (newVal.length === 1) {\n          this.dirty = false;\n        } else {\n          this.dirty = true;\n        }\n      }\n    }\n  );\n\n  const defaultColor = [39, 155, 145];\n  const dirtyColor = [153, 51, 51];\n  this.initializeStyles_(this.defaultStyles_, defaultColor);\n  this.initializeStyles_(this.defaultStylesWoVertice_, defaultColor, false);\n  this.initializeStyles_(this.dirtyStyles_, dirtyColor);\n  this.initializeStyles_(this.dirtyStylesWoVertice_, dirtyColor, false);\n\n  this.scope_.$watch(\n    () => this.dirty,\n    this.setFeatureStyle_.bind(this)\n  );\n\n  this.features_.push(this.feature);\n\n  this.featureHasGeom = !gmfObjecteditingGeom.isEmpty(geometry);\n\n  // Toggle on\n  this.initializeInteractions_();\n  this.registerInteractions_();\n  this.toggle_(true);\n  this.resetGeometryChanges_();\n\n  this.scope_.$on('$destroy', this.handleDestroy_.bind(this));\n};\n\n\n// == API methods ==\n\n\n/**\n * Delete the feature after asking for a confirmation.\n * @export\n */\nexports.Controller.prototype.delete = function() {\n  const gettextCatalog = this.gettextCatalog_;\n  const msg = gettextCatalog.getString(\n    'Do you really want to delete the feature?');\n  // Confirm deletion first\n  if (confirm(msg)) {\n    this.dirty = false;\n    this.pending = true;\n\n    this.gmfEditFeature_.deleteFeature(\n      this.layerNodeId,\n      this.feature\n    ).then(\n      this.handleDeleteFeature_.bind(this)\n    );\n  }\n\n};\n\n\n/**\n * Save the current modifications.\n * @export\n */\nexports.Controller.prototype.save = function() {\n\n  this.pending = true;\n\n  // The geometry of the feature may contain Z in its coordinates, which\n  // GMF doesn't support.  This section ensures that the geometry gets purged\n  // of all Z from the coordinates before saving.\n  //\n  // Also, this is only done before saving on a clone of the feature. Doing\n  // it directly on the feature makes JSTS complain.\n  const feature = this.feature.clone();\n  feature.setId(this.feature.getId());\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    gmfObjecteditingGeom.toXY(geometry);\n  }\n\n  if (this.state_ === exports.Controller.State.INSERT) {\n    this.gmfEditFeature_.insertFeatures(\n      this.layerNodeId,\n      [feature]\n    ).then(\n      this.handleEditFeature_.bind(this)\n    );\n  } else if (this.state_ === exports.Controller.State.UPDATE) {\n    this.gmfEditFeature_.updateFeature(\n      this.layerNodeId,\n      feature\n    ).then(\n      this.handleEditFeature_.bind(this)\n    );\n  }\n};\n\n\n/**\n * Undo the latest modifications.\n * @export\n */\nexports.Controller.prototype.undo = function() {\n\n  if (this.geometryChanges_.length <= 1) {\n    return;\n  }\n\n  this.skipGeometryChange_ = true;\n\n  this.geometryChanges_.pop();\n  const clone = exports.Controller.cloneGeometry_(\n    this.geometryChanges_[this.geometryChanges_.length - 1]);\n\n  this.feature.setGeometry(clone);\n\n  this.skipGeometryChange_ = false;\n};\n\n\n/**\n * Undo the latest modifications.\n * @return {boolean} Whether the state is INSERT or not.\n * @export\n */\nexports.Controller.prototype.isStateInsert = function() {\n  return this.state_ === exports.Controller.State.INSERT;\n};\n\n\n// == Private methods ==\n\n\n/**\n * Called after a delete request.\n * @param {angular.$http.Response} resp Ajax response.\n * @private\n */\nexports.Controller.prototype.handleDeleteFeature_ = function(resp) {\n  this.feature.setGeometry(null);\n  this.resetGeometryChanges_();\n  this.state_ = exports.Controller.State.INSERT;\n  this.pending = false;\n  this.refreshWMSLayer_();\n};\n\n\n/**\n * Called after an 'insert' or 'update' request.\n * @param {angular.$http.Response} resp Ajax response.\n * @private\n */\nexports.Controller.prototype.handleEditFeature_ = function(resp) {\n  // (1) Update the id\n  const features = new olFormatGeoJSON().readFeatures(resp.data);\n  if (features.length) {\n    this.feature.setId(features[0].getId());\n  }\n  // (2) Reset geometry changes\n  this.resetGeometryChanges_();\n  // (3) Update state\n  if (this.feature.getGeometry()) {\n    this.state_ = exports.Controller.State.UPDATE;\n  } else {\n    this.state_ = exports.Controller.State.INSERT;\n  }\n  // (4) No longer pending\n  this.pending = false;\n  // (5) Refresh WMS layer\n  this.refreshWMSLayer_();\n};\n\n\n/**\n * Initialize interactions by setting them inactive and decorating them\n * @private\n */\nexports.Controller.prototype.initializeInteractions_ = function() {\n  this.interactions_.forEach((interaction) => {\n    interaction.setActive(false);\n    ngeoMiscDecorate.interaction(interaction);\n  });\n};\n\n\n/**\n * Register interactions by adding them to the map\n * @private\n */\nexports.Controller.prototype.registerInteractions_ = function() {\n  this.interactions_.forEach((interaction) => {\n    this.map.addInteraction(interaction);\n  });\n};\n\n\n/**\n * Unregister interactions, i.e. remove them from the map\n * @private\n */\nexports.Controller.prototype.unregisterInteractions_ = function() {\n  this.interactions_.forEach((interaction) => {\n    this.map.removeInteraction(interaction);\n  });\n};\n\n\n/**\n * Activate or deactivate this component.\n * @param {boolean} active Whether to activate this component or not.\n * @private\n */\nexports.Controller.prototype.toggle_ = function(active) {\n\n  const keys = this.listenerKeys_;\n  const uid = `${exports.Controller.NAMESPACE_}-${olBase.getUid(this)}`;\n  const toolMgr = this.ngeoToolActivateMgr_;\n\n  if (active) {\n\n    keys.push(\n      olEvents.listen(\n        this.feature,\n        `change:${this.feature.getGeometryName()}`,\n        this.handleFeatureGeometryChange_,\n        this\n      )\n    );\n\n    keys.push(\n      olEvents.listen(\n        this.modify_,\n        'change:active',\n        this.setFeatureStyle_,\n        this\n      )\n    );\n\n    keys.push(\n      olEvents.listen(\n        this.modify_,\n        'modifyend',\n        this.handleModifyInteractionModifyEnd_,\n        this\n      )\n    );\n\n    keys.push(\n      olEvents.listen(\n        window,\n        'beforeunload',\n        this.handleWindowBeforeUnload_,\n        this\n      )\n    );\n\n    keys.push(\n      olEvents.listen(\n        this.sketchFeatures,\n        'add',\n        this.handleSketchFeaturesAdd_,\n        this\n      )\n    );\n\n    toolMgr.registerTool(uid, this.modifyToolActivate_, true);\n    toolMgr.registerTool(uid, this.toolsToolActivate_, false);\n\n  } else {\n\n    this.undoAllChanges_();\n\n    keys.forEach(olEvents.unlistenByKey);\n    keys.length = 0;\n\n    toolMgr.unregisterTool(uid, this.modifyToolActivate_);\n    toolMgr.unregisterTool(uid, this.toolsToolActivate_);\n\n  }\n\n  this.modify_.setActive(active);\n};\n\n\n/**\n * Undo all current changes.\n * @private\n */\nexports.Controller.prototype.undoAllChanges_ = function() {\n  const clone = exports.Controller.cloneGeometry_(\n    this.geometryChanges_[0]);\n  this.feature.setGeometry(clone);\n\n  this.resetGeometryChanges_();\n  this.dirty = false;\n  this.setFeatureStyle_();\n};\n\n\n/**\n * Reset the array of geometry changes.  If there are more than one changes,\n * reset them entirely. Then, if there's no changes, clone the current geometry\n * as the first entry. One entry means that there's no changes.\n * @private\n */\nexports.Controller.prototype.resetGeometryChanges_ = function() {\n  if (this.geometryChanges_.length > 1) {\n    this.geometryChanges_.length = 0;\n  }\n  if (this.geometryChanges_.length === 0) {\n    const geometry = this.feature.getGeometry();\n    const clone = exports.Controller.cloneGeometry_(geometry);\n    this.geometryChanges_.push(clone);\n  }\n};\n\n\n/**\n * Called after the modification interaction has completed modifying the\n * existing geometry. The new geometry is pushed in the changes array.\n * If the geometry type is `MultiPolygon`, we check if any of the inner\n * geometries intersects with one an other first. Those that does are merged\n * before being pushed to the changes.\n *\n * @param {ol.interaction.Modify.Event} evt Event.\n * @private\n */\nexports.Controller.prototype.handleModifyInteractionModifyEnd_ = function(\n  evt\n) {\n  let geometry = this.feature.getGeometry();\n\n  if (geometry instanceof olGeomMultiPolygon) {\n    const jstsGeom = this.jstsOL3Parser_.read(geometry);\n    const jstsBuffered = jstsGeom.buffer(0);\n    geometry = ngeoUtils.toMulti(this.jstsOL3Parser_.write(jstsBuffered));\n    this.skipGeometryChange_ = true;\n    this.feature.setGeometry(geometry.clone());\n    this.skipGeometryChange_ = false;\n  }\n\n  const clone = exports.Controller.cloneGeometry_(geometry);\n  googAsserts.assert(clone);\n  this.geometryChanges_.push(clone);\n  this.scope_.$apply();\n};\n\n\n/**\n * @param {gmfx.StylesObject} styles Hash of style.\n * @param {ol.Color} color Color.\n * @param {boolean=} opt_incVertice Whether to include vertice or not. Defaults\n *     to `true`.\n * @private\n */\nexports.Controller.prototype.initializeStyles_ = function(\n  styles, color, opt_incVertice\n) {\n\n  const incVertice = opt_incVertice !== false;\n  const rgbaColor = color.slice();\n  rgbaColor.push(0.3);\n\n  const image = new olStyleCircle({\n    radius: 8,\n    stroke: new olStyleStroke({\n      color: color,\n      width: 1\n    }),\n    fill: new olStyleFill({color: rgbaColor})\n  });\n\n  styles['Point'] = new olStyleStyle({\n    image\n  });\n  styles['MultiPoint'] = new olStyleStyle({\n    image\n  });\n\n  styles['LineString'] = [\n    new olStyleStyle({\n      stroke: new olStyleStroke({\n        color: color,\n        width: 3\n      })\n    })\n  ];\n  if (incVertice) {\n    styles['LineString'].push(\n      this.ngeoFeatureHelper_.getVertexStyle(true)\n    );\n  }\n  styles['MultiLineString'] = [\n    new olStyleStyle({\n      stroke: new olStyleStroke({\n        color: color,\n        width: 3\n      })\n    })\n  ];\n  if (incVertice) {\n    styles['MultiLineString'].push(\n      this.ngeoFeatureHelper_.getVertexStyle(true)\n    );\n  }\n\n  styles['Polygon'] = [\n    new olStyleStyle({\n      stroke: new olStyleStroke({\n        color: color,\n        width: 2\n      }),\n      fill: new olStyleFill({\n        color: rgbaColor\n      })\n    })\n  ];\n  if (incVertice) {\n    styles['Polygon'].push(\n      this.ngeoFeatureHelper_.getVertexStyle(true)\n    );\n  }\n  styles['MultiPolygon'] = [\n    new olStyleStyle({\n      stroke: new olStyleStroke({\n        color: color,\n        width: 2\n      }),\n      fill: new olStyleFill({\n        color: rgbaColor\n      })\n    })\n  ];\n  if (incVertice) {\n    styles['MultiPolygon'].push(\n      this.ngeoFeatureHelper_.getVertexStyle(true)\n    );\n  }\n\n};\n\n\n/**\n * Set the style of the feature depending on:\n *  - the geometry type\n *  - the dirty state of the component\n *  - whether the modify control is active or not\n *\n * @private\n */\nexports.Controller.prototype.setFeatureStyle_ = function() {\n  const geometry = this.feature.getGeometry();\n  if (geometry) {\n    const geomType = geometry.getType();\n    const modifyActive = this.modify_.getActive();\n    let style;\n    if (this.dirty) {\n      if (modifyActive) {\n        style = this.dirtyStyles_[geomType];\n      } else {\n        style = this.dirtyStylesWoVertice_[geomType];\n      }\n    } else {\n      if (modifyActive) {\n        style = this.defaultStyles_[geomType];\n      } else {\n        style = this.defaultStylesWoVertice_[geomType];\n      }\n    }\n    this.feature.setStyle(style);\n  }\n};\n\n\n/**\n * Registers a newly added Layertree controller 'leaf', i.e. groups are\n * excluded.\n *\n * If the Layertree controller node id is equal to the `layerNodeId` configured\n * with this component, then find the WMS layer associated with it for\n * for refresh purpose.\n *\n * @param {ngeo.layertree.Controller} treeCtrl Layertree controller to register\n * @private\n */\nexports.Controller.prototype.registerTreeCtrl_ = function(treeCtrl) {\n\n  // Skip any Layertree controller that has a node that is not a leaf\n  const node = /** @type {gmfThemes.GmfGroup|gmfThemes.GmfLayer} */ (\n    treeCtrl.node);\n  if (node.children && node.children.length) {\n    return;\n  }\n\n  // Set editable WMS layer for refresh purpose\n  if (node.id === this.layerNodeId) {\n    const layer = gmfLayertreeSyncLayertreeMap.getLayer(treeCtrl);\n    googAsserts.assert(\n      layer instanceof olLayerImage || layer instanceof olLayerTile);\n    this.editableWMSLayer_ = layer;\n  }\n\n};\n\n\n/**\n * Unregisters all currently registered Layertree controllers.\n *\n * Unset the WMS layer associated with the `layerNodeId` configured with\n * this component.\n *\n * @private\n */\nexports.Controller.prototype.unregisterAllTreeCtrl_ = function() {\n  this.editableWMSLayer_ = null;\n};\n\n\n/**\n * Refresh the WMS layer, if set.\n * @private\n */\nexports.Controller.prototype.refreshWMSLayer_ = function() {\n  if (this.editableWMSLayer_) {\n    this.ngeoLayerHelper_.refreshWMSLayer(this.editableWMSLayer_);\n  }\n};\n\n\n/**\n * Called before the window unloads. Show a confirmation message if there are\n * unsaved modifications.\n * @param {Event} e Event.\n * @return {string} Message\n * @private\n */\nexports.Controller.prototype.handleWindowBeforeUnload_ = function(e) {\n  const gettextCatalog = this.gettextCatalog_;\n  if (this.dirty) {\n    const msg = gettextCatalog.getString('There are unsaved changes.');\n    (e || window.event).returnValue = msg;\n    return msg;\n  }\n  return '';\n};\n\n\n/**\n * Called when a feature is added to the collection of sketch features.\n * Depending on the current behaviour, use the added sketch feature to process\n * the existing geometry.\n *\n * @param {ol.Collection.Event} evt Event.\n * @private\n */\nexports.Controller.prototype.handleSketchFeaturesAdd_ = function(evt) {\n  const sketchFeature = /** @type {ol.Feature} */ (evt.element);\n  const sketchGeom = /** @type {ol.geom.Geometry} */ (\n    sketchFeature.getGeometry());\n\n  const geom = this.feature.getGeometry();\n\n  if (geom) {\n    const jstsGeom = this.jstsOL3Parser_.read(geom);\n    const jstsSketchGeom = this.jstsOL3Parser_.read(sketchGeom);\n    let jstsProcessedGeom;\n\n    if (this.process === gmfObjecteditingToolsComponent.ProcessType.ADD) {\n      jstsProcessedGeom = jstsGeom.union(jstsSketchGeom);\n    } else {\n      if (jstsGeom.intersects(jstsSketchGeom)) {\n        jstsProcessedGeom = jstsGeom.difference(jstsSketchGeom);\n      }\n    }\n\n    if (jstsProcessedGeom) {\n      const processedGeom = this.jstsOL3Parser_.write(jstsProcessedGeom);\n      const multiGeom = ngeoUtils.toMulti(processedGeom);\n      this.feature.setGeometry(multiGeom.clone());\n    }\n\n  } else if (this.process === gmfObjecteditingToolsComponent.ProcessType.ADD) {\n    this.feature.setGeometry(ngeoUtils.toMulti(sketchGeom.clone()));\n  }\n\n  this.sketchFeatures.clear();\n};\n\n\n/**\n * Called when the geometry property of the feature changes, i.e. not when the\n * geometry itself changes but when a new geometry is set to the feature.\n *\n * This happens either when resetting the geometry to null, in which case\n * there's nothing to do here. Otherwise, it happens after the combinaison\n * of a sketch geometry with the existing feature geometry. This new geom\n * is pushed in the `geometryChanges_` array.\n *\n * @private\n */\nexports.Controller.prototype.handleFeatureGeometryChange_ = function() {\n  const geom = this.feature.getGeometry();\n  this.timeout_(() => {\n    this.featureHasGeom = !gmfObjecteditingGeom.isEmpty(geom);\n  });\n\n  if (this.skipGeometryChange_) {\n    return;\n  }\n\n  if (geom) {\n    // Use a timeout here, because there can be a scope digest already in\n    // progress. For example, with tools that requires the user to draw\n    // features on the map, we would need to manually call:\n    // this.scope_.$apply();\n    // For tools that use promises instead, such as the \"copy/delete\" from,\n    // a scope is already in progress so we must not invoke it again.\n    this.timeout_(() => {\n      this.geometryChanges_.push(geom.clone());\n    });\n  }\n};\n\n\n/**\n * @param {Array.<gmfx.ObjectEditingQueryableLayerInfo>} layersInfo List\n *     of queryable layers information, which contains the node and ogcServer.\n * @private\n */\nexports.Controller.prototype.handleGetQueryableLayersInfo_ = function(layersInfo) {\n  this.queryableLayersInfo = layersInfo;\n  if (this.queryableLayersInfo.length) {\n    this.selectedQueryableLayerInfo = this.queryableLayersInfo[0];\n  }\n};\n\n\n/**\n * @private\n */\nexports.Controller.prototype.handleDestroy_ = function() {\n  this.features_.clear();\n  this.toggle_(false);\n  this.unregisterInteractions_();\n};\n\n\n// == Static methods and type definitions ==\n\n\n/**\n * Utility method that gets the clone of a geometry, which can be null or\n * undefined. In the latter case, a null value is returned instead of a\n * geometry.\n * @param {?ol.geom.Geometry|undefined} geometry A geometry, undefined or\n *     null value.\n * @return {?ol.geom.Geometry} A geometry clone or null value.\n * @private\n */\nexports.Controller.cloneGeometry_ = function(geometry) {\n  let clone = null;\n  if (geometry) {\n    clone = geometry.clone();\n  }\n  return clone;\n};\n\n\n/**\n * @const\n * @private\n */\nexports.Controller.NAMESPACE_ = 'oe';\n\n\n/**\n * @enum {string}\n */\nexports.Controller.State = {\n  INSERT: 'insert',\n  UPDATE: 'update'\n};\n\n\nexports.controller('GmfObjecteditingController',\n  exports.Controller);\n\n\nexport default exports;\n","/**\n * @module gmf.objectediting.Manager\n */\nimport gmfEditingEditFeature from 'gmf/editing/EditFeature.js';\nimport ngeoStatemanagerLocation from 'ngeo/statemanager/Location.js';\nimport olFeature from 'ol/Feature.js';\n\n/**\n * A service that looks for certain parameters in the url and use them to fetch\n * a feature using the GMF protocol.\n *\n * @param {angular.$q} $q Angular $q service.\n * @param {gmf.editing.EditFeature} gmfEditFeature Gmf edit feature service.\n * @param {ngeo.statemanager.Location} ngeoLocation ngeo location service.\n * @constructor\n * @struct\n * @ngInject\n */\nconst exports = function($q, gmfEditFeature, ngeoLocation) {\n\n  /**\n   * @type {angular.$q}\n   * @private\n   */\n  this.q_ = $q;\n\n  /**\n   * @type {gmf.editing.EditFeature}\n   * @private\n   */\n  this.gmfEditFeature_ = gmfEditFeature;\n\n  /**\n   * @type {ngeo.statemanager.Location}\n   * @private\n   */\n  this.ngeoLocation_ = ngeoLocation;\n\n  /**\n   * @type {angular.$q.Deferred|null}\n   * @private\n   */\n  this.getFeatureDefered_ = null;\n\n};\n\n\n/**\n * Use the EditFeature service to fetch a single feature using parameters in\n * the url. The method returns a promise that has the feature as argument in\n * the callback method. If any parameter in the url is missing, `null` is\n * returned, otherwise the query is made. If the query returns a feature, it\n * is returned, otherwise one is created with empty geometry and with the\n * property set.\n *\n * @return {angular.$q.Promise} Promise.\n * @export\n */\nexports.prototype.getFeature = function() {\n\n  if (!this.getFeatureDefered_) {\n    this.getFeatureDefered_ = this.q_.defer();\n\n    const geomType = this.ngeoLocation_.getParam(\n      exports.Param.GEOM_TYPE);\n    const id = this.ngeoLocation_.getParam(\n      exports.Param.ID);\n    const layer = this.ngeoLocation_.getParam(\n      exports.Param.LAYER);\n    const property = this.ngeoLocation_.getParam(\n      exports.Param.PROPERTY);\n    const theme = this.ngeoLocation_.getParam(\n      exports.Param.THEME);\n\n    if (geomType && id && layer && property && theme) {\n      this.gmfEditFeature_.getFeaturesWithComparisonFilters(\n        [layer],\n        [{\n          operator: 'eq',\n          property: property,\n          value: id\n        }]\n      ).then(this.handleGetFeatures_.bind(this, property, id));\n    } else {\n      this.getFeatureDefered_.resolve(null);\n    }\n  }\n\n  return this.getFeatureDefered_.promise;\n\n};\n\n\n/**\n * @return {string|undefined} The geometry type.\n * @export\n */\nexports.prototype.getGeomType = function() {\n  return this.ngeoLocation_.getParam(\n    exports.Param.GEOM_TYPE);\n};\n\n\n/**\n * @return {number|undefined} The gmf layer node id.\n * @export\n */\nexports.prototype.getLayerNodeId = function() {\n  return this.ngeoLocation_.getParamAsInt(\n    exports.Param.LAYER);\n};\n\n\n/**\n * Called after getting features with comparison filters. Resolve the deferred\n * promise with the first returned feature (if any), otherwise resolve it\n * with a feature created with an empty geometry and the property key + value\n * that was used in the attempt to fetch it.\n *\n * @param {string} key Property key.\n * @param {string} value Property value.\n * @param {Array.<ol.Feature>} features List of features.\n * @private\n */\nexports.prototype.handleGetFeatures_ = function(key, value, features) {\n  let feature;\n\n  if (features.length) {\n    feature = features[0];\n  } else {\n    const featureProperties = {};\n    featureProperties[key] = value;\n    featureProperties['geometry'] = null;\n    feature = new olFeature(featureProperties);\n  }\n\n  this.getFeatureDefered_.resolve(feature);\n};\n\n\n/**\n * @enum {string}\n * @export\n */\nexports.Param = {\n  /**\n   * @type {string}\n   * @export\n   */\n  GEOM_TYPE: 'objectediting_geomtype',\n  /**\n   * @type {string}\n   * @export\n   */\n  ID: 'objectediting_id',\n  /**\n   * @type {string}\n   * @export\n   */\n  LAYER: 'objectediting_layer',\n  /**\n   * @type {string}\n   * @export\n   */\n  PROPERTY: 'objectediting_property',\n  /**\n   * @type {string}\n   * @export\n   */\n  THEME: 'objectediting_theme'\n};\n\n\n/**\n * @type {!angular.Module}\n */\nexports.module = angular.module('gmfObjectEditingManager', [\n  gmfEditingEditFeature.module.name,\n  ngeoStatemanagerLocation.module.name,\n]);\nexports.module.service('gmfObjectEditingManager', exports);\n\n\nexport default exports;\n","/**\n * @module gmf.objectediting.module\n */\nimport gmfObjecteditingComponent from 'gmf/objectediting/component.js';\nimport gmfObjecteditingGetWMSFeatureComponent from 'gmf/objectediting/getWMSFeatureComponent.js';\nimport gmfObjecteditingManager from 'gmf/objectediting/Manager.js';\nimport gmfObjecteditingQuery from 'gmf/objectediting/Query.js';\nimport gmfObjecteditingToolsComponent from 'gmf/objectediting/toolsComponent.js';\n\n/**\n * @type {!angular.Module}\n */\nconst exports = angular.module('gmfObjecteditingModule', [\n  gmfObjecteditingComponent.name,\n  gmfObjecteditingGetWMSFeatureComponent.name,\n  gmfObjecteditingManager.module.name,\n  gmfObjecteditingQuery.module.name,\n  gmfObjecteditingToolsComponent.name,\n]);\n\n\nexport default exports;\n","/**\n * @module app.oeedit.Controller\n */\n/**\n * Application entry point.\n *\n * This file includes `goog.require`'s for all the components/directives used\n * by the HTML page and the controller to provide the configuration.\n */\n\nimport gmfControllersAbstractDesktopController from 'gmf/controllers/AbstractDesktopController.js';\nimport './sass/main.scss';\nimport appBase from '../appmodule.js';\nimport gmfObjecteditingModule from 'gmf/objectediting/module.js';\nimport ngeoMiscToolActivate from 'ngeo/misc/ToolActivate.js';\nimport ngeoProjEPSG2056 from 'ngeo/proj/EPSG2056.js';\nimport ngeoProjEPSG21781 from 'ngeo/proj/EPSG21781.js';\nimport * as olBase from 'ol/index.js';\nimport olCollection from 'ol/Collection.js';\nimport olLayerVector from 'ol/layer/Vector.js';\nimport olSourceVector from 'ol/source/Vector.js';\nimport Raven from 'raven-js/src/raven.js';\nimport RavenPluginsAngular from 'raven-js/plugins/angular.js';\n\nif (!window.requestAnimationFrame) {\n  alert('Your browser is not supported, please update it or use another one. You will be redirected.\\n\\n'\n    + 'Votre navigateur n\\'est pas support, veuillez le mettre  jour ou en utiliser un autre. Vous allez tre redirig.\\n\\n'\n    + 'Ihr Browser wird nicht untersttzt, bitte aktualisieren Sie ihn oder verwenden Sie einen anderen. Sie werden weitergeleitet.');\n  window.location = 'http://geomapfish.org/';\n}\n\n/**\n * @param {angular.Scope} $scope Scope.\n * @param {angular.$injector} $injector Main injector.\n * @param {angular.$timeout} $timeout Angular timeout service.\n * @constructor\n * @extends {gmf.controllers.AbstractDesktopController}\n * @ngInject\n * @export\n */\nconst exports = function($scope, $injector, $timeout) {\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.oeEditActive = false;\n\n  gmfControllersAbstractDesktopController.call(this, {\n    srid: 21781,\n    mapViewConfig: {\n      center: [632464, 185457],\n      zoom: 3,\n      resolutions: [250, 100, 50, 20, 10, 5, 2, 1, 0.5, 0.25, 0.1, 0.05]\n    }\n  }, $scope, $injector);\n\n  /**\n   * The ngeo ToolActivate manager service.\n   * @type {ngeo.misc.ToolActivateMgr}\n   */\n  const ngeoToolActivateMgr = $injector.get('ngeoToolActivateMgr');\n\n  ngeoToolActivateMgr.unregisterGroup('mapTools');\n\n  const oeEditToolActivate = new ngeoMiscToolActivate(this, 'oeEditActive');\n  ngeoToolActivateMgr.registerTool('mapTools', oeEditToolActivate, true);\n\n  const queryToolActivate = new ngeoMiscToolActivate(this, 'queryActive');\n  ngeoToolActivateMgr.registerTool('mapTools', queryToolActivate, false);\n\n  // Set edit tool as default active one\n  $timeout(() => {\n    this.oeEditActive = true;\n  });\n\n  /**\n   * @type {ol.source.Vector}\n   * @private\n   */\n  this.vectorSource_ = new olSourceVector({\n    wrapX: false\n  });\n\n  /**\n   * @type {ol.layer.Vector}\n   * @private\n   */\n  this.vectorLayer_ = new olLayerVector({\n    source: this.vectorSource_\n  });\n\n  /**\n   * @type {ol.Collection.<ol.Feature>}\n   * @export\n   */\n  this.sketchFeatures = new olCollection();\n\n  /**\n   * @type {ol.layer.Vector}\n   * @private\n   */\n  this.sketchLayer_ = new olLayerVector({\n    source: new olSourceVector({\n      features: this.sketchFeatures,\n      wrapX: false\n    })\n  });\n\n  /**\n   * @type {gmf.theme.Themes} gmfObjectEditingManager The gmf theme service\n   */\n  const gmfThemes = $injector.get('gmfThemes');\n\n  gmfThemes.getThemesObject().then((themes) => {\n    if (themes) {\n      // Add layer vector after\n      this.map.addLayer(this.vectorLayer_);\n      this.map.addLayer(this.sketchLayer_);\n    }\n  });\n\n  /**\n   * @type {gmf.objectediting.Manager} gmfObjectEditingManager The gmf\n   *     ObjectEditing manager service.\n   */\n  const gmfObjectEditingManager = $injector.get('gmfObjectEditingManager');\n\n  /**\n   * @type {string|undefined}\n   * @export\n   */\n  this.oeGeomType = gmfObjectEditingManager.getGeomType();\n\n  /**\n   * @type {number|undefined}\n   * @export\n   */\n  this.oeLayerNodeId = gmfObjectEditingManager.getLayerNodeId();\n\n  /**\n   * @type {?ol.Feature}\n   * @export\n   */\n  this.oeFeature = null;\n\n  gmfObjectEditingManager.getFeature().then((feature) => {\n    this.oeFeature = feature;\n    if (feature) {\n      this.vectorSource_.addFeature(feature);\n    }\n  });\n\n  /**\n   * @type {Array.<string>}\n   * @export\n   */\n  this.searchCoordinatesProjections = [ngeoProjEPSG21781, ngeoProjEPSG2056, 'EPSG:4326'];\n\n  /**\n   * @type {!Array.<number>}\n   * @export\n   */\n  this.scaleSelectorValues = [250000, 100000, 50000, 20000, 10000, 5000, 2000, 1000, 500, 250, 100, 50];\n\n  /**\n   * @type {Array.<string>}\n   * @export\n   */\n  this.elevationLayers = ['aster', 'srtm'];\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.selectedElevationLayer = this.elevationLayers[0];\n\n  /**\n   * @type {Object.<string, gmfx.ProfileLineConfiguration>}\n   * @export\n   */\n  this.profileLinesconfiguration = {\n    'aster': {color: '#0000A0'},\n    'srtm': {color: '#00A000'}\n  };\n\n  /**\n   * @type {Array.<gmfx.MousePositionProjection>}\n   * @export\n   */\n  this.mousePositionProjections = [{\n    code: ngeoProjEPSG2056,\n    label: 'CH1903+ / LV95',\n    filter: 'ngeoNumberCoordinates::{x}, {y} m'\n  }, {\n    code: ngeoProjEPSG21781,\n    label: 'CH1903 / LV03',\n    filter: 'ngeoNumberCoordinates::{x}, {y} m'\n  }, {\n    code: 'EPSG:4326',\n    label: 'WGS84',\n    filter: 'ngeoDMSCoordinates:2'\n  }];\n\n  // Allow angular-gettext-tools to collect the strings to translate\n  /** @type {angularGettext.Catalog} */\n  const gettextCatalog = $injector.get('gettextCatalog');\n  gettextCatalog.getString('Add a theme');\n  gettextCatalog.getString('Add a sub theme');\n  gettextCatalog.getString('Add a layer');\n\n  if ($injector.has('sentryUrl')) {\n    const options = $injector.has('sentryOptions') ? $injector.get('sentryOptions') : undefined;\n    const raven = new Raven();\n    raven.config($injector.get('sentryUrl'), options)\n      .addPlugin(RavenPluginsAngular)\n      .install();\n  }\n};\n\nolBase.inherits(exports, gmfControllersAbstractDesktopController);\n\nexports.module = angular.module('Appoeedit', [\n  appBase.module.name,\n  gmfControllersAbstractDesktopController.module.name,\n  gmfObjecteditingModule.name,\n]);\n\nexports.module.value('gmfContextualdatacontentTemplateUrl', 'gmf/contextualdata');\nexports.module.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('gmf/contextualdata', require('./contextualdata.html'));\n});\n\nexports.module.controller('OEEditController', exports);\n\nexport default exports;\n"],"sourceRoot":""}