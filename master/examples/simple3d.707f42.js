!function(t){function e(e){for(var i,r,l=e[0],s=e[1],u=e[2],c=0,d=[];c<l.length;c++)r=l[c],o[r]&&d.push(o[r][0]),o[r]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i]);for(m&&m(e);d.length;)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,l=1;l<n.length;l++){var s=n[l];0!==o[s]&&(i=!1)}i&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var i={},o={41:0},a=[];function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=e,l=l.slice();for(var u=0;u<l.length;u++)e(l[u]);var m=s;a.push([528,0]),n()}({528:function(t,e,n){n(53),n(54),t.exports=n(535)},529:function(t,e){},530:function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="ngeo-tools">\n  <div class="ngeo-angle"><div class="ngeo-angle3d"></div></div>\n  <button class="ngeo-left ngeo-tilt-left" ng-click="$ctrl.tilt(5)"></button>\n  <button class="ngeo-right ngeo-tilt-right" ng-click="$ctrl.tilt(-5)"></button>\n</div>\n<div class="ngeo-zoom">\n  <button class="ol-zoom-in" ng-click="$ctrl.zoom(1)"></button>\n  <button class="ol-zoom-out" ng-click="$ctrl.zoom(-1)"></button>\n</div>\n<div class="ngeo-tools">\n  <div class="ngeo-rotation"><div class="ngeo-rotation3d"></div></div>\n  <button class="ngeo-left" ng-click="$ctrl.rotate(-15)"></button>\n  <button class="ngeo-right" ng-click="$ctrl.rotate(15)"></button>\n</div>\n';return __p}},535:function(t,e,n){"use strict";n.r(e);n(529);var i=n(18),o=n(24),a=n(17),r=n(28),l=n(1),s=n(141),u=n(224),m={Permalink3dParam:{ENABLED:"3d_enabled",LON:"3d_lon",LAT:"3d_lat",ELEVATION:"3d_elevation",HEADING:"3d_heading",PITCH:"3d_pitch",PREFIX:"3d_"}},c=m,d=n(285),g=function(){function t(t,e,n){this.manager_,this.ngeoDebounce_=t,this.ngeoLocation_=e,this.ngeoStateManager_=n}t.$inject=["ngeoDebounce","ngeoLocation","ngeoStateManager"];var e=t.prototype;return e.initialize=function(t){var e=this;this.manager_=t,this.manager_.on("load",function(){e.cameraToState_()}),this.ngeoStateManager_.getInitialBooleanValue("3d_enabled")&&this.initialStateToCamera_()},e.getManager=function(){return this.manager_},e.initialStateToCamera_=function(){var t=this.ngeoStateManager_,e=t.getInitialNumberValue(c.Permalink3dParam.LON),n=t.getInitialNumberValue(c.Permalink3dParam.LAT),i=t.getInitialNumberValue(c.Permalink3dParam.ELEVATION),o=t.getInitialNumberValue(c.Permalink3dParam.HEADING)||0,a=t.getInitialNumberValue(c.Permalink3dParam.PITCH)||0;return l.a.assert(void 0!==e),l.a.assert(void 0!==n),l.a.assert(void 0!==i),this.manager_.set3dWithView(e,n,i,o,a)},e.cameraToState_=function(){var t=this,e=this.manager_.getOl3d().getCesiumScene().camera;e.moveEnd.addEventListener(this.ngeoDebounce_(function(){var n,i=e.positionCartographic;t.ngeoStateManager_.updateState(((n={})[c.Permalink3dParam.ENABLED]=!0,n[c.Permalink3dParam.LON]=Cesium.Math.toDegrees(i.longitude).toFixed(5),n[c.Permalink3dParam.LAT]=Cesium.Math.toDegrees(i.latitude).toFixed(5),n[c.Permalink3dParam.ELEVATION]=i.height.toFixed(0),n[c.Permalink3dParam.HEADING]=Cesium.Math.toDegrees(e.heading).toFixed(3),n[c.Permalink3dParam.PITCH]=Cesium.Math.toDegrees(e.pitch).toFixed(3),n))},1e3,!0)),this.manager_.on("toggle",function(e){e.target.is3dEnabled()||t.remove3dState_()})},e.remove3dState_=function(){var t=this;this.ngeoLocation_.getParamKeysWithPrefix(c.Permalink3dParam.PREFIX).forEach(function(e){t.ngeoStateManager_.deleteParam(e)})},t}();g.module=angular.module("ngeoOlcsService",[s.a.name,u.a.module.name,d.a.module.name]).service("ngeoOlcsService",g);var h=g,f=n(73),_=n(66);b.$inject=["$attrs","ngeoOlcsControls3dTemplateUrl"];var v=angular.module("ngeoOlcsControls3d",[]);var p=function(){function t(t,e){this.element_=t,this.ol3dm,this.minTilt,this.maxTilt,this.tiltRightEl_,this.tiltLeftEl_,this.rotation3dEl_,this.angle3dEl_,this.previousRotation_,this.previousViewMatrix_,this.animationFrameRequestId_,this.olcsService_=e}t.$inject=["$element","ngeoOlcsService"];var e=t.prototype;return e.updateWidget_=function(){var t=this,e=this.ol3dm.getOl3d().getOlView().getRotation();(function(t,e){return Number.isFinite(e)&&(!Number.isFinite(t)||Math.abs(e-t)>.05)})(this.previousRotation_,e)&&(this.rotateElement_(this.rotation3dEl_,e),this.previousRotation_=e);var n=this.ol3dm.getCesiumViewMatrix();if(!Cesium.Matrix4.equalsEpsilon(this.previousViewMatrix_,n,1e-5)){var i=this.ol3dm.getTiltOnGlobe();if(Number.isFinite(i||0)){this.rotateElement_(this.angle3dEl_,i),this.previousViewMatrix_=Cesium.Matrix4.clone(n);i-this.minTilt<.01?this.tiltRightEl_.addClass("ngeo-right-inactive"):this.tiltRightEl_.hasClass("ngeo-right-inactive")&&this.tiltRightEl_.removeClass("ngeo-right-inactive"),this.maxTilt-i<.01?this.tiltLeftEl_.addClass("ngeo-left-inactive"):this.tiltLeftEl_.hasClass("ngeo-left-inactive")&&this.tiltLeftEl_.removeClass("ngeo-left-inactive")}}this.animationFrameRequestId_=requestAnimationFrame(function(){return t.updateWidget_()})},e.$onDestroy=function(){this.animationFrameRequestId_&&cancelAnimationFrame(this.animationFrameRequestId_)},e.$onInit=function(){void 0===this.minTilt&&(this.minTilt=0),void 0===this.maxTilt&&(this.maxTilt=7*Math.PI/16),this.ol3dm||(this.ol3dm=l.a.assert(this.olcsService_.getManager())),this.tiltRightEl_=this.element_.find(".ngeo-tilt-right"),this.tiltLeftEl_=this.element_.find(".ngeo-tilt-left"),this.rotation3dEl_=this.element_.find(".ngeo-rotation3d"),this.angle3dEl_=this.element_.find(".ngeo-angle3d"),this.updateWidget_()},e.rotateElement_=function(t,e){var n="rotate("+e+"rad)";t.css({"-moz-transform":n,"-webkit-transform":n,"-o-transform":n,"-ms-transform":n,transform:n})},e.rotate=function(t){t=Cesium.Math.toRadians(t),this.ol3dm.setHeading(t)},e.tilt=function(t){t=Cesium.Math.toRadians(t);var e=this.ol3dm.getTiltOnGlobe();e+t<this.minTilt?t=this.minTilt-e:e+t>this.maxTilt&&(t=this.maxTilt-e);var n=this.ol3dm.getCesiumScene();_.a.rotateAroundBottomCenter(n,t)},e.zoom=function(t){var e=this.ol3dm.getOlView(),n=e.getResolution(),i=e.constrainResolution(n,t);e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:i,duration:250,easing:f.b})},t}();function b(t,e){if(e)return e;var n=t.ngeoOlcsControls3dTemplateUrl;return n||"ngeo/olsc/controls3d"}v.run(["$templateCache",function(t){t.put("ngeo/olsc/controls3d",n(530))}]);var P={bindings:{minTilt:"<?",maxTilt:"<?",ol3dm:"<?"},controller:p,templateUrl:b};v.component("ngeoOlcsControls3d",P),v.value("ngeoOlcsControls3dTemplateUrl","");var E=v,C=angular.module("ngeoOlcsModule",[E.name,h.module.name]),T=n(21);var O=function(t){function e(e,n,i){var o;return(o=t.call(this,e,i)||this).rootScope_=n,o}return function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(e,t),e.prototype.toggle3d=function(){var e=this;return t.prototype.toggle3d.call(this).then(function(){e.rootScope_.$apply()})},e}(n(335).a),M={};M.module=angular.module("app",["gettext",T.a.name,C.name]),M.MainController=function(t,e){this.map=new i.a({layers:[new a.a({source:new r.b})],view:new o.a({center:[0,0],zoom:4})});this.ol3dm=new O("../node_modules/@camptocamp/cesium/Build/Cesium/Cesium.js",t,{map:this.map}),e.initialize(this.ol3dm)},M.MainController.$inject=["$rootScope","ngeoOlcsService"],M.module.controller("MainController",M.MainController);e.default=M}});
//# sourceMappingURL=simple3d.707f42.js.map